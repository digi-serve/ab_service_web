{"version":3,"file":"webix.resources.7e2d787645f55f6c331c.js","mappings":"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","sources":["webpack://ab_platform_web/./js/webix/components/gantt/ sync","webpack://ab_platform_web/./js/webix/components/pivot/ sync","webpack://ab_platform_web/./js/webix/components/reports/ sync","webpack://ab_platform_web/./js/webix/components/scheduler/ sync","webpack://ab_platform_web/./js/webix/components/node_modules/webix-jet/dist/es6/jet.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/rLayout.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/jetWin.js","webpack://ab_platform_web/./js/webix/components/node_modules/jet-restate/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dragscroll.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dnd.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/bars.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/scale.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/diagram.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/common.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/tree.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/baseline.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/links.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/numeditor.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/resources.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/form.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/info.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/tree.js","webpack://ab_platform_web/./js/webix/components/sources/views/top.js","webpack://ab_platform_web/./js/webix/components/sources/export_views.js","webpack://ab_platform_web/./js/webix/components/sources/models/Local.js","webpack://ab_platform_web/./js/webix/components/sources/models/Backend.js","webpack://ab_platform_web/./js/webix/components/sources/models/Operations.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/webix-gantt-lib/dist/wgantt.es6.js","webpack://ab_platform_web/./js/webix/components/sources/models/Helpers.js","webpack://ab_platform_web/./js/webix/components/sources/models/Grouping.js","webpack://ab_platform_web/./js/webix/components/sources/app.js","webpack://ab_platform_web/./js/webix/components/sources/locales/en.js","webpack://ab_platform_web/./js/webix/components/sources/header.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/image.js","webpack://ab_platform_web/./js/webix/components/sources/common.js","webpack://ab_platform_web/./js/webix/components/sources/list.js","webpack://ab_platform_web/./js/webix/components/sources/dataview.js","webpack://ab_platform_web/./js/webix/components/sources/kanban.js","webpack://ab_platform_web/./js/webix/components/sources/uploader.js","webpack://ab_platform_web/./js/webix/components/sources/locale.js","webpack://ab_platform_web/./js/webix/components/sources/editor.js","webpack://ab_platform_web/./js/webix/components/sources/userlist.js","webpack://ab_platform_web/./js/webix/components/sources/menu.js","webpack://ab_platform_web/./js/webix/components/sources/comments.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/portlet.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/complex.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/values.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/group.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/table.js","webpack://ab_platform_web/./js/webix/components/sources/views/filter.js","webpack://ab_platform_web/./js/webix/components/sources/views/mode.js","webpack://ab_platform_web/./js/webix/components/sources/views/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/main.js","webpack://ab_platform_web/./js/webix/components/sources/views/table.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/rengine/dist/rengine.es6.js","webpack://ab_platform_web/./js/webix/components/sources/models/LocalData.js","webpack://ab_platform_web/./js/webix/components/sources/views/common/export.js","webpack://ab_platform_web/./js/webix/components/sources/views/common/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/jet-restate-bind/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/inputlist.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/icons.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/query/codebase/query.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/common.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/prompt.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/queryselect.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/query.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/data.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/summarypopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/bucket.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/bucketpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/groupselect.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/buckets.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/datepopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/summary.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/groups.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/sorts.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/axis.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/baseview.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/colorpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/rsearch.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/chartseries.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/column.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/heatmap.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/table.js","webpack://ab_platform_web/./js/webix/components/sources/views/empty.js","webpack://ab_platform_web/./js/webix/components/sources/views/heatmap.js","webpack://ab_platform_web/./js/webix/components/sources/views/menu.js","webpack://ab_platform_web/./js/webix/components/sources/views/modules.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/export.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/index.js","webpack://ab_platform_web/./js/webix/components/node_modules/jet-hotkey/index.js","webpack://ab_platform_web/./js/webix/components/sources/models/Charts.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/waitVisible.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/add.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/date.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/nav.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/palette.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/editor.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/navpopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/actionmenu.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dates.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/ical.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/recurring.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/recurringform.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/editrecurring.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/form.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/formpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/copypaste.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/info.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/colors.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/actionpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/templates.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/unitlist.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/agenda/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/hourscale.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/multimore.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/selection.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/resizer.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/webix-gantt-lib/dist/wgantt.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/compact.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/more.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/list.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/bar.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/more.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/scale.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/multidaylist.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/compact.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/year/calendar.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/year/index.js","webpack://ab_platform_web/./js/webix/locales/th-TH.js","webpack://ab_platform_web/./js/webix/extras/tinymce.js","webpack://ab_platform_web/./js/webix/webixResources.js"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 69907;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 24327;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 31163;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 38509;\nmodule.exports = webpackEmptyContext;","class NavigationBlocked {\r\n}\n\nclass JetBase {\r\n    constructor(webix, config) {\r\n        this.webixJet = true;\r\n        this.webix = webix;\r\n        this._events = [];\r\n        this._subs = {};\r\n        this._data = {};\r\n        if (config && config.params)\r\n            webix.extend(this._data, config.params);\r\n    }\r\n    getRoot() {\r\n        return this._root;\r\n    }\r\n    destructor() {\r\n        this._detachEvents();\r\n        this._destroySubs();\r\n        this._events = this._container = this.app = this._parent = this._root = null;\r\n    }\r\n    setParam(id, value, url) {\r\n        if (this._data[id] !== value) {\r\n            this._data[id] = value;\r\n            this._segment.update(id, value, 0);\r\n            if (url) {\r\n                return this.show(null);\r\n            }\r\n        }\r\n    }\r\n    getParam(id, parent) {\r\n        const value = this._data[id];\r\n        if (typeof value !== \"undefined\" || !parent) {\r\n            return value;\r\n        }\r\n        const view = this.getParentView();\r\n        if (view) {\r\n            return view.getParam(id, parent);\r\n        }\r\n    }\r\n    getUrl() {\r\n        return this._segment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._segment.toString();\r\n    }\r\n    getParentView() {\r\n        return this._parent;\r\n    }\r\n    $$(id) {\r\n        if (typeof id === \"string\") {\r\n            const root = this.getRoot();\r\n            return root.queryView((obj => (obj.config.id === id || obj.config.localId === id) &&\r\n                (obj.$scope === root.$scope)), \"self\");\r\n        }\r\n        else {\r\n            return id;\r\n        }\r\n    }\r\n    on(obj, name, code) {\r\n        const id = obj.attachEvent(name, code);\r\n        this._events.push({ obj, id });\r\n        return id;\r\n    }\r\n    contains(view) {\r\n        for (const key in this._subs) {\r\n            const kid = this._subs[key].view;\r\n            if (kid === view || kid.contains(view)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    getSubView(name) {\r\n        const sub = this.getSubViewInfo(name);\r\n        if (sub) {\r\n            return sub.subview.view;\r\n        }\r\n    }\r\n    getSubViewInfo(name) {\r\n        const sub = this._subs[name || \"default\"];\r\n        if (sub) {\r\n            return { subview: sub, parent: this };\r\n        }\r\n        if (name === \"_top\") {\r\n            this._subs[name] = { url: \"\", id: null, popup: true };\r\n            return this.getSubViewInfo(name);\r\n        }\r\n        // when called from a child view, searches for nearest parent with subview\r\n        if (this._parent) {\r\n            return this._parent.getSubViewInfo(name);\r\n        }\r\n        return null;\r\n    }\r\n    _detachEvents() {\r\n        const events = this._events;\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            events[i].obj.detachEvent(events[i].id);\r\n        }\r\n    }\r\n    _destroySubs() {\r\n        // destroy sub views\r\n        for (const key in this._subs) {\r\n            const subView = this._subs[key].view;\r\n            // it possible that subview was not loaded with any content yet\r\n            // so check on null\r\n            if (subView) {\r\n                subView.destructor();\r\n            }\r\n        }\r\n        // reset to prevent memory leaks\r\n        this._subs = {};\r\n    }\r\n    _init_url_data() {\r\n        const url = this._segment.current();\r\n        this._data = {};\r\n        this.webix.extend(this._data, url.params, true);\r\n    }\r\n    _getDefaultSub() {\r\n        if (this._subs.default) {\r\n            return this._subs.default;\r\n        }\r\n        for (const key in this._subs) {\r\n            const sub = this._subs[key];\r\n            if (!sub.branch && sub.view && key !== \"_top\") {\r\n                const child = sub.view._getDefaultSub();\r\n                if (child) {\r\n                    return child;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _routed_view() {\r\n        const parent = this.getParentView();\r\n        if (!parent) {\r\n            return true;\r\n        }\r\n        const sub = parent._getDefaultSub();\r\n        if (!sub && sub !== this) {\r\n            return false;\r\n        }\r\n        return parent._routed_view();\r\n    }\r\n}\n\nfunction parse(url) {\r\n    // remove starting /\r\n    if (url[0] === \"/\") {\r\n        url = url.substr(1);\r\n    }\r\n    // split url by \"/\"\r\n    const parts = url.split(\"/\");\r\n    const chunks = [];\r\n    // for each page in url\r\n    for (let i = 0; i < parts.length; i++) {\r\n        const test = parts[i];\r\n        const result = {};\r\n        // detect params\r\n        // support old \t\t\tsome:a=b:c=d\r\n        // and new notation\t\tsome?a=b&c=d\r\n        let pos = test.indexOf(\":\");\r\n        if (pos === -1) {\r\n            pos = test.indexOf(\"?\");\r\n        }\r\n        if (pos !== -1) {\r\n            const params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\r\n            // create hash of named params\r\n            for (const param of params) {\r\n                const dchunk = param.split(\"=\");\r\n                result[dchunk[0]] = decodeURIComponent(dchunk[1]);\r\n            }\r\n        }\r\n        // store parsed values\r\n        chunks[i] = {\r\n            page: (pos > -1 ? test.substr(0, pos) : test),\r\n            params: result,\r\n            isNew: true\r\n        };\r\n    }\r\n    // return array of page objects\r\n    return chunks;\r\n}\r\nfunction url2str(stack) {\r\n    const url = [];\r\n    for (const chunk of stack) {\r\n        url.push(\"/\" + chunk.page);\r\n        const params = obj2str(chunk.params);\r\n        if (params) {\r\n            url.push(\"?\" + params);\r\n        }\r\n    }\r\n    return url.join(\"\");\r\n}\r\nfunction obj2str(obj) {\r\n    const str = [];\r\n    for (const key in obj) {\r\n        if (typeof obj[key] === \"object\")\r\n            continue;\r\n        if (str.length) {\r\n            str.push(\"&\");\r\n        }\r\n        str.push(key + \"=\" + encodeURIComponent(obj[key]));\r\n    }\r\n    return str.join(\"\");\r\n}\n\nclass Route {\r\n    constructor(route, index) {\r\n        this._next = 1;\r\n        if (typeof route === \"string\") {\r\n            this.route = {\r\n                url: parse(route),\r\n                path: route\r\n            };\r\n        }\r\n        else {\r\n            this.route = route;\r\n        }\r\n        this.index = index;\r\n    }\r\n    current() {\r\n        return this.route.url[this.index];\r\n    }\r\n    next() {\r\n        return this.route.url[this.index + this._next];\r\n    }\r\n    suburl() {\r\n        return this.route.url.slice(this.index);\r\n    }\r\n    shift(params) {\r\n        const route = new Route(this.route, this.index + this._next);\r\n        route.setParams(route.route.url, params, route.index);\r\n        return route;\r\n    }\r\n    setParams(url, params, index) {\r\n        if (params) {\r\n            const old = url[index].params;\r\n            for (var key in params)\r\n                old[key] = params[key];\r\n        }\r\n    }\r\n    refresh() {\r\n        const url = this.route.url;\r\n        for (let i = this.index + 1; i < url.length; i++) {\r\n            url[i].isNew = true;\r\n        }\r\n    }\r\n    toString() {\r\n        const str = url2str(this.suburl());\r\n        return str ? str.substr(1) : \"\";\r\n    }\r\n    _join(path, kids) {\r\n        let url = this.route.url;\r\n        if (path === null) { // change of parameters, route elements are not affected\r\n            return url;\r\n        }\r\n        const old = this.route.url;\r\n        let reset = true;\r\n        url = old.slice(0, this.index + (kids ? this._next : 0));\r\n        if (path) {\r\n            url = url.concat(parse(path));\r\n            for (let i = 0; i < url.length; i++) {\r\n                if (old[i]) {\r\n                    url[i].view = old[i].view;\r\n                }\r\n                if (reset && old[i] && url[i].page === old[i].page) {\r\n                    url[i].isNew = false;\r\n                }\r\n                else if (url[i].isNew) {\r\n                    // if some segment was marked as new, all subsegments must be updated as well\r\n                    reset = false;\r\n                }\r\n            }\r\n        }\r\n        return url;\r\n    }\r\n    append(path) {\r\n        const url = this._join(path, true);\r\n        this.route.path = url2str(url);\r\n        this.route.url = url;\r\n        return this.route.path;\r\n    }\r\n    show(path, view, kids) {\r\n        const url = this._join(path.url, kids);\r\n        this.setParams(url, path.params, this.index + (kids ? this._next : 0));\r\n        return new Promise((res, rej) => {\r\n            const redirect = url2str(url);\r\n            const obj = {\r\n                url,\r\n                redirect,\r\n                confirm: Promise.resolve()\r\n            };\r\n            const app = view ? view.app : null;\r\n            // when creating a new route, it possible that it will not have any content\r\n            // guard is not necessary in such case\r\n            if (app) {\r\n                const result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\r\n                if (!result) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n            }\r\n            obj.confirm.catch(err => rej(err)).then(() => {\r\n                if (obj.redirect === null) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                if (obj.redirect !== redirect) {\r\n                    app.show(obj.redirect);\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                this.route.path = redirect;\r\n                this.route.url = url;\r\n                res();\r\n            });\r\n        });\r\n    }\r\n    size(n) {\r\n        this._next = n;\r\n    }\r\n    split() {\r\n        const route = {\r\n            url: this.route.url.slice(this.index + 1),\r\n            path: \"\"\r\n        };\r\n        if (route.url.length) {\r\n            route.path = url2str(route.url);\r\n        }\r\n        return new Route(route, 0);\r\n    }\r\n    update(name, value, index) {\r\n        const chunk = this.route.url[this.index + (index || 0)];\r\n        if (!chunk) {\r\n            this.route.url.push({ page: \"\", params: {} });\r\n            return this.update(name, value, index);\r\n        }\r\n        if (name === \"\") {\r\n            chunk.page = value;\r\n        }\r\n        else {\r\n            chunk.params[name] = value;\r\n        }\r\n        this.route.path = url2str(this.route.url);\r\n    }\r\n}\n\nclass JetView extends JetBase {\r\n    constructor(app, config) {\r\n        super(app.webix);\r\n        this.app = app;\r\n        //this.$config = config;\r\n        this._children = [];\r\n    }\r\n    ui(ui, config) {\r\n        config = config || {};\r\n        const container = config.container || ui.container;\r\n        const jetview = this.app.createView(ui);\r\n        this._children.push(jetview);\r\n        jetview.render(container, this._segment, this);\r\n        if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\r\n            // raw webix UI\r\n            return jetview;\r\n        }\r\n        else {\r\n            return jetview.getRoot();\r\n        }\r\n    }\r\n    show(path, config) {\r\n        config = config || {};\r\n        // convert parameters object to url\r\n        if (typeof path === \"object\") {\r\n            for (const key in path) {\r\n                this.setParam(key, path[key]);\r\n            }\r\n            path = null;\r\n        }\r\n        else {\r\n            // deligate to app in case of root prefix\r\n            if (path.substr(0, 1) === \"/\") {\r\n                return this.app.show(path, config);\r\n            }\r\n            // local path, do nothing\r\n            if (path.indexOf(\"./\") === 0) {\r\n                path = path.substr(2);\r\n            }\r\n            // parent path, call parent view\r\n            if (path.indexOf(\"../\") === 0) {\r\n                const parent = this.getParentView();\r\n                if (parent) {\r\n                    return parent.show(path.substr(3), config);\r\n                }\r\n                else {\r\n                    return this.app.show(\"/\" + path.substr(3));\r\n                }\r\n            }\r\n            const sub = this.getSubViewInfo(config.target);\r\n            if (sub) {\r\n                if (sub.parent !== this) {\r\n                    return sub.parent.show(path, config);\r\n                }\r\n                else if (config.target && config.target !== \"default\") {\r\n                    return this._renderFrameLock(config.target, sub.subview, {\r\n                        url: path,\r\n                        params: config.params,\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                if (path) {\r\n                    return this.app.show(\"/\" + path, config);\r\n                }\r\n            }\r\n        }\r\n        return this._show(this._segment, { url: path, params: config.params }, this);\r\n    }\r\n    _show(segment, path, view) {\r\n        return segment.show(path, view, true).then(() => {\r\n            this._init_url_data();\r\n            return this._urlChange();\r\n        }).then(() => {\r\n            if (segment.route.linkRouter) {\r\n                this.app.getRouter().set(segment.route.path, { silent: true });\r\n                this.app.callEvent(\"app:route\", [segment.route.path]);\r\n            }\r\n        });\r\n    }\r\n    init(_$view, _$) {\r\n        // stub\r\n    }\r\n    ready(_$view, _$url) {\r\n        // stub\r\n    }\r\n    config() {\r\n        this.app.webix.message(\"View:Config is not implemented\");\r\n    }\r\n    urlChange(_$view, _$url) {\r\n        // stub\r\n    }\r\n    destroy() {\r\n        // stub\r\n    }\r\n    destructor() {\r\n        this.destroy();\r\n        this._destroyKids();\r\n        // destroy actual UI\r\n        if (this._root) {\r\n            this._root.destructor();\r\n            super.destructor();\r\n        }\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this.app, this, config);\r\n    }\r\n    refresh() {\r\n        const url = this.getUrl();\r\n        this.destroy();\r\n        this._destroyKids();\r\n        this._destroySubs();\r\n        this._detachEvents();\r\n        if (this._container.tagName) {\r\n            this._root.destructor();\r\n        }\r\n        this._segment.refresh();\r\n        return this._render(this._segment);\r\n    }\r\n    render(root, url, parent) {\r\n        if (typeof url === \"string\") {\r\n            url = new Route(url, 0);\r\n        }\r\n        this._segment = url;\r\n        this._parent = parent;\r\n        this._init_url_data();\r\n        root = root || document.body;\r\n        const _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\r\n        if (this._container !== _container) {\r\n            this._container = _container;\r\n            return this._render(url);\r\n        }\r\n        else {\r\n            return this._urlChange().then(() => this.getRoot());\r\n        }\r\n    }\r\n    _render(url) {\r\n        const config = this.config();\r\n        if (config.then) {\r\n            return config.then(cfg => this._render_final(cfg, url));\r\n        }\r\n        else {\r\n            return this._render_final(config, url);\r\n        }\r\n    }\r\n    _render_final(config, url) {\r\n        // get previous view in the same slot\r\n        let slot = null;\r\n        let container = null;\r\n        let show = false;\r\n        if (!this._container.tagName) {\r\n            slot = this._container;\r\n            if (slot.popup) {\r\n                container = document.body;\r\n                show = true;\r\n            }\r\n            else {\r\n                container = this.webix.$$(slot.id);\r\n            }\r\n        }\r\n        else {\r\n            container = this._container;\r\n        }\r\n        // view already destroyed\r\n        if (!this.app || !container) {\r\n            return Promise.reject(null);\r\n        }\r\n        let response;\r\n        const current = this._segment.current();\r\n        // using wrapper object, so ui can be changed from app:render event\r\n        const result = { ui: {} };\r\n        this.app.copyConfig(config, result.ui, this._subs);\r\n        this.app.callEvent(\"app:render\", [this, url, result]);\r\n        result.ui.$scope = this;\r\n        /* destroy old HTML attached views before creating new one */\r\n        if (!slot && current.isNew && current.view) {\r\n            current.view.destructor();\r\n        }\r\n        try {\r\n            // special handling for adding inside of multiview - preserve old id\r\n            if (slot && !show) {\r\n                const oldui = container;\r\n                const parent = oldui.getParentView();\r\n                if (parent && parent.name === \"multiview\" && !result.ui.id) {\r\n                    result.ui.id = oldui.config.id;\r\n                }\r\n            }\r\n            this._root = this.app.webix.ui(result.ui, container);\r\n            const asWin = this._root;\r\n            // check for url added to ignore this.ui calls\r\n            if (show && asWin.setPosition && !asWin.isVisible()) {\r\n                asWin.show();\r\n            }\r\n            // check, if we are replacing some older view\r\n            if (slot) {\r\n                if (slot.view && slot.view !== this && slot.view !== this.app) {\r\n                    slot.view.destructor();\r\n                }\r\n                slot.id = this._root.config.id;\r\n                if (this.getParentView() || !this.app.app)\r\n                    slot.view = this;\r\n                else {\r\n                    // when we have subapp, set whole app as a view\r\n                    // so on destruction, the whole app will be destroyed\r\n                    slot.view = this.app;\r\n                }\r\n            }\r\n            if (current.isNew) {\r\n                current.view = this;\r\n                current.isNew = false;\r\n            }\r\n            response = Promise.resolve(this._init(this._root, url)).then(() => {\r\n                return this._urlChange().then(() => {\r\n                    this._initUrl = null;\r\n                    return this.ready(this._root, url.suburl());\r\n                });\r\n            });\r\n        }\r\n        catch (e) {\r\n            response = Promise.reject(e);\r\n        }\r\n        return response.catch(err => this._initError(this, err));\r\n    }\r\n    _init(view, url) {\r\n        return this.init(view, url.suburl());\r\n    }\r\n    _urlChange() {\r\n        this.app.callEvent(\"app:urlchange\", [this, this._segment]);\r\n        const waits = [];\r\n        for (const key in this._subs) {\r\n            const frame = this._subs[key];\r\n            const wait = this._renderFrameLock(key, frame, null);\r\n            if (wait) {\r\n                waits.push(wait);\r\n            }\r\n        }\r\n        return Promise.all(waits).then(() => {\r\n            return this.urlChange(this._root, this._segment.suburl());\r\n        });\r\n    }\r\n    _renderFrameLock(key, frame, path) {\r\n        // if subview is not occupied by some rendering yet\r\n        if (!frame.lock) {\r\n            // retreive and store rendering end promise\r\n            const lock = this._renderFrame(key, frame, path);\r\n            if (lock) {\r\n                // clear lock after frame rendering\r\n                // as promise.finally is not supported by  Webix lesser than 6.2\r\n                // using a more verbose notation\r\n                frame.lock = lock.then(() => frame.lock = null, () => frame.lock = null);\r\n            }\r\n        }\r\n        // return rendering end promise\r\n        return frame.lock;\r\n    }\r\n    _renderFrame(key, frame, path) {\r\n        //default route\r\n        if (key === \"default\") {\r\n            if (this._segment.next()) {\r\n                // we have a next segment in url, render it\r\n                let params = path ? path.params : null;\r\n                if (frame.params) {\r\n                    params = this.webix.extend(params || {}, frame.params);\r\n                }\r\n                return this._createSubView(frame, this._segment.shift(params));\r\n            }\r\n            else if (frame.view && frame.popup) {\r\n                // there is no next segment, delete the existing sub-view\r\n                frame.view.destructor();\r\n                frame.view = null;\r\n            }\r\n        }\r\n        //if new path provided, set it to the frame\r\n        if (path !== null) {\r\n            frame.url = path.url;\r\n            if (frame.params) {\r\n                path.params = this.webix.extend(path.params || {}, frame.params);\r\n            }\r\n        }\r\n        // in case of routed sub-view\r\n        if (frame.route) {\r\n            // we have a new path for sub-view\r\n            if (path !== null) {\r\n                return frame.route.show(path, frame.view).then(() => {\r\n                    return this._createSubView(frame, frame.route);\r\n                });\r\n            }\r\n            // do not trigger onChange for isolated sub-views\r\n            if (frame.branch) {\r\n                return;\r\n            }\r\n        }\r\n        let view = frame.view;\r\n        // if view doesn't exists yet, init it\r\n        if (!view && frame.url) {\r\n            if (typeof frame.url === \"string\") {\r\n                // string, so we have isolated subview url\r\n                frame.route = new Route(frame.url, 0);\r\n                if (path)\r\n                    frame.route.setParams(frame.route.route.url, path.params, 0);\r\n                if (frame.params)\r\n                    frame.route.setParams(frame.route.route.url, frame.params, 0);\r\n                return this._createSubView(frame, frame.route);\r\n            }\r\n            else {\r\n                // object, so we have an embeded subview\r\n                if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\r\n                    view = new (this.app._override(frame.url))(this.app, \"\");\r\n                }\r\n                if (!view) {\r\n                    view = frame.url;\r\n                }\r\n            }\r\n        }\r\n        // trigger onChange for already existed view\r\n        if (view) {\r\n            return view.render(frame, (frame.route || this._segment), this);\r\n        }\r\n    }\r\n    _initError(view, err) {\r\n        /*\r\n            if view is destroyed, ignore any view related errors\r\n        */\r\n        if (this.app) {\r\n            this.app.error(\"app:error:initview\", [err, view]);\r\n        }\r\n        return true;\r\n    }\r\n    _createSubView(sub, suburl) {\r\n        return this.app.createFromURL(suburl.current()).then(view => {\r\n            return view.render(sub, suburl, this);\r\n        });\r\n    }\r\n    _destroyKids() {\r\n        // destroy child views\r\n        const uis = this._children;\r\n        for (let i = uis.length - 1; i >= 0; i--) {\r\n            if (uis[i] && uis[i].destructor) {\r\n                uis[i].destructor();\r\n            }\r\n        }\r\n        // reset vars for better GC processing\r\n        this._children = [];\r\n    }\r\n}\n\n// wrapper for raw objects and Jet 1.x structs\r\nclass JetViewRaw extends JetView {\r\n    constructor(app, config) {\r\n        super(app, config);\r\n        this._ui = config.ui;\r\n    }\r\n    config() {\r\n        return this._ui;\r\n    }\r\n}\n\nclass SubRouter {\r\n    constructor(cb, config, app) {\r\n        this.path = \"\";\r\n        this.app = app;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        const a = this.app;\r\n        a.app.getRouter().set(a._segment.append(this.path), { silent: true });\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nlet _once = true;\r\nclass JetAppBase extends JetBase {\r\n    constructor(config) {\r\n        const webix = (config || {}).webix || window.webix;\r\n        config = webix.extend({\r\n            name: \"App\",\r\n            version: \"1.0\",\r\n            start: \"/home\"\r\n        }, config, true);\r\n        super(webix, config);\r\n        this.config = config;\r\n        this.app = this.config.app;\r\n        this.ready = Promise.resolve();\r\n        this._services = {};\r\n        this.webix.extend(this, this.webix.EventSystem);\r\n    }\r\n    getUrl() {\r\n        return this._subSegment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._subSegment.toString();\r\n    }\r\n    getService(name) {\r\n        let obj = this._services[name];\r\n        if (typeof obj === \"function\") {\r\n            obj = this._services[name] = obj(this);\r\n        }\r\n        return obj;\r\n    }\r\n    setService(name, handler) {\r\n        this._services[name] = handler;\r\n    }\r\n    destructor() {\r\n        this.getSubView().destructor();\r\n        super.destructor();\r\n    }\r\n    // copy object and collect extra handlers\r\n    copyConfig(obj, target, config) {\r\n        // raw ui config\r\n        if (obj instanceof JetBase ||\r\n            (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\r\n            obj = { $subview: obj };\r\n        }\r\n        // subview placeholder\r\n        if (typeof obj.$subview != \"undefined\") {\r\n            return this.addSubView(obj, target, config);\r\n        }\r\n        // process sub-properties\r\n        const isArray = obj instanceof Array;\r\n        target = target || (isArray ? [] : {});\r\n        for (const method in obj) {\r\n            let point = obj[method];\r\n            // view class\r\n            if (typeof point === \"function\" && point.prototype instanceof JetBase) {\r\n                point = { $subview: point };\r\n            }\r\n            if (point && typeof point === \"object\" &&\r\n                !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\r\n                if (point instanceof Date) {\r\n                    target[method] = new Date(point);\r\n                }\r\n                else {\r\n                    const copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\r\n                    if (copy !== null) {\r\n                        if (isArray)\r\n                            target.push(copy);\r\n                        else\r\n                            target[method] = copy;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                target[method] = point;\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n    getRouter() {\r\n        return this.$router;\r\n    }\r\n    clickHandler(e, target) {\r\n        if (e) {\r\n            target = target || (e.target || e.srcElement);\r\n            if (target && target.getAttribute) {\r\n                const trigger = target.getAttribute(\"trigger\");\r\n                if (trigger) {\r\n                    this._forView(target, view => view.app.trigger(trigger));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n                const route = target.getAttribute(\"route\");\r\n                if (route) {\r\n                    this._forView(target, view => view.show(route));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n            }\r\n        }\r\n        const parent = target.parentNode;\r\n        if (parent) {\r\n            this.clickHandler(e, parent);\r\n        }\r\n    }\r\n    getRoot() {\r\n        return this.getSubView().getRoot();\r\n    }\r\n    refresh() {\r\n        if (!this._subSegment) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return this.getSubView().refresh().then(view => {\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return view;\r\n        });\r\n    }\r\n    loadView(url) {\r\n        const views = this.config.views;\r\n        let result = null;\r\n        if (url === \"\") {\r\n            return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\r\n        }\r\n        try {\r\n            if (views) {\r\n                if (typeof views === \"function\") {\r\n                    // custom loading strategy\r\n                    result = views(url);\r\n                }\r\n                else {\r\n                    // predefined hash\r\n                    result = views[url];\r\n                }\r\n                if (typeof result === \"string\") {\r\n                    url = result;\r\n                    result = null;\r\n                }\r\n            }\r\n            if (!result) {\r\n                if (url === \"_hidden\") {\r\n                    result = { hidden: true };\r\n                }\r\n                else if (url === \"_blank\") {\r\n                    result = {};\r\n                }\r\n                else {\r\n                    url = url.replace(/\\./g, \"/\");\r\n                    result = this.require(\"jet-views\", url);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            result = this._loadError(url, e);\r\n        }\r\n        // custom handler can return view or its promise\r\n        if (!result.then) {\r\n            result = Promise.resolve(result);\r\n        }\r\n        // set error handler\r\n        result = result\r\n            .then(module => module.__esModule ? module.default : module)\r\n            .catch(err => this._loadError(url, err));\r\n        return result;\r\n    }\r\n    _forView(target, handler) {\r\n        const view = this.webix.$$(target);\r\n        if (view) {\r\n            handler(view.$scope);\r\n        }\r\n    }\r\n    _loadViewDynamic(url) {\r\n        return null;\r\n    }\r\n    createFromURL(chunk) {\r\n        let view;\r\n        if (chunk.isNew || !chunk.view) {\r\n            view = this.loadView(chunk.page)\r\n                .then(ui => this.createView(ui, name, chunk.params));\r\n        }\r\n        else {\r\n            view = Promise.resolve(chunk.view);\r\n        }\r\n        return view;\r\n    }\r\n    _override(ui) {\r\n        const over = this.config.override;\r\n        if (over) {\r\n            let dv;\r\n            while (ui) {\r\n                dv = ui;\r\n                ui = over.get(ui);\r\n            }\r\n            return dv;\r\n        }\r\n        return ui;\r\n    }\r\n    createView(ui, name, params) {\r\n        ui = this._override(ui);\r\n        let obj;\r\n        if (typeof ui === \"function\") {\r\n            if (ui.prototype instanceof JetAppBase) {\r\n                // UI class\r\n                return new ui({ app: this, name, params, router: SubRouter });\r\n            }\r\n            else if (ui.prototype instanceof JetBase) {\r\n                // UI class\r\n                return new ui(this, { name, params });\r\n            }\r\n            else {\r\n                // UI factory functions\r\n                ui = ui(this);\r\n            }\r\n        }\r\n        if (ui instanceof JetBase) {\r\n            obj = ui;\r\n        }\r\n        else {\r\n            // UI object\r\n            obj = new JetViewRaw(this, { name, ui });\r\n        }\r\n        return obj;\r\n    }\r\n    // show view path\r\n    show(url, config) {\r\n        if (url && this.app && url.indexOf(\"//\") == 0)\r\n            return this.app.show(url.substr(1), config);\r\n        return this.render(this._container, url || this.config.start, config);\r\n    }\r\n    // event helpers\r\n    trigger(name, ...rest) {\r\n        this.apply(name, rest);\r\n    }\r\n    apply(name, data) {\r\n        this.callEvent(name, data);\r\n    }\r\n    action(name) {\r\n        return this.webix.bind(function (...rest) {\r\n            this.apply(name, rest);\r\n        }, this);\r\n    }\r\n    on(name, handler) {\r\n        this.attachEvent(name, handler);\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this, null, config);\r\n    }\r\n    error(name, er) {\r\n        this.callEvent(name, er);\r\n        this.callEvent(\"app:error\", er);\r\n        /* tslint:disable */\r\n        if (this.config.debug) {\r\n            for (var i = 0; i < er.length; i++) {\r\n                console.error(er[i]);\r\n                if (er[i] instanceof Error) {\r\n                    let text = er[i].message;\r\n                    if (text.indexOf(\"Module build failed\") === 0) {\r\n                        text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\r\n                        document.body.innerHTML = `<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${text}</pre>`;\r\n                    }\r\n                    else {\r\n                        text += \"<br><br>Check console for more details\";\r\n                        this.webix.message({ type: \"error\", text: text, expire: -1 });\r\n                    }\r\n                }\r\n            }\r\n            debugger;\r\n        }\r\n        /* tslint:enable */\r\n    }\r\n    // renders top view\r\n    render(root, url, config) {\r\n        this._container = (typeof root === \"string\") ?\r\n            this.webix.toNode(root) :\r\n            (root || document.body);\r\n        const firstInit = !this.$router;\r\n        let path = null;\r\n        if (firstInit) {\r\n            if (_once && \"tagName\" in this._container) {\r\n                this.webix.event(document.body, \"click\", e => this.clickHandler(e));\r\n                _once = false;\r\n            }\r\n            if (typeof url === \"string\") {\r\n                url = new Route(url, 0);\r\n            }\r\n            this._subSegment = this._first_start(url);\r\n            this._subSegment.route.linkRouter = true;\r\n        }\r\n        else {\r\n            if (typeof url === \"string\") {\r\n                path = url;\r\n            }\r\n            else {\r\n                if (this.app) {\r\n                    path = url.split().route.path || this.config.start;\r\n                }\r\n                else {\r\n                    path = url.toString();\r\n                }\r\n            }\r\n        }\r\n        const params = config ? config.params : this.config.params || null;\r\n        const top = this.getSubView();\r\n        const segment = this._subSegment;\r\n        const ready = segment\r\n            .show({ url: path, params }, top)\r\n            .then(() => this.createFromURL(segment.current()))\r\n            .then(view => view.render(root, segment))\r\n            .then(base => {\r\n            this.$router.set(segment.route.path, { silent: true });\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return base;\r\n        });\r\n        this.ready = this.ready.then(() => ready);\r\n        return ready;\r\n    }\r\n    getSubView() {\r\n        if (this._subSegment) {\r\n            const view = this._subSegment.current().view;\r\n            if (view)\r\n                return view;\r\n        }\r\n        return new JetView(this, {});\r\n    }\r\n    require(type, url) { return null; }\r\n    _first_start(route) {\r\n        this._segment = route;\r\n        const cb = (a) => setTimeout(() => {\r\n            this.show(a).catch(e => {\r\n                if (!(e instanceof NavigationBlocked))\r\n                    throw e;\r\n            });\r\n        }, 1);\r\n        this.$router = new (this.config.router)(cb, this.config, this);\r\n        // start animation for top-level app\r\n        if (this._container === document.body && this.config.animation !== false) {\r\n            const node = this._container;\r\n            this.webix.html.addCss(node, \"webixappstart\");\r\n            setTimeout(() => {\r\n                this.webix.html.removeCss(node, \"webixappstart\");\r\n                this.webix.html.addCss(node, \"webixapp\");\r\n            }, 10);\r\n        }\r\n        if (!route) {\r\n            // if no url defined, check router first\r\n            let urlString = this.$router.get();\r\n            if (!urlString) {\r\n                urlString = this.config.start;\r\n                this.$router.set(urlString, { silent: true });\r\n            }\r\n            route = new Route(urlString, 0);\r\n        }\r\n        else if (this.app) {\r\n            const now = route.current().view;\r\n            route.current().view = this;\r\n            if (route.next()) {\r\n                route.refresh();\r\n                route = route.split();\r\n            }\r\n            else {\r\n                route = new Route(this.config.start, 0);\r\n            }\r\n            route.current().view = now;\r\n        }\r\n        return route;\r\n    }\r\n    // error during view resolving\r\n    _loadError(url, err) {\r\n        this.error(\"app:error:resolve\", [err, url]);\r\n        return { template: \" \" };\r\n    }\r\n    addSubView(obj, target, config) {\r\n        const url = obj.$subview !== true ? obj.$subview : null;\r\n        const name = obj.name || (url ? this.webix.uid() : \"default\");\r\n        target.id = obj.id || \"s\" + this.webix.uid();\r\n        const view = config[name] = {\r\n            id: target.id,\r\n            url,\r\n            branch: obj.branch,\r\n            popup: obj.popup,\r\n            params: obj.params\r\n        };\r\n        return view.popup ? null : target;\r\n    }\r\n}\n\nclass HashRouter {\r\n    constructor(cb, config) {\r\n        this.config = config || {};\r\n        this._detectPrefix();\r\n        this.cb = cb;\r\n        window.onpopstate = () => this.cb(this.get());\r\n    }\r\n    set(path, config) {\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            for (const key in this.config.routes) {\r\n                if (this.config.routes[key] === compare[0]) {\r\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this.get() !== path) {\r\n            window.history.pushState(null, null, this.prefix + this.sufix + path);\r\n        }\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        let path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\r\n        path = (path !== \"/\" && path !== \"#\") ? path : \"\";\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            const key = this.config.routes[compare[0]];\r\n            if (key) {\r\n                path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n            }\r\n        }\r\n        return path;\r\n    }\r\n    _detectPrefix() {\r\n        // use \"#!\" for backward compatibility\r\n        const sufix = this.config.routerPrefix;\r\n        this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\r\n        this.prefix = document.location.href.split(\"#\", 2)[0];\r\n    }\r\n    _getRaw() {\r\n        return document.location.href;\r\n    }\r\n}\n\nlet isPatched = false;\r\nfunction patch(w) {\r\n    if (isPatched || !w) {\r\n        return;\r\n    }\r\n    isPatched = true;\r\n    // custom promise for IE8\r\n    const win = window;\r\n    if (!win.Promise) {\r\n        win.Promise = w.promise;\r\n    }\r\n    const version = w.version.split(\".\");\r\n    // will be fixed in webix 5.3\r\n    if (version[0] * 10 + version[1] * 1 < 53) {\r\n        w.ui.freeze = function (handler) {\r\n            // disabled because webix jet 5.0 can't handle resize of scrollview correctly\r\n            // w.ui.$freeze = true;\r\n            const res = handler();\r\n            if (res && res.then) {\r\n                res.then(function (some) {\r\n                    w.ui.$freeze = false;\r\n                    w.ui.resize();\r\n                    return some;\r\n                });\r\n            }\r\n            else {\r\n                w.ui.$freeze = false;\r\n                w.ui.resize();\r\n            }\r\n            return res;\r\n        };\r\n    }\r\n    // adding views as classes\r\n    const baseAdd = w.ui.baselayout.prototype.addView;\r\n    const baseRemove = w.ui.baselayout.prototype.removeView;\r\n    const config = {\r\n        addView(view, index) {\r\n            // trigger logic only for widgets inside of jet-view\r\n            // ignore case when addView used with already initialized widget\r\n            if (this.$scope && this.$scope.webixJet && !view.queryView) {\r\n                const jview = this.$scope;\r\n                const subs = {};\r\n                view = jview.app.copyConfig(view, {}, subs);\r\n                baseAdd.apply(this, [view, index]);\r\n                for (const key in subs) {\r\n                    jview._renderFrame(key, subs[key], null).then(() => {\r\n                        jview._subs[key] = subs[key];\r\n                    });\r\n                }\r\n                return view.id;\r\n            }\r\n            else {\r\n                return baseAdd.apply(this, arguments);\r\n            }\r\n        },\r\n        removeView() {\r\n            baseRemove.apply(this, arguments);\r\n            if (this.$scope && this.$scope.webixJet) {\r\n                const subs = this.$scope._subs;\r\n                // check all sub-views, destroy and clean the removed one\r\n                for (const key in subs) {\r\n                    const test = subs[key];\r\n                    if (!w.$$(test.id)) {\r\n                        test.view.destructor();\r\n                        delete subs[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    w.extend(w.ui.layout.prototype, config, true);\r\n    w.extend(w.ui.baselayout.prototype, config, true);\r\n    // wrapper for using Jet Apps as views\r\n    w.protoUI({\r\n        name: \"jetapp\",\r\n        $init(cfg) {\r\n            this.$app = new this.app(cfg);\r\n            const id = w.uid().toString();\r\n            cfg.body = { id };\r\n            this.$ready.push(function () {\r\n                this.callEvent(\"onInit\", [this.$app]);\r\n                this.$app.render({ id });\r\n            });\r\n        }\r\n    }, w.ui.proxy, w.EventSystem);\r\n}\n\nclass JetApp extends JetAppBase {\r\n    constructor(config) {\r\n        config.router = config.router || HashRouter;\r\n        super(config);\r\n        patch(this.webix);\r\n    }\r\n    require(type, url) {\r\n        return require(type + \"/\" + url);\r\n    }\r\n}\n\nclass StoreRouter {\r\n    constructor(cb, config, app) {\r\n        this.storage = config.storage || app.webix.storage.session;\r\n        this.name = (config.storeName || config.id + \":route\");\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.storage.put(this.name, path);\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.storage.get(this.name);\r\n    }\r\n}\n\nclass UrlRouter extends HashRouter {\r\n    _detectPrefix() {\r\n        this.prefix = \"\";\r\n        this.sufix = this.config.routerPrefix || \"\";\r\n    }\r\n    _getRaw() {\r\n        return document.location.pathname + (document.location.search || \"\");\r\n    }\r\n}\n\nclass EmptyRouter {\r\n    constructor(cb, _$config) {\r\n        this.path = \"\";\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nfunction UnloadGuard(app, view, config) {\r\n    view.on(app, `app:guard`, function (_$url, point, promise) {\r\n        if (point === view || point.contains(view)) {\r\n            const res = config();\r\n            if (res === false) {\r\n                promise.confirm = Promise.reject(new NavigationBlocked());\r\n            }\r\n            else {\r\n                promise.confirm = promise.confirm.then(() => res);\r\n            }\r\n        }\r\n    });\r\n}\n\n//     (c) 2012-2018 Airbnb, Inc.\n\n// var has = require('has');\nfunction has(store, key) {\n  return Object.prototype.hasOwnProperty.call(store, key);\n}\n// var forEach = require('for-each');\nfunction forEach(obj, handler, context) {\n  for (var key in obj) {\n    if (has(obj, key)) {\n      handler.call((context || obj), obj[key], key, obj);\n    }\n  }\n}\n// var trim = require('string.prototype.trim');\nfunction trim(str) {\n  return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n}\n// var warning = require('warning');\nfunction warn(message) {\n  message = 'Warning: ' + message;\n  if (typeof console !== 'undefined') {\n    console.error(message);\n  }\n\n  try { throw new Error(message); } catch (x) {}\n}\n\nvar replace = String.prototype.replace;\nvar split = String.prototype.split;\n\n// #### Pluralization methods\n// The string that separates the different phrase possibilities.\nvar delimiter = '||||';\n\nvar russianPluralGroups = function (n) {\n  var end = n % 10;\n  if (n !== 11 && end === 1) {\n    return 0;\n  }\n  if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n    return 1;\n  }\n  return 2;\n};\n\n// Mapping from pluralization group plural logic.\nvar pluralTypes = {\n  arabic: function (n) {\n    // http://www.arabeyes.org/Plural_Forms\n    if (n < 3) { return n; }\n    var lastTwo = n % 100;\n    if (lastTwo >= 3 && lastTwo <= 10) return 3;\n    return lastTwo >= 11 ? 4 : 5;\n  },\n  bosnian_serbian: russianPluralGroups,\n  chinese: function () { return 0; },\n  croatian: russianPluralGroups,\n  french: function (n) { return n > 1 ? 1 : 0; },\n  german: function (n) { return n !== 1 ? 1 : 0; },\n  russian: russianPluralGroups,\n  lithuanian: function (n) {\n    if (n % 10 === 1 && n % 100 !== 11) { return 0; }\n    return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n  },\n  czech: function (n) {\n    if (n === 1) { return 0; }\n    return (n >= 2 && n <= 4) ? 1 : 2;\n  },\n  polish: function (n) {\n    if (n === 1) { return 0; }\n    var end = n % 10;\n    return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n  },\n  icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n  slovenian: function (n) {\n    var lastTwo = n % 100;\n    if (lastTwo === 1) {\n      return 0;\n    }\n    if (lastTwo === 2) {\n      return 1;\n    }\n    if (lastTwo === 3 || lastTwo === 4) {\n      return 2;\n    }\n    return 3;\n  }\n};\n\n\n// Mapping from pluralization group to individual language codes/locales.\n// Will look up based on exact match, if not found and it's a locale will parse the locale\n// for language code, and if that does not exist will default to 'en'\nvar pluralTypeToLanguages = {\n  arabic: ['ar'],\n  bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n  chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n  croatian: ['hr', 'hr-HR'],\n  german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n  french: ['fr', 'tl', 'pt-br'],\n  russian: ['ru', 'ru-RU'],\n  lithuanian: ['lt'],\n  czech: ['cs', 'cs-CZ', 'sk'],\n  polish: ['pl'],\n  icelandic: ['is'],\n  slovenian: ['sl-SL']\n};\n\nfunction langToTypeMap(mapping) {\n  var ret = {};\n  forEach(mapping, function (langs, type) {\n    forEach(langs, function (lang) {\n      ret[lang] = type;\n    });\n  });\n  return ret;\n}\n\nfunction pluralTypeName(locale) {\n  var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n  return langToPluralType[locale]\n    || langToPluralType[split.call(locale, /-/, 1)[0]]\n    || langToPluralType.en;\n}\n\nfunction pluralTypeIndex(locale, count) {\n  return pluralTypes[pluralTypeName(locale)](count);\n}\n\nfunction escape(token) {\n  return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction constructTokenRegex(opts) {\n  var prefix = (opts && opts.prefix) || '%{';\n  var suffix = (opts && opts.suffix) || '}';\n\n  if (prefix === delimiter || suffix === delimiter) {\n    throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n  }\n\n  return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n}\n\nvar dollarRegex = /\\$/g;\nvar dollarBillsYall = '$$';\nvar defaultTokenRegex = /%\\{(.*?)\\}/g;\n\n// ### transformPhrase(phrase, substitutions, locale)\n//\n// Takes a phrase string and transforms it by choosing the correct\n// plural form and interpolating it.\n//\n//     transformPhrase('Hello, %{name}!', {name: 'Spike'});\n//     // \"Hello, Spike!\"\n//\n// The correct plural form is selected if substitutions.smart_count\n// is set. You can pass in a number instead of an Object as `substitutions`\n// as a shortcut for `smart_count`.\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 1}, 'en');\n//     // \"1 new message\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 2}, 'en');\n//     // \"2 new messages\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', 5, 'en');\n//     // \"5 new messages\"\n//\n// You should pass in a third argument, the locale, to specify the correct plural type.\n// It defaults to `'en'` with 2 plural forms.\nfunction transformPhrase(phrase, substitutions, locale, tokenRegex) {\n  if (typeof phrase !== 'string') {\n    throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n  }\n\n  if (substitutions == null) {\n    return phrase;\n  }\n\n  var result = phrase;\n  var interpolationRegex = tokenRegex || defaultTokenRegex;\n\n  // allow number as a pluralization shortcut\n  var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n\n  // Select plural form: based on a phrase text that contains `n`\n  // plural forms separated by `delimiter`, a `locale`, and a `substitutions.smart_count`,\n  // choose the correct plural form. This is only done if `count` is set.\n  if (options.smart_count != null && result) {\n    var texts = split.call(result, delimiter);\n    result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n  }\n\n  // Interpolate: Creates a `RegExp` object for each interpolation placeholder.\n  result = replace.call(result, interpolationRegex, function (expression, argument) {\n    if (!has(options, argument) || options[argument] == null) { return expression; }\n    // Ensure replacement value is escaped to prevent special $-prefixed regex replace tokens.\n    return replace.call(options[argument], dollarRegex, dollarBillsYall);\n  });\n\n  return result;\n}\n\n// ### Polyglot class constructor\nfunction Polyglot(options) {\n  var opts = options || {};\n  this.phrases = {};\n  this.extend(opts.phrases || {});\n  this.currentLocale = opts.locale || 'en';\n  var allowMissing = opts.allowMissing ? transformPhrase : null;\n  this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n  this.warn = opts.warn || warn;\n  this.tokenRegex = constructTokenRegex(opts.interpolation);\n}\n\n// ### polyglot.locale([locale])\n//\n// Get or set locale. Internally, Polyglot only uses locale for pluralization.\nPolyglot.prototype.locale = function (newLocale) {\n  if (newLocale) this.currentLocale = newLocale;\n  return this.currentLocale;\n};\n\n// ### polyglot.extend(phrases)\n//\n// Use `extend` to tell Polyglot how to translate a given key.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The key can be any string.  Feel free to call `extend` multiple times;\n// it will override any phrases with the same key, but leave existing phrases\n// untouched.\n//\n// It is also possible to pass nested phrase objects, which get flattened\n// into an object with the nested keys concatenated using dot notation.\n//\n//     polyglot.extend({\n//       \"nav\": {\n//         \"hello\": \"Hello\",\n//         \"hello_name\": \"Hello, %{name}\",\n//         \"sidebar\": {\n//           \"welcome\": \"Welcome\"\n//         }\n//       }\n//     });\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}',\n//     //   'nav.sidebar.welcome': 'Welcome'\n//     // }\n//\n// `extend` accepts an optional second argument, `prefix`, which can be used\n// to prefix every key in the phrases object with some string, using dot\n// notation.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     }, \"nav\");\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}'\n//     // }\n//\n// This feature is used internally to support nested phrase objects.\nPolyglot.prototype.extend = function (morePhrases, prefix) {\n  forEach(morePhrases, function (phrase, key) {\n    var prefixedKey = prefix ? prefix + '.' + key : key;\n    if (typeof phrase === 'object') {\n      this.extend(phrase, prefixedKey);\n    } else {\n      this.phrases[prefixedKey] = phrase;\n    }\n  }, this);\n};\n\n// ### polyglot.unset(phrases)\n// Use `unset` to selectively remove keys from a polyglot instance.\n//\n//     polyglot.unset(\"some_key\");\n//     polyglot.unset({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The unset method can take either a string (for the key), or an object hash with\n// the keys that you would like to unset.\nPolyglot.prototype.unset = function (morePhrases, prefix) {\n  if (typeof morePhrases === 'string') {\n    delete this.phrases[morePhrases];\n  } else {\n    forEach(morePhrases, function (phrase, key) {\n      var prefixedKey = prefix ? prefix + '.' + key : key;\n      if (typeof phrase === 'object') {\n        this.unset(phrase, prefixedKey);\n      } else {\n        delete this.phrases[prefixedKey];\n      }\n    }, this);\n  }\n};\n\n// ### polyglot.clear()\n//\n// Clears all phrases. Useful for special cases, such as freeing\n// up memory if you have lots of phrases but no longer need to\n// perform any translation. Also used internally by `replace`.\nPolyglot.prototype.clear = function () {\n  this.phrases = {};\n};\n\n// ### polyglot.replace(phrases)\n//\n// Completely replace the existing phrases with a new set of phrases.\n// Normally, just use `extend` to add more phrases, but under certain\n// circumstances, you may want to make sure no old phrases are lying around.\nPolyglot.prototype.replace = function (newPhrases) {\n  this.clear();\n  this.extend(newPhrases);\n};\n\n\n// ### polyglot.t(key, options)\n//\n// The most-used method. Provide a key, and `t` will return the\n// phrase.\n//\n//     polyglot.t(\"hello\");\n//     => \"Hello\"\n//\n// The phrase value is provided first by a call to `polyglot.extend()` or\n// `polyglot.replace()`.\n//\n// Pass in an object as the second argument to perform interpolation.\n//\n//     polyglot.t(\"hello_name\", {name: \"Spike\"});\n//     => \"Hello, Spike\"\n//\n// If you like, you can provide a default value in case the phrase is missing.\n// Use the special option key \"_\" to specify a default.\n//\n//     polyglot.t(\"i_like_to_write_in_language\", {\n//       _: \"I like to write in %{language}.\",\n//       language: \"JavaScript\"\n//     });\n//     => \"I like to write in JavaScript.\"\n//\nPolyglot.prototype.t = function (key, options) {\n  var phrase, result;\n  var opts = options == null ? {} : options;\n  if (typeof this.phrases[key] === 'string') {\n    phrase = this.phrases[key];\n  } else if (typeof opts._ === 'string') {\n    phrase = opts._;\n  } else if (this.onMissingKey) {\n    var onMissingKey = this.onMissingKey;\n    result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n  } else {\n    this.warn('Missing translation for key: \"' + key + '\"');\n    result = key;\n  }\n  if (typeof phrase === 'string') {\n    result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n  }\n  return result;\n};\n\n\n// ### polyglot.has(key)\n//\n// Check if polyglot has a translation for given key\nPolyglot.prototype.has = function (key) {\n  return has(this.phrases, key);\n};\n\n// export transformPhrase\nPolyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n  return transformPhrase(phrase, substitutions, locale);\n};\n\nvar webixPolyglot = Polyglot;\n\nfunction Locale(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\r\n    function setLangData(name, data, silent) {\r\n        if (data.__esModule) {\r\n            data = data.default;\r\n        }\r\n        const pconfig = { phrases: data };\r\n        if (config.polyglot) {\r\n            app.webix.extend(pconfig, config.polyglot);\r\n        }\r\n        const poly = service.polyglot = new webixPolyglot(pconfig);\r\n        poly.locale(name);\r\n        service._ = app.webix.bind(poly.t, poly);\r\n        lang = name;\r\n        if (storage) {\r\n            storage.put(\"lang\", lang);\r\n        }\r\n        if (config.webix) {\r\n            const locName = config.webix[name];\r\n            if (locName) {\r\n                app.webix.i18n.setLocale(locName);\r\n            }\r\n        }\r\n        if (!silent) {\r\n            return app.refresh();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    function getLang() { return lang; }\r\n    function setLang(name, silent) {\r\n        // ignore setLang if loading by path is disabled\r\n        if (config.path === false) {\r\n            return;\r\n        }\r\n        const path = (config.path ? config.path + \"/\" : \"\") + name;\r\n        const data = app.require(\"jet-locales\", path);\r\n        setLangData(name, data, silent);\r\n    }\r\n    const service = {\r\n        getLang, setLang, setLangData, _: null, polyglot: null\r\n    };\r\n    app.setService(\"locale\", service);\r\n    setLang(lang, true);\r\n}\n\nfunction show(view, config, value) {\r\n    if (config.urls) {\r\n        value = config.urls[value] || value;\r\n    }\r\n    else if (config.param) {\r\n        value = { [config.param]: value };\r\n    }\r\n    view.show(value);\r\n}\r\nfunction Menu(app, view, config) {\r\n    const frame = view.getSubViewInfo().parent;\r\n    const ui = view.$$(config.id || config);\r\n    let silent = false;\r\n    ui.attachEvent(\"onchange\", function () {\r\n        if (!silent) {\r\n            show(frame, config, this.getValue());\r\n        }\r\n    });\r\n    ui.attachEvent(\"onafterselect\", function () {\r\n        if (!silent) {\r\n            let id = null;\r\n            if (ui.setValue) {\r\n                id = this.getValue();\r\n            }\r\n            else if (ui.getSelectedId) {\r\n                id = ui.getSelectedId();\r\n            }\r\n            show(frame, config, id);\r\n        }\r\n    });\r\n    view.on(app, `app:route`, function () {\r\n        let name = \"\";\r\n        if (config.param) {\r\n            name = view.getParam(config.param, true);\r\n        }\r\n        else {\r\n            const segment = frame.getUrl()[1];\r\n            if (segment) {\r\n                name = segment.page;\r\n            }\r\n        }\r\n        if (name) {\r\n            silent = true;\r\n            if (ui.setValue && ui.getValue() !== name) {\r\n                ui.setValue(name);\r\n            }\r\n            else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\r\n                ui.select(name);\r\n            }\r\n            silent = false;\r\n        }\r\n    });\r\n}\n\nconst baseicons = {\r\n    good: \"check\",\r\n    error: \"warning\",\r\n    saving: \"refresh fa-spin\"\r\n};\r\nconst basetext = {\r\n    good: \"Ok\",\r\n    error: \"Error\",\r\n    saving: \"Connecting...\"\r\n};\r\nfunction Status(app, view, config) {\r\n    let status = \"good\";\r\n    let count = 0;\r\n    let iserror = false;\r\n    let expireDelay = config.expire;\r\n    if (!expireDelay && expireDelay !== false) {\r\n        expireDelay = 2000;\r\n    }\r\n    const texts = config.texts || basetext;\r\n    const icons = config.icons || baseicons;\r\n    if (typeof config === \"string\") {\r\n        config = { target: config };\r\n    }\r\n    function refresh(content) {\r\n        const area = view.$$(config.target);\r\n        if (area) {\r\n            if (!content) {\r\n                content = \"<div class='status_\" +\r\n                    status +\r\n                    \"'><span class='webix_icon fa-\" +\r\n                    icons[status] + \"'></span> \" + texts[status] + \"</div>\";\r\n            }\r\n            area.setHTML(content);\r\n        }\r\n    }\r\n    function success() {\r\n        count--;\r\n        setStatus(\"good\");\r\n    }\r\n    function fail(err) {\r\n        count--;\r\n        setStatus(\"error\", err);\r\n    }\r\n    function start(promise) {\r\n        count++;\r\n        setStatus(\"saving\");\r\n        if (promise && promise.then) {\r\n            promise.then(success, fail);\r\n        }\r\n    }\r\n    function getStatus() {\r\n        return status;\r\n    }\r\n    function hideStatus() {\r\n        if (count === 0) {\r\n            refresh(\" \");\r\n        }\r\n    }\r\n    function setStatus(mode, err) {\r\n        if (count < 0) {\r\n            count = 0;\r\n        }\r\n        if (mode === \"saving\") {\r\n            status = \"saving\";\r\n            refresh();\r\n        }\r\n        else {\r\n            iserror = (mode === \"error\");\r\n            if (count === 0) {\r\n                status = iserror ? \"error\" : \"good\";\r\n                if (iserror) {\r\n                    app.error(\"app:error:server\", [err.responseText || err]);\r\n                }\r\n                else {\r\n                    if (expireDelay) {\r\n                        setTimeout(hideStatus, expireDelay);\r\n                    }\r\n                }\r\n                refresh();\r\n            }\r\n        }\r\n    }\r\n    function track(data) {\r\n        const dp = app.webix.dp(data);\r\n        if (dp) {\r\n            view.on(dp, \"onAfterDataSend\", start);\r\n            view.on(dp, \"onAfterSaveError\", (_id, _obj, response) => fail(response));\r\n            view.on(dp, \"onAfterSave\", success);\r\n        }\r\n    }\r\n    app.setService(\"status\", {\r\n        getStatus,\r\n        setStatus,\r\n        track\r\n    });\r\n    if (config.remote) {\r\n        view.on(app.webix, \"onRemoteCall\", start);\r\n    }\r\n    if (config.ajax) {\r\n        view.on(app.webix, \"onBeforeAjax\", (_mode, _url, _data, _request, _headers, _files, promise) => {\r\n            start(promise);\r\n        });\r\n    }\r\n    if (config.data) {\r\n        track(config.data);\r\n    }\r\n}\n\nfunction Theme(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let theme = storage ?\r\n        (storage.get(\"theme\") || \"flat-default\")\r\n        :\r\n            (config.theme || \"flat-default\");\r\n    const service = {\r\n        getTheme() { return theme; },\r\n        setTheme(name, silent) {\r\n            const parts = name.split(\"-\");\r\n            const links = document.getElementsByTagName(\"link\");\r\n            for (let i = 0; i < links.length; i++) {\r\n                const lname = links[i].getAttribute(\"title\");\r\n                if (lname) {\r\n                    if (lname === name || lname === parts[0]) {\r\n                        links[i].disabled = false;\r\n                    }\r\n                    else {\r\n                        links[i].disabled = true;\r\n                    }\r\n                }\r\n            }\r\n            app.webix.skin.set(parts[0]);\r\n            // remove old css\r\n            app.webix.html.removeCss(document.body, \"theme-\" + theme);\r\n            // add new css\r\n            app.webix.html.addCss(document.body, \"theme-\" + name);\r\n            theme = name;\r\n            if (storage) {\r\n                storage.put(\"theme\", name);\r\n            }\r\n            if (!silent) {\r\n                app.refresh();\r\n            }\r\n        }\r\n    };\r\n    app.setService(\"theme\", service);\r\n    service.setTheme(theme, true);\r\n}\n\nfunction copyParams(data, url, route) {\r\n    for (let i = 0; i < route.length; i++) {\r\n        data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\r\n    }\r\n}\r\nfunction UrlParam(app, view, config) {\r\n    const route = config.route || config;\r\n    const data = {};\r\n    view.on(app, \"app:urlchange\", function (subview, segment) {\r\n        if (view === subview) {\r\n            copyParams(data, segment.suburl(), route);\r\n            segment.size(route.length + 1);\r\n        }\r\n    });\r\n    const os = view.setParam;\r\n    const og = view.getParam;\r\n    view.setParam = function (name, value, show) {\r\n        const index = route.indexOf(name);\r\n        if (index >= 0) {\r\n            data[name] = value;\r\n            this._segment.update(\"\", value, index + 1);\r\n            if (show) {\r\n                return view.show(null);\r\n            }\r\n        }\r\n        else {\r\n            return os.call(this, name, value, show);\r\n        }\r\n    };\r\n    view.getParam = function (key, mode) {\r\n        const val = data[key];\r\n        if (typeof val !== \"undefined\") {\r\n            return val;\r\n        }\r\n        return og.call(this, key, mode);\r\n    };\r\n    copyParams(data, view.getUrl(), route);\r\n}\n\nfunction User(app, _view, config) {\r\n    config = config || {};\r\n    const login = config.login || \"/login\";\r\n    const logout = config.logout || \"/logout\";\r\n    const afterLogin = config.afterLogin || app.config.start;\r\n    const afterLogout = config.afterLogout || \"/login\";\r\n    const ping = config.ping || 5 * 60 * 1000;\r\n    const model = config.model;\r\n    let user = config.user;\r\n    const service = {\r\n        getUser() {\r\n            return user;\r\n        },\r\n        getStatus(server) {\r\n            if (!server) {\r\n                return user !== null;\r\n            }\r\n            return model.status().catch(() => null).then(data => {\r\n                user = data;\r\n            });\r\n        },\r\n        login(name, pass) {\r\n            return model.login(name, pass).then(data => {\r\n                user = data;\r\n                if (!data) {\r\n                    throw new Error(\"Access denied\");\r\n                }\r\n                app.callEvent(\"app:user:login\", [user]);\r\n                app.show(afterLogin);\r\n            });\r\n        },\r\n        logout() {\r\n            user = null;\r\n            return model.logout().then(res => {\r\n                app.callEvent(\"app:user:logout\", []);\r\n                return res;\r\n            });\r\n        }\r\n    };\r\n    function canNavigate(url, obj) {\r\n        if (url === logout) {\r\n            service.logout();\r\n            obj.redirect = afterLogout;\r\n        }\r\n        else if (url !== login && !service.getStatus()) {\r\n            obj.redirect = login;\r\n        }\r\n    }\r\n    app.setService(\"user\", service);\r\n    app.attachEvent(`app:guard`, function (url, _$root, obj) {\r\n        if (config.public && config.public(url)) {\r\n            return true;\r\n        }\r\n        if (typeof user === \"undefined\") {\r\n            obj.confirm = service.getStatus(true).then(() => canNavigate(url, obj));\r\n        }\r\n        return canNavigate(url, obj);\r\n    });\r\n    if (ping) {\r\n        setInterval(() => service.getStatus(true), ping);\r\n    }\r\n}\n\n/*\r\nMIT License\r\nCopyright (c) 2019 XB Software\r\n*/\r\nlet webix = window.webix;\r\nif (webix) {\r\n    patch(webix);\r\n}\r\nconst plugins = {\r\n    UnloadGuard, Locale, Menu, Theme, User, Status, UrlParam\r\n};\r\nconst errors = { NavigationBlocked };\r\nconst w = window;\r\nif (!w.Promise) {\r\n    w.Promise = w.webix.promise;\r\n}\n\nexport { plugins, errors, JetApp, JetView, HashRouter, StoreRouter, UrlRouter, EmptyRouter, SubRouter };\n//# sourceMappingURL=jet.js.map\n","let once = false;\n\nexport function initRLayout(){\n    if (once) return;\n    once = true;\n\n    webix.protoUI(\n        {\n            name: \"r-layout\",\n            sizeTrigger(app, handler, value) {\n                this._compactValue = value;\n                this._compactHandler = handler;\n                this._app = app;\n\n                const config = app.config;\n                this._forceCompact = typeof config.params.forceCompact !== \"undefined\";\n                this._compactWidth = config.compactWidth;\n\n                if (!this._forceCompact) this._checkTrigger(this.$view.width, value);\n            },\n            _checkTrigger(x, value) {\n                if (this._compactWidth) {\n                    if (\n                        (x <= this._compactWidth && !value) ||\n                        (x > this._compactWidth && value)\n                    ) {\n                        this._compactWidth = null;\n                        this._compactHandler(!value);\n                        return false;\n                    }\n                }\n                return true;\n            },\n            $setSize(x, y) {\n                if (this._forceCompact || this._checkTrigger(x, this._compactValue))\n                    webix.ui.layout.prototype.$setSize.call(this, x, y);\n                if (this._app) this._app.callEvent(\"view:resize\", []); //edit popup resize\n            },\n        },\n        webix.ui.layout\n    );\n}\n","export function initJetWin(app) {\n\tlet appId;\n\n\tconst service = {\n\t\tupdateConfig(config){\n\t\t\tconst appView = app.getRoot();\n\t\t\tconst appNode = appView.$view;\n\n\t\t\tif(!appId){\n\t\t\t\tif(appNode.id)\n\t\t\t\t\tappId = appNode.id;\n\t\t\t\telse \n\t\t\t\t\tappNode.id = appId = \"webix_\" + webix.uid();\n\n\t\t\t\twebix.html.addStyle(`.webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }`);\n\t\t\t\twebix.html.addStyle(`#${appId}{ position: relative; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_window{ z-index:2 !important; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_disabled{ z-index:1 !important; }`);\n\t\t\t}\n\t\t\telse if(appId && !appNode.id) //app refresh\n\t\t\t\tappNode.id = appId;\n\n\t\t\tconfig.container = appId;\n\n\t\t\tif(config.fullscreen){\n\t\t\t\tconfig._fillApp = true;\n\t\t\t\tdelete config.fullscreen;\n\t\t\t}\n\n\t\t\tif(!config.on)\n\t\t\t\tconfig.on = {};\n\n\t\t\tlet firstShow = true;\n\t\t\tconst defaultHandler = config.on.onShow;\n\n\t\t\tconfig.on.onShow = function(){\n\t\t\t\tif(defaultHandler)\n\t\t\t\t\tdefaultHandler.apply(this, arguments);\n\n\t\t\t\tif(firstShow){\n\t\t\t\t\tthis.$setSize = (x, y) => {\n\t\t\t\t\t\tsetSize(this, appView, true);\n\t\t\t\t\t\twebix.ui.window.prototype.$setSize.apply(this, [x, y]);\n\t\t\t\t\t};\n\t\t\t\t\tsetHandlers(this, app);\n\t\t\t\t\tfirstShow = null;\n\t\t\t\t}\n\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\twebix.html.addCss(appNode, \"webix_win_inside\");\n\t\t\t\tappView.disable();\n\n\t\t\t\tsetSize(this, appView);\n\t\t\t}\n\n\t\t\treturn config;\n\t\t}\n\t};\n\n\tapp.setService(\"jet-win\", service);\n}\n\nfunction setSize(win, appView, silent){\n\tconst appWidth = appView.$width;\n\tconst appHeight = appView.$height;\n\n\tif(win.config._fillApp)\n\t\twin.define({\n\t\t\twidth: appWidth,\n\t\t\theight: appHeight,\n\t\t});\n\telse {\n\t\twin.define({\n\t\t\tleft: (appWidth - win.$width) / 2,\n\t\t\ttop: (appHeight - win.$height) / 2,\n\t\t});\n\t}\n\n\tif(!silent)\n\t\twin.resize();\n}\n\nfunction setHandlers(win, app){\n\tconst appView = app.getRoot();\n\n\twin.attachEvent(\"onHide\", ()=> {\n\t\tif(!appView.$destructed){\n\t\t\twebix.html.removeCss(appView.$view, \"webix_win_inside\");\n\t\t\tappView.enable();\n\t\t}\n\t});\n\n\tconst resizeEv = app.attachEvent(\"view:resize\", ()=> {\n\t\tsetSize(win, appView);\n\t});\n\n\twin.attachEvent(\"onDestruct\", ()=> {\n\t\tapp.detachEvent(resizeEv);\n\t});\n}\n","var index = 1;\nfunction uid() {\n\treturn index++;\n}\n\nvar empty = undefined;\n\nexport function ignoreInitial(code) {\n\tlet init = false;\n\treturn function() {\n\t\tif (init) return code.apply(this, arguments);\n\t\telse init = true;\n\t};\n}\n\nvar context = null;\nexport function withContext(value, code) {\n\tcontext = value;\n\tcode();\n\tcontext = null;\n}\n\nexport function filter(rule, handler) {\n\treturn function(v, o, obj, meta) {\n\t\tif (rule(v, meta)) handler.apply(this, arguments);\n\t};\n}\n\nexport function link(source, target, key) {\n\tObject.defineProperty(target, key, {\n\t\tget: () => source[key],\n\t\tset: value => (source[key] = value),\n\t});\n}\n\nexport function debounce(handler, delay) {\n\tdelay = delay || 200;\n\tlet timer = null;\n\tlet data = null;\n\treturn function() {\n\t\tdata = arguments;\n\t\tif (!timer) {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = null;\n\n\t\t\t\thandler.apply(this, data);\n\t\t\t}, delay);\n\t\t}\n\t};\n}\n\nexport function createState(data, config) {\n\tconfig = config || {};\n\tconst handlers = {};\n\tconst out = {};\n\n\tconst observe = function(mask, handler) {\n\t\tconst key = uid();\n\t\thandlers[key] = { mask, handler };\n\t\tif (mask === \"*\") handler(out, empty, mask);\n\t\telse handler(out[mask], empty, mask);\n\n\t\treturn key;\n\t};\n\n\tconst extend = function(data, sconfig){\n\t\tsconfig = sconfig || config;\n\t\t// normal js object\n\t\tfor (const key in data) {\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tconst test = data[key];\n\t\t\t\tif (sconfig.nested && typeof test === \"object\" && test) {\n\t\t\t\t\tout[key] = createState(test, sconfig);\n\t\t\t\t} else {\n\t\t\t\t\treactive(out, test, key, notify);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst observeEnd = function(id) {\n\t\tdelete handlers[id];\n\t};\n\n\tconst queue = [];\n\tlet waitInQueue = false;\n\n\tvar batch = function(code) {\n\t\tif (typeof code !== \"function\") {\n\t\t\tconst values = code;\n\t\t\tcode = () => {\n\t\t\t\tfor (const key in values) out[key] = values[key];\n\t\t\t};\n\t\t}\n\n\t\twaitInQueue = true;\n\t\tcode(out);\n\t\twaitInQueue = false;\n\t\twhile (queue.length) {\n\t\t\tconst obj = queue.shift();\n\t\t\tnotify.apply(this, obj);\n\t\t}\n\t};\n\n\tconst notify = function(key, old, value, meta) {\n\t\tif (waitInQueue) {\n\t\t\tqueue.push([key, old, value, meta]);\n\t\t\treturn;\n\t\t}\n\n\t\tconst list = Object.keys(handlers);\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\tconst obj = handlers[list[i]];\n\t\t\tif (!obj) continue;\n\t\t\tif (obj.mask === \"*\" || obj.mask === key) {\n\t\t\t\tobj.handler(value, old, key, meta);\n\t\t\t}\n\t\t}\n\t};\n\n\tObject.defineProperty(out, \"$changes\", {\n\t\tvalue: {\n\t\t\tattachEvent: observe,\n\t\t\tdetachEvent: observeEnd,\n\t\t},\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$observe\", {\n\t\tvalue: observe,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$batch\", {\n\t\tvalue: batch,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$extend\", {\n\t\tvalue: extend,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\n\tout.$extend(data, config);\n\treturn out;\n}\n\nfunction reactive(obj, val, key, notify) {\n\tObject.defineProperty(obj, key, {\n\t\tget: function() {\n\t\t\treturn val;\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar changed = false;\n\t\t\tif (val === null || value === null) {\n\t\t\t\tchanged = val !== value;\n\t\t\t} else {\n\t\t\t\tchanged = val.valueOf() != value.valueOf();\n\t\t\t}\n\n\t\t\tif (changed) {\n\t\t\t\tvar old = val;\n\t\t\t\tval = value;\n\t\t\t\tnotify(key, old, value, context);\n\t\t\t}\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t});\n}","function updateDragPos(e, pos) {\n\tif (webix.DragControl.active) {\n\t\tconst node = webix.DragControl.getNode();\n\n\t\tpos = webix.copy(pos);\n\t\twebix.DragControl.$dragPos(pos, e);\n\n\t\tnode.style.top = pos.y + webix.DragControl.top + \"px\";\n\t\tnode.style.left = pos.x + webix.DragControl.left + \"px\";\n\t}\n}\n\nconst DragScroll = {\n\tstart(ctx, e) {\n\t\tctx._auto_scroll_delay = webix.delay(\n\t\t\tDragScroll.autoScroll,\n\t\t\tctx,\n\t\t\t[e, webix.html.pos(e)],\n\t\t\t250\n\t\t);\n\t},\n\n\treset(ctx) {\n\t\tif (ctx._auto_scroll_delay)\n\t\t\tctx._auto_scroll_delay = window.clearTimeout(ctx._auto_scroll_delay);\n\t},\n\n\tautoScroll(e, pos) {\n\t\tconst yScroll = this.direction.indexOf(\"y\") !== -1;\n\t\tconst xScroll = this.direction.indexOf(\"x\") !== -1;\n\t\tconst box = webix.html.offset(this.from.$view);\n\n\t\tlet reset = false;\n\t\tif (yScroll && DragScroll.autoYScroll.call(this, pos, box, this.senseY))\n\t\t\treset = true;\n\t\tif (xScroll && DragScroll.autoXScroll.call(this, pos, box, this.senseX))\n\t\t\treset = true;\n\n\t\tif (reset) {\n\t\t\tupdateDragPos(e, pos);\n\t\t\tthis._auto_scroll_delay = webix.delay(\n\t\t\t\tDragScroll.autoScroll,\n\t\t\t\tthis,\n\t\t\t\t[e, pos],\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t},\n\n\tautoYScroll(pos, box, sense) {\n\t\tconst scroll = this.from.getScrollState();\n\n\t\tif (pos.y < box.y + sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x,\n\t\t\t\tscroll.y - sense,\n\t\t\t\t\"y\"\n\t\t\t);\n\t\t} else if (pos.y > box.y + box.height - sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x,\n\t\t\t\tscroll.y + sense,\n\t\t\t\t\"y\"\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t},\n\n\tautoXScroll(pos, box, sense) {\n\t\tconst scroll = this.from.getScrollState();\n\n\t\tif (pos.x < box.x + sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x - sense,\n\t\t\t\tscroll.y,\n\t\t\t\t\"x\"\n\t\t\t);\n\t\t} else if (pos.x > box.x + box.width - sense) {\n\t\t\tconst x = this.snode\n\t\t\t\t? Math.min(scroll.x + sense, this.snode.scrollWidth - box.width)\n\t\t\t\t: scroll.x + sense;\n\t\t\treturn x == scroll.x\n\t\t\t\t? false\n\t\t\t\t: DragScroll.autoScrollTo.call(this, x, scroll.y, \"x\");\n\t\t}\n\t\treturn false;\n\t},\n\n\tautoScrollTo(x, y, mode) {\n\t\tthis.from.scrollTo(x, y);\n\t\tthis.from.callEvent(\"onAfterAutoScroll\", []);\n\n\t\tconst scroll = this.from.getScrollState();\n\t\treturn Math.abs((mode === \"x\" ? x : y) - scroll[mode]) < 1;\n\t},\n};\n\nexport default DragScroll;\n","import DragScroll from \"./dragscroll\";\n\nexport function initDnD(view) {\n\tconst ctrl = webix.copy(DragControl);\n\n\tctrl.view = view;\n\tctrl.master = this;\n\n\tctrl.Local = this.app.getService(\"local\");\n\n\twebix.DragControl.addDrag(view.$view, ctrl);\n\twebix.DragControl.addDrop(view.$view, ctrl, true);\n}\n\nexport function switchCursor(e, view) {\n\tif (webix.DragControl.active) return;\n\n\tconst id = webix.html.locate(e, \"webix_l_id\");\n\tif (id && view.getItem(id).type == \"task\") {\n\t\tconst node = view.getItemNode(id);\n\t\tconst mode = getMoveMode(node, e.clientX);\n\t\tnode.style.cursor = mode == \"move\" ? \"pointer\" : \"ew-resize\";\n\t}\n}\n\nfunction getMoveMode(node, x) {\n\tconst rect = node.getBoundingClientRect();\n\tconst p = (x - rect.left) / rect.width;\n\tconst minWidth = webix.env.touch ? 400 : 200;\n\tconst delta = 0.2 / (rect.width > minWidth ? rect.width / minWidth : 1);\n\n\tif (p < delta) return \"start\";\n\tif (p > 1 - delta) return \"end\";\n\treturn \"move\";\n}\n\nfunction updateDragScrollConfig(ds) {\n\tconst scales = this.Local.getScales();\n\tds.senseX = Math.round(scales.cellWidth * (webix.env.touch ? 1 : 0.5));\n\tds.senseY = Math.round(scales.cellHeight * (webix.env.touch ? 3 : 1));\n\treturn ds;\n}\n\nfunction isProgressDrag(t, node) {\n\twhile (t != node) {\n\t\tif (t.classList.contains(\"webix_gantt_progress_drag\")) return true;\n\t\tt = t.parentNode;\n\t}\n\treturn false;\n}\n\nconst DragControl = {\n\t$longTouchLimit: true,\n\t$dragCreate: function(t, e, pointer) {\n\t\tif (this.master.State.readonly) return false;\n\n\t\tconst ctx = this.getContext();\n\t\tctx.$touch = pointer === \"touch\";\n\n\t\tconst id = this.locateEvent(e);\n\t\tif (id) {\n\t\t\tconst item = this.view.getItem(id);\n\t\t\tif (item.$group) return false;\n\n\t\t\tconst target = e.target;\n\n\t\t\tif (target.classList.contains(\"webix_gantt_link\")) {\n\t\t\t\tctx.mode = \"links\";\n\t\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e, id);\n\t\t\t}\n\n\t\t\tconst node = this.view.getItemNode(id);\n\t\t\tif (!ctx.$touch && isProgressDrag(target, node)) {\n\t\t\t\tctx.mode = \"progress\";\n\t\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e, id);\n\t\t\t}\n\n\t\t\tconst scroll = this.view.getScrollState();\n\t\t\tconst evContext = this.getEventContext(e, ctx);\n\n\t\t\tlet mode = getMoveMode(node, evContext.x);\n\t\t\tif (item.type != \"task\" && (mode == \"start\" || mode == \"end\"))\n\t\t\t\tmode = \"move\";\n\n\t\t\tconst scales = this.Local.getScales();\n\t\t\tlet step = scales.cellWidth;\n\t\t\tif (scales.precise) {\n\t\t\t\tconst nsc = this.master.app\n\t\t\t\t\t.getService(\"helpers\")\n\t\t\t\t\t.getSmallerCount(scales.minUnit);\n\t\t\t\tstep = Math.round(step / (typeof nsc === \"number\" ? nsc : nsc()));\n\t\t\t}\n\n\t\t\twebix.extend(\n\t\t\t\tctx,\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\tmode,\n\t\t\t\t\tnode,\n\t\t\t\t\tstep,\n\t\t\t\t\tdx: 0,\n\t\t\t\t\tfrom: this.view,\n\t\t\t\t\tsnode: t.querySelector(\".webix_scroll_cont\"),\n\t\t\t\t\tx: evContext.x,\n\t\t\t\t\tscroll: scroll,\n\t\t\t\t\tt: parseInt(node.style.top),\n\t\t\t\t\tl: parseInt(node.style.left),\n\t\t\t\t\tw: parseInt(node.style.width),\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\tif (!this.master.app.callEvent(\"bars:beforedrag\", [item, ctx]))\n\t\t\t\treturn false;\n\n\t\t\tif (Modes[ctx.mode].dragScroll)\n\t\t\t\twebix.extend(\n\t\t\t\t\tctx,\n\t\t\t\t\tupdateDragScrollConfig.call(this, Modes[ctx.mode].dragScroll)\n\t\t\t\t);\n\n\t\t\tconst html = node.cloneNode(true);\n\t\t\thtml.className += \" webix_drag_zone webix_gantt_mode_\" + mode;\n\n\t\t\tnode.style.visibility = \"hidden\";\n\t\t\twebix.html.addCss(t, \"webix_gantt_in_action\", true);\n\n\t\t\tt.style.cursor = mode == \"move\" ? \"move\" : \"ew-resize\";\n\t\t\tt.appendChild(html);\n\t\t\treturn html;\n\t\t} else if (\n\t\t\tthis.master.app.config.split &&\n\t\t\tthis.master.State.display !== \"resources\" &&\n\t\t\te.target == t\n\t\t) {\n\t\t\tctx.mode = \"split\";\n\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e);\n\t\t}\n\n\t\treturn false;\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tif (Modes[ctx.mode].dragScroll) DragScroll.reset(ctx);\n\n\t\tif (ctx.mode && Modes[ctx.mode].$dragDestroy)\n\t\t\treturn Modes[ctx.mode].$dragDestroy.call(this, t, node);\n\n\t\tif (ctx.$waitUpdate) {\n\t\t\tctx.$waitUpdate.catch(() => {\n\t\t\t\tthis.master.Action({ action: \"update-task-time\", id: ctx.id });\n\t\t\t});\n\t\t} else\n\t\t\tctx.$waitUpdate = this.master.Action({\n\t\t\t\taction: \"update-task-time\",\n\t\t\t\tid: ctx.id,\n\t\t\t});\n\n\t\tctx.$waitUpdate.finally(() => {\n\t\t\tctx.node.style.visibility = \"\";\n\t\t\twebix.html.remove(node);\n\n\t\t\tif (this.master.app.config.split && ctx.id)\n\t\t\t\tthis.master.Action({\n\t\t\t\t\taction: \"split-resize\",\n\t\t\t\t\tid: ctx.id,\n\t\t\t\t});\n\t\t});\n\n\t\tt.style.cursor = \"\";\n\t\twebix.html.removeCss(t, \"webix_gantt_in_action\");\n\t\treturn false;\n\t},\n\t$dragIn: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (!ctx.mode) return false;\n\n\t\tif (Modes[ctx.mode].dragScroll) {\n\t\t\tDragScroll.reset(ctx);\n\t\t\tDragScroll.start(ctx, e);\n\t\t}\n\n\t\tif (Modes[ctx.mode].$dragIn)\n\t\t\treturn Modes[ctx.mode].$dragIn.call(this, s, t, e);\n\t\treturn true;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\treturn Modes[ctx.mode].$dragPos.call(this, pos);\n\t},\n\t$dragOut: function(s, t, n, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (Modes[ctx.mode].$dragOut)\n\t\t\treturn Modes[ctx.mode].$dragOut.call(this, s, t, n, e);\n\t\treturn null;\n\t},\n\t$drop: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (!ctx.mode) return false;\n\n\t\tif (Modes[ctx.mode].$drop) return Modes[ctx.mode].$drop.call(this, s, t, e);\n\n\t\tconst { id, mode, dx, step } = ctx;\n\t\tconst time = Math.round(dx / step);\n\t\tctx.timeShift = time;\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrop\", [\n\t\t\t\tthis.view.getItem(ctx.id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tctx[\"$waitUpdate\"] = this.master.Action({\n\t\t\taction: \"update-task-time\",\n\t\t\tmode,\n\t\t\ttime,\n\t\t\tid,\n\t\t});\n\t},\n\tlocateEvent: function(ev, context) {\n\t\tif (context) {\n\t\t\tev = document.elementFromPoint(context.x, context.y);\n\t\t}\n\t\treturn webix.html.locate(ev, \"webix_l_id\");\n\t},\n\tgetEventContext: function(e, ctx) {\n\t\tif (ctx.$touch) {\n\t\t\tif (e.changedTouches && !(e.touches && e.touches[0])) {\n\t\t\t\tconst t = e.changedTouches[0];\n\t\t\t\treturn { x: t.pageX, y: t.pageY };\n\t\t\t}\n\t\t\treturn e.time ? e : webix.env.touch.context(e);\n\t\t}\n\t\treturn { x: e.clientX, y: e.clientY };\n\t},\n\tgetContext: function() {\n\t\treturn webix.DragControl.getContext();\n\t},\n\tsetDragOffset: function(node, target, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst pos = webix.html.pos(e);\n\t\tconst offset = webix.html.offset(node);\n\n\t\tctx.width = offset.width;\n\t\tctx.height = offset.height;\n\t\tctx.x_offset = offset.x - pos.x;\n\t\tctx.y_offset = offset.y - pos.y;\n\t},\n};\n\nconst links = {\n\tdragScroll: {\n\t\tdirection: \"xy\",\n\t},\n\t$dragCreate: function(t, e, id) {\n\t\tconst ctx = this.getContext();\n\t\tconst link = e.target;\n\t\tconst node = this.view.getItemNode(id);\n\t\tconst scroll = this.view.getScrollState();\n\t\tconst offset = webix.html.offset(link);\n\t\tconst css = link.classList;\n\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tfrom: this.view,\n\t\t\t\tnode,\n\t\t\t\tlink,\n\t\t\t\tfromStart: css.contains(\"webix_gantt_link_left\"),\n\t\t\t\tstart: {\n\t\t\t\t\tx: offset.x + offset.width / 2 + scroll.x,\n\t\t\t\t\ty: offset.y + offset.height / 2 + scroll.y,\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrag\", [\n\t\t\t\tthis.view.getItem(id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tif (Modes[ctx.mode].dragScroll)\n\t\t\twebix.extend(\n\t\t\t\tctx,\n\t\t\t\tupdateDragScrollConfig.call(this, Modes[ctx.mode].dragScroll)\n\t\t\t);\n\n\t\tlink.style.opacity = 1;\n\t\twebix.html.addCss(node, \"webix_gantt_task_in_action\", true);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tthis.master.Action({ action: \"temp-link\" });\n\n\t\tif (ctx.target) {\n\t\t\tconst node = this.view.getItemNode(ctx.target);\n\t\t\twebix.html.removeCss(node, \"webix_gantt_link_visible\");\n\t\t}\n\n\t\tctx.link.style.opacity = \"\";\n\t\twebix.html.removeCss(ctx.node, \"webix_gantt_task_in_action\");\n\t\twebix.html.remove(node);\n\n\t\treturn false;\n\t},\n\t$dragIn: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst id = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (!id) return false;\n\n\t\tconst node = this.view.getItemNode(id);\n\t\tif (id != ctx.target) {\n\t\t\twebix.html.addCss(node, \"webix_gantt_link_visible\", true);\n\t\t\tctx.target = id;\n\t\t}\n\t\treturn node;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst nscroll = this.view.getScrollState();\n\n\t\tctx.end = {\n\t\t\tx: pos.x + nscroll.x,\n\t\t\ty: pos.y + nscroll.y,\n\t\t};\n\n\t\tthis.master.Action({ action: \"temp-link\", start: ctx.start, end: ctx.end });\n\t},\n\t$dragOut: function(s, t, n, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst id = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (ctx.target && id != ctx.target) {\n\t\t\tconst node = this.view.getItemNode(ctx.target);\n\t\t\twebix.html.removeCss(node, \"webix_gantt_link_visible\");\n\t\t\tctx.target = null;\n\t\t}\n\t\treturn null;\n\t},\n\t$drop: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst source = ctx.id;\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst target = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (!target || source == target) return false;\n\n\t\tconst node = this.view.getItemNode(target);\n\t\tconst rect = node.getBoundingClientRect();\n\t\tconst toStart = evContext.x - rect.left < rect.width / 2;\n\n\t\tconst type = (ctx.linkType = (ctx.fromStart ? 1 : 0) + (toStart ? 0 : 2));\n\t\tctx.targetId = target;\n\t\tif (\n\t\t\tthis.master.app.callEvent(\"bars:beforedrop\", [\n\t\t\t\tthis.view.getItem(source),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\tthis.master.Action({ action: \"add-link\", source, target, type });\n\t},\n};\n\nconst resize = {\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst nscroll = this.view.getScrollState();\n\t\tconst node = webix.DragControl.getNode();\n\t\tconst { mode, l, t, w, x, id, scroll, step } = ctx;\n\t\tconst dx = (ctx.dx = pos.x - x - scroll.x + nscroll.x);\n\n\t\tif (mode === \"start\") {\n\t\t\tpos.x = Math.min(l + dx, l + w - step);\n\t\t\tnode.style.width = `${Math.max(w - dx, step)}px`;\n\t\t} else if (mode === \"end\") {\n\t\t\tpos.x = l;\n\t\t\tnode.style.width = `${Math.max(w + dx, step)}px`;\n\t\t}\n\t\tpos.y = t;\n\n\t\tthis.master.Action({\n\t\t\taction: \"drag-task\",\n\t\t\tid,\n\t\t\tleft: pos.x,\n\t\t\twidth: parseInt(node.style.width),\n\t\t});\n\n\t\tif (this.master.app.config.split)\n\t\t\tthis.master.Action({\n\t\t\t\taction: \"split-resize\",\n\t\t\t\tid,\n\t\t\t});\n\t},\n};\n\nconst move = {\n\tdragScroll: {\n\t\tdirection: \"x\",\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst { node, l, t, x, id, scroll } = ctx;\n\t\tconst nscroll = this.view.getScrollState();\n\t\tconst dx = (ctx.dx = pos.x - x - scroll.x + nscroll.x);\n\n\t\tpos.x = l + dx;\n\t\tpos.y = t;\n\n\t\tthis.master.Action({\n\t\t\taction: \"drag-task\",\n\t\t\tid,\n\t\t\tleft: pos.x,\n\t\t\twidth: parseInt(node.style.width),\n\t\t});\n\n\t\tif (this.master.app.config.split)\n\t\t\tthis.master.Action({\n\t\t\t\taction: \"split-resize\",\n\t\t\t\tid,\n\t\t\t});\n\t},\n};\n\nconst progress = {\n\t$dragCreate: function(t, e, id) {\n\t\tconst ctx = this.getContext();\n\t\tconst node = this.view.getItemNode(id);\n\t\tconst prevProgress = this.view.getItem(id).progress;\n\t\tconst progressNode = node.querySelector(\".webix_gantt_progress\");\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst scroll = this.view.getScrollState();\n\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tnode,\n\t\t\t\tprevProgress,\n\t\t\t\tprogressNode,\n\t\t\t\tfrom: this.view,\n\t\t\t\tx: evContext.x,\n\t\t\t\tw: parseInt(node.style.width),\n\t\t\t\tscroll,\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrag\", [\n\t\t\t\tthis.view.getItem(id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tt.style.cursor = \"ew-resize\";\n\t\twebix.html.addCss(t, \"webix_gantt_in_action\", true);\n\t\twebix.html.addCss(node, \"webix_gantt_mode_progress\", true);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst { x, scroll, w, node } = ctx;\n\t\tconst nscroll = this.view.getScrollState();\n\n\t\tconst dx = pos.x - x - scroll.x + nscroll.x;\n\t\tconst progress = Math.min(\n\t\t\tMath.max(ctx.prevProgress + Math.round((dx * 100) / w), 0),\n\t\t\t100\n\t\t);\n\n\t\tif (ctx.progress != progress) {\n\t\t\tctx.progress = progress;\n\t\t\tModes[ctx.mode].updateTaskTemplate.call(this, ctx, progress);\n\t\t}\n\n\t\tconst colors = { contrast: \"#393939\", dark: \"#20262B\" };\n\t\tnode.style.zIndex = \"3\";\n\t\tnode.style.boxShadow = `${\n\t\t\tcolors[webix.skin.$name || \"#ffffff\"]\n\t\t} -1px 0px 0px`;\n\t},\n\t$drop: function() {\n\t\tconst ctx = this.getContext();\n\t\tconst { id, progress, prevProgress } = ctx;\n\n\t\tif (\n\t\t\t!webix.isUndefined(progress) &&\n\t\t\tprogress != prevProgress &&\n\t\t\tthis.master.app.callEvent(\"bars:beforedrop\", [this.view.getItem(id), ctx])\n\t\t)\n\t\t\tctx[\"$waitUpdate\"] = this.master.Action({\n\t\t\t\taction: \"update-task-progress\",\n\t\t\t\tprogress,\n\t\t\t\tid,\n\t\t\t});\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tif (ctx.$waitUpdate) {\n\t\t\tctx.$waitUpdate.catch(() => {\n\t\t\t\tthis.master.Action({ action: \"update-task-progress\", id: ctx.id });\n\t\t\t});\n\t\t} else\n\t\t\tctx.$waitUpdate = this.master.Action({\n\t\t\t\taction: \"update-task-progress\",\n\t\t\t\tid: ctx.id,\n\t\t\t});\n\n\t\tt.style.cursor = \"\";\n\t\twebix.html.removeCss(t, \"webix_gantt_in_action\");\n\t\twebix.html.removeCss(ctx.node, \"webix_gantt_mode_progress\");\n\n\t\twebix.html.remove(node);\n\t\treturn false;\n\t},\n\tupdateTaskTemplate(ctx, progress) {\n\t\tconst node = ctx.progressNode;\n\t\tnode.style.width = progress + \"%\";\n\t\tnode.innerHTML = this.master.DragProgressTemplate(progress);\n\t},\n};\n\nconst split = {\n\t$dragCreate: function(t, e) {\n\t\tconst selection = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_split_selection\",\n\t\t});\n\n\t\tconst scales = this.Local.getScales();\n\t\tconst scroll = this.view.getScrollState();\n\n\t\tconst tb = e.target.getBoundingClientRect();\n\t\tconst index = Math.floor((e.y - tb.y + scroll.y) / scales.cellHeight);\n\t\tconst offsetX = e.x - tb.x;\n\n\t\tselection.style.top = index * scales.cellHeight + 6 + \"px\";\n\t\tselection.style.left = offsetX + scroll.x + \"px\";\n\t\tselection.style.height = scales.cellHeight - 14 + \"px\";\n\t\tselection.style.width = \"0px\";\n\n\t\tlet step = scales.cellWidth;\n\t\tif (scales.precise) {\n\t\t\tconst nsc = this.master.app\n\t\t\t\t.getService(\"helpers\")\n\t\t\t\t.getSmallerCount(scales.minUnit);\n\t\t\tstep = Math.round(step / (typeof nsc === \"number\" ? nsc : nsc()));\n\t\t}\n\n\t\tconst ctx = this.getContext();\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tfrom: this.view,\n\t\t\t\tnode: selection,\n\t\t\t\tstart: { offsetX, clientX: e.clientX },\n\t\t\t\tindex,\n\t\t\t\tstep,\n\t\t\t\tscroll,\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tt.appendChild(selection);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragPos(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst width = (ctx.dx = pos.x - ctx.start.clientX);\n\t\tif (pos.x < ctx.start.clientX) {\n\t\t\tctx.node.style.left = ctx.start.offsetX + ctx.scroll.x + width + \"px\";\n\t\t\tctx.node.style.width = -width + \"px\";\n\t\t} else {\n\t\t\tctx.node.style.left = ctx.start.offsetX + ctx.scroll.x + \"px\";\n\t\t\tctx.node.style.width = pos.x - ctx.start.clientX + \"px\";\n\t\t}\n\t},\n\t$drop() {\n\t\tconst ctx = this.getContext();\n\t\tconst id = this.view.getIdByIndex(ctx.index);\n\n\t\tlet start = Math.round((ctx.start.offsetX + ctx.scroll.x) / ctx.step);\n\t\tlet end = Math.round(ctx.dx / ctx.step);\n\t\tif (end < 0) {\n\t\t\tstart = start + end;\n\t\t\tend *= -1;\n\t\t}\n\n\t\tthis.master.Action({ action: \"add-task\", id, dates: { start, end } });\n\t},\n\t$dragDestroy(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\twebix.html.remove(node);\n\t\twebix.html.remove(ctx.node);\n\n\t\treturn false;\n\t},\n};\n\nconst Modes = {\n\tlinks,\n\tmove,\n\tprogress,\n\tstart: resize,\n\tend: resize,\n\tsplit,\n};\n","import { JetView } from \"webix-jet\";\nimport { initDnD, switchCursor } from \"../../helpers/dnd\";\n\nexport default class BarsView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"abslayout\",\n\t\t\tcss:\n\t\t\t\tthis.State.readonly || !this.app.config.links\n\t\t\t\t\t? \"webix_gantt_readonly\"\n\t\t\t\t\t: \"\",\n\t\t\tborderless: true,\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_holidays\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_links\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"list\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttype: this.BarsType(_),\n\t\t\t\t\tcss: `webix_gantt${webix.env.touch ? \"_touch\" : \"\"}_bars`,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ItemClickHandler(id),\n\t\t\t\t\t},\n\t\t\t\t\ttooltip: obj => this.GetTooltip(obj, _),\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tconst [holidays, links, bars] = view.getChildViews();\n\t\tthis.Holidays = holidays;\n\t\tthis.Links = links;\n\t\tthis.Bars = bars;\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\tconst local = (this.Local = this.app.getService(\"local\"));\n\t\tconst scales = local.getScales();\n\t\tconst linkCollection = local.links();\n\t\tconst ldata = (this.LinksData = linkCollection.data);\n\t\tthis.Calendars = this.app.config.resourceCalendars;\n\n\t\tthis.HandleScroll();\n\t\tthis.HandleDrag(scales);\n\t\tthis.HandleSelection(scales);\n\t\tthis.InitMarkers();\n\t\tthis.HandleHolidays(scales);\n\n\t\tthis.on(this.State.$changes, \"display\", (v, old) => {\n\t\t\t// if the selected task type was changed, the form not closed and the display mode changed, we need to close the form and remove selection layer\n\t\t\tthis.SyncData(true);\n\t\t\tif (old) {\n\t\t\t\tthis.Local.refreshLinks();\n\t\t\t\tthis.RefreshLinks();\n\t\t\t\tif (this.Calendars) this.RenderResourceHolidays();\n\t\t\t}\n\t\t});\n\n\t\t// leave here for app.refresh() calls (inc. from Locale plugin)\n\t\tthis.DrawGrid(view, scales);\n\t\tif (this.Calendars) this.RenderResourceHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tthis.DrawGrid(view, scales);\n\t\t\tthis.Bars.refresh();\n\t\t\tthis.RefreshLinks();\n\t\t});\n\n\t\tthis.on(this.VisibleTasks.data, \"onStoreUpdated\", (id, data, action) => {\n\t\t\tthis.RefreshLinks();\n\t\t\tif (action !== \"update\") this.ApplySelection();\n\t\t\tif (!action && this.Calendars) this.RenderResourceHolidays();\n\t\t});\n\t\tthis.on(ldata, \"onStoreUpdated\", () => {\n\t\t\tthis.RefreshLinks();\n\t\t});\n\t\tthis.on(this.State.$changes, \"criticalPath\", (v, o) => {\n\t\t\tif (!webix.isUndefined(o)) {\n\t\t\t\tthis.Local.showCriticalPath(!v);\n\t\t\t\tthis.RefreshLinks();\n\t\t\t}\n\t\t});\n\t\tthis.on(this.State.$changes, \"compact\", () => {\n\t\t\tthis.RefreshLinks();\n\t\t});\n\t\tif (this.Calendars)\n\t\t\tthis.on(\n\t\t\t\tthis.Local.assignments().data,\n\t\t\t\t\"onStoreUpdated\",\n\t\t\t\t(id, data, action) => {\n\t\t\t\t\tthis.RenderResourceHolidays();\n\t\t\t\t\tif (this.app.config.excludeHolidays && action) {\n\t\t\t\t\t\tconst task = this.Local.tasks().getItem(data.task);\n\t\t\t\t\t\tif (task) this.Ops.updateAssignedTaskDates(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\tthis.on(this.State.$changes, \"baseline\", (v, o) => {\n\t\t\tif (!webix.isUndefined(o))\n\t\t\t\tthis.Local.updateScaleMinMax(this.VisibleTasks);\n\t\t});\n\t}\n\n\t/**\n\t * Sets action ot bar item click\n\t * @param {(string|number)} id  - ID of the clicked item\n\t */\n\tItemClickHandler(id) {\n\t\tif (!this.Bars.getItem(id).$group)\n\t\t\tthis.State.$batch({\n\t\t\t\tparent: null,\n\t\t\t\tselected: id,\n\t\t\t});\n\t}\n\n\t/**\n\t * Paints a grid\n\t * @param {view} Object - Webix view of bars chart\n\t * @param {scales} Object - scales object as returned by this.Local.getScales()\n\t */\n\tDrawGrid(view, scales) {\n\t\tconst colors = { contrast: \"#808080\", dark: \"#384047\" };\n\t\tview.$view.style.backgroundImage = `url(${this.app\n\t\t\t.getService(\"helpers\")\n\t\t\t.drawGridInner(\n\t\t\t\tscales.cellWidth,\n\t\t\t\tscales.cellHeight,\n\t\t\t\tcolors[webix.skin.$name] || \"#ccc\"\n\t\t\t)})`;\n\t\tview.$view.style.marginTop = \"0px\";\n\n\t\t// sync grid to scroll position\n\t\tconst state = this.app.getState();\n\t\tview.$view.style.backgroundPosition = `-${state.left}px -${state.top}px`;\n\n\t\tthis.Resize(scales.width);\n\t}\n\n\t/**\n\t * Loads data to the chart\n\t * @param {Boolean} unselect - passed on 'display' change; if the selected task is not found on chart and this param is true, State.selected will be nulled in ApplySelection\n\t */\n\tSyncData(unselect) {\n\t\tthis.Bars.clearAll();\n\t\tthis.VisibleTasks = this.Local.getVisibleTasksCollection();\n\t\tif (this.Calendars) {\n\t\t\tthis.Local.taskCalendarMap().then(() => {\n\t\t\t\tthis.Bars.sync(this.VisibleTasks);\n\t\t\t});\n\t\t} else this.Bars.sync(this.VisibleTasks);\n\t\tthis.ApplySelection(unselect);\n\t}\n\n\t/**\n\t * Returns a string with HTML of a task node content\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string}\n\t */\n\tBarsTemplate(obj, _) {\n\t\tconst text = obj.text || (obj.$group ? _(\"Unassigned\") : _(\"(no title)\"));\n\t\treturn obj.type == \"milestone\" ? `<span>${text}</span>` : text;\n\t}\n\n\t/**\n\t * Returns all templates for bars\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {Object} all templates for bars\n\t */\n\tBarsType(_) {\n\t\treturn {\n\t\t\ttemplate: obj => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\tobj.type === \"split\" &&\n\t\t\t\t\tobj.$data &&\n\t\t\t\t\tobj.$data.length\n\t\t\t\t) {\n\t\t\t\t\tconst { height, width, left, top } = this.GetSplitBox(obj);\n\t\t\t\t\tlet html = `<div class=\"webix_gantt_split_container\" webix_s_id=\"${obj.id}\" style=\"top:${top}px;left:${left}px;height:${height}px;width:${width}px;\"></div>`;\n\n\t\t\t\t\t// split kids are not in the order\n\t\t\t\t\tconst order = this.VisibleTasks.data.order;\n\t\t\t\t\tconst isLast = order.length > 1 && obj.id == order[order.length - 1];\n\t\t\t\t\tobj.$data.forEach(kid => {\n\t\t\t\t\t\thtml +=\n\t\t\t\t\t\t\tthis.TemplateStart(kid, isLast, true) +\n\t\t\t\t\t\t\tthis.BarsTemplate(kid, _) +\n\t\t\t\t\t\t\tthis.TemplateEnd(kid);\n\t\t\t\t\t});\n\t\t\t\t\treturn html;\n\t\t\t\t} else return this.BarsTemplate(obj, _);\n\t\t\t},\n\t\t\ttemplateStart: task => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\ttask.type === \"split\" &&\n\t\t\t\t\ttask.$data &&\n\t\t\t\t\ttask.$data.length\n\t\t\t\t)\n\t\t\t\t\treturn \"\";\n\t\t\t\tconst order = this.VisibleTasks.data.order;\n\t\t\t\tconst isLast = order.length > 1 && task.id == order[order.length - 1];\n\t\t\t\treturn this.TemplateStart(task, isLast);\n\t\t\t},\n\t\t\ttemplateEnd: task => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\ttask.type === \"split\" &&\n\t\t\t\t\ttask.$data &&\n\t\t\t\t\ttask.$data.length\n\t\t\t\t)\n\t\t\t\t\treturn \"\";\n\t\t\t\treturn this.TemplateEnd();\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Gets the size and position parameters for a decorative div-element behind a split task\n\t * @param {Object} obj - data of a split task\n\t * @returns {Object} an object with top, left, height, and width of an element\n\t */\n\tGetSplitBox(obj) {\n\t\tconst last = obj.$data[0];\n\t\tconst first = obj.$data[obj.$data.length - 1];\n\t\tconst left =\n\t\t\tfirst.$x + (first.type == \"milestone\" ? Math.floor(first.$w / 2) : 0);\n\t\tconst rwidth = last.type == \"milestone\" ? Math.floor(last.$w / 2) : last.$w;\n\n\t\treturn {\n\t\t\ttop: last.$y,\n\t\t\tleft,\n\t\t\theight: last.$h,\n\t\t\twidth: last.$x - left + rwidth,\n\t\t};\n\t}\n\n\t/**\n\t * Returns the html for the first part of a task\n\t * @param {Object} task - a task data object\n\t * @param {Boolean} last - a flag that indicates that this task is in the last line of gantt\n\t * @param {Boolean} split - a flag that indicates that this task is a child of a parent with \"split\" type\n\t * @returns {string} HTML that defines how a task is displayed\n\t */\n\tTemplateStart(task, last, split) {\n\t\tlet w = task.$w,\n\t\t\th = task.$h,\n\t\t\tdiff = 0,\n\t\t\tprogress = \"\";\n\t\tconst css = this.BarCSS(task, last);\n\t\tconst contentCss = this.ContentCss(task);\n\t\tif (task.type == \"milestone\") {\n\t\t\tw = h = Math.ceil(Math.sqrt(Math.pow(task.$w, 2) / 2));\n\t\t\tdiff = Math.ceil((task.$w - w) / 2);\n\t\t} else {\n\t\t\tconst drag =\n\t\t\t\ttask.type == \"task\" ? this.DragProgressTemplate(task.progress) : \"\";\n\t\t\tprogress = `<div class=\"webix_gantt_progress\" style=\"width:${task.progress}%;\">${drag}</div>`;\n\t\t}\n\n\t\tlet baseline = \"\";\n\t\tif (\n\t\t\tthis.State.baseline &&\n\t\t\ttask.type !== \"milestone\" &&\n\t\t\ttask.planned_start &&\n\t\t\t!split\n\t\t)\n\t\t\tbaseline = this.TemplateBaseline(task);\n\n\t\treturn (\n\t\t\tbaseline +\n\t\t\t`<div webix_l_id=\"${task.id}\" class=\"${css}\" \n\t\t\tstyle=\"left:${task.$x + diff}px;top:${task.$y +\n\t\t\t\tdiff -\n\t\t\t\t(baseline ? 1 : 0)}px;width:${w}px;height:${h}px;\" \n\t\t\tdata-id=\"${task.id}\">\n\t\t\t\t<div class=\"webix_gantt_link webix_gantt_link_left\"></div>\n\t\t\t\t${progress}\n\t\t\t\t<div class=\"webix_gantt_content ${contentCss}\">`\n\t\t);\n\t}\n\n\tTemplateBaseline(t) {\n\t\treturn `<div  \n\t\t\tclass=\"webix_gantt_baseline_${t.type}\" \n\t\t\tstyle=\"left:${t.$x0}px;top:${t.$y + t.$h - 2}px;width:${t.$w0}px; \" \n\t\t\tdata-baseid=\"${t.id}\"></div>`;\n\t}\n\n\t/**\n\t * Get task classname\n\t * @param {Object} task - a task data object\n\t * @param {Boolean} last - a flag that indicates that this task is in the last line of gantt\n\t * @returns {string} a classname\n\t */\n\tBarCSS(task, last) {\n\t\tlet css = `webix_gantt_task_base webix_gantt_${\n\t\t\ttask.type === \"split\" ? \"task\" : task.type\n\t\t}`;\n\t\tif (task.$critical) css += \" webix_gantt_critical\";\n\t\tif (task.$group) css += \" webix_gantt_group\";\n\t\tif (last) css += \" webix_gantt_last\";\n\t\tif (task.css && task.type != \"milestone\") css += \" \" + task.css;\n\t\treturn css;\n\t}\n\tContentCss(task) {\n\t\treturn task.css && task.type == \"milestone\" ? \" \" + task.css : \"\";\n\t}\n\t/**\n\t * Returns the html for the last part of a task\n\t * @returns {string} HTML that defines how a task is displayed\n\t */\n\tTemplateEnd() {\n\t\treturn `</div><div class=\"webix_gantt_link webix_gantt_link_right\"></div></div>`;\n\t}\n\n\t/**\n\t * Returns a string with HTML of the progress drag marker\n\t * @param {number} progress - the progress of a task (number from 0 to 100)\n\t * @returns {string}\n\t */\n\tDragProgressTemplate(progress) {\n\t\treturn `<div class=\"webix_gantt_progress_drag\" style=\"left:${progress}%\">\n\t\t\t<span class=\"webix_gantt_progress_percent\">${progress}</span>\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Extends the class with methods for DnD and handles cursor change for bars\n\t */\n\tHandleDrag() {\n\t\tinitDnD.call(this, this.Bars);\n\n\t\tthis._mousemove_handler = webix.event(this.Bars.$view, \"pointermove\", e => {\n\t\t\tif (e.pointerType == \"mouse\") switchCursor(e, this.Bars);\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis._mousemove_handler = webix.eventRemove(this._mousemove_handler);\n\t\tthis._scroll_handler = webix.eventRemove(this._scroll_handler);\n\n\t\tconst markers = this.app.config.markers;\n\t\tif (markers)\n\t\t\tfor (let i = 0; i < markers.length; i++) {\n\t\t\t\tconst m = markers[i];\n\t\t\t\tif (m.$interval) m.$interval = clearInterval(m.$interval);\n\t\t\t}\n\t}\n\n\t/**\n\t * Finds and returns the SVG element with all links or the temp link that is rendered while the user is linking two tasks\n\t * @param {Boolean} temp - if true, the method looks for the temp link\n\t * @returns {SVGElement}\n\t */\n\tGetLinks(temp) {\n\t\treturn this.Links.$view.querySelector(\n\t\t\t`.webix_gantt_${temp ? \"temp_line\" : \"lines\"}`\n\t\t);\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\n\t\t\tthis.holidaysContainer.style.height = 0 + \"px\";\n\t\t\tthis.containerForMarkers.style.height = 0 + \"px\";\n\n\t\t\tif (this.app.config.links) {\n\t\t\t\tconst lines = this.GetLinks();\n\t\t\t\tconst temp = this.GetLinks(true);\n\t\t\t\tconst attrs = {\n\t\t\t\t\tviewBox: `${left} ${top} ${bars.scrollWidth} ${bars.scrollHeight}`,\n\t\t\t\t\twidth: bars.scrollWidth,\n\t\t\t\t\theight: bars.scrollHeight,\n\t\t\t\t};\n\n\t\t\t\tfor (let key in attrs) {\n\t\t\t\t\tlines.setAttribute(key, attrs[key]);\n\t\t\t\t\ttemp.setAttribute(key, attrs[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.SetHolidaysScroll(bars.scrollHeight, left, top);\n\n\t\t\tthis.containerForMarkers.style.height = bars.scrollHeight + \"px\";\n\n\t\t\tthis.getRoot().$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.State.$batch({ top, left });\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"top\", y => {\n\t\t\tthis.Bars.scrollTo(this.State.left, y);\n\t\t});\n\n\t\tif (this.app.config.resources) {\n\t\t\tthis.on(this.State.$changes, \"left\", v => {\n\t\t\t\tif (this.State.resourcesDiagram) this.Bars.scrollTo(v, this.State.top);\n\t\t\t});\n\n\t\t\tthis.on(this.app, \"rdiagram:resize\", () => {\n\t\t\t\tthis.holidaysContainer.style.height =\n\t\t\t\t\tthis.Bars.$view.scrollHeight + \"px\";\n\t\t\t\tthis.containerForMarkers.style.height =\n\t\t\t\t\tthis.Bars.$view.scrollHeight + \"px\";\n\t\t\t});\n\t\t}\n\t}\n\n\tSetHolidaysScroll(height, x, y) {\n\t\tthis.holidaysContainer.style.height = height + \"px\";\n\t\tthis.holidaysContainer.style.left = -x + \"px\";\n\t\tthis.holidaysContainer.style.top = -y + \"px\";\n\t\tif (this.Calendars) {\n\t\t\tthis.resHolidaysContainer.style.height = height + \"px\";\n\t\t\tthis.resHolidaysContainer.style.left = -x + \"px\";\n\t\t\tthis.resHolidaysContainer.style.top = -y + \"px\";\n\t\t}\n\t}\n\n\t/**\n\t * Handles selection\n\t * @param {Object} scales - the current scales\n\t */\n\tHandleSelection(scales) {\n\t\tthis.selLine = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_bar_selection\",\n\t\t\tstyle: `height:${scales.cellHeight}px;width:${scales.width}px`,\n\t\t});\n\t\tthis.Bars.$view.insertBefore(this.selLine, this.Bars.$view.firstChild);\n\n\t\tthis.on(this.State.$changes, \"selected\", () => this.ApplySelection());\n\t}\n\n\t/**\n\t * Highlights the selected task\n\t * @param {Boolean} unselect - passed by SyncData call on 'display' change; if the selected task is not found in current collection and this param is true, State.selected will be nulled\n\t */\n\tApplySelection(unselect) {\n\t\tconst id = this.State.selected;\n\t\tlet top = -100;\n\t\tif (id && this.Bars.data.order.length) {\n\t\t\tlet ind = (top = this.Bars.getIndexById(id));\n\t\t\tconst task = this.Bars.getItem(id);\n\t\t\tif (ind < 0) {\n\t\t\t\t// split subtasks will not be found in datastore order\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display == \"tasks\" &&\n\t\t\t\t\ttask &&\n\t\t\t\t\ttask.parent != 0 &&\n\t\t\t\t\tthis.Bars.getItem(task.parent).type === \"split\"\n\t\t\t\t) {\n\t\t\t\t\tind = this.Bars.getIndexById(task.parent);\n\t\t\t\t} else if (unselect && !this.Bars.exists(id)) {\n\t\t\t\t\tthis.State.selected = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttop = ind * this.Local.getScales().cellHeight;\n\n\t\t\tthis.ScrollToTask(task);\n\t\t}\n\t\tthis.selLine.style.top = top + \"px\";\n\t}\n\n\t/**\n\t * Scrolls the chart to make the task visible\n\t * @param {Object} task - the data object of a task\n\t */\n\tScrollToTask(task) {\n\t\tif (task) {\n\t\t\tconst bars = this.Bars;\n\t\t\tif (\n\t\t\t\ttask.$x > bars.$width - this.Local.getScales().cellWidth ||\n\t\t\t\ttask.$x < bars.$view.scrollLeft\n\t\t\t) {\n\t\t\t\t// to make it visible, -30px for better looks - not sticking to the tree\n\t\t\t\tthis.State.left = task.$x - 30;\n\t\t\t}\n\t\t}\n\t\tthis.Bars.scrollTo(this.State.left, this.State.top);\n\t}\n\n\t/**\n\t * Creates and renders markers (today and custom ones if they are provided)\n\t */\n\tInitMarkers() {\n\t\tthis.containerForMarkers = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_markers\",\n\t\t\tstyle: `height:${this.Bars.$view.scrollHeight}px`,\n\t\t});\n\t\tthis.Bars.$view.insertBefore(\n\t\t\tthis.containerForMarkers,\n\t\t\tthis.Bars.$view.firstChild\n\t\t);\n\n\t\tthis.RenderMarkers(this.app.config.markers);\n\t\tthis.on(this.app, \"onScalesUpdate\", () =>\n\t\t\tthis.RenderMarkers(this.app.config.markers)\n\t\t);\n\t}\n\n\t/**\n\t * Renders markers (today and custom ones if they are provided)\n\t * @param {Array} markers - all markers\n\t */\n\tRenderMarkers(markers) {\n\t\tif (!markers) return;\n\n\t\tconst html = [];\n\t\tfor (let i = 0; i < markers.length; i++) {\n\t\t\tconst m = markers[i];\n\t\t\tif (m.now) {\n\t\t\t\tm.start_date = new Date();\n\t\t\t\tif (!m.$interval)\n\t\t\t\t\tm.$interval = setInterval(\n\t\t\t\t\t\titem => {\n\t\t\t\t\t\t\tconst node = this.containerForMarkers.querySelector(\n\t\t\t\t\t\t\t\t`[gantt_now=\"${item.$interval}\"]`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tnode.style.left = this.GetMarkerPosition(new Date()) + \"px\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\t5 * 60 * 1000,\n\t\t\t\t\t\tm\n\t\t\t\t\t);\n\t\t\t}\n\t\t\thtml.push(this.MarkerTemplate(markers[i]));\n\t\t}\n\t\tthis.containerForMarkers.innerHTML = html.join(\"\");\n\t}\n\n\t/**\n\t * Returns a string with HTML content of a marker\n\t * @param {Object} obj - marker settings\n\t * @returns {string}\n\t */\n\tMarkerTemplate(obj) {\n\t\tconst text = obj.text\n\t\t\t? `<span class=\"webix_gantt_marker_text\">${obj.text}</span>`\n\t\t\t: \"\";\n\n\t\treturn `<div\n\t\t\tgantt_now=\"${obj.$interval}\"\n\t\t\tclass=\"webix_gantt_marker ${obj.css || \"\"}\"\n\t\t\tstyle=\"left:${this.GetMarkerPosition(obj.start_date)}px\">${text}</div>`;\n\t}\n\n\t/**\n\t * Calculates new X position of a marker based on its date\n\t * @param {Date} date - the date from marker settings\n\t * @returns {number}\n\t */\n\tGetMarkerPosition(date) {\n\t\tconst { start, end, cellWidth, diff, minUnit } = this.Local.getScales();\n\t\tconst astart = this.Helpers.getUnitStart(minUnit, start);\n\n\t\treturn date < start || date > end\n\t\t\t? -100\n\t\t\t: Math.round(\n\t\t\t\t\tdiff(date, astart, webix.Date.startOnMonday, true) * cellWidth\n\t\t\t  );\n\t}\n\n\t/**\n\t * Returns a string with SVG with all links or a temp link\n\t * @param {string} lines - all lines as SVG polylines\n\t * @param {string} css - the name of CSS class for SVG (by default 'webix_gantt_lines' or 'webix_gantt_temp_line')\n\t * @returns {string}\n\t */\n\tLinksTemplate(lines, css) {\n\t\tconst bars = this.Bars.$view;\n\n\t\treturn `<svg\n\t\t\tclass=\"${css}\"\n\t\t\tviewBox=\"${this.State.left} ${this.State.top} ${bars.scrollWidth} ${bars.scrollHeight}\"\n\t\t\twidth=\"${bars.scrollWidth}\"\n\t\t\theight=\"${bars.scrollHeight}\"\n\t\t>${lines}</svg>`;\n\t}\n\n\t/**\n\t * Re-renders links\n\t */\n\tRefreshLinks() {\n\t\tconst lines = [];\n\t\t// check to skip multiple re-rendering initially\n\t\tif (this.LinksData.count() && this.VisibleTasks.count()) {\n\t\t\tconst links = this.LinksData;\n\t\t\tlinks.order.each(id => {\n\t\t\t\tconst link = links.getItem(id);\n\t\t\t\tif (link.$p) {\n\t\t\t\t\tlet critical =\n\t\t\t\t\t\tthis.State.criticalPath && this.Local.isLinkCritical(link);\n\t\t\t\t\tlines.push(\n\t\t\t\t\t\t`<polyline data-id=\"${id}\" ${\n\t\t\t\t\t\t\tcritical ? \"class='webix_gantt_line_critical'\" : \"\"\n\t\t\t\t\t\t} points=\"${link.$p}\" />`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst html =\n\t\t\tthis.LinksTemplate(lines.join(\"\"), \"webix_gantt_lines\") +\n\t\t\tthis.LinksTemplate('<polyline points=\"\" />', \"webix_gantt_temp_line\");\n\t\tthis.Links.setHTML(html);\n\t}\n\n\t/**\n\t * Refreshes links of a task\n\t * @param {string, number} tid - the ID of a task\n\t */\n\tRefreshTaskLinks(tid) {\n\t\tthis.LinksData.find(a => a.source == tid || a.target == tid).forEach(\n\t\t\tobj => {\n\t\t\t\tconst l = this.Links.$view.querySelector(`[data-id=\"${obj.id}\"]`);\n\t\t\t\tif (l) {\n\t\t\t\t\tconst s = this.VisibleTasks.getItem(obj.source);\n\t\t\t\t\tconst e = this.VisibleTasks.getItem(obj.target);\n\t\t\t\t\tthis.Helpers.updateLink(obj, s, e);\n\t\t\t\t\tl.setAttribute(\"points\", obj.$p);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Changes the width of the root component (list with bars)\n\t * @param {number} width\n\t */\n\tResize(width) {\n\t\tconst area = this.Bars.$view.querySelector(\".webix_scroll_cont\");\n\t\tarea.style.width = width + \"px\";\n\t\tarea.style.minHeight = \"1px\";\n\n\t\tif (this.selLine) this.selLine.style.width = width + \"px\";\n\t}\n\n\t/**\n\t * Handles actions with tasks\n\t * @param {Object} obj - settings of an action\n\t * @returns {Promise} - the result of asynchronous operations or an empty promise\n\t */\n\tAction(obj) {\n\t\tconst ops = this.app.getService(\"operations\");\n\t\t/**\n\t\t * Some actions invoke server-side request\n\t\t * therefore we need show progress bar for them\n\t\t */\n\t\tlet inProgress = null;\n\n\t\tif (obj.action === \"update-task-time\") {\n\t\t\tif (obj.time) {\n\t\t\t\tinProgress = ops.updateTaskTime(obj.id, obj.mode, obj.time);\n\t\t\t} else {\n\t\t\t\tthis.Local.refreshTasks(obj.id);\n\t\t\t\tif (this.State.display === \"resources\") {\n\t\t\t\t\tthis.VisibleTasks.refresh(obj.id);\n\t\t\t\t}\n\t\t\t\tthis.RefreshTaskLinks(obj.id);\n\t\t\t}\n\t\t} else if (obj.action === \"update-task-progress\") {\n\t\t\tif (!webix.isUndefined(obj.progress)) {\n\t\t\t\tinProgress = ops.updateTask(obj.id, { progress: obj.progress });\n\t\t\t} else {\n\t\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\t\tthis.Bars.render(obj.id, task, \"paint\");\n\t\t\t}\n\t\t} else if (obj.action === \"drag-task\") {\n\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\ttask.$x = parseInt(obj.left);\n\t\t\ttask.$w = parseInt(obj.width);\n\n\t\t\tthis.RefreshTaskLinks(obj.id);\n\t\t} else if (obj.action === \"add-link\") {\n\t\t\tconst { source, target, type } = obj;\n\t\t\tinProgress = ops.addLink({ source, target, type });\n\t\t} else if (obj.action === \"temp-link\") {\n\t\t\tconst { start, end } = obj;\n\t\t\tconst link = this.GetLinks(true).firstChild;\n\n\t\t\tif (!start) {\n\t\t\t\tlink.setAttribute(\"points\", \"\");\n\t\t\t} else {\n\t\t\t\tconst { left, top, p } = this.app\n\t\t\t\t\t.getService(\"helpers\")\n\t\t\t\t\t.newLink(this.Links.$view.getBoundingClientRect(), start, end);\n\t\t\t\tconst shift = [left, top];\n\t\t\t\tconst points = p\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.map((a, i) => a * 1 + shift[i % 2])\n\t\t\t\t\t.join(\",\");\n\n\t\t\t\tlink.setAttribute(\"points\", points);\n\t\t\t}\n\t\t} else if (obj.action === \"add-task\") {\n\t\t\tconst scales = this.Local.getScales();\n\t\t\tconst unit = scales.precise\n\t\t\t\t? this.Helpers.getSmallerUnit(scales.minUnit)\n\t\t\t\t: scales.minUnit;\n\t\t\tconst start = this.Helpers.addUnit(unit, scales.start, obj.dates.start);\n\t\t\tconst end = this.Helpers.addUnit(unit, start, obj.dates.end);\n\t\t\tthis.app.callEvent(\"task:add\", [obj.id, { start, end }]);\n\t\t} else if (\n\t\t\tobj.action === \"split-resize\" &&\n\t\t\tthis.State.display !== \"resources\"\n\t\t) {\n\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\tif (task.parent != 0) {\n\t\t\t\tconst parent = this.VisibleTasks.getItem(task.parent);\n\t\t\t\tif (parent.type === \"split\") {\n\t\t\t\t\tconst splitCont = this.Bars.$view.querySelector(\n\t\t\t\t\t\t`[webix_s_id=\"${task.parent}\"]`\n\t\t\t\t\t);\n\t\t\t\t\tparent.$data.sort((a, b) => b.$x - a.$x);\n\t\t\t\t\tconst { width, left } = this.GetSplitBox(parent);\n\t\t\t\t\tsplitCont.style.width = `${width}px`;\n\t\t\t\t\tsplitCont.style.left = `${left}px`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn inProgress || webix.promise.resolve();\n\t}\n\n\t/**\n\t * Adds the layer for holiday highlighting and renders it\n\t * @param {Object} scales - current scales\n\t */\n\tHandleHolidays(scales) {\n\t\tlet html =\n\t\t\t\"<div class='webix_gantt_bar_holidays' style='height:\" +\n\t\t\tthis.Bars.$view.scrollHeight +\n\t\t\t\"px'></div>\";\n\t\tif (this.Calendars)\n\t\t\thtml +=\n\t\t\t\t\"<div class='webix_gantt_bar_resource_holidays' style='height:\" +\n\t\t\t\tthis.Bars.$view.scrollHeight +\n\t\t\t\t\"px'></div>\";\n\t\tthis.Holidays.setHTML(html);\n\t\tthis.holidaysContainer = this.Holidays.$view.querySelector(\n\t\t\t\".webix_gantt_bar_holidays\"\n\t\t);\n\t\tthis.resHolidaysContainer = this.Holidays.$view.querySelector(\n\t\t\t\".webix_gantt_bar_resource_holidays\"\n\t\t);\n\t\tthis.RenderHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => this.RenderHolidays(scales));\n\t\tthis.on(this.app.getRoot(), \"onViewShow\", () => {\n\t\t\tthis.refresh();\n\t\t});\n\t}\n\n\tEachScaleDate(scales, func) {\n\t\tif (scales.minUnit === \"day\" || scales.minUnit === \"hour\") {\n\t\t\tlet date = webix.Date.copy(scales.start);\n\n\t\t\tlet end = webix.Date.dayStart(scales.end);\n\t\t\tif (!(scales.end - end)) {\n\t\t\t\tend = webix.Date.add(end, -1, \"day\", true);\n\t\t\t}\n\n\t\t\tlet hourOffset = scales.start.getHours();\n\n\t\t\twhile (date <= end) {\n\t\t\t\tfunc.call(this, date, hourOffset);\n\t\t\t\tdate = webix.Date.add(webix.Date.dayStart(date), 1, \"day\", true);\n\t\t\t\thourOffset = webix.Date.equal(date, end)\n\t\t\t\t\t? 24 - Math.ceil(webix.Date.timePart(scales.end) / 60 / 60)\n\t\t\t\t\t: 0;\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Renders holiday highlighting\n\t * @param {Object} scales - current scales\n\t */\n\tRenderHolidays(scales) {\n\t\tif (this.holidaysContainer) {\n\t\t\tlet html = \"\";\n\t\t\tthis.EachScaleDate(scales, (date, hourOffset) => {\n\t\t\t\tif (scales.isHoliday(date)) {\n\t\t\t\t\thtml += this.HolidayTemplate(scales, date, hourOffset);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.holidaysContainer.innerHTML = html;\n\n\t\t\tif (this.Calendars) this.RenderResourceHolidays(scales);\n\t\t}\n\t}\n\tMarkResourceHolidays(scales, id, calendar) {\n\t\tlet index = this.Bars.getIndexById(id);\n\t\tif (index < 0) return \"\";\n\t\tlet html = \"\",\n\t\t\tn = 0,\n\t\t\tdateStart = null;\n\n\t\tthis.EachScaleDate(scales, (date, hourOffset) => {\n\t\t\tconst isHoliday = scales.isHoliday(date);\n\t\t\tif (this.Helpers.isResourceHoliday(date, calendar)) {\n\t\t\t\tif (!isHoliday) {\n\t\t\t\t\tif (!n) dateStart = date;\n\t\t\t\t\tn++;\n\t\t\t\t} else if (n) {\n\t\t\t\t\thtml += this.ResourceHolidayTemplate(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdateStart,\n\t\t\t\t\t\thourOffset,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tn\n\t\t\t\t\t);\n\t\t\t\t\tn = 0;\n\t\t\t\t}\n\t\t\t} else if (isHoliday) {\n\t\t\t\tif (n) {\n\t\t\t\t\thtml += this.ResourceHolidayTemplate(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdateStart,\n\t\t\t\t\t\thourOffset,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tn\n\t\t\t\t\t);\n\t\t\t\t\tn = 0;\n\t\t\t\t}\n\t\t\t\thtml += this.ResourceWorkDayTemplate(scales, date, hourOffset, index);\n\t\t\t}\n\t\t});\n\t\treturn html;\n\t}\n\tRenderResourceHolidays(scales) {\n\t\tif (this.resHolidaysContainer) {\n\t\t\tscales = scales || this.Local.getScales();\n\t\t\tthis.Local.taskCalendarMap().then(data => {\n\t\t\t\tlet html = \"\";\n\t\t\t\tif (data)\n\t\t\t\t\tfor (let taskId in data)\n\t\t\t\t\t\thtml += this.MarkResourceHolidays(scales, taskId, data[taskId]);\n\t\t\t\tthis.resHolidaysContainer.innerHTML = html;\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Returns a size and position of a date column / cell\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task / row index ( optional )\n\t * @returns {object}\n\t */\n\tGetDateBox(scales, date, hourOffset, i) {\n\t\tconst astart = this.Helpers.getUnitStart(scales.minUnit, scales.start);\n\t\tconst x = Math.round(scales.diff(date, astart) * scales.cellWidth);\n\t\tconst w =\n\t\t\t(scales.minUnit === \"hour\" ? 24 - hourOffset : 1) * scales.cellWidth;\n\t\tlet box = { x, w };\n\t\tif (i || i === 0) {\n\t\t\tbox.y = scales.cellHeight * i;\n\t\t\tbox.h = scales.cellHeight;\n\t\t}\n\t\treturn box;\n\t}\n\t/**\n\t * Returns a string with HTML of 1 holiday highlight element\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @returns {string}\n\t */\n\tHolidayTemplate(scales, date, hourOffset) {\n\t\tconst { x, w } = this.GetDateBox(scales, date, hourOffset);\n\t\tconst style = `left:${x}px;width:${w}px;`;\n\t\treturn \"<div class='webix_gantt_holiday' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML of holiday unit\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the start date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task index\n\t * @param {number} n - a number of holiday dates to include\n\t * @returns {string}\n\t */\n\tResourceHolidayTemplate(scales, date, hourOffset, i, n) {\n\t\tconst { x, y, w, h } = this.GetDateBox(scales, date, hourOffset, i);\n\t\tconst style = `left:${x}px;width:${w * n}px;top:${y}px;height:${h}px;`;\n\t\treturn \"<div class='webix_gantt_holiday' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML of work day unit\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task index\n\t * @returns {string}\n\t */\n\tResourceWorkDayTemplate(scales, date, hourOffset, i) {\n\t\tconst { x, y, w, h } = this.GetDateBox(scales, date, hourOffset, i);\n\t\tconst style = `left:${x + 0.2}px;width:${w - 1.2}px;top:${y}px;height:${h -\n\t\t\t1}px;`;\n\t\treturn \"<div class='webix_gantt_work_day' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML content of a tooltip for tasks\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string}\n\t */\n\tGetTooltip(obj, _) {\n\t\tconst parser = webix.i18n.longDateFormatStr;\n\t\tlet tip = `${obj.text || _(\"(no title)\")}<br>\n\t\t\t<br>${_(\"Start date\")}: ${parser(obj.start_date)}`;\n\n\t\tif (obj.type != \"milestone\") {\n\t\t\ttip += `<br>${_(\"End date\")}: ${parser(obj.end_date)}\n\t\t\t<br>${_(\"Lasts\")} ${obj.duration} ${obj.duration > 1 ? _(\"days\") : _(\"day\")}`;\n\t\t}\n\t\treturn tip;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ScalesView extends JetView {\n\tconfig() {\n\t\treturn { view: \"template\", height: 20, css: \"webix_gantt_scale\" };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tconst scales = this.Local.getScales();\n\t\tthis.RenderScales(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => this.RenderScales(scales));\n\t}\n\n\tready() {\n\t\tconst view = this.getRoot();\n\t\tthis.on(this.State.$changes, \"left\", x => view.scrollTo(x, null));\n\t}\n\n\t/**\n\t * Renders gantt scales\n\t * @param {Object} s - the object that stores the data of current scales\n\t */\n\tRenderScales(s) {\n\t\tconst view = this.getRoot();\n\t\tconst html = s.rows\n\t\t\t.map(line => {\n\t\t\t\tconst canMarkHolidays =\n\t\t\t\t\t(line.type === \"hour\" || line.type === \"day\") && line.step === 1;\n\t\t\t\treturn (\n\t\t\t\t\t`<div class=\"webix_gantt_scale_row\" style='height:${line.height}px;width:${s.width}px'>` +\n\t\t\t\t\tline.cells\n\t\t\t\t\t\t.map(cell => this.CellTemplate(cell, canMarkHolidays))\n\t\t\t\t\t\t.join(\"\") +\n\t\t\t\t\t\"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tview.config.height = s.height;\n\t\tview.setHTML(html);\n\t\tview.resize();\n\t}\n\n\t/**\n\t * Returns the template string for a scale unit\n\t * @param {Object} cell - a scale unit\n\t * @param {boolean} canMarkHolidays - signals whether to add styling for holidays\n\t * @returns {string} - the template string of the scale cell\n\t */\n\tCellTemplate(cell, canMarkHolidays) {\n\t\treturn `<div class=\"webix_gantt_scale_cell ${cell.css +\n\t\t\t(canMarkHolidays && this.app.config.isHoliday(cell.date)\n\t\t\t\t? \"webix_gantt_holiday_scale\"\n\t\t\t\t: \"\")}\" style=\"width:${cell.width}px;\">${this.FormatDate(\n\t\t\tcell.date,\n\t\t\tcell.format\n\t\t)}</div>`;\n\t}\n\n\tFormatDate(date, format) {\n\t\tif (typeof format === \"string\") format = webix.Date.dateToStr(format);\n\t\treturn format(date);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nimport ScaleView from \"./scale\";\nimport BarsView from \"./bars\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\treturn { rows: [ScaleView, BarsView] };\n\t}\n\tinit() {\n\t\tthis.on(this.app, \"bars:toggle\", v => {\n\t\t\tif (v) this.getRoot().show();\n\t\t\telse this.getRoot().hide();\n\t\t});\n\t}\n}\n","import BarsView from \"../chart/bars\";\n\nexport default class DiagramView extends BarsView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\treturn {\n\t\t\tview: \"abslayout\",\n\t\t\tcss: \" webix_gantt_readonly\",\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_holidays\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"tree\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttype: this.WorkloadMarkersType(),\n\t\t\t\t\tcss: `webix_gantt${\n\t\t\t\t\t\twebix.env.touch ? \"_touch\" : \"\"\n\t\t\t\t\t}_bars webix_gantt_resdiagram_chart`,\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t\trelative: true,\n\t\t\t\t\tfilterMode: {\n\t\t\t\t\t\tshowSubItems: false,\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tconst [holidays, bars] = view.getChildViews();\n\t\tthis.Holidays = holidays;\n\t\tthis.Bars = bars;\n\t\tthis.LocalState = this.getParam(\"localState\");\n\t\tthis.Unit = \"hours\";\n\n\t\tconst local = (this.Local = this.app.getService(\"local\"));\n\t\tconst scales = (this.Scales = local.getScales());\n\t\tthis.RDCollection = this.app.getService(\"grouping\").getRDCollection();\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\tthis.on(this.Bars.data, \"onSyncApply\", () => {\n\t\t\tthis.Scales = this.Local.getScales();\n\t\t\tthis.RestoreTreeState();\n\t\t\tif (this.Calendars) this.RenderResourceHolidays();\n\t\t});\n\n\t\tthis.Bars.sync(this.RDCollection, function() {\n\t\t\tthis.filter(t => t.$group);\n\t\t});\n\n\t\tthis.Calendars = this.app.config.resourceCalendars;\n\n\t\t// leave here for app.refresh() calls (inc. from Locale plugin)\n\t\tthis.DrawGrid(view, scales);\n\n\t\t// the order of DrawGrid-HandleScroll and HandleHolidays is important for the case when\n\t\t// main gantt chart is scrolled x and the diagram is empty or has something only in the\n\t\t// beginning of x-axis\n\t\tthis.HandleScroll();\n\t\tthis.HandleHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tthis.DrawGrid(view, scales);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:branch:toggle\", (id, v) => {\n\t\t\tthis.ToggleBranch(id, v);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:resize\", () => {\n\t\t\tthis.holidaysContainer.style.height = this.Bars.$view.scrollHeight + \"px\";\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:sort\", (by, dir, as) => {\n\t\t\tif (by) this.Bars.sort(by, dir, as);\n\t\t\telse this.Bars.sort(as, dir);\n\t\t});\n\n\t\tif (this.Calendars)\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", () => {\n\t\t\t\tthis.RenderResourceHolidays();\n\t\t\t});\n\t}\n\n\t/**\n\t * Opens or closes a branch of the diagram\n\t * @param {number} id - the id of a branch\n\t * @param {Boolean} v - if true, the branch will be opened; false - closed\n\t */\n\tToggleBranch(id, v) {\n\t\tif (v) this.Bars.open(id);\n\t\telse this.Bars.close(id);\n\n\t\tconst root = this.Bars.data.getBranch(\"0\");\n\t\tconst opened = this.Bars.getState().open.filter(i => {\n\t\t\treturn root.find(o => o.id == i);\n\t\t});\n\n\t\tthis._treeOpened = opened.map(id => this.Bars.getIndexById(id));\n\n\t\tthis.holidaysContainer.style.height = this.Bars.$view.clientHeight + \"px\";\n\t\tif (this.Calendars) {\n\t\t\tthis.resHolidaysContainer.style.height =\n\t\t\t\tthis.Bars.$view.clientHeight + \"px\";\n\t\t\tthis.RenderResourceHolidays();\n\t\t}\n\t}\n\n\t/**\n\t * Restores opened/closed branches after diagram update and regroup\n\t */\n\tRestoreTreeState() {\n\t\tif (this._treeOpened && this._treeOpened.length) {\n\t\t\tconst t = this._treeOpened;\n\t\t\tconst root = this.Bars.data.getBranch(\"0\");\n\t\t\troot.forEach(b => {\n\t\t\t\tconst ind = root.indexOf(b);\n\t\t\t\tb.open = !t.indexOf(ind);\n\t\t\t\tthis.Bars.data.callEvent(\"onStoreUpdated\", [b.id, 0, \"branch\"]);\n\t\t\t});\n\t\t} else this.Bars.openAll();\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\t\t\tthis.getRoot().$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.State.left = left;\n\t\t\tthis.LocalState.top = top;\n\t\t\tthis.SetHolidaysScroll(bars.scrollHeight, left, top);\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"top\", y => {\n\t\t\tthis.Bars.scrollTo(this.State.left, y);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"left\", v => {\n\t\t\tthis.Bars.scrollTo(v, this.LocalState.top);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:unit:change\", u => {\n\t\t\tthis.Unit = u;\n\t\t\tthis.Bars.render();\n\t\t});\n\t}\n\n\t/**\n\t * Returns all templates for bars\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {Object} - all templates for bars\n\t */\n\tWorkloadMarkersType() {\n\t\treturn {\n\t\t\ttemplate: task => this.MarkerTemplate(task),\n\t\t\ttemplateStart: (task, common) => this.MarkerStartTemplate(task, common),\n\t\t\ttemplateEnd: () => \"</div>\",\n\t\t};\n\t}\n\n\t/**\n\t * Defines the html of the data item of the diagram tree\n\t * @param {Object} task - data object\n\t * @returns {string} with HTML\n\t */\n\tMarkerStartTemplate(task, common) {\n\t\treturn `<div webix_tm_id=\"${task.id}\" style=\"height:${this.Scales\n\t\t\t.cellHeight - 8}px; padding: 4px;\" class=\"${common.classname(\n\t\t\ttask,\n\t\t\tcommon\n\t\t)} webix_gantt_diagram_line\" ${common.aria(task)}>`;\n\t}\n\n\t/**\n\t * Defines the looks and contents of a diagram workload marker\n\t * @param {Object} task - data object\n\t * @returns {string} with HTML\n\t */\n\tMarkerTemplate(task) {\n\t\tif (task.$level === 2) {\n\t\t\tconst markers = this.GetMarkerData(task);\n\n\t\t\tconst html = [];\n\t\t\tfor (const x in markers) {\n\t\t\t\thtml.push(this.MarkerToHTML(markers[x]));\n\t\t\t}\n\n\t\t\treturn html.join(\"\");\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tCheckResourceHoliday(date, id) {\n\t\tif (this.Calendars) {\n\t\t\tconst resId = this.Bars.getItem(id).resource_id;\n\t\t\tif (resId) {\n\t\t\t\tconst calendarId = this.Local.resources().getItem(resId).calendar_id;\n\t\t\t\tif (calendarId) {\n\t\t\t\t\tconst calendar = this.Local.calendars().getItem(calendarId);\n\t\t\t\t\treturn this.Helpers.isResourceHoliday(date, calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.app.config.isHoliday(date);\n\t}\n\t/**\n\t * Calculates work load per unit and prepares the result for display on the diagram\n\t * @param {Object} task - the data object of the data collection\n\t * @returns {Object} an object with x coordinates as keys and marker data objects and values (hours, count of tasks)\n\t */\n\tGetMarkerData(task) {\n\t\tconst markers = {};\n\t\tfor (let a = 0; a < task.duration.length; ++a) {\n\t\t\tlet d = task.duration[a];\n\t\t\tconst hourParts = task.units[a];\n\t\t\tconst delta = task.$x[a] - Math.min(...task.$x);\n\n\t\t\tconst markerWidth = this.Scales.cellHeight > 40 ? 28 : 20;\n\t\t\tconst step = this.Scales.cellWidth - markerWidth;\n\t\t\tconst halfStep = Math.round(step / 2);\n\t\t\tlet x = delta ? -2 : halfStep;\n\t\t\tlet date = webix.Date.copy(task.start_date[a]);\n\t\t\tfor (let i = 0; i < d; ++i, x += step) {\n\t\t\t\tif (\n\t\t\t\t\tthis.app.config.excludeHolidays &&\n\t\t\t\t\tthis.CheckResourceHoliday(date, task.id)\n\t\t\t\t) {\n\t\t\t\t\t++d;\n\t\t\t\t} else {\n\t\t\t\t\tlet hours = 0;\n\t\t\t\t\tif (this.Scales.minUnit !== \"hour\")\n\t\t\t\t\t\thours =\n\t\t\t\t\t\t\t(i === d - 1 ? hourParts[1] : i ? hourParts[2] : hourParts[0]) ||\n\t\t\t\t\t\t\thourParts[2];\n\t\t\t\t\telse {\n\t\t\t\t\t\thours = hourParts[2];\n\t\t\t\t\t}\n\n\t\t\t\t\tconst cell = task.$x[a] + i * this.Scales.cellWidth - 2;\n\t\t\t\t\tif (!markers[cell]) {\n\t\t\t\t\t\tmarkers[cell] = { hours, x: cell + halfStep, count: 1 };\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarkers[cell].hours += hours;\n\t\t\t\t\t\tmarkers[cell].count += 1;\n\t\t\t\t\t}\n\t\t\t\t\tmarkers[cell].overloaded = this.CheckOverload(markers[cell], task);\n\t\t\t\t}\n\t\t\t\twebix.Date.add(date, 1, this.Scales.minUnit);\n\t\t\t}\n\t\t}\n\n\t\treturn markers;\n\t}\n\n\t/**\n\t * Checks if a resource is overloaded during this unit of time\n\t * @param {Object} marker - the data of a diagram marker for one unit\n\t * @returns {boolean} true if during this unit resource is overloaded with work\n\t */\n\tCheckOverload(marker) {\n\t\tif (this.Scales.minUnit === \"hour\") {\n\t\t\t// temp until full support for hourly duration is done\n\t\t\treturn Math.round(marker.hours * 24) > this.Helpers.unitLoadNorm.day;\n\t\t}\n\t\treturn marker.hours > this.Helpers.unitLoadNorm[this.Scales.minUnit];\n\t}\n\n\t/**\n\t * Returns the html of a marker\n\t * @param {Object} marker - an object with data for a marker (hours, count of tasks)\n\t */\n\tMarkerToHTML(marker) {\n\t\tconst over = marker.overloaded ? \"webix_gantt_overload\" : \"\";\n\t\tconst number =\n\t\t\tthis.Unit === \"hours\"\n\t\t\t\t? marker.hours >= 1\n\t\t\t\t\t? marker.hours\n\t\t\t\t\t: \" \"\n\t\t\t\t: marker.count;\n\t\treturn `<div class=\"webix_gantt_diagram_marker ${over}\" style=\"left:${marker.x}px;\">${number}</div>`;\n\t}\n\n\tRenderResourceHolidays(scales) {\n\t\tscales = scales || this.Local.getScales();\n\t\tlet html = \"\";\n\t\tthis.Bars.data.each(data => {\n\t\t\tif (data.resource_id) {\n\t\t\t\tconst calendarId = this.Local.resources().getItem(data.resource_id)\n\t\t\t\t\t.calendar_id;\n\t\t\t\tif (calendarId)\n\t\t\t\t\thtml += this.MarkResourceHolidays(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdata.id,\n\t\t\t\t\t\tthis.Local.calendars().getItem(calendarId)\n\t\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\tthis.resHolidaysContainer.innerHTML = html;\n\t}\n}\n","/**\n * Prepares a sorting function with locale-based comparison\n * @param {string} by - column ID\n * @returns {function} sorting function\n */\nexport function sort(by) {\n\treturn (a, b) =>\n\t\ta[by].localeCompare(b[by], undefined, {\n\t\t\tignorePunctuation: true,\n\t\t\tnumeric: true,\n\t\t});\n}\n\n/**\n * Check if two arrays contain same elements\n * @param {array} a - an array\n * @param {array} b - an array\n * @returns {boolean} true if two arrays contain same elements\n */\nexport function arrayEquals(a, b) {\n\treturn a && a.length == b.length && a.every(item => b.includes(item));\n}\n","import { JetView } from \"webix-jet\";\nimport { sort } from \"../../helpers/common\";\n\nexport default class TreeView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst scales = this.app.getService(\"local\").getScales();\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst compact = (this.Compact = this.getParam(\"compact\", true));\n\n\t\tconst columns = [\n\t\t\t{\n\t\t\t\tid: \"name\",\n\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\theader: compact ? \"<span class='webix_icon gti-menu'>\" : _(\"Name\"),\n\t\t\t\ttemplate: (obj, common) => this.TreeTemplate(obj, common),\n\t\t\t\tfillspace: true,\n\t\t\t\tsort: compact ? \"\" : sort(\"name\"),\n\t\t\t\tminWidth: compact ? 44 : 150,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"load\",\n\t\t\t\theader: _(\"Hours\"),\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"hours\",\n\t\t\t\tsort: \"int\",\n\t\t\t\tminWidth: 50,\n\t\t\t\tresize: false,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"count\",\n\t\t\t\theader: _(\"Tasks\"),\n\t\t\t\tbatch: \"tasks\",\n\t\t\t\tsort: \"int\",\n\t\t\t\tminWidth: 50,\n\t\t\t\thidden: true,\n\t\t\t\tresize: false,\n\t\t\t},\n\t\t];\n\n\t\tconst skin = webix.skin.$name;\n\t\tconst headerCss =\n\t\t\tskin == \"material\" || skin == \"mini\" ? \"webix_header_border\" : \"\";\n\t\tconst tree = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_resdiagram_tree \" + headerCss,\n\t\t\tprerender: true,\n\t\t\tborderless: skin === \"contrast\",\n\t\t\twidth: compact ? 44 : this.State.treeWidth,\n\t\t\trowHeight: scales.cellHeight,\n\t\t\theaderRowHeight: scales.height,\n\t\t\tscroll: \"xy\",\n\t\t\tscrollAlignY: false,\n\t\t\tsort: true,\n\t\t\tresizeColumn: {\n\t\t\t\theaderOnly: true,\n\t\t\t\tsize: 10,\n\t\t\t},\n\t\t\tcolumns,\n\t\t\ttooltip: () => \"\",\n\t\t\ton: {\n\t\t\t\tonViewResize: () => {\n\t\t\t\t\tthis.State.treeWidth = this.Tree.$width;\n\t\t\t\t},\n\t\t\t\tonAfterOpen: id => this.ToggleBranch(id, 1),\n\t\t\t\tonAfterClose: id => this.ToggleBranch(id, 0),\n\t\t\t\tonAfterSort: (by, dir, as) => this.SortTasks(by, dir, as),\n\t\t\t\tonColumnResize: (id, v, o, user) => this.NormalizeColumns(id, user),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"gti-menu\": () => this.ToggleColumns(),\n\t\t\t},\n\t\t\tfilterMode: {\n\t\t\t\tshowSubItems: false,\n\t\t\t\tlevel: 0,\n\t\t\t},\n\t\t};\n\n\t\tconst ls = (this.LocalState = this.getParam(\"localState\"));\n\t\ttree.on[\"onScrollY\"] = tree.on[\"onSyncScroll\"] = tree.on[\n\t\t\t\"onAfterScroll\"\n\t\t] = function() {\n\t\t\tls.top = this.getScrollState().y;\n\t\t};\n\t\treturn tree;\n\t}\n\n\tinit(view) {\n\t\tthis.Tree = view;\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.RDCollection = this.app.getService(\"grouping\").getRDCollection();\n\t\tthis._unit = \"hours\";\n\t\tthis._collapsed = true;\n\n\t\tthis.on(this.LocalState.$changes, \"top\", y => {\n\t\t\tthis.Tree.scrollTo(null, y);\n\t\t});\n\n\t\tthis.on(this.Tree.data, \"onSyncApply\", () => this.RestoreTreeState());\n\n\t\tview.sync(this.RDCollection, function() {\n\t\t\tthis.filter(t => t.$group);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"treeWidth\", v => {\n\t\t\tif (!this.Compact && view.$width !== v) {\n\t\t\t\tview.define({ width: v });\n\t\t\t\tview.resize();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:unit:change\", u => this.ShowInUnits(u));\n\n\t\t// resetting headerRowHeight\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tconst col = this.Tree.columnId(0);\n\t\t\tthis.Tree.getColumnConfig(col).header[0].height = scales.height;\n\t\t\tthis.Tree.refreshColumns();\n\t\t});\n\t}\n\n\t/**\n\t * Opens/closes same branches as were opened/closed before updates\n\t */\n\tRestoreTreeState() {\n\t\tif (this._treeOpened && this._treeOpened.length) {\n\t\t\tconst t = this._treeOpened;\n\t\t\tconst root = this.Tree.data.getBranch(\"0\");\n\t\t\troot.forEach(b => {\n\t\t\t\tconst ind = root.indexOf(b);\n\t\t\t\tb.open = !t.indexOf(ind);\n\t\t\t\tthis.Tree.data.callEvent(\"onStoreUpdated\", [b.id, 0, \"branch\"]);\n\t\t\t});\n\t\t} else this.Tree.openAll();\n\t}\n\n\t/**\n\t * Defines the look of a tree item\n\t * @param {Object} obj - data object of a tree item\n\t * @param {Object} common - type object of tree\n\t */\n\tTreeTemplate(obj, common) {\n\t\tconst compact = this.Compact && this._collapsed;\n\t\tif (obj.$level == 1)\n\t\t\treturn compact\n\t\t\t\t? common.icon(obj)\n\t\t\t\t: common.treetable(obj, common) + obj.category;\n\n\t\tif (compact) return this.Helpers.resourceAvatar(obj);\n\t\treturn common.space(obj) + this.Helpers.resourceAvatar(obj) + obj.name;\n\t}\n\n\t/**\n\t * Shows total workload in tasks or hours\n\t * @param {string} u - \"tasks\" or \"hours\"\n\t */\n\tShowInUnits(u) {\n\t\tthis._unit = u;\n\t\tconst tree = this.Tree;\n\t\tconst cols = tree.config.columns;\n\t\tconst lastFillspace = cols[cols.length - 1].fillspace;\n\t\tif (!this.Compact || !this._collapsed) tree.showColumnBatch(u);\n\t\t// columns normalizing\n\t\tthis.SetColumns(0, lastFillspace);\n\t}\n\n\t/**\n\t * Adjusts columns after resizing\n\t * @param {string} id - ID of the column being resized\n\t * @param {boolean} user - defines whether resizing was triggered by user or API\n\t */\n\tNormalizeColumns(id, user) {\n\t\tif (!user) return;\n\t\tthis.SetColumns(this.Tree.getColumnIndex(id), true);\n\t}\n\n\tSetColumns(index, fillspace) {\n\t\tconst columns = this.Tree.config.columns;\n\t\tconst last = columns.length - 1;\n\t\tif (index === 0) {\n\t\t\tcolumns[last].fillspace = fillspace;\n\t\t\tcolumns[last].width = 0;\n\t\t\tcolumns[last].resize = false;\n\t\t} else if (index === last) {\n\t\t\tcolumns[0].fillspace = true;\n\t\t\tcolumns[0].width = 0;\n\t\t}\n\t\tthis.Tree.refreshColumns();\n\t}\n\n\t/** Shows and hides columns in a compact mode */\n\tToggleColumns() {\n\t\t// [todo] toggle tree in compact code\n\t\tconst tree = this.Tree;\n\t\tconst lv = tree.isColumnVisible(\"load\");\n\t\tconst cv = tree.isColumnVisible(\"count\");\n\t\tconst vis = (this._collapsed = lv || cv);\n\n\t\tif (vis) {\n\t\t\tif (lv) tree.hideColumn(\"load\");\n\t\t\tif (cv) tree.hideColumn(\"count\");\n\t\t} else {\n\t\t\tif (this._unit === \"hours\") tree.showColumn(\"load\");\n\t\t\telse tree.showColumn(\"count\");\n\t\t}\n\n\t\ttree.config.width = vis ? 44 : 0;\n\t\tconst nameCol = tree.config.columns[0];\n\t\tnameCol.minWidth = vis ? 44 : 150;\n\t\ttree.resize();\n\t\ttree.refreshColumns();\n\n\t\tthis.app.callEvent(\"rdiagram:tree:toggle\", [vis]);\n\t}\n\n\t/**\n\t * Hides/Shows the lines of the diagram for the closed/opened tree branch\n\t * @param {number} id - the ID of a branch\n\t * @param {Number} v - the state of a branch (1 - opened, 0 - closed)\n\t */\n\tToggleBranch(id, v) {\n\t\tconst root = this.Tree.data.getBranch(\"0\");\n\t\tconst opened = this.Tree.getState().open.filter(i => {\n\t\t\treturn root.find(o => o.id == i);\n\t\t});\n\t\tthis._treeOpened = opened.map(id => this.Tree.getIndexById(id));\n\n\t\tthis.app.callEvent(\"rdiagram:branch:toggle\", [id, v]);\n\t}\n\n\tSortTasks(by, dir, as) {\n\t\tthis.app.callEvent(\"rdiagram:sort\", [by, dir, as]);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TreeView from \"./tree\";\nimport ScalesView from \"../chart/scale\";\nimport DiagramView from \"./diagram\";\n\nimport { createState } from \"jet-restate\";\n\nexport default class RDiagramView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst contrast = webix.skin.$name === \"contrast\";\n\t\tconst unit = this.app.getService(\"local\").getScales().minUnit;\n\t\treturn {\n\t\t\ttype: contrast ? \"clean\" : \"line\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tborderless: contrast,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\twidth: 330,\n\t\t\t\t\t\t\tvalue: \"hours\",\n\t\t\t\t\t\t\tlocalId: \"radio\",\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{ id: \"hours\", value: `${_(\"Hours per\")} ${_(unit)}` },\n\t\t\t\t\t\t\t\t{ id: \"tasks\", value: `${_(\"Tasks per\")} ${_(unit)}` },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: v => {\n\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:unit:change\", [v]);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\tTreeView,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: compact ? \"spacer\" : \"resizer\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\t\t\t\twidth: compact ? 1 : 4,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"diagram\",\n\t\t\t\t\t\t\trows: [ScalesView, DiagramView],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst localState = createState({\n\t\t\ttop: 0,\n\t\t});\n\t\tthis.setParam(\"localState\", localState);\n\n\t\tthis.on(this.app, \"rdiagram:tree:toggle\", v => {\n\t\t\tif (v) this.$$(\"diagram\").show();\n\t\t\telse this.$$(\"diagram\").hide();\n\t\t});\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst radio = this.$$(\"radio\");\n\t\tthis.on(this.app, \"onScalesUpdate\", (scales, old) => {\n\t\t\tif (scales.minUnit !== old.minUnit) {\n\t\t\t\tradio.config.options.map(o => {\n\t\t\t\t\tconst words = o.value.split(\" \");\n\t\t\t\t\twords[words.length - 1] = _(scales.minUnit);\n\t\t\t\t\to.value = words.join(\" \");\n\t\t\t\t});\n\t\t\t\tradio.refresh();\n\t\t\t}\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaselineView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst calendar = {\n\t\t\tcss: \"webix_gantt_datepicker\",\n\t\t\ttype: \"calendar\",\n\t\t\tbody: {\n\t\t\t\theight: 270,\n\t\t\t\twidth: 250,\n\t\t\t\ticons: true,\n\t\t\t\tevents: date => this.app.config.isHoliday(date) && \"webix_cal_event\",\n\t\t\t},\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\tpadding: {\n\t\t\t\tleft: 3,\n\t\t\t\tright: 3,\n\t\t\t},\n\t\t\tvisibleBatch: \"added\",\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tbatch: \"added\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: \"planned_start\",\n\t\t\t\t\t\t\tlabel: _(\"Start date\"),\n\t\t\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: \"planned_end\",\n\t\t\t\t\t\t\tlabel: _(\"End date\"),\n\t\t\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"counter\",\n\t\t\t\t\t\t\tname: \"planned_duration\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_form_counter\",\n\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\tmax: 1000,\n\t\t\t\t\t\t\tlabel: _(\"Duration\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbatch: \"none\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tlabel: _(\"Add dates\"),\n\t\t\t\t\t\t\tclick: () => this.AddBtnClickHandler(),\n\t\t\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbatch: \"added\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-trash\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tlabel: _(\"Remove dates\"),\n\t\t\t\t\t\t\tclick: () => this.RemoveBtnClickHandler(),\n\t\t\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (n, o, config) => {\n\t\t\t\t\tif (this.Compact) this.UpdateTaskTime();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config == \"user\") this.UpdateTask();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Form = this.$$(\"form\");\n\n\t\t// changing links via bars and dnd\n\t\tthis.Tasks = this.app.getService(\"local\").tasks();\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected) this.FillData(id);\n\t\t});\n\t}\n\n\tFillData(id) {\n\t\tconst task = this.Tasks.getItem(id);\n\t\tif (task.planned_start) this.$$(\"form\").showBatch(\"added\");\n\t\telse this.$$(\"form\").showBatch(\"none\");\n\t\tthis.Form.setValues(this.Tasks.getItem(id));\n\t}\n\n\t/**\n\t * Prepares task  object for processing with respect to date-related changes\n\t * @param {Object} vals - object with form values\n\t * @returns {boolean} flag that indicates whether dates were updated or not\n\t */\n\tPrepareDates(vals) {\n\t\tconst f = (this._eventSource = this.Form.$eventSource.config.name);\n\n\t\tlet updateDates = true;\n\t\tif (\n\t\t\tf == \"planned_duration\" ||\n\t\t\t(f == \"planned_start\" && vals.type == \"project\")\n\t\t)\n\t\t\tvals.planned_end = null;\n\t\telse if (f == \"planned_end\" || f == \"planned_start\")\n\t\t\tvals.planned_duration = null;\n\t\telse updateDates = false;\n\n\t\treturn updateDates;\n\t}\n\t/**\n\t * Update task time and duration on data change in compact form\n\t */\n\tUpdateTaskTime() {\n\t\tconst vals = this.Form.getValues();\n\t\tconst updateDates = this.PrepareDates(vals);\n\t\tif (updateDates) {\n\t\t\tlet mode = this._eventSource ? this._eventSource.split(\"_\")[1] : null;\n\t\t\tif (mode == \"duration\") mode = null;\n\n\t\t\tthis.Ops.updatePlannedTaskDuration(vals, mode);\n\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\t}\n\t/**\n\t * Saves changes\n\t * @returns {Promise} the result of a data operation (adding new event or updating)\n\t */\n\tUpdateTask() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tif (!this.Compact) this.PrepareDates(vals);\n\n\t\tlet mode = this._eventSource ? this._eventSource.split(\"_\")[1] : null;\n\t\tif (mode == \"duration\") mode = null;\n\t\tthis.Ops.updateTask(id, vals, mode, false, true);\n\t}\n\tAddBtnClickHandler() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tconst obj = {\n\t\t\tplanned_start: vals.start_date,\n\t\t\tplanned_end: vals.end_date,\n\t\t\tplanned_duration: vals.duration,\n\t\t};\n\t\tthis.Ops.updateTask(id, obj, null, false, true);\n\t}\n\tRemoveBtnClickHandler() {\n\t\tconst id = this.State.selected;\n\t\twebix\n\t\t\t.confirm(this._(\"Planned dates will be removed, are you sure?\"))\n\t\t\t.then(() => {\n\t\t\t\tthis.Ops.updateTask(\n\t\t\t\t\tid,\n\t\t\t\t\t{ planned_start: null, planned_end: null, planned_duration: null },\n\t\t\t\t\tnull,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_tree webix_gantt_form_tree\",\n\t\t\theader: false,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"links\",\n\t\t\tautoheight: true,\n\t\t\teditable: true,\n\t\t\tscroll: false,\n\t\t\thover: \"webix_gantt_link_table_hover\",\n\t\t\tscheme: {\n\t\t\t\t$group: {\n\t\t\t\t\tby: \"ttype\",\n\t\t\t\t},\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"task\",\n\t\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\t\theader: _(\"Task\"),\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\tif (obj.$group)\n\t\t\t\t\t\t\treturn `<span class=\"webix_strong\">${_(\n\t\t\t\t\t\t\t\tobj.ttype == \"source\" ? _(\"Successors\") : _(\"Predecessors\")\n\t\t\t\t\t\t\t)}</span>`;\n\t\t\t\t\t\telse return obj.text || _(\"(no title)\");\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"type\",\n\t\t\t\t\tcss: \"webix_gantt_type\",\n\t\t\t\t\theader: _(\"Link\"),\n\t\t\t\t\twidth: 140,\n\t\t\t\t\ttemplate: function(obj, c, v, conf) {\n\t\t\t\t\t\tif (obj.$group) return \"\";\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconst type = conf.collection.getItem(v).value;\n\t\t\t\t\t\t\treturn `${type}<span class=\"webix_icon wxi-menu-down\"></span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\teditor: \"richselect\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"0\", value: _(\"End to start\") },\n\t\t\t\t\t\t{ id: \"1\", value: _(\"Start to start\") },\n\t\t\t\t\t\t{ id: \"2\", value: _(\"End to end\") },\n\t\t\t\t\t\t{ id: \"3\", value: _(\"Start to end\") },\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 30,\n\t\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\treturn obj.$group\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: \"<span class='webix_icon wxi-trash'></span>\";\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonBeforeEditStart: function(id) {\n\t\t\t\t\treturn !this.getItem(id).$group;\n\t\t\t\t},\n\t\t\t\tonBeforeEditStop: (v, editor) => {\n\t\t\t\t\tif (v.value != v.old) {\n\t\t\t\t\t\tthis.UpdateLink(editor.row, { type: v.value * 1 });\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterLoad: function() {\n\t\t\t\t\tthis.openAll();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"wxi-trash\": (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\t\ttitle: _(\"Delete link\"),\n\t\t\t\t\t\t\ttext: _(\"The link will be deleted permanently, are you sure?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.DeleteLink(id));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tpadding: { top: webix.skin.$active.layoutMargin.form, bottom: 5 },\n\t\t\trows: [table],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Links = this.$$(\"links\");\n\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\n\t\t// changing links via bars and dnd\n\t\tconst links = this.app.getService(\"local\").links();\n\t\tthis.on(links.data, \"onStoreUpdated\", (_id, obj) => {\n\t\t\tif (obj) {\n\t\t\t\tconst tid = this.State.selected;\n\t\t\t\tif (obj.target === tid || obj.source === tid) {\n\t\t\t\t\tthis.FillData(tid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tFillData(id) {\n\t\tconst local = this.app.getService(\"local\");\n\t\tconst related = local\n\t\t\t.getLinks(id, \"target\")\n\t\t\t.concat(local.getLinks(id, \"source\"));\n\n\t\tthis.Links.clearAll();\n\t\tif (related.length) {\n\t\t\tthis.Links.parse(related);\n\t\t\tthis.getRoot().show();\n\t\t} else {\n\t\t\tthis.getRoot().hide();\n\t\t}\n\t}\n\n\tUpdateLink(id, obj) {\n\t\tthis.Ops.updateLink(id, obj).then(() => {\n\t\t\tthis.Links.blockEvent();\n\t\t\tthis.Links.editCancel();\n\t\t\tthis.Links.unblockEvent();\n\n\t\t\t// must not give 0 ID to dropdown list of column editor\n\t\t\tobj.type += \"\";\n\t\t\tthis.Links.updateItem(id, obj);\n\t\t});\n\t}\n\n\tDeleteLink(id) {\n\t\tthis.Ops.removeLink(id).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n}\n","webix.editors.gantt_numeditor = webix.extend(\n\t{\n\t\trender: function() {\n\t\t\tconst node = webix.editors.text.render.call(this);\n\t\t\tconst inp = node.querySelector(\"input\");\n\t\t\tinp.type = \"number\";\n\t\t\tinp.min = 0;\n\t\t\treturn node;\n\t\t},\n\t},\n\twebix.editors.text\n);\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/numeditor\";\n\nexport default class ResourcesView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tconst conf = this.app.config;\n\t\tconst single = (this.IsSingle =\n\t\t\tconf.resources == \"single\" || conf.resourceCalendars);\n\n\t\tconst button = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tautowidth: true,\n\t\t\t\t\tlocalId: \"addBtn\",\n\t\t\t\t\tlabel: _(\"Add assignment\"),\n\t\t\t\t\tclick: () => this.AddBtnClickHandler(),\n\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_resource_table webix_gantt_tree webix_gantt_form_tree\",\n\t\t\theader: false,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"resources\",\n\t\t\tautoheight: true,\n\t\t\teditable: true,\n\t\t\teditaction: \"custom\",\n\t\t\tscroll: false,\n\t\t\thover: \"webix_gantt_table_hover\",\n\t\t\trowHeight: Math.max(webix.skin.$active.rowHeight, 32),\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"resource\",\n\t\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: obj => this.ResourceTemplate(obj),\n\t\t\t\t\teditor: \"richselect\",\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\tcss: \"webix_gantt_select_editor_popup\",\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tpoint: 0,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\t\theight: Math.max(webix.skin.$active.listItemHeight, 32),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate: r =>\n\t\t\t\t\t\t\t\tsingle ? this.OptionTemplate(r) : this.EditorOptionTemplate(r),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\t{\n\t\t\t\t\tid: \"value\",\n\t\t\t\t\twidth: 85,\n\t\t\t\t\tcss: \"webix_gantt_value\",\n\t\t\t\t\ttemplate: obj => this.ValueTemplate(obj),\n\t\t\t\t\teditFormat: function(v) {\n\t\t\t\t\t\treturn parseFloat(v);\n\t\t\t\t\t},\n\t\t\t\t\teditParse: function(v) {\n\t\t\t\t\t\tv = parseFloat(v);\n\t\t\t\t\t\treturn isNaN(v) ? 0 : v;\n\t\t\t\t\t},\n\t\t\t\t\teditor: \"gantt_numeditor\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"remove\",\n\t\t\t\t\twidth: 30,\n\t\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t\t\ttemplate: obj => this.DeleteIconTemplate(obj),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => {\n\t\t\t\t\tif (!this.Table.getItem(id).$group && id.column != \"remove\") {\n\t\t\t\t\t\tthis.Table.editRow(id);\n\t\t\t\t\t\tif (id.column == \"value\")\n\t\t\t\t\t\t\tthis.Table.getEditor(id.row, \"resource\")\n\t\t\t\t\t\t\t\t.getPopup()\n\t\t\t\t\t\t\t\t.hide();\n\t\t\t\t\t\tthis.Table.getEditor(id.row, id.column).focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonBeforeEditStart: id => {\n\t\t\t\t\tconst item = this.Table.getItem(id.row);\n\t\t\t\t\tif (item.$group) return false;\n\t\t\t\t\tif (id.column == \"resource\") {\n\t\t\t\t\t\tthis.Table.addCellCss(\n\t\t\t\t\t\t\tid.row,\n\t\t\t\t\t\t\tid.column,\n\t\t\t\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst r = id && !single ? item.resource : null;\n\t\t\t\t\t\tthis.FilterOptions(r);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tonAfterEditStart: id => {\n\t\t\t\t\tif (id.column == \"value\") {\n\t\t\t\t\t\tconst item = this.Table.getItem(id.row);\n\t\t\t\t\t\tconst node = this.Table.getEditor(id.row, \"value\").getInputNode();\n\t\t\t\t\t\tconst range = this.GetRange(item);\n\t\t\t\t\t\tif (range) this.ApplyEditorLimits(node, range);\n\t\t\t\t\t\tconst step = this.GetValueStep(item);\n\t\t\t\t\t\tif (step) this.ApplyEditorStep(node, step);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonBeforeEditStop: (state, editor) => {\n\t\t\t\t\tthis.Table.removeCellCss(\n\t\t\t\t\t\teditor.row,\n\t\t\t\t\t\t\"resource\",\n\t\t\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t\t\t);\n\t\t\t\t\tif (state.value != state.old) {\n\t\t\t\t\t\tlet obj = {};\n\t\t\t\t\t\tobj[editor.column] = state.value;\n\t\t\t\t\t\tif (editor.column == \"value\") {\n\t\t\t\t\t\t\tconst item = this.Table.getItem(editor.row);\n\t\t\t\t\t\t\tconst range = this.GetRange(item);\n\t\t\t\t\t\t\tif (range) this.ApplyValueRange(obj, range);\n\t\t\t\t\t\t\telse if (obj.value < 0) obj.value = 0;\n\t\t\t\t\t\t\teditor.getInputNode().value = obj.value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.UpdateAssignment(editor.row, obj);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tonAfterLoad: function() {\n\t\t\t\t\tthis.openAll();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_gantt_remove_icon: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\t\ttitle: _(\"Delete assignment\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete this assignment?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveAssignment(id.row));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tif (!single)\n\t\t\ttable.scheme = {\n\t\t\t\t$group: {\n\t\t\t\t\tby: \"category\",\n\t\t\t\t},\n\t\t\t};\n\n\t\treturn {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: webix.skin.$active.layoutMargin.form, bottom: 5 },\n\t\t\trows: [table, button],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Table = this.$$(\"resources\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Resources = this.Local.resources();\n\t\tif (!this.app.config.resources) return false;\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\t}\n\n\t/**\n\t * Display assignments table\n\t * @param {string} id - a task id\n\t */\n\tFillData(id) {\n\t\tconst item = this.Local.tasks().getItem(id);\n\t\tif (item.type != \"task\") return false;\n\n\t\tconst loader = this.Local.getAssignments(id);\n\t\tloader.then(assignees => {\n\t\t\tif (!this.getRoot()) return false;\n\t\t\tthis.Table.clearAll();\n\t\t\tthis.Table.getColumnConfig(\"resource\").collection = this.Resources;\n\n\t\t\tif (assignees.length) {\n\t\t\t\tthis.Table.show();\n\t\t\t\tthis.Table.parse(this.GetData(assignees));\n\t\t\t\tif (this.IsSingle) this.$$(\"addBtn\").disable();\n\t\t\t} else {\n\t\t\t\tif (this.IsSingle) this.$$(\"addBtn\").enable();\n\t\t\t\tthis.Table.hide();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Get treetable data\n\t * @param {array} assignments - an array of assignments data\n\t * @returns {array} data array\n\t */\n\n\tGetData(assignments) {\n\t\tassignments.sort(this.app.getService(\"operations\").sortResources);\n\t\treturn assignments;\n\t}\n\n\t/**\n\t * Filters an option collection\n\t * @param {string} id - the selected resource id\n\t */\n\tFilterOptions(id) {\n\t\tlet tableIds = [];\n\t\tconst category = id ? this.Resources.getItem(id)[\"category_id\"] : null;\n\t\tthis.Table.data.each(item => {\n\t\t\ttableIds.push(item.resource);\n\t\t});\n\n\t\tthis.Resources.filter(item => {\n\t\t\treturn (\n\t\t\t\t(!category || item[\"category_id\"] == category) &&\n\t\t\t\t(tableIds.indexOf(item.id) < 0 || (id && item.id == id))\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Updates an assignment\n\t * @param {string} id - an assignment id\n\t * @param {object} obj - a hash of new assignment properties\n\t */\n\tUpdateAssignment(id, obj) {\n\t\t// remove \"focus\" style for a richselect cell editor when\n\t\t// the editor is closed without event calls\n\t\tconst node = this.Table.$view.querySelector(\".webix_gantt_select_editor\");\n\t\tif (node) {\n\t\t\tconst rInd = node.getAttribute(\"aria-rowindex\") * 1;\n\t\t\tthis.Table.removeCellCss(\n\t\t\t\tthis.Table.data.getIdByIndex(rInd - 1),\n\t\t\t\t\"resource\",\n\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t);\n\t\t}\n\n\t\tthis.Ops.updateAssignment(id, obj).then(() => {\n\t\t\tthis.CloseEditor(id, obj);\n\t\t});\n\t}\n\n\t/**\n\t * Get range for unit values\n\t * @param {object} item - an assignment item object\n\t * @returns {array} an array with two numeric values [min,max]\n\t */\n\tGetRange(item) {\n\t\tconst resourceItem = this.Resources.getItem(item.resource);\n\t\treturn this.Helpers.getResourceValueRange(resourceItem);\n\t}\n\n\t/**\n\t * Apply limits to \"value\" property of a data object\n\t * @param {object} obj - an object with a value property to change\n\t * @param {array} range - a value range [min,max]\n\t */\n\tApplyValueRange(obj, range) {\n\t\tif (obj.value < range[0]) obj.value = range[0];\n\t\telse if (obj.value > range[1]) obj.value = range[1];\n\t}\n\t/**\n\t * Apply limits to editor value\n\t * @param {HTMLInputElement} node - an editor input\n\t * @param {array} range - a value range [min,max]\n\t */\n\tApplyEditorLimits(node, range) {\n\t\tnode.min = range[0];\n\t\tnode.max = range[1];\n\t}\n\t/**\n\t * Get set for unit values\n\t * @param {object} item - an assignment item object\n\t * @returns {number} a step value\n\t */\n\tGetValueStep(item) {\n\t\tconst resourceItem = this.Resources.getItem(item.resource);\n\t\treturn this.Helpers.getResourceValueStep(resourceItem);\n\t}\n\n\t/**\n\t * Apply changing step to editor value\n\t * @param {HTMLInputElement} node - an editor input\n\t * @param {number} step - changing step\n\t */\n\tApplyEditorStep(node, step) {\n\t\tnode.step = step;\n\t}\n\n\t/**\n\t * Closes editor and updated table row\n\t * @param {string} id - an assignment id\n\t * @param {object} obj - assignment properties\n\t */\n\tCloseEditor(id, obj) {\n\t\tthis.Table.blockEvent();\n\t\tthis.Table.editCancel();\n\t\tthis.Table.unblockEvent();\n\n\t\tthis.Table.updateItem(id, obj);\n\t}\n\n\t/**\n\t * Removes assignment\n\t * @param {string} id - assignment id\n\t */\n\tRemoveAssignment(id) {\n\t\tthis.Ops.removeAssignment(id).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n\n\t/**\n\t *  \"Add\" button click handler\n\t */\n\tAddBtnClickHandler() {\n\t\tthis.FilterOptions();\n\t\twebix.delay(() => {\n\t\t\tthis.ShowPopup();\n\t\t});\n\t}\n\n\t/**\n\t * Adds an assignment and a new row to \"assignees\" table\n\t * @param {object} obj - assignment properties\n\t */\n\tAddAssignment(obj) {\n\t\tif (this.IsSingle) this.$$(\"addBtn\").disable();\n\t\tthis.Ops.addAssignment({\n\t\t\tresource: obj.id,\n\t\t\tvalue: this.Helpers.getDefaultResourceValue(obj),\n\t\t\ttask: this.State.selected,\n\t\t}).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n\t/**\n\t * A template for a resource column\n\t * @param {object} obj - a data item\n\t * @returns {string} an html string of a column cell\n\t */\n\tResourceTemplate(obj) {\n\t\tif (obj.$group) return `<span class=\"webix_strong\">${obj.category}</span>`;\n\t\telse if (obj.resource) {\n\t\t\tconst item = this.Resources.getItem(obj.resource);\n\t\t\treturn this.EditorTemplate(item);\n\t\t}\n\t\treturn \"\";\n\t}\n\t/**\n\t * The template for value column\n\t * @param {object} obj - an assignment data object\n\t * @returns {string} html string\n\t */\n\tValueTemplate(obj) {\n\t\tif (obj.$group) return \"\";\n\t\tconst v = obj.value;\n\t\treturn (\n\t\t\t(isNaN(v) ? this.Helpers.getDefaultResourceValue(obj) : v) +\n\t\t\tthis.GetUnitName(obj)\n\t\t);\n\t}\n\n\t/**\n\t * Get a unit name for a resource\n\t * @param {object} obj - resource object\n\t * @returns {string} a unit name\n\t */\n\tGetUnitName(obj) {\n\t\treturn this._(this.Helpers.getResourceUnit(obj));\n\t}\n\n\t/**\n\t * The template for \"delete\" column\n\t * @param {object} obj - assignment data object\n\t * @returns {string} html string\n\t */\n\tDeleteIconTemplate(obj) {\n\t\tif (obj.$group) return \"\";\n\t\treturn \"<span class='webix_icon wxi-trash webix_gantt_remove_icon'></span>\";\n\t}\n\n\t/**\n\t * Get popup configuration\n\t * @returns {object} popup config\n\t */\n\tGetPopupConfig() {\n\t\treturn {\n\t\t\tview: \"suggest\",\n\t\t\tlocalId: \"popup\",\n\t\t\twidth: 320,\n\t\t\tpadding: 0,\n\t\t\tpoint: 0,\n\t\t\tfitMaster: false,\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_gantt_select_editor_popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tminHeight: 28,\n\t\t\t\ttype: {\n\t\t\t\t\theight: Math.max(webix.skin.$active.listItemHeight, 32),\n\t\t\t\t},\n\t\t\t\tdata: this.Resources,\n\t\t\t\ttemplate: obj => this.OptionTemplate(obj),\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.AddAssignment(this.Resources.getItem(id));\n\t\t\t\t\t\tthis.Popup.hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Show resources popup\n\t */\n\tShowPopup() {\n\t\tif (!this.Popup || !this.Popup.$view) {\n\t\t\tthis.Popup = this.ui(this.GetPopupConfig());\n\t\t\tthis.SetPopupPlaceholder();\n\t\t}\n\n\t\tthis.Popup.show(this.$$(\"addBtn\").$view, { x: 1 });\n\t}\n\n\t/**\n\t * Set a placeholder for the \"Add\" popup placeholder\n\t * @param {string} placeholder - a popup placeholder (optional)\n\t */\n\tSetPopupPlaceholder(placeholder) {\n\t\tconst list = this.Popup.getBody();\n\t\tlist.$view.firstChild.setAttribute(\n\t\t\t\"placeholder\",\n\t\t\tplaceholder || this._(\"No resources to add\")\n\t\t);\n\t}\n\n\t/**\n\t * A template for \"Add assignment\" popup options\n\t * @param {object} obj - a data item\n\t * @returns {string} an html string of an editor option\n\t */\n\tOptionTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\tconst avatarStr = `<div class=\"webix_gantt_avatar_box_inline\">${avatar +\n\t\t\tname}</div>`;\n\t\tconst dpt = `<span class='webix_gantt_resource_section'>${obj.category}</span>`;\n\t\treturn (\n\t\t\t\"<div class='webix_gantt_avatar_option_box'>\" + avatarStr + dpt + \"</div>\"\n\t\t);\n\t}\n\n\t/**\n\t * Cell template\n\t * @param {object} obj - resource object\n\t * @returns {string} html string for resource editable cell\n\t */\n\tEditorTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\tconst icon = \"<span class='webix_icon wxi-menu-down'></span>\";\n\t\treturn `<div class=\"webix_gantt_avatar_box\">${avatar} ${name}${icon}</div>`;\n\t}\n\n\t/**\n\t * Popup option template for resource editor\n\t * @param {object} obj - resource object\n\t * @returns {string} html string for an option\n\t */\n\tEditorOptionTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\treturn `<div class=\"webix_gantt_avatar_box\">${avatar} ${name}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TableView from \"./links\";\nimport ResourcesView from \"./resources\";\nimport BaselineView from \"./baseline\";\n\nexport default class FormView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.isResources = this.app.config.resources;\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_subbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst calendar = {\n\t\t\tcss: \"webix_gantt_datepicker\",\n\t\t\ttype: \"calendar\",\n\t\t\t//localId: \"calendar\",\n\t\t\tbody: {\n\t\t\t\theight: 270,\n\t\t\t\twidth: 250,\n\t\t\t\ticons: true,\n\t\t\t\tevents: date => this.app.config.isHoliday(date) && \"webix_cal_event\",\n\t\t\t},\n\t\t};\n\n\t\tconst types = [\n\t\t\t{ id: \"task\", value: _(\"Task\") },\n\t\t\t{ id: \"milestone\", value: _(\"Milestone\") },\n\t\t];\n\t\tif (!this.app.config.projects) {\n\t\t\ttypes.splice(1, 0, { id: \"project\", value: _(\"Project\") });\n\t\t}\n\n\t\tlet accItems = [];\n\t\tif (this.app.config.links)\n\t\t\taccItems.push({\n\t\t\t\theader: _(\"Related tasks\"),\n\t\t\t\tbody: TableView,\n\t\t\t\tcollapsed: true,\n\t\t\t});\n\t\tif (this.isResources)\n\t\t\taccItems.push({\n\t\t\t\tlocalId: \"resourcesItem\",\n\t\t\t\theader:\n\t\t\t\t\tthis.isResources == \"single\" || this.app.config.resourceCalendars\n\t\t\t\t\t\t? _(\"Assignment\")\n\t\t\t\t\t\t: _(\"Assignments\"),\n\t\t\t\tbody: { $subview: ResourcesView, name: \"resources\" },\n\t\t\t\tcollapsed: true,\n\t\t\t\thidden: true,\n\t\t\t});\n\t\tif (this.State.baseline)\n\t\t\taccItems.push({\n\t\t\t\tlocalId: \"baselineItem\",\n\t\t\t\theader: _(\"Planned dates\"),\n\t\t\t\tbody: { $subview: BaselineView, name: \"baseline\" },\n\t\t\t\tcollapsed: true,\n\t\t\t\thidden: true,\n\t\t\t});\n\n\t\tconst accordion = {\n\t\t\tmulti: true,\n\t\t\tview: \"accordion\",\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tmargin: 10,\n\t\t\tcss: \"webix_gantt_accordion\",\n\t\t\trows: accItems,\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tborderless: true,\n\t\t\tautoheight: false,\n\t\t\tscroll: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", name: \"text\", label: _(\"Title\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"types\",\n\t\t\t\t\tname: \"type\",\n\t\t\t\t\tlabel: _(\"Type\"),\n\t\t\t\t\toptions: types,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\tname: \"start_date\",\n\t\t\t\t\tlabel: _(\"Start date\"),\n\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\tname: \"end_date\",\n\t\t\t\t\tlabel: _(\"End date\"),\n\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"counter\",\n\t\t\t\t\tname: \"duration\",\n\t\t\t\t\tcss: \"webix_gantt_form_counter\",\n\t\t\t\t\tmin: 1,\n\t\t\t\t\tmax: 1000,\n\t\t\t\t\tlabel: _(\"Duration\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"slider\",\n\t\t\t\t\tname: \"progress\",\n\t\t\t\t\ttitle: webix.template(\"#value#%\"),\n\t\t\t\t\tlabel: _(\"Progress\"),\n\t\t\t\t},\n\t\t\t\taccordion,\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tname: \"details\",\n\t\t\t\t\tlabel: _(\"Notes\"),\n\t\t\t\t\theight: 150,\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (n, o, config) => {\n\t\t\t\t\tif (this.Compact) this.UpdateTaskTime();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config == \"user\")\n\t\t\t\t\t\t\tthis.UpdateTask().then(() => {\n\t\t\t\t\t\t\t\t// redraw all bars because a branch may be closed or opened in tree\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tthis._eventSource === \"type\" &&\n\t\t\t\t\t\t\t\t\tconfig === \"user\" &&\n\t\t\t\t\t\t\t\t\t(n === \"split\" || o === \"split\")\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", []);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\tpadding: { bottom: 14 },\n\t\t\t\trows: [bar, form],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Tasks = this.Local.tasks();\n\t\tthis.Form = this.$$(\"form\");\n\n\t\t// fills form with data of selected and newly created task\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) {\n\t\t\t\tthis.FillData(id);\n\t\t\t}\n\t\t});\n\n\t\t// updates for start and end dates of task while dnd happens and form is open\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected)\n\t\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\n\t\t// \"resources\" view shows only \"task\" items (disable \"type\" select for it)\n\t\tthis.on(this.State.$changes, \"display\", v => {\n\t\t\tconst typeSelect = this.$$(\"form\").elements[\"type\"];\n\t\t\tif (v == \"tasks\") typeSelect.enable();\n\t\t\telse if (v == \"resources\") typeSelect.disable();\n\t\t});\n\t\tif (this.app.config.resourceCalendars)\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", () =>\n\t\t\t\tthis.SetResourceHolidays()\n\t\t\t);\n\t\tthis.on(this.State.$changes, \"baseline\", (v, old) => {\n\t\t\tif (!webix.isUndefined(old))\n\t\t\t\tthis.SetBaselineVisibility(this.Tasks.getItem(this.State.selected));\n\t\t});\n\t}\n\n\t/**\n\t * Applies task selection\n\t * @param {(string|number)} id - the ID of a task\n\t */\n\tFillData(id) {\n\t\tconst item = this.Tasks.getItem(id);\n\n\t\tconst typeList = this.$$(\"types\").getList();\n\t\tif (this.app.config.split && item.$count) {\n\t\t\tif (!typeList.exists(\"split\"))\n\t\t\t\ttypeList.add({\n\t\t\t\t\tid: \"split\",\n\t\t\t\t\tvalue: this.app.getService(\"locale\")._(\"Split task\"),\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (typeList.exists(\"split\")) typeList.remove(\"split\");\n\t\t}\n\n\t\tif (this.app.config.projects) {\n\t\t\tthis.LimitTypeOptions(item);\n\t\t}\n\t\tif (this.app.config.resourceCalendars) this.SetResourceHolidays();\n\n\t\tif (this.isResources) this.SetResourcesVisibility(item);\n\t\tif (this.State.baseline) this.SetBaselineVisibility(item);\n\t\tthis.Form.setValues(item);\n\t\tthis.Form.focus();\n\t}\n\n\t/**\n\t * Hide/show the \"Assignments\" accordion item depending on a task type\n\t * @param {object} item - a task data object\n\t */\n\tSetResourcesVisibility(item) {\n\t\tconst layout = this.$$(\"resourcesItem\");\n\t\tif (item.type == \"task\") {\n\t\t\tif (!layout.isVisible()) {\n\t\t\t\tconst sub = this.getSubView(\"resources\");\n\t\t\t\tif (sub) sub.FillData(item.id);\n\t\t\t\tlayout.show();\n\t\t\t}\n\t\t} else if (layout.isVisible()) layout.hide();\n\t}\n\t/**\n\t * Hide/show the \"Assignments\" accordion item depending on a task type\n\t * @param {object} item - a task data object\n\t */\n\tSetBaselineVisibility(item) {\n\t\tconst layout = this.$$(\"baselineItem\");\n\t\tif (\n\t\t\tthis.State.baseline &&\n\t\t\t(item.type == \"task\" || item.type == \"project\")\n\t\t) {\n\t\t\tif (!layout.isVisible()) {\n\t\t\t\tconst sub = this.getSubView(\"baseline\");\n\t\t\t\tif (sub) sub.FillData(item.id);\n\t\t\t\tlayout.show();\n\t\t\t}\n\t\t} else if (layout.isVisible()) layout.hide();\n\t}\n\n\t/**\n\t * Prohibits the user from selecting the type incompatible with other data and relations of a task\n\t * @param {Object} item - the data object of a task\n\t */\n\tLimitTypeOptions(item) {\n\t\tconst typeSelect = this.Form.elements.type;\n\t\tif (item.type === \"project\") typeSelect.hide();\n\t\telse typeSelect.show();\n\t}\n\n\t/**\n\t * Prepares task  object for processing with respect to date-related changes\n\t * @param {Object} vals - object with form values\n\t * @returns {boolean} flag that indicates whether dates were updated or not\n\t */\n\tPrepareDates(vals) {\n\t\tconst f = (this._eventSource = this.Form.$eventSource.config.name);\n\n\t\tlet updateDates = true;\n\t\tif (f == \"duration\" || (f == \"start_date\" && vals.type == \"project\"))\n\t\t\tvals.end_date = null;\n\t\telse if (f == \"end_date\" || f == \"start_date\") vals.duration = null;\n\t\telse updateDates = false;\n\n\t\treturn updateDates;\n\t}\n\t/**\n\t * Update task time and duration on data change in compact form\n\t */\n\tUpdateTaskTime() {\n\t\tconst vals = this.Form.getValues();\n\t\tconst updateDates = this.PrepareDates(vals);\n\n\t\t// expand branches with subtasks that are not split anymore\n\t\tif (this._eventSource === \"type\" && vals.type !== \"split\")\n\t\t\tvals.open = vals.opened = 1;\n\n\t\tconst textUpdated = this.RemoveTagsFromText(vals);\n\t\tif (textUpdated) {\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\n\t\tif (updateDates) {\n\t\t\tconst mode = this._eventSource ? this._eventSource.split(\"_\")[0] : null;\n\t\t\tthis.Ops.updateTaskDuration(vals, mode);\n\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\t}\n\n\t/**\n\t * Removes HTML tags from text fields\n\t * @param {Object} vals - the changed values from the form\n\t * @returns {boolean} - true if there is a text field in the changed values, false otherwise\n\t */\n\tRemoveTagsFromText(vals) {\n\t\tif (this._eventSource === \"text\" || this._eventSource === \"details\") {\n\t\t\tvals[this._eventSource] = (vals[this._eventSource] || \"\").replace(\n\t\t\t\t/(<[^>]+>|^\\s+|\\s+$)/gi,\n\t\t\t\t\"\"\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Saves changes\n\t * @returns {Promise} the result of a data operation (adding new event or updating)\n\t */\n\tUpdateTask() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tif (!this.Compact) {\n\t\t\tthis.PrepareDates(vals);\n\t\t\tthis.RemoveTagsFromText(vals);\n\t\t}\n\n\t\tconst mode = this._eventSource ? this._eventSource.split(\"_\")[0] : null;\n\n\t\t// expand branches with subtasks that are not split anymore\n\t\tif (this._eventSource === \"type\" && vals.type !== \"split\")\n\t\t\tvals.open = vals.opened = 1;\n\n\t\tthis._inProgress = this.Ops.updateTask(id, vals, mode);\n\n\t\tthis._inProgress.finally(() => (this._inProgress = null));\n\t\treturn this._inProgress;\n\t}\n\n\t/**\n\t * Switches end date, duration and progress controls and enables or disables them depending on the type of the task\n\t * @param {string} v - the option chosen in the type selector: \"project\", \"task\", \"milestone\"\n\t */\n\tToggleControls(v) {\n\t\tthis.Form.elements.end_date.show();\n\t\tthis.Form.elements.duration.show();\n\t\tthis.Form.elements.progress.show();\n\t\tthis.Form.elements.end_date.enable();\n\t\tthis.Form.elements.duration.enable();\n\t\tthis.Form.elements.progress.enable();\n\n\t\tif (v == \"project\" || v == \"milestone\") {\n\t\t\tconst action = v == \"project\" ? \"disable\" : \"hide\";\n\t\t\tthis.Form.elements.end_date[action]();\n\t\t\tthis.Form.elements.duration[action]();\n\t\t\tthis.Form.elements.progress[action]();\n\t\t}\n\t}\n\n\t/**\n\t * Handles clicks on the 'cross' icon and closes the form\n\t * if there are unsaved changes, initiates saving after confirmation from the user\n\t */\n\tClose() {\n\t\tif (this.Compact && this.Form.isDirty()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\twebix\n\t\t\t\t.confirm({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: _(\"Save changes?\"),\n\t\t\t\t})\n\t\t\t\t.then(() => this.Done(true), () => this.Back(true));\n\t\t} else {\n\t\t\tthis.Back(true);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form and either closes the whole right panel or shows \"info\"\n\t * @param {Boolean} exit - if true, the right panel will be closed; otherwise, right panel stays, form closes, \"info\" shows up\n\t */\n\tBack(exit) {\n\t\tif (exit)\n\t\t\tthis.State.$batch({\n\t\t\t\tedit: null,\n\t\t\t\tselected: null,\n\t\t\t});\n\t\telse this.State.edit = null;\n\t}\n\n\t/**\n\t * Finishes task editing and closes the form\n\t * @param {Boolean} exit - if true, the right panel will be closed; otherwise, right panel stays, form closes, info shows up\n\t */\n\tDone(exit) {\n\t\tif (this.Compact && this.Form.isDirty()) {\n\t\t\tif (this._inProgress)\n\t\t\t\tthis._inProgress.then(() => {\n\t\t\t\t\tthis.Back(exit);\n\t\t\t\t});\n\t\t\telse this.UpdateTask().then(() => this.Back(exit));\n\t\t} else this.Back(exit);\n\t}\n\n\tSetResourceHolidays() {\n\t\tlet arr = [];\n\t\tconst els = this.Form.elements;\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tarr.push(els[\"start_date\"], els[\"end_date\"]);\n\t\tconst calendar = this.Local.getTaskCalendar(this.State.selected);\n\t\tarr.forEach(el => {\n\t\t\tconst c = el.getPopup().getBody();\n\t\t\tc.config.events = date =>\n\t\t\t\t(calendar\n\t\t\t\t\t? h.isResourceHoliday(date, calendar)\n\t\t\t\t\t: this.app.config.isHoliday(date)) && \"webix_cal_event\";\n\t\t\tc.refresh();\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TaskView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst editButton = {\n\t\t\tview: \"button\",\n\t\t\twidth: 130,\n\t\t\tlabel: _(\"Edit\"),\n\t\t\tcss: \"webix_primary\",\n\t\t\tclick: () => this.EditTask(),\n\t\t};\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_subbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t!state.readonly ? editButton : {},\n\t\t\t],\n\t\t};\n\n\t\tconst info = {\n\t\t\tlocalId: \"text\",\n\t\t\tview: \"template\",\n\t\t\tcss: \"webix_gantt_task_info\",\n\t\t\ttemplate: obj => this.InfoTemplate(obj),\n\t\t\tborderless: true,\n\t\t};\n\n\t\tconst deleteButton = {\n\t\t\tview: \"button\",\n\t\t\tlabel: _(\"Delete task\"),\n\t\t\tcss: \"webix_danger webix_gantt_danger\",\n\t\t\talign: \"center\",\n\t\t\tinputWidth: 330,\n\t\t\tclick: () => {\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\ttitle: _(\"Delete task\"),\n\t\t\t\t\t\ttext: _(\"The task will be deleted permanently, are you sure?\"),\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.DeleteTask());\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\tbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [info, !state.readonly ? deleteButton : {}],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Tasks = this.Local.tasks();\n\t\tthis.Text = this.$$(\"text\");\n\t\tthis.isResources = this.app.config.resources;\n\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillTemplate(id);\n\t\t});\n\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected) {\n\t\t\t\tthis.FillTemplate(this.State.selected);\n\t\t\t}\n\t\t});\n\n\t\t// changing links via bars and dnd\n\t\tconst links = this.Local.links();\n\t\tthis.on(links.data, \"onStoreUpdated\", (_id, obj) => {\n\t\t\tif (obj) {\n\t\t\t\tconst tid = this.State.selected;\n\t\t\t\tif (obj.target === tid || obj.source === tid) {\n\t\t\t\t\tthis.FillTemplate(tid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.isResources) {\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", (id, obj) => {\n\t\t\t\tif (obj && obj.task == this.State.selected) this.FillTemplate(obj.task);\n\t\t\t});\n\t\t}\n\t\tthis.on(this.State.$changes, \"baseline\", (v, old) => {\n\t\t\tif (!webix.isUndefined(old)) this.FillTemplate(this.State.selected);\n\t\t});\n\t}\n\n\tFillTemplate(id) {\n\t\tconst item = webix.copy(this.Tasks.getItem(id));\n\t\titem.sources = this.Local.getLinks(id, \"source\");\n\t\titem.targets = this.Local.getLinks(id, \"target\");\n\t\tif (this.isResources && item.type == \"task\") {\n\t\t\tthis.Local.getAssignments(id).then(d => {\n\t\t\t\tif (!this.getRoot()) return false;\n\t\t\t\titem.resources = d.sort(\n\t\t\t\t\tthis.app.getService(\"operations\").sortResources\n\t\t\t\t);\n\t\t\t\tthis.Text.setValues(item);\n\t\t\t});\n\t\t} else this.Text.setValues(item);\n\t}\n\n\tEditTask() {\n\t\tthis.State.edit = true;\n\t}\n\n\tDeleteTask() {\n\t\tthis.app.getService(\"operations\").removeTask(this.State.selected);\n\t\tthis.Close();\n\t}\n\n\tClose() {\n\t\tthis.State.$batch({\n\t\t\tedit: null,\n\t\t\tselected: null,\n\t\t});\n\t}\n\n\tInfoTemplate(obj) {\n\t\tif (!obj.start_date) return \"\";\n\t\tconst _ = this._;\n\t\tlet html = `<span class=\"webix_gantt_task_title\">${obj.text ||\n\t\t\t_(\"(no title)\")}</span><br><br>`;\n\t\thtml += this.BaseTemplate(obj);\n\t\thtml += this.LinkTemplate(obj);\n\n\t\tif (this.State.baseline && obj.planned_start) {\n\t\t\thtml += this.BaselineTemplateChunk(obj, _(\"Planned dates\"));\n\t\t}\n\n\t\tif (obj.details) {\n\t\t\thtml += `<br><br><div class=\"webix_gantt_task_title\">${_(\"Notes\")}</div>\n\t\t\t\t<br><div class=\"webix_gantt_task_text\">${obj.details.replace(\n\t\t\t\t\t/(?:\\r\\n|\\r|\\n)/g,\n\t\t\t\t\t\"<br>\"\n\t\t\t\t)}</div>`;\n\t\t}\n\n\t\treturn html;\n\t}\n\n\tBaseTemplate(obj) {\n\t\tconst _ = this._;\n\t\tlet html = `<span class=\"webix_strong\">${_(\n\t\t\t\"Start date\"\n\t\t)}</span>: ${this.DateFormat(obj.start_date)}<br>`;\n\n\t\tif (obj.type !== \"milestone\")\n\t\t\thtml += `<span class=\"webix_strong\">${_(\n\t\t\t\t\"End date\"\n\t\t\t)}</span>: ${this.DateFormat(obj.end_date)}<br>\n\t\t\t<span class=\"webix_strong\">${_(\"Duration\")}</span>: ${obj.duration}<br>\n\t\t\t<span class=\"webix_strong\">${_(\"Progress\")}</span>: ${obj.progress}%\n\t\t<br>`;\n\t\treturn html;\n\t}\n\n\tLinkTemplate(obj) {\n\t\tlet html = \"\";\n\t\tconst _ = this._;\n\t\tif (obj.targets.length)\n\t\t\thtml += this.InfoTemplateChunk(obj.targets, _(\"Predecessors\"));\n\t\tif (obj.sources.length)\n\t\t\thtml += this.InfoTemplateChunk(obj.sources, _(\"Successors\"));\n\t\tif (obj.resources) {\n\t\t\tconst single =\n\t\t\t\tthis.isResources == \"single\" || this.app.config.resourceCalendars;\n\t\t\thtml += this.ResourcesTemplateChunk(\n\t\t\t\tobj.resources,\n\t\t\t\tsingle ? _(\"Assignment\") : _(\"Assignments\")\n\t\t\t);\n\t\t}\n\t\treturn html;\n\t}\n\n\tResourcesTemplateChunk(arr, label) {\n\t\tif (!arr || !arr.length) return \"\";\n\t\tlet maxWidth = 130;\n\t\tarr.forEach(r => {\n\t\t\tconst s0 = webix.html.getTextSize(r.name, \"webix_gantt_info_list_text\");\n\t\t\tconst s1 = webix.html.getTextSize(\n\t\t\t\tr.category,\n\t\t\t\t\"webix_gantt_info_list_text webix_gantt_resource_section\"\n\t\t\t);\n\t\t\tmaxWidth = Math.max(maxWidth, s0.width, s1.width);\n\t\t});\n\t\tmaxWidth = Math.min(200, maxWidth);\n\t\tlet list = arr\n\t\t\t.map(r => {\n\t\t\t\tconst h = this.app.getService(\"helpers\");\n\t\t\t\tconst avatar =\n\t\t\t\t\t\"<div>\" +\n\t\t\t\t\th.resourceAvatar(r, \"webix_gantt_person_avatar_big\") +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst dpt =\n\t\t\t\t\t\"<div class=' webix_gantt_info_list_text webix_gantt_resource_section' style='min-width:\" +\n\t\t\t\t\tmaxWidth +\n\t\t\t\t\t\"px'>\" +\n\t\t\t\t\tr.category +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst value =\n\t\t\t\t\t\"<div class='webix_gantt_resource_section'>\" +\n\t\t\t\t\tr.value +\n\t\t\t\t\tthis._(h.getResourceUnit(r)) +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst top =\n\t\t\t\t\t\"<div class='webix_gantt_info_list_text_row'><div class='webix_gantt_info_list_text' style='min-width:\" +\n\t\t\t\t\tmaxWidth +\n\t\t\t\t\t\"px'>\" +\n\t\t\t\t\tr.name +\n\t\t\t\t\t\"</div>\" +\n\t\t\t\t\tvalue +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst text = \"<div  >\" + top + dpt + \"</div>\";\n\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_gantt_info_resource'>\" + avatar + text + \"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\t\treturn `<br><span class=\"webix_strong\">${label}</span>:<br><ul class=\"webix_gantt_info_list_resources\">${list}</ul>`;\n\t}\n\n\tInfoTemplateChunk(arr, label) {\n\t\tlet res = arr\n\t\t\t.map(s => `<li>${s.text || this._(\"(no title)\")}</li>`)\n\t\t\t.join(\"\");\n\t\treturn `<br><span class=\"webix_strong\">${label}</span>:<br><ul>${res}</ul>`;\n\t}\n\n\tDateFormat(date) {\n\t\treturn webix.i18n.longDateFormatStr(date);\n\t}\n\tBaselineTemplateChunk(obj, label) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tlet html =\n\t\t\t`${_(\"Start date\")}: ${this.DateFormat(obj.planned_start)}<br>` +\n\t\t\t`${_(\"End date\")}: ${this.DateFormat(obj.planned_end)}<br>` +\n\t\t\t`${_(\"Duration\")}: ${obj.planned_duration}<br>`;\n\t\treturn `<br><span class=\"webix_strong\">${label}</span><br><div class=\"webix_gantt_info_list_planned\">${html}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TaskPopup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tborderless: true,\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sort } from \"../helpers/common\";\n\nexport default class TreeView extends JetView {\n\tconfig() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tconst scales = this.Local.getScales();\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst compact = (this.Compact = this.getParam(\"compact\", true));\n\t\tthis.isResources = this.app.config.resources;\n\t\tthis.maxAvatarNumber = 3;\n\n\t\tconst action = {\n\t\t\tid: \"action\",\n\t\t\tcss: \"webix_gantt_action\",\n\t\t\theader: {\n\t\t\t\ttext: `<span webix_tooltip=\"${_(\n\t\t\t\t\t\"Add task\"\n\t\t\t\t)}\" class=\"webix_icon wxi-plus-circle\"></span>`,\n\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t},\n\t\t\ttemplate: () => {\n\t\t\t\treturn `<span webix_tooltip=\"${_(\n\t\t\t\t\t\"Add task\"\n\t\t\t\t)}\" class=\"webix_icon wxi-plus\"></span>`;\n\t\t\t},\n\t\t\twidth: 44,\n\t\t\tminWidth: 44,\n\t\t};\n\n\t\tlet columns = [\n\t\t\t{\n\t\t\t\tid: \"text\",\n\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\theader: _(\"Title\"),\n\t\t\t\ttemplate: (obj, common) =>\n\t\t\t\t\tcommon.treetable(obj, common) + this.TitleTemplate(obj),\n\t\t\t\tfillspace: true,\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"full\",\n\t\t\t\tsort: sort(\"text\"),\n\t\t\t\tminWidth: 150,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"start_date\",\n\t\t\t\theader: _(\"Start date\"),\n\t\t\t\tformat: webix.i18n.dateFormatStr,\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"full\",\n\t\t\t\tsort: \"date\",\n\t\t\t\tminWidth: 100,\n\t\t\t},\n\t\t];\n\n\t\tif (this.isResources) {\n\t\t\tcolumns.push({\n\t\t\t\tid: \"resources\",\n\t\t\t\tcss: \"webix_gantt_tree_column_resources\",\n\t\t\t\theader: _(\"Assigned\"),\n\t\t\t\ttemplate: obj => this.ResourcesTemplate(obj),\n\t\t\t\tminWidth: 100,\n\t\t\t});\n\t\t}\n\n\t\tif (compact) {\n\t\t\taction.header.text = \"<span class='webix_icon gti-menu'>\";\n\t\t\tif (state.readonly) action.template = \"\";\n\t\t\tcolumns.unshift(action);\n\t\t} else if (!state.readonly) columns.push(action);\n\n\t\tcolumns[columns.length - 1].resize = false;\n\n\t\tconst skin = webix.skin.$name;\n\t\tconst headerCss =\n\t\t\tskin == \"material\" || skin == \"mini\" ? \"webix_header_border\" : \"\";\n\t\tconst tree = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_tree \" + headerCss,\n\t\t\tprerender: true,\n\t\t\twidth: compact ? 44 : state.treeWidth,\n\t\t\trowHeight: scales.cellHeight,\n\t\t\theaderRowHeight: scales.height,\n\t\t\tscroll: \"xy\",\n\t\t\tscrollAlignY: false,\n\t\t\tselect: \"row\",\n\t\t\tsort: \"multi\",\n\t\t\tresizeColumn: {\n\t\t\t\theaderOnly: true,\n\t\t\t\tsize: 10,\n\t\t\t},\n\t\t\tdrag: state.readonly ? false : \"order\",\n\t\t\tcolumns,\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\t\"wxi-plus\": (ev, id) => this.AddTask(id.row),\n\t\t\t\t\"wxi-plus-circle\": () => this.AddTask(\"0\"),\n\t\t\t\t\"gti-menu\": () => this.ToggleColumns(),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeOpen: id => this.HandleToggle(id),\n\t\t\t\tonAfterOpen: id => {\n\t\t\t\t\tthis.ToggleBranch(id, 1);\n\t\t\t\t\tthis.ApplySelection();\n\t\t\t\t},\n\t\t\t\tonAfterClose: id => this.ToggleBranch(id, 0),\n\t\t\t\tonBeforeSelect: id => this.BeforeSelectHandler(id),\n\t\t\t\tonItemClick: id => this.ItemClickHandler(id),\n\t\t\t\tonAfterSort: (by, dir, as) => this.SortTasks(by, dir, as),\n\t\t\t\tonColumnResize: (id, v, o, user) => this.NormalizeColumns(id, user),\n\t\t\t\tonBeforeDrag: (ctx, e) => this.BeforeDragHandler(ctx, e),\n\t\t\t\tonBeforeDrop: ctx => this.BeforeDropHandler(ctx),\n\t\t\t\tonViewResize: () => {\n\t\t\t\t\tthis.State.treeWidth = this.Tree.$width;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\ttree.on[\"onScrollY\"] = tree.on[\"onSyncScroll\"] = tree.on[\n\t\t\t\"onAfterScroll\"\n\t\t] = function() {\n\t\t\tstate.top = this.getScrollState().y;\n\t\t};\n\t\treturn tree;\n\t}\n\n\tinit(view) {\n\t\tthis.Tree = view;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Tasks = this.Local.tasks();\n\n\t\tthis.on(this.State.$changes, \"display\", v => {\n\t\t\tthis.Mode = v;\n\t\t\tthis.State.top = 0;\n\t\t\tthis.SyncData();\n\t\t});\n\t\tif (this.isResources) {\n\t\t\tthis.on(this.Assignments.data, \"onStoreUpdated\", () => {\n\t\t\t\tthis.Tree.refresh();\n\t\t\t});\n\t\t\tthis.on(this.Tree.data, \"onStoreUpdated\", id => {\n\t\t\t\tif (this.Mode == \"resources\" && !id) {\n\t\t\t\t\tthis.ApplySelection();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.on(this.State.$changes, \"top\", y => this.Tree.scrollTo(null, y));\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.ApplySelection();\n\t\t\telse this.Tree.unselect();\n\t\t});\n\n\t\t// resetting headerRowHeight\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tconst col = this.Tree.columnId(0);\n\t\t\tthis.Tree.getColumnConfig(col).header[0].height = scales.height;\n\t\t\tthis.Tree.refreshColumns();\n\t\t});\n\n\t\t// compact button and dnd module\n\t\tthis.on(this.app, \"task:add\", (pid, dates) =>\n\t\t\tthis.AddTask(pid || \"0\", dates)\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"treeWidth\", v => {\n\t\t\tif (!this.Compact && view.$width !== v) {\n\t\t\t\tview.define({ width: v });\n\t\t\t\tview.resize();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Prevents split task branches from being opened\n\t * @param {(string|number)} id - the ID of a task branch\n\t * @returns {Boolean} return false to prevent branches from opening\n\t */\n\tHandleToggle(id) {\n\t\tconst obj = this.Tree.getItem(id);\n\t\tif (obj.type === \"split\" && obj.$data.length) return false;\n\t}\n\n\t/**\n\t * Selects a task\n\t * @param {(string|number)} id - the ID of a task\n\t */\n\tItemClickHandler(id) {\n\t\tif (!this.Tree.getItem(id).$group) {\n\t\t\tthis.State.$batch({\n\t\t\t\tparent: null,\n\t\t\t\tselected: id.row,\n\t\t\t});\n\t\t} else this.app.callEvent(\"edit:stop\");\n\t}\n\t/**\n\t * Checks whether selection is allowed\n\t * @param {string, number} id - task ID\n\t * @returns {boolean} returning false prevents selection\n\t */\n\tBeforeSelectHandler(id) {\n\t\treturn !this.Tree.getItem(id).$group;\n\t}\n\t/**\n\t * Checks whether drag-n-drop is allowed and defines the looks of the drag marker\n\t * @param {Object} ctx - the context object of DnD\n\t * @param {MouseEvent} e - native browser event\n\t * @returns {Boolean} returning false prevents Webix drag-n-drop logic\n\t */\n\tBeforeDragHandler(ctx, e) {\n\t\tif (this.Mode == \"tasks\") {\n\t\t\tconst obj = this.Tree.getItem(ctx.start);\n\t\t\tif (obj.type === \"split\" && obj.$data.length) {\n\t\t\t\tconst html = this.Tree.$dragHTML(this.Tree.getItem(ctx.start), e, ctx);\n\t\t\t\tctx.html = html.replace(\n\t\t\t\t\t\"webix_dd_drag\",\n\t\t\t\t\t\"webix_dd_drag webix_gantt_tree_no_icon\"\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t/**\n\t * Saves task position\n\t * @param {Object} ctx - drag-n-drop context\n\t * @returns {boolean} returning false prevents Webix drop logic\n\t */\n\tBeforeDropHandler(ctx) {\n\t\tthis.Ops.moveTask(ctx.start, ctx.parent, ctx.index);\n\t\treturn false;\n\t}\n\t/** Fills tree width data */\n\tSyncData() {\n\t\tthis.Tree.clearAll();\n\t\tthis.VisibleTasks = this.Local.getVisibleTasksCollection();\n\t\tthis.resDisplayed = this.State.display === \"resources\";\n\n\t\t// for Resource view: always handle existing waitData of VisibleTasks\n\t\tif (this.resDisplayed && !this.clearEvID) {\n\t\t\tthis.clearEvID = this.on(this.VisibleTasks.data, \"onClearAll\", () => {\n\t\t\t\tif (this.resDisplayed) {\n\t\t\t\t\tthis.RefreshData();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.RefreshData();\n\t}\n\n\t/**\n\t * Returns waitData of all involved Collections\n\t * @returns {Array} of Promises\n\t */\n\tGetLoaders() {\n\t\tconst loaders = [this.VisibleTasks.waitData];\n\t\tif (this.isResources) {\n\t\t\tthis.Resources = this.Local.resources();\n\t\t\tthis.Assignments = this.Local.assignments();\n\t\t\tloaders.push(this.Resources.waitData, this.Assignments.waitData);\n\t\t}\n\t\treturn loaders;\n\t}\n\n\t/**\n\t * Waits for data before syncing with main collection and restoring state\n\t * @param {Array} loaders -\n\t */\n\tRefreshData() {\n\t\tconst loaders = this.GetLoaders();\n\t\twebix.promise.all(loaders).then(() => {\n\t\t\tthis.Tree.sync(this.VisibleTasks);\n\t\t\tthis.ApplySelection();\n\t\t\tthis.ApplySorting();\n\t\t});\n\t}\n\n\t/** Applies selection from state */\n\tApplySelection() {\n\t\tconst id = this.State.selected;\n\n\t\tif (id && this.Tree.exists(id) && this.Tree.getSelectedId() != id) {\n\t\t\tlet selected;\n\t\t\tconst task = this.Tree.getItem(id);\n\n\t\t\t// split subtasks are in the tree but they are never visible\n\t\t\tif (this.State.display === \"tasks\") {\n\t\t\t\tconst parent = task.parent;\n\t\t\t\tconst pdata = parent != 0 ? this.Tree.getItem(parent) : null;\n\t\t\t\tif (pdata && pdata.type === \"split\") {\n\t\t\t\t\tselected = parent;\n\t\t\t\t} else if (this.Local._isTaskVisible(task)) {\n\t\t\t\t\tselected = id;\n\t\t\t\t}\n\t\t\t} else if (this.Local._isTaskVisible(task)) {\n\t\t\t\tselected = id;\n\t\t\t}\n\n\t\t\tif (selected) {\n\t\t\t\tthis.Tree.select(selected);\n\t\t\t\tthis.Tree.showItem(selected);\n\t\t\t}\n\t\t}\n\t}\n\t/** Applies sorting from state */\n\tApplySorting() {\n\t\tif (this.State.sort) {\n\t\t\t// UI-only: no need to re-apply sorting on collection\n\t\t\tthis.Tree.data.blockEvent();\n\t\t\tthis.Tree.setState({ sort: this.State.sort });\n\t\t\tthis.Tree.data.unblockEvent();\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new task\n\t * @param {string, number} pid - ID of parent task, can be \"0\" for root\n\t * @param {Object} dates - start and end of the new task in units (numbers)\n\t * @returns {boolean} returning false prevents selection of the parent task, if called from tree\n\t */\n\tAddTask(pid, dates) {\n\t\tthis.State.selected = null;\n\n\t\tconst row = this.Tree.getItem(pid);\n\t\tconst index = row ? 0 : -1;\n\t\tlet inProgress;\n\t\tconst newTask = this.GetNewTask(row, dates);\n\n\t\tif (this.Mode == \"resources\" && row) {\n\t\t\tinProgress = this.AddTaskWithAssignment(newTask, pid);\n\t\t} else {\n\t\t\t// row and dates come from drag-n-drop module\n\t\t\tif (row && dates) {\n\t\t\t\tlet assigned;\n\t\t\t\tif (this.app.config.resources) {\n\t\t\t\t\tassigned = this.Assignments.find(a => a.task == row.id);\n\t\t\t\t}\n\t\t\t\tif (assigned && assigned.length)\n\t\t\t\t\tinProgress = this.SplitTaskWithAssignment(\n\t\t\t\t\t\tnewTask,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tpid,\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tassigned\n\t\t\t\t\t);\n\t\t\t\telse inProgress = this.Ops.splitTaskWithDnd(newTask, index, pid, row);\n\t\t\t} else inProgress = this.Ops.addTask(newTask, index, row ? pid : 0);\n\t\t}\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\n\t\tinProgress.then(res => {\n\t\t\tif (row && this.Mode == \"tasks\" && row.type !== \"split\") {\n\t\t\t\tthis.Tree.open(pid);\n\t\t\t}\n\t\t\tthis.State.$batch({\n\t\t\t\tedit: true,\n\t\t\t\tselected: res.id,\n\t\t\t});\n\n\t\t\tthis.Tree.showItem(res.id);\n\t\t});\n\n\t\treturn false;\n\t}\n\t/**\n\t * Returns and object with new task data\n\t * @param {Object} row - the data object of parent task\n\t * @param {Object} dates - (optional) start and length of the new task in units (numbers)\n\t * @returns {Object} an object with default task fields\n\t */\n\tGetNewTask(row, dates) {\n\t\tconst { start, end } = this.GetDates(row, dates);\n\n\t\treturn {\n\t\t\tstart_date: new Date(start),\n\t\t\tend_date: end || webix.Date.add(start, 1, \"day\", true),\n\t\t\tprogress: 0,\n\t\t\ttext: \"\",\n\t\t};\n\t}\n\n\t/**\n\t * Gets start and end dates for a new task\n\t * @param {Object} row - (optional) the data object of a parent task\n\t * @param {Object} dates - (optional) start and length of the new task in units (numbers)\n\t * @returns {Object} with start and end dates\n\t */\n\tGetDates(row, dates) {\n\t\tif (dates) {\n\t\t\treturn dates;\n\t\t}\n\n\t\tlet start, end;\n\t\tif (row && row.type === \"split\") {\n\t\t\tconst date =\n\t\t\t\trow.$data && row.$data.length ? row.$data[0].end_date : row.end_date;\n\t\t\tstart = this.Helpers.addUnit(\"day\", date, 1);\n\t\t} else {\n\t\t\tif (row) {\n\t\t\t\tstart = row.start_date;\n\t\t\t} else {\n\t\t\t\tconst scales = this.Local.getScales();\n\t\t\t\tstart = webix.Date.add(scales.start, 1, scales.minUnit); //keep scale start\n\t\t\t}\n\t\t}\n\t\treturn { start, end };\n\t}\n\n\t/**\n\t * Adds a new task with assignment, if any is applicable\n\t * @param {Object} newTask - the data object of a new task\n\t * @param {(string|number)} pid - the ID of the parent task\n\t * @returns {Promise} server response with ID of the new task\n\t */\n\tAddTaskWithAssignment(newTask, pid) {\n\t\tthis.Tasks.data.blockEvent();\n\t\tthis.Assignments.data.blockEvent();\n\t\t// add task\n\t\tlet targetId = \"0\";\n\t\tif (pid) targetId = this.Tree.getItem(pid).$group ? \"0\" : pid;\n\t\tlet index = 0;\n\t\tif (this.Tasks.data.branch[targetId])\n\t\t\tindex = this.Tasks.data.branch[targetId].length;\n\n\t\treturn this.Ops.addTask(newTask, index, targetId)\n\t\t\t.then(obj => {\n\t\t\t\tnewTask.id = obj.id;\n\t\t\t\t// add assignments\n\t\t\t\tlet waitArr = [];\n\t\t\t\tlet resources = null;\n\t\t\t\twhile (pid != \"0\" && !resources) {\n\t\t\t\t\tresources = this.Tree.getItem(pid).resources;\n\t\t\t\t\tif (!resources) pid = this.Tree.getParentId(pid);\n\t\t\t\t}\n\t\t\t\tif (resources && resources.length) {\n\t\t\t\t\tresources.forEach(rId => {\n\t\t\t\t\t\tconst resource = this.Local.resources().getItem(rId);\n\t\t\t\t\t\twaitArr.push(\n\t\t\t\t\t\t\tthis.Ops.addAssignment({\n\t\t\t\t\t\t\t\tresource: rId,\n\t\t\t\t\t\t\t\tvalue: this.Helpers.getDefaultResourceValue(resource),\n\t\t\t\t\t\t\t\ttask: newTask.id,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (!waitArr.length) return webix.promise.resolve(obj);\n\t\t\t\treturn webix.promise.all(waitArr).then(() => obj);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.Tasks.data.unblockEvent();\n\t\t\t\tthis.Assignments.data.unblockEvent();\n\t\t\t\t//now we can refresh\n\t\t\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", [\n\t\t\t\t\tnewTask.id,\n\t\t\t\t\tnewTask,\n\t\t\t\t\t\"add\",\n\t\t\t\t]);\n\t\t\t});\n\t}\n\n\t/**\n\t * Splits a task and reassigns resources from original task to new kid if the original task was not split\n\t * @param {Object} newTask - data for a new split kid\n\t * @param {number} index - the index of the new kid\n\t * @param {(number|string)} pid - the ID of the original task\n\t * @param {Object} row - data of the original task\n\t * @param {Object} assignment - data of the assignment of the original task\n\t * @returns {Promise<Object>} server response with ID of the new task, it's 'sibling' ID\n\t */\n\tSplitTaskWithAssignment(newTask, index, pid, row, assignments) {\n\t\treturn this.Ops.splitTaskWithDnd(newTask, index, pid, row).then(res => {\n\t\t\tif (res.sibling) {\n\t\t\t\tconst aops = [];\n\t\t\t\tfor (let i = 0; i < assignments.length; ++i)\n\t\t\t\t\taops.push(\n\t\t\t\t\t\tthis.Ops.updateAssignment(assignments[i].id, {\n\t\t\t\t\t\t\ttask: res.sibling,\n\t\t\t\t\t\t}).then(() => res)\n\t\t\t\t\t);\n\t\t\t\treturn webix.promise.all(aops).then(() => res);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/** Invokes tasks painting in the chart */\n\tRefreshTasks() {\n\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", []);\n\t}\n\t/**\n\t * Sorts tasks according to current sorting config\n\t * @param {string, array} by - data field, can store an array of sorting configs in case of multiple sorting\n\t * @param {string, number} dir - sorting direction, \"asc\" or \"desc\"\n\t * @param {string, number} as - data type, \"string\" by default\n\t */\n\tSortTasks(by, dir, as) {\n\t\tconst dataSorter = webix.isArray(by) ? by : { by, dir, as };\n\t\tconst sortState = this.Tree.getState().sort;\n\n\t\t// sort the collection to affect task bars\n\t\tthis.VisibleTasks.sort(dataSorter);\n\t\t// save sorting state to restore it after app.refresh (switching from/to compact mode)\n\t\tthis.State.sort = sortState;\n\t}\n\t/** Shows and hides columns in a compact mode */\n\tToggleColumns() {\n\t\tconst vis = this.Tree.isColumnVisible(\"text\");\n\t\tthis.Tree.showColumnBatch(\"full\", !vis);\n\t\tthis.Tree.config.width = vis ? 44 : 0;\n\t\tthis.Tree.resize();\n\n\t\tthis.app.callEvent(\"bars:toggle\", [vis]);\n\t}\n\t/**\n\t * Adjusts columns after resizing\n\t * @param {string} id - ID of the column being resized\n\t * @param {boolean} user - defines whether resizing was triggered by user or API\n\t */\n\tNormalizeColumns(id, user) {\n\t\tif (!user) return;\n\t\tconst tree = this.Tree;\n\t\tconst columns = tree.config.columns;\n\t\tconst i = tree.getColumnIndex(id);\n\n\t\tlet last = columns.length - 1;\n\t\tif (columns[last].id === \"action\") last -= 1;\n\n\t\tif (i === 0) {\n\t\t\tcolumns[last].fillspace = true;\n\t\t\tcolumns[last].width = 0;\n\t\t} else if (i === last) {\n\t\t\tcolumns[0].fillspace = true;\n\t\t\tcolumns[0].width = 0;\n\t\t}\n\t\ttree.refreshColumns();\n\t}\n\t/**\n\t * Saves a task tree branch state (open or closed)\n\t * @param {number, string} id - the ID of the task (branch node)\n\t * @param {number} open - 1 if open, 0 if closed\n\t */\n\tToggleBranch(id, open) {\n\t\tif (this.State.display != \"resources\") {\n\t\t\tthis.RefreshTasks();\n\t\t\tif (!this.State.readonly) this.Ops.updateTask(id, { opened: open });\n\t\t} else {\n\t\t\tconst tree = this.VisibleTasks;\n\t\t\tconst item = tree.getItem(id);\n\t\t\titem.open = !!open;\n\t\t\t// need to update treestore order\n\t\t\ttree.data.callEvent(\"onStoreUpdated\", [id, 0, \"branch\"]);\n\t\t}\n\t}\n\n\t/**\n\t * Returns a string with the text label for item title\n\t * @param {Object} obj - the data object of a task\n\t * @returns {string} a string with the text label\n\t */\n\tTitleTemplate(obj) {\n\t\treturn (\n\t\t\tobj.text || (obj.$group ? this._(\"Unassigned\") : this._(\"(no title)\"))\n\t\t);\n\t}\n\n\t/**\n\t * Resources cell template\n\t * @param {object} obj - task data item\n\t * @returns {string} html string\n\t */\n\tResourcesTemplate(obj) {\n\t\tif (this.Assignments.count() && this.Resources.count()) {\n\t\t\tlet assigned = [];\n\t\t\tthis.Assignments.data.each(a => {\n\t\t\t\tif (a.task == obj.id) assigned.push(this.Resources.getItem(a.resource));\n\t\t\t});\n\t\t\tassigned.sort(this.Ops.sortResources);\n\t\t\treturn this.GetAssignmentsHTML(assigned);\n\t\t}\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Gets html content for assignments cell\n\t * @param {Array} assignedArr - an array of assignments\n\t * @returns {string} html string\n\t */\n\tGetAssignmentsHTML(assignedArr) {\n\t\tlet str = \"\";\n\t\tif (assignedArr.length > this.maxAvatarNumber) {\n\t\t\tconst num = assignedArr.length - this.maxAvatarNumber + 1;\n\t\t\tassignedArr = assignedArr.splice(0, this.maxAvatarNumber);\n\t\t\t// show remaining assignments as \"+[NUM]\" over the last avatar\n\t\t\tconst last = assignedArr.pop();\n\t\t\tconst lastStr = this.Helpers.resourceAvatar(last);\n\t\t\tconst numStr =\n\t\t\t\t\"<div class='webix_gantt_cell_remain_num'>+\" + num + \"</div>\";\n\t\t\tstr = assignedArr\n\t\t\t\t.map(r => `${this.Helpers.resourceAvatar(r, null, true)}`)\n\t\t\t\t.join(\"\");\n\t\t\tstr +=\n\t\t\t\t\"<div class='webix_gantt_cell_assigned_last'>\" +\n\t\t\t\tlastStr +\n\t\t\t\tnumStr +\n\t\t\t\t\"</div>\";\n\t\t} else {\n\t\t\tstr = assignedArr\n\t\t\t\t.map(r => `${this.Helpers.resourceAvatar(r, null, true)}`)\n\t\t\t\t.join(\"\");\n\t\t\t// show a name for single assignment\n\t\t\tif (assignedArr.length == 1) {\n\t\t\t\tlet arr = assignedArr[0].name.split(\" \");\n\t\t\t\tstr +=\n\t\t\t\t\t\"<span class='webix_gantt_cell_assigned_text'>\" + arr[0] + \"</span>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='webix_gantt_avatar_box'>\" + str + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TreeView from \"./tree\";\nimport ChartView from \"./chart\";\nimport { initRLayout } from \"@xbs/jet-helpers\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tinitRLayout();\n\t\tthis.fCompact = this.getParam(\"forceCompact\");\n\t\tif (!webix.isUndefined(this.fCompact))\n\t\t\tthis.setParam(\"compact\", this.fCompact);\n\t\tthis.Compact = this.getParam(\"compact\");\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst edit = this.Compact\n\t\t\t? { $subview: true, name: \"edit\", popup: true }\n\t\t\t: {\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tcss: \"webix_shadow_medium\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\twidth: 400,\n\t\t\t\t\thidden: true,\n\t\t\t\t\tlocalId: \"edit\",\n\t\t\t\t\tbody: { $subview: true, name: \"edit\" },\n\t\t\t  };\n\n\t\tlet cols = [\n\t\t\tTreeView,\n\t\t\t{\n\t\t\t\tview: this.Compact ? \"spacer\" : \"resizer\",\n\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\twidth: this.Compact ? 1 : 4,\n\t\t\t},\n\t\t\tChartView,\n\t\t];\n\n\t\tif (this.app.config.resources) {\n\t\t\tcols = [\n\t\t\t\t{\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\tcols,\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonViewResize: () => {\n\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:resize\", []);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"resizer\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\t\t\t\tlocalId: \"rdResizer\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\t\t\tlocalId: \"rdiagram\",\n\t\t\t\t\t\t\theight: this.Compact ? 0 : 400,\n\t\t\t\t\t\t\tbody: { $subview: true, name: \"rdiagram\" },\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tedit,\n\t\t\t];\n\t\t} else {\n\t\t\tcols.push(edit);\n\t\t}\n\n\t\tconst main = {\n\t\t\tview: \"abslayout\",\n\t\t\tcss: \"webix_gantt\",\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"r-layout\",\n\t\t\t\t\tlocalId: \"main\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\tcols: cols,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcss: \"webix_gantt_absbutton\",\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\thidden: !this.Compact || this.State.readonly,\n\t\t\t\t\twidth: 50,\n\t\t\t\t\theight: 50,\n\t\t\t\t\tright: 20,\n\t\t\t\t\tbottom: 20,\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.app.callEvent(\"task:add\", []);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn main;\n\t}\n\n\tinit(view) {\n\t\tthis.$$(\"main\").sizeTrigger(\n\t\t\tthis.app,\n\t\t\tmode => this.SetCompactMode(mode),\n\t\t\t!!this.Compact\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"selected\", (id, oid) => {\n\t\t\tif (id) this.ShowTask(this.State.edit ? \"form\" : \"info\");\n\t\t\telse if (oid) this.HideTask();\n\t\t});\n\t\tthis.on(this.State.$changes, \"edit\", v => {\n\t\t\tif (this.State.selected) this.ShowTask(v ? \"form\" : \"info\");\n\t\t});\n\n\t\twebix.extend(view, webix.ProgressBar);\n\t\tthis.on(this.app, \"backend:operation\", res => {\n\t\t\tview.showProgress({ type: \"top\", delay: 2000 });\n\t\t\tres.finally(() => {\n\t\t\t\tview.hideProgress();\n\t\t\t});\n\t\t});\n\n\t\tif (this.app.config.resources) {\n\t\t\tthis.on(this.State.$changes, \"resourcesDiagram\", v => {\n\t\t\t\tif (v) {\n\t\t\t\t\tthis.$$(\"rdiagram\").show();\n\t\t\t\t\tthis.$$(\"rdResizer\").show();\n\t\t\t\t\tthis.show(\"rdiagram\", { target: \"rdiagram\" });\n\t\t\t\t} else {\n\t\t\t\t\tthis.$$(\"rdiagram\").hide();\n\t\t\t\t\tthis.$$(\"rdResizer\").hide();\n\t\t\t\t\tthis.show(\"_blank\", { target: \"rdiagram\" }).then(() => {\n\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:resize\", []);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tShowTask(path) {\n\t\tpath = `task.${path}`;\n\t\tif (this.Compact) {\n\t\t\tthis.show(`task.popup/${path}`, {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$$(\"edit\").show();\n\t\t\tthis.show(path, {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t}\n\t}\n\n\tHideTask() {\n\t\t// we need to destroy the view inside first\n\t\tthis.show(\"_blank\", { target: \"edit\" });\n\t\tif (!this.Compact) this.$$(\"edit\").hide();\n\t}\n\n\tSetCompactMode(mode) {\n\t\t//let it render, then recreate\n\t\twebix.delay(() => {\n\t\t\tthis.State.$batch({ top: 0, left: 0 });\n\t\t\tthis.setParam(\"compact\", mode);\n\t\t\tthis.refresh();\n\t\t});\n\t}\n}\n","import m0 from \"./views/chart/bars\";\nimport m1 from \"./views/chart/index.js\";\nimport m2 from \"./views/chart/scale\";\nimport m3 from \"./views/rdiagram/diagram\";\nimport m4 from \"./views/rdiagram/index.js\";\nimport m5 from \"./views/rdiagram/tree\";\nimport m6 from \"./views/task/baseline\";\nimport m7 from \"./views/task/form\";\nimport m8 from \"./views/task/info\";\nimport m9 from \"./views/task/links\";\nimport m10 from \"./views/task/popup\";\nimport m11 from \"./views/task/resources\";\nimport m12 from \"./views/top\";\nimport m13 from \"./views/tree\";\nimport { JetView } from \"webix-jet\";\n\nconst views = { JetView };\nviews[\"chart/bars\"] = m0;\nviews[\"chart\"] = m1;\nviews[\"chart/scale\"] = m2;\nviews[\"rdiagram/diagram\"] = m3;\nviews[\"rdiagram\"] = m4;\nviews[\"rdiagram/tree\"] = m5;\nviews[\"task/baseline\"] = m6;\nviews[\"task/form\"] = m7;\nviews[\"task/info\"] = m8;\nviews[\"task/links\"] = m9;\nviews[\"task/popup\"] = m10;\nviews[\"task/resources\"] = m11;\nviews[\"top\"] = m12;\nviews[\"tree\"] = m13;\n\nexport default views;\n","export default class Local {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t * @param {object} config - object with app settings\n\t */\n\tconstructor(app, config) {\n\t\tthis.app = app;\n\t\tthis.state = app.getState();\n\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\t// initial config of scales\n\t\tthis.resetScales(config);\n\n\t\tthis.dateToLocalStr = webix.Date.dateToStr(webix.i18n.parseFormat);\n\t}\n\n\t/**\n\t * Creates and paints scales\n\t * @param {Date} scaleStart - start date\n\t * @param {Date} scaleEnd - end date\n\t * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\n\t * @param {number} width - width of smallest cell unit\n\t * @param {number} height - height of scale cell\n\t * @param {Array} scales - a set of scales (objects)\n\t */\n\tsetScales(scaleStart, scaleEnd, precise, width, height, scales) {\n\t\tconst oldScale = this._scales;\n\t\tif (width) {\n\t\t\tthis._scaleBase = { width, height, scales };\n\t\t\tscaleEnd = webix.Date.add(scaleEnd, 1, \"day\"); //inclusive\n\t\t} else {\n\t\t\twidth = this._scaleBase.width;\n\t\t\theight = this._scaleBase.height;\n\t\t\tscales = this._scaleBase.scales;\n\t\t}\n\n\t\tthis._scales = this.app\n\t\t\t.getService(\"helpers\")\n\t\t\t.setScales(scaleStart, scaleEnd, precise, width, height, scales);\n\t\tthis._taskHeight = this._scales.cellHeight - 12;\n\n\t\tconst tasks = this.getVisibleTasksCollection();\n\t\tif (tasks && tasks.data.order.length) {\n\t\t\tif (this.state.display === \"resources\") {\n\t\t\t\tthis.app.getService(\"grouping\").refreshResourceTasks();\n\t\t\t} else {\n\t\t\t\tthis.refreshTasks();\n\t\t\t}\n\t\t\tthis.refreshLinks();\n\t\t}\n\n\t\tthis.app.callEvent(\"onScalesUpdate\", [this._scales, oldScale]);\n\t}\n\t/**\n\t * returns scales\n\t * @returns {object} current scales object\n\t */\n\tgetScales() {\n\t\treturn this._scales;\n\t}\n\t/**\n\t * sets initial state of Gantt scales\n\t * @param {Object} config - scales configuration, by default from app config\n\t */\n\tresetScales(config) {\n\t\tconfig = config || this.app.config;\n\n\t\tconst active = webix.skin.$active;\n\t\tconst scaleStart = config.scaleStart || webix.Date.dayStart(new Date());\n\t\tconst scaleEnd =\n\t\t\tconfig.scaleEnd || webix.Date.add(scaleStart, 1, \"month\", true);\n\n\t\tthis.setScales(\n\t\t\tscaleStart,\n\t\t\tscaleEnd,\n\t\t\tconfig.preciseTimeUnit,\n\t\t\tconfig.scaleCellWidth || 80,\n\t\t\tactive.barHeight - active.borderWidth * 2,\n\t\t\tconfig.scales || [{ unit: \"day\", step: 1, format: \"%d\" }]\n\t\t);\n\t}\n\t/**\n\t * Get tasks height\n\t * @returns {number} tasks height\n\t */\n\tgetTaskHeight() {\n\t\treturn this._taskHeight;\n\t}\n\t/**\n\t * Adjusts scale to edited task\n\t * @param {object} task - task object\n\t */\n\tadjustScale(obj) {\n\t\tlet start = obj.start_date;\n\t\tlet end = obj.end_date;\n\t\tif (this.state.baseline && obj.planned_start && obj.planned_end) {\n\t\t\tif (start > obj.planned_start) start = obj.planned_start;\n\t\t\tif (end < obj.planned_end) end = obj.planned_end;\n\t\t}\n\t\tconst s = this.getScales();\n\n\t\t// add 1 unit space around\n\t\tstart = this.Helpers.addUnit(s.minUnit, start, -1);\n\t\tend = this.Helpers.addUnit(s.minUnit, end, 1);\n\n\t\tif ((s && s.start > start) || s.end < end) {\n\t\t\tthis.setScales(\n\t\t\t\ts.start > start ? start : s.start,\n\t\t\t\ts.end < end ? end : s.end,\n\t\t\t\ts.precise\n\t\t\t);\n\t\t}\n\t}\n\t/**\n\t * Fills and returns tasks collection\n\t * @returns {object} tasks Tree Collection\n\t */\n\ttasks(force) {\n\t\tif (this._tasks && !force) return this._tasks;\n\n\t\tif (!this._tasks) {\n\t\t\tthis._tasks = this.createTasks();\n\t\t} else {\n\t\t\tthis._tasks.clearAll();\n\t\t}\n\n\t\tconst waitArr = [this.app.getService(\"backend\").tasks()];\n\t\tif (this.app.config.resourceCalendars)\n\t\t\twaitArr.push(this.taskCalendarMap(false, force));\n\n\t\tthis._tasks.parse(\n\t\t\twebix.promise.all(waitArr).then(data => {\n\t\t\t\treturn this.app.getService(\"grouping\").getTreeData(data[0], 0);\n\t\t\t})\n\t\t);\n\t\treturn this._tasks;\n\t}\n\t/**\n\t * Creates tasks collection\n\t * @returns {object} empty tasks Tree Collection\n\t */\n\tcreateTasks() {\n\t\tconst ops = this.app.getService(\"operations\");\n\t\tconst tasks = new webix.TreeCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreLoad\": () => {\n\t\t\t\t\tif (!this.app.config.scaleStart) this.updateScaleMinMax(tasks);\n\t\t\t\t\ttasks.data.each(d => {\n\t\t\t\t\t\tif (this.app.config.projects && d.$count) d.type = \"project\";\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t\"data->onStoreUpdated\": (id, obj, mode) => {\n\t\t\t\t\tid = mode == \"update\" ? id : null;\n\t\t\t\t\tthis.refreshTasks(id);\n\t\t\t\t\tthis.refreshLinks();\n\n\t\t\t\t\tif (!mode && this.state.criticalPath) {\n\t\t\t\t\t\tif (this.app.config.links)\n\t\t\t\t\t\t\tthis._links.waitData.then(() => this.showCriticalPath());\n\t\t\t\t\t\telse this.showCriticalPath();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tobj.start_date = webix.i18n.parseFormatDate(obj.start_date);\n\t\t\t\t\tobj.end_date = webix.i18n.parseFormatDate(obj.end_date);\n\t\t\t\t\tobj.type = obj.type || \"task\";\n\t\t\t\t\tif (!this.app.config.split && obj.type === \"split\") obj.type = \"task\";\n\n\t\t\t\t\tops.updateTaskDuration(obj);\n\n\t\t\t\t\tif (obj.planned_start) {\n\t\t\t\t\t\tobj.planned_start = webix.i18n.parseFormatDate(obj.planned_start);\n\t\t\t\t\t\tobj.planned_end = webix.i18n.parseFormatDate(obj.planned_end);\n\t\t\t\t\t\tops.updatePlannedTaskDuration(obj);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (obj.type === \"split\") {\n\t\t\t\t\t\tobj.open = obj.opened = 0;\n\t\t\t\t\t\tobj.$css = \"webix_gantt_split_task\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete obj.$css;\n\t\t\t\t\t\tobj.open = (obj.open || obj.opened) * 1 || 0;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t$sort: {\n\t\t\t\t\tby: \"position\",\n\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\tas: \"int\",\n\t\t\t\t},\n\t\t\t\t$serialize: data => this.taskOut(data),\n\t\t\t\t$export: data => this.taskOut(data),\n\t\t\t},\n\t\t});\n\n\t\treturn tasks;\n\t}\n\t/**\n\t * Re-paints all tasks in chart or, if theID is provided, a specific task\n\t * @param {string|number} updID - (optional) the ID of the task\n\t * @param {number} i - the index of the task\n\t */\n\trefreshTasks(updID, i) {\n\t\t// console.log(\"[x] render tasks\");\n\t\tif (!updID) {\n\t\t\tthis._tasks.data.order.forEach((id, i) => {\n\t\t\t\tthis.refreshTasks(id, i);\n\t\t\t});\n\t\t} else {\n\t\t\tconst t = this._tasks.getItem(updID);\n\t\t\ti = !webix.isUndefined(i) ? i : this._tasks.getIndexById(updID);\n\t\t\t// type:\"split\" results in split kids missing in datastore.order\n\t\t\tif (i < 0) i = this._tasks.getIndexById(t.parent);\n\n\t\t\tif (t.type === \"split\") {\n\t\t\t\tt.$data = this._tasks\n\t\t\t\t\t.find(k => k.parent == t.id)\n\t\t\t\t\t.sort(\n\t\t\t\t\t\t(a, b) => b.start_date - a.start_date || b.end_date - a.end_date\n\t\t\t\t\t);\n\t\t\t}\n\t\t\tthis.Helpers.updateTask(t, i);\n\n\t\t\tif (this.state.baseline && t.planned_start) this.refreshBaseline(t, i);\n\t\t}\n\t}\n\n\t/**\n\t * Arranges task baseline\n\t * @param task {object} task object\n\t * @param i {number} task index\n\n\t */\n\trefreshBaseline(task, i) {\n\t\tconst t = { ...task };\n\t\tt.start_date = task.planned_start;\n\t\tt.duration = task.planned_duration;\n\t\tt.end_date = task.planned_end;\n\t\tthis.Helpers.updateTask(t, i, this._scales, this._taskHeight);\n\t\ttask.$x0 = t.$x;\n\t\ttask.$w0 = t.$w;\n\t}\n\n\t/**\n\t * Fills and returns links collection\n\t * @returns {object} links Data Collection\n\t */\n\tlinks(force) {\n\t\tif (this._links && !force) return this._links;\n\n\t\tif (!this._links) {\n\t\t\tthis._links = this.createLinks();\n\t\t} else {\n\t\t\tthis._links.clearAll();\n\t\t}\n\n\t\tif (this.app.config.links)\n\t\t\tthis._links.parse(this.app.getService(\"backend\").links());\n\t\treturn this._links;\n\t}\n\t/**\n\t * Creates and returns links collection\n\t * @returns {object} empty links Data Collection\n\t */\n\tcreateLinks() {\n\t\treturn new webix.DataCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreUpdated\": (id, v, mode) => {\n\t\t\t\t\t// do not refresh for initial data parsing\n\t\t\t\t\tif (mode) this.refreshLinks(id);\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$init: obj => {\n\t\t\t\t\tobj.type = obj.type * 1;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\t/**\n\t * Re-paints all links in chart\n\t * @param {(string|number)} id - (optional) the ID of a link\n\t */\n\trefreshLinks(id) {\n\t\tconst tasks = this.getVisibleTasksCollection();\n\t\tif (this._links && tasks) {\n\t\t\tthis._links.data.each(l => {\n\t\t\t\tconst s = tasks.getItem(l.source);\n\t\t\t\tconst e = tasks.getItem(l.target);\n\t\t\t\tif (!s || !e || !this._isTaskVisible(s) || !this._isTaskVisible(e))\n\t\t\t\t\tl.$p = \"\";\n\t\t\t\telse this.Helpers.updateLink(l, s, e);\n\t\t\t});\n\n\t\t\t// refresh the critical path if a link was added, updated or removed\n\t\t\tif (this.state.criticalPath && id) {\n\t\t\t\tthis.showCriticalPath();\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Returns all links of a particular type for the specified task\n\t * @param {string, number} id - task id\n\t * @param {type} type - link type, \"source\" or \"target\"\n\t * @returns {array} links array\n\t */\n\tgetLinks(id, type) {\n\t\tconst found = this._links.find(a => a[type] == id);\n\t\tconst res = [];\n\n\t\tfor (let i = 0; i < found.length; i++) {\n\t\t\tconst a = found[i];\n\t\t\tconst t = this._tasks.getItem(a[type == \"source\" ? \"target\" : \"source\"]);\n\t\t\tif (t)\n\t\t\t\tres.push({\n\t\t\t\t\tid: a.id,\n\t\t\t\t\ttype: a.type.toString(),\n\t\t\t\t\ttext: t.text,\n\t\t\t\t\tttype: type,\n\t\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\t/**\n\t * Prepares task data object for serializing and export\n\t * @param {Object} data - incoming task data object\n\t * @returns {Object} - processed task data object\n\t */\n\ttaskOut(data) {\n\t\tdata = webix.copy(data);\n\n\t\tconst format = this.dateToLocalStr;\n\t\tif (data.start_date) data.start_date = format(data.start_date);\n\t\tif (data.end_date) data.end_date = format(data.end_date);\n\n\t\t// clean $-fields\n\t\tfor (let k in data) {\n\t\t\tif (k.indexOf(\"$\") === 0) delete data[k];\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t/**\n\t * Checks whether the specified task is visible (all parents open)\n\t * @param {object} x - task object\n\t * @param {boolean} tcollection - if true, the method will return the main collection regardless of the current display mode\n\t * @returns {boolean} task visibility\n\t */\n\t_isTaskVisible(x, tcollection) {\n\t\t// display: \"resources\" case to hide projects\n\t\tconst tasks = this.getVisibleTasksCollection(tcollection);\n\n\t\tconst taskParent = x.$parent;\n\t\tconst taskSplit = x.type === \"split\" && !x.open;\n\n\t\tif (taskSplit && !taskParent) return false;\n\t\twhile (x.$parent) {\n\t\t\tx = tasks.getItem(x.$parent);\n\t\t\tif (\n\t\t\t\t!((taskParent == x.id && x.type == \"split\") || x.open) ||\n\t\t\t\t(x.open && taskSplit)\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource categories collection\n\t * @returns {object} categories Data Collection\n\t */\n\tcategories(force) {\n\t\tif (this._categories && !force) return this._categories;\n\t\tif (!this._categories) {\n\t\t\tthis._categories = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._categories.clearAll();\n\t\t}\n\n\t\tthis._categories.parse(this.app.getService(\"backend\").categories());\n\t\treturn this._categories;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource collection\n\t * @returns {object} resources Data Collection\n\t */\n\tresources(force) {\n\t\tif (this._resources && !force) return this._resources;\n\n\t\tif (!this._resources) {\n\t\t\tthis._resources = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._resources.clearAll();\n\t\t}\n\n\t\tlet waitArr = [\n\t\t\tthis.app.getService(\"backend\").resources(),\n\t\t\tthis.categories(force).waitData,\n\t\t];\n\t\tif (this.app.config.resourceCalendars)\n\t\t\twaitArr.push(this.calendars(force).waitData);\n\n\t\tthis._resources.parse(\n\t\t\twebix.promise.all(waitArr).then(arr => {\n\t\t\t\tlet rData = arr[0];\n\t\t\t\trData.forEach(resource => {\n\t\t\t\t\tif (resource[\"category_id\"]) {\n\t\t\t\t\t\tconst ctg = this.categories().getItem(resource[\"category_id\"]);\n\t\t\t\t\t\tresource.category = ctg.name;\n\t\t\t\t\t\tif (!resource.unit && ctg.unit) resource.unit = ctg.unit;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\trData.sort(this.app.getService(\"operations\").sortResources);\n\t\t\t\treturn rData;\n\t\t\t})\n\t\t);\n\t\treturn this._resources;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource-task relation collection\n\t * @returns {object} assignments Data Collection\n\t */\n\tassignments(force) {\n\t\tif (this._assignments && !force) return this._assignments;\n\n\t\tif (!this._assignments) {\n\t\t\tthis._assignments = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._assignments.clearAll();\n\t\t}\n\n\t\tthis._assignments.parse(this.app.getService(\"backend\").assignments());\n\t\treturn this._assignments;\n\t}\n\n\t/**\n\t * Returns all resource assignments for the specified task\n\t * @param {string, number} id - a task id\n\t * @returns {array} an array of assignments extended with resource properties\n\t */\n\tgetAssignments(id) {\n\t\treturn webix.promise\n\t\t\t.all([this.resources().waitData, this.assignments().waitData])\n\t\t\t.then(() => {\n\t\t\t\tconst resources = this.resources();\n\t\t\t\tconst assigned = this.assignments().data.find(a => a.task == id);\n\t\t\t\treturn assigned.map(a => {\n\t\t\t\t\tlet aCopy = Object.assign({}, a);\n\t\t\t\t\tlet resource = Object.assign({}, resources.getItem(a.resource));\n\t\t\t\t\tdelete resource.id;\n\t\t\t\t\treturn Object.assign(aCopy, resource);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\t/**\n\t * Fills and returns calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcalendars(force) {\n\t\tif (this._calendars && !force) return this._calendars;\n\n\t\tif (!this._calendars) {\n\t\t\tthis._calendars = this.createCalendars();\n\t\t} else {\n\t\t\tthis._calendars.clearAll();\n\t\t}\n\n\t\tthis._calendars.parse(this.app.getService(\"backend\").calendars());\n\t\treturn this._calendars;\n\t}\n\t/**\n\t * Creates calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcreateCalendars() {\n\t\treturn new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tif (typeof obj.weekDays == \"string\")\n\t\t\t\t\t\tobj.weekDays = obj.weekDays.split(\",\").map(a => 1 * a);\n\t\t\t\t\tif (obj.holidays) {\n\t\t\t\t\t\tif (typeof obj.holidays == \"string\")\n\t\t\t\t\t\t\tobj.holidays = obj.holidays.split(\",\");\n\t\t\t\t\t\tobj.holidays = obj.holidays.map(d =>\n\t\t\t\t\t\t\twebix.Date.datePart(new Date(d))\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Marks all tasks as critical or not\n\t * @param {Boolean} clean - pass true if you want to remove existing critical path markers\n\t */\n\tshowCriticalPath(clean) {\n\t\tif (clean) {\n\t\t\tthis._tasks.data.order.forEach(id => {\n\t\t\t\tconst task = this._tasks.getItem(id);\n\t\t\t\tdelete task.$critical;\n\t\t\t});\n\t\t} else {\n\t\t\tconst all = this._tasks.data.getRange().sort((a, b) => {\n\t\t\t\treturn (\n\t\t\t\t\tb.end_date - a.end_date ||\n\t\t\t\t\t(a.parent == b.id ? 1 : b.parent == a.id ? -1 : 0) ||\n\t\t\t\t\tb.start_date - a.start_date\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tlet latestDate = webix.Date.copy(all[0].end_date);\n\t\t\tall.forEach(task => {\n\t\t\t\ttask.$critical = this.isTaskCritical(task, latestDate);\n\t\t\t});\n\t\t}\n\t\tthis._tasks.data.callEvent(\"onStoreUpdated\", [null, null, \"paint\"]);\n\t}\n\t/**\n\t * Decides if a task is a part of the critical path\n\t * @param {Object} task - task data\n\t * @param {Date} latestDate - the date by which all tasks end\n\t * @returns {Boolean}\n\t */\n\tisTaskCritical(task, latestDate) {\n\t\tif (latestDate && webix.Date.equal(latestDate, task.end_date)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tconst links = this._links.find(l => l.source == task.id && l.type == 0);\n\t\t\tfor (let i = 0; i < links.length; ++i) {\n\t\t\t\t// a task is critical if its end is linked to the start of a critical task\n\t\t\t\t// and there is no slack time between them\n\t\t\t\tconst dependent = this._tasks.getItem(links[i].target);\n\t\t\t\tif (\n\t\t\t\t\tdependent.$critical &&\n\t\t\t\t\tthis.isNoSlack(dependent.start_date, task.end_date, task.id)\n\t\t\t\t)\n\t\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (task.parent != 0) {\n\t\t\t\tconst parent = this._tasks.getItem(task.parent);\n\t\t\t\treturn parent.$critical && task.end_date >= parent.end_date;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Checks if there is slack between 2 linked tasks\n\t * @param {Date} nextStart - the start date of the next linked task\n\t * @param {Date} currentEnd - the end date of the currently checked task\n\t * @param {String} taskId - the id of the currently checked task (optional, resourceCalendar related)\n\t * @returns {Boolean} the result of the check; true if there is no slack\n\t */\n\tisNoSlack(nextStart, currentEnd, taskId) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tif (currentEnd >= nextStart) return true;\n\n\t\t\tfor (let date = webix.Date.copy(currentEnd); date < nextStart; ) {\n\t\t\t\tif (!this.isHoliday(date, taskId)) return false;\n\t\t\t\twebix.Date.add(date, 1, \"day\");\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn currentEnd >= nextStart;\n\t}\n\n\t/**\n\t * Decides if a link is a part of the critical path\n\t * @param {Object} link - the data object of a link\n\t * @returns {Boolean} the result of the check; true if the link connects critical tasks\n\t */\n\tisLinkCritical(link) {\n\t\tlet critical = false;\n\t\tif (link.type == 0) {\n\t\t\tconst tasks = this.tasks();\n\t\t\tconst s = tasks.getItem(link.source);\n\t\t\tconst t = tasks.getItem(link.target);\n\t\t\tcritical = s && t && s.$critical && t.$critical;\n\t\t}\n\t\treturn critical;\n\t}\n\n\t/**\n\t * Gets visible tasks collection\n\t * @param {boolean} tasks - if true, the method will return the main collection regardless of the current display mode\n\t * @returns {object} webix.TreeCollection\n\t */\n\tgetVisibleTasksCollection(tasks) {\n\t\tif (!tasks && this.state.display == \"resources\") {\n\t\t\tconst g = this.app.getService(\"grouping\");\n\t\t\treturn g ? g.getResourceTree() : null;\n\t\t}\n\t\treturn this._tasks;\n\t}\n\n\ttaskCalendarMap(now, force) {\n\t\tif (now) return this._calendarMap || null;\n\n\t\tif (!this._calendarMap) {\n\t\t\tthis.assignments().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t\tthis.resources().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t\tthis.calendars().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t}\n\n\t\tconst waitArr = [\n\t\t\tthis.assignments(force).waitData,\n\t\t\tthis.resources(force).waitData,\n\t\t];\n\n\t\t// forced from resources\n\t\tif (!force) {\n\t\t\twaitArr.push(this.calendars().waitData);\n\t\t}\n\n\t\treturn webix.promise.all(waitArr).then(() => {\n\t\t\tif (!this._calendarMap) this.refreshCalendarMap();\n\t\t\treturn this._calendarMap;\n\t\t});\n\t}\n\trefreshCalendarMap() {\n\t\tconst resources = this.resources();\n\t\tconst calendars = this.calendars();\n\t\tlet data = {};\n\t\tthis.assignments().data.each(obj => {\n\t\t\tconst resource = resources.getItem(obj.resource);\n\t\t\tif (resource) {\n\t\t\t\tconst id = resource.calendar_id;\n\t\t\t\tconst cal = id ? calendars.getItem(id) : null;\n\t\t\t\tif (cal && !data[obj.task]) data[obj.task] = cal;\n\t\t\t}\n\t\t});\n\t\treturn (this._calendarMap = data);\n\t}\n\n\tgetTaskCalendar(taskId) {\n\t\tconst map = this.taskCalendarMap(true);\n\t\treturn map ? map[taskId] : null;\n\t}\n\tisHoliday(date, taskId) {\n\t\tif (taskId && this._calendarMap) {\n\t\t\tconst calendar = this._calendarMap[taskId];\n\t\t\tif (calendar) return this.Helpers.isResourceHoliday(date, calendar);\n\t\t}\n\t\treturn this.app.config.isHoliday(date);\n\t}\n\n\t/**\n\t * Clears all existing data collections; resets aggregated data, state, and scales\n\t */\n\tclearAll() {\n\t\tconst grouping = this.app.getService(\"grouping\");\n\t\tconst collections = [\n\t\t\t\"tasks\",\n\t\t\t\"links\",\n\t\t\t\"resources\",\n\t\t\t\"categories\",\n\t\t\t\"assignments\",\n\t\t\t\"calendars\",\n\t\t];\n\n\t\tthis.state.$batch({\n\t\t\tedit: null,\n\t\t\tselected: null,\n\t\t\tsort: null,\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t});\n\n\t\tif (this.app.config.resourcesDiagram) {\n\t\t\tconst rdCollection = grouping.getRDCollection();\n\t\t\trdCollection.clearAll();\n\t\t}\n\n\t\tif (this.app.config.resources) {\n\t\t\tconst rCollection = grouping.getResourceTree();\n\t\t\trCollection.clearAll();\n\t\t}\n\n\t\tcollections.forEach(name => {\n\t\t\tconst key = \"_\" + name;\n\t\t\tif (this[key]) this[key].clearAll();\n\t\t});\n\n\t\tthis.resetScales();\n\t}\n\n\t/**\n\t * Completely reloads data in the component; repaints application with new data\n\t */\n\treload() {\n\t\tthis.clearAll();\n\n\t\tconst grouping = this.app.getService(\"grouping\");\n\t\tconst collections = [\"tasks\", \"links\"];\n\t\tconst waitArr = [];\n\n\t\tif (this.app.config.resources && !this.app.config.resourceCalendars) {\n\t\t\tcollections.push(\"resources\", \"assignments\");\n\t\t}\n\n\t\tcollections.forEach(name => {\n\t\t\tconst collection = this[name](true);\n\t\t\twaitArr.push(collection.waitData);\n\t\t});\n\n\t\tif (this.app.config.resourcesDiagram) {\n\t\t\tgrouping.getRDCollection(true);\n\t\t}\n\n\t\twebix.promise.all(waitArr).then(() => {\n\t\t\tthis.app.refresh();\n\t\t});\n\t}\n\tupdateScaleMinMax(tasks) {\n\t\tlet min = Infinity;\n\t\tlet max = -Infinity;\n\t\ttasks.data.each(d => {\n\t\t\tif (d.start_date < min) min = d.start_date;\n\t\t\tif (d.end_date > max) max = d.end_date;\n\t\t\tif (this.state.baseline && d.planned_start && d.planned_end) {\n\t\t\t\tif (d.planned_start < min) min = d.planned_start;\n\t\t\t\tif (d.planned_end > max) max = d.planned_end;\n\t\t\t}\n\t\t});\n\t\tif (typeof min === \"object\") {\n\t\t\tconst s = this.getScales();\n\t\t\tthis.setScales(\n\t\t\t\tthis.Helpers.addUnit(s.minUnit, min, -1),\n\t\t\t\tthis.Helpers.addUnit(s.minUnit, max, 1),\n\t\t\t\ts.precise\n\t\t\t);\n\t\t}\n\t}\n}\n","export default class Backend {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t * @param {string} url - server url\n\t */\n\tconstructor(app, url) {\n\t\tthis.app = app;\n\t\tthis._url = url;\n\t}\n\t/**\n\t * Returns absolute url based on relative one\n\t * @param {string} path - relative url\n\t * @returns {string} absolute url\n\t */\n\turl(path) {\n\t\treturn this._url + path;\n\t}\n\t/**\n\t * Loads tasks\n\t * @returns {promise} promise that resolves with tasks array\n\t */\n\ttasks() {\n\t\treturn webix.ajax(this.url(\"tasks\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads links\n\t * @returns {promise} promise that resolves with links array\n\t */\n\tlinks() {\n\t\treturn webix.ajax(this.url(\"links\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads resources\n\t * @returns {promise} promise that resolves with resources array\n\t */\n\tresources() {\n\t\treturn webix.ajax(this.url(\"resources\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads resource categories\n\t * @returns {promise} promise that resolves with categories data\n\t */\n\tcategories() {\n\t\treturn webix.ajax(this.url(\"categories\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads task-resource data\n\t * @returns {promise} promise that resolves with array of task-resource assignments\n\t */\n\tassignments() {\n\t\treturn webix.ajax(this.url(\"assignments\")).then(res => res.json());\n\t}\n\t/**\n\t * Returns calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcalendars() {\n\t\treturn webix.ajax(this.url(\"calendars\")).then(res => res.json());\n\t}\n\t/**\n\t * Adds task\n\t * @param {object} obj - object with task fields\n\t * @param {string} mode - the relative position of the new task in a branch: \"first\", \"last\", \"after\"\n\t * @param {(string|number)} parent - parent task id, can be \"0\" for root\n\t * @returns {promise} promise that resolves with server response\n\t */\n\taddTask(obj, mode, parent) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"tasks\"), { ...obj, mode, parent })\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes task\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveTask(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"tasks/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates task\n\t * @param {(string|number)} id - task id\n\t * @param {Object} obj - object with task fields\n\t * @param {Boolean} split - flag that indicates that this is a splitting of a task\n\t * @returns {Promise} promise that resolves with with server response\n\t */\n\tupdateTask(id, obj, split) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tasks/\" + id + (split ? \"/split\" : \"\")), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\n\t/**\n\t * Changes order of tasks\n\t * @param {(string|number)} id - task id\n\t * @param {Object} obj - task position\n\t * @returns {Promise} promise that resolves with with server response\n\t */\n\treorderTask(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tasks/\" + id + \"/position\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Adds link\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with server response\n\t */\n\taddLink(obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"links\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates link\n\t * @param {string, number} id - link id\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with with server response\n\t */\n\tupdateLink(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"links/\" + id), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes link\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveLink(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"links/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Adds a new resource assignment to a task\n\t * @param {object} obj - an object with \"task\", \"resource\" and \"value\" fields\n\t * @returns {promise} a promise that is resolved with an object of a resource task\n\t */\n\taddAssignment(obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"assignments\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates resource assignment\n\t * @param {string, number} id -  an id of a task resource record\n\t * @param {object} obj - an object with record fields\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tupdateAssignment(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"assignments/\" + id), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes resource assignment\n\t * @param {string, number} id - an id of an assignment record\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tremoveAssignment(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"assignments/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n}\n","export default class Operations {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis._local = this.app.getService(\"local\");\n\t\tthis._helpers = this.app.getService(\"helpers\");\n\t\tthis._back = this.app.getService(\"backend\");\n\t\tthis._state = this.app.getState();\n\t}\n\t/**\n\t * Adds task\n\t * @param {object} obj - object with task fields\n\t * @param {number} index - index within a parent branch, 0 or -1\n\t * @param {string, number} parent - parent task id, can be \"0\" for root\n\t * @param {string} mode - (optional) name of the change, \"move\", \"start\", \"end\" or \"duration\"\n\t * @returns {promise} promise that resolves with task object\n\t */\n\taddTask(obj, index, parent, mode) {\n\t\tthis.updateTaskDuration(obj, mode);\n\t\tif (obj.planned_start) this.updatePlannedTaskDuration(obj, mode);\n\n\t\tconst addMode = index == 0 ? \"first\" : \"last\";\n\t\treturn this._back\n\t\t\t.addTask(this.cleanData(obj), addMode, parent)\n\t\t\t.then(added => {\n\t\t\t\tthis._local.adjustScale(obj);\n\n\t\t\t\tconst tasks = this._local.tasks();\n\t\t\t\ttasks.add({ ...obj, id: added.id, parent }, index, parent);\n\n\t\t\t\treturn this.completeAdd(parent, added);\n\t\t\t});\n\t}\n\n\t/**\n\t * Splits a task via dnd (adds a subtask that will be rendered in the same line)\n\t * @param {Object} obj - data of a new subtask\n\t * @param {number} index - the index of a new subtask\n\t * @param {(string|number)} parent - the ID of the parent task\n\t * @param {Object} row - data of the parent task\n\t * @returns {Promise<Object>} a promise that resolves with server response (object like {id:\"some\", sibling:\"some\"} with task ids)\n\t */\n\tsplitTaskWithDnd(obj, index, parent, row) {\n\t\tthis.updateTaskDuration(obj);\n\t\treturn this._back\n\t\t\t.updateTask(parent, { ...obj, position: index, parent }, true)\n\t\t\t.then(res => {\n\t\t\t\tthis._local.adjustScale(obj);\n\n\t\t\t\tconst tasks = this._local.tasks();\n\t\t\t\ttasks.updateItem(parent, {\n\t\t\t\t\ttype: \"split\",\n\t\t\t\t\tduration: row.duration || 1,\n\t\t\t\t\tprogress: row.progress || 0,\n\t\t\t\t});\n\t\t\t\tif (\n\t\t\t\t\t(res.sibling && res.sibling != 0) ||\n\t\t\t\t\t!tasks.find(t => t.parent == parent, true)\n\t\t\t\t) {\n\t\t\t\t\ttasks.add(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...row,\n\t\t\t\t\t\t\ttype: \"task\",\n\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\tid: res.sibling,\n\t\t\t\t\t\t\tduration: row.duration || 1,\n\t\t\t\t\t\t\tprogress: row.progress || 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tparent\n\t\t\t\t\t);\n\t\t\t\t\t++index;\n\t\t\t\t}\n\n\t\t\t\ttasks.add(\n\t\t\t\t\t{ ...obj, id: res.id, parent, position: index },\n\t\t\t\t\tindex,\n\t\t\t\t\tparent\n\t\t\t\t);\n\n\t\t\t\treturn this.completeAdd(parent, res, res.sibling);\n\t\t\t});\n\t}\n\n\t/**\n\t * Runs some common logic for add and split operations (see comments inside the method)\n\t * @param {(string|number)} parent - the ID of a parent task\n\t * @param {Object} added - server response (object like {id:\"some\", sibling:\"some\"} with task ids, sib;ing is optional)\n\t * @param {id} sibling - (optional) the ID of a first sibling added to split task that was ordinary before splitting\n\t * @returns {Promise<Object>} a promise that resolves with server response (object like {id:\"some\", sibling:\"some\"} with task ids)\n\t */\n\tcompleteAdd(parent, added, sibling) {\n\t\tif (parent) {\n\t\t\treturn this.syncProject(parent).then(() => {\n\t\t\t\t// critical path update\n\t\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\n\t\t\t\tif (sibling) added.sibling = sibling;\n\t\t\t\treturn added;\n\t\t\t});\n\t\t} else return webix.promise.resolve(added);\n\t}\n\n\t/**\n\t * Updates task\n\t * @param {string, number} id - task id\n\t * @param {object} obj - object with task fields\n\t * @param {string} mode - (optional) name of the change, \"move\", \"start\", \"end\" or \"duration\"\n\t * @param {boolean} inner - (optional) flag to mark inner logic call\n\t * @returns {promise} promise that resolves with task fields\n\t */\n\tupdateTask(id, obj, mode, inner) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst item = webix.copy(tasks.getItem(id));\n\t\tconst next = { ...item, ...obj };\n\n\t\tlet updateDates = !(\n\t\t\twebix.Date.equal(item.start_date, next.start_date) &&\n\t\t\twebix.Date.equal(item.end_date, next.end_date)\n\t\t);\n\t\tif (updateDates) {\n\t\t\tthis.updateTaskDuration(next, mode);\n\t\t}\n\t\tconst updatePlanned =\n\t\t\tnext.planned_start &&\n\t\t\t!(\n\t\t\t\twebix.Date.equal(item.planned_start, next.planned_start) &&\n\t\t\t\twebix.Date.equal(item.planned_end, next.planned_end)\n\t\t\t);\n\t\tif (updatePlanned) this.updatePlannedTaskDuration(next, mode);\n\n\t\tif (!inner && next.type == \"project\" && item.type != \"project\")\n\t\t\treturn this.syncProject(id, next);\n\n\t\treturn this._back.updateTask(id, this.cleanData(next)).then(() => {\n\t\t\t// scale must be updated before the task\n\t\t\tconst { start, end } = this._local.getScales();\n\t\t\tif (\n\t\t\t\tstart > next.start_date ||\n\t\t\t\tend < next.end_date ||\n\t\t\t\t(updatePlanned &&\n\t\t\t\t\t(start > next.planned_start || end < next.planned_end))\n\t\t\t)\n\t\t\t\tthis._local.adjustScale(next);\n\n\t\t\ttasks.updateItem(id, next);\n\n\t\t\tif (next.type != \"task\" && item.type == \"task\")\n\t\t\t\tthis.removeAssignments(next);\n\n\t\t\t//update dependent project or tasks\n\t\t\tif (\n\t\t\t\t!inner &&\n\t\t\t\t(updateDates ||\n\t\t\t\t\titem.progress != next.progress ||\n\t\t\t\t\titem.parent != next.parent)\n\t\t\t) {\n\t\t\t\tlet res;\n\t\t\t\tif (item.$count && item.type == \"project\")\n\t\t\t\t\tres = this.syncTasks(id, item.start_date, next.start_date).then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\treturn this.syncProject(item.parent);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\telse {\n\t\t\t\t\tif (item.parent != next.parent) {\n\t\t\t\t\t\tres = webix.promise.all([\n\t\t\t\t\t\t\tthis.syncProject(next.parent),\n\t\t\t\t\t\t\tthis.syncProject(item.parent),\n\t\t\t\t\t\t]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres = this.syncProject(next.parent);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// critical path update\n\t\t\t\tres.then(() => {\n\t\t\t\t\tif (this._state.criticalPath) {\n\t\t\t\t\t\ttasks.updateItem(id, { $critical: false });\n\t\t\t\t\t\tthis._local.showCriticalPath();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn next;\n\t\t});\n\t}\n\n\t/**\n\t * Normalizes task end_date and duration correspondence\n\t * @param {Object} task - a task\n\t * @param {string} mode - type of date data operation: \"move\", \"start\", \"end\", \"duration\", undefined\n\t */\n\tupdateTaskDuration(task, mode) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet dir;\n\t\t\tif (mode) {\n\t\t\t\tmode = mode == \"move\" ? \"start\" : mode;\n\t\t\t\tconst old = this._local.tasks().getItem(task.id);\n\t\t\t\tconst field =\n\t\t\t\t\tmode + (mode === \"start\" || mode === \"end\" ? \"_date\" : \"\");\n\t\t\t\tdir = old[field] > task[field] ? -1 : 1;\n\t\t\t\tif (mode != \"start\") mode = \"end\";\n\t\t\t}\n\t\t\tlet scales = webix.copy(this._local.getScales());\n\t\t\tscales.isHoliday = date => {\n\t\t\t\treturn this._local.isHoliday(date, task.id);\n\t\t\t};\n\t\t\tthis._helpers.updateTaskDuration(task, scales, mode, dir);\n\t\t} else this._helpers.updateTaskDuration(task);\n\t}\n\n\tupdatePlannedTaskDuration(task, mode) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet dir;\n\t\t\tif (mode) {\n\t\t\t\tconst old = this._local.tasks().getItem(task.id);\n\t\t\t\tconst field = \"planned_\" + mode;\n\t\t\t\tdir = old[field] > task[field] ? -1 : 1;\n\t\t\t}\n\t\t\tlet scales = webix.copy(this._local.getScales());\n\t\t\tscales.isHoliday = date => {\n\t\t\t\treturn this._local.isHoliday(date, task.id);\n\t\t\t};\n\t\t\tthis._updatePlannedTaskDuration(task, scales, mode, dir);\n\t\t} else this._updatePlannedTaskDuration(task);\n\t}\n\t_updatePlannedTaskDuration(task, scales, mode, dir) {\n\t\tconst t = { ...task };\n\t\tt.start_date = task.planned_start;\n\t\tt.duration = task.planned_duration;\n\t\tt.end_date = task.planned_end;\n\t\tthis._helpers.updateTaskDuration(t, scales, mode, dir);\n\t\ttask.planned_start = t.start_date;\n\t\ttask.planned_end = t.end_date;\n\t\ttask.planned_duration = t.duration;\n\t}\n\n\t/**\n\t * Updates related tasks when project start changes\n\t * @param {string, number} id - project id\n\t * @param {Date} old - old start date\n\t * @param {Date} change - current start date\n\t */\n\tsyncTasks(id, old, change) {\n\t\tlet diff = change - old;\n\n\t\tif (this.app.config.excludeHolidays)\n\t\t\tdiff = this.getWorkDateDiff(diff, old, id);\n\n\t\tif (diff) {\n\t\t\tconst p = [];\n\t\t\tthis._local.tasks().data.eachSubItem(id, kid => {\n\t\t\t\tlet newDate = kid.start_date.valueOf() + diff;\n\t\t\t\tif (this.app.config.excludeHolidays) {\n\t\t\t\t\tconst delta =\n\t\t\t\t\t\tdiff - this.getWorkDateDiff(diff, kid.start_date, kid.id);\n\t\t\t\t\tif (delta) newDate = newDate + delta;\n\t\t\t\t}\n\n\t\t\t\tconst changedKid = {\n\t\t\t\t\t...kid,\n\t\t\t\t\tstart_date: new Date(newDate),\n\t\t\t\t\tend_date: null,\n\t\t\t\t};\n\n\t\t\t\tp.push(this.updateTask(kid.id, changedKid, \"move\", true));\n\t\t\t});\n\t\t\treturn webix.promise.all(p);\n\t\t}\n\n\t\treturn webix.promise.resolve();\n\t}\n\t/**\n\t * Extracts working days from date difference\n\t * @param {number} diff - difference in days, milliseconds\n\t * @param {Date} old - the original date\n\t * @param {string} taskId - a task id (optional, resourceCalendars related)\n\t * @returns {number} difference in working days in milliseconds\n\t */\n\tgetWorkDateDiff(diff, old, taskId) {\n\t\tconst dir = Math.sign(diff);\n\t\tconst dayLen = 86400000;\n\t\tconst ad = dir * Math.floor(diff / dayLen);\n\t\tfor (let i = 0, date = old; i < ad; ++i) {\n\t\t\twebix.Date.add(date, dir, \"day\");\n\t\t\tif (this._local.isHoliday(date, taskId)) diff = diff - dir * dayLen;\n\t\t}\n\t\treturn diff;\n\t}\n\n\t/**\n\t * Updates related project when task start or end date changes\n\t * @param {string, number} id - task id\n\t * @param {object} item - task object, if it is converted to project\n\t * @returns {Promise}\n\t */\n\tsyncProject(id, item) {\n\t\tconst tasks = this._local.tasks();\n\n\t\tif (!item) {\n\t\t\titem = tasks.getItem(id);\n\t\t\tif (this.app.config.projects && item && item.type != \"split\") {\n\t\t\t\titem.type = item.$count ? \"project\" : \"task\";\n\t\t\t\tthis.removeAssignments(item);\n\t\t\t} else {\n\t\t\t\twhile (item && item.type != \"project\") {\n\t\t\t\t\tid = tasks.getParentId(id);\n\t\t\t\t\titem = tasks.getItem(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (item && item.$count) {\n\t\t\titem = this.setProjectData(item);\n\t\t}\n\t\tif (item) {\n\t\t\treturn this.updateTask(id, item, \"start\", true).then(() => {\n\t\t\t\tthis.syncProject(item.parent);\n\t\t\t\treturn item;\n\t\t\t});\n\t\t} else return webix.promise.resolve();\n\t}\n\t/**\n\t * Updates project with task-dependent data taken from tasks collection or an array of child items\n\t * @param {object} item - a project object\n\t * @param {Object} tasks collection (optional, local.tasks() by default)\n\t * @param {array} branch - an array of child items of a project (optional)\n\t */\n\tsetProjectData(item, tasks, branch) {\n\t\tif (!branch) item = webix.copy(item);\n\t\tlet min = Infinity,\n\t\t\tmax = 0,\n\t\t\tprogress = 0,\n\t\t\tduration = 0;\n\n\t\tconst handler = kid => {\n\t\t\tmin = kid.start_date < min ? kid.start_date : min;\n\t\t\tmax = kid.end_date > max ? kid.end_date : max;\n\t\t\tif (kid.duration && !(kid.type == \"project\" && kid.$count)) {\n\t\t\t\tprogress += kid.duration * kid.progress;\n\t\t\t\tduration += kid.duration * 1;\n\t\t\t}\n\t\t};\n\n\t\tif (branch) branch.forEach(handler);\n\t\telse {\n\t\t\tconst collection = tasks || this._local.tasks();\n\t\t\tcollection.data.eachSubItem(item.id, handler);\n\t\t}\n\n\t\tif (!webix.Date.equal(item.start_date, min)) {\n\t\t\titem.start_date = min;\n\t\t\titem.duration = null;\n\t\t}\n\t\tif (!webix.Date.equal(item.end_date, max)) {\n\t\t\titem.end_date = max;\n\t\t\titem.duration = null;\n\t\t}\n\t\titem.progress = progress ? Math.round(progress / duration) : progress;\n\t\treturn item;\n\t}\n\t/**\n\t * Updates task time after drag-n-drop\n\t * @param {string, number} id - task id\n\t * @param {string} mode - type of change: \"start\", \"end\" or \"move\"\n\t * @param {number} time - number of units by which task was shifted, can be negative\n\t * @returns {promise} promise that resolves with change object\n\t */\n\tupdateTaskTime(id, mode, time) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst task = tasks.getItem(id);\n\n\t\tconst obj = {};\n\t\tconst s = this._local.getScales();\n\n\t\tconst unit = s.precise\n\t\t\t? this._helpers.getSmallerUnit(s.minUnit)\n\t\t\t: s.minUnit;\n\t\tif (mode === \"start\" || mode === \"move\") {\n\t\t\tconst offsetDate = s.precise\n\t\t\t\t? task.start_date\n\t\t\t\t: this._helpers.getUnitStart(unit, task.start_date);\n\t\t\tobj.start_date = this._helpers.addUnit(unit, offsetDate, time);\n\t\t\tif (mode === \"start\" && obj.start_date > task.end_date)\n\t\t\t\tobj.start_date = this._helpers.addUnit(unit, task.end_date, -1);\n\t\t} else if (mode === \"end\") {\n\t\t\tconst us = this._helpers.getUnitStart(unit, task.end_date);\n\t\t\tconst offsetDate =\n\t\t\t\ts.precise || webix.Date.equal(us, task.end_date)\n\t\t\t\t\t? task.end_date\n\t\t\t\t\t: this._helpers.addUnit(unit, us, 1);\n\t\t\tobj.end_date = this._helpers.addUnit(unit, offsetDate, time);\n\n\t\t\tif (obj.end_date < task.start_date)\n\t\t\t\tobj.end_date = this._helpers.addUnit(unit, task.start_date, 1);\n\t\t}\n\n\t\tif (mode === \"move\") obj.end_date = null;\n\t\telse obj.duration = 0;\n\n\t\treturn this.updateTask(id, obj, mode);\n\t}\n\t/**\n\t * Removes task\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveTask(id) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst links = this._local.links();\n\n\t\t// [FIXME] - multiple redraw calls\n\t\tconst toRemove = links.find(a => a.source == id || a.target == id);\n\t\ttoRemove.forEach(a => links.remove(a.id));\n\n\t\treturn this._back.removeTask(id).then(res => {\n\t\t\tconst parent = tasks.getItem(id).parent;\n\t\t\ttasks.remove(id);\n\n\t\t\tif (\n\t\t\t\tthis.app.config.split &&\n\t\t\t\tparent != 0 &&\n\t\t\t\ttasks.getItem(parent).type === \"split\" &&\n\t\t\t\t!tasks.find(k => k.parent == parent, true)\n\t\t\t) {\n\t\t\t\treturn this.updateTask(parent, { type: \"task\" }).then(() => {\n\t\t\t\t\treturn this.completeRemoval(res, parent);\n\t\t\t\t});\n\t\t\t} else return this.completeRemoval(res, parent);\n\t\t});\n\t}\n\t/**\n\t * Synchronizes project and updates critical path after a task is removed\n\t * @param {Object} res - server response\n\t * @param {(string|number)} parent - the ID of a parent task\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tcompleteRemoval(res, parent) {\n\t\treturn this.syncProject(parent).then(() => {\n\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Adds a link\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with link object\n\t */\n\taddLink(obj) {\n\t\tif (!this.linkExists(obj)) {\n\t\t\treturn this._back.addLink(obj).then(added => {\n\t\t\t\tobj.id = added.id;\n\t\t\t\tthis._local.links().add(obj);\n\t\t\t\treturn obj;\n\t\t\t});\n\t\t}\n\t\treturn webix.promise.reject();\n\t}\n\n\t/**\n\t * Checks if two tasks are already connected by a link of the same type\n\t * @param {Object} obj - the data object of a link\n\t * @returns {Object, null} - the data object of the link that was found; null if nothing was found\n\t */\n\tlinkExists(obj) {\n\t\treturn this._local.links().find(l => {\n\t\t\treturn (\n\t\t\t\tl.target == obj.target && l.source == obj.source && l.type == obj.type\n\t\t\t);\n\t\t}, true);\n\t}\n\n\t/**\n\t * Updates a link\n\t * @param {string, number} id - link id\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tupdateLink(id, obj) {\n\t\treturn this._back.updateLink(id, obj).then(res => {\n\t\t\tconst links = this._local.links();\n\t\t\tconst duplicate = this.linkExists({ ...links.getItem(id), ...obj });\n\t\t\tlinks.updateItem(id, obj);\n\t\t\tif (duplicate) {\n\t\t\t\treturn this.removeLink(duplicate.id).then(() => res);\n\t\t\t} else return res;\n\t\t});\n\t}\n\t/**\n\t * Removes link\n\t * @param {string, number} id - link id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveLink(id) {\n\t\treturn this._back.removeLink(id).then(res => {\n\t\t\tthis._local.links().remove(id);\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Moves the task to a new position within the task tree\n\t * @param {string, number} id - the ID of the task\n\t * @param {string, number} parent - the ID of the parent/branch (0 for root)\n\t * @param {number} index - the position within the target branch or root (starting from 0)\n\t * @returns {Promise} - the promise of data operation\n\t */\n\tmoveTask(id, parent, index) {\n\t\tparent = parent || 0;\n\n\t\tconst tasks = this._local.tasks();\n\t\tconst branch = tasks.data.branch[parent];\n\t\tconst oldParent = tasks.getItem(id).parent;\n\t\tconst oldIndex = tasks.data.getBranchIndex(id);\n\t\tif (\n\t\t\tparent == oldParent &&\n\t\t\t(index === oldIndex || (index === -1 && id === branch[branch.length - 1]))\n\t\t)\n\t\t\treturn webix.promise.reject();\n\n\t\ttasks.move(id, index, null, { parent });\n\n\t\treturn this._back\n\t\t\t.reorderTask(id, {\n\t\t\t\tparent,\n\t\t\t\tmode: index === 0 ? \"first\" : index === -1 ? \"last\" : \"after\",\n\t\t\t\ttarget: tasks.data.branch[parent][index - 1],\n\t\t\t})\n\t\t\t.then(res => {\n\t\t\t\tif (parent !== oldParent) {\n\t\t\t\t\ttasks.updateItem(id, { parent });\n\n\t\t\t\t\treturn webix.promise\n\t\t\t\t\t\t.all([this.syncProject(parent), this.syncProject(oldParent)])\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\t\t\t\t\t\t\treturn res;\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn res;\n\t\t\t});\n\t}\n\t/**\n\t * Updates a resource assignment\n\t * @param {string, number} id -  an id of a resource assignment\n\t * @param {object} obj - an object with updated fields\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tupdateAssignment(id, obj) {\n\t\treturn this._back.updateAssignment(id, obj).then(res => {\n\t\t\tthis._local.assignments().updateItem(id, obj);\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Assigns a resource assignment to a task\n\t * @param {object} obj - an object with \"task\", \"resource\" and \"value\" fields\n\t * @returns {promise} a promise that is resolved with an object of a resource assignment\n\t */\n\taddAssignment(obj) {\n\t\treturn this._back.addAssignment(obj).then(added => {\n\t\t\tobj.id = added.id;\n\t\t\tthis._local.assignments().add(obj);\n\t\t\treturn obj;\n\t\t});\n\t}\n\t/**\n\t * Removes a resource assignment\n\t * @param {string, number} id - an id of a resource assignment\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveAssignment(id) {\n\t\treturn this._back.removeAssignment(id).then(res => {\n\t\t\tthis._local.assignments().remove(id);\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/**\n\t * Sorts resources\n\t * @param {object} a - a resource to compare\n\t * @param {object} b - a resource to compare\n\t * @returns {number}\n\t */\n\tsortResources(a, b) {\n\t\tif (a.category == b.category) return a.name > b.name ? 1 : -1;\n\t\treturn a.category > b.category ? 1 : -1;\n\t}\n\n\t/**\n\t * Removes all assignments (if any) from a task\n\t * @param {object} task - task object\n\t * @returns {Promise}\n\t */\n\tremoveAssignments(task) {\n\t\tif (this.app.config.resources) {\n\t\t\tconst collection = this._local.assignments();\n\t\t\tlet waitArr = [];\n\t\t\treturn collection.waitData.then(() => {\n\t\t\t\tcollection.data.each(item => {\n\t\t\t\t\tif (item.task == task.id)\n\t\t\t\t\t\twaitArr.push(this.removeAssignment(item.id));\n\t\t\t\t});\n\t\t\t\tif (waitArr.length) return webix.promise.all(waitArr);\n\t\t\t\treturn webix.promise.resolve(false);\n\t\t\t});\n\t\t}\n\t\treturn webix.promise.resolve(false);\n\t}\n\n\t/**\n\t * Cleans task data from all $-fields, they are functional and locally used and should not be sent to backend\n\t * */\n\tcleanData(obj) {\n\t\tconst res = {};\n\t\tfor (let key in obj) {\n\t\t\tif (key.indexOf(\"$\") !== 0) res[key] = obj[key];\n\t\t}\n\t\treturn res;\n\t}\n\n\tupdateAssignedTaskDates(task) {\n\t\tconst obj = webix.copy(task);\n\t\tthis.updateTaskDuration(obj);\n\t\tconst updateDates = !(\n\t\t\twebix.Date.equal(task.start_date, obj.start_date) &&\n\t\t\twebix.Date.equal(task.end_date, obj.end_date)\n\t\t);\n\t\tif (updateDates) this.updateTask(task.id, obj, null, true);\n\t}\n}\n","function toInteger(dirtyNumber) {\n  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {\n    return NaN;\n  }\n\n  var number = Number(dirtyNumber);\n\n  if (isNaN(number)) {\n    return number;\n  }\n\n  return number < 0 ? Math.ceil(number) : Math.floor(number);\n}\n\nfunction requiredArgs(required, args) {\n  if (args.length < required) {\n    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');\n  }\n}\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @param {Date|Number} argument - the value to convert\n * @returns {Date} the parsed date in the local time zone\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\n\nfunction toDate(argument) {\n  requiredArgs(1, arguments);\n  var argStr = Object.prototype.toString.call(argument); // Clone the date\n\n  if (argument instanceof Date || typeof argument === 'object' && argStr === '[object Date]') {\n    // Prevent the date to lose the milliseconds when passed to new Date() in IE10\n    return new Date(argument.getTime());\n  } else if (typeof argument === 'number' || argStr === '[object Number]') {\n    return new Date(argument);\n  } else {\n    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn(\"Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule\"); // eslint-disable-next-line no-console\n\n      console.warn(new Error().stack);\n    }\n\n    return new Date(NaN);\n  }\n}\n\n/**\n * @name addDays\n * @category Day Helpers\n * @summary Add the specified number of days to the given date.\n *\n * @description\n * Add the specified number of days to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of days to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} - the new date with the days added\n * @throws {TypeError} - 2 arguments required\n *\n * @example\n * // Add 10 days to 1 September 2014:\n * const result = addDays(new Date(2014, 8, 1), 10)\n * //=> Thu Sep 11 2014 00:00:00\n */\n\nfunction addDays(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var amount = toInteger(dirtyAmount);\n\n  if (isNaN(amount)) {\n    return new Date(NaN);\n  }\n\n  if (!amount) {\n    // If 0 days, no-op to avoid changing times in the hour before end of DST\n    return date;\n  }\n\n  date.setDate(date.getDate() + amount);\n  return date;\n}\n\n/**\n * @name addMonths\n * @category Month Helpers\n * @summary Add the specified number of months to the given date.\n *\n * @description\n * Add the specified number of months to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of months to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the months added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 5 months to 1 September 2014:\n * const result = addMonths(new Date(2014, 8, 1), 5)\n * //=> Sun Feb 01 2015 00:00:00\n */\n\nfunction addMonths(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var amount = toInteger(dirtyAmount);\n\n  if (isNaN(amount)) {\n    return new Date(NaN);\n  }\n\n  if (!amount) {\n    // If 0 months, no-op to avoid changing times in the hour before end of DST\n    return date;\n  }\n\n  var dayOfMonth = date.getDate(); // The JS Date object supports date math by accepting out-of-bounds values for\n  // month, day, etc. For example, new Date(2020, 0, 0) returns 31 Dec 2019 and\n  // new Date(2020, 13, 1) returns 1 Feb 2021.  This is *almost* the behavior we\n  // want except that dates will wrap around the end of a month, meaning that\n  // new Date(2020, 13, 31) will return 3 Mar 2021 not 28 Feb 2021 as desired. So\n  // we'll default to the end of the desired month by adding 1 to the desired\n  // month and using a date of 0 to back up one day to the end of the desired\n  // month.\n\n  var endOfDesiredMonth = new Date(date.getTime());\n  endOfDesiredMonth.setMonth(date.getMonth() + amount + 1, 0);\n  var daysInMonth = endOfDesiredMonth.getDate();\n\n  if (dayOfMonth >= daysInMonth) {\n    // If we're already at the end of the month, then this is the correct date\n    // and we're done.\n    return endOfDesiredMonth;\n  } else {\n    // Otherwise, we now know that setting the original day-of-month value won't\n    // cause an overflow, so set the desired day-of-month. Note that we can't\n    // just set the date of `endOfDesiredMonth` because that object may have had\n    // its time changed in the unusual case where where a DST transition was on\n    // the last day of the month and its local time was in the hour skipped or\n    // repeated next to a DST transition.  So we use `date` instead which is\n    // guaranteed to still have the original time.\n    date.setFullYear(endOfDesiredMonth.getFullYear(), endOfDesiredMonth.getMonth(), dayOfMonth);\n    return date;\n  }\n}\n\n/**\n * @name addMilliseconds\n * @category Millisecond Helpers\n * @summary Add the specified number of milliseconds to the given date.\n *\n * @description\n * Add the specified number of milliseconds to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the milliseconds added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 750 milliseconds to 10 July 2014 12:45:30.000:\n * const result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:30.750\n */\n\nfunction addMilliseconds(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var timestamp = toDate(dirtyDate).getTime();\n  var amount = toInteger(dirtyAmount);\n  return new Date(timestamp + amount);\n}\n\nvar MILLISECONDS_IN_HOUR = 3600000;\n/**\n * @name addHours\n * @category Hour Helpers\n * @summary Add the specified number of hours to the given date.\n *\n * @description\n * Add the specified number of hours to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of hours to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the hours added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 2 hours to 10 July 2014 23:00:00:\n * const result = addHours(new Date(2014, 6, 10, 23, 0), 2)\n * //=> Fri Jul 11 2014 01:00:00\n */\n\nfunction addHours(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_HOUR);\n}\n\n/**\n * @name startOfWeek\n * @category Week Helpers\n * @summary Return the start of a week for the given date.\n *\n * @description\n * Return the start of a week for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Date} the start of a week\n * @throws {TypeError} 1 argument required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // The start of a week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Sun Aug 31 2014 00:00:00\n *\n * @example\n * // If the week starts on Monday, the start of the week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0), { weekStartsOn: 1 })\n * //=> Mon Sep 01 2014 00:00:00\n */\n\nfunction startOfWeek(dirtyDate, dirtyOptions) {\n  requiredArgs(1, arguments);\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = date.getDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setDate(date.getDate() - diff);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nfunction getTimezoneOffsetInMilliseconds(date) {\n  var utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));\n  utcDate.setUTCFullYear(date.getFullYear());\n  return date.getTime() - utcDate.getTime();\n}\n\n/**\n * @name startOfDay\n * @category Day Helpers\n * @summary Return the start of a day for the given date.\n *\n * @description\n * Return the start of a day for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the start of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The start of a day for 2 September 2014 11:55:00:\n * const result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 00:00:00\n */\n\nfunction startOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nvar MILLISECONDS_IN_DAY = 86400000;\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar days\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\n\nfunction differenceInCalendarDays(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var startOfDayLeft = startOfDay(dirtyDateLeft);\n  var startOfDayRight = startOfDay(dirtyDateRight);\n  var timestampLeft = startOfDayLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfDayLeft);\n  var timestampRight = startOfDayRight.getTime() - getTimezoneOffsetInMilliseconds(startOfDayRight); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a day is not constant\n  // (e.g. it's different in the day of the daylight saving time clock shift)\n\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_DAY);\n}\n\nvar MILLISECONDS_IN_MINUTE = 60000;\n/**\n * @name addMinutes\n * @category Minute Helpers\n * @summary Add the specified number of minutes to the given date.\n *\n * @description\n * Add the specified number of minutes to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of minutes to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the minutes added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 30 minutes to 10 July 2014 12:00:00:\n * const result = addMinutes(new Date(2014, 6, 10, 12, 0), 30)\n * //=> Thu Jul 10 2014 12:30:00\n */\n\nfunction addMinutes(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_MINUTE);\n}\n\n/**\n * @name addQuarters\n * @category Quarter Helpers\n * @summary Add the specified number of year quarters to the given date.\n *\n * @description\n * Add the specified number of year quarters to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of quarters to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the quarters added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 1 quarter to 1 September 2014:\n * const result = addQuarters(new Date(2014, 8, 1), 1)\n * //=> Mon Dec 01 2014 00:00:00\n */\n\nfunction addQuarters(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  var months = amount * 3;\n  return addMonths(dirtyDate, months);\n}\n\n/**\n * @name addWeeks\n * @category Week Helpers\n * @summary Add the specified number of weeks to the given date.\n *\n * @description\n * Add the specified number of week to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of weeks to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the weeks added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 4 weeks to 1 September 2014:\n * const result = addWeeks(new Date(2014, 8, 1), 4)\n * //=> Mon Sep 29 2014 00:00:00\n */\n\nfunction addWeeks(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  var days = amount * 7;\n  return addDays(dirtyDate, days);\n}\n\n/**\n * @name addYears\n * @category Year Helpers\n * @summary Add the specified number of years to the given date.\n *\n * @description\n * Add the specified number of years to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of years to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the years added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 5 years to 1 September 2014:\n * const result = addYears(new Date(2014, 8, 1), 5)\n * //=> Sun Sep 01 2019 00:00:00\n */\n\nfunction addYears(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMonths(dirtyDate, amount * 12);\n}\n\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the first date to compare\n * @param {Date|Number} dateRight - the second date to compare\n * @returns {Number} the result of the comparison\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * const result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * const result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\n\nfunction compareAsc(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var diff = dateLeft.getTime() - dateRight.getTime();\n\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1; // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}\n\n/**\n * Days in 1 week.\n *\n * @name daysInWeek\n * @constant\n * @type {number}\n * @default\n */\n/**\n * Milliseconds in 1 minute\n *\n * @name millisecondsInMinute\n * @constant\n * @type {number}\n * @default\n */\n\nvar millisecondsInMinute = 60000;\n/**\n * Milliseconds in 1 hour\n *\n * @name millisecondsInHour\n * @constant\n * @type {number}\n * @default\n */\n\nvar millisecondsInHour = 3600000;\n\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * var result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\n\nfunction differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}\n\nvar MILLISECONDS_IN_WEEK = 604800000;\n/**\n * @name differenceInCalendarWeeks\n * @category Week Helpers\n * @summary Get the number of calendar weeks between the given dates.\n *\n * @description\n * Get the number of calendar weeks between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Number} the number of calendar weeks\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // How many calendar weeks are between 5 July 2014 and 20 July 2014?\n * const result = differenceInCalendarWeeks(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 6, 5)\n * )\n * //=> 3\n *\n * @example\n * // If the week starts on Monday,\n * // how many calendar weeks are between 5 July 2014 and 20 July 2014?\n * const result = differenceInCalendarWeeks(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 6, 5),\n *   { weekStartsOn: 1 }\n * )\n * //=> 2\n */\n\nfunction differenceInCalendarWeeks(dirtyDateLeft, dirtyDateRight, dirtyOptions) {\n  requiredArgs(2, arguments);\n  var startOfWeekLeft = startOfWeek(dirtyDateLeft, dirtyOptions);\n  var startOfWeekRight = startOfWeek(dirtyDateRight, dirtyOptions);\n  var timestampLeft = startOfWeekLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfWeekLeft);\n  var timestampRight = startOfWeekRight.getTime() - getTimezoneOffsetInMilliseconds(startOfWeekRight); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_WEEK);\n}\n\n/**\n * @name differenceInCalendarYears\n * @category Year Helpers\n * @summary Get the number of calendar years between the given dates.\n *\n * @description\n * Get the number of calendar years between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInCalendarYears(\n *   new Date(2015, 1, 11),\n *   new Date(2013, 11, 31)\n * )\n * //=> 2\n */\n\nfunction differenceInCalendarYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  return dateLeft.getFullYear() - dateRight.getFullYear();\n}\n\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of milliseconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\n\nfunction differenceInMilliseconds(dateLeft, dateRight) {\n  requiredArgs(2, arguments);\n  return toDate(dateLeft).getTime() - toDate(dateRight).getTime();\n}\n\nvar roundingMap = {\n  ceil: Math.ceil,\n  round: Math.round,\n  floor: Math.floor,\n  trunc: function (value) {\n    return value < 0 ? Math.ceil(value) : Math.floor(value);\n  } // Math.trunc is not supported by IE\n\n};\nvar defaultRoundingMethod = 'trunc';\nfunction getRoundingMethod(method) {\n  return method ? roundingMap[method] : roundingMap[defaultRoundingMethod];\n}\n\n/**\n * @name differenceInHours\n * @category Hour Helpers\n * @summary Get the number of hours between the given dates.\n *\n * @description\n * Get the number of hours between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of hours\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many hours are between 2 July 2014 06:50:00 and 2 July 2014 19:00:00?\n * const result = differenceInHours(\n *   new Date(2014, 6, 2, 19, 0),\n *   new Date(2014, 6, 2, 6, 50)\n * )\n * //=> 12\n */\n\nfunction differenceInHours(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInHour;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name differenceInMinutes\n * @category Minute Helpers\n * @summary Get the number of minutes between the given dates.\n *\n * @description\n * Get the signed number of full (rounded towards 0) minutes between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of minutes\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many minutes are between 2 July 2014 12:07:59 and 2 July 2014 12:20:00?\n * const result = differenceInMinutes(\n *   new Date(2014, 6, 2, 12, 20, 0),\n *   new Date(2014, 6, 2, 12, 7, 59)\n * )\n * //=> 12\n *\n * @example\n * // How many minutes are between 10:01:59 and 10:00:00\n * const result = differenceInMinutes(\n *   new Date(2000, 0, 1, 10, 0, 0),\n *   new Date(2000, 0, 1, 10, 1, 59)\n * )\n * //=> -1\n */\n\nfunction differenceInMinutes(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInMinute;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\n\nfunction endOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\n\nfunction endOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var month = date.getMonth();\n  date.setFullYear(date.getFullYear(), month + 1, 0);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}\n\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to check\n * @returns {Boolean} the date is the last day of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * var result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\n\nfunction isLastDayOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  return endOfDay(date).getTime() === endOfMonth(date).getTime();\n}\n\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @description\n * Get the number of full months between the given dates using trunc as a default rounding method.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\n\nfunction differenceInMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarMonths(dateLeft, dateRight));\n  var result; // Check for the difference of less than month\n\n  if (difference < 1) {\n    result = 0;\n  } else {\n    if (dateLeft.getMonth() === 1 && dateLeft.getDate() > 27) {\n      // This will check if the date is end of Feb and assign a higher end of month date\n      // to compare it with Jan\n      dateLeft.setDate(30);\n    }\n\n    dateLeft.setMonth(dateLeft.getMonth() - sign * difference); // Math.abs(diff in full months - diff in calendar months) === 1 if last calendar month is not full\n    // If so, result must be decreased by 1 in absolute value\n\n    var isLastMonthNotFull = compareAsc(dateLeft, dateRight) === -sign; // Check for cases of one full calendar month\n\n    if (isLastDayOfMonth(toDate(dirtyDateLeft)) && difference === 1 && compareAsc(dirtyDateLeft, dateRight) === 1) {\n      isLastMonthNotFull = false;\n    }\n\n    result = sign * (difference - Number(isLastMonthNotFull));\n  } // Prevent negative zero\n\n\n  return result === 0 ? 0 : result;\n}\n\n/**\n * @name differenceInQuarters\n * @category Quarter Helpers\n * @summary Get the number of quarters between the given dates.\n *\n * @description\n * Get the number of quarters between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of full quarters\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full quarters are between 31 December 2013 and 2 July 2014?\n * const result = differenceInQuarters(new Date(2014, 6, 2), new Date(2013, 11, 31))\n * //=> 2\n */\n\nfunction differenceInQuarters(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMonths(dateLeft, dateRight) / 3;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name differenceInYears\n * @category Year Helpers\n * @summary Get the number of full years between the given dates.\n *\n * @description\n * Get the number of full years between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInYears(new Date(2015, 1, 11), new Date(2013, 11, 31))\n * //=> 1\n */\n\nfunction differenceInYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarYears(dateLeft, dateRight)); // Set both dates to a valid leap year for accurate comparison when dealing\n  // with leap days\n\n  dateLeft.setFullYear(1584);\n  dateRight.setFullYear(1584); // Math.abs(diff in full years - diff in calendar years) === 1 if last calendar year is not full\n  // If so, result must be decreased by 1 in absolute value\n\n  var isLastYearNotFull = compareAsc(dateLeft, dateRight) === -sign;\n  var result = sign * (difference - Number(isLastYearNotFull)); // Prevent negative zero\n\n  return result === 0 ? 0 : result;\n}\n\nfunction getDatePart(date, copy) {\n    if (copy)\n        date = new Date(date.valueOf());\n    // workaround for non-existent hours\n    const d = new Date(date.valueOf());\n    d.setHours(0);\n    if (d.getDate() != date.getDate()) {\n        date.setHours(1);\n    }\n    else {\n        date.setHours(0);\n    }\n    date.setMinutes(0);\n    date.setSeconds(0);\n    date.setMilliseconds(0);\n    return date;\n}\nfunction getTimePart(date, copy) {\n    if (copy)\n        date = new Date(date.valueOf());\n    return (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n}\nfunction differenceInWeeks(a, b, startOnMonday) {\n    const weekStartsOn = startOnMonday ? 1 : 0;\n    return differenceInCalendarWeeks(a, b, { weekStartsOn });\n}\nfunction getDay(date, startOnMonday) {\n    let shift = date.getDay();\n    if (startOnMonday) {\n        if (shift === 0)\n            shift = 6;\n        else\n            shift--;\n    }\n    return shift;\n}\n\nconst diff = {\n    year: differenceInYears,\n    quarter: differenceInQuarters,\n    month: differenceInMonths,\n    week: differenceInWeeks,\n    day: differenceInCalendarDays,\n    hour: differenceInHours,\n    minute: differenceInMinutes,\n};\nfunction countDaysInMonth(date) {\n    if (!date)\n        return 30;\n    const m = date.getMonth();\n    if (m === 1) {\n        const y = date.getFullYear();\n        if (y % 4)\n            return 28;\n        if (y % 100)\n            return 29;\n        if (y % 400)\n            return 28;\n        return 29;\n    }\n    if ((m % 2 && m < 7) || (!(m % 2) && m > 7)) {\n        return 30;\n    }\n    return 31;\n}\nconst smallerCount = {\n    year: [\"quarter\", 4],\n    quarter: [\"month\", 3],\n    month: [\"day\", countDaysInMonth],\n    week: [\"day\", 7],\n    day: [\"hour\", 24],\n    hour: [\"minute\", 60],\n    minute: [\"minute\", 1],\n};\nconst add = {\n    year: addYears,\n    quarter: addQuarters,\n    month: addMonths,\n    week: addWeeks,\n    day: addDays,\n    hour: addHours,\n    minute: addMinutes,\n};\n/**\n * Calculates the difference between two dates in units\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\n * @param {Date} next - a later date\n * @param {Date} prev - an earlier date\n * @param {boolean} startOnMonday - true if week starts on Monday, false otherwise\n * @param {boolean} precise - current precision setting of the scales (if true, diff will be counted for smallerCount)\n * @param {boolean} wt - shows that diff will be counted for the width of a task\n * @returns {number} - an int (if precise is false) or a float number\n */\nfunction innerDiff(unit, next, prev, startOnMonday, precise, wt) {\n    let minUnit = unit;\n    if (precise) {\n        const u = smallerCount[unit][0];\n        if (typeof u !== \"number\" && typeof u !== \"function\")\n            minUnit = u;\n    }\n    let start = prev;\n    let end = next;\n    if (wt) {\n        start = getUnitStart(minUnit, start, startOnMonday);\n        end = getUnitStart(minUnit, end, startOnMonday);\n        if (end < next)\n            end = addUnit(minUnit)(end, 1);\n    }\n    if (precise) {\n        const filled = diff[minUnit](end, start);\n        const count = smallerCount[unit][1];\n        let all = 0;\n        if (typeof count === \"function\")\n            all = count(prev);\n        else if (typeof count === \"number\")\n            all = count;\n        return filled / all;\n    }\n    else {\n        return diff[minUnit](end, start, startOnMonday);\n    }\n}\n/**\n * Returns a function for calculating the difference between two dates in units\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\n * @returns {function} - details below\n */\nfunction getDiff(unit) {\n    /**\n     * the returned function calculates the difference between two dates based on passed parameters\n     * @param {Date} next - first date\n     * @param {Date} prev - second date\n     * @param {boolean} startOnMonday - true if week starts on Monday, false otherwise\n     * @param {boolean} precise false by default, true when used to count x-position\n     * and width of tasks with 'step-1' precision\n     * @param {boolean} wt - marker that diff is used to count width of a task;\n     * if diff returns 0, you have to add 1; otherwise tasks that are within 1 unit will have 0 width\n     * and will be displayed incorrectly\n     * @returns {number} - the difference between two dates in 'units'; if 'precise' is true, the number is float, otherwise int\n     */\n    return (next, prev, startOnMonday, precise, wt) => {\n        if (unit === \"month\" && precise) {\n            return getMonthDayDiff(next, prev, wt);\n        }\n        else {\n            return innerDiff(unit, next, prev, startOnMonday, precise, wt);\n        }\n    };\n}\n/**\n * Calculates the difference in months between two days for a scale with precision setting\n * This is a specific case of diff counting, because a month can have 28-31 days\n * @param {Date} end - a later date\n * @param {Date} start - an earlier date\n * @param {Boolean} wt - shows that diff will be counted for the width of a task\n * @returns {number} - a float number\n */\nfunction getMonthDayDiff(end, start, wt) {\n    if (sameMonth(start, end)) {\n        return innerDiff(\"month\", end, start, null, true, wt);\n    }\n    // if starts not on 1st day\n    let daysOfFirstMonth = 0;\n    if (start.getDate() > 1) {\n        const me = new Date(start.getFullYear(), start.getMonth() + 1, 1);\n        daysOfFirstMonth = innerDiff(\"month\", me, start, null, true);\n        start = me;\n    }\n    // if lasts 1+ whole months\n    let months = 0;\n    if (!sameMonth(start, end)) {\n        months = innerDiff(\"month\", getUnitStart(\"month\", end), start); // int part\n        start = addUnit(\"month\")(start, months);\n    }\n    // all above plus days of last month if any\n    return daysOfFirstMonth + months + innerDiff(\"month\", end, start, null, true);\n}\nfunction sameMonth(a, b) {\n    return (getUnitStart(\"month\", a).valueOf() === getUnitStart(\"month\", b).valueOf());\n}\nfunction addUnit(unit) {\n    return add[unit];\n}\nfunction getUnitStart(unit, start, startOnMonday) {\n    let t;\n    switch (unit) {\n        case \"year\":\n            return new Date(start.getFullYear(), 0, 1);\n        case \"quarter\":\n            return new Date(start.getFullYear(), Math.floor(start.getMonth() / 3) * 3, 1);\n        case \"month\":\n            return new Date(start.getFullYear(), start.getMonth(), 1);\n        case \"week\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setDate(start.getDate() - getDay(start, startOnMonday));\n            return t;\n        case \"day\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setHours(0, 0, 0, 0);\n            return t;\n        case \"hour\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setHours(start.getHours(), 0, 0, 0);\n            return t;\n        default:\n            return new Date(start);\n    }\n}\n\nfunction getMinUnit(scales) {\n    const start = new Date();\n    return scales\n        .map(item => ({ item, len: addUnit(item.unit)(start, 1) }))\n        .sort((a, b) => (a.len < b.len ? -1 : 1))[0].item.unit;\n}\n/**\n * Resets scales to new parameters and returns the object that stores related constants and functions\n * @param {Date} start - start date\n * @param {Date} end - end date\n * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\n * @param {number} width - width of smallest cell unit\n * @param {number} height - height of scale cell\n * @param {Array} scales - a set of scales (objects)\n * @param {function} isHoliday - the function that checks if a day is a holiday\n * @param {boolean} startOnMonday - flag that defines whether the week starts on Monday\n * @returns {Object} scales\n */\nfunction resetScales(start, end, precise, width, height, scales, isHoliday, startOnMonday) {\n    // console.log(\"[x] reset scales\");\n    const minUnit = getMinUnit(scales);\n    const diff = getDiff(minUnit);\n    const tempEnd = getUnitStart(minUnit, end, startOnMonday);\n    start = getUnitStart(minUnit, start, startOnMonday);\n    end = tempEnd < end ? addUnit(minUnit)(tempEnd, 1) : tempEnd;\n    const fullWidth = diff(end, start, startOnMonday) * width;\n    const fullHeight = height * scales.length;\n    const rows = scales.map(line => {\n        const cells = [];\n        const add = addUnit(line.unit);\n        const step = line.step || 1;\n        const countInWeeks = minUnit === \"week\" && line.unit !== \"week\";\n        let date = getUnitStart(line.unit, start, startOnMonday);\n        while (date < end) {\n            let next = add(date, step);\n            if (date < start)\n                date = start;\n            if (next > end)\n                next = end;\n            /**\n             * Special handling for counting width of greater units in weeks\n             * this code decides whether a week belongs to the current greater unit based on weekdays of this unit boundaries\n             * if start day is Thursday+, then this greater unit should not count this week as its own\n             * if end day is Thursday+, then this greater unit should count this week as its own\n             */\n            let cdate = date;\n            let cnext = next;\n            if (countInWeeks) {\n                if (getDay(date, startOnMonday) > 3) {\n                    cdate = addUnit(\"week\")(date, 1);\n                }\n                if (getDay(next, startOnMonday) > 3) {\n                    cnext = addUnit(\"week\")(next, 1);\n                }\n            }\n            const cellWidth = (diff(cnext, cdate, startOnMonday) || 1) * width;\n            let css = \"\";\n            if (line.css)\n                css += typeof line.css === \"function\" ? line.css(date) : line.css;\n            cells.push({\n                width: cellWidth,\n                css,\n                date,\n                format: line.format,\n            });\n            date = next;\n        }\n        return { cells, add, height, type: line.unit, step: line.step || 1 };\n    });\n    precise = !!(minUnit === \"day\" ? precise : precise != false);\n    return {\n        rows,\n        width: fullWidth,\n        height: fullHeight,\n        cellWidth: width,\n        cellHeight: height,\n        diff,\n        start,\n        end,\n        minUnit,\n        precise,\n        isHoliday,\n        startOnMonday,\n    };\n}\nfunction grid(width, height, color) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.setAttribute(\"width\", width + \"\");\n    canvas.setAttribute(\"height\", height + \"\");\n    const ctx = canvas.getContext(\"2d\");\n    ctx.strokeStyle = color;\n    ctx.moveTo(0, height);\n    ctx.lineTo(width, height);\n    ctx.lineTo(width, 0);\n    ctx.stroke();\n    return canvas.toDataURL();\n}\n\n/**\n * Prepares dimensional coordinates for a task\n * @param {Object} task - task data object\n * @param {number} i - the index of the task\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {number} taskHeight - the height of a task bar\n * @param {number} y - the top position of a task after which the current task will be placed (timeline mode)\n * @returns {Object} task data object\n */\nfunction updateTask(task, i, scales, taskHeight, y) {\n    if (task.type === \"split\" && task.$data && task.$data.length) {\n        task.$data.forEach(k => setSizes(k, i, scales, taskHeight));\n    }\n    else {\n        setSizes(task, i, scales, taskHeight, y);\n    }\n    return task;\n}\nfunction setSizes(task, i, scales, taskHeight, y) {\n    const { start, end, cellWidth, cellHeight, diff, minUnit, precise } = scales;\n    const startDate = task.start_date < start ? start : task.start_date;\n    const endDate = task.end_date > end ? end : task.end_date;\n    const astart = getUnitStart(minUnit, start, scales.startOnMonday);\n    const ms = task.type == \"milestone\";\n    task.$h = taskHeight;\n    task.$x =\n        Math.round(diff(startDate, astart, scales.startOnMonday, precise) * cellWidth) - (ms ? task.$h / 2 : 0);\n    task.$w = ms\n        ? task.$h\n        : Math.round(diff(endDate, startDate, scales.startOnMonday, precise, true) *\n            cellWidth);\n    task.$y =\n        typeof y === \"undefined\"\n            ? cellHeight * i + (cellHeight - taskHeight) / 2\n            : y;\n}\n/**\n * Updates start, end and duration fields of tasks during initial loading and updating\n * @param {Object} task - task data object\n * @param {Object} scales - (optional) the data for current scales; the return value of resetScales()\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\n */\nfunction updateTaskDuration(task, scales, mode, dir) {\n    if (task.start_date &&\n        task.end_date &&\n        task.start_date.valueOf() >= task.end_date.valueOf()) {\n        task.end_date = null;\n        task.duration = 1;\n        if (mode)\n            mode = \"move\";\n    }\n    if (scales) {\n        excludeHolidays(task, scales, mode, dir);\n    }\n    else {\n        if (task.type == \"milestone\") {\n            getMilestone(task);\n        }\n        else {\n            if (!task.duration) {\n                task.duration = getDuration(task);\n            }\n            if (!task.end_date) {\n                task.end_date = getEnd(task);\n            }\n        }\n    }\n}\n/**\n * Excludes holidays from start, end and duration of tasks (can't start or end on a holiday)\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\n */\nfunction excludeHolidays(task, scales, mode, dir) {\n    if (task.type == \"milestone\") {\n        task.start_date = mode\n            ? toWorkday(task.start_date, false, scales, dir)\n            : toClosestWorkday(task.start_date, scales); //on load\n        return getMilestone(task);\n    }\n    if (!mode) {\n        //on load\n        task.start_date = toClosestWorkday(task.start_date, scales);\n        task.end_date = getEndWorkday(task, scales);\n        task.duration = getDuration(task, scales);\n    }\n    else {\n        if (mode == \"start\" || mode == \"move\") {\n            task.start_date = toWorkday(task.start_date, false, scales, dir);\n            if (!task.duration)\n                task.duration = getDuration(task, scales);\n            if (!task.end_date)\n                task.end_date = getEndWorkday(task, scales);\n        }\n        else {\n            //end, duration\n            if (!task.end_date)\n                task.end_date = getEndWorkday(task, scales);\n            if (!task.duration) {\n                task.end_date = toWorkday(task.end_date, true, scales, dir);\n                task.duration = getDuration(task, scales);\n            }\n        }\n    }\n}\nfunction getMilestone(task) {\n    task.duration = 0;\n    task.end_date = task.start_date;\n}\n/**\n * Returns the end date of a task\n * @param {Object} task - task data object\n */\nfunction getEnd(task) {\n    if (task.duration < 1)\n        return addUnit(\"hour\")(task.start_date, Math.floor(24 * task.duration));\n    else\n        return addUnit(\"day\")(task.start_date, task.duration);\n}\n/**\n * Returns end date excluding holidays from duration\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {Date} end date\n */\nfunction getEndWorkday(task, scales) {\n    if (task.duration < 1)\n        return getEnd(task);\n    let date = getDatePart(task.start_date);\n    for (let w = 0, d = 0; w < task.duration;) {\n        if (!scales.isHoliday(date)) {\n            ++w;\n            d = 0;\n        }\n        else {\n            if (++d === 30)\n                holidayGuard();\n        }\n        date = addUnit(\"day\")(date, 1);\n    }\n    return date;\n}\n/**\n * Calculates the duration of a task\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {number} task duration\n */\nfunction getDuration(task, scales) {\n    const d = getDiff(\"day\")(task.end_date, task.start_date, true);\n    // allow float duration for tasks smaller than day\n    if (d < 1)\n        return parseFloat(d.toFixed(2));\n    if (!scales)\n        return Math.floor(d);\n    let date = task.start_date;\n    let duration = 0;\n    while (date < task.end_date) {\n        if (!scales.isHoliday(date))\n            ++duration;\n        date = addUnit(\"day\")(date, 1);\n    }\n    return duration;\n}\n/**\n * Moves a date from a holiday to the closest working day (priority to the future)\n * @param {Date} date - original date\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {Date} the date of a closest work day\n */\nfunction toClosestWorkday(date, scales) {\n    let left = date;\n    let right = date;\n    let notRight;\n    let d = 0;\n    while (d < 30 &&\n        (notRight = scales.isHoliday(right)) &&\n        scales.isHoliday(left)) {\n        left = addUnit(\"day\")(left, -1);\n        right = addUnit(\"day\")(right, 1);\n        d++;\n    }\n    if (d === 30)\n        holidayGuard();\n    return !notRight ? right : left;\n}\nfunction holidayGuard() {\n    alert(\"No work days found within 30 days, check your isHoliday function!\");\n    throw \"Wrong isHoliday function\";\n}\n/**\n * Moves a date from a holiday to a working day in the given direction\n * @param {Date} date - the current date\n * @param {Boolean} end - indicates if this is the end of a task\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {number} dir - the direction in which nearest workday will be located; -1 is the past, 1 is the future\n * @returns {Date} the date of a working day\n */\nfunction toWorkday(date, end, scales, dir) {\n    let d = 0;\n    while (d < 30 && scales.isHoliday(getCheckDate(date, end))) {\n        date = addUnit(\"day\")(date, dir);\n        d++;\n    }\n    if (d === 30)\n        holidayGuard();\n    return date;\n}\n/**\n * Returns the date for a holiday check\n * @param {Date} date - the date\n * @param {Boolean} end - if true, means it's the end date (end dates are exclusive)\n * @returns {Date} the date that will be used for a check\n */\nfunction getCheckDate(date, end) {\n    return end && !getTimePart(date) ? addUnit(\"day\")(date, -1) : date;\n}\n\nconst delta = 20;\nfunction updateLink(link, startTask, endTask, height) {\n    const dy = Math.round(height / 2);\n    if (!startTask || !endTask) {\n        link.$p = \"\";\n        return link;\n    }\n    let s_start = false;\n    let e_start = false;\n    switch (link.type) {\n        case 0:\n            e_start = true;\n            break;\n        case 1:\n            s_start = true;\n            e_start = true;\n            break;\n        case 3:\n            s_start = true;\n            break;\n    }\n    const sx = s_start ? startTask.$x : startTask.$x + startTask.$w;\n    const sy = startTask.$y;\n    const ex = e_start ? endTask.$x : endTask.$x + endTask.$w;\n    const ey = endTask.$y;\n    if (differentX(startTask, endTask, sx, ex, height) || sy !== ey) {\n        const lineCoords = getLineCoords(sx, sy + dy, ex, ey + dy, s_start, e_start, 38 / 2);\n        const arrowCoords = getArrowCoords(ex, ey + dy, e_start);\n        link.$p = `${lineCoords},${arrowCoords}`;\n    }\n    else {\n        link.$p = \"\";\n    }\n    return link;\n}\nfunction differentX(startTask, endTask, sx, ex, height) {\n    if (startTask.type === \"milestone\" || endTask.type === \"milestone\")\n        return Math.abs(sx - ex) > height / 2;\n    return sx !== ex;\n}\nfunction getLineCoords(sx, sy, ex, ey, s_start, e_start, gapp) {\n    const shift = delta * (s_start ? -1 : 1);\n    const backshift = delta * (e_start ? -1 : 1);\n    const sx1 = sx + shift;\n    const ex1 = ex + backshift;\n    const line = [sx, sy, sx1, sy, 0, 0, 0, 0, ex1, ey, ex, ey];\n    const dx = ex1 - sx1;\n    let dy = ey - sy;\n    const same = e_start === s_start;\n    if (!same && ((ex1 <= sx + delta - 2 && e_start) || (ex1 > sx && !e_start))) {\n        dy -= gapp;\n    }\n    if ((same && e_start && sx1 > ex1) || (same && !e_start && sx1 < ex1)) {\n        line[4] = line[2] + dx;\n        line[5] = line[3];\n        line[6] = line[4];\n        line[7] = line[5] + dy;\n    }\n    else {\n        line[4] = line[2];\n        line[5] = line[3] + dy;\n        line[6] = line[4] + dx;\n        line[7] = line[5];\n    }\n    return line.join(\",\");\n}\nfunction getArrowCoords(x, y, start) {\n    if (start) {\n        return `${x - 5},${y - 3},${x - 5},${y + 3},${x},${y}`;\n    }\n    else {\n        return `${x + 5},${y + 3},${x + 5},${y - 3},${x},${y}`;\n    }\n}\nfunction newLink(box, start, end) {\n    if (start && end) {\n        const width = end.x - start.x;\n        const height = end.y - start.y;\n        const left = (width > 0 ? start.x : end.x) - box.left;\n        const top = (height > 0 ? start.y : end.y) - box.top;\n        const p = `${width > 0 ? 0 : -width},${height > 0 ? 0 : -height},${width > 0 ? width : 0},${height > 0 ? height : 0}`;\n        return { width: Math.abs(width), height: Math.abs(height), left, top, p };\n    }\n    else {\n        return null;\n    }\n}\n\nexport { addUnit, getDiff, getUnitStart, grid, newLink, resetScales, smallerCount, updateLink, updateTask, updateTaskDuration };\n//# sourceMappingURL=wgantt.es6.js.map\n","import {\n\taddUnit,\n\tgetDiff,\n\tgetUnitStart,\n\tgrid,\n\tnewLink,\n\tresetScales,\n\tsmallerCount,\n\tupdateLink,\n\tupdateTask,\n\tupdateTaskDuration,\n} from \"@xbs/webix-gantt-lib\";\n\nexport default class Helpers {\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.defaultResourceUnit = \"hour\";\n\t\tthis.defaultResourceValues = {\n\t\t\thour: 8,\n\t\t};\n\t\tthis.resourceValueRanges = {\n\t\t\thour: [0.5, 24],\n\t\t};\n\t\tthis.resourceValueSteps = {\n\t\t\thour: 0.5,\n\t\t};\n\t\tthis.unitLoadNorm = {\n\t\t\tday: 8,\n\t\t\tweek: 40,\n\t\t\tmonth: 170,\n\t\t\tquarter: 510,\n\t\t\tyear: 2040,\n\t\t};\n\t}\n\n\t/**\n\t * Get name initials\n\t * @param {string} name - resource name\n\t * @returns {string} name initials\n\t */\n\tinitials(name) {\n\t\tlet initials = name.match(/\\b\\w/g) || [];\n\t\tif (initials.length == 1)\n\t\t\treturn name.charAt(0).toUpperCase() + name.charAt(1);\n\t\treturn ((initials.shift() || \"\") + (initials.pop() || \"\")).toUpperCase();\n\t}\n\n\t/**\n\t * Get an additional css class for resource avatar\n\t * @param {string} name - a resource name\n\t * @returns {string} a css class\n\t */\n\tavatarCss(name) {\n\t\treturn (\n\t\t\t\" webix_gantt_person_avatar_\" +\n\t\t\t((name.charCodeAt(1) + (name.length % 10)) % 10)\n\t\t);\n\t}\n\n\t/**\n\t * A template for an assignment avatar\n\t * @param {object} resource - a resource object\n\t * @param {string} cssClass - an addition css class for the avatar\n\t * @param {boolean} withTooltip - specifies whether  an avatar should get tooltip\n\t * @returns {string} html string for assignment avatar\n\t */\n\tresourceAvatar(resource, cssClass, withTooltip) {\n\t\tlet css = \"webix_gantt_person_avatar\";\n\t\tif (typeof cssClass == \"string\") css += \" \" + cssClass;\n\t\tif (resource.avatar)\n\t\t\treturn `<img class=\"${css}\" src=\"${resource.avatar}\" webix_tooltip=\"${\n\t\t\t\twithTooltip ? resource.name : \"\"\n\t\t\t}\"/>`;\n\t\tconst txt = resource.name;\n\t\treturn `<div class='${css} ${\n\t\t\ttxt ? this.avatarCss(txt) : \"\"\n\t\t}' webix_tooltip=\"${withTooltip ? resource.name : \"\"}\">${\n\t\t\ttxt ? this.initials(txt) : \"\"\n\t\t}</div>`;\n\t}\n\n\t/**\n\t * Get the default value for the resource unit\n\t * @param {object} obj - a resource object\n\t * @returns {any} the default resource\n\t */\n\tgetDefaultResourceValue(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.defaultResourceValues[unit];\n\t}\n\n\t/**\n\t * Get a resource unit\n\t * @param {object} obj - a resource object\n\t * @returns {string} a resource unit\n\t */\n\tgetResourceUnit(obj) {\n\t\treturn obj.unit || this.defaultResourceUnit;\n\t}\n\t/**\n\t * Get a resource value range\n\t * @param {object} obj - a resource object\n\t * @returns {array} a resource value range\n\t */\n\tgetResourceValueRange(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.resourceValueRanges[unit] || [1, 100];\n\t}\n\t/**\n\t * Get a resource value step\n\t * @param {object} obj - a resource object\n\t * @returns {array} a resource value step\n\t */\n\tgetResourceValueStep(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.resourceValueSteps[unit] || null;\n\t}\n\t/**\n\t * Check if a date is a holiday for an assigned resource\n\t * @param {date} date - Date object\n\t * @param {object} cal - a calendar object of a resource\n\t * @returns {boolean} true if date is a holiday\n\t */\n\tisResourceHoliday(date, cal) {\n\t\tlet result = false;\n\t\tif (cal.holidays)\n\t\t\tresult = cal.holidays.find(d => d.getTime() == date.getTime());\n\t\tif (cal.weekDays)\n\t\t\tresult = result || cal.weekDays.indexOf(date.getDay()) == -1;\n\t\treturn result;\n\t}\n\n\t/* wrappers for gantt-lib functions */\n\n\taddUnit(unit, date, inc) {\n\t\treturn addUnit(unit)(date, inc);\n\t}\n\n\tgetDifference(unit, next, prev) {\n\t\treturn getDiff(unit)(next, prev, webix.Date.startOnMonday);\n\t}\n\n\tgetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date, webix.Date.startOnMonday);\n\t}\n\n\tupdateTask(task, index) {\n\t\tconst local = this.app.getService(\"local\");\n\t\treturn updateTask(task, index, local.getScales(), local.getTaskHeight());\n\t}\n\n\tsetScales(start, end, precise, width, height, scales) {\n\t\treturn resetScales(\n\t\t\tstart,\n\t\t\tend,\n\t\t\tprecise,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tscales,\n\t\t\tthis.app.config.isHoliday,\n\t\t\twebix.Date.startOnMonday\n\t\t);\n\t}\n\n\tupdateLink(link, start, end) {\n\t\tconst local = this.app.getService(\"local\");\n\t\treturn updateLink(link, start, end, local.getTaskHeight());\n\t}\n\n\tupdateTaskDuration(task, scales, mode, dir) {\n\t\treturn updateTaskDuration(task, scales, mode, dir);\n\t}\n\n\tgetSmallerUnit(unit) {\n\t\treturn smallerCount[unit][0];\n\t}\n\n\tgetSmallerCount(unit) {\n\t\treturn smallerCount[unit][1];\n\t}\n\n\tnewLink(box, start, end) {\n\t\treturn newLink(box, start, end);\n\t}\n\n\tdrawGridInner(width, height, color) {\n\t\treturn grid(width, height, color);\n\t}\n}\n","import { arrayEquals } from \"helpers/common\";\n\nexport default class Grouping {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.local = app.getService(\"local\");\n\t\tthis.helpers = app.getService(\"helpers\");\n\t\tthis.closedResources = null;\n\t}\n\n\t/* Grouping for Tasks View*/\n\n\t/***\n\t * Get tasks tree data (grouped by parent)\n\t * @param {array} data - a data array\n\t * @param {string} id - a branch id\n\t * @returns {array} a data array for webix.TreeCollection\n\t */\n\tgetTreeData(data, id) {\n\t\tconst tree = data.filter(a => a.parent == id);\n\t\ttree.forEach(a => {\n\t\t\tconst temp = this.getTreeData(data, a.id);\n\t\t\tif (temp) a.data = temp;\n\t\t});\n\n\t\treturn tree;\n\t}\n\n\t/* Grouping for Resource Diagram */\n\n\t/**\n\t * Webix TreeCollection\n\t * @typedef {Object} TreeCollection\n\t */\n\n\t/**\n\t * Collects data for resource diagram (hierarchical structure)\n\t * @returns {TreeCollection}\n\t */\n\tgetRDCollection(force) {\n\t\tif (this._rdCollection && !force) return this._rdCollection;\n\n\t\tconst tasks = this.local.tasks();\n\t\tconst assignments = this.local.assignments();\n\t\tconst resources = this.local.resources();\n\t\tif (!this._rdCollection) {\n\t\t\tthis._rdCollection = new webix.TreeCollection({});\n\t\t\twebix.extend(this._rdCollection, webix.Group);\n\n\t\t\tthis.syncRDWithData();\n\t\t} else {\n\t\t\tthis._rdCollection.clearAll();\n\t\t}\n\n\t\twebix.promise\n\t\t\t.all([tasks.waitData, assignments.waitData, resources.waitData])\n\t\t\t.then(() => {\n\t\t\t\tconst data = [];\n\t\t\t\tconst scales = this.local.getScales();\n\t\t\t\tassignments.data.each(obj => {\n\t\t\t\t\tconst res = this.getDiagramItemData(obj, scales);\n\t\t\t\t\tif (res) data.push(res);\n\t\t\t\t});\n\t\t\t\tthis._rdCollection.parse(data);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t});\n\n\t\treturn this._rdCollection;\n\t}\n\n\t/**\n\t * Synchs RD collection with main collections and scale changes\n\t */\n\tsyncRDWithData() {\n\t\tthis.app.on(\"onScalesUpdate\", (v, o) => {\n\t\t\tif (this._rdCollection && this._rdCollection.data.order.length) {\n\t\t\t\tthis.refreshTaskDiagram();\n\n\t\t\t\tif (v.minUnit !== o.minUnit) {\n\t\t\t\t\tthis.updateUnitDurations();\n\t\t\t\t\tthis.groupResourceDiagram();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst tasks = this.local.tasks();\n\t\ttasks.data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (\n\t\t\t\tmode &&\n\t\t\t\tobj &&\n\t\t\t\t(mode == \"update\" ||\n\t\t\t\t\tmode == \"delete\" ||\n\t\t\t\t\tthis.local.assignments().find(a => a.task === obj.id, true))\n\t\t\t) {\n\t\t\t\tthis.updateTaskDiagram(obj, mode);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t}\n\t\t});\n\t\tconst assignments = this.local.assignments();\n\t\tassignments.data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (id) {\n\t\t\t\tthis.refreshResourceDiagram(id, obj, mode);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateUnitDurations() {\n\t\tconst tasks = this.local.tasks();\n\t\tconst assignments = this.local.assignments();\n\t\tconst scales = this.local.getScales();\n\t\tthis._rdCollection.data.each(obj => {\n\t\t\tif (obj.task) {\n\t\t\t\tconst task = tasks.getItem(obj.task);\n\t\t\t\tconst assignment = assignments.getItem(obj.id);\n\t\t\t\tif (task && assignment) {\n\t\t\t\t\tobj.duration = this.calculateUnitDuration(task, scales);\n\t\t\t\t\tobj.value = this.calculateLoad(\n\t\t\t\t\t\t{ ...task, ...assignment },\n\t\t\t\t\t\tscales.minUnit\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param {Object} task\n\t */\n\tcalculateUnitDuration(task, scales) {\n\t\treturn scales.minUnit === \"day\"\n\t\t\t? task.duration\n\t\t\t: scales.diff(\n\t\t\t\t\ttask.end_date,\n\t\t\t\t\ttask.start_date,\n\t\t\t\t\twebix.Date.startOnMonday,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue\n\t\t\t  );\n\t}\n\n\t/**\n\t * Collects data on assignment from all related tables (tasks and resources) for resources diagram\n\t * @param {Object} obj - assignment data object\n\t * @returns {Object} all data about assignment\n\t */\n\tgetDiagramItemData(obj, scales) {\n\t\tconst task = this.local.tasks().getItem(obj.task);\n\n\t\tif (task) {\n\t\t\tif (!this.local._isTaskVisible(task, true)) {\n\t\t\t\tthis.helpers.updateTask(task, 0);\n\t\t\t}\n\n\t\t\tconst resource = this.local.resources().getItem(obj.resource);\n\t\t\tconst res = { ...task, ...resource, ...obj };\n\t\t\tres.duration = this.calculateUnitDuration(task, scales);\n\t\t\tres.value = this.calculateLoad(res, scales.minUnit);\n\n\t\t\t// diagram renders 1 workload markers per min unit\n\t\t\tres.$x = this.truncateX(res.$x, scales);\n\n\t\t\treturn res;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Calculates workload per current min scale unit\n\t * @param {Object} data - data object for resource diagram (at least must have values from tasks and resources)\n\t * @param {string} unit - the min scale unit of the current scale (\"day\", \"week\", etc)\n\t * @returns {Array} load per 1st and last units if they are not fully occupied, and a fully occupied unit load. e.g. [1,0,8]\n\t */\n\tcalculateLoad(data, unit) {\n\t\tconst num = this.getUnitLoad(data);\n\n\t\tif (unit === \"hour\") return [0, 0, num / 24];\n\n\t\tif (unit === \"day\") return [0, 0, num];\n\n\t\tconst load = [];\n\n\t\tlet start = webix.Date.copy(data.start_date);\n\t\tconst startUnitStart = this.helpers.getUnitStart(unit, start);\n\t\tlet end = webix.Date.copy(data.end_date);\n\t\tconst endUnitStart = this.helpers.getUnitStart(unit, end);\n\t\tlet startUnitEnd;\n\n\t\tif (webix.Date.datePart(start, true) > startUnitStart) {\n\t\t\tstartUnitEnd = this.helpers.addUnit(unit, startUnitStart, 1);\n\t\t\tif (end > startUnitEnd) {\n\t\t\t\t// find duration in days for the first not-fully occupied unit\n\t\t\t\tconst days = this.findUnitDuration(start, startUnitEnd, data);\n\t\t\t\tload.push(days);\n\t\t\t\tstart = startUnitEnd;\n\t\t\t} else load.push(0);\n\t\t} else load.push(0);\n\n\t\tif (\n\t\t\t!webix.Date.equal(startUnitStart, endUnitStart) &&\n\t\t\twebix.Date.datePart(end, true) >= endUnitStart\n\t\t) {\n\t\t\t// find duration in days for the last not fully-occupied unit\n\t\t\tconst days = this.findUnitDuration(endUnitStart, end, data);\n\t\t\tload.push(days);\n\t\t\tend = endUnitStart;\n\t\t} else load.push(0);\n\n\t\t// find duration in days for a fully-occupied unit\n\t\tconst plusUnit = this.helpers.addUnit(unit, start, 1);\n\t\tconst days = this.findUnitDuration(\n\t\t\tstart,\n\t\t\tnew Date(Math.min(plusUnit, end)),\n\t\t\tdata\n\t\t);\n\t\tload.push(days);\n\n\t\treturn load.map(l => l * num);\n\t}\n\n\t/**\n\t * Finds unit duration in days ( to calculate work load per init )\n\t * @param start {Date} start date\n\t * @param end {Date} end date\n\t * @param data {object} data object\n\t * @returns {number} days number\n\t */\n\tfindUnitDuration(start, end, data) {\n\t\tlet days = this.helpers.getDifference(\"day\", end, start);\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet i,\n\t\t\t\td = webix.Date.copy(start),\n\t\t\t\tn = days;\n\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\tif (this.checkHoliday(d, data)) days--;\n\t\t\t\twebix.Date.add(d, 1, \"day\");\n\t\t\t}\n\t\t}\n\t\treturn days;\n\t}\n\n\t/**\n\t * Check if date is a holiday\n\t * @param d {Date} date to check\n\t * @param data {object} data object (resource calendar check)\n\t * @returns {boolean} true if date is a holiday\n\t */\n\tcheckHoliday(d, data) {\n\t\tif (this.app.config.resourceCalendars) {\n\t\t\tconst calendarId = this.local.resources().getItem(data.resource)\n\t\t\t\t.calendar_id;\n\t\t\tif (calendarId) {\n\t\t\t\tconst calendar = this.local.calendars().getItem(calendarId);\n\t\t\t\treturn this.helpers.isResourceHoliday(d, calendar);\n\t\t\t}\n\t\t}\n\t\treturn this.app.config.isHoliday(d);\n\t}\n\n\t/**\n\t * Returns resource load per unit\n\t * @param {Object} data - data object from Resource Diagram collection\n\t * @returns {number} load per unit (by default hours, but can be anything)\n\t */\n\tgetUnitLoad(data) {\n\t\treturn data.value;\n\t}\n\n\t/**\n\t * Cuts X coordinate down to unit start if precision setting was set for the scale,\n\t * because diagram renders 1 workload marker per min unit in the middle\n\t * @param {number} x - the X coordinate of a task bar on a date scale\n\t * @param {Object} scales - the data object of current scales\n\t * @returns {number} altered X\n\t */\n\ttruncateX(x, scales) {\n\t\tif (scales.precise !== false) {\n\t\t\treturn Math.floor(x / scales.cellWidth) * scales.cellWidth;\n\t\t}\n\t\treturn x;\n\t}\n\n\t/**\n\t * Refreshes data in diagram collection if a resource was (un)assigned or load per day changed\n\t * @param {(string|number)} id - the ID of an assignment record\n\t * @param {Object} obj - data object of an assignment\n\t * @param {string} mode - operation mode (\"add\", \"update\", \"delete\")\n\t */\n\trefreshResourceDiagram(id, obj, mode) {\n\t\tconst data = this._rdCollection;\n\t\tconst scales = this.local.getScales();\n\t\tswitch (mode) {\n\t\t\tcase \"update\":\n\t\t\t\tif (data.exists(id)) {\n\t\t\t\t\tconst task = this.local.tasks().getItem(obj.task);\n\t\t\t\t\tconst resource = { ...this.local.resources().getItem(obj.resource) };\n\t\t\t\t\tdelete resource.id;\n\t\t\t\t\tconst value = this.calculateLoad({ ...task, ...obj }, scales.minUnit);\n\t\t\t\t\tdata.updateItem(id, { ...obj, ...resource, value });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"add\":\n\t\t\t\tdata.add(this.getDiagramItemData(obj, scales));\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tif (data.exists(id)) data.remove(id);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Removed all related data records in diagram collection if an assigned task was removed\n\t * @param {Object} task - the ID of a task\n\t * @param {string} mode - operation type (add, delete, update)\n\t */\n\tupdateTaskDiagram(task, mode) {\n\t\tconst data = this._rdCollection;\n\t\tconst scales = this.local.getScales();\n\n\t\tif (mode === \"delete\") {\n\t\t\tthis.pruneDiagram();\n\t\t} else if (mode === \"add\") {\n\t\t\tconst rec = this.local.assignments().find(a => a.task === task.id, true);\n\t\t\tdata.add(this.getDiagramItemData(rec, scales));\n\t\t} else if (mode === \"update\") {\n\t\t\tconst assignments = data.find(a => a.task === task.id);\n\t\t\tassignments.forEach(a => {\n\t\t\t\tconst oa = this.local.assignments().getItem(a.id);\n\t\t\t\tdata.updateItem(a.id, {\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tid: a.id,\n\t\t\t\t\tduration: this.calculateUnitDuration(task, scales),\n\t\t\t\t\t$x: this.truncateX(task.$x, scales),\n\t\t\t\t\tvalue: this.calculateLoad({ ...task, ...oa }, scales.minUnit),\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Cleans removed tasks from resource diagram\n\t * (it's not enough to remove 1 removed task because the removed task can have kids,\n\t * and they go together with their parent and there is no event about each of them)\n\t */\n\tpruneDiagram() {\n\t\tconst tasks = this.local.tasks();\n\t\tconst toRemove = [];\n\t\tthis._rdCollection.data.eachLeaf(0, d => {\n\t\t\tif (!tasks.exists(d.task)) toRemove.push(d.id);\n\t\t});\n\t\tif (toRemove.length) this._rdCollection.remove(toRemove);\n\t}\n\n\t/**\n\t * Updates $x coordinates for tasks after scale changes\n\t */\n\trefreshTaskDiagram() {\n\t\tconst scales = this.local.getScales();\n\t\tthis._rdCollection.data.each(a => {\n\t\t\tconst task = this.local.tasks().getItem(a.task);\n\t\t\tif (task) a.$x = this.truncateX(task.$x, scales);\n\t\t});\n\t}\n\n\t/**\n\t * Groups data for resource diagram\n\t */\n\tgroupResourceDiagram() {\n\t\tconst collection = this._rdCollection;\n\t\tcollection.group({\n\t\t\tby: obj => obj.name + \"-\" + obj.category,\n\t\t\tmap: {\n\t\t\t\tresource_id: [\"resource\"],\n\t\t\t\tvalue: [\"name\"],\n\t\t\t\tname: [\"name\"],\n\t\t\t\tcategory: [\"category\"],\n\t\t\t\tavatar: [\"avatar\"],\n\t\t\t\tload: [\"value\", calculateLoad],\n\t\t\t\tduration: [\"duration\", collect], // num of workload markers\n\t\t\t\tunits: [\"value\", collect], // number on a workload marker\n\t\t\t\t$x: [\"$x\", collect], // start of a task\n\t\t\t\tcount: [\"value\", \"count\"],\n\t\t\t\tstart_date: [\"start_date\", collect],\n\t\t\t},\n\t\t});\n\t\tcollection.group(\n\t\t\t{\n\t\t\t\tby: \"category\",\n\t\t\t\tmap: {\n\t\t\t\t\tvalue: [\"category\"],\n\t\t\t\t\tname: [\"category\"],\n\t\t\t\t\tduration: [\"duration\", \"sum\"],\n\t\t\t\t\tload: [\"load\", \"sum\"],\n\t\t\t\t\tcount: [\"count\", \"sum\"],\n\t\t\t\t},\n\t\t\t},\n\t\t\t0\n\t\t);\n\t}\n\n\t/* Grouping for Resource View*/\n\n\t/**\n\t * Resource-task collection (shown when \"display\" state property equals \"resources\")\n\t * @returns {object} TreeCollection|webix.TreeCollection\n\t */\n\tgetResourceTree() {\n\t\tif (this._resourcesTree) return this._resourcesTree;\n\n\t\tthis._resourcesTree = new webix.TreeCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreUpdated\": (id, obj, mode) => {\n\t\t\t\t\tid = mode == \"update\" || mode == \"paint\" ? id : null;\n\t\t\t\t\tthis.refreshResourceTasks(id);\n\t\t\t\t\tthis.local.refreshLinks();\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$sort: {\n\t\t\t\t\tby: \"start_date\",\n\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\tas: \"int\",\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis._resourcesTree.parse(\n\t\t\tthis.resourceTaskLoader().finally(() => {\n\t\t\t\tthis.syncResourceTree();\n\t\t\t})\n\t\t);\n\n\t\treturn this._resourcesTree;\n\t}\n\n\t/**\n\t * Load task data and extend each task item with the \"resources\" property -\n\t * an array of task resources or null\n\t * @returns {Promise} promise that is resolved with a data array\n\t */\n\ttasksWithResources() {\n\t\treturn webix.promise\n\t\t\t.all([this.local.tasks().waitData, this.local.assignments().waitData])\n\t\t\t.then(() => {\n\t\t\t\tlet data = [];\n\t\t\t\tthis.local.tasks().data.each(\n\t\t\t\t\tt => {\n\t\t\t\t\t\tif (t.type == \"task\" || !t.type) {\n\t\t\t\t\t\t\tlet task = Object.assign({}, t);\n\t\t\t\t\t\t\tconst result = this.local\n\t\t\t\t\t\t\t\t.assignments()\n\t\t\t\t\t\t\t\t.data.find(a => a.task == task.id);\n\t\t\t\t\t\t\ttask.resources = result.length\n\t\t\t\t\t\t\t\t? result.map(item => item.resource)\n\t\t\t\t\t\t\t\t: null;\n\t\t\t\t\t\t\tdata.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"\",\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t});\n\t}\n\n\t/**\n\t * tasks and resources loader\n\t * @returns {Promise<[]>} promise that is resolved with a data array\n\t * @private\n\t */\n\tresourceTaskLoader() {\n\t\tconst Ops = this.app.getService(\"operations\");\n\t\treturn webix.promise\n\t\t\t.all([this.tasksWithResources(), this.local.resources().waitData])\n\t\t\t.then(d => {\n\t\t\t\tlet data = this.getResourceTaskData(d[0]);\n\t\t\t\tdata.forEach(r => {\n\t\t\t\t\tOps.setProjectData(r, null, r.data);\n\t\t\t\t});\n\t\t\t\treturn data;\n\t\t\t});\n\t}\n\n\t/**\n\t * Updates Resource TreeCollection, called on tasks() TreeCollection update\n\t */\n\trefreshResourceTree() {\n\t\tif (this._resourcesTree.count()) {\n\t\t\t// get closed branches\n\t\t\tthis.closedResources = [];\n\t\t\tthis._resourcesTree.data.eachChild(\"0\", item => {\n\t\t\t\tif (!item.open) this.closedResources.push(item.resources);\n\t\t\t});\n\t\t} else this.closedResources = null;\n\t\tthis.resourceTaskLoader().then(data => {\n\t\t\t// reload data\n\t\t\tthis._resourcesTree.clearAll();\n\t\t\tthis._resourcesTree.parse(data);\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tsyncResourceTree() {\n\t\tconst tree = this._resourcesTree;\n\t\tthis.local.tasks().data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\") {\n\t\t\t\tconst inTree = tree.exists(id) && tree.getItem(id).type == \"task\";\n\t\t\t\tconst becomesTask = obj.type == \"task\";\n\n\t\t\t\tif (inTree && becomesTask) {\n\t\t\t\t\ttree.updateItem(id, {\n\t\t\t\t\t\ttext: obj.text,\n\t\t\t\t\t\tdetails: obj.details,\n\t\t\t\t\t\tstart_date: obj.start_date,\n\t\t\t\t\t\tend_date: obj.end_date,\n\t\t\t\t\t\tduration: obj.duration,\n\t\t\t\t\t\tprogress: obj.progress,\n\t\t\t\t\t});\n\t\t\t\t\tconst pId = tree.getParentId(id);\n\t\t\t\t\tlet item = tree.getItem(pId);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\titem = this.app.getService(\"operations\").setProjectData(item, tree);\n\t\t\t\t\t\ttree.updateItem(pId, item);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t} else if (inTree ^ becomesTask) {\n\t\t\t\t\tthis.refreshResourceTree();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.refreshResourceTree();\n\t\t\t}\n\t\t});\n\t\tthis.local.assignments().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tthis.refreshResourceTree();\n\t\t});\n\t}\n\n\t/**\n\t * Get data for resource Tree collection ( tasks grouped by resources )\n\t * @param {array} tasks - an tasks array where each item contains\n\t * \"resources\" property (an array of ids or null)\n\t * @returns {array} data array\n\t */\n\tgetResourceTaskData(tasks) {\n\t\tlet data = [];\n\t\tlet unassignedBranch = null;\n\t\tconst Ops = this.app.getService(\"operations\");\n\n\t\ttasks.forEach(t => {\n\t\t\tconst { resources } = t;\n\t\t\tlet item;\n\t\t\tif (!resources) item = unassignedBranch ? unassignedBranch : null;\n\t\t\telse item = data.find(item => arrayEquals(item.resources, resources));\n\t\t\tif (!item) {\n\t\t\t\titem = {\n\t\t\t\t\tid: resources ? webix.uid() : \"unassigned\",\n\t\t\t\t\ttype: \"project\",\n\t\t\t\t\ttext: \"\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\t// $group needed for faster checks\n\t\t\t\t\t$group: true,\n\t\t\t\t\t// restore open/closed state\n\t\t\t\t\topen: this.checkResourceOpen(resources),\n\t\t\t\t};\n\t\t\t\titem.resources = resources;\n\t\t\t\tif (resources)\n\t\t\t\t\titem.text = resources\n\t\t\t\t\t\t.map(id => this.local.resources().getItem(id))\n\t\t\t\t\t\t.sort(Ops.sortResources)\n\t\t\t\t\t\t.map(item => item.name)\n\t\t\t\t\t\t.join(\", \");\n\n\t\t\t\tif (resources) data.push(item);\n\t\t\t\telse {\n\t\t\t\t\titem.id = \"unassigned\";\n\t\t\t\t\tunassignedBranch = item;\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.data.push(webix.copy(t));\n\t\t});\n\t\tif (unassignedBranch) data.push(unassignedBranch);\n\t\treturn data;\n\t}\n\n\t/**\n\t * Set task(s) properties that are needed to define size and position\n\t * @param {string} updID - task id (optional)\n\t * @param {number} i - task index (optional)\n\t */\n\trefreshResourceTasks(updID, i) {\n\t\tconst tree = this._resourcesTree;\n\t\tif (!updID) {\n\t\t\ttree.data.order.forEach((id, i) => {\n\t\t\t\tthis.refreshResourceTasks(id, i);\n\t\t\t});\n\t\t} else {\n\t\t\tconst t = tree.getItem(updID);\n\t\t\ti = !webix.isUndefined(i) ? i : tree.getIndexById(updID);\n\t\t\tthis.helpers.updateTask(t, i);\n\t\t}\n\t}\n\t/**\n\t * Checks whether this resource group needs to be open\n\t * @param {array} resources - array of resources in the group or null for Unassigned\n\t * @returns {boolean} result of the check\n\t */\n\tcheckResourceOpen(resources) {\n\t\tif (!this.closedResources) return true;\n\t\tif (!resources) return this.closedResources.indexOf(null) == -1;\n\t\treturn this.closedResources.find(arr => arrayEquals(arr, resources))\n\t\t\t? false\n\t\t\t: true;\n\t}\n}\n\n/**\n * An aggregation function for data grouping that collects column values (any) into an array\n * @param {string} property - the name of the data field (column)\n * @param {Array} data - the data objects of the items from the data set\n * @returns {Array} the resulting array\n */\nfunction collect(property, data) {\n\tconst ws = [];\n\n\tfor (let i = 0; i < data.length; i++) {\n\t\tws.push(property(data[i]));\n\t}\n\n\treturn ws;\n}\n\n/**\n * @param {string} property - the name of the data field (column)\n * @param {Array} data - the data objects of the items from the data set\n * @returns {number}\n */\nfunction calculateLoad(property, data) {\n\tlet sum = 0;\n\n\tfor (let i = 0; i < data.length; i++) {\n\t\tconst units = property(data[i]);\n\t\tlet duration = parseInt(data[i].duration);\n\t\tconst last = units.length - 1;\n\t\tfor (let j = 0; j < units.length; ++j) {\n\t\t\tconst num = units[j];\n\t\t\tif (num) {\n\t\t\t\tsum += (j === last ? duration : 1) * num;\n\t\t\t\tduration--;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn sum;\n}\n","import { JetApp, plugins, EmptyRouter } from \"webix-jet\";\nimport { initJetWin } from \"@xbs/jet-helpers\";\nimport { createState, link } from \"jet-restate\";\n\nimport views from \"./export_views\";\nimport en from \"locales/en\";\n\n// services\nimport Local from \"./models/Local\";\nimport Backend from \"./models/Backend\";\nimport Operations from \"./models/Operations\";\nimport Helpers from \"./models/Helpers\";\nimport Grouping from \"models/Grouping\";\n\nexport class App extends JetApp {\n\tconstructor(config) {\n\t\t// widget state\n\t\tconst state = createState({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\tselected: null,\n\t\t\tedit: null,\n\t\t\treadonly: config.readonly || false,\n\t\t\tsort: null,\n\t\t\tdisplay:\n\t\t\t\tconfig.resources && config.display == \"resources\"\n\t\t\t\t\t? \"resources\"\n\t\t\t\t\t: \"tasks\",\n\t\t\tcriticalPath: config.criticalPath || false,\n\t\t\tresourcesDiagram: !!(config.resources && config.resourcesDiagram),\n\t\t\ttreeWidth: config.treeWidth || (config.resources ? 400 : 500),\n\t\t\tbaseline: config.baseline || false,\n\t\t});\n\n\t\tconst isHoliday =\n\t\t\tconfig.isHoliday ||\n\t\t\tfunction(date) {\n\t\t\t\tconst d = date.getDay();\n\t\t\t\treturn d === 0 || d === 6;\n\t\t\t};\n\n\t\tconst defaults = {\n\t\t\trouter: EmptyRouter,\n\t\t\tversion: VERSION,\n\t\t\tdebug: DEBUG,\n\t\t\tstart: \"/top\",\n\t\t\tcompactWidth: 650,\n\t\t\tmarkers: [{ css: \"webix_gantt_today_marker\", now: true }],\n\t\t\tparams: { state, forceCompact: config.compact },\n\t\t\tlinks: true,\n\t\t\tisHoliday,\n\t\t};\n\n\t\tsuper({ ...defaults, ...config });\n\n\t\tconst dynamic = obj =>\n\t\t\tthis.config.override ? this.config.override.get(obj) || obj : obj;\n\n\t\t//order matters\n\t\tthis.setService(\"helpers\", new (dynamic(Helpers))(this, config));\n\t\tthis.setService(\"local\", new (dynamic(Local))(this, config));\n\t\tthis.setService(\"backend\", new (dynamic(Backend))(this, config.url));\n\t\tthis.setService(\"operations\", new (dynamic(Operations))(this));\n\t\tthis.setService(\"grouping\", new (dynamic(Grouping))(this));\n\t\tinitJetWin(this);\n\n\t\tthis.use(\n\t\t\tplugins.Locale,\n\t\t\tthis.config.locale || {\n\t\t\t\tlang: \"en\",\n\t\t\t\twebix: {\n\t\t\t\t\ten: \"en-US\",\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\trequire(type, name) {\n\t\tif (type === \"jet-views\") return views[name];\n\t\telse if (type === \"jet-locales\") return locales[name];\n\n\t\treturn null;\n\t}\n\n\t// for external users\n\tgetState() {\n\t\treturn this.config.params.state;\n\t}\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"gantt\",\n\t\tapp: App,\n\t\tgetState() {\n\t\t\treturn this.$app.getState();\n\t\t},\n\t\tgetService(name) {\n\t\t\treturn this.$app.getService(name);\n\t\t},\n\t\t$init() {\n\t\t\tconst state = this.$app.getState();\n\t\t\tfor (let key in state) {\n\t\t\t\tlink(state, this.config, key);\n\t\t\t}\n\n\t\t\tthis.$app.attachEvent(\"bars:beforedrag\", (item, ctx) =>\n\t\t\t\tthis.callEvent(\"onBeforeDrag\", [item, ctx])\n\t\t\t);\n\t\t\tthis.$app.attachEvent(\"bars:beforedrop\", (item, ctx) =>\n\t\t\t\tthis.callEvent(\"onBeforeDrop\", [item, ctx])\n\t\t\t);\n\t\t},\n\t\t$exportView: function(options) {\n\t\t\tif (\n\t\t\t\toptions.export_mode === \"png\" ||\n\t\t\t\t(options.export_mode === \"pdf\" && options.display === \"image\")\n\t\t\t)\n\t\t\t\treturn this.$app.getRoot();\n\t\t\treturn this.$app.getService(\"local\").tasks();\n\t\t},\n\t\tclearAll() {\n\t\t\tthis.$app.getService(\"local\").clearAll();\n\t\t},\n\t\treload() {\n\t\t\tthis.$app.getService(\"local\").reload();\n\t\t},\n\t},\n\twebix.ui.jetapp\n);\n\n// re-export for customization\nconst services = { Local, Backend, Operations, Helpers, Grouping };\nconst locales = { en };\nexport { views, locales, services };\n","export default {\n\tEdit: \"Edit\",\n\tDone: \"Done\",\n\t\"Delete task\": \"Delete task\",\n\t\"Delete link\": \"Delete link\",\n\t\"The task will be deleted permanently, are you sure?\":\n\t\t\"The task will be deleted permanently, are you sure?\",\n\t\"The link will be deleted permanently, are you sure?\":\n\t\t\"The link will be deleted permanently, are you sure?\",\n\tPredecessors: \"Predecessors\",\n\tSuccessors: \"Successors\",\n\n\tTitle: \"Title\",\n\t\"Start date\": \"Start date\",\n\t\"End date\": \"End date\",\n\tDuration: \"Duration\",\n\tProgress: \"Progress\",\n\tNotes: \"Notes\",\n\tType: \"Type\",\n\tProject: \"Project\",\n\tMilestone: \"Milestone\",\n\t\"Add task\": \"Add task\",\n\t\"Add project\": \"Add project\",\n\t\"(no title)\": \"(no title)\",\n\t\"Save changes?\": \"Save changes?\",\n\n\t\"Related tasks\": \"Related tasks\",\n\tTask: \"Task\",\n\tLink: \"Link\",\n\t\"End to start\": \"End to start\",\n\t\"Start to start\": \"Start to start\",\n\t\"End to end\": \"End to end\",\n\t\"Start to end\": \"Start to end\",\n\n\tLasts: \"Lasts\",\n\tday: \"day\",\n\tdays: \"days\",\n\n\t\"Add assignment\": \"Add assignment\",\n\tAssignment: \"Assignment\",\n\tAssignments: \"Assignments\",\n\tAssigned: \"Assigned\",\n\t\"Delete assignment\": \"Delete assignment\",\n\t\"Are you sure to delete this assignment?\":\n\t\t\"Are you sure to delete this assignment?\",\n\t\"No resources to add\": \"No resources to add\",\n\tUnassigned: \"Unassigned\",\n\n\thour: \"h\",\n\t\"Hours per\": \"Hours per\",\n\t\"Tasks per\": \"Tasks per\",\n\tName: \"Name\",\n\tHours: \"Hours\",\n\tTasks: \"Tasks\",\n\tmonth: \"month\",\n\tweek: \"week\",\n\tquarter: \"quarter\",\n\tyear: \"year\",\n\n\t\"Split task\": \"Split task\",\n\t\"Planned dates\": \"Planned dates\",\n\t\"Planned dates will be removed, are you sure?\":\n\t\t\"Planned dates will be removed, are you sure?\",\n\t\"Add dates\": \"Add dates\",\n\t\"Remove dates\": \"Remove dates\",\n};\n","webix.protoUI({\n\tname:\"kanbanheader\",\n\t$kanban:true,\n\t$skin:function(){\n\t\tthis.defaults.height = webix.skin.$active.barHeight;\n\t\tthis._template_types.sub.height = webix.skin.$active.barHeight - 12;\n\t},\n\t$init:function(config){\n\t\tlet subtype = this._template_types[config.type];\n\t\tif (subtype)\n\t\t\twebix.extend(config, subtype);\n\t},\n\tdefaults:{\n\t\tcss:\"webix_kanban_header\",\n\t\tborderless:true,\n\t\ttemplate:function(){\n\t\t\tlet icon = this.icon||(this.link?\"webix_kanban_icon kbi-plus-circle\":\"\");\n\t\t\treturn (icon ? \"<span class='webix_icon \"+(this.link?\"webix_kanban_add_icon \":\"\")+icon+\"'></span>\" : \"\") +\n\t\t\t\t\"<span class='webix_strong' style='line-height:\"+this.height+\"px'>\"+(this.label||\"\")+\"</span>\";\n\t\t},\n\t},\n\t_template_types:{\n\t\t\"sub\":{\n\t\t\tcss:\"webix_kanban_sub_header\"\n\t\t}\n\t},\n\ton_click:{\n\t\t\"webix_kanban_add_icon\":function(){\n\t\t\tlet obj = { text:\"\" };\n\t\t\tlet kanban = this.getKanban();\n\t\t\tlet list = kanban.queryView({id:this.config.link});\n\n\t\t\tif (list && this.callEvent(\"onBeforeCardAdd\",[obj, list])){\n\t\t\t\tkanban.setListStatus(obj, list);\n\t\t\t\tkanban.add(obj);\n\t\t\t}\n\t\t}\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n}, webix.MouseEvents, webix.ui.template);","const images = { jpg:true, jpeg:true, png:true, gif:true };\n\nconst icons = { ppt:\"-powerpoint\", pptx:\"-powerpoint\", pptm:\"-powerpoint\", pps:\"-powerpoint\", ppsx:\"-powerpoint\", ppsm:\"-powerpoint\",\n\tdoc:\"-word\", docx:\"-word\", docm:\"-word\", xls:\"-excel\", xlsx:\"-excel\", xlsm:\"-excel\", xlsb:\"-excel\", pdf:\"-pdf\",\n\twav:\"-audio\", aif:\"-audio\", mp3:\"-audio\", mid:\"-audio\", mpg:\"-video\", mov:\"-video\", wmv:\"-video\", avi:\"-video\", mp4:\"-video\",\n\tzip:\"-archive\", jar:\"-archive\", rar:\"-archive\", gz:\"-archive\", jpg:\"-image\", jpeg:\"-image\", png:\"-image\", gif:\"-image\"\n};\n\nexport function isImage(key){\n\treturn images[key.toString().toLowerCase()];\n}\n\nexport function getIconName(key){\n\treturn icons[key.toString().toLowerCase()] || \"\";\n}","import {isImage} from \"./helpers/image\";\n\nexport var type = {\n\theight:\"auto\",\n\ticons:[\n\t\t{ id:\"attachments\", icon:\"webix_kanban_icon kbi-file\", show:function(obj) { return obj.attachments? obj.attachments.length: false; }, template:\"#attachments.length#\"},\n\t\t{ id:\"comments\", icon:\"webix_kanban_icon kbi-comment\" , show:function(obj,kanban) { return !!kanban.config.comments; },\n\t\t\ttemplate:function(obj) { return obj.comments?(obj.comments.length||\"\"):\"\"; }\n\t\t},\n\t\t{ id:\"editor\", icon:\"webix_kanban_icon kbi-pencil\", show:function(obj,kanban) { return (kanban.config.editor && !kanban.config.cardActions);} },\n\t\t{ id:\"menu\", icon:\"webix_kanban_icon kbi-cogs\", show:function(obj,kanban) { return !!kanban.config.cardActions;} }\n\t],\n\ttemplateTags: function(obj,common,kanban){\n\t\tlet res = [];\n\t\tif(obj.tags){\n\t\t\tlet tags = kanban._tags;\n\t\t\tfor (let i = 0; i < obj.tags.length; i++){\n\t\t\t\tlet tag = obj.tags[i];\n\t\t\t\tif (tags.exists(tag))\n\t\t\t\t\ttag = tags.getItem(tag).value;\n\t\t\t\tres.push(\"<span class='webix_kanban_tag'>\"+tag+\"</span>\");\n\t\t\t}\n\t\t}\n\t\treturn \"<div  class='webix_kanban_tags'>\" +(res.length?res.join(\"\"):\"&nbsp;\")+\"</div>\";\n\t},\n\ttemplateIcons: function(obj,common,kanban){\n\t\tvar icons = [];\n\t\tvar icon = null;\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < common.icons.length; i++){\n\t\t\ticon = common.icons[i];\n\t\t\tif(!icon.show || icon.show(obj,kanban)){\n\t\t\t\thtml = \"<span webix_icon_id='\"+(icon.id||icon.icon||icon)+\"' class='webix_kanban_footer_icon' title='\"+(icon.tooltip||\"\")+\"'>\";\n\t\t\t\thtml += \"<span class='\"+(icon.icon||icon)+\" webix_icon'></span>\";\n\n\t\t\t\tif(icon.template){\n\t\t\t\t\thtml += \"<span class='webix_kanban_icon_text'>\"+webix.template(icon.template)(obj)+\"</span>\";\n\t\t\t\t}\n\t\t\t\thtml += \"</span>\";\n\t\t\t\ticons.push(html);\n\t\t\t}\n\t\t}\n\t\treturn \"<div  class='webix_kanban_footer_icons'>\" + icons.join(\" \") + \"</div>\";\n\t},\n\ttemplateAvatar: function(obj,common,kanban){\n\t\tlet users = kanban._users;\n\t\tlet user = (obj.user_id && users.exists(obj.user_id)) ? users.getItem(obj.user_id) : {};\n\t\tif (user.image)\n\t\t\treturn \"<img class='webix_kanban_avatar' src='\"+user.image+\"' title='\"+(user.value||\"\")+\"'>\";\n\t\treturn \"<span class='webix_icon webix_kanban_icon kbi-account' title='\"+(user.value||\"\")+\"'></span>\";\n\t},\n\ttemplateBody: function(obj){\n\t\treturn obj.text;\n\t},\n\ttemplateAttachments: function(obj){\n\t\tif(obj.attachments){\n\t\t\tfor (let i in obj.attachments){\n\t\t\t\tlet v = obj.attachments[i];\n\t\t\t\tlet type = v.link.split(\".\").pop();\n\t\t\t\tif (isImage(type))\n\t\t\t\t\treturn \"<img class='webix_kanban_attachment' src='\"+v.link+\"'/>\";\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t},\n\ttemplateFooter: function(obj,common,kanban){\n\t\tvar tags = common.templateTags(obj,common,kanban);\n\t\treturn (tags?tags:\"&nbsp;\") + common.templateIcons(obj,common,kanban);\n\t},\n\ttemplateStart:webix.template(\"<div webix_l_id='#id#' class='{common.classname()} webix_kanban_list_item' style='width:{common.width}px; height:{common.height}px;'>\"),\n\ttemplate:function(obj, common){\n\t\tlet kanban = webix.$$(common.master);\n\n\t\tvar color = kanban._colors.exists(obj.color) ? kanban._colors.getItem(obj.color).color : obj.color;\n\t\tvar avatar = \"<div class='webix_kanban_user_avatar' webix_icon_id='$avatar'>\"+common.templateAvatar(obj,common,kanban)+\"</div>\";\n\t\tvar body = \"<div class='webix_kanban_body'>\"+common.templateBody(obj,common,kanban)+avatar+\"</div>\";\n\t\tvar attachments = kanban.config.attachments ? common.templateAttachments(obj,common,kanban) : \"\";\n\t\tvar footer = \"<div class='webix_kanban_footer'>\"+common.templateFooter(obj,common,kanban)+ \"</div>\";\n\t\treturn \"<div class='webix_kanban_list_content'\"+(color ? \" style='border-left-color:\"+color+\"'\" : \"\")+\">\"+attachments+body+footer+\"</div>\";\n\t}\n};\n\nwebix.KanbanView = {\n\t$kanban:true,\n\ton_context:{},\n\t$skin:function(){\n\t\t// prevent default list's item skin height\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n\t_kanban_event(s, t, i){\n\t\tthis.attachEvent(s,function(...rest){\n\t\t\trest[i] = this;\n\t\t\treturn  this.getKanban().callEvent(t, rest);\n\t\t});\n\t},\n\t_fixOrder(){\n\t\tthis.data.each((a,i) => a.$index = i+1);\n\t},\n\tmove(sid,tindex,tobj, details){\n\t\ttobj = tobj || this;\n\t\tdetails = details || {};\n\t\t// normally only one item is dragged\n\t\t// still, it possible to enable multi-selection through API\n\t\tif (webix.isArray(sid)){\n\t\t\treturn webix.DataMove.move.call(this, sid,tindex,tobj, details);\n\t\t}\n\n\t\tconst statusChange = (tobj !== this);\n\t\tconst kanban = this.getKanban();\n\t\tconst item = kanban.getItem(sid);\n\t\tconst dp = webix.dp.$$(kanban.config.id);\n\n\t\tif (statusChange){\n\t\t\tif (!kanban.callEvent(\"onBeforeStatusChange\", [sid,tobj.config.status,tobj])) return;\n\n\t\t\tkanban.setListStatus(item, tobj);\n\n\t\t\tif (dp){\n\t\t\t\tdp.ignore(() => kanban.updateItem(sid));\n\t\t\t} else kanban.updateItem(sid);\n\t\t}\n\n\t\twebix.DataMove.move.call(tobj, sid, tindex);\n\n\t\tthis._fixOrder();\n\t\tif (this !== tobj) tobj._fixOrder();\n\n\t\t// trigger data saving\n\t\tif (dp){\n\t\t\tconst update = webix.copy(item);\n\t\t\tupdate.webix_move_index = tindex;\n\t\t\tupdate.webix_move_id = tobj.data.order[tindex+1];\n\t\t\t// we need to identify the target list on server side\n\t\t\t// when we have a complex status ( object or function )\n\t\t\t// use separate property\n\t\t\tupdate.webix_move_parent = tobj.config.serverStatus || tobj.config.status;\n\t\t\tdp.save(sid, \"update\", update);\n\t\t}\n\n\t\tif (statusChange)\n\t\t\tkanban.callEvent(\"onAfterStatusChange\", [sid,tobj.config.status,tobj]);\n\n\t\treturn sid;\n\t},\n\t_setHandlers(){\n\t\tthis.attachEvent(\"onAfterSelect\", function(){\n\t\t\tthis.eachOtherList(function(list){\n\t\t\t\tlist.unselect();\n\t\t\t});\n\t\t});\n\n\t\tthis._kanban_event(\"onBeforeSelect\", \"onListBeforeSelect\", 2);\n\t\tthis._kanban_event(\"onAfterSelect\", \"onListAfterSelect\", 1);\n\t\tthis._kanban_event(\"onBeforeContextMenu\", \"onListBeforeContextMenu\", 3);\n\t\tthis._kanban_event(\"onAfterContextMenu\", \"onListAfterContextMenu\", 3);\n\t\tthis._kanban_event(\"onItemClick\", \"onListItemClick\", 3);\n\t\tthis._kanban_event(\"onItemDblClick\", \"onListItemDblClick\", 3);\n\t\tthis._kanban_event(\"onBeforeDrag\", \"onListBeforeDrag\", 2);\n\t\tthis._kanban_event(\"onBeforeDrop\", \"onListBeforeDrop\", 2);\n\t\tthis._kanban_event(\"onAfterDrop\",\"onListAfterDrop\", 2);\n\t\tthis._kanban_event(\"onBeforeDragIn\", \"onListBeforeDragIn\", 2);\n\t\tthis._kanban_event(\"onDragOut\", \"onListDragOut\", 2);\n\n\t\tthis.on_click.webix_kanban_user_avatar = this._handle_icons;\n\t\tthis.on_click.webix_kanban_footer_icon = this._handle_icons;\n\t},\n\t_handle_icons(e,id,node){\n\t\tvar icon = node.getAttribute(\"webix_icon_id\");\n\t\tvar all = this.type.icons;\n\n\t\t//per-icon click handlers\n\t\tif (all){\n\t\t\tfor (var i=0; i<all.length; i++){\n\t\t\t\tif (typeof all[i] === \"object\" && (all[i].id || all[i].icon) === icon){\n\t\t\t\t\tif (all[i].click){\n\t\t\t\t\t\tall[i].click.call(this,id,e,node,this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (icon === \"$avatar\")\n\t\t\tthis.getKanban().callEvent(\"onAvatarClick\", [id, e, node, this]);\n\t\telse\n\t\t\tthis.getKanban().callEvent(\"onListIconClick\", [icon, id, e, node, this]);\n\t},\n\t$dragCreate: function(a,e){\n\t\tconst text = webix.DragControl.$drag(a,e);\n\t\tif (!text) return false;\n\n\t\t// hide context menus\n\t\twebix.callEvent(\"onClick\", []);\n\n\t\tconst drag_container = document.createElement(\"DIV\");\n\t\tdrag_container.innerHTML = text;\n\t\tdrag_container.className = \"webix_drag_zone webix_kanban_drag_zone\";\n\t\tdocument.body.appendChild(drag_container);\n\t\treturn drag_container;\n\t},\n\t$dropHTML: function(){\n\t\treturn \"<div class='webix_kanban_drop_inner'></div>\";\n\t},\n\teachOtherList:function(code){\n\t\tvar self = this.config.id;\n\t\tvar master = this.getKanban();\n\n\t\tmaster.eachList(function(view){\n\t\t\tif (view.config.id != self)\n\t\t\t\tcode.call(webix.$$(self), view);\n\t\t});\n\t},\n\tdefaults:{\n\t\tdrag:\"move\",\n\t\tselect:true\n\t}\n};","import {type} from \"./common\";\n\nwebix.protoUI({\n\tname:\"kanbanlist\",\n\t$init(){\n\t\tthis.$view.className += \" webix_kanban_list\";\n\t\tthis.$ready.push(webix.bind(this._setHandlers,this));\n\t},\n\tdefaults:{\n\t\tscroll:\"auto\",\n\t},\n\ttype: type\n}, webix.ui.list, webix.KanbanView);","import {type} from \"./common\";\n\nvar dtype = webix.copy(type);\ndtype.width = 200;\n\nwebix.protoUI({\n\tname:\"kanbandataview\",\n\t$init(){\n\t\tthis.$view.className += \" webix_kanban_list\";\n\t\tthis.$ready.push(webix.bind(this._setHandlers,this));\n\t},\n\tdefaults:{\n\t\tprerender:true,\n\t},\n\ttype:dtype\n}, webix.ui.dataview, webix.KanbanView);","import \"./header\";\nimport \"./list\";\nimport \"./dataview\";\nimport \"./editor\";\nimport \"./userlist\";\nimport \"./menu\";\nimport \"./comments\";\n\nimport \"./locale\";\n\nfunction defaultSetter(a, sub){\n\tvar status = sub.config.status;\n\n\tif (typeof status === \"object\"){\n\t\tfor (var key in status)\n\t\t\ta[key] = status[key];\n\t} else if (typeof status === \"function\"){\n\t\tstatus.call(sub, a, true);\n\t} else {\n\t\ta.status = status;\n\t}\n}\nfunction defaultFilter(sub){\n\tvar status = sub.config.status;\n\n\tif (typeof status === \"object\")\n\t\treturn function(a){\n\t\t\tfor (var key in status){\n\t\t\t\tif (a[key] != status[key])\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\tif (typeof status === \"function\")\n\t\treturn function(a){ return status.call(sub, a); };\n\n\treturn function(a){ return a.status === status; };\n}\n\nwebix.protoUI({\n\tname:\"kanban\",\n\tdefaults:{\n\t\tdelimiter:\",\"\n\t},\n\t$skin:function(){\n\t\tthis.defaults.type = \"space\";\n\t},\n\t$init(config){\n\t\tthis.$view.className += \" webix_kanban\";\n\n\t\tthis.data.provideApi(this, true);\n\t\tthis.data.scheme({\n\t\t\t$change:(obj) =>{\n\t\t\t\tif (typeof obj.tags === \"string\")\n\t\t\t\t\tobj.tags = this._strToArr(obj.tags);\n\t\t\t}\n\t\t});\n\t\tthis._destroy_with_me = [];\n\n\t\tthis._statuses = new webix.DataCollection();\n\t\tthis._destroy_with_me.push(this._statuses);\n\n\t\tthis._tags = this._data_unification(config.tags);\n\t\tthis._users = this._data_unification(config.users);\n\t\tthis._colors = this._data_unification(config.colors);\n\t\tthis.$ready.push(function(){\n\t\t\tthis.reconstruct();\n\t\t\tthis._initEditor();\n\t\t\tthis._initUserList();\n\t\t\tthis._initMenu();\n\t\t\tthis._initComments();\n\t\t\tthis.data.attachEvent(\"onStoreUpdated\",\n\t\t\t\t(id, data, mode) => this._applyOrder(id, data, mode));\n\t\t\tthis.data.attachEvent(\"onIdChange\",\n\t\t\t\t(oldid, newid) => {\n\t\t\t\t\tthis.getOwnerList(oldid).data.changeId(oldid, newid);\n\t\t\t\t});\n\t\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\t\tfor (let i = 0; i < this._destroy_with_me.length; i++)\n\t\t\t\t\tthis._destroy_with_me[i].destructor();\n\t\t\t});\n\t\t});\n\n\t\t//override default api of datastore\n\t\tthis.serialize = this._serialize;\n\t},\n\t_strToArr(value){\n\t\tif (value){\n\t\t\treturn value.split(this.config.delimiter);\n\t\t}\n\t\treturn [];\n\t},\n\tgetTags(){\n\t\treturn this._tags;\n\t},\n\tgetUsers(){\n\t\treturn this._users;\n\t},\n\tgetColors(){\n\t\treturn this._colors;\n\t},\n\tgetStatuses(){\n\t\treturn this._statuses.serialize();\n\t},\n\tcardActions_setter(value){\n\t\tif (value === true) value = [\"edit\", \"copy\", \"remove\"];\n\t\tif (webix.isArray(value)){\n\t\t\treturn value.map((v) => {\n\t\t\t\treturn { id:v, value:webix.i18n.kanban.menu[v]||v };\n\t\t\t});\n\t\t}\n\t},\n\tshowEditor(obj){\n\t\tlet editor = this.getEditor();\n\t\tif (this.callEvent(\"onBeforeEditorShow\", [editor, obj]) && editor){\n\t\t\teditor.setValues(obj);\n\t\t\teditor.show();\n\t\t\tthis.callEvent(\"onAfterEditorShow\", [editor, obj]);\n\t\t}\n\t},\n\tcopy(id){\n\t\tif (this.callEvent(\"onBeforeCopy\", [id])){\n\t\t\tlet item = webix.copy(this.getItem(id));\n\t\t\tdelete item.id;\n\t\t\titem.text = webix.i18n.kanban.copy + \" \" + (item.text || \"\");\n\t\t\tlet sid = this.add(item);\n\t\t\tlet list = this.getOwnerList(sid);\n\t\t\tlist.move(sid, list.getIndexById(id)+1, list);\n\n\t\t\tthis.callEvent(\"onAfterCopy\", [id]);\n\t\t}\n\t},\n\t_removeCard(id){\n\t\tvar promise = webix.promise.defer();\n\n\t\tif (webix.i18n.kanban.confirm){\n\t\t\twebix.confirm({\n\t\t\t\ttext:webix.i18n.kanban.confirm,\n\t\t\t\tcallback:(result) => {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tthis.remove(id);\n\t\t\t\t\t\tpromise.resolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.remove(id);\n\t\t\tpromise.resolve();\n\t\t}\n\n\t\treturn promise;\n\t},\n\t_data_unification(value){\n\t\tif (value && value.getItem)\n\t\t\treturn value;\n\t\telse {\n\t\t\tlet data = new webix.DataCollection();\n\t\t\tthis._destroy_with_me.push(data);\n\t\t\tif(value && typeof value === \"string\")\n\t\t\t\tdata.load(value);\n\t\t\telse\n\t\t\t\tdata.parse(value||[]);\n\t\t\treturn data;\n\t\t}\n\t},\n\tgetEditor(){\n\t\treturn webix.$$(this._editor);\n\t},\n\tgetUserList(){\n\t\treturn webix.$$(this._userList);\n\t},\n\tgetMenu(){\n\t\treturn webix.$$(this._menu);\n\t},\n\tgetComments(){\n\t\treturn webix.$$(this._comments);\n\t},\n\t_initEditor(){\n\t\tif (this.config.editor){\n\t\t\tlet editor = webix.ui( {view:\"kanbaneditor\", master:this.config.id} );\n\n\t\t\tthis._editor = editor.config.id;\n\t\t\tthis._destroy_with_me.push(editor);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id) => {\n\t\t\t\tif (icon === \"editor\") this.showEditor(webix.copy( this.getItem(id) ));\n\t\t\t});\n\t\t\tthis.attachEvent(\"onListItemDblClick\", (id) => this.showEditor(webix.copy( this.getItem(id) )));\n\t\t}\n\t},\n\t_initUserList(){\n\t\tif (this.config.userList){\n\t\t\tlet userlist = typeof this.config.userList === \"object\"?this.config.userList:{};\n\t\t\twebix.extend(userlist, {view:\"kanbanuserlist\", masterId:this.config.id, data:this._users}, true);\n\t\t\tuserlist = webix.ui(userlist);\n\n\t\t\tthis._userList = userlist.config.id;\n\t\t\tthis._destroy_with_me.push(userlist);\n\t\t\t\n\t\t\tthis.attachEvent(\"onAvatarClick\", (id, e, node) => {\n\t\t\t\tlet userList = this.getUserList();\n\t\t\t\tuserList.setContext({id:id, user_id:this.getItem(id).user_id});\n\t\t\t\tuserList.show(node);\n\t\t\t});\n\t\t}\n\t},\n\t_initMenu(){\n\t\tif (this.config.cardActions){\n\t\t\tlet menu = webix.ui( {view:\"kanbanmenu\", data:this.config.cardActions, masterId:this.config.id} );\n\n\t\t\tthis._menu = menu.config.id;\n\t\t\tthis._destroy_with_me.push(menu);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id, e, node) => {\n\t\t\t\tif (icon === \"menu\"){\n\t\t\t\t\tlet menu = this.getMenu();\n\t\t\t\t\tmenu.setContext( {id:id} );\n\t\t\t\t\tmenu.show(node);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t_initComments(){\n\t\tif (this.config.comments){\n\t\t\tlet body = typeof this.config.comments === \"object\"?this.config.comments:{};\n\t\t\tbody = webix.extend({width:400, height:400}, body, true);\n\t\t\twebix.extend(body, { view:\"comments\", users:this._users }, true);\n\t\t\tlet comments = webix.ui( {view:\"kanbanchat\", body:body, masterId:this.config.id} );\n\n\t\t\tthis._comments = comments.config.id;\n\t\t\tthis._destroy_with_me.push(comments);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id, e, node) => {\n\t\t\t\tif (icon === \"comments\" && this.callEvent(\"onBeforeCommentsShow\", [id, e, node])){\n\t\t\t\t\tlet chat = this.getComments();\n\t\t\t\t\tlet pos = webix.html.offset(node);\n\t\t\t\t\tpos.y += pos.height;\n\t\t\t\t\t\n\t\t\t\t\tchat.hide();\n\t\t\t\t\tlet comments = chat.getBody();\n\t\t\t\t\tlet data = this.getItem(id).comments || [];\n\n\t\t\t\t\tcomments.parse( webix.copy(data) );\n\t\t\t\t\tchat.setContext( {id:id} );\n\t\t\t\t\tchat.show(pos);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t_serialize(){\n\t\tvar d = [];\n\t\tthis.eachList(function(l){ d = d.concat(l.serialize()); });\n\t\treturn d;\n\t},\n\t_applyOrder(id, data, mode){\n\t\tif (!id) return this._syncData();\n\n\t\tswitch(mode){\n\t\t\tcase \"add\":\n\t\t\t\tif (this._assignList(data) >= 0){\n\t\t\t\t\tthis.getOwnerList(id).add(data);\n\t\t\t\t\tdata.$index = this._sublists[data.$list].count();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\": {\n\t\t\t\tconst subList = this._sublists[data.$list];\n\t\t\t\tif (subList && subList.exists(id))\n\t\t\t\t\tsubList.remove(id);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"paint\":\n\t\t\tcase \"update\": {\n\t\t\t\tif (this.getIndexById(id) === -1) break;\n\n\t\t\t\tconst prevList = data.$list;\n\t\t\t\tconst list = this._assignList(data);\n\n\t\t\t\tif (prevList === list){\n\t\t\t\t\tif (list >= 0)\n\t\t\t\t\t\tthis.getOwnerList(id).updateItem(id, data);\n\t\t\t\t} else {\n\t\t\t\t\tif (this._sublists[prevList])\n\t\t\t\t\t\tthis._sublists[prevList].remove(id);\n\t\t\t\t\tif (list >= 0)\n\t\t\t\t\t\tthis.getOwnerList(id).add(data);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tsetListStatus(obj, list){\n\t\tfor (var i=0; i<this._sublists.length; i++){\n\t\t\tif (this._sublists[i] === list){\n\t\t\t\tdefaultSetter(obj, list);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\treconstruct(){\n\t\tthis._prepareLists();\n\t\tthis._syncData();\n\t},\n\t_prepareLists(){\n\t\tthis._sublists = [];\n\t\tthis._subfilters = [];\n\t\tlet statuses = [];\n\t\tlet views = this.queryView(a => a.$kanban, \"all\");\n\n\t\tfor (let i = 0; i < views.length; i++) {\n\t\t\tlet sub = views[i];\n\t\t\tif ( sub.config.view !== \"kanbanheader\")\n\t\t\t\tthis._sublists.push(sub);\n\t\t\telse sub.config.master = this.config.id;\n\t\t}\n\n\t\tfor (let i = 0; i < this._sublists.length; i++) {\n\t\t\tlet sub = this._sublists[i];\n\t\t\tthis._subfilters[i] = defaultFilter(sub);\n\n\t\t\tif (this.config.icons){\n\t\t\t\tsub.type.icons = sub.type.icons || this.config.icons;\n\t\t\t}\n\n\t\t\tlet value = sub.config.name || (typeof sub.config.status === \"string\" && sub.config.status ?\n\t\t\t\tsub.config.status[0].toUpperCase() + sub.config.status.slice(1) : sub.config.id);\n\t\t\tstatuses.push( {id:i.toString(), value:value} );\n\n\t\t\tsub.config.master = this.config.id;\n\t\t\tsub.type.master = this.config.id;\n\t\t}\n\n\t\tthis._statuses.clearAll();\n\t\tthis._statuses.parse(statuses);\n\t},\n\t_syncData(){\n\t\tconst sets = [];\n\t\tfor (let i=0; i<this._sublists.length; i++) sets[i] = [];\n\n\t\tthis.data.each(function(item){\n\t\t\tlet j = this._assignList(item);\n\t\t\tif (j >= 0)\n\t\t\t\tsets[j].push(item);\n\t\t}, this);\n\n\t\tfor (let i=0; i<this._sublists.length; i++){\n\t\t\tconst data = sets[i];\n\n\t\t\tif (data.length > 1 && data[0].$index)\n\t\t\t\tdata.sort( (a,b) => a.$index > b.$index ? 1 : -1 );\n\n\t\t\tthis._sublists[i].clearAll();\n\t\t\tthis._sublists[i].data.importData(data);\n\t\t\tthis._sublists[i]._fixOrder();\n\t\t}\n\t},\n\t_assignList(data){\n\t\tfor (var i = 0; i < this._sublists.length; i++) {\n\t\t\tif (this._subfilters[i](data)){\n\t\t\t\treturn data.$list = i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\tgetSelectedId(){\n\t\tvar selected = null;\n\t\tthis.eachList(function(list){ selected = list.getSelectedId() || selected; });\n\t\treturn selected;\n\t},\n\tselect(id){\n\t\tthis.getOwnerList(id).select(id);\n\t},\n\tgetOwnerList(id){\n\t\tvar item = this.getItem(id);\n\t\treturn item ? this._sublists[item.$list] : null;\n\t},\n\teachList(code){\n\t\tfor (var i=0; i<this._sublists.length; i++){\n\t\t\tcode.call(this, this._sublists[i], this._sublists[i].config.status);\n\t\t}\n\t}\n}, webix.DataLoader, webix.EventSystem, webix.ui.headerlayout );","import {isImage, getIconName} from \"./helpers/image\";\n\nwebix.protoUI({\n\tname:\"kanbanuploader\",\n\t$init(){\n\t\tthis.files.data.scheme({\n\t\t\t$init:(obj) =>{\n\t\t\t\tif (typeof obj.link === \"string\" && obj.link){\n\t\t\t\t\tobj.name = obj.name || obj.link.split(\"/\").pop();\n\t\t\t\t\tobj.type = obj.type || obj.name.split(\".\").pop();\n\t\t\t\t\tobj.status = obj.status || \"server\";\n\t\t\t\t}\n\t\t\t\tobj.sizetext = obj.sizetext || this._format_size(obj.size);\n\t\t\t}\n\t\t});\n\n\t\tthis.files.data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tlet view = webix.$$(this.config.link);\n\t\t\tlet html = \"<span class='webix_strong'>\" + (webix.i18n.kanban.dnd||\"\") + \"</span>\";\n\t\t\tif (!this.files.data.count())\n\t\t\t\tview.showOverlay(html);\n\t\t\telse view.hideOverlay();\n\t\t});\n\t},\n\tdefaults:{\n\t\ticon:\"webix_kanban_icon kbi-upload\",\n\t},\n\tgetValue(){\n\t\tlet data = [];\n\t\tthis.files.data.each(function(obj){\n\t\t\tif (obj.status === \"server\")\n\t\t\t\tdata.push( {id:obj.id, link:obj.link, size:obj.size} );\n\t\t});\n\t\treturn data;\n\t},\n\t_format_size(size){\n\t\tlet index = 0;\n\t\twhile (size > 1024){\n\t\t\tindex++;\n\t\t\tsize = size/1024;\n\t\t}\n\t\treturn Math.round(size*100)/100 + \" \" + webix.i18n.fileSize[index];\n\t}\n}, webix.ui.uploader);\n\nwebix.type(webix.ui.dataview, {\n\tname:\"uploader\",\n\theight:91,\n\twidth:161,\n\ttemplate:(obj, common) => {\n\t\treturn `<a${(obj.status === \"server\") ? ` href=\"${obj.link}\" download=\"${obj.name}\"` : \"\"}></a>\n\t\t\t\t${common.body(obj)}\n\t\t\t\t${common.title(obj,common)}\n\t\t\t\t${common.removeIcon(obj)}`;\n\t},\n\tbody:function(obj){\n\t\tif (obj.status === \"server\" && isImage(obj.type))\n\t\t\treturn `<div class=\"webix_kanban_uploader_body\"><img src=\"${obj.link}\"></div>`;\n\n\t\treturn `<div class='webix_kanban_uploader_body'>\n\t\t\t\t\t<span class='webix_icon webix_kanban_icon kbi-file${getIconName(obj.type)}'></span>\n\t\t\t\t</div>`;\n\t},\n\ttitle:function(obj,common){\n\t\treturn `<div class=\"webix_kanban_uploader_title\" title=\"${obj.name}\">\n\t\t\t\t\t${common.progress(obj)}\n\t\t\t\t\t<div class=\"webix_kanban_uploader_label\">${obj.name}</div>\n\t\t\t\t</div>`;\n\t},\n\tprogress:function(obj){\n\t\tswitch(obj.status){\n\t\t\tcase \"client\": return \"<span class='webix_kanban_uploader_progress'>\"+obj.sizetext+\"</span>\";\n\t\t\tcase \"transfer\": return \"<span class='webix_kanban_uploader_progress'>\"+obj.percent+\"%</span>\";\n\t\t\tcase \"server\": return \"<span class='webix_kanban_uploader_progress_server'>\"+obj.sizetext+\"</span>\";\n\t\t\tdefault: return \"<span class='webix_kanban_uploader_progress_error'>ERROR</span>\";\n\t\t}\n\t},\n\tremoveIcon:function(){\n\t\treturn \"<div class='webix_kanban_remove_upload'><span class='webix_icon wxi-close'></span></div>\";\n\t},\n\ton_click:{\n\t\t\"webix_kanban_remove_upload\":function(ev, id){\n\t\t\twebix.$$(this.config.uploader).files.remove(id);\n\t\t\treturn webix.html.preventEvent(ev);\n\t\t}\n\t}\n});","import en from \"./locales/en\";\nwebix.i18n.kanban = en;","import \"./uploader\";\n\nimport \"./locale\";\n\nwebix.protoUI({\n\tname:\"kanbaneditor\",\n\tdefaults:{\n\t\twidth:534,\n\t\tposition:\"center\",\n\t\tcss:\"webix_kanban_editor\",\n\t\tmodal:true,\n\t\tmove:true\n\t},\n\t$init(config){\n\t\tlet kanban = webix.$$(config.master);\n\n\t\tconfig.head = {\n\t\t\tview:\"toolbar\", paddingX:17, paddingY:8,\n\t\t\telements:[\n\t\t\t\t{ view:\"label\", label:webix.i18n.kanban.editor.add, localId:\"$kanban_header\"},\n\t\t\t\t{ view:\"icon\", icon:\"wxi-close\", click:() => this._close()}\n\t\t\t]\n\t\t};\n\n\t\tlet c = kanban.config.editor;\n\t\tlet form = { view:\"form\", borderless:true, padding:0, elementsConfig:{ labelPosition:\"top\" } };\n\t\tlet elements = [\n\t\t\t{ view:\"textarea\", label:webix.i18n.kanban.editor.text, name:\"text\", height:90},\n\t\t\t{ view:\"multicombo\", label:webix.i18n.kanban.editor.tags, name:\"tags\", options:kanban._tags, $hide:true},\n\t\t\t{ margin:8,\n\t\t\t\tcols:[\n\t\t\t\t\t{ view:\"combo\", label:webix.i18n.kanban.editor.assign, name:\"user_id\", $hide:true, options:{\n\t\t\t\t\t\tbody:{ data:kanban._users, yCount:5 }\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"richselect\", label:webix.i18n.kanban.editor.color,  name:\"color\", $hide:true, options:{\n\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\tyCount:5, data:kanban._colors, css:\"webix_kanban_colorpicker\",\n\t\t\t\t\t\t\ttemplate:\"<span class='webix_kanban_color_item' style='background-color: #color#'></span>#value#\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"richselect\", label:webix.i18n.kanban.editor.status, name:\"$list\", options:{\n\t\t\t\t\t\tbody:{ data:kanban._statuses, yCount:5 }\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\t\tif (webix.isArray(c))\n\t\t\tform.elements = c;\n\t\telse if (typeof c === \"object\"){\n\t\t\tform = webix.extend(form, c, true);\n\t\t\tform.view = \"form\";\n\t\t\tform.elements = form.elements || form.rows || (form.cols ? [{cols:form.cols}] : elements);\n\t\t\tdelete form.rows; delete form.cols;\n\t\t} else form.elements = elements;\n\n\t\tif (kanban.config.attachments)\n\t\t\tform.elements.push({ margin:0, rows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{ view:\"label\", label:webix.i18n.kanban.editor.attachments },\n\t\t\t\t\t\t{ view:\"kanbanuploader\", label:webix.i18n.kanban.editor.upload, upload:kanban.config.attachments,\n\t\t\t\t\t\t\tname:\"attachments\", autowidth:true, css:\"webix_transparent webix_kanban_uploader\", type:\"icon\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{ view:\"dataview\", localId:\"$kanban_dataview_uploader\", yCount:1, borderless:true,\n\t\t\t\t\ttype:\"uploader\", css:\"webix_kanban_dataview_uploader\",\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonItemDblClick:(id, e, node) => {\n\t\t\t\t\t\t\tlet link = node.getElementsByTagName(\"a\")[0];\n\t\t\t\t\t\t\tlink.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]});\n\n\t\tconfig.body = { paddingX:17, paddingY:0, margin:16,\n\t\t\trows:[\n\t\t\t\tform,\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{ view:\"button\", label:webix.i18n.kanban.remove, type:\"danger\", autowidth:true,\n\t\t\t\t\t\t\thidden:true, localId:\"$kanban_remove\",\n\t\t\t\t\t\t\tclick:() => {\n\t\t\t\t\t\t\t\tlet values = this.getValues({hidden:false});\n\t\t\t\t\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\t\t\t\t\tif (!kanban.callEvent(\"onBeforeEditorAction\", [\"remove\", this, values])) return;\n\n\t\t\t\t\t\t\t\tkanban._removeCard(values.id).then(() => this._close());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:webix.i18n.kanban.save, type:\"form\", autowidth:true,\n\t\t\t\t\t\t\tclick:() => {\n\t\t\t\t\t\t\t\tlet values = this.getValues({hidden:false});\n\t\t\t\t\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\t\t\t\t\tif (!kanban.callEvent(\"onBeforeEditorAction\", [\"save\", this, values])) return;\n\n\t\t\t\t\t\t\t\tthis._fixStatus(values, kanban);\n\t\t\t\t\t\t\t\tif ( kanban.exists(values.id) ){\n\t\t\t\t\t\t\t\t\tvalues.$list = kanban.getItem(values.id).$list;\n\t\t\t\t\t\t\t\t\tkanban.updateItem(values.id, values);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse kanban.add(values);\n\t\t\t\t\t\t\t\tthis._close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{ height:1 }\n\t\t\t]\n\n\t\t};\n\n\t\tthis.$ready.push(this._afterInit);\n\t},\n\t_afterInit:function(){\n\t\tthis._form = this.queryView({view:\"form\"});\n\t\tthis._removeBtn = this.queryView({localId:\"$kanban_remove\"});\n\t\tthis._header = this.queryView({localId:\"$kanban_header\"});\n\n\t\tlet uploader = this.queryView({view:\"kanbanuploader\"});\n\t\tif (uploader){\n\t\t\tlet dataview = this.queryView({localId:\"$kanban_dataview_uploader\"});\n\t\t\tuploader.define( \"link\", dataview.config.id );\n\t\t\tuploader.addDropZone(dataview.$view);\n\t\t\twebix.extend(dataview, webix.OverlayBox);\n\t\t}\n\n\t\tlet views = this.queryView({$hide:true}, \"all\");\n\t\tif (views.length)\n\t\t\tthis.attachEvent(\"onShow\", () => {\n\t\t\t\tfor (let i=0; i<views.length; i++)\n\t\t\t\t\tif (views[i].getList().count())\n\t\t\t\t\t\tviews[i].show();\n\t\t\t\t\telse views[i].hide();\n\t\t\t});\n\t},\n\t_fixStatus(values, kanban){\n\t\tvalues.$list = Number(values.$list) || 0;\n\t\tif (kanban._sublists[values.$list])\n\t\t\tkanban.setListStatus(values, kanban._sublists[values.$list]);\n\t},\n\tgetForm(){\n\t\treturn this._form;\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n\tsetValues(values){\n\t\tif (typeof values !== \"object\" || !values)\n\t\t\tvalues = {};\n\t\tlet kanban = this.getKanban();\n\t\tlet listIndex = kanban._assignList(values);\n\t\tvalues.$list = values.$list || (listIndex !== -1 ? listIndex : 0);\n\n\t\tthis._prepareEditor(kanban, values.id);\n\t\tthis._form.setValues(values);\n\t},\n\tgetValues(details){\n\t\treturn this._form.getValues(details);\n\t},\n\t_prepareEditor(kanban, id){\n\t\tif (id && kanban.exists(id)){\n\t\t\tthis._removeBtn.show();\n\t\t\tthis._header.define(\"label\", webix.i18n.kanban.editor.edit);\n\t\t} else {\n\t\t\tthis._removeBtn.hide();\n\t\t\tthis._header.define(\"label\", webix.i18n.kanban.editor.add);\n\t\t}\n\t\tthis._header.refresh();\n\t},\n\t_close(){\n\t\tthis.hide();\n\t\tthis._form.clear();\n\t\tthis._prepareEditor();\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname:\"kanbanuserlist\",\n\tdefaults:{\n\t\twidth:300,\n\t\tlayout:\"y\",\n\t\tscroll:true,\n\t\tyCount:4,\n\t\tautoheight:false,\n\t\tselect:true,\n\t\ttemplate:function(obj){\n\t\t\tif (obj.image)\n\t\t\t\treturn \"<img class='webix_kanban_list_avatar' src='\"+obj.image+\"'>\"+obj.value;\n\n\t\t\treturn \"<span class='webix_icon webix_kanban_icon kbi-account webix_kanban_list_avatar'></span>\"+obj.value;\n\t\t}\n\t},\n\t$init(){\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onShow\", () => {\n\t\t\t\tlet user_id = this.getContext().user_id;\n\n\t\t\t\tif ( user_id && this.exists(user_id) ){\n\t\t\t\t\tthis.select(user_id);\n\t\t\t\t\tthis.showItem(user_id);\n\t\t\t\t} else this.unselectAll();\n\t\t\t});\n\n\t\t\tthis.attachEvent(\"onMenuItemClick\", (id) => {\n\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\tlet selectedTask = this.getContext().id;\n\n\t\t\t\tkanban.updateItem(selectedTask, {user_id:id});\n\t\t\t});\n\n\t\t\tthis.type.master = this.config.masterId;\n\t\t});\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.contextmenu);\n","webix.protoUI({\n\tname:\"kanbanmenu\",\n\t$init(){\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onItemClick\", function(id){\n\t\t\t\tlet cid = this.getContext().id;\n\t\t\t\tlet kanban = this.getKanban();\n\n\t\t\t\tif ( kanban.callEvent(\"onBeforeCardAction\", [id, cid]) ){\n\t\t\t\t\tswitch(id){\n\t\t\t\t\t\tcase \"edit\":\n\t\t\t\t\t\t\tkanban.showEditor(webix.copy( kanban.getItem(cid) ));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"copy\":\n\t\t\t\t\t\t\tkanban.copy(cid);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"remove\":\n\t\t\t\t\t\t\tkanban._removeCard(cid);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.contextmenu);","webix.protoUI({\n\tname:\"kanbanchat\",\n\t$init(config){\n\t\tconfig.padding = 0;\n\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onHide\", this._hide_chat);\n\n\t\t\tlet list = this.queryView({view:\"list\"});\n\t\t\tlist.data.attachEvent(\"onStoreUpdated\", (id, obj, mode)=>{\n\t\t\t\tif (mode && mode !== \"paint\")\n\t\t\t\t\tthis._save();\n\t\t\t});\n\t\t});\n\t},\n\t_save(){\n\t\tlet context = this.getContext();\n\t\tlet comments = this.getBody();\n\t\tlet kanban = this.getKanban();\n\n\t\tif (context && kanban.exists(context.id))\n\t\t\tkanban.updateItem(context.id, {comments:comments.serialize()});\n\t},\n\t_hide_chat(){\n\t\tlet comments = this.getBody();\n\t\tcomments.queryView({view:\"form\"}).clear();\n\t\tcomments.queryView({view:\"list\"}).clearAll();\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.context);\n","webix.protoUI(\n\t{\n\t\tname: \"pivot-portlet\",\n\t\t$reorderOnly: true,\n\t\t$drag: function(object) {\n\t\t\twebix.html.addCss(this.$view, \"portlet_in_drag\");\n\t\t\tconst ctx = webix.DragControl.getContext();\n\t\t\tctx.source = ctx.from = object;\n\n\t\t\t// hide suggests\n\t\t\twebix.callEvent(\"onClick\", []);\n\n\t\t\tconst local = this.$scope.app.getService(\"local\");\n\t\t\tconst values = this.getChildViews()[0].getValues();\n\n\t\t\tlet text = \"\";\n\n\t\t\tif (values.operation == \"complex\") text = local.fixMath(values.math);\n\t\t\telse {\n\t\t\t\ttext = values.name ? local.getField(values.name).value : \"\";\n\n\t\t\t\tif (values.name2)\n\t\t\t\t\ttext += (text ? \", \" : \"\") + local.getField(values.name2).value;\n\t\t\t\telse if (!text) {\n\t\t\t\t\tconst _ = this.$scope.app.getService(\"locale\")._;\n\t\t\t\t\ttext = _(\"Field not defined\");\n\t\t\t\t} else if (values.operation) text += ` (${values.operation})`;\n\t\t\t}\n\n\t\t\tconst askin = webix.skin.$active;\n\t\t\tconst style = `width:${this.$width - askin.inputHeight}px;height:${\n\t\t\t\tthis.$height\n\t\t\t}px;`;\n\t\t\treturn `<div class=\"webix_pivot_portlet_drag\" style=\"${style}\">\n\t\t\t\t<span class=\"webix_icon ${this.config.icon}\"></span>${text}\n\t\t\t</div>`;\n\t\t},\n\t},\n\twebix.ui.portlet\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"helpers/portlet\";\n\nexport default class Property extends JetView {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name);\n\n\t\tif (!config) config = {};\n\n\t\tthis.plusLabel = config.plusLabel;\n\t\tthis.field = config.field;\n\t}\n\tconfig() {\n\t\tconst askin = webix.skin.$active;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpaddingY: 8,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"forms\",\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttemplate: `<div class=\"webix_pivot_handle_add_value\">\n\t\t\t\t\t\t<span class=\"webix_icon wxi-plus-circle\"></span><span>${this.plusLabel}</span>\n\t\t\t\t\t</div>`,\n\t\t\t\t\tcss: \"webix_pivot_add_value\",\n\t\t\t\t\theight: askin.inputHeight - 2 * askin.inputPadding,\n\t\t\t\t\tlocalId: \"addValue\",\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_pivot_handle_add_value: () => {\n\t\t\t\t\t\t\tconst forms = this.$$(\"forms\").getChildViews();\n\n\t\t\t\t\t\t\tthis.Add(null, forms.length);\n\t\t\t\t\t\t\tconst input = forms[forms.length - 1].queryView({ name: \"name\" });\n\n\t\t\t\t\t\t\tif (input) {\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\twebix.html.triggerEvent(\n\t\t\t\t\t\t\t\t\tinput.getInputNode(),\n\t\t\t\t\t\t\t\t\t\"MouseEvent\",\n\t\t\t\t\t\t\t\t\t\"click\"\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.field != \"values\" &&\n\t\t\t\t\t\t\t\tforms.length == this.app.getState().fields.length\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tthis.$$(\"addValue\").hide();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\tinit() {\n\t\tthis.on(webix, \"onAfterPortletMove\", source => {\n\t\t\tif (source == this.$$(\"forms\"))\n\t\t\t\tthis.app.callEvent(\"property:change\", [this.field, this.GetValue()]);\n\t\t});\n\t\tthis.on(webix, \"onPortletDrag\", function(active, target) {\n\t\t\tif (active.$reorderOnly)\n\t\t\t\treturn active.getParentView() === target.getParentView();\n\t\t});\n\t}\n\tListTemplate(obj) {\n\t\tconst input = this._activeInput;\n\n\t\t//wavg - complex operation, no need to correct inputs\n\t\tconst wavg =\n\t\t\tthis.field == \"values\" &&\n\t\t\tinput &&\n\t\t\t!input.$destructed && // CorrectInputs calls SetValue, which recreates inputs\n\t\t\tinput.getFormView().elements.operation.getValue() == \"wavg\";\n\n\t\tconst corrections = this.getParentView().GetCorrections()[this.field];\n\t\tconst value = obj.value;\n\n\t\tif (!wavg && corrections) {\n\t\t\tconst includes = this.CheckCorrections(corrections, obj.id);\n\n\t\t\tlet css = \"webix_pivot_list_marker\";\n\t\t\tif (includes) css += \" webix_pivot_list_marker_fill\";\n\n\t\t\treturn `<div class=\"${css}\"> ${value}</div>`;\n\t\t} else return value;\n\t}\n\tCheckCorrections(corrections, id) {\n\t\tif (this._activeInput && id == this._activeInput.getValue()) return true;\n\n\t\tconst structure = this.app.getStructure();\n\n\t\tfor (let i = 0; i < corrections.length; i++) {\n\t\t\tconst name = corrections[i];\n\t\t\tconst val = structure[name];\n\n\t\t\tif (val) {\n\t\t\t\tif (typeof val == \"string\") {\n\t\t\t\t\tif (val == id) return true;\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j = 0; j < val.length; j++) {\n\t\t\t\t\t\tlet value = val[j];\n\t\t\t\t\t\tif (value.name) value = value.name;\n\n\t\t\t\t\t\tif (value == id) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tGetValue() {\n\t\tconst forms = this.$$(\"forms\").getChildViews();\n\t\tlet arr = [];\n\n\t\tforms.forEach(form => {\n\t\t\tconst val = form.getChildViews()[0].getValues().name;\n\n\t\t\tif (val) arr.push(val);\n\t\t});\n\n\t\treturn arr;\n\t}\n\tSetValue(val) {\n\t\tconst layout = this.$$(\"forms\");\n\t\tconst forms = layout.getChildViews();\n\n\t\tfor (let i = forms.length - 1; i >= 0; i--) layout.removeView(forms[i]);\n\t\tfor (let i = 0; i < val.length; i++) {\n\t\t\tif (!val[i].external) this.Add(val[i], i);\n\t\t}\n\t}\n\tAdd(val, i) {\n\t\tthis.$$(\"forms\").addView({\n\t\t\tview: \"pivot-portlet\",\n\t\t\tmode: \"replace\",\n\t\t\tborderless: true,\n\t\t\tbody: {\n\t\t\t\tview: \"form\",\n\t\t\t\tpaddingY: 0,\n\t\t\t\tpaddingX: 2,\n\t\t\t\telements: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\tcols: this.ItemConfig(val, i),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonChange: (val, old, config) => {\n\t\t\t\t\t\tif (config == \"user\")\n\t\t\t\t\t\t\tthis.app.callEvent(\"property:change\", [\n\t\t\t\t\t\t\t\tthis.field,\n\t\t\t\t\t\t\t\tthis.GetValue(),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\tItemConfig(val) {\n\t\treturn [\n\t\t\t{ width: webix.skin.$active.inputHeight }, //for portlet icon\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"name\",\n\t\t\t\tvalue: this.PrepareValue(val),\n\t\t\t\thidden: val && val.operation == \"complex\",\n\t\t\t\toptions: {\n\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\tdata: this.app.getState().fields,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tconst input = webix.$$(this.config.master);\n\t\t\t\t\t\t\tconst master = input.$scope;\n\n\t\t\t\t\t\t\tconst data = master.GetValue();\n\t\t\t\t\t\t\tmaster._activeInput = input;\n\n\t\t\t\t\t\t\tthis.getList().filter(val =>\n\t\t\t\t\t\t\t\tmaster.FilterSuggest(data, input.getValue(), val)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-close\",\n\t\t\t\tcss: \"webix_pivot_close_icon\",\n\t\t\t\tpivotPropertyRemove: true,\n\t\t\t\tclick: function() {\n\t\t\t\t\tconst master = this.$scope;\n\t\t\t\t\tmaster.$$(\"addValue\").show();\n\t\t\t\t\tmaster\n\t\t\t\t\t\t.$$(\"forms\")\n\t\t\t\t\t\t.removeView(this.queryView(\"pivot-portlet\", \"parent\"));\n\t\t\t\t\tmaster.app.callEvent(\"property:change\", [\n\t\t\t\t\t\tmaster.field,\n\t\t\t\t\t\tmaster.GetValue(),\n\t\t\t\t\t]);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n\tPrepareValue(val) {\n\t\tif (val) {\n\t\t\tif (typeof val == \"object\") val = val.name;\n\t\t\tif (webix.isArray(val)) val = val[0];\n\t\t} else val = \"\";\n\n\t\treturn val;\n\t}\n\tFilterSuggest(data, activeVal, val) {\n\t\tval = val.id;\n\n\t\tif (val == activeVal) return true;\n\n\t\treturn !data.find(item => {\n\t\t\tif (item.name) item = item.name;\n\n\t\t\treturn val == item;\n\t\t});\n\t}\n}\n","function isSymbolAllowed(char) {\n\tconst code = char.charCodeAt(0);\n\treturn code <= 122 ? (code >= 48 && code <= 57) || code >= 65 : code > 191;\n}\n\nfunction getLastSymbolIndex(str, right) {\n\tif (right) {\n\t\tfor (let i = 0; i < str.length; i++) if (!isSymbolAllowed(str[i])) return i;\n\t\treturn str.length;\n\t} else\n\t\tfor (let i = str.length - 1; i >= 0; i--)\n\t\t\tif (!isSymbolAllowed(str[i])) return i + 1;\n\n\treturn 0;\n}\n\nfunction startsWith(text, start) {\n\treturn text.toLowerCase().indexOf(start.toLowerCase()) === 0;\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"suggest-math\",\n\t\t$enterKey() {\n\t\t\tconst list = this.getList();\n\t\t\tif (this.isVisible() && !list.getSelectedId() && list.count()) {\n\t\t\t\tlist.select(list.data.order[1]);\n\t\t\t\tthis._addFirst = 1;\n\t\t\t}\n\n\t\t\twebix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\n\t\t\twebix.delay(() => {\n\t\t\t\tdelete this._addFirst; //wait for input node change event\n\t\t\t});\n\t\t},\n\t\tdefaults: {\n\t\t\tfilter(item, value) {\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\t\tconst str = value.substring(0, cursor);\n\t\t\t\tconst search = str.substring(getLastSymbolIndex(str));\n\t\t\t\tconst nextSymbol = value.charAt(cursor);\n\n\t\t\t\tif (search && (cursor === value.length || !isSymbolAllowed(nextSymbol)))\n\t\t\t\t\tvalue = search;\n\n\t\t\t\t//groups\n\t\t\t\tif (item.disabled) {\n\t\t\t\t\tconst app = editor.$scope.app;\n\n\t\t\t\t\tif (item.id == \"$fields\") {\n\t\t\t\t\t\tconst fields = app.getState().fields;\n\t\t\t\t\t\treturn !!fields.find(obj => startsWith(obj.value, value));\n\t\t\t\t\t} else if (item.id == \"$methods\") {\n\t\t\t\t\t\tconst _ = app.getService(\"locale\")._;\n\t\t\t\t\t\tconst operations = app.getService(\"local\").operations;\n\t\t\t\t\t\treturn !!operations.find(method => startsWith(_(method.id), value));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn startsWith(item.value, value);\n\t\t\t},\n\t\t},\n\t},\n\twebix.ui.suggest\n);\n\nwebix.protoUI(\n\t{\n\t\tname: \"math-editor\",\n\t\t$init() {\n\t\t\tthis.$view.className += \" webix_el_text\";\n\t\t},\n\t\t$onBlur() {\n\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\tconst suggestClick = suggest.$view.contains(document.activeElement);\n\n\t\t\twebix.delay(() => {\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\t\t\t\tif (focus && focus.config.pivotPropertyRemove) return;\n\n\t\t\t\tif (!suggestClick)\n\t\t\t\t\tthis.callEvent(\"onChange\", [this.getValue(), null, \"user\"]);\n\t\t\t});\n\t\t},\n\t\tsetValue() {\n\t\t\tconst suggest = webix.$$(this.config.suggest);\n\n\t\t\t//handle clicks on suggest items and add first suggest value via enter\n\t\t\tif (suggest.isVisible() || suggest._addFirst) return;\n\n\t\t\twebix.ui.text.prototype.setValue.apply(this, arguments);\n\t\t},\n\t\t$setValueHere(value) {\n\t\t\tthis.setValueHere(value);\n\t\t},\n\t\tsetValueHere(value) {\n\t\t\tconst formula = this.getValue();\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\n\t\t\tconst lastSymbol = getLastSymbolIndex(str2, true);\n\t\t\tstr1 += str2.substring(0, lastSymbol);\n\t\t\tstr2 = str2.substring(lastSymbol);\n\n\t\t\tif (str1[str1.length - 1] == \"(\")\n\t\t\t\tstr1 = str1.substring(0, str1.length - 1);\n\n\t\t\tstr1 = str1.substring(0, getLastSymbolIndex(str1)) + value;\n\n\t\t\tconst operations = this.$scope.app.getService(\"local\").operations;\n\t\t\tconst isMethod = operations.find(obj => obj.value == value);\n\n\t\t\tif (isMethod)\n\t\t\t\t//suggest called via up/down key\n\t\t\t\tstr1 += str2[0] == \"(\" ? \"\" : \"(\";\n\n\t\t\tthis.$setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t},\n\t},\n\twebix.ui.text\n);\n","import \"helpers/complex\";\nimport Property from \"views/config/properties\";\n\nexport default class ValuesProperty extends Property {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name, config);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tthis._ = this.app.getService(\"locale\")._;\n\n\t\tthis.typeName = \"operation\";\n\t\tthis.plusLabel = this._(\"Add value\");\n\t\tthis.field = \"values\";\n\n\t\tthis.operations = this.Local.operations;\n\n\t\tthis.operations.map(operation => {\n\t\t\toperation.value = this._(operation.id);\n\t\t\treturn operation;\n\t\t});\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.State = this.app.getState();\n\n\t\tthis.on(this.State.$changes, \"mode\", () => {\n\t\t\tthis.ToggleColors();\n\t\t});\n\t}\n\tGetValue() {\n\t\tconst forms = this.$$(\"forms\").getChildViews();\n\t\tconst arr = [];\n\n\t\tforms.forEach(form => {\n\t\t\tconst values = form.getChildViews()[0].getValues({ hidden: false });\n\t\t\tif (!webix.isUndefined(values.name2)) {\n\t\t\t\t//wavg\n\t\t\t\tif (values.name && values.name2) {\n\t\t\t\t\tvalues.name = [values.name, values.name2];\n\t\t\t\t\tdelete values.name2;\n\t\t\t\t} else values.name = \"\";\n\t\t\t}\n\n\t\t\tif (values.name == \"\" || values.math == \"\") return;\n\t\t\tif (values.math) values.math = this.OutComplexMath(values.math);\n\t\t\tarr.push(values);\n\t\t});\n\n\t\treturn arr;\n\t}\n\tItemConfig(val, i) {\n\t\tconst config = super.ItemConfig(val);\n\n\t\tlet operation;\n\t\tif (val) operation = val.operation;\n\t\telse {\n\t\t\tconst def = this.app.config.defaultOperation;\n\t\t\tconst defIndex = Math.max(this.operations.findIndex(a => a.id == def), 0);\n\t\t\toperation = this.operations[defIndex].id;\n\t\t}\n\n\t\tconfig.splice(2, 0, {\n\t\t\tview: \"richselect\",\n\t\t\tname: \"operation\",\n\t\t\twidth: 110,\n\t\t\tvalue: operation,\n\t\t\toptions: {\n\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\tdata: this.operations.filter(\n\t\t\t\t\tobj => obj.fields <= 2 || obj.id == \"complex\"\n\t\t\t\t),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonChange: function(v) {\n\t\t\t\t\tthis.$scope.SetOperation(v, this);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tconfig.splice(2, 0, {\n\t\t\tview: \"richselect\",\n\t\t\thidden: this.Local.getOperation(operation).fields != 2,\n\t\t\tvalue: val && webix.isArray(val.name) ? val.name[1] : \"\",\n\t\t\tname: \"name2\",\n\t\t\toptions: {\n\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\tdata: this.app.getState().fields,\n\t\t\t},\n\t\t});\n\n\t\t//custom math\n\t\tconfig.splice(1, 0, {\n\t\t\tview: \"math-editor\",\n\t\t\tname: \"math\",\n\t\t\thidden: !val || val.operation != \"complex\",\n\t\t\tvalue: val && val.math ? this.Local.fixMath(val.math) : \"\",\n\t\t\tsuggest: {\n\t\t\t\tview: \"suggest-math\",\n\t\t\t\tdata: this.SuggestData(),\n\t\t\t},\n\t\t});\n\n\t\tconst mini = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\tconst palette = this.Local.getPalette();\n\t\tconst color = (val && val.color) || this.Local.getValueColor(i);\n\n\t\tconfig.splice(1, 0, {\n\t\t\tview: \"colorpicker\",\n\t\t\thidden: this.State.mode != \"chart\",\n\t\t\tname: \"color\",\n\t\t\tcss: \"webix_pivot_value_color\",\n\t\t\tvalue: color,\n\t\t\twidth: mini ? 30 : 38,\n\t\t\tsuggest: {\n\t\t\t\ttype: \"colorboard\",\n\t\t\t\tbody: {\n\t\t\t\t\twidth: 150,\n\t\t\t\t\theight: 150,\n\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\tpalette,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn config;\n\t}\n\tToggleColors() {\n\t\tconst mode = this.State.mode;\n\n\t\tconst layout = this.$$(\"forms\");\n\t\tconst forms = layout.getChildViews();\n\n\t\tfor (let i = 0; i < forms.length; i++) {\n\t\t\tconst input = forms[i].getChildViews()[0].elements.color;\n\t\t\tif (mode == \"chart\") input.show();\n\t\t\telse input.hide();\n\t\t}\n\t}\n\tFilterSuggest() {\n\t\treturn true;\n\t}\n\tSetOperation(val, view) {\n\t\tconst form = view.getFormView();\n\t\tconst elements = form.elements;\n\n\t\tif (val == \"complex\") {\n\t\t\telements.name.hide();\n\t\t\telements.name2.hide();\n\t\t\telements.math.show();\n\n\t\t\telements.name.setValue();\n\t\t\telements.name2.setValue();\n\t\t} else if (this.Local.getOperation(val).fields == 2) {\n\t\t\telements.name.show();\n\t\t\telements.name2.show();\n\t\t\telements.math.hide();\n\t\t} else {\n\t\t\telements.name.show();\n\t\t\telements.name2.hide();\n\t\t\telements.math.hide();\n\t\t}\n\t}\n\tSuggestData() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tvalue: this._(\"Fields\"),\n\t\t\t\tid: \"$fields\",\n\t\t\t\tdisabled: true,\n\t\t\t\t$css: \"webix_pivot_values_section\",\n\t\t\t},\n\t\t\t...this.app.getState().fields,\n\t\t\t{\n\t\t\t\tvalue: this._(\"Methods\"),\n\t\t\t\tid: \"$methods\",\n\t\t\t\tdisabled: true,\n\t\t\t\t$css: \"webix_pivot_values_section\",\n\t\t\t},\n\t\t\t...this.operations.filter(obj => obj.id != \"complex\"),\n\t\t];\n\t}\n\tOutComplexMath(math) {\n\t\tconst fields = this.app.getState().fields;\n\t\tconst fieldsRegex = new RegExp(\n\t\t\t\"(\\\\(|\\\\s|,|^)(\" +\n\t\t\t\tfields\n\t\t\t\t\t.map(field => field.value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\"))\n\t\t\t\t\t.join(\"|\") +\n\t\t\t\t\")(\\\\)|\\\\s|,|$)\",\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst fieldsMatch = Array.from(math.matchAll(fieldsRegex));\n\t\tfor (let i = fieldsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = fieldsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\tfields.find(obj => obj.value == match[2]).id +\n\t\t\t\tmath.substring(\n\t\t\t\t\tmatch.index + match[0].length - match[3].length,\n\t\t\t\t\tmath.length\n\t\t\t\t);\n\t\t}\n\n\t\tconst methods = this.operations;\n\t\tconst methodsRegex = new RegExp(\n\t\t\t\"(\\\\(|,|\\\\+|-|\\\\/|\\\\*|\\\\s|^)(\" +\n\t\t\t\tmethods\n\t\t\t\t\t.map(method =>\n\t\t\t\t\t\tmethod.value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\")\n\t\t\t\t\t)\n\t\t\t\t\t.join(\"|\") +\n\t\t\t\t\")\\\\(\",\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst methodsMatch = Array.from(math.matchAll(methodsRegex));\n\t\tfor (let i = methodsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = methodsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\tthis.operations.find(operation => operation.value == match[2]).id +\n\t\t\t\tmath.substring(match.index + match[0].length - 1, math.length);\n\t\t}\n\n\t\treturn math;\n\t}\n}\n","import Property from \"views/config/properties\";\n\nexport default class GroupProperty extends Property {\n\tconstructor(app, name) {\n\t\tsuper(app, name);\n\n\t\tthis.field = \"groupBy\";\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tpadding: 10,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"group\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\t\tdata: this.app.getState().fields,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonBeforeShow: () => {\n\t\t\t\t\t\t\t\tthis._activeInput = this.$$(\"group\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\t\t\tif (source == \"user\")\n\t\t\t\t\t\t\t\tthis.app.callEvent(\"property:change\", [this.field, value]);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t}\n\tGetValue() {\n\t\treturn this.$$(\"group\").getValue();\n\t}\n\tSetValue(val) {\n\t\tthis.$$(\"group\").setValue(val);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ChartSettings extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tcomplexData: true,\n\t\t\tpadding: 10,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tname: \"type\",\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tvalue: \"bar\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t{ id: \"bar\", value: _(\"Bar\") },\n\t\t\t\t\t\t\t{ id: \"line\", value: _(\"Line\") },\n\t\t\t\t\t\t\t{ id: \"radar\", value: _(\"Radar\") },\n\t\t\t\t\t\t\t{ id: \"area\", value: _(\"Area\") },\n\t\t\t\t\t\t\t{ id: \"spline\", value: _(\"Spline\") },\n\t\t\t\t\t\t\t{ id: \"splineArea\", value: _(\"Spline Area\") },\n\t\t\t\t\t\t\t{ id: \"pie\", value: _(\"Pie\") },\n\t\t\t\t\t\t\t{ id: \"donut\", value: _(\"Donut\") },\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"xAxis.title\",\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tlabel: _(\"X axis title\"),\n\t\t\t\t\tbatch: \"axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"yAxis.title\",\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tlabel: _(\"Y axis title\"),\n\t\t\t\t\tbatch: \"axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"scaleColor\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\teditable: true,\n\t\t\t\t\tlabel: _(\"Scale color\"),\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\t\t\tpalette: this.app.getService(\"local\").getPalette(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"3D\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"pie\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"3D\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"pieInnerText\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"pie\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Show values inside\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"stacked\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"stacked\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Stacked\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"horizontal\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"bar\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Horizontal\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"scale\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tcheckValue: \"logarithmic\",\n\t\t\t\t\tuncheckValue: \"linear\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Logarithmic scale\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"yAxis.lineShape\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"radar\",\n\t\t\t\t\tcheckValue: \"arc\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Circled lines\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"lines\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Lines\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\tif (source == \"user\") {\n\t\t\t\t\t\tconst out = this.OutValues(this.getRoot().getValues());\n\n\t\t\t\t\t\tthis.innerChange = true;\n\t\t\t\t\t\tthis.State.chart = Object.assign({}, out);\n\t\t\t\t\t\tthis.HandleVisibility();\n\t\t\t\t\t\tdelete this.innerChange;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"chart\", chart => {\n\t\t\tif (!this.innerChange) {\n\t\t\t\tthis.getRoot().setValues(this.InValues(chart));\n\t\t\t\tthis.HandleVisibility();\n\t\t\t}\n\t\t});\n\t}\n\tHandleVisibility() {\n\t\tconst form = this.getRoot();\n\t\tconst type = form.getValues().type;\n\t\tconst pieBased = type == \"pie\" || type == \"donut\";\n\n\t\tif (pieBased) form.showBatch(\"pie\");\n\t\telse {\n\t\t\tform.showBatch(\"scale\");\n\t\t\tif (type == \"radar\") form.showBatch(\"radar\", true);\n\t\t\telse {\n\t\t\t\tform.showBatch(\"axis\", true);\n\t\t\t\tconst bar = type == \"bar\";\n\t\t\t\tif (bar || type == \"area\") {\n\t\t\t\t\tif (bar) form.showBatch(\"bar\", true);\n\t\t\t\t\tform.showBatch(\"stacked\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tInValues(values) {\n\t\tvalues = webix.copy(values);\n\t\tconst type = values.type.toLowerCase();\n\t\tconst stackedArea = type == \"stackedarea\";\n\n\t\tif (type.indexOf(\"bar\") != -1 || stackedArea) {\n\t\t\tif (type.indexOf(\"stacked\") != -1) values.stacked = 1;\n\t\t\tif (type.indexOf(\"h\") != -1) values.horizontal = 1;\n\t\t\tvalues.type = stackedArea ? \"area\" : \"bar\";\n\t\t}\n\n\t\treturn values;\n\t}\n\tOutValues(values) {\n\t\tconst bar = values.type == \"bar\";\n\t\tif (bar || values.type == \"area\") {\n\t\t\tif (bar && values.horizontal) {\n\t\t\t\tvalues.type += \"H\";\n\t\t\t\tdelete values.horizontal;\n\t\t\t}\n\t\t\tif (values.stacked) {\n\t\t\t\tvalues.type =\n\t\t\t\t\t\"stacked\" + values.type[0].toUpperCase() + values.type.slice(1);\n\t\t\t\tdelete values.stacked;\n\t\t\t}\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableSettings extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tpadding: 10,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tname: \"cleanRows\",\n\t\t\t\t\tlocalId: \"cleanRows\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Clean rows\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Highlight\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"minX\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Min X\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"maxX\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Max X\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"minY\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Min Y\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"maxY\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Max Y\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Footer\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tname: \"footer\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: 1, value: _(\"Off\") },\n\t\t\t\t\t\t{ id: 2, value: _(\"On\") },\n\t\t\t\t\t\t{ id: 3, value: _(\"Sum Only\") },\n\t\t\t\t\t],\n\t\t\t\t\tvalue: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Total Column\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tname: \"totalColumn\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: 1, value: _(\"Off\") },\n\t\t\t\t\t\t{ id: 2, value: _(\"On\") },\n\t\t\t\t\t\t{ id: 3, value: _(\"Sum Only\") },\n\t\t\t\t\t],\n\t\t\t\t\tvalue: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\tif (source == \"user\") {\n\t\t\t\t\t\tconst out = this.OutValues(this.getRoot().getValues());\n\n\t\t\t\t\t\tthis.innerChange = true;\n\t\t\t\t\t\tthis.State.datatable = Object.assign({}, out);\n\t\t\t\t\t\tdelete this.innerChange;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"datatable\", datatable => {\n\t\t\tif (!this.innerChange) this.getRoot().setValues(this.InValues(datatable));\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", mode => {\n\t\t\tif (mode == \"table\") this.$$(\"cleanRows\").show();\n\t\t\telse this.$$(\"cleanRows\").hide();\n\t\t});\n\t}\n\tInValues(values) {\n\t\tvalues = webix.copy(values);\n\n\t\tif (values.footer) values.footer = values.footer == \"sumOnly\" ? 3 : 2;\n\t\telse values.footer = 1;\n\n\t\tif (values.totalColumn)\n\t\t\tvalues.totalColumn = values.totalColumn == \"sumOnly\" ? 3 : 2;\n\t\telse values.totalColumn = 1;\n\n\t\treturn values;\n\t}\n\tOutValues(values) {\n\t\tswitch (values.footer) {\n\t\t\tcase \"1\":\n\t\t\t\tdelete values.footer;\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tvalues.footer = true;\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\t\tvalues.footer = \"sumOnly\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch (values.totalColumn) {\n\t\t\tcase \"1\":\n\t\t\t\tdelete values.totalColumn;\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tvalues.totalColumn = true;\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\t\tvalues.totalColumn = \"sumOnly\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class FilterView extends JetView {\n\tconfig() {\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss: \"webix_pivot_filter_popup\",\n\t\t\ttemplate: item => item.label,\n\t\t\tbody: {\n\t\t\t\tview: \"filter\",\n\t\t\t\tfield: \"value\",\n\t\t\t\ton: {\n\t\t\t\t\tonChange: config => {\n\t\t\t\t\t\tif (config == \"user\") {\n\t\t\t\t\t\t\tconst state = this.app.getState();\n\t\t\t\t\t\t\tconst structure = webix.copy(state.structure);\n\n\t\t\t\t\t\t\tlet value;\n\t\t\t\t\t\t\tstructure.filters = structure.filters.filter(filter => {\n\t\t\t\t\t\t\t\tconst exists = filter.name == this.field;\n\t\t\t\t\t\t\t\tconst inner = exists && !filter.external;\n\n\t\t\t\t\t\t\t\tif (inner) value = filter.value = this.filter.getValue();\n\n\t\t\t\t\t\t\t\treturn !exists || inner;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tstate.structure = structure;\n\n\t\t\t\t\t\t\tthis.app.callEvent(\"filter:change\", [this.field, value]);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tShow(pos, filterObj) {\n\t\tconst popup = this.getRoot();\n\t\tconst filter = (this.filter = popup.getBody());\n\t\tthis.field = filterObj.name;\n\t\tconst list = filter.getChildViews()[2];\n\n\t\tconst field = this.Local.getField(this.field);\n\n\t\tthis.Local.collectFieldValues(this.field).then(values => {\n\t\t\tlist.clearAll();\n\t\t\tlist.parse(webix.copy(values));\n\n\t\t\tfilter.define({ mode: field.type });\n\t\t\tfilter.config.value = \"\";\n\t\t\tfilter.setValue(webix.copy(filterObj.value || {}));\n\n\t\t\tpopup.show(pos);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ModeView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\");\n\n\t\tconst askin = webix.skin.$active;\n\t\tconst mini = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\tconst config = {\n\t\t\theight: askin.toolbarHeight,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"segmented\",\n\t\t\t\t\tlocalId: \"modes\",\n\t\t\t\t\talign: \"middle\",\n\t\t\t\t\tinputHeight: askin.inputHeight - askin.inputPadding * (mini ? 0 : 2),\n\t\t\t\t\toptionWidth: 80,\n\t\t\t\t\twidth: 244,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"table\", value: _(\"Table\") },\n\t\t\t\t\t\t{ id: \"tree\", value: _(\"Tree\") },\n\t\t\t\t\t\t{ id: \"chart\", value: _(\"Chart\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: (v, o, c) => {\n\t\t\t\t\t\t\tif (c == \"user\") this.SetMode(v);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ width: askin.dataPadding },\n\t\t\t],\n\t\t};\n\n\t\tif (this.Compact) {\n\t\t\tconfig.css = \"webix_pivot_footer\";\n\t\t\tconfig.cols[1].width = 0;\n\t\t\tconfig.cols.unshift({});\n\t\t}\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\");\n\n\t\tthis.on(this.State.$changes, \"mode\", mode => {\n\t\t\tthis.$$(\"modes\").setValue(mode);\n\t\t});\n\t}\n\n\t/**\n\t * Sets Pivot mode\n\t * @param {string} desired mode (\"table\", \"tree\", \"data\")\n\t */\n\tSetMode(value) {\n\t\tthis.State.mode = value;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ModeView from \"views/mode\";\nimport filterPopup from \"views/filter\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\");\n\t\tthis.State = this.getParam(\"state\");\n\n\t\tlet config;\n\t\tif (this.Compact) {\n\t\t\tconfig = {\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"pt-settings\",\n\t\t\t\tinputHeight: webix.skin.$active.buttonHeight,\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: () => this.ToggleConfig(),\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tconst label = _(\"Configure Pivot\");\n\t\t\tconst css = \"webix_template webix_pivot_measure_size\";\n\n\t\t\t// 20px icon width and 8px additional padding\n\t\t\tconst width = 20 + 8 + webix.html.getTextSize(label, css).width;\n\t\t\tconfig = {\n\t\t\t\tview: \"template\",\n\t\t\t\tborderless: true,\n\t\t\t\twidth,\n\t\t\t\ttemplate: () => {\n\t\t\t\t\treturn `\n\t\t\t\t\t\t<span>${label}</span>\n\t\t\t\t\t\t<span class=\"pt-settings webix_pivot_toolbar_icon\"></span>`;\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\twebix_pivot_settings: () => this.ToggleConfig(),\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t\tconfig.localId = \"config\";\n\t\tconfig.css = \"webix_pivot_settings\";\n\t\tconfig.tooltip = _(\"Click to configure\");\n\n\t\tconst scrollSize = webix.env.$customScroll ? 0 : this._GetScrollWidth();\n\t\tconst height = webix.skin.$active.toolbarHeight + scrollSize;\n\n\t\tlet css = \"webix_pivot_toolbar\";\n\t\tif (scrollSize) {\n\t\t\twebix.html.addStyle(\n\t\t\t\t`.webix_pivot_bar_with_scroll .webix_pivot_settings>.webix_template{ line-height: ${height}px; }`\n\t\t\t);\n\t\t\tcss += \" webix_pivot_bar_with_scroll\";\n\t\t}\n\n\t\tconst result = {\n\t\t\tcss,\n\t\t\tmargin: this.Compact ? 12 : 0,\n\t\t\tpadding: {\n\t\t\t\tleft: this.Compact ? webix.skin.$active.inputPadding : 0,\n\t\t\t},\n\t\t\theight,\n\t\t\tcols: [config, this.GetFilters()],\n\t\t};\n\n\t\tif (!this.Compact) result.cols.push(ModeView);\n\n\t\treturn result;\n\t}\n\n\tinit() {\n\t\tthis.filterPopup = this.ui(filterPopup);\n\n\t\tthis.on(this.State.$changes, \"fields\", fields => {\n\t\t\tif (fields.length) {\n\t\t\t\t// render filters after fields set\n\t\t\t\tconst filtersView = this.$$(\"filters\").getParentView();\n\t\t\t\twebix.ui(this.GetFilters(), filtersView);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old && this.FiltersChanged(structure, old)) {\n\t\t\t\tconst filtersView = this.$$(\"filters\").getParentView();\n\t\t\t\twebix.ui(this.GetFilters(), filtersView);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", val => {\n\t\t\tthis.ToggleReadonly(val);\n\t\t});\n\t}\n\t/**\n\t * Compares filters when structure changes\n\t * @param {Object} structure - current structure\n\t * @param {Object} oldStructure - previous structure\n\t * @returns {boolean} result of comparison\n\t */\n\tFiltersChanged(structure, oldStructure) {\n\t\tif (structure.filters.length == oldStructure.filters.length) {\n\t\t\tfor (let i = 0; i < structure.filters.length; i++) {\n\t\t\t\tconst filter = structure.filters[i];\n\t\t\t\tconst old = oldStructure.filters[i];\n\t\t\t\tif (filter.name != old.name || filter.external != old.external)\n\t\t\t\t\treturn true;\n\t\t\t\tif (JSON.stringify(filter.value) != JSON.stringify(old.value))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t} else return true;\n\n\t\treturn false;\n\t}\n\t/**\n\t * Toggles the configuration window\n\t */\n\tToggleConfig() {\n\t\tthis.State.config = !this.State.config;\n\t}\n\t/**\n\t * Controls visibility of a button with Pivot settings\n\t * @param {boolean} val - indicates whether Pivot is in a readonly mode\n\t */\n\tToggleReadonly(val) {\n\t\tif (val) this.$$(\"config\").hide();\n\t\telse this.$$(\"config\").show();\n\t}\n\t/**\n\t * Gets configuration for toolbar filters\n\t * @returns {Object} layout with all filters\n\t */\n\tGetFilters() {\n\t\tconst structure = this.State.structure;\n\t\tconst filters = [];\n\n\t\tif (this.State.fields.length)\n\t\t\t// toolbar renders before fields set\n\t\t\tstructure.filters.forEach(filter => {\n\t\t\t\tif (!filter.external) filters.push(this.FilterConfig(filter));\n\t\t\t});\n\n\t\tconst askin = webix.skin.$active;\n\t\tconst padding = (askin.toolbarHeight - askin.buttonHeight) / 2;\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tborderless: true,\n\t\t\tscroll: \"x\",\n\t\t\tbody: {\n\t\t\t\tmargin: 8,\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: this.Compact ? 0 : 8,\n\t\t\t\t\ttop: padding + askin.inputPadding,\n\t\t\t\t\tbottom: padding + askin.inputPadding,\n\t\t\t\t},\n\t\t\t\tlocalId: \"filters\",\n\t\t\t\tcols: filters,\n\t\t\t},\n\t\t};\n\t}\n\t/**\n\t * Gets configuration a single toolbar filter\n\t * @param {Object} filter - filter object from structure\n\t * @returns {Object} filter UI\n\t */\n\tFilterConfig(filter) {\n\t\tconst label = this.app.getService(\"local\").getField(filter.name).value;\n\t\tconst css = \"webix_template webix_pivot_measure_size\";\n\n\t\t// 20px icon width and 8px additional padding\n\t\tconst width =\n\t\t\t(this.Compact ? 0 : 20 + 8) + webix.html.getTextSize(label, css).width;\n\t\treturn {\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\twidth,\n\t\t\tcss: \"webix_pivot_filter\",\n\t\t\ttemplate: () => {\n\t\t\t\tconst value = filter.value;\n\t\t\t\tconst activeCss =\n\t\t\t\t\tvalue && (value.includes || value.condition.filter)\n\t\t\t\t\t\t? \"webix_pivot_active_filter\"\n\t\t\t\t\t\t: \"\";\n\t\t\t\tconst icon = !this.Compact\n\t\t\t\t\t? \"<span class='pt-filter webix_pivot_toolbar_icon'></span>\"\n\t\t\t\t\t: \"\";\n\t\t\t\treturn `<div class=\"webix_pivot_filter_inner ${activeCss}\">\n\t\t\t\t\t<span>${label}</span>\n\t\t\t\t\t${icon}\n\t\t\t\t</div>`;\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_pivot_filter: function() {\n\t\t\t\t\tthis.$scope.filterPopup.Show(this.$view, filter);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t_GetScrollWidth() {\n\t\tconst outer = webix.html.create(\"DIV\", {\n\t\t\tstyle: \"visibility:hidden;overflow:scroll;\",\n\t\t});\n\t\tconst inner = webix.html.create(\"DIV\");\n\n\t\tdocument.body.appendChild(outer);\n\t\touter.appendChild(inner);\n\n\t\tconst scrollbarWidth = outer.offsetWidth - inner.offsetWidth;\n\n\t\touter.parentNode.removeChild(outer);\n\t\treturn scrollbarWidth;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst chart = {\n\t\t\tview: \"chart\",\n\t\t\t$mainView: true,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"data\",\n\t\t\txAxis: {},\n\t\t\tyAxis: {},\n\t\t};\n\n\t\twebix.extend(chart, webix.copy(state.chart), true);\n\n\t\tconst type = chart.type;\n\t\tif (type == \"barH\" || type == \"stackedBarH\") {\n\t\t\tif (!chart.yAxis.template)\n\t\t\t\tchart.yAxis.template = obj => obj[obj.length - 1];\n\t\t} else if (!chart.xAxis.template)\n\t\t\tchart.xAxis.template = obj => obj[obj.length - 1];\n\n\t\tconst commonAxisSettings = {\n\t\t\tlines: chart.lines,\n\t\t};\n\n\t\t//save default chart line color\n\t\tif (chart.scaleColor)\n\t\t\tcommonAxisSettings.color = commonAxisSettings.lineColor =\n\t\t\t\tchart.scaleColor;\n\n\t\twebix.extend(chart.xAxis, commonAxisSettings, true);\n\t\twebix.extend(chart.yAxis, commonAxisSettings, true);\n\n\t\tif (this.IsPieBased()) {\n\t\t\twebix.extend(\n\t\t\t\tchart,\n\t\t\t\t{\n\t\t\t\t\tmultilevel: true,\n\t\t\t\t\ttooltip: this.ValueFormat,\n\t\t\t\t\tcolor: \"#color#\",\n\t\t\t\t\ttype: type + (chart[\"3D\"] ? \"3D\" : \"\"),\n\t\t\t\t\tpieInnerText: chart[\"pieInnerText\"] ? this.ValueFormat : \"\",\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\treturn chart;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.LoadData();\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old) this.LoadData();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"chart\", (val, o) => {\n\t\t\tif (o) this.refresh();\n\t\t});\n\t}\n\t/**\n\t * Loads data to a chart\n\t * @returns {Promise} promise that resolves when data is parsed\n\t */\n\tLoadData() {\n\t\treturn this.Local.getData().then(data => {\n\t\t\tthis.UpdateChart(data);\n\t\t});\n\t}\n\t/**\n\t * Updates chart data\n\t * @param {Array} data - array of data\n\t */\n\tUpdateChart(data) {\n\t\tthis.$$(\"data\").clearAll();\n\n\t\tif (!this.IsPieBased()) {\n\t\t\tthis.$$(\"data\").removeAllSeries();\n\t\t\tthis.SetSeries(data.values);\n\t\t}\n\n\t\tthis.SetLegend(data.values);\n\t\tthis.$$(\"data\").parse(data.data);\n\t}\n\t/**\n\t * Checks if chart is pie based\n\t * @param {string} type (optional) - chart type\n\t * @returns {boolean} is pie based\n\t */\n\tIsPieBased(type) {\n\t\tif (!type) type = this.State.chart.type;\n\t\treturn type == \"pie\" || type == \"donut\";\n\t}\n\t/**\n\t * Sets chart series\n\t * @param {Array} values - array of values for series\n\t */\n\tSetSeries(values) {\n\t\tfor (let i = 0; i < values.length; i++)\n\t\t\tthis.$$(\"data\").addSeries(this.GetSeriesConfig(values[i], i));\n\t}\n\t/**\n\t * Prepares chart series\n\t * @param {object} settings - values for series\n\t * @param {number} i - index\n\t * @param {string} type - chart type (customizations)\n\t */\n\tGetSeriesConfig(settings, i, type) {\n\t\ttype = type || this.State.chart.type;\n\t\treturn {\n\t\t\ttype,\n\t\t\tvalue: obj => obj[i],\n\t\t\talpha: type == \"area\" || type == \"splineArea\" ? 0.7 : 1,\n\t\t\tcolor: settings.color,\n\t\t\ttooltip: obj => this.ValueFormat({ value: obj[i] }),\n\t\t\titem: {\n\t\t\t\tcolor: settings.color,\n\t\t\t\tborderColor: settings.color,\n\t\t\t},\n\t\t\tline: {\n\t\t\t\tcolor: settings.color,\n\t\t\t},\n\t\t};\n\t}\n\t/**\n\t * Prepares and sets chart legend\n\t * @param {Array} values - array of values for legend\n\t */\n\tSetLegend(values) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tvalues = values.map(v => {\n\t\t\tconst operation = v.operation;\n\t\t\tlet text = v.text;\n\t\t\tif (operation == \"complex\") text = this.Local.fixMath(text);\n\t\t\telse if (operation) {\n\t\t\t\ttext = text\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.map(t => this.Local.getField(t).value)\n\t\t\t\t\t.join(\", \");\n\t\t\t\ttext = `${text} (${_(operation)})`;\n\t\t\t}\n\t\t\treturn { color: v.color, text };\n\t\t});\n\n\t\tconst legend = webix.extend(\n\t\t\t{\n\t\t\t\tvalues,\n\t\t\t\tvalign: \"middle\",\n\t\t\t\talign: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t},\n\t\t\tthis.State.chart.legend || {},\n\t\t\ttrue\n\t\t);\n\t\tthis.$$(\"data\").define({ legend });\n\t}\n\t/**\n\t * Formats tooltip values / inner text\n\t * @param {object} item - data item\n\t * @returns {number} formatted value\n\t */\n\tValueFormat(item) {\n\t\treturn item.text || parseFloat(item.value || 0).toFixed(3);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Property from \"views/config/properties\";\nimport ValuesProperty from \"views/config/properties/values\";\nimport GroupProperty from \"views/config/properties/group\";\nimport ChartSettings from \"views/config/properties/chart\";\nimport TableSettings from \"views/config/properties/table\";\n\nexport default class ConfigView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tthis.State = this.app.getState();\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst toolbar = {\n\t\t\ttype: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: 16,\n\t\t\t\tright: 14, //button\n\t\t\t\ttop: 8,\n\t\t\t\tbottom: 4,\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Done\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tautowidth: true,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: () => this.ToggleForm(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst structure = {\n\t\t\tborderless: true,\n\t\t\tview: \"scrollview\",\n\t\t\tscroll: \"y\",\n\t\t\tbody: {\n\t\t\t\tview: \"accordion\",\n\t\t\t\tcss: \"webix_pivot_configuration\",\n\t\t\t\tlocalId: \"settings\",\n\t\t\t\tmulti: true,\n\t\t\t\ttype: \"space\",\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: 16,\n\t\t\t\t\tright: 16,\n\t\t\t\t\ttop: 4,\n\t\t\t\t\tbottom: 16,\n\t\t\t\t},\n\t\t\t\tmargin: 20,\n\t\t\t\trows: [\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Rows\"),\n\t\t\t\t\t\t\"pt-rows\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"rows\",\n\t\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\t\tfield: \"rows\",\n\t\t\t\t\t\t\t\tplusLabel: _(\"Add row\"),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Columns\"),\n\t\t\t\t\t\t\"pt-columns\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"columns\",\n\t\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\t\tfield: \"columns\",\n\t\t\t\t\t\t\t\tplusLabel: _(\"Add column\"),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(_(\"Values\"), \"pt-values\", {\n\t\t\t\t\t\tname: \"values\",\n\t\t\t\t\t\t$subview: ValuesProperty,\n\t\t\t\t\t}),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Group By\"),\n\t\t\t\t\t\t\"pt-group\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"groupBy\",\n\t\t\t\t\t\t\t$subview: GroupProperty,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"chart\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(_(\"Filters\"), \"pt-filter\", {\n\t\t\t\t\t\tname: \"filters\",\n\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\tfield: \"filters\",\n\t\t\t\t\t\t\tplusLabel: _(\"Add filter\"),\n\t\t\t\t\t\t}),\n\t\t\t\t\t}),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Chart\"),\n\t\t\t\t\t\t\"pt-chart\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$subview: ChartSettings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"chart\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Table\"),\n\t\t\t\t\t\t\"wxi-columns\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$subview: TableSettings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\t{},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t\trows: [toolbar, structure],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.State.$changes, \"readonly\", (_v, o) => {\n\t\t\tif (!webix.isUndefined(o)) this.ToggleForm();\n\t\t});\n\t}\n\n\tready() {\n\t\tthis.on(this.app, \"property:change\", (field, value) => {\n\t\t\tthis.HandleFieldChange(field, value);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"structure\", () => {\n\t\t\tif (!this.innerChange) this.SetValues();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", (mode, oldMode) => {\n\t\t\tconst isChart = mode == \"chart\";\n\n\t\t\tthis.$$(\"settings\").showBatch(isChart ? \"chart\" : \"table\");\n\n\t\t\t//columns can be updated in structure via groupBy\n\t\t\tif (oldMode && (isChart || oldMode == \"chart\")) this.SetValues();\n\t\t});\n\t}\n\t/** Toggles configuration form */\n\tToggleForm() {\n\t\tthis.State.config = !this.State.config;\n\t}\n\t/** Sets values into a  configuration form */\n\tSetValues() {\n\t\tconst structure = this.State.structure;\n\t\tconst inputs = [\"rows\", \"columns\", \"values\", \"filters\", \"groupBy\"];\n\n\t\tinputs.forEach(input => {\n\t\t\tconst value = structure[input] || this.State[input];\n\t\t\tconst view = this.getSubView(input);\n\t\t\tview.SetValue(value);\n\t\t});\n\t}\n\t/**\n\t * Applies changes in form fields to data structure\n\t * @param {string} field - field name\n\t * @param {string|Array} value - field value\n\t */\n\tHandleFieldChange(field, value) {\n\t\tconst structure = webix.copy(this.State.structure);\n\n\t\tif (field == \"filters\") value = this.CorrectFilters(structure, value);\n\t\telse this.CorrectInputs(structure, field, value);\n\n\t\tstructure[field] = value;\n\t\tthis.innerChange = true;\n\t\tthis.app.setStructure(structure);\n\t\tdelete this.innerChange;\n\t}\n\t/**\n\t * Prepares configuration for an accordion item with form fields\n\t * @param {string} name - accordion item header name\n\t * @param {string} icon - accordion item icon\n\t * @param {Object} config - object with form fields for this accordion item\n\t * @param {string} batch - batch name, used to control visibility\n\t * @returns {Object} configuration of the accordion item body\n\t */\n\tGroupConfig(name, icon, config, batch) {\n\t\treturn {\n\t\t\tbatch,\n\t\t\theader: `\n\t\t\t\t<span class=\"webix_icon webix_pivot_config_icon ${icon}\"></span>\n\t\t\t\t<span class=\"webix_pivot_config_label\">${name}</span>\n\t\t\t`,\n\t\t\tbody: config,\n\t\t\tborderless: true,\n\t\t};\n\t}\n\t/** Returns an object with fields that need to be corrected when some field changes */\n\tGetCorrections() {\n\t\treturn {\n\t\t\trows: [\"columns\", \"values\", \"groupBy\"],\n\t\t\tcolumns: [\"rows\", \"values\"],\n\t\t\tvalues: [\"rows\", \"columns\", \"groupBy\"],\n\t\t\tgroupBy: [\"rows\", \"values\"],\n\t\t};\n\t}\n\t/**\n\t * Prepares filters before applying them to data structure\n\t * @param {Object} structure - a copy of the current data structure\n\t * @param {Array} value - \"filters\" field value\n\t */\n\tCorrectFilters(structure, value) {\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst active = structure.filters.find(filter => {\n\t\t\t\tif (filter.name == value[i]) return true;\n\t\t\t});\n\t\t\tvalue[i] = { name: value[i] };\n\t\t\tif (active && !active.external) value[i].value = active.value;\n\t\t}\n\n\t\tconst external = structure.filters.filter(filter => filter.external);\n\t\tvalue = value.concat(external);\n\n\t\treturn value;\n\t}\n\t/**\n\t * Prepares form fields before applying them to data structure\n\t * @param {Object} structure - a copy of the current data structure\n\t * @param {string} field -  field name\n\t * @param {string|Array} value -  field value\n\t */\n\tCorrectInputs(structure, field, value) {\n\t\tconst inputs = this.GetCorrections()[field];\n\n\t\tif (inputs) {\n\t\t\tif (typeof value == \"string\") value = [value];\n\n\t\t\tvalue = value.map(v => (v.name ? v.name : v));\n\n\t\t\tinputs.forEach(input => {\n\t\t\t\tconst view = this.getSubView(input);\n\t\t\t\tlet values = view.GetValue();\n\n\t\t\t\tif (typeof values == \"string\") {\n\t\t\t\t\tif (value.find(v => v == values)) values = \"\";\n\t\t\t\t} else\n\t\t\t\t\tvalues = values.filter(v => {\n\t\t\t\t\t\tif (v.name) v = v.name;\n\n\t\t\t\t\t\treturn value.indexOf(v) == -1;\n\t\t\t\t\t});\n\n\t\t\t\tstructure[input] = values;\n\t\t\t\tview.SetValue(values);\n\t\t\t});\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class Popup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tborderless: true,\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ModeView from \"views/mode\";\nimport ToolbarView from \"views/toolbar\";\n\nimport { initRLayout } from \"@xbs/jet-helpers\";\n\nexport default class MainView extends JetView {\n\tconfig() {\n\t\tinitRLayout();\n\n\t\tconst fCompact = this.getParam(\"forceCompact\");\n\t\tif (!webix.isUndefined(fCompact)) this.setParam(\"compact\", fCompact);\n\t\tthis.Compact = this.getParam(\"compact\");\n\n\t\tconst rows = [\n\t\t\tToolbarView,\n\t\t\t{\n\t\t\t\tview: \"r-layout\",\n\t\t\t\tlocalId: \"main\",\n\t\t\t\tcols: [{ $subview: true }],\n\t\t\t},\n\t\t];\n\n\t\tif (this.Compact) {\n\t\t\trows.push(ModeView, {\n\t\t\t\t$subview: true,\n\t\t\t\tname: \"edit\",\n\t\t\t\tpopup: true,\n\t\t\t});\n\t\t} else {\n\t\t\trows[1].cols.push({\n\t\t\t\tview: \"proxy\",\n\t\t\t\tmaxWidth: 450,\n\t\t\t\tlocalId: \"edit\",\n\t\t\t\tcss: \"webix_pivot_config_container webix_shadow_medium\",\n\t\t\t\tborderless: true,\n\t\t\t\thidden: true,\n\t\t\t\tbody: { $subview: true, name: \"edit\" },\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t\trows,\n\t\t\tview: webix.isUndefined(fCompact) ? \"r-layout\" : \"layout\",\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst state = this.getParam(\"state\");\n\n\t\tthis.$$(\"main\").sizeTrigger(\n\t\t\tthis.app,\n\t\t\tmode => this.SetCompactMode(mode),\n\t\t\t!!this.Compact\n\t\t);\n\n\t\tthis.on(state.$changes, \"mode\", mode => {\n\t\t\tthis.show(\"./\" + (mode == \"chart\" ? \"chart\" : \"table\"));\n\t\t});\n\n\t\tthis.on(state.$changes, \"config\", val => {\n\t\t\tif (val) this.ShowConfig();\n\t\t\telse this.HideConfig();\n\t\t});\n\t}\n\n\t/** Shows configuration window*/\n\tShowConfig() {\n\t\tif (this.Compact) {\n\t\t\tthis.show(\"config.popup/config\", {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$$(\"edit\").show();\n\t\t\tthis.show(\"config\", {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t}\n\t}\n\n\t/** Hides configuration window*/\n\tHideConfig() {\n\t\t// we need to destroy the view inside first\n\t\tthis.show(\"_blank\", { target: \"edit\" });\n\n\t\tif (!this.Compact) this.$$(\"edit\").hide();\n\t}\n\n\tSetCompactMode(mode) {\n\t\t//let it render, then recreate\n\t\twebix.delay(() => {\n\t\t\tthis.setParam(\"compact\", mode);\n\t\t\tif (!mode) webix.fullscreen.exit();\n\t\t\tthis.refresh();\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst rows = state.structure.rows.length;\n\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\t$mainView: true,\n\t\t\tlocalId: \"data\",\n\t\t\tcss: \"webix_data_border webix_header_border\",\n\t\t\tselect: true,\n\t\t\tleftSplit: state.mode == \"table\" ? rows : rows ? 1 : 0,\n\t\t\tresizeColumn: true,\n\t\t\tborderless: true,\n\t\t\tcolumns: [],\n\t\t\tfooter: state.datatable.footer,\n\t\t};\n\n\t\twebix.extend(table, state.datatable, true);\n\n\t\treturn table;\n\t}\n\n\tinit() {\n\t\tthis.LoadData();\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old) this.LoadData();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"datatable\", (val, o) => {\n\t\t\tif (o) this.refresh();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", (val, o) => {\n\t\t\tif (o && o != \"chart\" && val != \"chart\") this.refresh();\n\t\t});\n\t}\n\t/**\n\t * Loads data to a table\n\t * @returns {Promise} promise that resolves when data is parsed\n\t */\n\tLoadData() {\n\t\treturn this.Local.getData().then(data => {\n\t\t\tthis.UpdateTable(data);\n\t\t});\n\t}\n\t/**\n\t * Updates table data\n\t * @param {Array} data - array of data\n\t */\n\tUpdateTable(data) {\n\t\tconst state = this.State;\n\t\tconst structure = state.structure;\n\n\t\tconst freeze = this.CheckFreeze();\n\n\t\tlet rightSplit = 0;\n\t\tconst totalCols = state.datatable.totalColumn;\n\t\tlet totalOps;\n\t\tif (totalCols) {\n\t\t\tconst vals = structure.values;\n\t\t\ttotalOps =\n\t\t\t\ttotalCols == \"sumOnly\" ? vals.filter(v => v.operation == \"sum\") : vals;\n\t\t\tif (freeze) rightSplit = totalOps.length;\n\t\t}\n\n\t\tlet leftSplit = 0;\n\t\tif (freeze) {\n\t\t\tconst rows = structure.rows.length;\n\t\t\tleftSplit = state.mode == \"table\" ? rows : rows ? 1 : 0;\n\t\t}\n\n\t\tif (!data.$ready) {\n\t\t\tconst total = data.totalColumn;\n\t\t\tlet lastId;\n\n\t\t\tif (total) {\n\t\t\t\tlastId = data.header[data.header.length - 1].id;\n\n\t\t\t\tfor (let i = 0; i < totalOps.length; i++) {\n\t\t\t\t\tlet name = totalOps[i].name;\n\t\t\t\t\tif (webix.isArray(name)) name = name.join();\n\n\t\t\t\t\tdata.header.push({\n\t\t\t\t\t\theader: [\n\t\t\t\t\t\t\t{ name: \"total\", colspan: rightSplit },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: name || totalOps[i].operation,\n\t\t\t\t\t\t\t\toperation: totalOps[i].operation,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tid: lastId + i + 1,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst totalIndex = { i: 0 };\n\t\t\tdata = this.Local._store = {\n\t\t\t\tdata: data.data.map(item =>\n\t\t\t\t\tthis._prepareData(item, total, totalIndex, lastId)\n\t\t\t\t),\n\t\t\t\tcolumns: this.SetColumns(data.header, data.footer, data.marks),\n\t\t\t\t$ready: 1,\n\t\t\t};\n\t\t}\n\n\t\tconst table = this.$$(\"data\");\n\t\ttable.clearAll();\n\t\ttable.define({ leftSplit, rightSplit }, true);\n\t\ttable.refreshColumns(data.columns);\n\t\ttable.parse(data.data);\n\t}\n\t/**\n\t * Prepares table item (updates id, adds total cols, etc.)\n\t * @param {Array} obj - data item\n\t * @param {Array} total - array with total values for columns\n\t * @param {Object} index - current total index\n\t * @param {number} lastId - last column id\n\t * @returns {Proxy} prepared item\n\t */\n\t_prepareData(obj, total, index, lastId) {\n\t\tconst table = this.State.mode == \"table\";\n\t\tlet totalIndex;\n\n\t\tif (table || (total && !obj.data)) totalIndex = index.i++;\n\n\t\tconst item = new Proxy(obj, {\n\t\t\tget: (item, prop) => {\n\t\t\t\tif (prop == \"data\") return item.vals;\n\t\t\t\tif (table && prop == \"id\") return totalIndex + 1;\n\n\t\t\t\tconst id = prop * 1;\n\t\t\t\tif (!isNaN(id)) {\n\t\t\t\t\tconst vals = typeof item.values == \"object\" ? item.values : item;\n\n\t\t\t\t\tif (total && id > lastId && (totalIndex || totalIndex === 0)) {\n\t\t\t\t\t\treturn total[totalIndex][id - lastId - 1];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn vals[id - 1];\n\t\t\t\t}\n\n\t\t\t\treturn item[prop];\n\t\t\t},\n\t\t});\n\n\t\tif (obj.data) {\n\t\t\titem.open = true;\n\t\t\titem.vals = obj.data.map(r => {\n\t\t\t\treturn this._prepareData(r, total, index, lastId);\n\t\t\t});\n\t\t}\n\n\t\treturn item;\n\t}\n\t/**\n\t * Checks if columns should be frozen\n\t */\n\tCheckFreeze() {\n\t\tconst freezeColumns = this.app.config.freezeColumns;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\treturn webix.isUndefined(freezeColumns) ? !compact : freezeColumns;\n\t}\n\t/**\n\t * Prepares table columns\n\t * @param {Array} columns - array with columns\n\t * @param {Array} footer - array with total values for columns\n\t * @param {Array} marks - array with min/max marks for columns\n\t * @returns {Array} column configurations\n\t */\n\tSetColumns(columns, footer, marks) {\n\t\tcolumns = webix.copy(columns);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst rows = this.State.structure.rows.length;\n\t\tconst left = this.State.mode == \"table\" ? rows : rows ? 1 : 0;\n\n\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\tif (i < left) {\n\t\t\t\tthis.SetFirstColumn(columns[i], !i && this.State.datatable.footer, _);\n\t\t\t} else {\n\t\t\t\tcolumns[i].sort = \"int\";\n\n\t\t\t\tif (!columns[i].format) columns[i].format = this.CellFormat;\n\n\t\t\t\tif (marks.length)\n\t\t\t\t\tcolumns[i].cssFormat = (v, row, rid, cid) => {\n\t\t\t\t\t\tconst col = marks[rid - 1];\n\t\t\t\t\t\tconst css = col ? col[cid - 1] : null;\n\t\t\t\t\t\treturn css ? css.join(\" \") : \"\";\n\t\t\t\t\t};\n\n\t\t\t\tconst header = columns[i].header;\n\t\t\t\tfor (let j = 0; j < header.length; j++) {\n\t\t\t\t\tlet h = header[j];\n\t\t\t\t\tif (h) {\n\t\t\t\t\t\tif (!j && h.name == \"total\") {\n\t\t\t\t\t\t\th.text = _(\"Total\");\n\t\t\t\t\t\t} else if (j == header.length - 1) {\n\t\t\t\t\t\t\th.text = this.HeaderTemplate(h, _);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (footer.length) {\n\t\t\t\t\tcolumns[i].footer = this.CellFormat(footer[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn columns;\n\t}\n\t/**\n\t * Prepares first column\n\t * @param {Object} column - column configuration\n\t * @param {boolean} footer - column with footer name\n\t * @param {function} _ - function for translating text labels\n\t */\n\tSetFirstColumn(column, footer, _) {\n\t\tif (this.State.mode == \"tree\") {\n\t\t\tcolumn.header = {\n\t\t\t\ttext: this.State.structure.rows\n\t\t\t\t\t.map(field => this.Local.getField(field).value)\n\t\t\t\t\t.join(\"<span class='webix_icon wxi-angle-right'></span>\"),\n\t\t\t\tcss: \"webix_pivot_tree_header\",\n\t\t\t};\n\t\t\tcolumn.width = 300;\n\t\t\tcolumn.template = (obj, common) => {\n\t\t\t\treturn common.treetable(obj, common) + obj[1];\n\t\t\t};\n\t\t} else {\n\t\t\tcolumn.header = this.Local.getField(column.header[0].text).value;\n\t\t\tcolumn.width = 200;\n\t\t}\n\t\tif (footer) column.footer = _(\"Total\");\n\t}\n\t/**\n\t * Sets a template for column header\n\t * @param {Object} line - object with header line properties\n\t * @param {function} _ - function for translating text labels\n\t * @returns {string} string with header text\n\t */\n\tHeaderTemplate(line, _) {\n\t\tif (!line.operation || line.operation == \"complex\")\n\t\t\treturn this.Local.fixMath(line.text);\n\t\telse {\n\t\t\tlet text = line.text.split(\",\");\n\t\t\ttext = text.map(t => this.Local.getField(t).value).join(\", \");\n\t\t\treturn `${text} <span class=\"webix_pivot_operation\">${_(\n\t\t\t\tline.operation\n\t\t\t)}</span>`;\n\t\t}\n\t}\n\t/**\n\t * Formats a cell value\n\t * @param {(number|string)} value - raw value\n\t * @returns {(number|string)} formatted value\n\t */\n\tCellFormat(value) {\n\t\tif (!value) value = value === 0 ? \"0\" : \"\";\n\n\t\treturn value ? parseFloat(value).toFixed(3) : value;\n\t}\n}\n","const asc = (a, b) => (a.key > b.key ? 1 : -1);\nconst desc = (a, b) => (a.key < b.key ? 1 : -1);\nclass DataDimension {\n    constructor(table, getValue, label, meta, sort) {\n        if (sort === \"desc\") {\n            this._sort = desc;\n        }\n        else if (sort === \"asc\") {\n            this._sort = asc;\n        }\n        else if (sort) {\n            this._sort = (a, b) => sort(a.key, b.key);\n        }\n        this._label = label;\n        this._meta = meta || null;\n        this._table = table;\n        this._getter = getValue;\n        this._prepared = 0;\n    }\n    getIndexes() {\n        return this._indexes;\n    }\n    getValue(i) {\n        return this._values[i].key;\n    }\n    getSize() {\n        return this._values.length;\n    }\n    getLabel() {\n        return this._label;\n    }\n    getOptions() {\n        this._prepareOptions();\n        return this._values.map(a => a.key);\n    }\n    getMeta() {\n        return this._meta;\n    }\n    reset() {\n        this._prepared = 0;\n    }\n    prepare() {\n        // eslint-disable-next-line\n        if (this._prepared & 1)\n            return;\n        // eslint-disable-next-line\n        this._prepared = this._prepared | 1;\n        this._prepareOptions();\n        const { _table, _getter, _keys } = this;\n        const fSize = _table.count();\n        this._values.forEach((a, i) => (a.index = i));\n        const indexes = (this._indexes = new Array(fSize));\n        for (let i = 0; i < fSize; i++) {\n            const key = _getter(i);\n            indexes[i] = _keys.get(key).index;\n        }\n    }\n    _prepareOptions() {\n        // eslint-disable-next-line\n        if (this._prepared & 2)\n            return;\n        // eslint-disable-next-line\n        this._prepared = this._prepared | 2;\n        const { _table, _getter } = this;\n        const fSize = _table.count();\n        const keys = (this._keys = new Map());\n        const values = (this._values = []);\n        for (let i = 0; i < fSize; i++) {\n            const key = _getter(i);\n            const index = keys.get(key);\n            if (typeof index === \"undefined\") {\n                keys.set(key, (values[values.length] = { key, index: 0 }));\n            }\n        }\n        if (this._sort)\n            values.sort(this._sort);\n    }\n}\n\nclass DataExport {\n    constructor(pivot) {\n        this._pivot = pivot;\n    }\n    toArray({ cleanRows, filters, ops }) {\n        const out = [];\n        const limit = this._pivot.getLimit();\n        const maxRow = limit.rows || 0;\n        this._pivot.filter(filters);\n        this._pivot.operations(ops);\n        this._pivot.resetCursor();\n        let count = 0;\n        const header = new Set();\n        const rAggr = new Map();\n        const rowData = [];\n        // eslint-disable-next-line\n        while (true) {\n            const cAggr = {};\n            const row = this._pivot.next(header, out.length, rAggr, cAggr);\n            if (!row)\n                break;\n            out.push(row);\n            rowData.push(cAggr);\n            count++;\n            if (maxRow === count)\n                break;\n        }\n        const [scaleWidth, width] = this._pivot.getWidth();\n        if (cleanRows)\n            this._cleanRows(out, scaleWidth);\n        const result = {\n            data: out,\n            columns: Array.from(header).sort((a, b) => (a > b ? 1 : -1)),\n            width: width + scaleWidth,\n            scaleWidth,\n            rowData,\n        };\n        result.columnData = this._pivot.aggregateColumns(result, rAggr);\n        result.marks = this._pivot.mark(result, rAggr);\n        return result;\n    }\n    toNested({ filters, ops }) {\n        this._pivot.filter(filters);\n        this._pivot.operations(ops);\n        this._pivot.resetCursor();\n        const rAggr = new Map();\n        const result = this._pivot.nested(rAggr);\n        result.columnData = this._pivot.aggregateColumns(result, rAggr);\n        result.marks = this._pivot.mark(result, rAggr);\n        return result;\n    }\n    toXHeader(data, config) {\n        return this._pivot.getXHeader(data, config);\n    }\n    _cleanRows(data, rowsLength) {\n        const count = data.length;\n        const prev = new Array(rowsLength);\n        for (let j = 0; j < count; j++) {\n            const row = data[j];\n            for (let i = 0; i < rowsLength; i++) {\n                if (prev[i] !== row[i]) {\n                    for (let j = i; j < rowsLength; j++)\n                        prev[j] = row[j];\n                    break;\n                }\n                row[i] = \"\";\n            }\n        }\n    }\n}\n\nfunction t(t,e){let n=\"\";const o=t.length;let r=0,i=!1,s=!1,u=0;for(;r<o;){const o=t[r];if(r++,'\"'===o)i?n+=t.substr(u,r-u):u=r-1,i=!i;else {if(i)continue;const c=\",\"===o||\"/\"===o||\"*\"===o||\"+\"===o||\"-\"===o||\"(\"===o||\")\"===o,f=\" \"===o||\"\\t\"===o||\" \\n\"===o||\"\\r\"===o;if(s){if(!c&&!f)continue;{const i=t.substr(u,r-u-1);n+=\"(\"===o?e.method(i):e.property(i),s=!1;}}if(f)continue;if(c)n+=o;else {\"0\"===o||\"1\"===o||\"2\"===o||\"3\"===o||\"4\"===o||\"5\"===o||\"6\"===o||\"7\"===o||\"8\"===o||\"9\"===o?n+=o:(s=!0,u=r-1);}}}return s&&(n+=e.property(t.substr(u,r-u))),n}function e(e,n){return new Function(n.propertyName,n.methodName,n.contextName,\"return \"+t(e,n))}\n\nfunction optimize(table, order, code, allMath) {\n    const math = getMath(table, code);\n    const ctx = {\n        table,\n        order,\n        from: 0,\n        to: 0,\n        array: (i, c) => {\n            const size = c.to - c.from;\n            const temp = new Array(size);\n            const getter = cache[i];\n            for (let j = 0; j < size; j++) {\n                temp[j] = getter(c.order[j + c.from]);\n            }\n            return temp;\n        },\n    };\n    return function (from, to) {\n        ctx.from = from;\n        ctx.to = to;\n        return math(0, allMath, ctx);\n    };\n}\nfunction optimizeRangeGroup(table, order, code, allMath) {\n    const math = getMath(table, code);\n    const ctx = {\n        table,\n        order,\n        range: [],\n        array: (i, c) => {\n            const size = ctx.range.length;\n            const temp = [];\n            const getter = cache[i];\n            for (let j = 0; j < size; j += 2) {\n                const from = ctx.range[j];\n                const to = ctx.range[j + 1];\n                for (let i = from; i < to; i++) {\n                    temp.push(getter(c.order[i]));\n                }\n            }\n            return temp;\n        },\n    };\n    return function (range) {\n        ctx.range = range;\n        return math(0, allMath, ctx);\n    };\n}\nfunction optimizeGroup(code, allMath) {\n    const math = getGroupMath(code);\n    return function (v) {\n        return math(v, allMath, null);\n    };\n}\nlet id = 0;\nconst cache = [];\nfunction getMath(table, rule) {\n    return e(rule, {\n        propertyName: \"d\",\n        methodName: \"m\",\n        contextName: \"c\",\n        property: (a) => {\n            const i = id;\n            cache[i] = table.getColumn(a).getter;\n            id += 1;\n            return `c.array(\"${i}\", c)`;\n        },\n        method: (a) => {\n            return `m.${a.toLowerCase()}`;\n        },\n    });\n}\nfunction getGroupMath(rule) {\n    return e(rule, {\n        propertyName: \"d\",\n        methodName: \"m\",\n        contextName: \"c\",\n        property: () => {\n            return `d`;\n        },\n        method: (a) => {\n            return `m.${a.toLowerCase()}`;\n        },\n    });\n}\n\nconst and = (a, b) => c => a(c) && b(c);\nfunction buildFinder(data, key, value, context) {\n    const getValue = context.getter(data, key);\n    if (typeof value !== \"object\") {\n        const check = context.compare[\"eq\"](value);\n        return i => check(getValue(i));\n    }\n    else {\n        const ops = Object.keys(value);\n        let result = null;\n        for (let i = 0; i < ops.length; i++) {\n            const check = context.compare[ops[i].toLowerCase()](value[ops[i]]);\n            const step = i => check(getValue(i));\n            result = result ? and(result, step) : step;\n        }\n        return result;\n    }\n}\nfunction build(table, rule, context) {\n    const keys = Object.keys(rule);\n    let result = null;\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        const step = buildFinder(table, key, rule[key], context);\n        result = result ? and(result, step) : step;\n    }\n    return result;\n}\nfunction filter(order, table, rule, context) {\n    const filter = build(table, rule, context);\n    return order.filter(n => filter(n));\n}\n\nclass DataPivot {\n    constructor(table, rows, cols, filters, config) {\n        this._rows = rows;\n        this._cols = cols;\n        this._dims = rows.concat(cols);\n        this._table = table;\n        this._context = config;\n        this._cursor = -1;\n        this._order = this._base_order = this._sort();\n        this._data = this._dims.map(a => a.getIndexes());\n        this.filter(filters, true);\n    }\n    resetCursor() {\n        this._cursor = 0;\n        this._group = this._dims.map(() => null);\n        if (this._order.length) {\n            if (this._rows.length)\n                this._nextRow();\n            if (this._cols.length)\n                this._nextColumn();\n        }\n    }\n    next(header, index, rAggr, cAggr) {\n        const { _cursor, _cols, _order, _group, _ops, _rows } = this;\n        if (this._cursor >= _order.length)\n            return null;\n        const dimsSize = _rows.length;\n        const out = new Array(dimsSize + _ops.length * _cols.length);\n        // dimensions\n        for (let i = 0; i < dimsSize; i++)\n            out[i] = _rows[i].getValue(_group[i]);\n        // get end of next line ( all dataset for columns mode )\n        const to = this._rows.length\n            ? this._nextRow(_cols.length > 0)\n            : _order.length;\n        this._fillRow(out, index, _cursor, to, dimsSize, header, rAggr, cAggr);\n        this._cursor = to;\n        return out;\n    }\n    nested(rAggr) {\n        const { _cols, _order, _rows } = this;\n        const header = new Set();\n        const dimSize = _rows.length;\n        const dimOutSize = dimSize > 0 ? 1 : 0;\n        const levels = [{ data: [], values: [] }];\n        const data = [];\n        let prev = [];\n        let now = [];\n        let from = this._cursor;\n        let count = 0;\n        const { _groupOps } = this;\n        const _groupLength = [{}].concat(_rows.map(() => ({})));\n        const rowData = [];\n        const limit = this._context.limit.rows;\n        const width = Math.min(this._context.limit.columns, (_cols.length ? this._sizes[0] * _cols[0].getSize() : 0) + dimOutSize);\n        const closeLevels = function (j) {\n            // ignore not created, during first iteration\n            if (!levels[j])\n                return;\n            // each sub-level\n            for (; j < dimSize; j++) {\n                // get all known columns\n                for (const [kAgr, vAgr] of rAggr) {\n                    // get start of related rows\n                    const prev = _groupLength[j][kAgr] || 0;\n                    // if have new rows\n                    if (prev === 0 || vAgr.length > prev) {\n                        // check and calcualte op\n                        for (let z = 0; z < _groupOps.length; z++) {\n                            const math = _groupOps[z];\n                            if (math) {\n                                levels[j].values[dimOutSize + kAgr + z] = math(vAgr.slice(prev + 1));\n                                _groupLength[j][kAgr] = vAgr.length - 1;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        while (this._cursor < _order.length) {\n            const out = new Array(width);\n            prev = now;\n            now = [].concat(this._group);\n            // get end of next line ( all dataset for columns mode )\n            const to = this._rows.length\n                ? this._nextRow(_cols.length > 0)\n                : _order.length;\n            // calculate finished branches\n            if (_groupOps !== null) {\n                for (let level = 0; level < dimSize; level++) {\n                    // find level at which route differs\n                    if (now[level] != prev[level]) {\n                        closeLevels(level + 1);\n                        break;\n                    }\n                }\n            }\n            const cAggr = {};\n            this._fillRow(out, data.length, from, to, dimOutSize, header, rAggr, cAggr);\n            rowData.push(cAggr);\n            // if we have row-dimensions\n            if (dimSize > 0) {\n                for (let level = 0; level < dimSize; level++) {\n                    // find level at which route differs\n                    if (now[level] != prev[level]) {\n                        // starting from that level and below\n                        for (let j = level; j < dimSize; j++) {\n                            const index = j + 1;\n                            const last = index === dimSize;\n                            // create new nodes\n                            const obj = (levels[index] = {\n                                id: last ? data.length + 1 : 0,\n                                data: last ? null : [],\n                                values: last ? out : [_rows[j].getValue(now[j])],\n                            });\n                            // store node in the parents branch\n                            levels[j].data.push(obj);\n                        }\n                        break;\n                    }\n                }\n                // store scale value in the first cell of the new row\n                out[0] = _rows[dimSize - 1].getValue(now[dimSize - 1]);\n                // store value line of the pivot ( leaf of the tree )\n                levels[dimSize].values = out;\n            }\n            else {\n                // if we have not row-dimensions, store plain data only\n                levels[0].data.push({ data: null, values: out });\n            }\n            data.push(out);\n            count++;\n            if (count >= limit)\n                break;\n            this._cursor = from = to;\n        }\n        if (_groupOps !== null) {\n            closeLevels(1);\n        }\n        const columns = Array.from(header).sort((a, b) => (a > b ? 1 : -1));\n        const result = {\n            tree: levels[0].data,\n            data,\n            width,\n            scaleWidth: dimOutSize,\n            columns,\n            rowData,\n        };\n        this._fillGroupRow(levels[0], result, rAggr, _rows.length - 1);\n        return result;\n    }\n    getLimit() {\n        return this._context.limit;\n    }\n    getWidth() {\n        return [\n            this._rows.length,\n            this._cols.length && this._ops.length\n                ? this._cols[0].getSize() * this._sizes[0]\n                : 0,\n            this._ops.length,\n        ];\n    }\n    getXHeader(result, hConfig) {\n        const { _cols, _rows, _ops, _opInfo } = this;\n        const { nonEmpty, meta } = hConfig || {};\n        const isNested = result.tree;\n        // compressed line\n        const line = [];\n        // rows prefix\n        const rpref = result.tree ? Math.min(_rows.length, 1) : _rows.length;\n        // count of operations, repeat step of bottom scale\n        const ostep = _ops.length;\n        // how many scale units in one parent\n        const unitsInParent = _cols.map(a => a.getSize());\n        // calculate full width of data\n        const length = unitsInParent.reduce((prev, value) => prev * value, ostep);\n        const columns = result.columns;\n        const fullLength = rpref +\n            Math.min(nonEmpty ? columns.length * ostep : length, this._context.limit.columns);\n        // how many data points per unit\n        let temp = length;\n        const unitSizes = unitsInParent.map(a => (temp = temp / a));\n        // result header\n        const out = [];\n        this._cols.forEach(() => out.push(new Array(fullLength)));\n        // build compressed order\n        if (nonEmpty) {\n            //check all cells, include columns of cells with data\n            for (let i = 0; i < rpref; i++)\n                line.push(i);\n            for (let j = 0; j < columns.length; j++) {\n                const base = rpref + columns[j];\n                for (let i = 0; i < ostep; i++)\n                    line.push(base + i);\n            }\n            // now check each scale line\n            for (let j = 0; j < _cols.length; j++) {\n                const step = unitSizes[j];\n                let start = -1;\n                let end = 0;\n                let colspan = 0;\n                let text;\n                // against each non-empty column\n                for (let i = rpref; i < line.length; i += ostep) {\n                    const test = line[i];\n                    // if we inside of span\n                    if (test < end) {\n                        colspan += ostep;\n                    }\n                    else {\n                        // we have reached the new span\n                        // setting old one if any\n                        if (colspan !== 0) {\n                            out[j][start] = { colspan, text };\n                        }\n                        // store position of new span\n                        const ind = Math.floor((test - rpref) / step);\n                        start = i;\n                        end = (ind + 1) * step + rpref;\n                        colspan = ostep;\n                        // store related text\n                        text = _cols[j].getValue(ind % unitsInParent[j]);\n                    }\n                }\n                // setting last span\n                if (colspan !== 0)\n                    out[j][start] = { colspan, text };\n            }\n        }\n        else {\n            // for each scale\n            for (let i = 0; i < _cols.length; i++) {\n                const size = unitsInParent[i];\n                const step = unitSizes[i];\n                let ind = 0;\n                // set value at n-th cell\n                for (let j = rpref; j < fullLength; j += step) {\n                    if (step === 1) {\n                        out[i][j] = _cols[i].getValue(ind++);\n                    }\n                    else {\n                        out[i][j] = { text: _cols[i].getValue(ind++), colspan: step };\n                    }\n                    // repeat dimension values\n                    if (ind >= size)\n                        ind = 0;\n                }\n            }\n        }\n        // add bottom line, with operations\n        if (this._ops) {\n            const opNames = new Array(fullLength);\n            const step = _ops.length;\n            for (let j = rpref; j < fullLength; j += step)\n                for (let z = 0; z < step; z++)\n                    opNames[j + z] = _opInfo[z].label;\n            out.push(opNames);\n        }\n        // prepend row labels\n        for (let i = 0; i < rpref; i++) {\n            const rowspan = _cols.length + (this._ops ? 1 : 0);\n            if (isNested) {\n                out[0][0] = { text: \"\", rowspan };\n                break;\n            }\n            const text = _rows[i].getLabel();\n            out[0][i] = rowspan > 1 ? { text, rowspan } : text;\n        }\n        const res = { data: out };\n        // add compression line to output\n        if (nonEmpty)\n            res.nonEmpty = line;\n        if (meta) {\n            const metaLine = new Array(fullLength);\n            for (let i = 0; i < rpref; i++)\n                metaLine[i] = _rows[i].getMeta();\n            const step = _ops.length;\n            for (let j = rpref; j < fullLength; j += step)\n                for (let z = 0; z < step; z++)\n                    metaLine[j + z] = _opInfo[z].meta;\n            res.meta = metaLine;\n        }\n        return res;\n    }\n    filter(rules, master) {\n        if (!rules || Object.keys(rules).length === 0) {\n            if (!master && this._masterRules)\n                rules = Object.assign(Object.assign({}, this._masterRules), rules);\n            else {\n                this._order = this._base_order;\n                return;\n            }\n        }\n        if (master)\n            this._masterRules = rules;\n        this._order = filter(this._base_order, this._table, rules, this._context);\n    }\n    operations(ops) {\n        const { _table, _order, _context } = this;\n        ops = ops || [];\n        this._ops = ops.map(p => optimize(_table, _order, typeof p === \"string\" ? p : p.math, _context.math));\n        this._groupResultOps = ops.map(p => p.branchMode === \"result\"\n            ? optimizeGroup(typeof p === \"string\" ? p : p.branchMath || p.math, _context.math)\n            : null);\n        if (!this._groupResultOps.find(a => a !== null))\n            this._groupResultOps = null;\n        this._groupOps = ops.map(p => p.branchMode === \"raw\"\n            ? optimizeRangeGroup(_table, _order, typeof p === \"string\" ? p : p.branchMath || p.math, _context.math)\n            : null);\n        if (!this._groupOps.find(a => a !== null))\n            this._groupOps = null;\n        this._opInfo = ops.map(p => {\n            if (typeof p === \"string\") {\n                return { label: p, math: p };\n            }\n            else {\n                return Object.assign(Object.assign({}, p), { label: p.label || p.math });\n            }\n        });\n        this._rowResultOps = compactOps(ops, \"row\", \"result\", (x, name) => ({\n            name,\n            op: optimizeGroup(x, _context.math),\n        }));\n        this._rowOps = compactOps(ops, \"row\", \"raw\", (x, name) => ({\n            name,\n            op: optimize(_table, _order, x, _context.math),\n        }));\n        this._colResultOps = compactOps(ops, \"column\", \"result\", (x, name) => ({\n            name,\n            op: optimizeGroup(x, _context.math),\n        }));\n        this._colOps = compactOps(ops, \"column\", \"raw\", (x, name) => ({\n            name,\n            op: optimizeRangeGroup(_table, _order, x, _context.math),\n        }));\n        this._marks = ops.map(a => a.marks || null);\n        if (!this._marks.find(a => a !== null))\n            this._marks = null;\n        this._setSizes();\n    }\n    aggregateColumns(result, rAggr) {\n        const { _colOps, _colResultOps } = this;\n        const { columns, data, scaleWidth } = result;\n        if (!_colOps && !_colResultOps)\n            return [];\n        const step = this._ops.length;\n        const out = [];\n        for (let i = 0; i < columns.length; i++) {\n            const ind = columns[i];\n            const dmr = rAggr.get(ind);\n            if (!dmr)\n                continue;\n            const keys = Array.from(dmr[0].keys());\n            for (let j = 0; j < step; j++) {\n                const column = {};\n                if (_colResultOps) {\n                    const op = _colResultOps[j];\n                    if (op) {\n                        const values = keys.map(a => data[a][ind + j + scaleWidth]);\n                        op.forEach(x => (column[x.name] = x.op(values)));\n                    }\n                }\n                if (_colOps) {\n                    const op = _colOps[j];\n                    if (op) {\n                        op.forEach(x => (column[x.name] = x.op(dmr.slice(1))));\n                    }\n                }\n                out[scaleWidth + ind + j] = column;\n            }\n        }\n        return out;\n    }\n    _optimizeGroup(ops) {\n        const config = {};\n        let exit = true;\n        for (const key in ops) {\n            const test = ops[key];\n            config[key] = optimizeGroup(test, this._context.math);\n            exit = false;\n        }\n        return exit ? null : config;\n    }\n    mark(result, rAggr) {\n        const out = [];\n        const { _marks, _ops } = this;\n        if (!_marks)\n            return out;\n        const opsLength = _ops.length;\n        const { scaleWidth, data, columnData, rowData } = result;\n        for (const [k, v] of rAggr) {\n            const r = v[0];\n            for (let i = 0; i < opsLength; i++) {\n                const marks = this._marks[i];\n                if (marks === null)\n                    continue;\n                for (const z of r) {\n                    const cid = k + i + scaleWidth;\n                    const rid = z;\n                    const cell = [];\n                    for (let j = 0; j < marks.length; j++) {\n                        if (marks[j].check(data[rid][cid], columnData[cid] || {}, rowData[rid] || {}))\n                            cell.push(marks[j].name);\n                    }\n                    if (cell.length) {\n                        let rarr = out[rid];\n                        if (typeof rarr === \"undefined\")\n                            rarr = out[rid] = [];\n                        rarr[cid] = cell;\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    __getHeaderStub() {\n        return {};\n    }\n    _fillGroupRow(obj, result, rAggr, level) {\n        const { _groupResultOps } = this;\n        const { columns, scaleWidth } = result;\n        if (_groupResultOps) {\n            for (let i = 0; i < columns.length; i++) {\n                const ind = columns[i];\n                for (let j = 0; j < _groupResultOps.length; j++) {\n                    const op = _groupResultOps[j];\n                    if (!op)\n                        continue;\n                    if (level > 0)\n                        this._fillGroupRowInner(obj, op, ind + j + scaleWidth, level);\n                }\n            }\n        }\n    }\n    _fillGroupRowInner(obj, op, ind, level) {\n        const arr = [];\n        if (level > 0) {\n            obj.data.forEach(a => {\n                const res = this._fillGroupRowInner(a, op, ind, level - 1);\n                if (res !== null) {\n                    arr.push(res);\n                }\n            });\n        }\n        else {\n            for (let i = 0; i < obj.data.length; i++) {\n                const test = obj.data[i].values[ind];\n                if (typeof test !== \"undefined\")\n                    arr.push(test);\n            }\n        }\n        if (arr.length)\n            return (obj.values[ind] = op(arr));\n        return null;\n    }\n    _fillRow(out, index, from, to, dimsSize, header, rAggr, cAggr) {\n        const { _cols, _group, _ops, _sizes, _rows, _rowResultOps, _rowOps } = this;\n        const rl = _rows.length;\n        const collectRaggr = this._colResultOps !== null ||\n            this._colOps !== null ||\n            this._marks !== null;\n        let ctemp = [];\n        if (_rowResultOps !== null)\n            ctemp = _rowResultOps.map(() => []);\n        // calculations\n        if (_ops.length) {\n            if (_cols.length) {\n                let cfrom = from;\n                while (cfrom < to) {\n                    let cind = 0;\n                    for (let i = 0; i < _cols.length; i++)\n                        cind += _sizes[i] * _group[rl + i];\n                    const cto = this._nextColumn();\n                    for (let i = 0; i < _ops.length; i++) {\n                        const temp = (out[cind + dimsSize + i] = _ops[i](cfrom, cto));\n                        if (_rowResultOps !== null)\n                            ctemp[i].push(temp);\n                    }\n                    if (collectRaggr) {\n                        let arr = rAggr.get(cind);\n                        if (!arr)\n                            rAggr.set(cind, (arr = [new Set(), cfrom, cto]));\n                        else\n                            arr.push(cfrom, cto);\n                        arr[0].add(index);\n                    }\n                    header.add(cind);\n                    this._cursor = cfrom = cto;\n                }\n            }\n            else {\n                for (let i = 0; i < _ops.length; i++) {\n                    out[i + dimsSize] = _ops[i](from, to);\n                }\n                if (collectRaggr) {\n                    let arr = rAggr.get(0);\n                    if (!arr)\n                        rAggr.set(0, (arr = [new Set(), from, to]));\n                    else\n                        arr.push(from, to);\n                    arr[0].add(index);\n                }\n                header.add(0);\n            }\n        }\n        if (_rowResultOps !== null) {\n            _rowResultOps.forEach((opset, i) => {\n                const dataset = ctemp[i];\n                if (opset && dataset.length)\n                    opset.forEach(op => {\n                        cAggr[op.name] = op.op(ctemp[i]);\n                    });\n            });\n        }\n        if (_rowOps !== null) {\n            _rowOps.forEach(opset => {\n                opset === null || opset === void 0 ? void 0 : opset.forEach(op => {\n                    cAggr[op.name] = op.op(from, to);\n                });\n            });\n        }\n    }\n    _sort() {\n        const { _table, _dims } = this;\n        const size = Math.min(_table.count(), this._context.limit.raws);\n        const order = new Array(size);\n        for (let i = 0; i < size; i++) {\n            order[i] = i;\n        }\n        const dimsSize = _dims.length;\n        const dimsData = _dims.map(a => a.getIndexes());\n        order.sort((a, b) => {\n            for (let j = 0; j < dimsSize; j++) {\n                const left = dimsData[j][a];\n                const right = dimsData[j][b];\n                if (left > right)\n                    return 1;\n                if (left < right)\n                    return -1;\n            }\n            return 0;\n        });\n        return order;\n    }\n    _nextRow(silent) {\n        const { _data, _order, _group, _rows } = this;\n        const dimsSize = _rows.length;\n        let ok = true;\n        let to = this._cursor;\n        // eslint-disable-next-line\n        while (true) {\n            const ind = _order[to];\n            for (let i = 0; i < dimsSize; i++) {\n                if (_data[i][ind] != _group[i]) {\n                    if (!silent)\n                        _group[i] = _data[i][ind];\n                    ok = false;\n                }\n            }\n            if (!ok)\n                break;\n            to++;\n        }\n        return to;\n    }\n    _nextColumn() {\n        const { _data, _order, _group, _rows, _cols } = this;\n        const dimsSize = _cols.length + _rows.length;\n        let ok = true;\n        let to = this._cursor;\n        // eslint-disable-next-line\n        while (true) {\n            const ind = _order[to];\n            for (let i = 0; i < dimsSize; i++) {\n                if (_data[i][ind] != _group[i]) {\n                    _group[i] = _data[i][ind];\n                    ok = false;\n                }\n            }\n            if (!ok)\n                break;\n            to++;\n        }\n        return to;\n    }\n    _setSizes() {\n        const sizes = this._cols.map(a => a.getSize());\n        let sum = this._ops.length || 1;\n        for (let i = sizes.length - 1; i >= 0; i--) {\n            const now = sum;\n            sum *= sizes[i];\n            sizes[i] = now;\n        }\n        this._sizes = sizes;\n    }\n}\nfunction compactOps(ops, kind, mode, optimizer) {\n    const result = ops.map(p => {\n        const row = p[kind];\n        if (!row)\n            return null;\n        const out = row\n            .map(op => {\n            const source = op.source || \"raw\";\n            if (source === mode)\n                if (typeof op === \"string\")\n                    return optimizer(op, getName(op));\n                else\n                    return optimizer(op.math, op.as || getName(op.math));\n            return null;\n        })\n            .filter(a => a !== null);\n        if (!out.length)\n            return null;\n        return out;\n    });\n    if (!result.find(a => !!a))\n        return null;\n    return result;\n}\nfunction getName(x) {\n    const end = x.indexOf(\"(\");\n    if (end === -1)\n        return x.trim();\n    return x.substring(0, end).trim();\n}\n\nclass RawTable {\n    constructor(config) {\n        this._columns = config.fields;\n        this.parse(config.data);\n    }\n    parse(data) {\n        this._raw = data;\n        this._parse_inner();\n    }\n    prepare() {\n        if (this._prepared)\n            return;\n        this._prepared = true;\n        const data = this._raw;\n        const fields = this._columns;\n        const cols = fields.filter(a => a.type === 3);\n        if (!data || !cols.length)\n            return;\n        const dataLength = data.length;\n        const columnsLength = cols.length;\n        for (let i = 0; i < dataLength; i++) {\n            for (let j = 0; j < columnsLength; j++) {\n                const col = cols[j];\n                const text = col.getter(i);\n                if (typeof text === \"string\")\n                    col.setter(i, new Date(text));\n            }\n        }\n    }\n    _parse_inner() {\n        this._columns.forEach(a => {\n            const key = a.id;\n            a.getter = i => this._raw[i][key];\n            a.setter = (i, v) => (this._raw[i][key] = v);\n        });\n    }\n    getColumn(id) {\n        return this._columns.find(a => a.id === id);\n    }\n    count() {\n        return this._raw.length;\n    }\n}\n\nclass ColumnTable extends RawTable {\n    parse(data) {\n        this._parse_init(data.length);\n        const dataLength = data.length;\n        const columnsLength = this._columns.length;\n        for (let i = 0; i < dataLength; i++) {\n            const obj = data[i];\n            for (let j = 0; j < columnsLength; j++) {\n                const col = this._columns[j];\n                col.data[i] = obj[col.id];\n            }\n        }\n    }\n    _parse_init(n) {\n        this._columns.forEach(a => {\n            const data = (a.data = new Array(n));\n            a.getter = i => data[i];\n            a.setter = (i, v) => (data[i] = v);\n        });\n    }\n    count() {\n        return this._columns[0].data.length;\n    }\n}\n\nconst methods = {\n    round: (v) => Math.round(v),\n    sum: (arr) => arr.reduce((acc, a) => acc + a, 0),\n    min: (arr) => arr.reduce((acc, a) => (a < acc ? a : acc), arr.length ? arr[0] : 0),\n    max: (arr) => arr.reduce((acc, a) => (a > acc ? a : acc), arr.length ? arr[0] : 0),\n    avg: (arr) => arr.length ? arr.reduce((acc, a) => acc + a, 0) / arr.length : 0,\n    wavg: (arr, w) => {\n        if (!arr.length)\n            return 0;\n        let count = 0;\n        let summ = 0;\n        for (let i = arr.length - 1; i >= 0; i--) {\n            count += w[i];\n            summ += arr[i] * w[i];\n        }\n        return summ / count;\n    },\n    count: (arr) => arr.length,\n    any: (arr) => (arr.length ? arr[0] : null),\n};\nconst filters = {\n    eq: (v) => (x) => x == v,\n    neq: (v) => (x) => x != v,\n    gt: (v) => (x) => x > v,\n    gte: (v) => (x) => x >= v,\n    lt: (v) => (x) => x < v,\n    lte: (v) => (x) => x <= v,\n    in: (v) => (x) => v[x],\n    hasPrefix: (v) => (x) => x.indexOf(v) === 0,\n    contains: (v) => (x) => x.indexOf(v) !== -1,\n};\nconst predicates = {\n    year: (v) => v.getFullYear(),\n    month: (v) => v.getMonth(),\n    day: (v) => v.getDate(),\n    hour: (v) => v.getHours(),\n    minute: (v) => v.getMinutes(),\n};\n\nclass Analytic {\n    constructor(cfg) {\n        this._tables = {};\n        this._dimensions = {};\n        this._preds = Object.assign({}, predicates);\n        this._maths = Object.assign({}, methods);\n        this._comps = Object.assign({}, filters);\n        if (cfg && cfg.tables)\n            cfg.tables.forEach(s => this.addTable(s));\n        if (cfg && cfg.dimensions)\n            cfg.dimensions.forEach(s => this.addDimension(s));\n    }\n    addPredicate(name, code) {\n        this._preds[name.toLowerCase()] = code;\n    }\n    addMath(name, code) {\n        this._maths[name.toLowerCase()] = code;\n    }\n    addComparator(name, code) {\n        this._comps[name.toLowerCase()] = code;\n    }\n    getDimension(id) {\n        return this._dimensions[id];\n    }\n    addDimension(s) {\n        if (this._dimensions[s.id])\n            return;\n        const table = this._tables[s.table];\n        const getter = this._predicateGetter(table, s.rule.by);\n        this._dimensions[s.id] = new DataDimension(table, getter, s.label || s.id, s.meta || s, s.sort);\n    }\n    resetDimensions(s, preserve) {\n        const prev = this._dimensions;\n        this._dimensions = {};\n        if (s)\n            s.forEach(a => {\n                const used = prev[a.id];\n                if (preserve && used)\n                    this._dimensions[a.id] = used;\n                else\n                    this.addDimension(a);\n            });\n    }\n    addTable(s) {\n        const driver = (s.driver || \"raw\") === \"raw\" ? RawTable : ColumnTable;\n        const t = (this._tables[s.id] = new driver(s));\n        if (s.prepare)\n            t.prepare();\n    }\n    getTable(id) {\n        return this._tables[id];\n    }\n    compact(table, config) {\n        const { rows, cols, filters, limit } = config;\n        const base = this._tables[table];\n        const rDims = rows ? rows.map(a => this._dimensions[a]) : [];\n        const cDims = cols ? cols.map(a => this._dimensions[a]) : [];\n        [...rDims, ...cDims].forEach(a => a.prepare());\n        const pivot = new DataPivot(base, rDims, cDims, filters, {\n            getter: this._predicateGetter.bind(this),\n            math: this._maths,\n            compare: this._comps,\n            limit: Object.assign({ rows: 10000, columns: 5000, raws: Infinity }, (limit || {})),\n        });\n        return new DataExport(pivot);\n    }\n    _predicateGetter(table, key) {\n        const find = key.indexOf(\"(\");\n        if (find !== -1) {\n            const fn = this._preds[key.substr(0, find).toLowerCase()];\n            key = key.substr(find + 1, key.length - find - 2);\n            const getter = table.getColumn(key).getter;\n            return i => fn(getter(i));\n        }\n        else {\n            return table.getColumn(key).getter;\n        }\n    }\n}\n\nexport { Analytic };\n//# sourceMappingURL=rengine.es6.js.map\n","import * as rengine from \"@xbs/rengine\";\n\nexport default class LocalData {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis._app = app;\n\t\tthis._store = {}; //aggregated data\n\n\t\tthis._filtersHash = {};\n\t\tthis._state = app.getState();\n\n\t\tif (app.config.externalProcessing) this._setOperations();\n\t\telse {\n\t\t\tthis._data = [];\n\t\t\tthis._initRengine();\n\t\t}\n\t}\n\t/** Set list of avaible operations; adds custom operations from config */\n\t_setOperations() {\n\t\tthis.operations = [\n\t\t\t{ id: \"sum\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"min\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"max\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"avg\", fields: 1, branchMode: \"raw\" },\n\t\t\t{ id: \"wavg\", fields: 2, branchMode: \"raw\" },\n\t\t\t{ id: \"count\", fields: 1, branchMode: \"raw\" },\n\t\t\t{ id: \"any\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"complex\" },\n\t\t];\n\n\t\tconst config = this._app.config;\n\t\tconst extraOperations = this._app.config.operations;\n\t\tif (extraOperations) {\n\t\t\tif (config.externalProcessing)\n\t\t\t\tthis.operations = this.operations.concat(extraOperations);\n\t\t\telse\n\t\t\t\tfor (let name in extraOperations) {\n\t\t\t\t\tlet operation = extraOperations[name];\n\t\t\t\t\tlet fields, branchMode, hidden;\n\n\t\t\t\t\tif (typeof operation == \"object\") {\n\t\t\t\t\t\tfields = operation.fields || operation.handler.length;\n\t\t\t\t\t\tbranchMode = operation.branchMode;\n\t\t\t\t\t\thidden = operation.hidden;\n\t\t\t\t\t\toperation = operation.handler;\n\t\t\t\t\t} else fields = operation.length;\n\n\t\t\t\t\tthis._reng.addMath(name, operation);\n\n\t\t\t\t\tif (!hidden)\n\t\t\t\t\t\tthis.operations.push({\n\t\t\t\t\t\t\tid: name,\n\t\t\t\t\t\t\tfields,\n\t\t\t\t\t\t\tbranchMode,\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t}\n\t}\n\t/** Set list of avaible total operations */\n\t_setTotalOperations() {\n\t\tthis.totalOperations = {};\n\t\tconst totalOps = this._app.config.totalOperations;\n\n\t\tif (totalOps)\n\t\t\tfor (let name in totalOps) {\n\t\t\t\tconst op = totalOps[name];\n\t\t\t\tconst all = typeof totalOps[name] == \"string\";\n\t\t\t\t[\"footer\", \"group\", \"column\"].forEach(type => {\n\t\t\t\t\tif (all || op[type]) {\n\t\t\t\t\t\tif (!this.totalOperations[type]) this.totalOperations[type] = {};\n\t\t\t\t\t\tthis.totalOperations[type][name] = all ? op : op[type];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t}\n\t/** Sets default filter rules */\n\t_setFilters() {\n\t\tfor (let type in webix.filters) {\n\t\t\tthis._reng.addComparator(type, v => test => {\n\t\t\t\tif (type == \"date\") test = test.valueOf();\n\n\t\t\t\tif (!v) return true;\n\t\t\t\telse if (v.includes) return v.includes.indexOf(test) != -1;\n\t\t\t\telse if (!v.condition.filter) return true;\n\t\t\t\telse\n\t\t\t\t\treturn webix.filters[type][v.condition.type](\n\t\t\t\t\t\ttest,\n\t\t\t\t\t\tv.condition.filter\n\t\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\t/** Adds predicates from config */\n\t_setPredicates() {\n\t\tconst predicates = this._app.config.predicates;\n\t\tif (predicates)\n\t\t\tfor (let name in predicates)\n\t\t\t\tthis._reng.addPredicate(name, predicates[name]);\n\t}\n\t/**\n\t * Returns fields that contain data\n\t * @param {object} firstRow - first row in data\n\t * @returns {array} data fields\n\t */\n\tgetFields(firstRow) {\n\t\tlet fields = this._app.config.fields;\n\n\t\tif (!fields) {\n\t\t\tfields = [];\n\n\t\t\tfor (let i in firstRow) {\n\t\t\t\tlet type;\n\n\t\t\t\tconst dataType = typeof firstRow[i];\n\t\t\t\tswitch (dataType) {\n\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\ttype = \"text\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"number\":\n\t\t\t\t\t\ttype = dataType;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttype = \"date\";\n\t\t\t\t}\n\n\t\t\t\tfields.push({ id: i, value: i, type });\n\t\t\t}\n\t\t}\n\n\t\treturn fields;\n\t}\n\t/**\n\t * Loads data and populates store\n\t * @param {boolean} force - if true, data will be reloaded\n\t * @returns {Promise} promise that resolves with store array\n\t */\n\tgetData(force) {\n\t\tif (!force && this.useOldData())\n\t\t\treturn this._dataLoad || webix.promise.resolve(this._store);\n\n\t\tconst externalProcessing = this._app.config.externalProcessing;\n\t\tif (externalProcessing || !Object.keys(this._store).length || force) {\n\t\t\treturn (this._dataLoad = this._app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.data()\n\t\t\t\t.then(data => {\n\t\t\t\t\tif (externalProcessing)\n\t\t\t\t\t\tthis._store = this._rengineToWebix(data.result, data.header);\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._table = this.getTable(data);\n\t\t\t\t\t\tthis._reng.addTable(this._table);\n\t\t\t\t\t\tthis._store = this.getPivotData();\n\t\t\t\t\t}\n\t\t\t\t\tthis._filtersHash = {};\n\t\t\t\t\treturn this._store;\n\t\t\t\t})\n\t\t\t\t.catch(error => this.loadError(error))\n\t\t\t\t.finally(() => delete this._dataLoad));\n\t\t} else {\n\t\t\tthis._store = this.getPivotData();\n\t\t\treturn webix.promise.resolve(this._store);\n\t\t}\n\t}\n\t/** Checks if pivot should use last aggregated data **/\n\tuseOldData() {\n\t\tconst state = this._state;\n\t\tlet newConfig = `${state.mode}|${JSON.stringify(state.structure)}`;\n\t\tif (state.mode == \"chart\") {\n\t\t\tconst type = state.chart.type;\n\t\t\tnewConfig += `|${type == \"pie\" || type == \"donut\"}`;\n\t\t} else newConfig += `|${JSON.stringify(state.datatable)}`;\n\n\t\tconst refresh = this._old == newConfig;\n\t\tthis._old = newConfig;\n\t\treturn refresh;\n\t}\n\t/** Inits math module */\n\t_initRengine() {\n\t\tthis._reng = new rengine.Analytic();\n\n\t\tthis._setFilters();\n\t\tthis._setOperations();\n\t\tthis._setTotalOperations();\n\t\tthis._setPredicates();\n\t}\n\t/**\n\t * onverts data to pivot readable form\n\t * @returns {Object} object with aggregated data and its parameters\n\t */\n\tgetPivotData() {\n\t\tif (!this._table)\n\t\t\treturn {\n\t\t\t\tdata: [],\n\t\t\t\theader: [],\n\t\t\t\ttotal: [],\n\t\t\t\tmarks: [],\n\t\t\t};\n\n\t\tconst structure = this._state.structure;\n\t\tconst mode = this._state.mode;\n\t\tconst table = this._state.datatable;\n\n\t\tthis.setDimensions();\n\n\t\tconst filters = {};\n\t\tfor (let i = 0; i < structure.filters.length; i++) {\n\t\t\tconst filter = structure.filters[i];\n\n\t\t\tconst fields = this._state.fields;\n\t\t\tconst field = fields.find(field => field.id == filter.name);\n\n\t\t\tfilters[filter.name] = { [field.type]: filter.value };\n\t\t}\n\n\t\t//groups data\n\t\tconst res = this._reng.compact(this._table.id, {\n\t\t\trows: this.getRows(),\n\t\t\tcols: this.getColumns(),\n\t\t\tlimit: this.getLimits(),\n\t\t});\n\n\t\tconst ops = this.getOps();\n\n\t\ttry {\n\t\t\tlet result;\n\n\t\t\t//plain data\n\t\t\tif (mode == \"table\")\n\t\t\t\tresult = res.toArray({\n\t\t\t\t\tfilters,\n\t\t\t\t\tops,\n\t\t\t\t\t//remove repetitions in 'parent' col in 'table' mode\n\t\t\t\t\tcleanRows: table.cleanRows,\n\t\t\t\t});\n\t\t\t//groupped data\n\t\t\telse\n\t\t\t\tresult = res.toNested({\n\t\t\t\t\tfilters,\n\t\t\t\t\tops,\n\t\t\t\t});\n\n\t\t\tlet headerConfig;\n\t\t\tif (mode != \"chart\") headerConfig = { meta: true, nonEmpty: true };\n\n\t\t\treturn this._rengineToWebix(result, res.toXHeader(result, headerConfig));\n\t\t} catch (e) {\n\t\t\treturn this.loadError();\n\t\t}\n\t}\n\t/**\n\t * Updates math with custom total methods\n\t * @param {string} type - total operation type (group/footer/total)\n\t * @param {string} math - operation math\n\t * @param {Array} methodsMatch - math methods pos\n\t * @returns {string} updated math\n\t */\n\t_updateTotalMath(type, math, methodsMatch) {\n\t\tfor (let i = methodsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = methodsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\t(this.totalOperations[type][match[2]] || match[2]) +\n\t\t\t\tmath.substring(match.index + match[0].length - 1, math.length);\n\t\t}\n\t\treturn math;\n\t}\n\t/**\n\t * Applies math operations to data and groups\n\t * @returns {Object} ops\n\t */\n\tgetOps() {\n\t\tconst state = this._state;\n\t\tconst table = state.datatable;\n\t\tconst mode = state.mode;\n\t\tconst vals = state.structure.values;\n\t\tconst ops = [];\n\n\t\tfor (let i = 0; i < vals.length; i++) {\n\t\t\tconst format = vals[i].format;\n\t\t\tconst operation = vals[i].operation;\n\t\t\tconst color = vals[i].color;\n\n\t\t\tconst isComplex = operation == \"complex\";\n\t\t\tlet name = isComplex ? vals[i].math : vals[i].name;\n\t\t\tname = webix.isArray(name) ? name.join(\",\") : name;\n\n\t\t\tconst math = isComplex ? name : `${operation}(${name})`;\n\n\t\t\tlet branchMode;\n\t\t\tif (!isComplex) branchMode = this.getOperation(operation).branchMode;\n\n\t\t\tconst op = {\n\t\t\t\tmath,\n\t\t\t\tbranchMode: branchMode || \"raw\",\n\t\t\t\tlabel: name,\n\t\t\t\tmeta: { operation, format, color },\n\t\t\t\tcolumn: [],\n\t\t\t\trow: [],\n\t\t\t\tmarks: [],\n\t\t\t};\n\n\t\t\tconst total = this.totalOperations;\n\t\t\tlet methodsMatch;\n\t\t\tif (Object.keys(total).length) {\n\t\t\t\tconst methodsRegex = new RegExp(\n\t\t\t\t\t\"(\\\\(|,|\\\\+|-|\\\\/|\\\\*|\\\\s|^)(\" +\n\t\t\t\t\t\tthis.operations.map(method => method.id).join(\"|\") +\n\t\t\t\t\t\t\")\\\\(\",\n\t\t\t\t\t\"g\"\n\t\t\t\t);\n\t\t\t\tmethodsMatch = Array.from(math.matchAll(methodsRegex));\n\t\t\t}\n\n\t\t\tif (total.group)\n\t\t\t\top.branchMath = this._updateTotalMath(\"group\", math, methodsMatch);\n\n\t\t\tif (mode != \"chart\") {\n\t\t\t\tif (\n\t\t\t\t\ttable.footer &&\n\t\t\t\t\t((table.footer == \"sumOnly\" && operation == \"sum\") ||\n\t\t\t\t\t\ttable.footer != \"sumOnly\")\n\t\t\t\t)\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tmath: total.footer\n\t\t\t\t\t\t\t? this._updateTotalMath(\"footer\", math, methodsMatch)\n\t\t\t\t\t\t\t: math,\n\t\t\t\t\t\tas: \"value\",\n\t\t\t\t\t});\n\n\t\t\t\tif (\n\t\t\t\t\ttable.totalColumn &&\n\t\t\t\t\t((table.totalColumn == \"sumOnly\" && operation == \"sum\") ||\n\t\t\t\t\t\ttable.totalColumn != \"sumOnly\")\n\t\t\t\t)\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tmath: total.column\n\t\t\t\t\t\t\t? this._updateTotalMath(\"column\", math, methodsMatch)\n\t\t\t\t\t\t\t: math,\n\t\t\t\t\t\tas: \"\" + i,\n\t\t\t\t\t});\n\n\t\t\t\tif (table.minY) {\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tas: \"minY\",\n\t\t\t\t\t\tmath: \"min(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_min_y\",\n\t\t\t\t\t\tcheck: (v, column) => v == column.minY,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.maxY) {\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tas: \"maxY\",\n\t\t\t\t\t\tmath: \"max(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_max_y\",\n\t\t\t\t\t\tcheck: (v, column) => v == column.maxY,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.minX) {\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tas: \"minX\" + math,\n\t\t\t\t\t\tmath: \"min(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_min_x\",\n\t\t\t\t\t\tcheck: (v, column, row) => v == row[\"minX\" + math],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.maxX) {\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tas: \"maxX\" + math,\n\t\t\t\t\t\tmath: \"max(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_max_x\",\n\t\t\t\t\t\tcheck: (v, column, row) => v == row[\"maxX\" + math],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tops.push(op);\n\t\t}\n\t\treturn ops;\n\t}\n\t/** Convert rengine output data to pivot readable form **/\n\t_rengineToWebix(result, header) {\n\t\tconst state = this._state;\n\n\t\tif (state.mode == \"chart\") return this.getChartData(result, header);\n\n\t\tconst footer = header.nonEmpty.map(i =>\n\t\t\tresult.columnData[i] ? result.columnData[i].value : \"\"\n\t\t);\n\n\t\theader = this.getHeader(header);\n\n\t\tlet column;\n\t\tif (state.datatable.totalColumn) {\n\t\t\tcolumn = result.rowData.map(obj => {\n\t\t\t\tconst res = [];\n\t\t\t\tfor (let key in obj) {\n\t\t\t\t\tif (key.indexOf(\"minX\") == -1 && key.indexOf(\"maxX\") == -1)\n\t\t\t\t\t\tres[key] = obj[key];\n\t\t\t\t}\n\t\t\t\treturn res.filter(v => v || v === 0);\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tdata: result.tree || result.data,\n\t\t\theader,\n\t\t\tmarks: result.marks,\n\t\t\tfooter,\n\t\t\ttotalColumn: column,\n\t\t};\n\t}\n\t/**\n\t * Handle load error\n\t * @param {XMLHttpRequest} server error (customizations)\n\t * @returns {Object} empty data\n\t */\n\tloadError() {\n\t\twebix.message({\n\t\t\ttext: this._app.getService(\"locale\")._(\"Incorrect formula in values\"),\n\t\t\ttype: \"error\",\n\t\t});\n\n\t\treturn {\n\t\t\tdata: [],\n\t\t\tvalues: [],\n\t\t\theader: [],\n\t\t\tmarks: [],\n\t\t\tfooter: [],\n\t\t\ttotalColumn: [],\n\t\t};\n\t}\n\t/**\n\t * Prepares data for tree nodes\n\t * @param {Object} obj - item data as returted by Pivot engine\n\t * @returns {Object} item data ready for parsing in Webix Tree\n\t */\n\t_toTree(obj) {\n\t\tlet item = obj.values;\n\n\t\t// server returns object\n\t\tif (!webix.isArray(item)) {\n\t\t\tlet arr = [];\n\t\t\tfor (let name in item) arr[name] = item[name];\n\t\t\titem = arr;\n\t\t}\n\n\t\titem.unshift(\"\"); //header ids start from 1\n\t\tif (obj.data) {\n\t\t\titem.open = true;\n\t\t\titem.data = obj.data.map(r => {\n\t\t\t\treturn this._toTree(r);\n\t\t\t});\n\t\t} else item.id = obj.id; //row ids\n\t\treturn item;\n\t}\n\t/**\n\t * Prepares a storage for raw data before aggregation\n\t * @param {Array} data - initial data set\n\t * @returns {Object} object with storage data and parameters\n\t */\n\tgetTable(data) {\n\t\tconst fields = this.getFields(data[0]);\n\t\tthis._state.fields = fields;\n\t\tthis._data = data = this.prepareData(data, fields);\n\n\t\treturn {\n\t\t\tid: \"webixpivot\",\n\t\t\tprepare: true,\n\t\t\tdriver: \"raw\", //or \"columns\"\n\t\t\tfields: webix.copy(fields),\n\t\t\tdata,\n\t\t};\n\t}\n\t/**\n\t * Prepares data: parse dates, values template\n\t * @param {Array} data - initial data set\n\t * @returns {Array} data ready to parse\n\t */\n\tprepareData(data, fields) {\n\t\tfields = fields.filter(field => field.prepare || field.type == \"date\");\n\n\t\tif (fields.length) {\n\t\t\tdata = data.map(item => {\n\t\t\t\tfields.forEach(field => {\n\t\t\t\t\titem[field.id] = field.prepare\n\t\t\t\t\t\t? field.prepare(item[field.id])\n\t\t\t\t\t\t: new Date(item[field.id]);\n\t\t\t\t});\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\n\t\treturn data;\n\t}\n\t/**\n\t * Gets field values\n\t * @param {string} field name\n\t * @returns {Promise} promise that resolves with field values\n\t */\n\tcollectFieldValues(field) {\n\t\tif (this._filtersHash[field])\n\t\t\treturn webix.promise.resolve(this._filtersHash[field]);\n\n\t\tconst app = this._app;\n\t\tif (app.config.externalProcessing)\n\t\t\treturn (this._filtersHash[field] = app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.collectFieldValues(field));\n\n\t\tconst fieldObj = this.getField(field);\n\n\t\tconst hash = {};\n\t\tconst values = [];\n\t\tfor (let i = 0; i < this._data.length; i++) {\n\t\t\tlet value = this._data[i][field];\n\t\t\tif (value || value === 0) {\n\t\t\t\tlet label = value;\n\n\t\t\t\tif (fieldObj.type == \"date\") value = value.valueOf();\n\n\t\t\t\tif (!hash[value]) {\n\t\t\t\t\thash[value] = true;\n\n\t\t\t\t\tif (fieldObj.predicate)\n\t\t\t\t\t\tlabel = app.config.predicates[fieldObj.predicate](label);\n\n\t\t\t\t\tvalues.push({ value, id: value, label });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._filtersHash[field] = values;\n\t\treturn webix.promise.resolve(values);\n\t}\n\t/**\n\t * Apply custom fields names and methods locale to complex math\n\t * @param {String} complex math\n\t * @returns {String} complex math with correct fields and math methods names\n\t */\n\tfixMath(math) {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\n\t\tconst fields = this._state.fields;\n\t\tconst fieldsRegex = new RegExp(\n\t\t\tfields.map(field => \"\\\\b\" + field.id + \"\\\\b(?!\\\\()\").join(\"|\"),\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst methods = this.operations;\n\t\tconst methodsRegex = new RegExp(\n\t\t\tmethods.map(method => \"\\\\b\" + method.id + \"\\\\b\\\\(\").join(\"|\"),\n\t\t\t\"g\"\n\t\t);\n\n\t\treturn math\n\t\t\t.replaceAll(fieldsRegex, id => fields.find(obj => obj.id == id).value)\n\t\t\t.replaceAll(\n\t\t\t\tmethodsRegex,\n\t\t\t\tmethod => _(method.substring(0, method.length - 1)) + \"(\"\n\t\t\t);\n\t}\n\t/**\n\t * Finds field\n\t * @param {String} field id\n\t * @returns {Object} field\n\t */\n\tgetField(id) {\n\t\treturn this._state.fields.find(obj => obj.id == id);\n\t}\n\t/**\n\t * Finds operation\n\t * @param {String} operation id\n\t * @returns {Object} operation\n\t */\n\tgetOperation(id) {\n\t\treturn this.operations.find(obj => obj.id == id);\n\t}\n\t/**\n\t * Returns columns for aggregation\n\t * @returns {Array} array of field names for columns\n\t */\n\tgetColumns() {\n\t\tconst struct = this._state.structure;\n\t\tif (this._state.mode == \"chart\" && struct.groupBy) return [struct.groupBy];\n\t\telse return struct.columns;\n\t}\n\t/**\n\t * Returns for aggregation\n\t * @returns {Array} array of field names for rows\n\t */\n\tgetRows() {\n\t\treturn this._state.mode == \"chart\" ? [] : this._state.structure.rows;\n\t}\n\t/** Sets limits for raw and output data\n\t * @returns {Object} object with limits. By default math engine uses\n\t * { rows: 10000, columns: 5000, raws: Infinity }\n\t */\n\tgetLimits() {\n\t\treturn {};\n\t}\n\t/**\n\t * Prepares table header\n\t * @param {Object} hdata - object with header config\n\t * @returns {Array} array with header lines\n\t */\n\tgetHeader(hdata) {\n\t\tconst header = hdata.data;\n\t\tconst rows = [];\n\n\t\thdata.nonEmpty.forEach((v, i) => {\n\t\t\trows.push({\n\t\t\t\tid: v + 1,\n\t\t\t\theader: header.map(h => {\n\t\t\t\t\th =\n\t\t\t\t\t\th[i] && !webix.isUndefined(h[i].text) ? h[i] : { text: h[i] || \"\" };\n\t\t\t\t\tconst op = hdata.meta[i] && hdata.meta[i].operation;\n\t\t\t\t\tif (op) h.operation = op;\n\t\t\t\t\treturn h;\n\t\t\t\t}),\n\t\t\t\tformat: hdata.meta[i] && hdata.meta[i].format,\n\t\t\t});\n\t\t});\n\n\t\treturn rows;\n\t}\n\t/**\n\t * Sets dimensions based on rows/columns from structure\n\t */\n\tsetDimensions() {\n\t\tthis._reng.resetDimensions();\n\t\tconst columns = this.getColumns();\n\t\tconst fields = columns.concat(this.getRows() || []);\n\n\t\tfor (let i = 0; i < fields.length; i++) {\n\t\t\tconst field = this.getField(fields[i]);\n\t\t\tthis._reng.addDimension({\n\t\t\t\tid: fields[i],\n\t\t\t\ttable: this._table.id,\n\t\t\t\tlabel: fields[i],\n\t\t\t\trule: {\n\t\t\t\t\tby: field.predicate ? `${field.predicate}(${fields[i]})` : fields[i],\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Prepares chart data\n\t * @param {Object} res - object with groupped data\n\t * @param {Object} result - object with aggregated data and its parameters\n\t * @returns {Array} array with chart data\n\t */\n\tgetChartData(result, header) {\n\t\tconst state = this._state;\n\t\tconst ops = state.structure.values;\n\n\t\tlet data = [];\n\t\tlet values = [];\n\n\t\tif (result.data.length) {\n\t\t\tconst chartType = state.chart.type;\n\t\t\tconst groupBy = state.structure.groupBy;\n\n\t\t\tconst first = webix.copy(result.data[0]);\n\t\t\tconst axis = groupBy ? header.data[0] : first.map(() => \"\");\n\n\t\t\tlet count = 0;\n\t\t\twhile (first.length) {\n\t\t\t\tlet item = first.splice(0, ops.length);\n\t\t\t\tif (item.length) {\n\t\t\t\t\tlet text = axis[count].text;\n\t\t\t\t\tif (text === 0) text = \"0\";\n\n\t\t\t\t\tif (chartType == \"pie\" || chartType == \"donut\") {\n\t\t\t\t\t\tfor (let i = 0; i < item.length; i++)\n\t\t\t\t\t\t\titem[i] = { value: item[i], color: ops[i].color };\n\n\t\t\t\t\t\tif (groupBy)\n\t\t\t\t\t\t\tdata.push({\n\t\t\t\t\t\t\t\ttext: text || axis[count],\n\t\t\t\t\t\t\t\tcolor: this.getValueColor(count / ops.length, true),\n\t\t\t\t\t\t\t\tdata: item,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\telse data = item;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.push(text || axis[count]);\n\t\t\t\t\t\tdata.push(item);\n\t\t\t\t\t}\n\t\t\t\t\tcount += ops.length;\n\t\t\t\t} else break;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < ops.length; i++) {\n\t\t\tconst op = ops[i];\n\n\t\t\tlet name = op.operation == \"complex\" ? op.math : op.name;\n\t\t\tname = Array.isArray(name) ? name.join(\",\") : name;\n\n\t\t\tvalues.push({\n\t\t\t\ttext: name || op.operation,\n\t\t\t\toperation: op.operation,\n\t\t\t\tcolor: op.color,\n\t\t\t});\n\t\t}\n\n\t\treturn { data, values };\n\t}\n\t/**\n\t * Gets built-in colors for chart values\n\t * @param {boolean} pieGroup - is palette for pie group (customizations)\n\t * @returns {Array} color palette\n\t */\n\tgetPalette() {\n\t\treturn [\n\t\t\t[\"#e33fc7\", \"#a244ea\", \"#476cee\", \"#36abee\", \"#58dccd\", \"#a7ee70\"],\n\t\t\t[\"#d3ee36\", \"#eed236\", \"#ee9336\", \"#ee4339\", \"#595959\", \"#b85981\"],\n\t\t\t[\"#c670b8\", \"#9984ce\", \"#b9b9e2\", \"#b0cdfa\", \"#a0e4eb\", \"#7faf1b\"],\n\t\t\t[\"#b4d9a4\", \"#f2f79a\", \"#ffaa7d\", \"#d6806f\", \"#939393\", \"#d9b0d1\"],\n\t\t\t[\"#780e3b\", \"#684da9\", \"#242464\", \"#205793\", \"#5199a4\", \"#065c27\"],\n\t\t\t[\"#54b15a\", \"#ecf125\", \"#c65000\", \"#990001\", \"#363636\", \"#800f3e\"],\n\t\t];\n\t}\n\t/**\n\t * Gets a color from the palette\n\t * @param {number} i - row number of the required value\n\t * @param {boolean} pieGroup - is palette for pie group (customizations)\n\t * @returns {string} HEX color\n\t */\n\tgetValueColor(i, pieGroup) {\n\t\tconst palette = this.getPalette(pieGroup);\n\t\tlet rowIndex = i / palette[0].length;\n\t\trowIndex = rowIndex == palette.length ? 0 : parseInt(rowIndex, 10);\n\t\tconst columnIndex = i % palette[0].length;\n\t\treturn palette[rowIndex][columnIndex];\n\t}\n\n\tclearAll() {\n\t\t// fields\n\t\tthis._app.config.fields = null;\n\t\tthis._state.fields = [];\n\t\t// structure\n\t\tthis._app.setStructure({});\n\t\t// reset aggregated data/table config\n\t\tdelete this._table;\n\t\tthis._store = this.getPivotData();\n\t\tthis._data = [];\n\t\tthis._filtersHash = {};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseExportView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tsubMenuPos: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\tborderless: true,\n\t\t\t\ttype: {\n\t\t\t\t\tsubsign: true,\n\t\t\t\t},\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\twidth: 160,\n\t\t\t\tsubmenuConfig: {\n\t\t\t\t\tpoint: false,\n\t\t\t\t\twidth: 190,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t},\n\t\t\t\tautowidth: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: this.GetData(),\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: (id, e) => this.PopupAction(id, e),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To PNG\"), id: \"png\" },\n\t\t\t{ value: _(\"To PDF\"), id: \"pdf\" },\n\t\t];\n\t}\n\t/**\n\t * Calls \"exportModule\" event for app\n\t * @param {number} id - the ID of clicked menu option\n\t */\n\tPopupAction(id) {\n\t\tthis.app.callEvent(\"exportModule\", [id]);\n\t\tthis.getRoot().hide();\n\t}\n\t/**\n\t * Returns html template menu option\n\t * @param {Object} obj - data of menu option\n\t * @returns {String} - a string with html for an option\n\t */\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\t/**\n\t * Shows menu\n\t * @param {Object} node - html node where menu should be shown\n\t */\n\tShow(node) {\n\t\tif (this.getRoot().isVisible()) return;\n\t\tthis.webix.delay(() => this.getRoot().show(node));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ExportMenu from \"./export\";\n\nexport default class BaseToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: id => this.ShowExportPopup(id),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { createState, withContext } from \"jet-restate\";\n\nexport function bind(obj, key, ctrl, view) {\n\tbindOut(obj, key, ctrl);\n\treturn bindIn(obj, key, ctrl, view);\n}\n\nfunction bindIn(obj, key, ctrl, view) {\n\tconst handler = (v, o, k, meta) => {\n\t\tif (k === \"*\") {\n\t\t\tvar els = ctrl.elements;\n\t\t\tfor (var subkey in els) {\n\t\t\t\tif (typeof v[subkey] !== \"undefined\") els[subkey].setValue(v[subkey]);\n\t\t\t}\n\t\t} else if (key === \"*\") {\n\t\t\tvar el = ctrl.elements[k];\n\t\t\tif (el && el != meta) el.setValue(v);\n\t\t} else if (meta != ctrl) ctrl.setValue(v);\n\t};\n\n\treturn view\n\t\t? view.on(obj.$changes, key, handler)\n\t\t: obj.$changes.attachEvent(key, handler);\n}\n\nfunction bindOut(obj, key, ctrl) {\n\tif (key === \"*\") {\n\t\tvar els = ctrl.elements;\n\t\tfor (var subkey in els) {\n\t\t\tif (typeof obj[subkey] !== \"undefined\") bindOut(obj, subkey, els[subkey]);\n\t\t}\n\t\treturn;\n\t}\n\n\tconst trigger = function(newValue) {\n\t\tconst oldValue = obj[key];\n\t\tif (newValue !== oldValue) {\n\t\t\tobj[key] = newValue;\n\t\t}\n\t};\n\n\tif (!ctrl.getList)\n\t\tctrl.attachEvent(\"onTimedKeyPress\", function() {\n\t\t\tconst newValue = this.getValue();\n\t\t\tif (this.config.value !== newValue) {\n\t\t\t\tthis.config.value = newValue;\n\t\t\t\tthis.callEvent(\"onChange\", [newValue]);\n\t\t\t}\n\t\t});\n\n\tctrl.attachEvent(\"onChange\", function() {\n\t\twithContext(this, () => {\n\t\t\ttrigger(this.getValue());\n\t\t});\n\t});\n}\n\nexport function track(obj) {\n\tif (!obj.$changes) obj = createState(obj);\n\n\tvar observe = function(key, ctrl) {\n\t\treturn bind(obj, key, ctrl, ctrl);\n\t};\n\n\tvar observeEnd = function(id) {\n\t\tobj.$changes.detachEvent(id);\n\t};\n\n\treturn {\n\t\tattachEvent: observe,\n\t\tdetachEvent: observeEnd,\n\t};\n}\n","webix.protoUI(\n\t{\n\t\tname: \"input-list\",\n\t\tgetValue() {\n\t\t\treturn this._value || [];\n\t\t},\n\t\tsetValue(data) {\n\t\t\tthis._value = data;\n\n\t\t\tthis.clearAll();\n\t\t\tthis.parse([].concat(data));\n\t\t},\n\t},\n\twebix.ui.list\n);\n","export const menu = \"<span class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const edit =\n\t\"<span class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const remove =\n\t\"<span class='webix_icon webix_rpt_action_remove rpi-trash-can-outline'></span>\";\n\nexport const menuRight =\n\t\"<span style='float:right' class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const editRight =\n\t\"<span style='float:right' class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const removeRight =\n\t\"<span style='float:right' class='webix_icon webix_rpt_action_remove rpi-delete'></span>\";\n\nexport const visible =\n\t\"<span class='webix_icon action-visible mdi mdi-eye'></span>\";\nexport const hidden =\n\t\"<span class='webix_icon action-hidden mdi mdi-eye-off-outline'></span>\";\n\nexport const checked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-marked-outline'></span>\";\nexport const notChecked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-blank-outline'></span>\";\n\nexport const sortAsc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-ascending'></span>\";\nexport const sortDesc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-descending'></span>\";\n\nexport const types = {\n\ttable: \"<span class='rpi-table'></span>\",\n\tchart: \"<span class='rpi-poll'></span>\",\n\theatmap: \"<span class='rpi-chart-tree'></span>\",\n};\n\nexport const empty = {\n\tmain:\n\t\t\"<svg  xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320'><path class='webix_rpt_cls1' d='M369.51,182.77c-23.18-52.39,32-103.23,13.74-148.28s-77.61-39.42-162.07-20S78.47-6.35,34.66,14.46c-29.39,14-27.27,58.82-5,107,38.95,84.29-51.86,117.32-24.38,166s118.91-.95,183.37,4.22c37.62.59,62.88,6.26,109.52,21.27C387.63,341.7,412.41,279.75,369.51,182.77Z'/><rect class='webix_rpt_cls2' x='111.53' y='226.04' width='212.47' height='0.91'/><rect class='webix_rpt_cls3' x='97' y='89.51' width='212' height='151.96'/><rect class='webix_rpt_cls4' x='67' y='159.96' width='136.33' height='81.98' rx='2'/><polygon class='webix_rpt_cls5' points='199.32 235.55 72.61 235.55 72.61 165.28 71.01 165.28 71.01 235.55 71.01 237.68 71.01 237.68 72.61 237.68 72.61 237.68 199.32 237.68 199.32 235.55'/><rect class='webix_rpt_cls6' x='84.64' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='97.47' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='110.3' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='123.14' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='135.97' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='148.8' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='161.63' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='174.46' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='187.29' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='111.53' y='94.41' width='212.47' height='132.54'/><rect class='webix_rpt_cls8' x='111.53' y='109.85' width='212.47' height='0.91'/><path class='webix_rpt_cls9' d='M111.53,94.41H324v15.44H111.53Z'/><path class='webix_rpt_cls7' d='M111.53,79H324V94.41H111.53Z'/><path class='webix_rpt_cls2' d='M324,125.28v-.91H287.68V109.84h-.91v14.53H250.45V109.84h-.91v14.53H213.22V109.84h-.9v14.53H176V109.85h-.91v14.52H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56V197H111.53v.91h63.56v13.62H111.53v.9h63.56V227H176V212.42h36.32V227h.9V212.42h36.32V227h.91V212.42h36.32V227h.91V212.42H324v-.9H287.68V197.9H324V197H287.68V183.38H324v-.91H287.68V168.85H324v-.91H287.68V154.33H324v-.91H287.68V139.8H324v-.91H287.68V125.28Zm-74.46,0v13.61H213.22V125.28Zm-36.32,57.19V168.85h36.32v13.62Zm36.32.91V197H213.22V183.38Zm-36.32-15.44V154.33h36.32v13.61Zm0-14.52V139.8h36.32v13.62ZM176,125.28h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32V197H176Zm0,28.14V197.9h36.32v13.62Zm37.22,0V197.9h36.32v13.62Zm73.55,0H250.45V197.9h36.32Zm0-14.53H250.45V183.38h36.32Zm0-14.52H250.45V168.85h36.32Zm0-14.53H250.45V154.33h36.32Zm0-14.52H250.45V139.8h36.32Zm0-14.53H250.45V125.28h36.32Z'/><rect class='webix_rpt_cls2' x='175.09' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='212.32' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='249.54' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='286.77' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls9' x='118.79' y='84.43' width='21.79' height='5.45'/><rect class='webix_rpt_cls9' x='250.45' y='84.43' width='66.28' height='5.45'/></svg>\",\n\talt:\n\t\t\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320' fill='none'><g clip-path='url(#clip0_4706_8889)'><path d='M369.502 182.763C346.322 130.373 401.502 79.5332 383.242 34.4832C364.982 -10.5668 305.632 -4.93676 221.172 14.4832C136.712 33.9032 78.4622 -6.35676 34.6522 14.4532C5.26223 28.4532 7.38222 73.2732 29.6522 121.453C68.6022 205.743 -22.2078 238.773 5.27222 287.453C32.7522 336.133 124.182 286.503 188.642 291.673C226.262 292.263 251.522 297.933 298.162 312.943C387.622 341.693 412.402 279.743 369.502 182.763Z' class='webix_rpt_cls1'/><path d='M112.545 76.0479C112.545 74.9421 113.475 74.0457 114.622 74.0457H215.368L256.913 114.09V251.238C256.913 252.344 255.983 253.241 254.836 253.241H114.622C113.475 253.241 112.545 252.344 112.545 251.238V76.0479Z' class='webix_rpt_cls6'/><path d='M128.322 60.5902C128.322 59.4844 129.252 58.588 130.399 58.588H231.145L272.69 98.6313V235.781C272.69 236.887 271.76 237.783 270.612 237.783H130.399C129.252 237.783 128.322 236.887 128.322 235.781V60.5902Z' class='webix_rpt_cls4'/><path fill-rule='evenodd' clip-rule='evenodd' d='M130.399 59.588C129.769 59.588 129.322 60.0708 129.322 60.5902V235.781C129.322 236.3 129.769 236.783 130.399 236.783H270.612C271.243 236.783 271.69 236.299 271.69 235.781V99.0563L230.742 59.588H130.399ZM231.145 58.588H130.399C129.252 58.588 128.322 59.4844 128.322 60.5902V235.781C128.322 236.887 129.252 237.783 130.399 237.783H270.612C271.76 237.783 272.69 236.887 272.69 235.781V98.6313L231.145 58.588Z' class='webix_rpt_cls3'/><path d='M231.146 96.6297V58.588L272.69 98.6313H233.222C232.075 98.6313 231.146 97.7353 231.146 96.6297Z' class='webix_rpt_cls3'/><path d='M184.729 74.0457H143.184C142.323 74.0457 141.626 74.718 141.626 75.5473V75.5473C141.626 76.3766 142.323 77.0489 143.184 77.0489H184.729C185.589 77.0489 186.287 76.3766 186.287 75.5473C186.287 74.718 185.589 74.0457 184.729 74.0457Z' class='webix_rpt_cls2'/><path d='M184.729 87.0457H143.184C142.323 87.0457 141.626 87.718 141.626 88.5473V88.5473C141.626 89.3766 142.323 90.0489 143.184 90.0489H184.729C185.589 90.0489 186.287 89.3766 186.287 88.5473C186.287 87.718 185.589 87.0457 184.729 87.0457Z' class='webix_rpt_cls2'/><path d='M222.443 101H143.557C142.697 101 142 101.672 142 102.5C142 103.328 142.697 104 143.557 104H222.443C223.303 104 224 103.328 224 102.5C224 101.672 223.303 101 222.443 101Z' class='webix_rpt_cls2'/><path d='M222.443 115H143.557C142.697 115 142 115.672 142 116.5V116.5C142 117.328 142.697 118 143.557 118H222.443C223.303 118 224 117.328 224 116.5C224 115.672 223.303 115 222.443 115Z' class='webix_rpt_cls2'/><path fill-rule='evenodd' clip-rule='evenodd' d='M218 223C240.644 223 259 204.644 259 182C259 159.356 240.644 141 218 141C195.356 141 177 159.356 177 182C177 204.644 195.356 223 218 223ZM218 227C242.853 227 263 206.853 263 182C263 157.147 242.853 137 218 137C193.147 137 173 157.147 173 182C173 206.853 193.147 227 218 227Z' class='webix_rpt_cls4'/><path d='M219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134ZM219.686 148.057C202.114 148.057 188.057 162.114 188.057 179.686C188.057 197.257 202.114 211.314 219.686 211.314C237.257 211.314 251.314 197.257 251.314 179.686C251.314 162.114 237.257 148.057 219.686 148.057Z' class='webix_rpt_cls5'/><path fill-rule='evenodd' clip-rule='evenodd' d='M253.047 209.471L253.645 208.769C260.316 200.928 264.371 190.754 264.371 179.686C264.371 167.834 259.663 156.468 251.283 148.088C242.903 139.708 231.537 135 219.686 135C207.834 135 196.468 139.708 188.088 148.088C179.708 156.468 175 167.834 175 179.686C175 191.537 179.708 202.903 188.088 211.283C196.468 219.663 207.834 224.371 219.686 224.371C230.754 224.371 240.928 220.316 248.769 213.645L249.471 213.047L252.314 215.89V221.443L286.457 255.586L295.586 246.457L261.443 212.314H255.89L253.047 209.471ZM261.857 211.314L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857ZM187.057 179.686C187.057 161.562 201.562 147.057 219.686 147.057C237.809 147.057 252.314 161.562 252.314 179.686C252.314 197.809 237.809 212.314 219.686 212.314C201.562 212.314 187.057 197.809 187.057 179.686ZM188.057 179.686C188.057 162.114 202.114 148.057 219.686 148.057C237.257 148.057 251.314 162.114 251.314 179.686C251.314 197.257 237.257 211.314 219.686 211.314C202.114 211.314 188.057 197.257 188.057 179.686Z' class='webix_rpt_cls3'/><path d='M236.083 167.231L232.852 164L220.042 176.81L207.231 164L204 167.231L216.81 180.042L204 192.852L207.231 196.083L220.042 183.273L232.852 196.083L236.083 192.852L223.273 180.042L236.083 167.231Z' class='webix_rpt_cls3'/></g><defs><clipPath id='clip0_4706_8889'><rect width='390' height='320' class='webix_rpt_cls4'/></clipPath></defs></svg>\",\n};\n","/*\n@license\nWebix Query v.10.0.9\nThis software is covered by Webix Commercial License.\nUsage without proper license is prohibited.\n(c) XB Software Ltd.\n*/\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = global || self, factory(global.query = {}));\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\n\n    var NavigationBlocked = (function () {\n        function NavigationBlocked() {\n        }\n        return NavigationBlocked;\n    }());\n    var JetBase = (function () {\n        function JetBase(webix, config) {\n            this.webixJet = true;\n            this.webix = webix;\n            this._events = [];\n            this._subs = {};\n            this._data = {};\n            if (config && config.params)\n                webix.extend(this._data, config.params);\n        }\n        JetBase.prototype.getRoot = function () {\n            return this._root;\n        };\n        JetBase.prototype.destructor = function () {\n            this._detachEvents();\n            this._destroySubs();\n            this._events = this._container = this.app = this._parent = this._root = null;\n        };\n        JetBase.prototype.setParam = function (id, value, url) {\n            if (this._data[id] !== value) {\n                this._data[id] = value;\n                this._segment.update(id, value, 0);\n                if (url) {\n                    return this.show(null);\n                }\n            }\n        };\n        JetBase.prototype.getParam = function (id, parent) {\n            var value = this._data[id];\n            if (typeof value !== \"undefined\" || !parent) {\n                return value;\n            }\n            var view = this.getParentView();\n            if (view) {\n                return view.getParam(id, parent);\n            }\n        };\n        JetBase.prototype.getUrl = function () {\n            return this._segment.suburl();\n        };\n        JetBase.prototype.getUrlString = function () {\n            return this._segment.toString();\n        };\n        JetBase.prototype.getParentView = function () {\n            return this._parent;\n        };\n        JetBase.prototype.$$ = function (id) {\n            if (typeof id === \"string\") {\n                var root_1 = this.getRoot();\n                return root_1.queryView((function (obj) { return (obj.config.id === id || obj.config.localId === id) &&\n                    (obj.$scope === root_1.$scope); }), \"self\");\n            }\n            else {\n                return id;\n            }\n        };\n        JetBase.prototype.on = function (obj, name, code) {\n            var id = obj.attachEvent(name, code);\n            this._events.push({ obj: obj, id: id });\n            return id;\n        };\n        JetBase.prototype.contains = function (view) {\n            for (var key in this._subs) {\n                var kid = this._subs[key].view;\n                if (kid === view || kid.contains(view)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        JetBase.prototype.getSubView = function (name) {\n            var sub = this.getSubViewInfo(name);\n            if (sub) {\n                return sub.subview.view;\n            }\n        };\n        JetBase.prototype.getSubViewInfo = function (name) {\n            var sub = this._subs[name || \"default\"];\n            if (sub) {\n                return { subview: sub, parent: this };\n            }\n            if (name === \"_top\") {\n                this._subs[name] = { url: \"\", id: null, popup: true };\n                return this.getSubViewInfo(name);\n            }\n            if (this._parent) {\n                return this._parent.getSubViewInfo(name);\n            }\n            return null;\n        };\n        JetBase.prototype._detachEvents = function () {\n            var events = this._events;\n            for (var i = events.length - 1; i >= 0; i--) {\n                events[i].obj.detachEvent(events[i].id);\n            }\n        };\n        JetBase.prototype._destroySubs = function () {\n            for (var key in this._subs) {\n                var subView = this._subs[key].view;\n                if (subView) {\n                    subView.destructor();\n                }\n            }\n            this._subs = {};\n        };\n        JetBase.prototype._init_url_data = function () {\n            var url = this._segment.current();\n            this._data = {};\n            this.webix.extend(this._data, url.params, true);\n        };\n        JetBase.prototype._getDefaultSub = function () {\n            if (this._subs.default) {\n                return this._subs.default;\n            }\n            for (var key in this._subs) {\n                var sub = this._subs[key];\n                if (!sub.branch && sub.view && key !== \"_top\") {\n                    var child = sub.view._getDefaultSub();\n                    if (child) {\n                        return child;\n                    }\n                }\n            }\n        };\n        JetBase.prototype._routed_view = function () {\n            var parent = this.getParentView();\n            if (!parent) {\n                return true;\n            }\n            var sub = parent._getDefaultSub();\n            if (!sub && sub !== this) {\n                return false;\n            }\n            return parent._routed_view();\n        };\n        return JetBase;\n    }());\n    function parse(url) {\n        if (url[0] === \"/\") {\n            url = url.substr(1);\n        }\n        var parts = url.split(\"/\");\n        var chunks = [];\n        for (var i = 0; i < parts.length; i++) {\n            var test = parts[i];\n            var result = {};\n            var pos = test.indexOf(\":\");\n            if (pos === -1) {\n                pos = test.indexOf(\"?\");\n            }\n            if (pos !== -1) {\n                var params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\n                for (var _i = 0, params_1 = params; _i < params_1.length; _i++) {\n                    var param = params_1[_i];\n                    var dchunk = param.split(\"=\");\n                    result[dchunk[0]] = decodeURIComponent(dchunk[1]);\n                }\n            }\n            chunks[i] = {\n                page: (pos > -1 ? test.substr(0, pos) : test),\n                params: result,\n                isNew: true\n            };\n        }\n        return chunks;\n    }\n    function url2str(stack) {\n        var url = [];\n        for (var _i = 0, stack_1 = stack; _i < stack_1.length; _i++) {\n            var chunk = stack_1[_i];\n            url.push(\"/\" + chunk.page);\n            var params = obj2str(chunk.params);\n            if (params) {\n                url.push(\"?\" + params);\n            }\n        }\n        return url.join(\"\");\n    }\n    function obj2str(obj) {\n        var str = [];\n        for (var key in obj) {\n            if (typeof obj[key] === \"object\")\n                continue;\n            if (str.length) {\n                str.push(\"&\");\n            }\n            str.push(key + \"=\" + encodeURIComponent(obj[key]));\n        }\n        return str.join(\"\");\n    }\n    var Route = (function () {\n        function Route(route, index) {\n            this._next = 1;\n            if (typeof route === \"string\") {\n                this.route = {\n                    url: parse(route),\n                    path: route\n                };\n            }\n            else {\n                this.route = route;\n            }\n            this.index = index;\n        }\n        Route.prototype.current = function () {\n            return this.route.url[this.index];\n        };\n        Route.prototype.next = function () {\n            return this.route.url[this.index + this._next];\n        };\n        Route.prototype.suburl = function () {\n            return this.route.url.slice(this.index);\n        };\n        Route.prototype.shift = function (params) {\n            var route = new Route(this.route, this.index + this._next);\n            route.setParams(route.route.url, params, route.index);\n            return route;\n        };\n        Route.prototype.setParams = function (url, params, index) {\n            if (params) {\n                var old = url[index].params;\n                for (var key in params)\n                    old[key] = params[key];\n            }\n        };\n        Route.prototype.refresh = function () {\n            var url = this.route.url;\n            for (var i = this.index + 1; i < url.length; i++) {\n                url[i].isNew = true;\n            }\n        };\n        Route.prototype.toString = function () {\n            var str = url2str(this.suburl());\n            return str ? str.substr(1) : \"\";\n        };\n        Route.prototype._join = function (path, kids) {\n            var url = this.route.url;\n            if (path === null) {\n                return url;\n            }\n            var old = this.route.url;\n            var reset = true;\n            url = old.slice(0, this.index + (kids ? this._next : 0));\n            if (path) {\n                url = url.concat(parse(path));\n                for (var i = 0; i < url.length; i++) {\n                    if (old[i]) {\n                        url[i].view = old[i].view;\n                    }\n                    if (reset && old[i] && url[i].page === old[i].page) {\n                        url[i].isNew = false;\n                    }\n                    else if (url[i].isNew) {\n                        reset = false;\n                    }\n                }\n            }\n            return url;\n        };\n        Route.prototype.append = function (path) {\n            var url = this._join(path, true);\n            this.route.path = url2str(url);\n            this.route.url = url;\n            return this.route.path;\n        };\n        Route.prototype.show = function (path, view, kids) {\n            var _this = this;\n            var url = this._join(path.url, kids);\n            this.setParams(url, path.params, this.index + (kids ? this._next : 0));\n            return new Promise(function (res, rej) {\n                var redirect = url2str(url);\n                var obj = {\n                    url: url,\n                    redirect: redirect,\n                    confirm: Promise.resolve()\n                };\n                var app = view ? view.app : null;\n                if (app) {\n                    var result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n                    if (!result) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                }\n                obj.confirm.catch(function (err) { return rej(err); }).then(function () {\n                    if (obj.redirect === null) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    if (obj.redirect !== redirect) {\n                        app.show(obj.redirect);\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    _this.route.path = redirect;\n                    _this.route.url = url;\n                    res();\n                });\n            });\n        };\n        Route.prototype.size = function (n) {\n            this._next = n;\n        };\n        Route.prototype.split = function () {\n            var route = {\n                url: this.route.url.slice(this.index + 1),\n                path: \"\"\n            };\n            if (route.url.length) {\n                route.path = url2str(route.url);\n            }\n            return new Route(route, 0);\n        };\n        Route.prototype.update = function (name, value, index) {\n            var chunk = this.route.url[this.index + (index || 0)];\n            if (!chunk) {\n                this.route.url.push({ page: \"\", params: {} });\n                return this.update(name, value, index);\n            }\n            if (name === \"\") {\n                chunk.page = value;\n            }\n            else {\n                chunk.params[name] = value;\n            }\n            this.route.path = url2str(this.route.url);\n        };\n        return Route;\n    }());\n    var JetView = (function (_super) {\n        __extends(JetView, _super);\n        function JetView(app, config) {\n            var _this = _super.call(this, app.webix) || this;\n            _this.app = app;\n            _this._children = [];\n            return _this;\n        }\n        JetView.prototype.ui = function (ui, config) {\n            config = config || {};\n            var container = config.container || ui.container;\n            var jetview = this.app.createView(ui);\n            this._children.push(jetview);\n            jetview.render(container, this._segment, this);\n            if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\n                return jetview;\n            }\n            else {\n                return jetview.getRoot();\n            }\n        };\n        JetView.prototype.show = function (path, config) {\n            config = config || {};\n            if (typeof path === \"object\") {\n                for (var key in path) {\n                    this.setParam(key, path[key]);\n                }\n                path = null;\n            }\n            else {\n                if (path.substr(0, 1) === \"/\") {\n                    return this.app.show(path, config);\n                }\n                if (path.indexOf(\"./\") === 0) {\n                    path = path.substr(2);\n                }\n                if (path.indexOf(\"../\") === 0) {\n                    var parent_1 = this.getParentView();\n                    if (parent_1) {\n                        return parent_1.show(path.substr(3), config);\n                    }\n                    else {\n                        return this.app.show(\"/\" + path.substr(3));\n                    }\n                }\n                var sub = this.getSubViewInfo(config.target);\n                if (sub) {\n                    if (sub.parent !== this) {\n                        return sub.parent.show(path, config);\n                    }\n                    else if (config.target && config.target !== \"default\") {\n                        return this._renderFrameLock(config.target, sub.subview, {\n                            url: path,\n                            params: config.params,\n                        });\n                    }\n                }\n                else {\n                    if (path) {\n                        return this.app.show(\"/\" + path, config);\n                    }\n                }\n            }\n            return this._show(this._segment, { url: path, params: config.params }, this);\n        };\n        JetView.prototype._show = function (segment, path, view) {\n            var _this = this;\n            return segment.show(path, view, true).then(function () {\n                _this._init_url_data();\n                return _this._urlChange();\n            }).then(function () {\n                if (segment.route.linkRouter) {\n                    _this.app.getRouter().set(segment.route.path, { silent: true });\n                    _this.app.callEvent(\"app:route\", [segment.route.path]);\n                }\n            });\n        };\n        JetView.prototype.init = function (_$view, _$) {\n        };\n        JetView.prototype.ready = function (_$view, _$url) {\n        };\n        JetView.prototype.config = function () {\n            this.app.webix.message(\"View:Config is not implemented\");\n        };\n        JetView.prototype.urlChange = function (_$view, _$url) {\n        };\n        JetView.prototype.destroy = function () {\n        };\n        JetView.prototype.destructor = function () {\n            this.destroy();\n            this._destroyKids();\n            if (this._root) {\n                this._root.destructor();\n                _super.prototype.destructor.call(this);\n            }\n        };\n        JetView.prototype.use = function (plugin, config) {\n            plugin(this.app, this, config);\n        };\n        JetView.prototype.refresh = function () {\n            var url = this.getUrl();\n            this.destroy();\n            this._destroyKids();\n            this._destroySubs();\n            this._detachEvents();\n            if (this._container.tagName) {\n                this._root.destructor();\n            }\n            this._segment.refresh();\n            return this._render(this._segment);\n        };\n        JetView.prototype.render = function (root, url, parent) {\n            var _this = this;\n            if (typeof url === \"string\") {\n                url = new Route(url, 0);\n            }\n            this._segment = url;\n            this._parent = parent;\n            this._init_url_data();\n            root = root || document.body;\n            var _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n            if (this._container !== _container) {\n                this._container = _container;\n                return this._render(url);\n            }\n            else {\n                return this._urlChange().then(function () { return _this.getRoot(); });\n            }\n        };\n        JetView.prototype._render = function (url) {\n            var _this = this;\n            var config = this.config();\n            if (config.then) {\n                return config.then(function (cfg) { return _this._render_final(cfg, url); });\n            }\n            else {\n                return this._render_final(config, url);\n            }\n        };\n        JetView.prototype._render_final = function (config, url) {\n            var _this = this;\n            var slot = null;\n            var container = null;\n            var show = false;\n            if (!this._container.tagName) {\n                slot = this._container;\n                if (slot.popup) {\n                    container = document.body;\n                    show = true;\n                }\n                else {\n                    container = this.webix.$$(slot.id);\n                }\n            }\n            else {\n                container = this._container;\n            }\n            if (!this.app || !container) {\n                return Promise.reject(null);\n            }\n            var response;\n            var current = this._segment.current();\n            var result = { ui: {} };\n            this.app.copyConfig(config, result.ui, this._subs);\n            this.app.callEvent(\"app:render\", [this, url, result]);\n            result.ui.$scope = this;\n            if (!slot && current.isNew && current.view) {\n                current.view.destructor();\n            }\n            try {\n                if (slot && !show) {\n                    var oldui = container;\n                    var parent_2 = oldui.getParentView();\n                    if (parent_2 && parent_2.name === \"multiview\" && !result.ui.id) {\n                        result.ui.id = oldui.config.id;\n                    }\n                }\n                this._root = this.app.webix.ui(result.ui, container);\n                var asWin = this._root;\n                if (show && asWin.setPosition && !asWin.isVisible()) {\n                    asWin.show();\n                }\n                if (slot) {\n                    if (slot.view && slot.view !== this && slot.view !== this.app) {\n                        slot.view.destructor();\n                    }\n                    slot.id = this._root.config.id;\n                    if (this.getParentView() || !this.app.app)\n                        slot.view = this;\n                    else {\n                        slot.view = this.app;\n                    }\n                }\n                if (current.isNew) {\n                    current.view = this;\n                    current.isNew = false;\n                }\n                response = Promise.resolve(this._init(this._root, url)).then(function () {\n                    return _this._urlChange().then(function () {\n                        _this._initUrl = null;\n                        return _this.ready(_this._root, url.suburl());\n                    });\n                });\n            }\n            catch (e) {\n                response = Promise.reject(e);\n            }\n            return response.catch(function (err) { return _this._initError(_this, err); });\n        };\n        JetView.prototype._init = function (view, url) {\n            return this.init(view, url.suburl());\n        };\n        JetView.prototype._urlChange = function () {\n            var _this = this;\n            this.app.callEvent(\"app:urlchange\", [this, this._segment]);\n            var waits = [];\n            for (var key in this._subs) {\n                var frame = this._subs[key];\n                var wait = this._renderFrameLock(key, frame, null);\n                if (wait) {\n                    waits.push(wait);\n                }\n            }\n            return Promise.all(waits).then(function () {\n                return _this.urlChange(_this._root, _this._segment.suburl());\n            });\n        };\n        JetView.prototype._renderFrameLock = function (key, frame, path) {\n            if (!frame.lock) {\n                var lock = this._renderFrame(key, frame, path);\n                if (lock) {\n                    frame.lock = lock.then(function () { return frame.lock = null; }, function () { return frame.lock = null; });\n                }\n            }\n            return frame.lock;\n        };\n        JetView.prototype._renderFrame = function (key, frame, path) {\n            var _this = this;\n            if (key === \"default\") {\n                if (this._segment.next()) {\n                    var params = path ? path.params : null;\n                    if (frame.params) {\n                        params = this.webix.extend(params || {}, frame.params);\n                    }\n                    return this._createSubView(frame, this._segment.shift(params));\n                }\n                else if (frame.view && frame.popup) {\n                    frame.view.destructor();\n                    frame.view = null;\n                }\n            }\n            if (path !== null) {\n                frame.url = path.url;\n                if (frame.params) {\n                    path.params = this.webix.extend(path.params || {}, frame.params);\n                }\n            }\n            if (frame.route) {\n                if (path !== null) {\n                    return frame.route.show(path, frame.view).then(function () {\n                        return _this._createSubView(frame, frame.route);\n                    });\n                }\n                if (frame.branch) {\n                    return;\n                }\n            }\n            var view = frame.view;\n            if (!view && frame.url) {\n                if (typeof frame.url === \"string\") {\n                    frame.route = new Route(frame.url, 0);\n                    if (path)\n                        frame.route.setParams(frame.route.route.url, path.params, 0);\n                    if (frame.params)\n                        frame.route.setParams(frame.route.route.url, frame.params, 0);\n                    return this._createSubView(frame, frame.route);\n                }\n                else {\n                    if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\n                        view = new (this.app._override(frame.url))(this.app, \"\");\n                    }\n                    if (!view) {\n                        view = frame.url;\n                    }\n                }\n            }\n            if (view) {\n                return view.render(frame, (frame.route || this._segment), this);\n            }\n        };\n        JetView.prototype._initError = function (view, err) {\n            if (this.app) {\n                this.app.error(\"app:error:initview\", [err, view]);\n            }\n            return true;\n        };\n        JetView.prototype._createSubView = function (sub, suburl) {\n            var _this = this;\n            return this.app.createFromURL(suburl.current()).then(function (view) {\n                return view.render(sub, suburl, _this);\n            });\n        };\n        JetView.prototype._destroyKids = function () {\n            var uis = this._children;\n            for (var i = uis.length - 1; i >= 0; i--) {\n                if (uis[i] && uis[i].destructor) {\n                    uis[i].destructor();\n                }\n            }\n            this._children = [];\n        };\n        return JetView;\n    }(JetBase));\n    var JetViewRaw = (function (_super) {\n        __extends(JetViewRaw, _super);\n        function JetViewRaw(app, config) {\n            var _this = _super.call(this, app, config) || this;\n            _this._ui = config.ui;\n            return _this;\n        }\n        JetViewRaw.prototype.config = function () {\n            return this._ui;\n        };\n        return JetViewRaw;\n    }(JetView));\n    var SubRouter = (function () {\n        function SubRouter(cb, config, app) {\n            this.path = \"\";\n            this.app = app;\n        }\n        SubRouter.prototype.set = function (path, config) {\n            this.path = path;\n            var a = this.app;\n            a.app.getRouter().set(a._segment.append(this.path), { silent: true });\n        };\n        SubRouter.prototype.get = function () {\n            return this.path;\n        };\n        return SubRouter;\n    }());\n    var _once = true;\n    var JetAppBase = (function (_super) {\n        __extends(JetAppBase, _super);\n        function JetAppBase(config) {\n            var _this = this;\n            var webix = (config || {}).webix || window.webix;\n            config = webix.extend({\n                name: \"App\",\n                version: \"1.0\",\n                start: \"/home\"\n            }, config, true);\n            _this = _super.call(this, webix, config) || this;\n            _this.config = config;\n            _this.app = _this.config.app;\n            _this.ready = Promise.resolve();\n            _this._services = {};\n            _this.webix.extend(_this, _this.webix.EventSystem);\n            return _this;\n        }\n        JetAppBase.prototype.getUrl = function () {\n            return this._subSegment.suburl();\n        };\n        JetAppBase.prototype.getUrlString = function () {\n            return this._subSegment.toString();\n        };\n        JetAppBase.prototype.getService = function (name) {\n            var obj = this._services[name];\n            if (typeof obj === \"function\") {\n                obj = this._services[name] = obj(this);\n            }\n            return obj;\n        };\n        JetAppBase.prototype.setService = function (name, handler) {\n            this._services[name] = handler;\n        };\n        JetAppBase.prototype.destructor = function () {\n            this.getSubView().destructor();\n            _super.prototype.destructor.call(this);\n        };\n        JetAppBase.prototype.copyConfig = function (obj, target, config) {\n            if (obj instanceof JetBase ||\n                (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\n                obj = { $subview: obj };\n            }\n            if (typeof obj.$subview != \"undefined\") {\n                return this.addSubView(obj, target, config);\n            }\n            var isArray = obj instanceof Array;\n            target = target || (isArray ? [] : {});\n            for (var method in obj) {\n                var point = obj[method];\n                if (typeof point === \"function\" && point.prototype instanceof JetBase) {\n                    point = { $subview: point };\n                }\n                if (point && typeof point === \"object\" &&\n                    !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n                    if (point instanceof Date) {\n                        target[method] = new Date(point);\n                    }\n                    else {\n                        var copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\n                        if (copy !== null) {\n                            if (isArray)\n                                target.push(copy);\n                            else\n                                target[method] = copy;\n                        }\n                    }\n                }\n                else {\n                    target[method] = point;\n                }\n            }\n            return target;\n        };\n        JetAppBase.prototype.getRouter = function () {\n            return this.$router;\n        };\n        JetAppBase.prototype.clickHandler = function (e, target) {\n            if (e) {\n                target = target || (e.target || e.srcElement);\n                if (target && target.getAttribute) {\n                    var trigger_1 = target.getAttribute(\"trigger\");\n                    if (trigger_1) {\n                        this._forView(target, function (view) { return view.app.trigger(trigger_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                    var route_1 = target.getAttribute(\"route\");\n                    if (route_1) {\n                        this._forView(target, function (view) { return view.show(route_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                }\n            }\n            var parent = target.parentNode;\n            if (parent) {\n                this.clickHandler(e, parent);\n            }\n        };\n        JetAppBase.prototype.getRoot = function () {\n            return this.getSubView().getRoot();\n        };\n        JetAppBase.prototype.refresh = function () {\n            var _this = this;\n            if (!this._subSegment) {\n                return Promise.resolve(null);\n            }\n            return this.getSubView().refresh().then(function (view) {\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return view;\n            });\n        };\n        JetAppBase.prototype.loadView = function (url) {\n            var _this = this;\n            var views = this.config.views;\n            var result = null;\n            if (url === \"\") {\n                return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\n            }\n            try {\n                if (views) {\n                    if (typeof views === \"function\") {\n                        result = views(url);\n                    }\n                    else {\n                        result = views[url];\n                    }\n                    if (typeof result === \"string\") {\n                        url = result;\n                        result = null;\n                    }\n                }\n                if (!result) {\n                    if (url === \"_hidden\") {\n                        result = { hidden: true };\n                    }\n                    else if (url === \"_blank\") {\n                        result = {};\n                    }\n                    else {\n                        url = url.replace(/\\./g, \"/\");\n                        result = this.require(\"jet-views\", url);\n                    }\n                }\n            }\n            catch (e) {\n                result = this._loadError(url, e);\n            }\n            if (!result.then) {\n                result = Promise.resolve(result);\n            }\n            result = result\n                .then(function (module) { return module.__esModule ? module.default : module; })\n                .catch(function (err) { return _this._loadError(url, err); });\n            return result;\n        };\n        JetAppBase.prototype._forView = function (target, handler) {\n            var view = this.webix.$$(target);\n            if (view) {\n                handler(view.$scope);\n            }\n        };\n        JetAppBase.prototype._loadViewDynamic = function (url) {\n            return null;\n        };\n        JetAppBase.prototype.createFromURL = function (chunk) {\n            var _this = this;\n            var view;\n            if (chunk.isNew || !chunk.view) {\n                view = this.loadView(chunk.page)\n                    .then(function (ui) { return _this.createView(ui, name, chunk.params); });\n            }\n            else {\n                view = Promise.resolve(chunk.view);\n            }\n            return view;\n        };\n        JetAppBase.prototype._override = function (ui) {\n            var over = this.config.override;\n            if (over) {\n                var dv = void 0;\n                while (ui) {\n                    dv = ui;\n                    ui = over.get(ui);\n                }\n                return dv;\n            }\n            return ui;\n        };\n        JetAppBase.prototype.createView = function (ui, name, params) {\n            ui = this._override(ui);\n            var obj;\n            if (typeof ui === \"function\") {\n                if (ui.prototype instanceof JetAppBase) {\n                    return new ui({ app: this, name: name, params: params, router: SubRouter });\n                }\n                else if (ui.prototype instanceof JetBase) {\n                    return new ui(this, { name: name, params: params });\n                }\n                else {\n                    ui = ui(this);\n                }\n            }\n            if (ui instanceof JetBase) {\n                obj = ui;\n            }\n            else {\n                obj = new JetViewRaw(this, { name: name, ui: ui });\n            }\n            return obj;\n        };\n        JetAppBase.prototype.show = function (url, config) {\n            if (url && this.app && url.indexOf(\"//\") == 0)\n                return this.app.show(url.substr(1), config);\n            return this.render(this._container, url || this.config.start, config);\n        };\n        JetAppBase.prototype.trigger = function (name) {\n            var rest = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                rest[_i - 1] = arguments[_i];\n            }\n            this.apply(name, rest);\n        };\n        JetAppBase.prototype.apply = function (name, data) {\n            this.callEvent(name, data);\n        };\n        JetAppBase.prototype.action = function (name) {\n            return this.webix.bind(function () {\n                var rest = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    rest[_i] = arguments[_i];\n                }\n                this.apply(name, rest);\n            }, this);\n        };\n        JetAppBase.prototype.on = function (name, handler) {\n            this.attachEvent(name, handler);\n        };\n        JetAppBase.prototype.use = function (plugin, config) {\n            plugin(this, null, config);\n        };\n        JetAppBase.prototype.error = function (name, er) {\n            this.callEvent(name, er);\n            this.callEvent(\"app:error\", er);\n            if (this.config.debug) {\n                for (var i = 0; i < er.length; i++) {\n                    console.error(er[i]);\n                    if (er[i] instanceof Error) {\n                        var text = er[i].message;\n                        if (text.indexOf(\"Module build failed\") === 0) {\n                            text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\n                            document.body.innerHTML = \"<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>\" + text + \"</pre>\";\n                        }\n                        else {\n                            text += \"<br><br>Check console for more details\";\n                            this.webix.message({ type: \"error\", text: text, expire: -1 });\n                        }\n                    }\n                }\n                debugger;\n            }\n        };\n        JetAppBase.prototype.render = function (root, url, config) {\n            var _this = this;\n            this._container = (typeof root === \"string\") ?\n                this.webix.toNode(root) :\n                (root || document.body);\n            var firstInit = !this.$router;\n            var path = null;\n            if (firstInit) {\n                if (_once && \"tagName\" in this._container) {\n                    this.webix.event(document.body, \"click\", function (e) { return _this.clickHandler(e); });\n                    _once = false;\n                }\n                if (typeof url === \"string\") {\n                    url = new Route(url, 0);\n                }\n                this._subSegment = this._first_start(url);\n                this._subSegment.route.linkRouter = true;\n            }\n            else {\n                if (typeof url === \"string\") {\n                    path = url;\n                }\n                else {\n                    if (this.app) {\n                        path = url.split().route.path || this.config.start;\n                    }\n                    else {\n                        path = url.toString();\n                    }\n                }\n            }\n            var params = config ? config.params : this.config.params || null;\n            var top = this.getSubView();\n            var segment = this._subSegment;\n            var ready = segment\n                .show({ url: path, params: params }, top)\n                .then(function () { return _this.createFromURL(segment.current()); })\n                .then(function (view) { return view.render(root, segment); })\n                .then(function (base) {\n                _this.$router.set(segment.route.path, { silent: true });\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return base;\n            });\n            this.ready = this.ready.then(function () { return ready; });\n            return ready;\n        };\n        JetAppBase.prototype.getSubView = function () {\n            if (this._subSegment) {\n                var view = this._subSegment.current().view;\n                if (view)\n                    return view;\n            }\n            return new JetView(this, {});\n        };\n        JetAppBase.prototype.require = function (type, url) { return null; };\n        JetAppBase.prototype._first_start = function (route) {\n            var _this = this;\n            this._segment = route;\n            var cb = function (a) { return setTimeout(function () {\n                _this.show(a).catch(function (e) {\n                    if (!(e instanceof NavigationBlocked))\n                        throw e;\n                });\n            }, 1); };\n            this.$router = new (this.config.router)(cb, this.config, this);\n            if (this._container === document.body && this.config.animation !== false) {\n                var node_1 = this._container;\n                this.webix.html.addCss(node_1, \"webixappstart\");\n                setTimeout(function () {\n                    _this.webix.html.removeCss(node_1, \"webixappstart\");\n                    _this.webix.html.addCss(node_1, \"webixapp\");\n                }, 10);\n            }\n            if (!route) {\n                var urlString = this.$router.get();\n                if (!urlString) {\n                    urlString = this.config.start;\n                    this.$router.set(urlString, { silent: true });\n                }\n                route = new Route(urlString, 0);\n            }\n            else if (this.app) {\n                var now = route.current().view;\n                route.current().view = this;\n                if (route.next()) {\n                    route.refresh();\n                    route = route.split();\n                }\n                else {\n                    route = new Route(this.config.start, 0);\n                }\n                route.current().view = now;\n            }\n            return route;\n        };\n        JetAppBase.prototype._loadError = function (url, err) {\n            this.error(\"app:error:resolve\", [err, url]);\n            return { template: \" \" };\n        };\n        JetAppBase.prototype.addSubView = function (obj, target, config) {\n            var url = obj.$subview !== true ? obj.$subview : null;\n            var name = obj.name || (url ? this.webix.uid() : \"default\");\n            target.id = obj.id || \"s\" + this.webix.uid();\n            var view = config[name] = {\n                id: target.id,\n                url: url,\n                branch: obj.branch,\n                popup: obj.popup,\n                params: obj.params\n            };\n            return view.popup ? null : target;\n        };\n        return JetAppBase;\n    }(JetBase));\n    var HashRouter = (function () {\n        function HashRouter(cb, config) {\n            var _this = this;\n            this.config = config || {};\n            this._detectPrefix();\n            this.cb = cb;\n            window.onpopstate = function () { return _this.cb(_this.get()); };\n        }\n        HashRouter.prototype.set = function (path, config) {\n            var _this = this;\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                for (var key in this.config.routes) {\n                    if (this.config.routes[key] === compare[0]) {\n                        path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                        break;\n                    }\n                }\n            }\n            if (this.get() !== path) {\n                window.history.pushState(null, null, this.prefix + this.sufix + path);\n            }\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        HashRouter.prototype.get = function () {\n            var path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n            path = (path !== \"/\" && path !== \"#\") ? path : \"\";\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                var key = this.config.routes[compare[0]];\n                if (key) {\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                }\n            }\n            return path;\n        };\n        HashRouter.prototype._detectPrefix = function () {\n            var sufix = this.config.routerPrefix;\n            this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n            this.prefix = document.location.href.split(\"#\", 2)[0];\n        };\n        HashRouter.prototype._getRaw = function () {\n            return document.location.href;\n        };\n        return HashRouter;\n    }());\n    var isPatched = false;\n    function patch(w) {\n        if (isPatched || !w) {\n            return;\n        }\n        isPatched = true;\n        var win = window;\n        if (!win.Promise) {\n            win.Promise = w.promise;\n        }\n        var version = w.version.split(\".\");\n        if (version[0] * 10 + version[1] * 1 < 53) {\n            w.ui.freeze = function (handler) {\n                var res = handler();\n                if (res && res.then) {\n                    res.then(function (some) {\n                        w.ui.$freeze = false;\n                        w.ui.resize();\n                        return some;\n                    });\n                }\n                else {\n                    w.ui.$freeze = false;\n                    w.ui.resize();\n                }\n                return res;\n            };\n        }\n        var baseAdd = w.ui.baselayout.prototype.addView;\n        var baseRemove = w.ui.baselayout.prototype.removeView;\n        var config = {\n            addView: function (view, index) {\n                if (this.$scope && this.$scope.webixJet && !view.queryView) {\n                    var jview_1 = this.$scope;\n                    var subs_1 = {};\n                    view = jview_1.app.copyConfig(view, {}, subs_1);\n                    baseAdd.apply(this, [view, index]);\n                    var _loop_1 = function (key) {\n                        jview_1._renderFrame(key, subs_1[key], null).then(function () {\n                            jview_1._subs[key] = subs_1[key];\n                        });\n                    };\n                    for (var key in subs_1) {\n                        _loop_1(key);\n                    }\n                    return view.id;\n                }\n                else {\n                    return baseAdd.apply(this, arguments);\n                }\n            },\n            removeView: function () {\n                baseRemove.apply(this, arguments);\n                if (this.$scope && this.$scope.webixJet) {\n                    var subs = this.$scope._subs;\n                    for (var key in subs) {\n                        var test = subs[key];\n                        if (!w.$$(test.id)) {\n                            test.view.destructor();\n                            delete subs[key];\n                        }\n                    }\n                }\n            }\n        };\n        w.extend(w.ui.layout.prototype, config, true);\n        w.extend(w.ui.baselayout.prototype, config, true);\n        w.protoUI({\n            name: \"jetapp\",\n            $init: function (cfg) {\n                this.$app = new this.app(cfg);\n                var id = w.uid().toString();\n                cfg.body = { id: id };\n                this.$ready.push(function () {\n                    this.callEvent(\"onInit\", [this.$app]);\n                    this.$app.render({ id: id });\n                });\n            }\n        }, w.ui.proxy, w.EventSystem);\n    }\n    var JetApp = (function (_super) {\n        __extends(JetApp, _super);\n        function JetApp(config) {\n            var _this = this;\n            config.router = config.router || HashRouter;\n            _this = _super.call(this, config) || this;\n            patch(_this.webix);\n            return _this;\n        }\n        JetApp.prototype.require = function (type, url) {\n            return require(type + \"/\" + url);\n        };\n        return JetApp;\n    }(JetAppBase));\n    var UrlRouter = (function (_super) {\n        __extends(UrlRouter, _super);\n        function UrlRouter() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        UrlRouter.prototype._detectPrefix = function () {\n            this.prefix = \"\";\n            this.sufix = this.config.routerPrefix || \"\";\n        };\n        UrlRouter.prototype._getRaw = function () {\n            return document.location.pathname + (document.location.search || \"\");\n        };\n        return UrlRouter;\n    }(HashRouter));\n    var EmptyRouter = (function () {\n        function EmptyRouter(cb, _$config) {\n            this.path = \"\";\n            this.cb = cb;\n        }\n        EmptyRouter.prototype.set = function (path, config) {\n            var _this = this;\n            this.path = path;\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        EmptyRouter.prototype.get = function () {\n            return this.path;\n        };\n        return EmptyRouter;\n    }());\n    function UnloadGuard(app, view, config) {\n        view.on(app, \"app:guard\", function (_$url, point, promise) {\n            if (point === view || point.contains(view)) {\n                var res_1 = config();\n                if (res_1 === false) {\n                    promise.confirm = Promise.reject(new NavigationBlocked());\n                }\n                else {\n                    promise.confirm = promise.confirm.then(function () { return res_1; });\n                }\n            }\n        });\n    }\n    function has(store, key) {\n        return Object.prototype.hasOwnProperty.call(store, key);\n    }\n    function forEach(obj, handler, context) {\n        for (var key in obj) {\n            if (has(obj, key)) {\n                handler.call((context || obj), obj[key], key, obj);\n            }\n        }\n    }\n    function trim(str) {\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n    function warn(message) {\n        message = 'Warning: ' + message;\n        if (typeof console !== 'undefined') {\n            console.error(message);\n        }\n        try {\n            throw new Error(message);\n        }\n        catch (x) { }\n    }\n    var replace = String.prototype.replace;\n    var split = String.prototype.split;\n    var delimiter = '||||';\n    var russianPluralGroups = function (n) {\n        var end = n % 10;\n        if (n !== 11 && end === 1) {\n            return 0;\n        }\n        if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n            return 1;\n        }\n        return 2;\n    };\n    var pluralTypes = {\n        arabic: function (n) {\n            if (n < 3) {\n                return n;\n            }\n            var lastTwo = n % 100;\n            if (lastTwo >= 3 && lastTwo <= 10)\n                return 3;\n            return lastTwo >= 11 ? 4 : 5;\n        },\n        bosnian_serbian: russianPluralGroups,\n        chinese: function () { return 0; },\n        croatian: russianPluralGroups,\n        french: function (n) { return n > 1 ? 1 : 0; },\n        german: function (n) { return n !== 1 ? 1 : 0; },\n        russian: russianPluralGroups,\n        lithuanian: function (n) {\n            if (n % 10 === 1 && n % 100 !== 11) {\n                return 0;\n            }\n            return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n        },\n        czech: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            return (n >= 2 && n <= 4) ? 1 : 2;\n        },\n        polish: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            var end = n % 10;\n            return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n        },\n        icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n        slovenian: function (n) {\n            var lastTwo = n % 100;\n            if (lastTwo === 1) {\n                return 0;\n            }\n            if (lastTwo === 2) {\n                return 1;\n            }\n            if (lastTwo === 3 || lastTwo === 4) {\n                return 2;\n            }\n            return 3;\n        }\n    };\n    var pluralTypeToLanguages = {\n        arabic: ['ar'],\n        bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n        chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n        croatian: ['hr', 'hr-HR'],\n        german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n        french: ['fr', 'tl', 'pt-br'],\n        russian: ['ru', 'ru-RU'],\n        lithuanian: ['lt'],\n        czech: ['cs', 'cs-CZ', 'sk'],\n        polish: ['pl'],\n        icelandic: ['is'],\n        slovenian: ['sl-SL']\n    };\n    function langToTypeMap(mapping) {\n        var ret = {};\n        forEach(mapping, function (langs, type) {\n            forEach(langs, function (lang) {\n                ret[lang] = type;\n            });\n        });\n        return ret;\n    }\n    function pluralTypeName(locale) {\n        var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n        return langToPluralType[locale]\n            || langToPluralType[split.call(locale, /-/, 1)[0]]\n            || langToPluralType.en;\n    }\n    function pluralTypeIndex(locale, count) {\n        return pluralTypes[pluralTypeName(locale)](count);\n    }\n    function escape(token) {\n        return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    }\n    function constructTokenRegex(opts) {\n        var prefix = (opts && opts.prefix) || '%{';\n        var suffix = (opts && opts.suffix) || '}';\n        if (prefix === delimiter || suffix === delimiter) {\n            throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n        }\n        return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n    }\n    var dollarRegex = /\\$/g;\n    var dollarBillsYall = '$$';\n    var defaultTokenRegex = /%\\{(.*?)\\}/g;\n    function transformPhrase(phrase, substitutions, locale, tokenRegex) {\n        if (typeof phrase !== 'string') {\n            throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n        }\n        if (substitutions == null) {\n            return phrase;\n        }\n        var result = phrase;\n        var interpolationRegex = tokenRegex || defaultTokenRegex;\n        var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n        if (options.smart_count != null && result) {\n            var texts = split.call(result, delimiter);\n            result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n        }\n        result = replace.call(result, interpolationRegex, function (expression, argument) {\n            if (!has(options, argument) || options[argument] == null) {\n                return expression;\n            }\n            return replace.call(options[argument], dollarRegex, dollarBillsYall);\n        });\n        return result;\n    }\n    function Polyglot(options) {\n        var opts = options || {};\n        this.phrases = {};\n        this.extend(opts.phrases || {});\n        this.currentLocale = opts.locale || 'en';\n        var allowMissing = opts.allowMissing ? transformPhrase : null;\n        this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n        this.warn = opts.warn || warn;\n        this.tokenRegex = constructTokenRegex(opts.interpolation);\n    }\n    Polyglot.prototype.locale = function (newLocale) {\n        if (newLocale)\n            this.currentLocale = newLocale;\n        return this.currentLocale;\n    };\n    Polyglot.prototype.extend = function (morePhrases, prefix) {\n        forEach(morePhrases, function (phrase, key) {\n            var prefixedKey = prefix ? prefix + '.' + key : key;\n            if (typeof phrase === 'object') {\n                this.extend(phrase, prefixedKey);\n            }\n            else {\n                this.phrases[prefixedKey] = phrase;\n            }\n        }, this);\n    };\n    Polyglot.prototype.unset = function (morePhrases, prefix) {\n        if (typeof morePhrases === 'string') {\n            delete this.phrases[morePhrases];\n        }\n        else {\n            forEach(morePhrases, function (phrase, key) {\n                var prefixedKey = prefix ? prefix + '.' + key : key;\n                if (typeof phrase === 'object') {\n                    this.unset(phrase, prefixedKey);\n                }\n                else {\n                    delete this.phrases[prefixedKey];\n                }\n            }, this);\n        }\n    };\n    Polyglot.prototype.clear = function () {\n        this.phrases = {};\n    };\n    Polyglot.prototype.replace = function (newPhrases) {\n        this.clear();\n        this.extend(newPhrases);\n    };\n    Polyglot.prototype.t = function (key, options) {\n        var phrase, result;\n        var opts = options == null ? {} : options;\n        if (typeof this.phrases[key] === 'string') {\n            phrase = this.phrases[key];\n        }\n        else if (typeof opts._ === 'string') {\n            phrase = opts._;\n        }\n        else if (this.onMissingKey) {\n            var onMissingKey = this.onMissingKey;\n            result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n        }\n        else {\n            this.warn('Missing translation for key: \"' + key + '\"');\n            result = key;\n        }\n        if (typeof phrase === 'string') {\n            result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n        }\n        return result;\n    };\n    Polyglot.prototype.has = function (key) {\n        return has(this.phrases, key);\n    };\n    Polyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n        return transformPhrase(phrase, substitutions, locale);\n    };\n    var webixPolyglot = Polyglot;\n    function Locale(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n        function setLangData(name, data, silent) {\n            if (data.__esModule) {\n                data = data.default;\n            }\n            var pconfig = { phrases: data };\n            if (config.polyglot) {\n                app.webix.extend(pconfig, config.polyglot);\n            }\n            var poly = service.polyglot = new webixPolyglot(pconfig);\n            poly.locale(name);\n            service._ = app.webix.bind(poly.t, poly);\n            lang = name;\n            if (storage) {\n                storage.put(\"lang\", lang);\n            }\n            if (config.webix) {\n                var locName = config.webix[name];\n                if (locName) {\n                    app.webix.i18n.setLocale(locName);\n                }\n            }\n            if (!silent) {\n                return app.refresh();\n            }\n            return Promise.resolve();\n        }\n        function getLang() { return lang; }\n        function setLang(name, silent) {\n            if (config.path === false) {\n                return;\n            }\n            var path = (config.path ? config.path + \"/\" : \"\") + name;\n            var data = app.require(\"jet-locales\", path);\n            setLangData(name, data, silent);\n        }\n        var service = {\n            getLang: getLang, setLang: setLang, setLangData: setLangData, _: null, polyglot: null\n        };\n        app.setService(\"locale\", service);\n        setLang(lang, true);\n    }\n    function show(view, config, value) {\n        var _a;\n        if (config.urls) {\n            value = config.urls[value] || value;\n        }\n        else if (config.param) {\n            value = (_a = {}, _a[config.param] = value, _a);\n        }\n        view.show(value);\n    }\n    function Menu(app, view, config) {\n        var frame = view.getSubViewInfo().parent;\n        var ui = view.$$(config.id || config);\n        var silent = false;\n        ui.attachEvent(\"onchange\", function () {\n            if (!silent) {\n                show(frame, config, this.getValue());\n            }\n        });\n        ui.attachEvent(\"onafterselect\", function () {\n            if (!silent) {\n                var id = null;\n                if (ui.setValue) {\n                    id = this.getValue();\n                }\n                else if (ui.getSelectedId) {\n                    id = ui.getSelectedId();\n                }\n                show(frame, config, id);\n            }\n        });\n        view.on(app, \"app:route\", function () {\n            var name = \"\";\n            if (config.param) {\n                name = view.getParam(config.param, true);\n            }\n            else {\n                var segment = frame.getUrl()[1];\n                if (segment) {\n                    name = segment.page;\n                }\n            }\n            if (name) {\n                silent = true;\n                if (ui.setValue && ui.getValue() !== name) {\n                    ui.setValue(name);\n                }\n                else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\n                    ui.select(name);\n                }\n                silent = false;\n            }\n        });\n    }\n    var baseicons = {\n        good: \"check\",\n        error: \"warning\",\n        saving: \"refresh fa-spin\"\n    };\n    var basetext = {\n        good: \"Ok\",\n        error: \"Error\",\n        saving: \"Connecting...\"\n    };\n    function Status(app, view, config) {\n        var status = \"good\";\n        var count = 0;\n        var iserror = false;\n        var expireDelay = config.expire;\n        if (!expireDelay && expireDelay !== false) {\n            expireDelay = 2000;\n        }\n        var texts = config.texts || basetext;\n        var icons = config.icons || baseicons;\n        if (typeof config === \"string\") {\n            config = { target: config };\n        }\n        function refresh(content) {\n            var area = view.$$(config.target);\n            if (area) {\n                if (!content) {\n                    content = \"<div class='status_\" +\n                        status +\n                        \"'><span class='webix_icon fa-\" +\n                        icons[status] + \"'></span> \" + texts[status] + \"</div>\";\n                }\n                area.setHTML(content);\n            }\n        }\n        function success() {\n            count--;\n            setStatus(\"good\");\n        }\n        function fail(err) {\n            count--;\n            setStatus(\"error\", err);\n        }\n        function start(promise) {\n            count++;\n            setStatus(\"saving\");\n            if (promise && promise.then) {\n                promise.then(success, fail);\n            }\n        }\n        function getStatus() {\n            return status;\n        }\n        function hideStatus() {\n            if (count === 0) {\n                refresh(\" \");\n            }\n        }\n        function setStatus(mode, err) {\n            if (count < 0) {\n                count = 0;\n            }\n            if (mode === \"saving\") {\n                status = \"saving\";\n                refresh();\n            }\n            else {\n                iserror = (mode === \"error\");\n                if (count === 0) {\n                    status = iserror ? \"error\" : \"good\";\n                    if (iserror) {\n                        app.error(\"app:error:server\", [err.responseText || err]);\n                    }\n                    else {\n                        if (expireDelay) {\n                            setTimeout(hideStatus, expireDelay);\n                        }\n                    }\n                    refresh();\n                }\n            }\n        }\n        function track(data) {\n            var dp = app.webix.dp(data);\n            if (dp) {\n                view.on(dp, \"onAfterDataSend\", start);\n                view.on(dp, \"onAfterSaveError\", function (_id, _obj, response) { return fail(response); });\n                view.on(dp, \"onAfterSave\", success);\n            }\n        }\n        app.setService(\"status\", {\n            getStatus: getStatus,\n            setStatus: setStatus,\n            track: track\n        });\n        if (config.remote) {\n            view.on(app.webix, \"onRemoteCall\", start);\n        }\n        if (config.ajax) {\n            view.on(app.webix, \"onBeforeAjax\", function (_mode, _url, _data, _request, _headers, _files, promise) {\n                start(promise);\n            });\n        }\n        if (config.data) {\n            track(config.data);\n        }\n    }\n    function Theme(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var theme = storage ?\n            (storage.get(\"theme\") || \"flat-default\")\n            :\n                (config.theme || \"flat-default\");\n        var service = {\n            getTheme: function () { return theme; },\n            setTheme: function (name, silent) {\n                var parts = name.split(\"-\");\n                var links = document.getElementsByTagName(\"link\");\n                for (var i = 0; i < links.length; i++) {\n                    var lname = links[i].getAttribute(\"title\");\n                    if (lname) {\n                        if (lname === name || lname === parts[0]) {\n                            links[i].disabled = false;\n                        }\n                        else {\n                            links[i].disabled = true;\n                        }\n                    }\n                }\n                app.webix.skin.set(parts[0]);\n                app.webix.html.removeCss(document.body, \"theme-\" + theme);\n                app.webix.html.addCss(document.body, \"theme-\" + name);\n                theme = name;\n                if (storage) {\n                    storage.put(\"theme\", name);\n                }\n                if (!silent) {\n                    app.refresh();\n                }\n            }\n        };\n        app.setService(\"theme\", service);\n        service.setTheme(theme, true);\n    }\n    function copyParams(data, url, route) {\n        for (var i = 0; i < route.length; i++) {\n            data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\n        }\n    }\n    function UrlParam(app, view, config) {\n        var route = config.route || config;\n        var data = {};\n        view.on(app, \"app:urlchange\", function (subview, segment) {\n            if (view === subview) {\n                copyParams(data, segment.suburl(), route);\n                segment.size(route.length + 1);\n            }\n        });\n        var os = view.setParam;\n        var og = view.getParam;\n        view.setParam = function (name, value, show) {\n            var index = route.indexOf(name);\n            if (index >= 0) {\n                data[name] = value;\n                this._segment.update(\"\", value, index + 1);\n                if (show) {\n                    return view.show(null);\n                }\n            }\n            else {\n                return os.call(this, name, value, show);\n            }\n        };\n        view.getParam = function (key, mode) {\n            var val = data[key];\n            if (typeof val !== \"undefined\") {\n                return val;\n            }\n            return og.call(this, key, mode);\n        };\n        copyParams(data, view.getUrl(), route);\n    }\n    function User(app, _view, config) {\n        config = config || {};\n        var login = config.login || \"/login\";\n        var logout = config.logout || \"/logout\";\n        var afterLogin = config.afterLogin || app.config.start;\n        var afterLogout = config.afterLogout || \"/login\";\n        var ping = config.ping || 5 * 60 * 1000;\n        var model = config.model;\n        var user = config.user;\n        var service = {\n            getUser: function () {\n                return user;\n            },\n            getStatus: function (server) {\n                if (!server) {\n                    return user !== null;\n                }\n                return model.status().catch(function () { return null; }).then(function (data) {\n                    user = data;\n                });\n            },\n            login: function (name, pass) {\n                return model.login(name, pass).then(function (data) {\n                    user = data;\n                    if (!data) {\n                        throw new Error(\"Access denied\");\n                    }\n                    app.callEvent(\"app:user:login\", [user]);\n                    app.show(afterLogin);\n                });\n            },\n            logout: function () {\n                user = null;\n                return model.logout().then(function (res) {\n                    app.callEvent(\"app:user:logout\", []);\n                    return res;\n                });\n            }\n        };\n        function canNavigate(url, obj) {\n            if (url === logout) {\n                service.logout();\n                obj.redirect = afterLogout;\n            }\n            else if (url !== login && !service.getStatus()) {\n                obj.redirect = login;\n            }\n        }\n        app.setService(\"user\", service);\n        app.attachEvent(\"app:guard\", function (url, _$root, obj) {\n            if (config.public && config.public(url)) {\n                return true;\n            }\n            if (typeof user === \"undefined\") {\n                obj.confirm = service.getStatus(true).then(function () { return canNavigate(url, obj); });\n            }\n            return canNavigate(url, obj);\n        });\n        if (ping) {\n            setInterval(function () { return service.getStatus(true); }, ping);\n        }\n    }\n    var webix$1 = window.webix;\n    if (webix$1) {\n        patch(webix$1);\n    }\n    var plugins = {\n        UnloadGuard: UnloadGuard, Locale: Locale, Menu: Menu, Theme: Theme, User: User, Status: Status, UrlParam: UrlParam\n    };\n    var w = window;\n    if (!w.Promise) {\n        w.Promise = w.webix.promise;\n    }\n\n    var index = 1;\n    function uid() {\n        return index++;\n    }\n    var empty = undefined;\n    function ignoreInitial(code) {\n        var init = false;\n        return function () {\n            if (init)\n                return code.apply(this, arguments);\n            else\n                init = true;\n        };\n    }\n    var context = null;\n    function link(source, target, key) {\n        Object.defineProperty(target, key, {\n            get: function () { return source[key]; },\n            set: function (value) { return (source[key] = value); },\n        });\n    }\n    function createState(data, config) {\n        config = config || {};\n        var handlers = {};\n        var out = {};\n        var observe = function (mask, handler) {\n            var key = uid();\n            handlers[key] = { mask: mask, handler: handler };\n            if (mask === \"*\")\n                handler(out, empty, mask);\n            else\n                handler(out[mask], empty, mask);\n            return key;\n        };\n        var observeEnd = function (id) {\n            delete handlers[id];\n        };\n        var queue = [];\n        var waitInQueue = false;\n        var batch = function (code) {\n            if (typeof code !== \"function\") {\n                var values_1 = code;\n                code = function () {\n                    for (var key in values_1)\n                        out[key] = values_1[key];\n                };\n            }\n            waitInQueue = true;\n            code(out);\n            waitInQueue = false;\n            while (queue.length) {\n                var obj = queue.shift();\n                notify.apply(this, obj);\n            }\n        };\n        var notify = function (key, old, value, meta) {\n            if (waitInQueue) {\n                queue.push([key, old, value, meta]);\n                return;\n            }\n            var list = Object.keys(handlers);\n            for (var i = 0; i < list.length; i++) {\n                var obj = handlers[list[i]];\n                if (!obj)\n                    continue;\n                if (obj.mask === \"*\" || obj.mask === key) {\n                    obj.handler(value, old, key, meta);\n                }\n            }\n        };\n        for (var key2 in data) {\n            if (data.hasOwnProperty(key2)) {\n                var test = data[key2];\n                if (config.nested && typeof test === \"object\" && test) {\n                    out[key2] = createState(test, config);\n                }\n                else {\n                    reactive(out, test, key2, notify);\n                }\n            }\n        }\n        Object.defineProperty(out, \"$changes\", {\n            value: {\n                attachEvent: observe,\n                detachEvent: observeEnd,\n            },\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$observe\", {\n            value: observe,\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$batch\", {\n            value: batch,\n            enumerable: false,\n            configurable: false,\n        });\n        return out;\n    }\n    function reactive(obj, val, key, notify) {\n        Object.defineProperty(obj, key, {\n            get: function () {\n                return val;\n            },\n            set: function (value) {\n                var changed = false;\n                if (val === null || value === null) {\n                    changed = val !== value;\n                }\n                else {\n                    changed = val.valueOf() != value.valueOf();\n                }\n                if (changed) {\n                    var old = val;\n                    val = value;\n                    notify(key, old, value, context);\n                }\n            },\n            enumerable: true,\n            configurable: false,\n        });\n    }\n\n    var ActionsPopupView = (function (_super) {\n        __extends(ActionsPopupView, _super);\n        function ActionsPopupView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        ActionsPopupView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            return {\n                view: \"popup\",\n                point: false,\n                body: {\n                    view: \"list\",\n                    yCount: 4,\n                    width: 120,\n                    borderless: true,\n                    data: [\n                        { id: \"edit\", value: _(\"Edit\") },\n                        { id: \"add-filter\", value: _(\"Add Filter\") },\n                        { id: \"add-group\", value: _(\"Add Group\") },\n                        { id: \"delete\", value: _(\"Delete\") },\n                    ],\n                    click: function (id) {\n                        _this.app.callEvent(\"action\", [id, _this.Item]);\n                        _this.Hide();\n                    },\n                },\n            };\n        };\n        ActionsPopupView.prototype.Hide = function () {\n            this.getRoot().hide();\n        };\n        ActionsPopupView.prototype.Show = function (node, item) {\n            this.Item = item;\n            var pos = webix.html.offset(node);\n            this.getRoot().show({\n                x: pos.x + pos.width + webix.skin.$active.dataPadding,\n                y: pos.y - 10,\n            });\n        };\n        return ActionsPopupView;\n    }(JetView));\n\n    var menuRight = \"<span style='float:right' class='webix_icon action-menu wxi-dots'></span>\";\n    var menuClose = \"<span style='float:right' class='webix_icon action-close wxi-close'></span>\";\n\n    var BaseView = (function (_super) {\n        __extends(BaseView, _super);\n        function BaseView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        BaseView.prototype.GetButton = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var button = {\n                view: \"button\",\n                value: _(\"Add filter\"),\n                localId: \"button\",\n                css: \"webix_primary\",\n                click: function () { return _this.Add(null, null); },\n            };\n            return button;\n        };\n        BaseView.prototype.GetList = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var simple = this.getParam(\"simple\");\n            var icon = simple ? menuClose : menuRight;\n            var AND = _(\"and\");\n            var OR = _(\"or\");\n            var GLUE = function (obj) { return (obj.glue == \"and\" ? AND : OR); };\n            var list = {\n                view: \"tree\",\n                borderless: true,\n                localId: \"list\",\n                glue: \"and\",\n                css: \"wbq-query_list\",\n                scheme: {\n                    $serialize: function (obj) {\n                        if (obj.group) {\n                            return { group: obj.group, glue: obj.glue };\n                        }\n                        var out = {\n                            glue: obj.glue,\n                            field: obj.field,\n                            condition: obj.condition,\n                        };\n                        if (obj.includes && obj.includes.length)\n                            out.includes = obj.includes;\n                        return out;\n                    },\n                    $init: function (obj) {\n                        if (obj.group) {\n                            obj.$css = \"group\";\n                            obj.open = true;\n                        }\n                    },\n                },\n                type: {\n                    template: function (obj) {\n                        if (obj.group) {\n                            var editCss = _this.DisableSwitch\n                                ? \"wbq-filter_join_disabled\"\n                                : \"\";\n                            return \"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \" \" + editCss + \"'>\" + GLUE(obj) + \"</div>\";\n                        }\n                        return (_this.Template(obj, _this.app.config.fields, icon, _) +\n                            (\"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \"'>\" + GLUE(obj) + \"</div>\"));\n                    },\n                },\n                onClick: {\n                    \"action-menu\": function (e, id) {\n                        this.$scope.Actions.Show(e.target, id);\n                    },\n                    \"action-close\": function (e, id) {\n                        _this.Delete(id);\n                    },\n                    \"wbq-filter_join\": function (e, id) {\n                        _this.SwitchGlue(id);\n                    },\n                },\n                on: {\n                    onItemDblClick: function (id) {\n                        _this.EditStart(id);\n                    },\n                },\n            };\n            return list;\n        };\n        BaseView.prototype.init = function () {\n            var _this = this;\n            this.Actions = this.ui(ActionsPopupView);\n            this.on(this.app, \"applyFilter\", function (v) { return _this.EditStop(v); });\n            this.on(this.app, \"action\", function (type, id) {\n                if (type === \"delete\") {\n                    _this.Delete(id);\n                }\n                else if (type === \"add-filter\") {\n                    _this.Add(null, id);\n                }\n                else if (type === \"add-group\") {\n                    _this.AddGroup(null, id);\n                }\n                else if (type === \"edit\") {\n                    webix.delay(function () { return _this.EditStart(id); });\n                }\n            });\n            this.State = this.getParam(\"state\");\n            this.on(this.State.$changes, \"value\", function (v) {\n                _this.LastValue = JSON.stringify(v);\n                _this.EditStop();\n                _this.$$(\"list\").clearAll();\n                if (v) {\n                    _this.$$(\"list\").parse(_this.ConvertTo(v));\n                }\n            });\n        };\n        BaseView.prototype.ConvertTo = function (v, glue) {\n            var _this = this;\n            if (v.rules) {\n                var data = v.rules.map(function (a) { return _this.ConvertTo(a, v.glue); });\n                if (!glue)\n                    return data;\n                return { group: true, glue: glue, data: data };\n            }\n            var out = __assign(__assign({}, v), { glue: glue });\n            return out;\n        };\n        BaseView.prototype.ConvertFrom = function (id, source) {\n            var _this = this;\n            var glue = \"and\";\n            var branch = source.getBranch(id);\n            var rules = branch.map(function (_a) {\n                var id = _a.id, field = _a.field, type = _a.type, condition = _a.condition, includes = _a.includes;\n                if (field)\n                    return { field: field, type: type, condition: condition, includes: includes };\n                return _this.ConvertFrom(id, source);\n            });\n            if (!rules.length)\n                return null;\n            glue = branch[0].glue;\n            return { glue: glue, rules: rules };\n        };\n        BaseView.prototype.Add = function (obj, after) {\n            this.EditStop();\n            obj = obj || { field: \"\" };\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            if (!after && list.count())\n                after = list.getFirstId();\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            obj.glue = glue;\n            var id = list.add(obj, index, parent);\n            this.EditStart(id);\n            this.CreateMode = true;\n        };\n        BaseView.prototype.SwitchGlue = function (id) {\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var branch = list.data.getBranch(list.getParentId(id));\n            for (var i = 0; i < branch.length; i++) {\n                list.updateItem(branch[i].id, {\n                    glue: branch[i].glue == \"and\" ? \"or\" : \"and\",\n                });\n            }\n            this.Save();\n        };\n        BaseView.prototype.AddGroup = function (obj, after) {\n            this.EditStop();\n            obj = obj || {};\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            var node = { id: webix.uid(), group: true };\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            node.glue = glue;\n            obj.glue = node.glue == \"and\" ? \"or\" : \"and\";\n            this.DisableSwitch = true;\n            list.add(node, index, parent);\n            var id = list.add(obj, null, node.id);\n            this.EditStart(id);\n            this.DisableSwitch = false;\n            this.CreateMode = true;\n        };\n        BaseView.prototype.Delete = function (id) {\n            this.EditStop();\n            this.DeleteSilent(id);\n            this.Save();\n        };\n        BaseView.prototype.DeleteSilent = function (id) {\n            var list = this.$$(\"list\");\n            if (!list.exists(id))\n                return null;\n            var parent = list.getParentId(id);\n            list.remove(id);\n            var branch = list.data.branch[parent];\n            if (parent && !branch) {\n                this.DeleteSilent(parent);\n            }\n            else if (branch.length == 1 && list.getItem(branch[0]).group) {\n                var sub = branch[0];\n                if (parent) {\n                    var grand = list.getParentId(parent);\n                    var pIndex = list.getBranchIndex(parent, grand);\n                    list.move(sub, pIndex, list, { parent: grand });\n                    this.DeleteSilent(parent);\n                }\n                else {\n                    var pIndex = list.getBranchIndex(sub, 0);\n                    var kids = [].concat(list.data.branch[sub]);\n                    list.move(kids, pIndex, list, { parent: 0 });\n                    this.DeleteSilent(sub);\n                }\n            }\n        };\n        BaseView.prototype.EditStop = function (v) {\n            if (!this.Active)\n                return;\n            var list = this.$$(\"list\");\n            if (!v) {\n                if (this.CreateMode)\n                    this.DeleteSilent(this.ActiveId);\n                else\n                    list.refresh(this.ActiveId);\n            }\n            else {\n                v = v || this.Active.GetValue();\n                v.includes = v.includes || [];\n                list.updateItem(this.ActiveId, __assign({}, v));\n            }\n            var t = this.Active;\n            this.Active = null;\n            this.ActiveId = null;\n            t.destructor();\n            this.Save();\n        };\n        BaseView.prototype.Save = function () {\n            var v = this.ConvertFrom(0, this.$$(\"list\").data);\n            var asString = JSON.stringify(v);\n            if (this.LastValue !== asString) {\n                this.State.value = v;\n            }\n        };\n        BaseView.prototype.Template = function (obj, fields, icon, _) {\n            var op = \"&nbsp;\";\n            var field = fields.find(function (a) { return a.id === obj.field; }) || { value: \"\" };\n            if (obj.includes && obj.includes.length) {\n                op = _(\"in\") + \" \";\n                for (var i = 0; i < obj.includes.length; i++) {\n                    op +=\n                        (i > 0 ? \", \" : \"\") +\n                            (\"<span class='wbq-field-value'>\" + obj.includes[i] + \"</span>\");\n                }\n            }\n            else {\n                if (obj.condition && obj.condition.type) {\n                    op = _(obj.condition.type) + \" <span class='wbq-field-value'>\" + this.Format(obj.condition.filter, field.format, field.type) + \"</span>\";\n                }\n            }\n            return \"<span class='wbq-field-box'><span class='wbq-field-name'>\" + field.value + \"</span> \" + op + \" </span>\" + icon;\n        };\n        BaseView.prototype.Format = function (value, format, type) {\n            if (!value)\n                return \"\";\n            if (value.start)\n                value =\n                    this.Format(value.start, format, type) +\n                        (value.end ? \" - \" + this.Format(value.end, format, type) : \"\");\n            else {\n                var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                if (parser)\n                    value = parser(value);\n            }\n            return value;\n        };\n        return BaseView;\n    }(JetView));\n\n    var FilterView = (function (_super) {\n        __extends(FilterView, _super);\n        function FilterView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var fieldselect = {\n                view: \"richselect\",\n                options: [],\n                localId: \"field\",\n                on: {\n                    onChange: function () { return _this.AdjustToField(); },\n                },\n            };\n            var filter = { localId: \"filter\" };\n            var bottombar = {\n                type: \"clean\",\n                cols: [\n                    {\n                        view: \"button\",\n                        value: _(\"Cancel\"),\n                        width: 100,\n                        click: function () { return _this.Hide(); },\n                    },\n                    {},\n                    {\n                        view: \"button\",\n                        value: _(\"Apply\"),\n                        width: 100,\n                        css: \"webix_primary\",\n                        click: function () { return _this.ApplyFilter(); },\n                    },\n                ],\n            };\n            return {\n                padding: 10,\n                margin: 6,\n                css: \"webix_shadow_small\",\n                rows: [fieldselect, filter, bottombar],\n            };\n        };\n        FilterView.prototype.GetField = function () {\n            var fselect = this.$$(\"field\");\n            return fselect.getList().getItem(fselect.getValue());\n        };\n        FilterView.prototype.AdjustToField = function () {\n            var field = this.GetField();\n            this.CreateFilter(field.id, field.type, field.format, field.conditions, this.$$(\"filter\"));\n        };\n        FilterView.prototype.CreateFilter = function (field, type, format, conditions, place) {\n            var ui = {\n                view: \"filter\",\n                localId: \"filter\",\n                conditions: conditions,\n                field: field,\n                mode: type,\n                template: function (o) {\n                    var str = o[field];\n                    var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                    if (parser)\n                        str = parser(str);\n                    return str;\n                },\n                margin: 6,\n            };\n            var filter = webix.ui(ui, place);\n            var data = this.app.getService(\"backend\").data(field);\n            filter.parse(data);\n            return filter;\n        };\n        FilterView.prototype.ApplyFilter = function () {\n            this.app.callEvent(\"applyFilter\", [this.GetValue()]);\n        };\n        FilterView.prototype.GetValue = function () {\n            var field = this.GetField();\n            var rule = __assign(__assign({}, this.$$(\"filter\").getValue()), { field: field.id, type: field.type });\n            if (rule.condition.filter == \"\" &&\n                (!rule.includes || !rule.includes.length))\n                rule = null;\n            return rule;\n        };\n        FilterView.prototype.Hide = function () {\n            this.app.callEvent(\"applyFilter\", [null]);\n        };\n        FilterView.prototype.Show = function (value, fields) {\n            var fselect = this.$$(\"field\");\n            fselect.getList().parse(fields);\n            if (value.field) {\n                fselect.setValue(value.field);\n            }\n            else {\n                fselect.setValue(fields[0].id);\n            }\n            this.$$(\"filter\").setValue(webix.copy(value));\n        };\n        return FilterView;\n    }(JetView));\n\n    var FilterPopup = (function (_super) {\n        __extends(FilterPopup, _super);\n        function FilterPopup() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterPopup.prototype.config = function () {\n            return {\n                view: \"popup\",\n                point: false,\n                body: { $subview: FilterView, name: \"body\" },\n            };\n        };\n        FilterPopup.prototype.Show = function (value, fields, at) {\n            var _this = this;\n            setTimeout(function () {\n                _this.getRoot().show(at);\n                _this.getSubView(\"body\").Show(value, fields);\n            }, 100);\n        };\n        return FilterPopup;\n    }(JetView));\n\n    var TopBarView = (function (_super) {\n        __extends(TopBarView, _super);\n        function TopBarView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopBarView.prototype.config = function () {\n            var button = this.GetButton();\n            button.width = 100;\n            var list = this.GetList();\n            list.scroll = this.app.config.scroll !== false ? \"x\" : \"\";\n            list.borderless = true;\n            list.css = \"wbq-query_bar\";\n            var small = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n            var padding = 8, height = 58;\n            if (small) {\n                padding = 4;\n                height = 50;\n            }\n            if (list.scroll)\n                height += webix.env.scrollSize;\n            return {\n                view: \"toolbar\",\n                paddingX: padding * 2,\n                paddingY: padding,\n                height: height,\n                borderless: true,\n                cols: [list, button],\n            };\n        };\n        TopBarView.prototype.EditStart = function (id) {\n            var _this = this;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            this.ActiveId = id;\n            this.Active = this.ui(FilterPopup);\n            this.Active.getRoot().attachEvent(\"onHide\", function () {\n                if (_this.Active)\n                    _this.EditStop();\n            });\n            var at = webix.html.offset(list.getItemNode(id));\n            this.Active.Show(list.getItem(id), this.app.config.fields, at);\n            this.CreateMode = false;\n        };\n        return TopBarView;\n    }(BaseView));\n\n    var TopListView = (function (_super) {\n        __extends(TopListView, _super);\n        function TopListView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopListView.prototype.config = function () {\n            return {\n                paddingX: 16,\n                paddingY: 8,\n                margin: 0,\n                rows: [this.GetButton(), this.GetList()],\n            };\n        };\n        TopListView.prototype.EditStart = function (id) {\n            var _this = this;\n            if (this.ActiveId && this.ActiveId == id)\n                return;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var container = list.getItemNode(id);\n            container.classList.add(\"active-editor\");\n            container.innerHTML = \"\";\n            this.ActiveId = id;\n            this.Active = this.ui(FilterView, { container: container });\n            this.$$(\"list\").attachEvent(\"onAfterRender\", function () { return _this.EditStop(); });\n            this.Active.Show(list.getItem(id), this.app.config.fields);\n            this.CreateMode = false;\n        };\n        return TopListView;\n    }(BaseView));\n\n    var views = { JetView: JetView };\n    views[\"actions\"] = ActionsPopupView;\n    views[\"bar\"] = TopBarView;\n    views[\"base\"] = BaseView;\n    views[\"filter\"] = FilterView;\n    views[\"list\"] = TopListView;\n    views[\"popup\"] = FilterPopup;\n\n    var en = {\n        \"Add filter\": \"Add filter\",\n        in: \"=\",\n        equal: \"=\",\n        notEqual: \"<>\",\n        less: \"<\",\n        greater: \">\",\n        greaterOrEqual: \">=\",\n        lessOrEqual: \"<=\",\n        contains: \"contains\",\n        notContains: \"not contains\",\n        beginsWith: \"begins\",\n        notBeginsWith: \"not begings\",\n        endsWith: \"ends\",\n        notEndsWith: \"not ends\",\n        between: \"between\",\n        notBetween: \"not between\",\n        and: \"and\",\n        or: \"or\",\n        Edit: \"Edit\",\n        \"Add Filter\": \"Add Filter\",\n        \"Add Group\": \"Add Group\",\n        Delete: \"Delete\",\n        Apply: \"Apply\",\n        Cancel: \"Cancel\",\n    };\n\n    var Backend = (function () {\n        function Backend(app) {\n            this._app = app;\n        }\n        Backend.prototype.data = function (field) {\n            var data = this._app.config.data;\n            if (typeof data == \"function\")\n                return Promise.resolve(data(field)).then(function (a) {\n                    return a.map(function (b) {\n                        var _a;\n                        return (_a = {}, _a[field] = b, _a);\n                    });\n                });\n            return Promise.resolve(data);\n        };\n        Backend.prototype.save = function (v) {\n            console.log(v);\n        };\n        return Backend;\n    }());\n\n    function query(query, fields) {\n        var ops = webix.filters;\n        var types = {};\n        fields.forEach(function (a) {\n            if (a.conditions)\n                a.conditions.forEach(function (op) {\n                    if (typeof op === \"object\") {\n                        ops[op.id] = op.handler;\n                    }\n                });\n            if (a.type)\n                types[a.id] = a.type;\n        });\n        return queryToFilter(query, ops, types);\n    }\n    function queryToFilter(query, ops, types) {\n        if (!query || !query.rules.length)\n            return function () { return true; };\n        var filters = query.rules.map(function (a) { return singleFilter(a, ops, types); });\n        return (query.glue === \"or\" ? glueOr : glueAnd)(filters);\n    }\n    function glueAnd(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (!f[i](v))\n                    return false;\n            }\n            return true;\n        };\n    }\n    function glueOr(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (f[i](v))\n                    return true;\n            }\n            return false;\n        };\n    }\n    function singleFilter(rule, ops, types) {\n        if (rule.rules) {\n            return queryToFilter(rule, ops, types);\n        }\n        return function (v) {\n            var test = v[rule.field];\n            if (rule.includes && rule.includes.length) {\n                return rule.includes.findIndex(function (a) { return a === test; }) !== -1;\n            }\n            if (!webix.isUndefined(test)) {\n                var con = rule.condition.type;\n                var filter = ops[con] || ops[types[rule.field]][con];\n                return filter(test, rule.condition.filter);\n            }\n            return false;\n        };\n    }\n\n    var App = (function (_super) {\n        __extends(App, _super);\n        function App(config) {\n            var _this = this;\n            var state = createState({\n                value: config.value || null,\n            });\n            var defaults = {\n                router: EmptyRouter,\n                version: \"10.0.9\",\n                debug: true,\n            };\n            _this = _super.call(this, __assign(__assign({}, defaults), config)) || this;\n            _this.config.start = config.type === \"bar\" ? \"/bar\" : \"/list\";\n            _this.config.params = { state: state, simple: config.simple === true };\n            _this.setService(\"backend\", new (_this.dynamic(Backend))(_this));\n            _this.use(plugins.Locale, _this.config.locale || {\n                lang: \"en\",\n                webix: {\n                    en: \"en-US\",\n                },\n            });\n            return _this;\n        }\n        App.prototype.dynamic = function (obj) {\n            return this.config.override ? this.config.override.get(obj) || obj : obj;\n        };\n        App.prototype.require = function (type, name) {\n            if (type === \"jet-views\")\n                return views[name];\n            else if (type === \"jet-locales\")\n                return locales[name];\n            return null;\n        };\n        App.prototype.getState = function () {\n            return this.config.params.state;\n        };\n        App.prototype.GetFilter = function () {\n            return query(this.config.params.state.value, this.config.fields);\n        };\n        return App;\n    }(JetApp));\n    webix.protoUI({\n        name: \"query\",\n        app: App,\n        getState: function () {\n            return this.$app.getState();\n        },\n        getService: function (name) {\n            return this.$app.getService(name);\n        },\n        $init: function () {\n            var _this = this;\n            var state = this.getState();\n            for (var key in state) {\n                link(state, this.config, key);\n            }\n            state.$changes.attachEvent(\"value\", ignoreInitial(function (v, o) { return _this.callEvent(\"onChange\", v, o); }));\n        },\n        getFilterFunction: function () {\n            return this.$app.GetFilter();\n        },\n    }, webix.ui.jetapp);\n    var services = { Backend: Backend };\n    var locales = { en: en };\n\n    exports.App = App;\n    exports.locales = locales;\n    exports.services = services;\n    exports.views = views;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\nimport \"../../helpers/inputlist\";\nimport { removeRight } from \"../../helpers/icons\";\n\nexport default class CommonView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tlet form = {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 130,\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Report name\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\tlocalId: \"name\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Description\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tname: \"desc\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Data source\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"combo\",\n\t\t\t\t\t\t\tname: \"data\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"input-list\",\n\t\t\t\t\tname: \"joins\",\n\t\t\t\t\ttemplate: this.JoinListTemplate.bind(this),\n\t\t\t\t\tdata: [],\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_rpt_action_remove: (ev, id) => this.RemoveJoin(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tlabel: _(\"Join data\"),\n\t\t\t\t\tclick: () => this.ShowJoins(),\n\t\t\t\t},\n\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Delete report\"),\n\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\tinputWidth: 170,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tcss: \"webix_rpt_delete\",\n\t\t\t\t\tclick: () => this.app.callEvent(\"onMenuAction\", [null, \"delete\"]),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tconst els = this.getRoot().elements;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.AppState = this.app.getParam(\"state\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Models = this.Local.getModels(true);\n\n\t\tconst keys = Object.keys(this.Models);\n\t\tconst combo = els.data;\n\t\tcombo.getList().parse(\n\t\t\tkeys.map(a => {\n\t\t\t\tconst m = this.Models[a];\n\t\t\t\treturn { id: m.id, value: m.name };\n\t\t\t})\n\t\t);\n\n\t\tbind(this.State, \"*\", this.getRoot(), this);\n\t\tthis.on(this.State.$changes, \"id\", v => this.ShowDeleteButton(v));\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowDeleteButton(v));\n\n\t\tthis.SourcesList = this.ui({\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tautoheight: true,\n\t\t\t\ttype: {\n\t\t\t\t\ttemplate: this.JoinTemplate.bind(this),\n\t\t\t\t},\n\t\t\t\tclick: id => {\n\t\t\t\t\tconst item = this.SourcesList.getBody().getItem(id);\n\t\t\t\t\tthis.AddJoin(item);\n\t\t\t\t\tthis.SourcesList.hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tAddJoin(item) {\n\t\tconst batch = this.Local.addJoin(item.tid, this.State);\n\t\tbatch.joins = [...this.State.joins, item];\n\t\tthis.State.$batch(batch);\n\t}\n\n\tRemoveJoin(id) {\n\t\tconst next = this.Local.cleanLinkedModels(id, this.State);\n\n\t\tif (!next.block) this.State.$batch(next);\n\t\telse {\n\t\t\tif (next.block.filter)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related query filter first\"),\n\t\t\t\t});\n\t\t\tif (next.block.group)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related group rule first\"),\n\t\t\t\t});\n\t\t}\n\t}\n\n\tJoinTemplate(obj) {\n\t\tconst s = this.Models[obj.sid];\n\t\tconst t = this.Models[obj.tid];\n\t\tconst f = obj.sf || obj.tf;\n\t\tconst n = (obj.sf ? s : t).data.find(a => a.id === f).name;\n\t\treturn `${t.name} <span class='webix_rpt_sources_path'>${s.name}${\n\t\t\tobj.sf ? ` (${n})` : \"\"\n\t\t} -> ${t.name}${obj.tf ? ` (${n})` : \"\"}</span>`;\n\t}\n\n\tJoinListTemplate(obj) {\n\t\treturn removeRight + this.JoinTemplate(obj);\n\t}\n\n\tShowJoins() {\n\t\tconst data = this.Local.getLinkedModels(\n\t\t\t[this.State.data].concat(this.State.joins.map(a => a.tid)),\n\t\t\ttrue\n\t\t);\n\t\tif (!data.length) return;\n\n\t\tconst list = this.SourcesList.getBody();\n\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.SourcesList.show(this.$$(\"add\").$view);\n\t}\n\n\tShowDeleteButton() {\n\t\tif (this.State.id && this.AppState.toolbar) this.$$(\"delete\").show();\n\t\telse this.$$(\"delete\").hide();\n\t}\n}\n","export function prompt(config, app) {\n\tconst result = new webix.promise.defer();\n\n\twebix\n\t\t.ui(\n\t\t\tapp.getService(\"jet-win\").updateConfig({\n\t\t\t\tview: \"window\",\n\t\t\t\thead: {\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tpadding: { left: 12, right: 4 },\n\t\t\t\t\tborderless: true,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{ view: \"label\", label: config.text },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tresult.reject(\"prompt cancelled\");\n\t\t\t\t\t\t\t\tthis.getTopParentView().close();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"form\",\n\t\t\t\t\tpadding: { top: 5, left: 20, right: 20, bottom: 20 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 10,\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\t\t\tvalue: config.value,\n\t\t\t\t\t\t\t\t\twidth: 230,\n\t\t\t\t\t\t\t\t\tcss: \"fm-prompt-input\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tvalue: config.button,\n\t\t\t\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t\tconst popup = this.getTopParentView();\n\t\t\t\t\t\t\t\t\t\tconst newname = popup.getBody().getValues().name;\n\t\t\t\t\t\t\t\t\t\tresult.resolve(newname);\n\t\t\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tconst input = this.getBody().elements.name.getInputNode();\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tif (config.selectMask) config.selectMask(input);\n\t\t\t\t\t\telse input.select();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t)\n\t\t.show();\n\n\treturn result;\n}\n","webix.protoUI(\n\t{\n\t\tname: \"query-select\",\n\t\t$cssName: \"richselect\",\n\n\t\t$init() {\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_qselect_icon: function() {\n\t\t\t\t\tthis.callEvent(\"onClearClick\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\twebix.ui.richselect\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"@xbs/query/codebase/query\";\n\nexport default class QueryView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"query\",\n\t\t\tlocalId: \"query\",\n\t\t\tcss: \"webix_rpt_query\",\n\t\t\tlocale: { lang: this.app.getService(\"locale\").getLang() },\n\t\t\tdata: field => {\n\t\t\t\tconst column = this.State.fields.find(a => a.id === field);\n\t\t\t\tif (column.type === \"boolean\") return [0, 1];\n\t\t\t\treturn local.getFieldData(field, column.type);\n\t\t\t},\n\t\t\tfields: this.State.fields\n\t\t\t\t.filter(a => a.type !== \"reference\" && a.type !== \"picklist\")\n\t\t\t\t.map(a => {\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tid: a.id,\n\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\ta.name +\n\t\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\t\t(a.model\n\t\t\t\t\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + a.model + \"</span>\"\n\t\t\t\t\t\t\t\t: \"\"),\n\t\t\t\t\t\ttype: a.type,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (obj.type === \"boolean\") {\n\t\t\t\t\t\tobj.conditions = [\"equal\"];\n\t\t\t\t\t\tobj.type = \"number\";\n\t\t\t\t\t}\n\n\t\t\t\t\treturn obj;\n\t\t\t\t}),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst query = this.getRoot();\n\n\t\tthis.on(this.State.$changes, \"query\", value => {\n\t\t\tquery.$app.callEvent(\"applyFilter\", [null]);\n\t\t\tquery.config.value = value ? fixDates(JSON.parse(value)) : null;\n\t\t});\n\t\tquery.getState().$observe(\"value\", v => {\n\t\t\tthis.State.query = v ? JSON.stringify(v) : \"\";\n\t\t});\n\t}\n}\n\nfunction fixDates(value) {\n\tif (value.rules) value.rules.forEach(fixDates);\n\telse {\n\t\tif (value.type === \"date\") {\n\t\t\tvar c = value.condition;\n\t\t\tif (c.filter && typeof value.condition.filter === \"string\")\n\t\t\t\tc.filter = new Date(c.filter);\n\t\t\tif (c.filter.start && typeof c.filter.start === \"string\")\n\t\t\t\tc.filter.start = new Date(c.filter.start);\n\t\t\tif (c.filter.end && typeof c.filter.end === \"string\")\n\t\t\t\tc.filter.end = new Date(c.filter.end);\n\t\t}\n\t}\n\n\treturn value;\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport { bind } from \"jet-restate-bind\";\nimport { prompt } from \"../../helpers/prompt\";\nimport \"../../helpers/queryselect\";\n\nimport Query from \"./query\";\n\nexport default class QueryBuilderView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst querySelect = {\n\t\t\tlocalId: \"qblock\",\n\t\t\ttype: \"clean\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\ttype: \"form\",\n\t\t\t\t\tmargin: 5,\n\t\t\t\t\tpadding: { bottom: 5 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"queryBar\",\n\t\t\t\t\t\t\tvisibleBatch: \"def\",\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{ view: \"label\", label: _(\"Filtering query\"), width: 120 },\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Delete\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.DeleteQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"copy\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Create copy\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.CopyQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"rename\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-pencil\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Rename\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.RenameQuery(),\n\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\t\t\t\tlocalId: \"save\",\n\t\t\t\t\t\t\t\t\tlabel: _(\"Save\"),\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Save query\"),\n\t\t\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\t\t\tclick: () => this.SaveQuery(null),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"query-select\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\tname: \"id\",\n\t\t\t\t\t\t\tcss: \"webix_rpt_qselect\",\n\t\t\t\t\t\t\tlocalId: \"qselect\",\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\tcss: \"webix_rpt_qselect_suggest\",\n\t\t\t\t\t\t\t\ttemplate: item => this.QSelectTemplate(item),\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\tminHeight: 25,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonShow: function() {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t!this.getBody().$view.firstChild.getAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\tthis.getBody().$view.firstChild.setAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\",\n\t\t\t\t\t\t\t\t\t\t\t\t_(\"No saved queries\")\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonClearClick: () => this.NewQuery(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\ttemplate: _(\"Save filter to use it in other reports\"),\n\t\t\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tQuery,\n\t\t\t],\n\t\t};\n\n\t\treturn querySelect;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst qData = (this.Queries = this.Local.getQueries());\n\n\t\tthis.LocalState = createState({ id: \"\", saved: true });\n\n\t\tqData.waitData.then(() => {\n\t\t\tconst now = this.State.query;\n\t\t\tconst ctrl = this.$$(\"qselect\");\n\t\t\tconst list = ctrl.getList();\n\n\t\t\tconst tables = { [this.State.data]: 1 };\n\t\t\tthis.State.joins.forEach(a => (tables[a.tid] = 1));\n\n\t\t\tqData.filter(a => {\n\t\t\t\tlet res = true;\n\t\t\t\ta.models.forEach(m => {\n\t\t\t\t\tif (!tables[m]) res = false;\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t});\n\t\t\tlist.sync(qData);\n\n\t\t\tqData.data.each(v => {\n\t\t\t\tif (v.text == now) ctrl.setValue(v.id);\n\t\t\t});\n\n\t\t\tthis.on(state.$changes, \"query\", v => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tconst changed = (!id && v) || (id && qData.getItem(id).text != v);\n\t\t\t\tthis.LocalState.saved = !changed;\n\t\t\t});\n\t\t});\n\n\t\tbind(this.LocalState, \"id\", this.$$(\"qselect\"), this);\n\n\t\tconst saveBtn = this.$$(\"save\");\n\t\tthis.on(this.LocalState.$changes, \"saved\", v => {\n\t\t\tif (v) saveBtn.disable();\n\t\t\telse saveBtn.enable();\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"id\", v => {\n\t\t\tif (v) {\n\t\t\t\tconst item = qData.getItem(v);\n\t\t\t\tthis.State.query = item.text;\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"query\");\n\t\t\t} else {\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"def\");\n\t\t\t}\n\t\t});\n\t}\n\n\tNewQuery() {\n\t\tthis.LocalState.id = null;\n\t\tthis.LocalState.saved = true;\n\t\tthis.State.query = null;\n\t}\n\n\tSaveQuery(name) {\n\t\tconst id = this.LocalState.id;\n\t\tconst text = this.State.query;\n\n\t\tif (id) {\n\t\t\tif (name === null) name = this.Queries.getItem(id).name;\n\t\t\tthis.Operations.updateQuery(id, { name, text }).then(() => {\n\t\t\t\tthis.$$(\"qselect\").setValue(id);\n\t\t\t\tthis.LocalState.saved = true;\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t\tvalue: \"\",\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (name) {\n\t\t\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\t\t\tthis.LocalState.saved = true;\n\t\t\t\t\tthis.LocalState.id = id;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tRenameQuery() {\n\t\tconst id = this.LocalState.id;\n\t\tconst { name } = this.Queries.getItem(id);\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tvalue: name,\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (!name) return;\n\n\t\t\tthis.SaveQuery(name);\n\t\t});\n\t}\n\n\tCopyQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet { name, text } = this.Queries.getItem(this.LocalState.id);\n\t\tname = _(\"Copy of\") + \" \" + name;\n\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\tthis.LocalState.id = id;\n\t\t});\n\t}\n\n\tDeleteQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\tok: _(\"Delete\"),\n\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\ttext: _(\"Are you sure to delete this query?\"),\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tthis.Operations.deleteQuery(id).then(() => {\n\t\t\t\t\tthis.LocalState.$batch({ saved: true, id: null });\n\t\t\t\t\tthis.State.query = null;\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tGetMenuOptions() {\n\t\treturn [\n\t\t\t{ id: \"copy\", value: \"Copy\", icon: \"rpi-content-copy\" },\n\t\t\t{ id: \"rename\", value: \"Rename\", icon: \"rpi-pencil\" },\n\t\t\t{ id: \"delete\", value: \"Delete\", icon: \"rpi-delete\" },\n\t\t];\n\t}\n\n\tGetMenuTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\n\tApplyQueryAction(id) {\n\t\tthis.QueryMenu.hide();\n\t\tswitch (id) {\n\t\t\tcase \"rename\":\n\t\t\t\tthis.RenameQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"copy\":\n\t\t\t\tthis.CopyQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tthis.DeleteQuery();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tQSelectTemplate(obj) {\n\t\treturn `${obj.value} <span class='webix_icon wxi-close webix_rpt_qselect_icon'></span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { withContext, createState, debounce } from \"jet-restate\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\toptionWidth: 102,\n\t\t\ttabMinWidth: 102,\n\t\t\tview: \"tabbar\",\n\t\t\tlocalId: \"tabbar\",\n\t\t\tcss: \"webix_rpt_editor_tabbar\",\n\t\t\tborderless: true,\n\t\t\toptions: [\n\t\t\t\t{ id: \"common\", value: _(\"Common\") },\n\t\t\t\t{ id: \"data\", value: _(\"Query\") },\n\t\t\t\t{ id: \"other\", value: _(\"Data\") },\n\t\t\t\t{ id: \"structure\", value: _(\"View\") },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ShowView(v),\n\t\t\t},\n\t\t};\n\n\t\tconst skin = webix.skin.$name;\n\t\tif (skin == \"flat\" || skin == \"compact\" || skin == \"contrast\")\n\t\t\ttabbar.type = \"bottom\";\n\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: { left: 13, top: 0, bottom: 0 },\n\t\t\t//padding: { left: 13, top: webix.skin.$active.layoutPadding.toolbar, bottom: webix.skin.$active.layoutPadding.toolbar },\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tscroll: false,\n\t\t\tcols: [\n\t\t\t\ttabbar,\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\twidth: 40,\n\t\t\t\t\tlocalId: \"closeBtn\",\n\t\t\t\t\ticon: \"rpi-close\",\n\t\t\t\t\tclick: () => this.Hide(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 490,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn this.Local.ready(ui);\n\t}\n\n\tinit() {\n\t\tthis.AppState = this.app.getParam(\"state\");\n\n\t\tconst initial = this.Local.newModule();\n\t\tinitial.id = -1; // mark as temporary\n\n\t\tconst state = (this.State = createState(initial));\n\t\tthis.setParam(\"state\", this.State);\n\n\t\tthis.on(this.AppState.$changes, \"moduleId\", v => this.ChangeModule(v));\n\t\tthis.on(this.State.$changes, \"data\", (id, o, k, ctx) => {\n\t\t\tif (id && (!ctx || !ctx.load)) this.ChangeModel(id);\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowHideButton(v));\n\n\t\tthis.on(\n\t\t\tthis.State.$changes,\n\t\t\t\"*\",\n\t\t\tdebounce(() => {\n\t\t\t\tif (this.State.id === -1) return;\n\n\t\t\t\tthis.TrackChanges();\n\t\t\t\tthis.AppState.module = Object.assign({}, this.State);\n\t\t\t})\n\t\t);\n\n\t\tthis.on(state.$changes, \"group\", (v, old, _key, ctx) => {\n\t\t\tif (!v && old) {\n\t\t\t\t// revert back\n\t\t\t\tconst columns =\n\t\t\t\t\tstate.oldColumns ||\n\t\t\t\t\tthis.Local.getFields(state.data, state.joins, true);\n\t\t\t\tconst numColumns = webix\n\t\t\t\t\t.copy(columns)\n\t\t\t\t\t.filter(a => a.type == \"number\" && !a.key);\n\t\t\t\tconst meta = this.UpdateMeta(numColumns, columns);\n\t\t\t\tstate.$batch({\n\t\t\t\t\tpublicFields: null,\n\t\t\t\t\tcolumns,\n\t\t\t\t\tmeta,\n\t\t\t\t});\n\t\t\t} else if (v) {\n\t\t\t\tlet prev = [];\n\t\t\t\tif (!ctx || !ctx.load) {\n\t\t\t\t\tif (!old) state.oldColumns = state.columns;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (JSON.stringify(v) == JSON.stringify(old)) return;\n\t\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t}\n\n\t\t\t\t// group mode changed, add new columns\n\t\t\t\tlet columns = v.columns.map(a => ({\n\t\t\t\t\tid: `${a.op}.${a.id}`,\n\t\t\t\t\tname: a.name,\n\t\t\t\t\ttype: \"number\",\n\t\t\t\t\tmeta: {},\n\t\t\t\t\tmodel: \"\",\n\t\t\t\t}));\n\t\t\t\tconst groupColumns = webix.copy(columns);\n\t\t\t\tif (v.by)\n\t\t\t\t\tcolumns = columns.concat(\n\t\t\t\t\t\tv.by.map(a => {\n\t\t\t\t\t\t\tconst base = this.State.fields.find(b => b.id == a.id);\n\t\t\t\t\t\t\tconst id = a.mod ? `${a.mod}.${a.id}` : a.id;\n\t\t\t\t\t\t\tconst obj = { ...base, id };\n\t\t\t\t\t\t\tif (a.mod) obj.type = \"text\";\n\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t// apply modifications\n\t\t\t\tconst was = {};\n\t\t\t\t(state.publicFields || state.columns).forEach(a => (was[a.id] = 1));\n\t\t\t\tconst now = {};\n\t\t\t\t// add new / rename\n\t\t\t\tcolumns.forEach(a => {\n\t\t\t\t\tnow[a.id] = 1;\n\t\t\t\t\tif (!was[a.id]) prev.push(a);\n\t\t\t\t\telse {\n\t\t\t\t\t\t// rename a column if needed\n\t\t\t\t\t\tlet column = prev.find(b => b.id == a.id);\n\t\t\t\t\t\tif (column && column.name != a.name) column.name = a.name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//remove old\n\t\t\t\tprev = prev.filter(a => now[a.id]);\n\n\t\t\t\tconst meta = this.UpdateMeta(groupColumns, columns);\n\t\t\t\tif (meta.freeze && meta.freeze >= prev.length) delete meta.freeze;\n\t\t\t\tstate.$batch({ publicFields: columns, columns: prev, meta });\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"saveModule\", () => this.Save());\n\n\t\tthis.on(this.app, \"resetModule\", () => this.Reset());\n\n\t\tthis.on(this.app, \"onColumnResize\", (id, width) => {\n\t\t\tvar next = [...this.State.columns];\n\t\t\tnext.find(a => a.id == id).width = width;\n\t\t\tthis.State.columns = next;\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"readonly\", mod => {\n\t\t\tif (mod) this.Reset();\n\t\t});\n\n\t\tthis.show(\"./editor.common\");\n\t}\n\n\tSave() {\n\t\tconst save = this.Operations.getModuleSaveData(this.State);\n\t\tconst data = {\n\t\t\tname: this.State.name,\n\t\t\ttext: JSON.stringify(save),\n\t\t};\n\n\t\tif (this.AppState.moduleId)\n\t\t\tthis.Operations.updateModule(this.AppState.moduleId, data).then(id =>\n\t\t\t\tthis.SaveCallback(id)\n\t\t\t);\n\t\telse this.Operations.addModule(data).then(id => this.SaveCallback(id));\n\t}\n\tSaveCallback(id) {\n\t\tthis.AppState.$batch({\n\t\t\tmoduleId: id,\n\t\t\tmode: \"view\",\n\t\t\tmodule: Object.assign({}, this.AppState.module),\n\t\t\tsaved: true,\n\t\t});\n\t}\n\n\tShowView(v) {\n\t\tthis.$$(\"tabbar\").setValue(v);\n\t\tthis.show(\"editor.\" + v);\n\t}\n\n\tHide() {\n\t\tthis.Reset();\n\t}\n\n\tReset() {\n\t\tconst id = this.AppState.moduleId;\n\t\tif (!id) {\n\t\t\tthis.AppState.$batch({ mode: \"list\", module: null, saved: true });\n\t\t} else\n\t\t\tthis.Local.getModule(id).then(mod => {\n\t\t\t\tthis.AppState.$batch({\n\t\t\t\t\tmode: \"view\",\n\t\t\t\t\tmodule: Object.assign({}, JSON.parse(mod.text)),\n\t\t\t\t\tsaved: true,\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tChangeModel(id) {\n\t\tif (id) this.State.$batch(this.Local.setDataSource(id));\n\t}\n\n\tChangeModule(id) {\n\t\tthis.InitStateValue = \"\";\n\t\tif (id) {\n\t\t\tthis.Local.getModule(id).then(item => {\n\t\t\t\tconst obj = JSON.parse(item.text);\n\n\t\t\t\tthis.InitStateValue = item.text;\n\t\t\t\tthis.InitName = obj.name = item.name;\n\n\t\t\t\tobj.id = item.id;\n\t\t\t\tobj.saved = true;\n\t\t\t\tobj.fields = this.Local.getFields(obj.data, obj.joins);\n\n\t\t\t\twithContext({ load: true }, () => this.State.$batch(obj));\n\t\t\t\tthis.AppState.saved = true;\n\t\t\t});\n\t\t} else {\n\t\t\tthis.InitStateValue = null; // we need to have an always active Save button\n\t\t\tthis.State.$batch(this.Local.newModule());\n\t\t\tthis.State.fields = this.Local.getFields(\n\t\t\t\tthis.State.data,\n\t\t\t\tthis.State.joins\n\t\t\t);\n\t\t\tthis.AppState.saved = false;\n\t\t}\n\t}\n\tTrackChanges() {\n\t\tthis.AppState.saved =\n\t\t\tJSON.stringify(this.Operations.getModuleSaveData(this.State)) ==\n\t\t\t\tthis.InitStateValue && this.State.name == this.InitName;\n\t}\n\n\tShowHideButton(v) {\n\t\tif (v) this.$$(\"closeBtn\").show();\n\t\telse this.$$(\"closeBtn\").hide();\n\t}\n\n\tUpdateMeta(numColumns, columns) {\n\t\tlet meta = this.State.meta;\n\t\tconst state = this.State;\n\t\tif (numColumns.length) {\n\t\t\tif (state.type == \"chart\") {\n\t\t\t\tnumColumns = numColumns.map(a => {\n\t\t\t\t\tconst c = { ...a, value: a.name };\n\t\t\t\t\tdelete c.name;\n\t\t\t\t\treturn c;\n\t\t\t\t});\n\t\t\t\tmeta.chart.series = this.app\n\t\t\t\t\t.getService(\"charts\")\n\t\t\t\t\t.getSeries(numColumns, state.chartType);\n\t\t\t} else if (state.type == \"heatmap\") {\n\t\t\t\tmeta.value = numColumns[0].id;\n\t\t\t\tmeta.label = state.publicFields\n\t\t\t\t\t? columns[columns.length - 1].id\n\t\t\t\t\t: columns[0].id;\n\t\t\t\tif (meta.color && !numColumns.find(a => a.id == meta.color))\n\t\t\t\t\tmeta.color = numColumns[0].id;\n\t\t\t}\n\t\t}\n\t\treturn meta;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, masterName) {\n\t\tsuper(app);\n\t\tthis.Name = masterName;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.ClickHandler(id);\n\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t},\n\t\t\t\tdata: this.GetOptions(),\n\t\t\t},\n\t\t};\n\t}\n\n\tClickHandler(id) {\n\t\tthis.getParentView().ApplyAction(id);\n\t}\n\tShow(node, data, index) {\n\t\tthis.SetActionStates(data, index);\n\t\tthis.getRoot().show(node);\n\t}\n\tGetOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [{ id: \"delete\", value: _(\"Delete\"), icon: \"rpi-delete\" }];\n\t}\n\tSetActionStates(data) {\n\t\tconst popup = this.getRoot();\n\t\tconst list = popup.getBody();\n\t\tlist.data.each(action => {\n\t\t\tif (data.length == 1) list.disableItem(action.id);\n\t\t\telse list.enableItem(action.id);\n\t\t});\n\t}\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span> ${obj.value}`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class BucketView extends JetView {\n\tconstructor(app, state, pstate) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.ParentState = pstate;\n\t}\n\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.ValueSeparator = \",\";\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: 0, bottom: 0, left: 0, right: 0 },\n\t\t\tlocalId: \"forms\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\telements: [],\n\t\t};\n\t\tconst other = {\n\t\t\tlocalId: \"other\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\twidth: 150,\n\t\t\t\t\tplaceholder: _(\"Bucket name\"),\n\t\t\t\t\tvalue: _(\"Other\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.Changed(\"other\", \"name\", v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\tlabel: _(\"Other values\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t};\n\t\tconst padding = webix.skin.$active.layoutPadding.form;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpadding: { top: padding, bottom: padding, left: 0, right: 0 },\n\t\t\tcss: \"webix_rpt_subview\",\n\t\t\trows: [\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\tother,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add bucket\"),\n\t\t\t\t\tinputWidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewBucket(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Forms = this.$$(\"forms\");\n\t\tthis.GetRowKeys(this.State.id).then(data => {\n\t\t\tthis.Data = data.sort((a, b) => this.Sort(a, b));\n\t\t\tthis.CreateForm();\n\t\t});\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (name == \"bucket\" && action == \"focus\" && id == this.State.id)\n\t\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.ParentState.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetColumnData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\tGetColumnData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = [baseColumn];\n\t\tdelete moduleConfig.buckets;\n\t\tdelete moduleConfig.group;\n\t\tlet waitData = [\n\t\t\tthis.Local.getData(moduleConfig),\n\t\t\tthis.Local.getOptionsList(baseColumn),\n\t\t];\n\t\treturn Promise.all(waitData);\n\t}\n\n\tCreateForm() {\n\t\tconst options = this.State.options;\n\t\tif (options && options.length) this.LoadBuckets(options);\n\t\telse this.AddNewBucket();\n\t\twebix.delay(() => {\n\t\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"resize\", this.State.id]);\n\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\n\tAddNewBucket() {\n\t\tthis.AddBucket();\n\t\tthis.Changed();\n\t\tthis.Focus();\n\t}\n\n\tLoadBuckets(data) {\n\t\tdata.forEach(bucket => {\n\t\t\tif (!bucket.values) this.LoadOther(bucket);\n\t\t\telse this.AddBucket(bucket);\n\t\t});\n\t\tthis.Changed();\n\t}\n\tLoadOther(b) {\n\t\tconst other = this.$$(\"other\");\n\t\tother.setValues({ name: b.id });\n\t}\n\tAddBucket(bucket) {\n\t\tbucket = bucket || {};\n\t\tthis.Forms.addView(this.GetRowForm(webix.uid(), bucket));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: data.id || null,\n\t\t\t\t\t\tplaceholder: this._(\"Bucket name\"),\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: v => this.Changed(id, \"name\", v),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"multicombo\",\n\t\t\t\tname: \"values\",\n\t\t\t\tplaceholder: this._(\"Bucket values\"),\n\t\t\t\tcss: \"webix_multilist webix_rpt_multicombo\",\n\t\t\t\tseparator: this.ValueSeparator,\n\t\t\t\tsuggest: {\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_multilist webix_rpt_bucket_values\",\n\t\t\t\t\t\tdata: this.Data,\n\t\t\t\t\t\ttemplate: obj => this.OptionTemplate(id, obj),\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tthis.getList().refresh();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tvalue: data.values || null,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"values\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\ticon: \"wxi-dots\",\n\t\t\t\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t\tvalues: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"bucket\"));\n\t\tconst form = webix\n\t\t\t.$$(id)\n\t\t\t.getParentView()\n\t\t\t.getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetValues(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\tGetValidBuckets() {\n\t\tconst otherForm = this.$$(\"other\");\n\t\tconst otherName = otherForm.elements.name.getValue();\n\t\totherForm.validate();\n\t\tconst names = {};\n\t\tif (otherName) names[otherName] = [otherForm];\n\t\tconst options = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tform.validate();\n\t\t\tlet values = form.getValues();\n\t\t\tlet n = values.name;\n\t\t\tif (n) {\n\t\t\t\tif (names[n]) {\n\t\t\t\t\tthis.$$(names[n]).forEach(f => f.markInvalid(\"name\", true));\n\t\t\t\t\tform.markInvalid(\"name\", true);\n\t\t\t\t} else if (values.values.length)\n\t\t\t\t\toptions.push({ id: n, values: values.values.split(\",\") });\n\t\t\t\tif (!names[n]) names[n] = [];\n\t\t\t\tnames[n].push(form);\n\t\t\t}\n\t\t});\n\t\tif (options.length && otherName) options.push({ id: otherName });\n\t\treturn options;\n\t}\n\tChanged(id, name, value) {\n\t\tif (name == \"values\") this.CorrectValues(id, value);\n\t\tconst options = this.GetValidBuckets();\n\t\tthis.State.options = options;\n\t}\n\n\tOptionTemplate(id, obj) {\n\t\tlet selected =\n\t\t\t!obj.$checked &&\n\t\t\tthis.GetValues().find(\n\t\t\t\tbucket => bucket.id != id && bucket.values.indexOf(obj.value) > -1\n\t\t\t);\n\t\tconst css =\n\t\t\t\"webix_rpt_bucket_value\" +\n\t\t\t(selected ? \" webix_rpt_bucket_value_selected\" : \"\");\n\t\treturn (\n\t\t\t\"<div class='\" +\n\t\t\tcss +\n\t\t\t\"'>\" +\n\t\t\tobj.value +\n\t\t\t\"</div>\" +\n\t\t\t(selected\n\t\t\t\t? \"<span class='webix_rpt_bucket_icon webix_icon rpi-pail-outline'></span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\tGetValues() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tconst v = form.getValues();\n\t\t\tv.id = form.config.localId;\n\t\t\tdata.push(v);\n\t\t});\n\t\treturn data;\n\t}\n\tForEachFormRow(handler) {\n\t\tthis.Forms.getChildViews().forEach(form => {\n\t\t\tif (form && form.elements) {\n\t\t\t\thandler(form);\n\t\t\t}\n\t\t});\n\t}\n\tCorrectValues(id, v) {\n\t\tthis.ForEachFormRow(form => {\n\t\t\tif (form.config.localId != id) {\n\t\t\t\tlet values = form.getValues().values.split(\",\");\n\t\t\t\tvalues = values.filter(a => v.indexOf(a) == -1);\n\t\t\t\tform.elements.values.setValue(values);\n\t\t\t}\n\t\t});\n\t}\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteBucket(this.ActiveForm);\n\t}\n\n\tDeleteBucket(form) {\n\t\tthis.Forms.removeView(form);\n\t\tthis.Changed();\n\t}\n\tSort(a, b) {\n\t\tconst type = this.ParentState.fields.find(c => c.id == this.State.id).type;\n\t\ta = a.value;\n\t\tb = b.value;\n\t\tif (type == \"number\") {\n\t\t\ta = a * 1;\n\t\t\tb = b * 1;\n\t\t\tif (isNaN(b)) return 1;\n\t\t\tif (isNaN(a)) return -1;\n\t\t} else {\n\t\t\tif (!b) return 1;\n\t\t\tif (!a) return -1;\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t}\n\t\treturn a > b ? 1 : a < b ? -1 : 0;\n\t}\n\tFocus(index) {\n\t\twebix.delay(\n\t\t\t() => {\n\t\t\t\tconst forms = this.Forms.getChildViews();\n\t\t\t\tif (typeof index == \"undefined\") index = forms.length - 1;\n\t\t\t\tconst form = forms[index];\n\t\t\t\tif (form) form.elements.name.focus();\n\t\t\t},\n\t\t\tnull,\n\t\t\tnull,\n\t\t\t100\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tautoheight: true,\n\t\t\tfitMaster: true,\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpadding: { top: 5, bottom: 5, left: 10, right: 10 },\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\t\t\t\tplaceholder: _(\"Search\"),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\tscroll: true,\n\t\t\t\t\t\tyCount: 5,\n\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\t\t\tconst item = this.List.getItem(id);\n\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\tthis.View.hide();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonEnter: () => {\n\t\t\t\t\t\t\t\tconst item = this.List.getSelectedItem();\n\t\t\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\t\twebix.delay(() => this.View.hide());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.View = this.getRoot();\n\t\tconst views = this.View.getBody().getChildViews();\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.BucketState = this.getParam(\"buckets\", true);\n\t\tthis.Text = views[0].getChildViews()[0];\n\t\tthis.List = views[1];\n\t\tthis.Text.attachEvent(\"onTimedKeyPress\", () => {\n\t\t\tthis.Find(this.Text.getValue());\n\t\t});\n\t}\n\tAddColumn(column) {\n\t\tconst t = [...this.BucketState.buckets];\n\t\tt.push({ column: column.id, options: [] });\n\t\tthis.BucketState.buckets = t;\n\t}\n\tShow(node) {\n\t\tnode = node.firstChild.firstChild;\n\t\tthis.View.config.width = node.offsetWidth - 2;\n\t\tthis.View.adjust();\n\t\tthis.View.show(node);\n\t\tthis.Text.focus();\n\t\tthis.List.clearAll();\n\t\tthis.List.parse(this.GetColumns());\n\t}\n\tGetColumns() {\n\t\tlet columns = this.State.fields;\n\t\tif (this.State.publicFields)\n\t\t\tcolumns = columns.filter(a =>\n\t\t\t\tthis.State.publicFields.find(b => b.id == a.id)\n\t\t\t);\n\t\treturn columns.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t\tdisabled:\n\t\t\t\tthis.BucketState.buckets &&\n\t\t\t\tthis.BucketState.buckets.find(b => b.column == a.id),\n\t\t}));\n\t}\n\n\tGetTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tFind(value) {\n\t\tvalue = value.toLowerCase();\n\t\tif (value)\n\t\t\tthis.List.filter(item => item.value.toLowerCase().indexOf(value) > -1);\n\t\telse this.List.filter(\"\");\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"groupselect\",\n\t\t$cssName: \"text webix_rpt_groupselect\",\n\t\tdefaults: {\n\t\t\tselectIcon: true,\n\t\t\tmodifiers: {},\n\t\t},\n\t\trenderModifier(id) {\n\t\t\tconst mid = this._modifiers[id];\n\t\t\tif (mid) {\n\t\t\t\tconst option = this.config.modifiers.find(a => a.id === mid);\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_rpt_date_selector'>\" +\n\t\t\t\t\t(option ? option.value : \"\") +\n\t\t\t\t\t(this.config.selectIcon\n\t\t\t\t\t\t? \"<span class='webix_icon wxi-angle-down'></span>\"\n\t\t\t\t\t\t: \"\") +\n\t\t\t\t\t\"</div> <span class='webix_rpt_groupselect_sep'> | </span> \"\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\t$renderTag(text, width, height, value) {\n\t\t\tlet content = this.renderModifier(value);\n\t\t\tcontent +=\n\t\t\t\t\"<span>\" +\n\t\t\t\ttext +\n\t\t\t\t\"</span><span class='webix_multicombo_delete webix_rpt_groupselect_delete' role='button' aria-label='\" +\n\t\t\t\twebix.i18n.aria.removeItem +\n\t\t\t\t\"'></span>\";\n\t\t\treturn (\n\t\t\t\t\"<li class='webix_multicombo_value' style='line-height:\" +\n\t\t\t\theight +\n\t\t\t\t\"px;' optvalue='\" +\n\t\t\t\twebix.template.escape(value) +\n\t\t\t\t\"'>\" +\n\t\t\t\tcontent +\n\t\t\t\t\"</li>\"\n\t\t\t);\n\t\t},\n\t\t$init() {\n\t\t\tthis._modifiers = {};\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_date_selector: function(e, id, node) {\n\t\t\t\t\tlet value = webix.html.locate(e, \"optvalue\");\n\t\t\t\t\tthis.callEvent(\"onModifierClick\", [value, e, node]);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tsetValue(value) {\n\t\t\tif (value) {\n\t\t\t\tif (typeof value !== \"string\" && typeof value[0] !== \"string\") {\n\t\t\t\t\tthis._modifiers = {};\n\t\t\t\t\tvalue = value.map(a => {\n\t\t\t\t\t\tthis._modifiers[a.id] = a.mod || null;\n\t\t\t\t\t\treturn a.id;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t\t} else {\n\t\t\t\tthis._modifiers = {};\n\t\t\t}\n\n\t\t\treturn webix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t},\n\t\tgetModifier(id) {\n\t\t\treturn this._modifiers[id];\n\t\t},\n\t\tsetModifier(id, value, silent) {\n\t\t\tthis._modifiers[id] = value;\n\t\t\tif (!silent) this.callEvent(\"onChange\", []);\n\t\t\tthis.refresh();\n\t\t},\n\t\t// [FIXME] bug in multicombo repainting during view replacing\n\t\t$setSize: function(x, y) {\n\t\t\tvar config = this.config;\n\n\t\t\tconst [px, py] = this._custom_last_size || [0, 0];\n\t\t\tif (x == px && y == py) return;\n\t\t\tthis._custom_last_size = [x, y];\n\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tif (!x || !y) return;\n\t\t\t\tif (config.labelPosition == \"top\") {\n\t\t\t\t\tconfig.labelWidth = 0;\n\t\t\t\t}\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t},\n\t},\n\twebix.ui.multicombo\n);\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport \"../../../helpers/groupselect\";\nimport BucketView from \"./bucket\";\nimport BucketPopup from \"./bucketpopup\";\n\nexport default class BucketSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Views = {};\n\t\tconst columns = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns and their data buckets\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"addColumn\",\n\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\tclick: () => this.ShowColumns(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list webix_rpt_bcols\",\n\t\t\tlocalId: \"table\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst buckets = createState({\n\t\t\t\t\tid: obj.id,\n\t\t\t\t\toptions: obj.options,\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tbuckets.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, buckets);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = (this.Views[obj.id] = new BucketView(\n\t\t\t\t\tthis.app,\n\t\t\t\t\tbuckets,\n\t\t\t\t\tthis.State\n\t\t\t\t));\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ToggleSub(id),\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_bucket_delete: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\t\t\t\tok: _(\"Delete\"),\n\t\t\t\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveColumn(id));\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [columns, buckets],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Table = this.$$(\"table\");\n\t\tconst buckets = this.State.buckets || [];\n\n\t\tthis.BucketState = createState({ buckets, newColumn: null });\n\t\tthis.LoadBuckets();\n\t\tthis.setParam(\"buckets\", this.BucketState);\n\t\tthis.on(\n\t\t\tthis.BucketState.$changes,\n\t\t\t\"*\",\n\t\t\tignoreInitial((v, o) => this.Changed(v, o))\n\t\t);\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (this.getRoot() && name == \"bucket\" && action == \"resize\")\n\t\t\t\tthis.Table.refresh(id);\n\t\t});\n\t}\n\tShowColumns() {\n\t\tif (!this.ColumnList || !this.ColumnList.$view)\n\t\t\tthis.ColumnList = this.ui(BucketPopup, this.State);\n\t\tthis.ColumnList.Show(this.$$(\"addColumn\").$view);\n\t}\n\n\tLoadBuckets() {\n\t\tconst tableData = this.BucketState.buckets\n\t\t\t? this.BucketState.buckets.map(a => {\n\t\t\t\t\tconst field = this.State.fields.find(f => f.id == a.column);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: a.column,\n\t\t\t\t\t\tname: field.name,\n\t\t\t\t\t\tmodel: field.model || null,\n\t\t\t\t\t\toptions: a.options,\n\t\t\t\t\t};\n\t\t\t  })\n\t\t\t: [];\n\t\tthis.Table.clearAll();\n\t\tthis.Table.parse(tableData);\n\t\tif (!tableData.length) this.Table.hide();\n\t}\n\tAddColumn(id) {\n\t\tif (this.Table.config.hidden) this.Table.show();\n\t\tconst field = this.State.fields.find(f => f.id == id);\n\t\tthis.Table.add({\n\t\t\tid,\n\t\t\tname: field.name,\n\t\t\tmodel: field.model || null,\n\t\t\toptions: [],\n\t\t});\n\t}\n\tRemoveColumn(id) {\n\t\tthis.Table.remove(id);\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst i = buckets.findIndex(a => a.column == id);\n\t\tbuckets.splice(i, 1);\n\t\tthis.BucketState.buckets = buckets;\n\t\tif (!buckets.length) this.Table.hide();\n\t\tif (this._ActiveEditor && String(id) == String(this._ActiveEditor))\n\t\t\tthis.ResetEditor();\n\t\tthis.Views[id].destructor();\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChanged(newV, oldV) {\n\t\tif (newV.length > oldV.length) {\n\t\t\tconst id = newV[newV.length - 1].column;\n\t\t\tthis.AddColumn(id);\n\t\t\tthis.Table.openSub(id);\n\t\t}\n\t\tconst buckets = this.BucketState.buckets.filter(b => b.options.length);\n\t\tthis.State.buckets = buckets;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tconst html = `<div class='webix_rpt_config_row'>\n\t\t\t<span class='webix_rpt_buckets_num'>\n\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"buckets\")}: </span>\n\t\t\t\t\t${item.options.length}\n\t\t\t\t</span>\n\t\t\t\t<div class='webix_rpt_config_row_name'>\n\t\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"column\")}: </span>\n\t\t\t\t\t${item.name}${\n\t\t\titem.model\n\t\t\t\t? `<span class='webix_rpt_sources_path'>${item.model}</span>`\n\t\t\t\t: \"\"\n\t\t}\n\t\t\t\t</div>\n\t\t\t\t<span class='webix_icon rpi-delete webix_rpt_bucket_delete'></span>\n\t\t\t\t${common.subrow(item, common)}\n\t\t\n\t\t</div>`;\n\n\t\treturn html;\n\t}\n\n\tHideAllEditors(id) {\n\t\tconst prevId = this._ActiveEditor;\n\t\tif (prevId && this.Table.getItem(prevId)) this.Table.closeSub(prevId);\n\n\t\tthis._ActiveEditor = id;\n\t\tif (id) this.FocusEditor();\n\t}\n\tFocusEditor() {\n\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"focus\", this._ActiveEditor]);\n\t}\n\n\tResetEditor() {\n\t\tthis._ActiveEditor = null;\n\t}\n\n\tToggleSub(id) {\n\t\tvar row = this.Table.getItem(id);\n\t\tif (row.$subopen) this.Table.closeSub(id);\n\t\telse this.Table.openSub(id);\n\t}\n\tUpdate(id, data) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst column = this.BucketState.buckets.find(b => b.column == id);\n\t\tcolumn.options = data.options;\n\t\tthis.BucketState.buckets = buckets;\n\t\tthis.Table.updateItem(id, { options: column.options });\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tcss: \"webix_rpt_grouppopup\",\n\t\t\t\ttemplate: obj => this.GetPopupTemplate(obj),\n\t\t\t\tdata: this.Master.config.modifiers,\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.Master.setModifier(this.ActiveGroup, id);\n\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t$init() {\n\t\tthis.ActiveGroup = null;\n\t}\n\tGetPopupTemplate(obj) {\n\t\tconst isSelected = obj.id == this.Master.getModifier(this.ActiveGroup);\n\t\treturn `${obj.value} <span class='webix_icon wxi-radiobox-${\n\t\t\tisSelected ? \"marked\" : \"blank\"\n\t\t}'></span>`;\n\t}\n\tShow(node, id) {\n\t\tthis.ActiveGroup = id;\n\t\tthis.getRoot().show(node, { x: -10 });\n\t\tthis.getRoot()\n\t\t\t.getBody()\n\t\t\t.refresh();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class Summaries extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst labels = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Function\"),\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Column\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"New column name\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 38,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tlocalId: \"summaries\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tcss: \"webix_rpt_summary_form\",\n\t\t\telements: [],\n\t\t};\n\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [{ view: \"label\", label: _(\"Group summaries\") }],\n\t\t\t\t},\n\t\t\t\tlabels,\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\twidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewAggregation(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.GroupState = this.getParam(\"group\", true);\n\n\t\tthis.SummaryColumns = this.State.fields\n\t\t\t.filter(column => {\n\t\t\t\treturn (\n\t\t\t\t\t(column.type == \"number\" || column.type == \"date\") && !column.key\n\t\t\t\t);\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\tthis.CreateForm();\n\t\tthis.on(this.GroupState.$changes, \"by\", () => this.ValidateFormData());\n\t}\n\n\tCreateForm() {\n\t\tconst aggregate = this.GroupState.columns;\n\t\tif (aggregate && aggregate.length) this.LoadAggregations(aggregate);\n\t\telse this.AddNewAggregation();\n\n\t\tif (!this.SummaryColumns.length) {\n\t\t\tthis.ApplyOneRowMode();\n\t\t}\n\t}\n\tApplyOneRowMode() {\n\t\tconst rows = this.getRoot().getChildViews();\n\t\trows[3].hide();\n\t\trows[4].hide();\n\t}\n\n\tAddNewAggregation() {\n\t\tthis.AddAggregation();\n\t\tthis.Changed();\n\t}\n\n\tLoadAggregations(data) {\n\t\tdata.forEach(summary => {\n\t\t\tthis.AddAggregation(summary);\n\t\t});\n\t\tthis.Changed();\n\t}\n\n\tAddAggregation(aggregation) {\n\t\taggregation = aggregation || this.GetDefaultFormData();\n\t\tif (!aggregation) return false;\n\t\tconst formId = aggregation.id || \"form\" + webix.uid();\n\t\tthis.$$(\"summaries\").addView(this.GetRowForm(formId, aggregation));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\twidth: 100,\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"op\",\n\t\t\t\tvalue: data.op || null,\n\t\t\t\toptions: this.GetOperations(),\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"op\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"id\",\n\t\t\t\tdisabled: data.op == \"count\",\n\t\t\t\tvalue: data.id || null,\n\t\t\t\toptions: this.SummaryColumns,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"id\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"text\",\n\t\t\t\tvalue: data.name || null,\n\t\t\t\tname: \"name\",\n\t\t\t\ton: {\n\t\t\t\t\tonTimedKeypress: v => this.Changed(id, \"name\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tcols.push({\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-dots\",\n\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t});\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tid: value => {\n\t\t\t\t\tconst groupBy = this.GroupState.by;\n\t\t\t\t\treturn !groupBy || groupBy.indexOf(value) < 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\n\tGetDefaultFormData() {\n\t\tconst data = this.GetData();\n\t\tconst columns = this.SummaryColumns;\n\t\tconst operations = this.GetOperations();\n\t\tif (!columns.length) {\n\t\t\tconst op = !data.length ? operations.find(op => op.id == \"count\") : null;\n\t\t\treturn op\n\t\t\t\t? {\n\t\t\t\t\t\top: \"count\",\n\t\t\t\t\t\tid: \"\",\n\t\t\t\t\t\tname: this.NewColumnTemplate(op),\n\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t  }\n\t\t\t\t: null;\n\t\t} else {\n\t\t\tfor (let i = 0; i < operations.length; i++) {\n\t\t\t\tfor (let j = 0; j < columns.length; j++) {\n\t\t\t\t\tconst op = operations[i];\n\t\t\t\t\tif (\n\t\t\t\t\t\t!data.find(\n\t\t\t\t\t\t\trow =>\n\t\t\t\t\t\t\t\trow.op == op.id && (op.id == \"count\" || row.id == columns[j].id)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\top: op.id,\n\t\t\t\t\t\t\tid: op.id != \"count\" ? columns[j].id : null,\n\t\t\t\t\t\t\tname: this.NewColumnTemplate(op, columns[j]),\n\t\t\t\t\t\t\ttype: columns[j].type,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tNewColumnTemplate(operation, column) {\n\t\treturn operation.id == \"count\"\n\t\t\t? operation.value\n\t\t\t: operation.value + \" \" + column.value;\n\t}\n\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"summary\"));\n\t\tconst form = webix.$$(id).getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetData(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteAggregation();\n\t}\n\n\tDeleteAggregation(form) {\n\t\tform = form || this.ActiveForm;\n\t\tconst formList = form.getParentView();\n\t\tif (formList.getChildViews().length > 1) formList.removeView(form);\n\t\telse form.setValues({});\n\t\tthis.Changed();\n\t}\n\n\tGetOperations() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"sum\", value: _(\"Sum\") },\n\t\t\t{ id: \"count\", value: _(\"Count\") },\n\t\t\t{ id: \"avg\", value: _(\"Average\") },\n\t\t\t{ id: \"max\", value: _(\"Max\") },\n\t\t\t{ id: \"min\", value: _(\"Min\") },\n\t\t];\n\t}\n\n\tGetData() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tdata.push(form.getValues());\n\t\t});\n\t\treturn data;\n\t}\n\n\tForEachFormRow(handler) {\n\t\tthis.$$(\"summaries\")\n\t\t\t.getChildViews()\n\t\t\t.forEach(form => {\n\t\t\t\tif (form && form.elements) {\n\t\t\t\t\thandler(form);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tValidateFormData() {\n\t\tlet valid = true;\n\t\tthis.ForEachFormRow(form => (valid = form.validate() && valid));\n\t\treturn valid;\n\t}\n\n\tChangeNewColumnName(formId) {\n\t\tconst form = this.$$(formId).elements;\n\t\tconst oId = form.op.getValue();\n\t\tconst cId = form.id.getValue();\n\t\tconst operations = this.GetOperations();\n\n\t\tif (oId) {\n\t\t\tif (oId == \"count\")\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(operations.find(o => o.id == oId))\n\t\t\t\t);\n\t\t\telse if (cId)\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(\n\t\t\t\t\t\toperations.find(o => o.id == oId),\n\t\t\t\t\t\tthis.SummaryColumns.find(c => c.id == cId)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tChanged(formId, name, value) {\n\t\tif (name == \"op\" || name == \"id\") this.ChangeNewColumnName(formId);\n\t\tif (name == \"op\" && value == \"count\") {\n\t\t\tthis.$$(formId).elements.id.setValue(null);\n\t\t\tthis.$$(formId).elements.id.disable();\n\t\t} else {\n\t\t\tif (formId && name) this.$$(formId).elements.id.enable();\n\t\t}\n\n\t\tthis.ValidateFormData();\n\t\tconst columns = this.GetData();\n\t\tcolumns.forEach(\n\t\t\ta =>\n\t\t\t\t(a.type = (\n\t\t\t\t\tthis.SummaryColumns.find(b => b.id == a.id) || { type: \"number\" }\n\t\t\t\t).type)\n\t\t);\n\t\tthis.GroupState.columns = columns;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport Summaries from \"./summary\";\nimport \"../../../helpers/groupselect\";\nimport DatePopupView from \"./datepopup\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupBy = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns to group by and output(s)\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"groupBy\",\n\t\t\t\t\tmodifiers: this.GetDateOptions(),\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeGroupBy(),\n\t\t\t\t\t\tonModifierClick: (id, e, node) =>\n\t\t\t\t\t\t\tthis.ShowModifierPopup(id, e, node),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"groupByLayout\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [groupBy, Summaries],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst groupState = this.State.group || {};\n\t\tthis.GroupState = createState({\n\t\t\tby: groupState.by || null,\n\t\t\tcolumns: groupState.columns || null,\n\t\t});\n\n\t\tthis.LoadColumns();\n\n\t\tthis.setParam(\"group\", this.GroupState);\n\t\tthis.on(this.GroupState.$changes, \"*\", ignoreInitial(() => this.Apply()));\n\t}\n\n\tChangeGroupBy() {\n\t\tconst group = this.$$(\"groupBy\");\n\t\tconst list = group.getPopup().getList();\n\t\tlet arr = group.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tthis.GroupState.by = arr.map(a => {\n\t\t\tlet mod = group.getModifier(a);\n\t\t\tif (list.getItem(a).type === \"date\" && !mod) {\n\t\t\t\tmod = \"year\";\n\t\t\t\tgroup.setModifier(a, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id: a };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\t}\n\n\tFilterGroupByColumns(column) {\n\t\treturn column.id != \"id\";\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = this.State.fields.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\t\tconst groupBy = this.$$(\"groupBy\");\n\t\tconst list = groupBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.parse(columns);\n\n\t\tthis.$$(\"groupBy\").setValue(this.GroupState.by);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tShowModifierPopup(id, e, node) {\n\t\tif (!this.DatePopup)\n\t\t\tthis.DatePopup = this.ui(new DatePopupView(this.app, this.$$(\"groupBy\")));\n\t\twebix.delay(() => this.DatePopup.Show(node, id));\n\t}\n\n\tGetDateOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t{ id: \"yearmonth\", value: _(\"Year\") + \"/\" + _(\"Month\") },\n\t\t\t{\n\t\t\t\tid: \"yearmonthday\",\n\t\t\t\tvalue: _(\"Year\") + \"/\" + _(\"Month\") + \"/\" + _(\"Day\"),\n\t\t\t},\n\t\t];\n\t}\n\tApply() {\n\t\tconst s = this.GroupState;\n\t\tthis.State.group = {\n\t\t\tby: s.by || null,\n\t\t\tcolumns: s.columns || [],\n\t\t};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"groupBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleGroupBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Group\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"bucketsSwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleBuckets(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Data buckets\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst sortByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"sortBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleSortBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Sort\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\trows: [\n\t\t\t\t\tgroupByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"group\" },\n\t\t\t\t\tbuckets,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"buckets\" },\n\t\t\t\t\tsortByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"sort\" },\n\t\t\t\t\t{ gravity: 0.000001 },\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"groupBySwitch\").setValue(!!this.State.group);\n\t\tthis.$$(\"sortBySwitch\").setValue(!!this.State.sort);\n\t\tthis.$$(\"bucketsSwitch\").setValue(!!this.State.buckets);\n\t}\n\n\tToggleGroupBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.groups\", { target: \"group\" });\n\t\t} else {\n\t\t\tthis.State.group = null;\n\t\t\tthis.show(\"_hidden\", { target: \"group\" });\n\t\t}\n\t}\n\n\tToggleSortBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.sorts\", { target: \"sort\" });\n\t\t} else {\n\t\t\tthis.State.sort = null;\n\t\t\tthis.show(\"_hidden\", { target: \"sort\" });\n\t\t}\n\t}\n\tToggleBuckets(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.buckets\", { target: \"buckets\" });\n\t\t} else {\n\t\t\tthis.State.buckets = null;\n\t\t\tthis.show(\"_hidden\", { target: \"buckets\" });\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sortAsc, sortDesc } from \"helpers/icons\";\nimport \"../../../helpers/groupselect\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst sortBy = {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Specify columns to sort by\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"sortBy\",\n\t\t\t\t\tselectIcon: false,\n\t\t\t\t\tcss: \"webix_rpt_sort_selector\",\n\t\t\t\t\tmodifiers: [\n\t\t\t\t\t\t{ id: \"asc\", value: sortAsc },\n\t\t\t\t\t\t{ id: \"desc\", value: sortDesc },\n\t\t\t\t\t],\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeSortBy(),\n\t\t\t\t\t\tonModifierClick: id => this.ChangeDirection(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn sortBy;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.on(this.State.$changes, \"publicFields\", v => {\n\t\t\tif (v) this.LoadColumns();\n\t\t});\n\t\tthis.on(this.State.$changes, \"fields\", () => {\n\t\t\tif (!this.State.publicFields) this.LoadColumns();\n\t\t});\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = (this.State.publicFields || this.State.fields).map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\n\t\tconst sortBy = this.$$(\"sortBy\");\n\t\tconst list = sortBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.clearAll();\n\t\tlist.parse(columns);\n\n\t\tlet sort = this.State.sort;\n\t\tif (sort) sort = sort.filter(a => !!columns.find(b => b.id == a.id));\n\t\tsortBy.setValue(sort);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChangeSortBy() {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tlet arr = ui.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tconst state = arr.map(id => {\n\t\t\tlet mod = ui.getModifier(id);\n\t\t\tif (!mod) {\n\t\t\t\tmod = \"asc\";\n\t\t\t\tui.setModifier(id, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\n\t\tthis.State.sort = state.length ? state : null;\n\t}\n\n\tChangeDirection(id) {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tui.setModifier(id, ui.getModifier(id) === \"asc\" ? \"desc\" : \"asc\");\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class AxisPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Axis = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabel: _(\"Logarithmic scale\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"logarithmic\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"title\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabelWidth: 190,\n\t\t\t\t\t\tlabel: _(\"Gridlines\"),\n\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\tname: \"lines\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tname: \"lineColor\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tlabel: _(\"Vertical labels\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"verticalLabels\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabelWidth: 190,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.Axis.$changes, \"id\", id => {\n\t\t\tif (id == \"y\") this.ApplyYAxis();\n\t\t\telse this.ApplyXAxis();\n\t\t});\n\t\tthis.on(this.Axis.$changes, \"lines\", v => {\n\t\t\tconst lineColor = this.getRoot().elements[\"lineColor\"];\n\t\t\tif (v) lineColor.show();\n\t\t\telse lineColor.hide();\n\t\t});\n\t\tbind(this.Axis, \"*\", this.getRoot());\n\t}\n\n\tApplyYAxis() {\n\t\tthis.getRoot().elements[\"logarithmic\"].show();\n\t}\n\tApplyXAxis() {\n\t\tthis.getRoot().elements[\"verticalLabels\"].show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseStructureView extends JetView {\n\tHideField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: false });\n\t\tthis.SaveOrder();\n\t}\n\n\tShowField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: true });\n\t\tthis.SaveOrder();\n\t}\n\n\tHideAllEditors(id, name) {\n\t\tif (!name) name = \"fields\";\n\t\tif (this._ActiveEditor[name])\n\t\t\tthis.$$(name).closeSub(this._ActiveEditor[name]);\n\n\t\tthis._ActiveEditor[name] = id;\n\t\tif (id) {\n\t\t\twebix.delay(\n\t\t\t\t() => {\n\t\t\t\t\tconst subView = this.$$(name).getSubView(id);\n\t\t\t\t\tif (subView) subView.focus();\n\t\t\t\t},\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t}\n\n\tResetEditor(name) {\n\t\tthis._ActiveEditor[name || \"fields\"] = null;\n\t}\n\n\tToggleSub(id, name) {\n\t\tconst table = this.$$(name || \"fields\");\n\t\tvar row = table.getItem(id);\n\t\tif (row.$subopen) table.closeSub(id);\n\t\telse table.openSub(id);\n\t}\n\n\tSaveOrder() {}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ColorPopupView extends JetView {\n\tconstructor(app, state) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.Id = null;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"colorselect\",\n\t\t\t\tbutton: true,\n\t\t\t\ton: {\n\t\t\t\t\tonColorSelect: color => {\n\t\t\t\t\t\tlet s = this.GetSeries(this.Id);\n\t\t\t\t\t\tif (s) s.meta.color = color;\n\t\t\t\t\t\tthis.State.updatedSeries = this.Id;\n\t\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tShow(node, id) {\n\t\tconst popup = this.getRoot();\n\t\tthis.Id = id;\n\t\tpopup.show(node);\n\t\tpopup.getBody().setValue(this.GetSeries(id).meta.color);\n\t}\n\n\tGetSeries(id) {\n\t\treturn this.State.series.find(s => s.id == id);\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"text-search\",\n\t\t$cssName: \"search\",\n\t\tdefaults: {\n\t\t\tcloseIcon: \"wxi-close\",\n\t\t\ttemplate: function(obj, common) {\n\t\t\t\tvar text = common.$renderInput(obj);\n\t\t\t\tif (obj.badge || obj.badge === 0)\n\t\t\t\t\ttext = text.replace(\n\t\t\t\t\t\tnew RegExp(\"</div>$\"),\n\t\t\t\t\t\t\"<span class='webix_badge'>\" + obj.badge + \"</span></div>\"\n\t\t\t\t\t);\n\t\t\t\treturn text;\n\t\t\t},\n\t\t},\n\n\t\ton_click: {\n\t\t\twebix_input_icon: function(e) {\n\t\t\t\tconst css = e.target.className;\n\t\t\t\tthis.getInputNode().focus();\n\n\t\t\t\tif (css.indexOf(this.config.closeIcon) > -1) {\n\t\t\t\t\tthis.setValue(\"\");\n\t\t\t\t\tthis.callEvent(\"onCloseIconClick\", [e]);\n\t\t\t\t\tthis.hideCloseIcon();\n\t\t\t\t} else {\n\t\t\t\t\tthis.callEvent(\"onSearchIconClick\", [e]);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t$init() {\n\t\t\tthis.attachEvent(\"onTimedKeyPress\", () => this._onSearch());\n\t\t\tthis.attachEvent(\"onChange\", () => this._onSearch());\n\t\t},\n\t\t_onSearch() {\n\t\t\tconst v = this.getValue();\n\t\t\tif (v) this.showCloseIcon();\n\t\t\telse this.hideCloseIcon();\n\n\t\t\tthis.callEvent(\"onSearchChange\", [v]);\n\t\t},\n\t\tsetIcon(icon) {\n\t\t\tconst nodes = this.$view.getElementsByClassName(\"webix_input_icon\");\n\t\t\tif (nodes.length) nodes[0].className = \"webix_input_icon \" + icon;\n\t\t},\n\t\tshowCloseIcon() {\n\t\t\tthis.setIcon(this.config.closeIcon);\n\t\t},\n\t\thideCloseIcon() {\n\t\t\tthis.setIcon(this.config.icon);\n\t\t},\n\t\tsetBadge(value) {\n\t\t\tlet node = this.$view.querySelector(\".webix_badge\");\n\t\t\tif (value || value === 0) {\n\t\t\t\tif (!node) {\n\t\t\t\t\tnode = webix.html.create(\n\t\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t\t{ class: \"webix_badge\" },\n\t\t\t\t\t\t\"\" + value\n\t\t\t\t\t);\n\t\t\t\t\tthis.$view.querySelector(\".webix_el_box\").appendChild(node);\n\t\t\t\t} else node.innerHTML = \"\" + value;\n\t\t\t} else if (node) webix.html.remove(node);\n\t\t\tthis.config.badge = value;\n\t\t},\n\t},\n\twebix.ui.search\n);\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class SeriesPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Series = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Marker type\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tcss: \"webix_rpt_markerselect\",\n\t\t\t\tname: \"markerType\",\n\t\t\t\toptions: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_rpt_markerselect_list\",\n\t\t\t\t\t\ttemplate: item => this.ItemListTemplate(item),\n\t\t\t\t\t\tdata: this.Charts.getItemTypes(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Fill marker\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"fillMarker\",\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 170,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Series, \"*\", this.getRoot());\n\t\tif (this.Charts.itemSupport.indexOf(this.ChartState.chartType) > -1)\n\t\t\tthis.getRoot().showBatch(\"marker\");\n\n\t\tthis.on(this.Series.$changes, \"color\", () => {\n\t\t\tconst markerType = this.getRoot().elements[\"markerType\"];\n\t\t\tmarkerType.refresh();\n\t\t\tmarkerType.getList().refresh();\n\t\t});\n\t}\n\n\tItemListTemplate(item) {\n\t\treturn `<div class=\"webix_rpt_config_row\">${item.value} <span class='webix_icon ${item.icon}' style='color:${this.Series.color}'></span></div>`;\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\nimport ColorPopup from \"./colorpopup\";\nimport BaseView from \"./baseview\";\nimport \"../../../helpers/rsearch\";\nimport SeriesProperties from \"./chartseries\";\nimport AxisProperties from \"./axis\";\n//import LegendProperties from \"./legend\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis._ActiveEditor = {};\n\t\tconst type = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: this._(\"Chart type\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"type\",\n\t\t\t\t\toptions: this.Charts.getTypes(),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => (this.ChartState.chartType = v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"X axis column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"labelColumn\",\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLabelField(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueFields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\teditable: true,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tif (!this.SubState) this.SubState = {};\n\t\t\t\tconst series = (this.SubState[obj.id] = createState({\n\t\t\t\t\tname: obj.meta.name,\n\t\t\t\t\tcolor: obj.meta.color,\n\t\t\t\t\ttype: obj.meta.type || null,\n\t\t\t\t\tmarkerType: obj.meta.markerType || null,\n\t\t\t\t\tfillMarker: obj.meta.fillMarker || null,\n\t\t\t\t}));\n\t\t\t\tthis.on(\n\t\t\t\t\tseries.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.UpdateSeries(obj.id, series);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new SeriesProperties(this.app, series, this.ChartState);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tthis.openSub(id);\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => this.SaveOrder(),\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\t\"data->onClearAll\": () => this.ResetEditor(),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_chart_color: (e, id) => this.ShowColorPopup(e, id),\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\t\tconst axisFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Axes\") },\n\n\t\t\t\t{\n\t\t\t\t\tview: \"datatable\",\n\t\t\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\t\t\tlocalId: \"axisFields\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\theader: false,\n\t\t\t\t\tselect: false,\n\t\t\t\t\tsubview: (obj, target) => {\n\t\t\t\t\t\tconst axis = createState({ id: obj.id, ...obj.meta });\n\t\t\t\t\t\tthis.on(\n\t\t\t\t\t\t\taxis.$changes,\n\t\t\t\t\t\t\t\"*\",\n\t\t\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\t\t\tthis.UpdateAxis(obj.id, axis);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst sub = new AxisProperties(this.app, axis, this.ChartState);\n\t\t\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\t\t\treturn sub.getRoot();\n\t\t\t\t\t},\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t\ttemplate: (item, common) => this.AxisRowTemplate(item, common),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ToggleSub(id, \"axisFields\"),\n\t\t\t\t\t\tonAfterRender: () => {\n\t\t\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tel &&\n\t\t\t\t\t\t\t\t\tdocument.contains(el) &&\n\t\t\t\t\t\t\t\t\tel !== document.activeElement\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id, \"axisFields\"),\n\t\t\t\t\t\tonSubViewClose: () => this.ResetEditor(\"axisFields\"),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst legendFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Legend\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tlocalId: \"legendPosition\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"bottom\", value: _(\"Bottom\") },\n\t\t\t\t\t\t{ id: \"right\", value: _(\"Right\") },\n\t\t\t\t\t\t{ id: \"none\", value: _(\"None\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLegend(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tcss: \"webix_rpt_chart_config\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\ttype,\n\t\t\t\tlabelField,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"dataInputs\",\n\t\t\t\t\trows: this.GetDataInputs(),\n\t\t\t\t},\n\t\t\t\tvalueFields,\n\t\t\t\taxisFields,\n\t\t\t\tlegendFields,\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Types = this.Charts.getTypes();\n\n\t\tlet fields = [];\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tfields.push({ ...a });\n\t\t});\n\n\t\t// options with all fields\n\t\tthis.Fields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn !field.key;\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\t// Options with numeric fields\n\t\tthis.ValueFields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn field.type == \"number\" && !field.key;\n\t\t\t})\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type, model: a.model }));\n\n\t\tthis.ChartState = createState(this.GetInitState());\n\n\t\tthis.on(this.ChartState.$changes, \"*\", () => {\n\t\t\tthis.UpdateModuleState();\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"chartType\", (type, prev) => {\n\t\t\tthis.ApplyChartType(type, prev);\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"seriesFrom\", (value, prev) => {\n\t\t\tthis.ApplySeriesFrom(value, prev);\n\t\t});\n\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"baseColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"dataColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\n\t\tthis.on(this.ChartState.$changes, \"updatedSeries\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.$$(\"fields\").refresh(v);\n\t\t\t\tif (this.SubState && this.SubState[v])\n\t\t\t\t\tthis.SubState[v].color = this.ChartState.series.find(\n\t\t\t\t\t\ts => s.id == v\n\t\t\t\t\t).meta.color;\n\t\t\t\tthis.ChartState.updatedSeries = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.$$(\"type\").setValue(this.ChartState.chartType);\n\n\t\tthis.$$(\"labelColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"labelColumn\").setValue(this.ChartState.labelColumn);\n\n\t\tthis.$$(\"seriesFrom\").setValue(this.ChartState.seriesFrom);\n\n\t\tthis.$$(\"baseColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"baseColumn\").setValue(this.ChartState.baseColumn);\n\n\t\tthis.$$(\"dataColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.ValueFields);\n\t\tthis.$$(\"dataColumn\").setValue(this.ChartState.dataColumn);\n\n\t\tthis.$$(\"legendPosition\").setValue(this.ChartState.legendPosition);\n\t}\n\n\tChangeLabelField(label) {\n\t\tthis.ChartState.labelColumn = label;\n\t}\n\tChangeLegend(v) {\n\t\tthis.ChartState.legendPosition = v;\n\t}\n\n\tGetInitState() {\n\t\tconst meta = this.State.meta.chart || {};\n\t\treturn {\n\t\t\tchartType: meta.chartType || this.Charts.type,\n\t\t\tlabelColumn: meta.labelColumn || null,\n\t\t\tupdatedSeries: null,\n\t\t\tseriesFrom: meta.seriesFrom || \"columns\",\n\t\t\tbaseColumn: meta.baseColumn || null,\n\t\t\tdataColumn: meta.dataColumn || null,\n\t\t\tseries: meta.series || null,\n\t\t\tlegend: meta.legend || { layout: \"x\" },\n\t\t\taxises: meta.axises || null,\n\t\t\tlegendPosition: meta.legendPosition || \"bottom\",\n\t\t};\n\t}\n\n\t/*\n\t * Called when chart type changed.\n\t * */\n\tApplyChartType(type, prevType) {\n\t\tthis.ShowAxisInputs(type);\n\t\tthis.RenderSeries(prevType);\n\t}\n\n\t/*\n\t * Renders chart series. Loads init state values\n\t * or generates new series depending on selected type\n\t * */\n\tRenderSeries(prevType) {\n\t\tconst series = this.ChartState.series;\n\t\tif (series && typeof prevType == \"undefined\") this.LoadSeries(series);\n\t\telse this.GenerateSeries();\n\t}\n\n\t// Loads axis data\n\tShowAxisInputs(type) {\n\t\tconst isAxises = this.Charts.noAxisSupport.indexOf(type);\n\t\tif (isAxises) {\n\t\t\tif (!this.ChartState.axises) {\n\t\t\t\tthis.ChartState.axises = {\n\t\t\t\t\tx: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tverticalLabels: true,\n\t\t\t\t\t},\n\t\t\t\t\ty: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tlogarithmic: false,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (!this.$$(\"axisFields\").data.count())\n\t\t\t\tthis.$$(\"axisFields\").parse([\n\t\t\t\t\t{ id: \"x\", meta: { ...this.ChartState.axises.x } },\n\t\t\t\t\t{ id: \"y\", meta: { ...this.ChartState.axises.y } },\n\t\t\t\t]);\n\t\t} else {\n\t\t\tthis.ChartState.axises = null;\n\t\t\tthis.$$(\"axisFields\").clearAll();\n\t\t}\n\t}\n\tGetDataInputs() {\n\t\treturn [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{ view: \"label\", label: this._(\"Data series\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Extract series from\"),\n\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\t\t\t\t\tlocalId: \"seriesFrom\",\n\t\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"columns\", value: this._(\"columns\") },\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"rows\", value: this._(\"rows\") },\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.seriesFrom = v),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\tlocalId: \"baseColumnLayout\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Keys column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"baseColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.baseColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Values column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpdataColumnt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"dataColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.dataColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\t}\n\n\t/*\n\t * Generates series and loads these data\n\t * params:\n\t * - an array of fields/ keys options\n\t * */\n\tApplySeriesKeys(sourceArray) {\n\t\tconst data = this.Charts.getSeries(sourceArray, this.ChartState.type);\n\t\tthis.ChartState.series = data;\n\t\tthis.LoadSeries(data);\n\t}\n\n\tLoadSeries(data) {\n\t\tif (!data.length) this.$$(\"fields\").hide();\n\t\telse this.$$(\"fields\").show();\n\n\t\tthis.$$(\"fields\").clearAll();\n\t\tthis.$$(\"fields\").parse(data);\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.State.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\n\tGenerateSeries() {\n\t\tconst from = this.ChartState.seriesFrom;\n\t\tif (from == \"columns\") this.ApplySeriesKeys([...this.ValueFields], null);\n\t\telse {\n\t\t\tthis.ChartState.dataColumn = this.$$(\"dataColumn\").getValue();\n\t\t\tconst base = (this.ChartState.baseColumn = this.$$(\n\t\t\t\t\"baseColumn\"\n\t\t\t).getValue());\n\t\t\tthis.GetRowKeys(base).then(arr => this.ApplySeriesKeys(arr, base));\n\t\t}\n\t}\n\n\tApplySeriesFrom(v, prevValue) {\n\t\tif (this.$$(\"baseColumnLayout\")) {\n\t\t\tif (v == \"columns\") {\n\t\t\t\tthis.$$(\"baseColumnLayout\").hide();\n\t\t\t\tthis.$$(\"baseColumn\").setValue(null);\n\t\t\t} else this.$$(\"baseColumnLayout\").show();\n\t\t\tif (prevValue) {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t}\n\t\t}\n\t}\n\n\tUpdateSeries(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst series = [...this.ChartState.series];\n\t\tconst ind = series.findIndex(a => a.id == id);\n\t\tObject.assign(series[ind].meta, update);\n\t\tthis.ChartState.series = series;\n\t\tthis.$$(\"fields\").refresh(id);\n\t}\n\n\tUpdateAxis(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tlet axises = { ...this.ChartState.axises };\n\t\tObject.assign(axises[id], update);\n\t\tthis.ChartState.axises = axises;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\t\"<span class='webix_icon \" +\n\t\t\t(item.show\n\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\"'></span>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_chart_color' style='background:\" +\n\t\t\titem.meta.color +\n\t\t\t\"'> </div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n\n\tGetData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = this.State.columns.map(c => c.id);\n\t\tlet waitData = [this.Local.getData(moduleConfig)];\n\t\tif (baseColumn) waitData.push(this.Local.getOptionsList(baseColumn));\n\t\treturn Promise.all(waitData);\n\t}\n\n\tShowColorPopup(e, id) {\n\t\tif (!this.ColorPopup || !this.ColorPopup.$view)\n\t\t\tthis.ColorPopup = this.ui(new ColorPopup(this.app, this.ChartState));\n\t\tthis.ActiveSeries = id;\n\t\tthis.ColorPopup.Show(e.target, id);\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\t\tthis.ChartState.series = table.serialize();\n\t}\n\n\tUpdateModuleState() {\n\t\tconst state = this.ChartState;\n\t\tconst columns = [];\n\n\t\tif (state.labelColumn) this.AddColumn(columns, state.labelColumn);\n\t\tif (state.seriesFrom == \"columns\") {\n\t\t\tif (state.series)\n\t\t\t\tstate.series.forEach(a => {\n\t\t\t\t\tif (a.show) this.AddColumn(columns, a.id);\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (state.baseColumn) this.AddColumn(columns, state.baseColumn);\n\t\t\tif (state.dataColumn) this.AddColumn(columns, state.dataColumn);\n\t\t}\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, chart: this.ChartState },\n\t\t});\n\t}\n\n\tAddColumn(columns, id) {\n\t\tconst col = (this.State.publicFields || this.State.fields).find(\n\t\t\tb => b.id === id\n\t\t);\n\t\tif (col) columns.push(col);\n\t}\n\n\tAxisRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'>\" +\n\t\t\tthis._(item.id == \"x\" ? \"X Axis\" : \"Y Axis\");\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class ColumnPropertiesView extends JetView {\n\tconstructor(app, data) {\n\t\tsuper(app);\n\t\tthis.Column = data;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Filter\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"header\",\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: \"none\", value: _(\"No filter\") },\n\t\t\t\t\t{ id: \"text\", value: _(\"Text\") },\n\t\t\t\t\t{ id: \"select\", value: _(\"Select\") },\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Column, \"*\", this.getRoot());\n\t}\n}\n","import BaseView from \"./baseview\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Labels column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"label\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Values column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"value\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst colorField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Color column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: false,\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [valueField, labelField, colorField, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tlet fields = (this.Fields = (\n\t\t\tthis.State.publicFields || this.State.fields\n\t\t).map(a => ({\n\t\t\t...a,\n\t\t})));\n\t\tlet valueFields = fields.filter(\n\t\t\tfield => field.type == \"number\" && !field.key\n\t\t);\n\t\tif (!valueFields.length)\n\t\t\tvalueFields = fields.filter(field => field.type == \"number\");\n\t\tconst els = this.getRoot().elements;\n\n\t\tconst lc = els.label;\n\t\tlc.getList().parse(fields);\n\t\tlc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tlc.setValue(this.State.meta.label || fields[0].id);\n\n\t\tconst vc = els.value;\n\t\tvc.getList().parse(valueFields);\n\t\tvc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tvc.setValue(this.State.meta.value || valueFields[0].id);\n\n\t\tconst cc = els.color;\n\t\tcc.getList().parse(valueFields);\n\t\tcc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tcc.setValue(this.State.meta.color || valueFields[0].id);\n\n\t\tthis.getRoot().attachEvent(\"onChange\", () => this.OnChange());\n\t\tif (!this.State.meta.value) this.OnChange();\n\t}\n\n\tOnChange() {\n\t\tthis.Apply({ ...this.State.meta, ...this.getRoot().getValues() });\n\t}\n\n\tApply(meta) {\n\t\tconst check = [meta.value, meta.label, meta.color];\n\t\tconst columns = this.Fields.filter(a => check.indexOf(a.id) !== -1);\n\n\t\tthis.State.$batch({\n\t\t\tmeta,\n\t\t\tcolumns,\n\t\t});\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.name +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { types } from \"../../../helpers/icons\";\n\nexport default class StructureView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"select\",\n\t\t\tborderless: true,\n\t\t\talign: \"left\",\n\t\t\tinputWidth: 170,\n\t\t\toptions: [\n\t\t\t\t{\n\t\t\t\t\tid: \"table\",\n\t\t\t\t\tvalue: types.table + \" \" + _(\"Table\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"chart\",\n\t\t\t\t\tvalue: types.chart + \" \" + _(\"Chart\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"heatmap\",\n\t\t\t\t\tvalue: types.heatmap + \" \" + _(\"Heatmap\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ChangeReportType(v),\n\t\t\t},\n\t\t};\n\n\t\tconst toolbar = {\n\t\t\tview: \"form\",\n\t\t\tpadding: {\n\t\t\t\tleft: webix.skin.$active.layoutPadding.form,\n\t\t\t\ttop: 5,\n\t\t\t\tbottom: 0,\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tcols: [tabbar],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 480,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"type\", v => {\n\t\t\tthis.show(\"editor.structure.\" + v);\n\t\t});\n\t\tthis.$$(\"select\").setValue(this.State.type);\n\t}\n\n\tChangeReportType(type) {\n\t\tif (this.State.type != type) this.State.$batch({ type, meta: {} });\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\n\nimport ColumnProperties from \"./column\";\n\nimport \"../../../helpers/rsearch\";\nimport BaseView from \"./baseview\";\n\nexport default class ColumnsView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis._ActiveEditor = {};\n\t\tconst header = {\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Columns\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonSearchChange: () => this.FilterFields(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst fields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst column = createState({\n\t\t\t\t\tname: obj.meta.name || obj.name,\n\t\t\t\t\theader: obj.meta.header || \"none\",\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tcolumn.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, column);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new ColumnProperties(this.app, column);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tif (id.row !== \"$freeze\") this.openSub(id);\n\t\t\t\t},\n\t\t\t\tonBeforeDrag: ctx => {\n\t\t\t\t\tthis.HideAllEditors();\n\t\t\t\t\tconst list = this.$$(\"fields\");\n\t\t\t\t\twebix.html.addCss(list.$view, \"webix_rpt_drag\");\n\n\t\t\t\t\tif (ctx.start === \"$freeze\") {\n\t\t\t\t\t\tctx.html = `<div class=\"webix_drag_zone\"><div class=\"webix_dd_drag wbx-mark_frozen\" style=\"width:${\n\t\t\t\t\t\t\tlist.$width\n\t\t\t\t\t\t}px;\"><div>${this.FrozenTemplate()}</div></div></div>`;\n\t\t\t\t\t} else if (!list.getItem(ctx.start).show) return false;\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => {\n\t\t\t\t\twebix.html.removeCss(this.$$(\"fields\").$view, \"webix_rpt_drag\");\n\t\t\t\t\tthis.SaveOrder();\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [header, fields],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst table = this.$$(\"fields\");\n\t\tconst has = {};\n\t\tconst columns = this.State.columns.map(a => {\n\t\t\thas[a.id] = 1;\n\t\t\treturn { ...a, show: true };\n\t\t});\n\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tif (!has[a.id]) columns.push({ ...a, show: false });\n\t\t});\n\n\t\tcolumns.splice(this.State.meta.freeze || 0, 0, {\n\t\t\tid: \"$freeze\",\n\t\t\t$css: \"wbx-mark_frozen\",\n\t\t\tname: this.FrozenTemplate(),\n\t\t});\n\t\ttable.parse(columns);\n\t}\n\n\tFilterFields() {\n\t\tconst f = this.$$(\"search\")\n\t\t\t.getValue()\n\t\t\t.toLowerCase();\n\t\tthis.$$(\"fields\").filter(a => a.name.toLowerCase().indexOf(f) !== -1);\n\t}\n\n\tUpdate(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst columns = [...this.State.columns];\n\t\tconst ind = columns.findIndex(a => a.id == id);\n\t\tObject.assign(columns[ind].meta, update);\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tGetFreeze() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst order = table.data.order;\n\n\t\tlet freezeColumn = 0;\n\t\tfor (var i = 0; i < order.length; i++) {\n\t\t\tif (order[i] === \"$freeze\") break;\n\t\t\tfreezeColumn += table.getItem(order[i]).show ? 1 : 0;\n\t\t}\n\n\t\treturn freezeColumn;\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tFrozenTemplate() {\n\t\treturn (\n\t\t\t\"<span class='webix_rpt_frozen webix_icon rpi-arrow-horizontal-lock'></span><span>\" +\n\t\t\tthis._(\"Frozen columns above\") +\n\t\t\t\"</span>\"\n\t\t);\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\titem.id !== \"$freeze\"\n\t\t\t\t? \"<span class='webix_icon \" +\n\t\t\t\t  (item.show\n\t\t\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\t  \"'></span>\"\n\t\t\t\t: \"\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += item.id !== \"$freeze\" ? common.subrow(item, common) : \"\";\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { empty } from \"../helpers/icons\";\n\nexport default class EmptyView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tcss: \"webix_rpt_empty\",\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\ttemplate: value => this.GetTemplate(value),\n\t\t};\n\t}\n\tinit() {\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tmods.waitData.then(() => {\n\t\t\tconst text = this.GetText(mods.data.count());\n\t\t\tthis.getRoot().setValues({ text });\n\t\t});\n\t}\n\tGetText(count) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn count\n\t\t\t? _(\"Select any report from the list\")\n\t\t\t: _(\"Click 'New' button to add a new report\");\n\t}\n\tGetSVG() {\n\t\tconst skin = webix.skin.$name;\n\t\tconst icon = skin == \"willow\" || skin == \"dark\" ? \"alt\" : \"main\";\n\t\treturn empty[icon];\n\t}\n\tGetTemplate(value) {\n\t\tconst text =\n\t\t\t\"<div class='webix_rpt_empty_placeholder'>\" +\n\t\t\t(value.text || \"\") +\n\t\t\t\"</div>\";\n\t\treturn text + this.GetSVG();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Toolbar from \"./common/toolbar\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.meta.value && mod.type === \"heatmap\") {\n\t\t\tconst config = this.GetChartConfig(mod);\n\t\t\tif (!config.view) return;\n\t\t\tthis.Bar.show();\n\t\t\tthis.GetChartData(mod).then(([data, options]) => {\n\t\t\t\tconfig.data = this.FormatLabels(webix.copy(data), options);\n\t\t\t\tif (data.length && mod.meta.color)\n\t\t\t\t\tconfig.type.cssClass = this.CssFactory(data, mod.meta.color);\n\n\t\t\t\twebix.ui([config], host);\n\t\t\t\tthis.Chart = host.getChildViews()[0];\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{ template: \" \" }], host);\n\t\t\tthis.Bar.hide();\n\t\t\tthis.Chart = null;\n\t\t}\n\t}\n\n\tGetChartConfig(mod) {\n\t\tconst { meta, columns } = mod;\n\n\t\tconst obj = {\n\t\t\tview: \"treemap\",\n\t\t\tcss: \"webix_rpt\",\n\t\t\tvalue: obj => obj[meta.value],\n\t\t\ttooltip: this.TooltipFactory(meta, columns),\n\t\t\ttype: {},\n\t\t};\n\n\t\tif (meta.label) obj.type.template = obj => obj[meta.label];\n\n\t\treturn obj;\n\t}\n\n\tGetChartData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tCssFactory(data, prop) {\n\t\tvar min = Infinity;\n\t\tvar max = -Infinity;\n\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tconst v = data[i][prop];\n\t\t\tif (v > max) max = v * 1;\n\t\t\tif (v < min) min = v * 1;\n\t\t}\n\n\t\tconst step = (max - min) / 4;\n\t\tconst bases = [max - step, max - step * 2, max - step * 3, min];\n\n\t\treturn function(obj) {\n\t\t\tconst v = obj[prop];\n\t\t\tfor (var i = 0; i < bases.length; i++) if (v >= bases[i]) return \"l\" + i;\n\t\t};\n\t}\n\n\tTooltipFactory(obj, columns) {\n\t\tconst valueColumn = columns.find(a => a.id === obj.value);\n\t\tconst colorColumn = columns.find(a => a.id === obj.color);\n\t\tif (!valueColumn || !colorColumn) return \"\";\n\t\tconst props = [obj.value, valueColumn.name];\n\t\tif (obj.color && obj.color != obj.value)\n\t\t\tprops.push(obj.color, colorColumn.name);\n\n\t\treturn function(obj) {\n\t\t\tlet out = \"\";\n\t\t\tfor (let i = 0; i < props.length; i += 2) {\n\t\t\t\tout += (i ? \", \" : \"\") + props[i + 1] + \": \" + obj[props[i]];\n\t\t\t}\n\n\t\t\treturn out;\n\t\t};\n\t}\n\t/**\n\t * Exports chart to png image or PDF\n\t * @param {String} mode - export mode ( \"png\" or PDF \"table\"/\"image\"/\"all\"),\n\t */\n\tExport(mode) {\n\t\tif (this.Chart) {\n\t\t\tif (mode == \"png\") webix.toPNG(this.Chart);\n\t\t\telse if (mode == \"pdf\") {\n\t\t\t\tlet params = { autowidth: true, display: \"image\" };\n\t\t\t\twebix.toPDF(this.Chart, params);\n\t\t\t}\n\t\t}\n\t}\n\tFormatLabels(data, options) {\n\t\tconst labelColumn = this.State.module.meta.label;\n\t\tconst labelOptions =\n\t\t\tlabelColumn && options.length\n\t\t\t\t? options.find(op => op.field == labelColumn)\n\t\t\t\t: null;\n\n\t\tif (labelOptions)\n\t\t\tdata.forEach(item => {\n\t\t\t\tconst option = labelOptions.data.find(o => o.id == item[labelColumn]);\n\t\t\t\titem[labelColumn] = option ? option.value : item[labelColumn];\n\t\t\t});\n\t\telse {\n\t\t\tconst field = this.State.module.fields.find(\n\t\t\t\tfield => field.id == labelColumn\n\t\t\t);\n\t\t\tif (field && field.type == \"date\") {\n\t\t\t\tdata.forEach(item => {\n\t\t\t\t\titem[labelColumn] = webix.i18n.dateFormatStr(\n\t\t\t\t\t\tnew Date(item[labelColumn])\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MenuPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tborderless: true,\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj =>\n\t\t\t\t\t`<span class='webix_icon ${obj.icon}'></span>${obj.value}`,\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Edit\"),\n\t\t\t\t\t\tid: \"edit\",\n\t\t\t\t\t\ticon: \"rpi-square-edit-outline\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Create copy\"),\n\t\t\t\t\t\tid: \"copy\",\n\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\t\t\tid: \"delete\",\n\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.app.callEvent(\"onMenuAction\", [this.ID, id]);\n\t\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {}\n\n\tShow(trg, id) {\n\t\tthis.ID = id;\n\t\twebix.delay(() => {\n\t\t\tif (this.getRoot()) this.getRoot().show(trg);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../helpers/rsearch\";\nimport MenuPopup from \"./menu\";\nimport { types } from \"../helpers/icons\";\n\nexport default class GridsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tpadding: { left: 10, right: 10, top: 5, bottom: 5 },\n\t\t\tmargin: 0,\n\t\t\tlocalId: \"bar\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"Reports\") },\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"nameSorting\",\n\t\t\t\t\ticon: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon webix_rpt_btn_active\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-alphabetical-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"name\"),\n\t\t\t\t},\n\t\t\t\t{ width: 4 },\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"updatedSorting\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon\",\n\t\t\t\t\ticon: \"rpi-sort-calendar-descending\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-calendar-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-calendar-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"updated\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst menu = {\n\t\t\tview: \"form\",\n\t\t\tpadding: { left: 10, right: 10, top: 2, bottom: 4 },\n\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"list\",\n\t\t\tscroll: true,\n\t\t\tselect: true,\n\t\t\tcss: \"webix_rpt_list\",\n\t\t\ttype: {\n\t\t\t\theight: webix.skin.$active.rowHeight + 24,\n\t\t\t\ttemplate: data => this.GetListTemplate(data),\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: function(obj) {\n\t\t\t\t\tif (obj.date && typeof obj.date === \"string\")\n\t\t\t\t\t\tobj.date = new Date(obj.date);\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_action_menu: (e, id) => {\n\t\t\t\t\tthis.Menu.Show(e, id);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t\tonDblClick: {},\n\t\t\ton: {\n\t\t\t\tonAfterSelect: id => this.LoadModule(id, null),\n\t\t\t\tonItemDblClick: id => this.LoadModule(id, \"edit\"),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\twidth: 320,\n\t\t\ttype: \"clean\",\n\t\t\trows: [bar, { type: \"clean\", rows: [menu, table] }],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Menu = this.ui(MenuPopup);\n\n\t\tconst list = this.$$(\"list\");\n\t\tlist.$view.firstChild.setAttribute(\"placeholder\", this._(\"No reports\"));\n\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tlist.sync(mods);\n\t\tmods.waitData.then(() => {\n\t\t\tif (this.State.moduleId) list.select(this.State.moduleId);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.$$(\"list\").refresh());\n\n\t\tthis.$$(\"search\").attachEvent(\"onSearchChange\", v => this.Find(v));\n\n\t\tthis.Sorting = { by: \"name\", dir: \"asc\" };\n\t}\n\n\tLoadModule(id, mode) {\n\t\tthis.app.callEvent(\"loadModule\", [id, mode]);\n\t}\n\n\tHide() {\n\t\tthis.app.callEvent(\"hideModuleList\");\n\t}\n\n\tFind() {\n\t\tlet text = this.$$(\"search\").getValue();\n\t\tconst list = this.$$(\"list\");\n\t\tif (text) {\n\t\t\ttext = text.toLowerCase();\n\t\t\tlist.filter(data => this.SearchCompare(text, data));\n\t\t} else {\n\t\t\tlist.filter();\n\t\t}\n\t}\n\tSearchCompare(value, item) {\n\t\treturn item.name.toLowerCase().indexOf(value) > -1;\n\t}\n\n\tGetListTemplate(item) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet html = \"<div class='webix_rpt_list_block'>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_name'>\" +\n\t\t\ttypes[item.parsed.type] +\n\t\t\t\" \" +\n\t\t\titem.name +\n\t\t\t\"</div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_date'>\" +\n\t\t\t_(\"Last modified\") +\n\t\t\t\": \" +\n\t\t\twebix.i18n.longDateFormatStr(item.updated || new Date()) +\n\t\t\t\"</div>\";\n\t\tif (!this.State.readonly)\n\t\t\thtml +=\n\t\t\t\t\"<span class='webix_icon webix_rpt_action_menu rpi-dots-vertical'></span>\";\n\t\treturn html + \"</div>\";\n\t}\n\n\tSort(by) {\n\t\tlet sState = this.Sorting;\n\t\tconst prevState = webix.copy(sState);\n\t\tif (sState.by == by) sState.dir = sState.dir == \"desc\" ? \"asc\" : \"desc\";\n\t\telse {\n\t\t\tsState.by = by;\n\t\t\tsState.dir = \"desc\";\n\t\t}\n\t\tsState.as = by == \"updated\" ? \"date\" : \"string\";\n\t\tthis.ChangeSortButtons(sState, prevState);\n\t\tthis.$$(\"list\").sort(sState);\n\t}\n\n\tChangeSortButtons(state, prevState) {\n\t\tconst btn = this.$$(state.by + \"Sorting\");\n\n\t\tthis.webix.html.addCss(btn.$view, \"webix_rpt_btn_active\");\n\t\tbtn.config.icon = btn.config.icons[state.dir];\n\t\tbtn.refresh();\n\t\tif (state.by != prevState.by) {\n\t\t\tconst prevBtn = this.$$(prevState.by + \"Sorting\");\n\t\t\tthis.webix.html.removeCss(prevBtn.$view, \"webix_rpt_btn_active\");\n\t\t}\n\t}\n}\n","import BaseExportView from \"../common/export\";\n\nexport default class ExportView extends BaseExportView {\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To Excel\"), id: \"excel\" },\n\t\t\t{ value: _(\"To CSV\"), id: \"csv\" },\n\t\t];\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/rsearch\";\nimport ExportMenu from \"./export\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: viewId => this.ShowExportPopup(viewId),\n\t\t\t\t},\n\t\t\t\t{},\n\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t\tmaxWidth: 600,\n\t\t\t\t\tminWidth: 200,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn bar;\n\t}\n\n\tready() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"search\").attachEvent(\n\t\t\t\"onSearchChange\",\n\t\t\tv => (this.State.search = v)\n\t\t);\n\t\tthis.on(this.app, \"onRecordsSearch\", (value, result) => {\n\t\t\tif (value) this.$$(\"search\").setBadge(result.length);\n\t\t\telse this.$$(\"search\").setBadge(null);\n\t\t});\n\t}\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport Toolbar from \"./toolbar\";\n\nconst typeToSort = {\n\tnumber: \"int\",\n\tdate: \"date\",\n\ttext: \"string\",\n\tboolean: \"number\",\n\tpicklist: \"text\",\n\treference: \"text\",\n};\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.LocalState = createState({ search: \"\" });\n\t\tthis.setParam(\"state\", this.LocalState);\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t\tthis.on(this.LocalState.$changes, \"search\", v => this.Find(v));\n\t}\n\n\tExport(mode) {\n\t\tconst params = {\n\t\t\tignore: { $selection: true },\n\t\t\tplainOutput: true,\n\t\t\tfilterHTML: true,\n\t\t};\n\t\tif (this.Table) {\n\t\t\tif (mode == \"excel\") webix.toExcel(this.Table, params);\n\t\t\telse if (mode == \"csv\") webix.toCSV(this.Table, params);\n\t\t}\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.columns.length && mod.type === \"table\") {\n\t\t\tconst config = this.GetTableConfig(mod);\n\t\t\tif (!config) return;\n\n\t\t\tthis.Bar.show();\n\t\t\twebix.ui([config], host);\n\t\t\tconst table = (this.Table = host.getChildViews()[0]);\n\n\t\t\tthis.GetTableData(mod).then(([data, options]) => {\n\t\t\t\t// table already reconstructed on moment of data loading\n\t\t\t\tif (table.$destructed) return;\n\t\t\t\toptions.forEach(({ field, data }) => {\n\t\t\t\t\tif (!this.IsBucketColumn(field))\n\t\t\t\t\t\ttable.getColumnConfig(field).collection.parse(data);\n\t\t\t\t});\n\t\t\t\ttable.parse(data);\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{}], host);\n\t\t\tthis.Table = null;\n\t\t\tthis.Bar.hide();\n\t\t}\n\t}\n\tIsBucketColumn(field, module) {\n\t\tmodule = module || this.State.module;\n\t\treturn module.buckets && module.buckets.find(b => b.column == field);\n\t}\n\tGetTableConfig(mod) {\n\t\tconst { groups, columns, meta } = mod;\n\t\tif (!columns) return null;\n\t\tlet dateColumns = [];\n\t\tconst gColumns = columns.map(a => {\n\t\t\tif (a.type == \"date\") dateColumns.push(a.id);\n\t\t\treturn this.GetColumnConfig(a);\n\t\t});\n\n\t\tconst edit = this.State.mode === \"edit\";\n\t\tconst grid = {\n\t\t\tview: groups ? \"treetable\" : \"datatable\",\n\t\t\tcolumns: gColumns,\n\t\t\tresizeColumn: edit ? { headerOnly: true } : false,\n\t\t\tleftSplit: meta.freeze ? meta.freeze : 0,\n\t\t\tcss: edit ? \"webix_header_border\" : \"\",\n\t\t\ton: {\n\t\t\t\tonColumnResize: (id, width, old, byUser) =>\n\t\t\t\t\tthis.SetColWidth(id, width, old, byUser),\n\t\t\t},\n\t\t};\n\n\t\tif (dateColumns.length)\n\t\t\tgrid.scheme = {\n\t\t\t\t$change: row =>\n\t\t\t\t\tdateColumns.forEach(cId => (row[cId] = new Date(row[cId]))),\n\t\t\t};\n\n\t\treturn grid;\n\t}\n\n\tGetColumnConfig(a) {\n\t\tlet column = {\n\t\t\tid: a.id,\n\t\t\theader:\n\t\t\t\t!a.meta.header || a.meta.header === \"none\"\n\t\t\t\t\t? a.meta.name || a.name\n\t\t\t\t\t: [\n\t\t\t\t\t\t\ta.meta.name || a.name,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t\t\ta.meta.header === \"text\" ? \"textFilter\" : \"richSelectFilter\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ],\n\t\t\ttype: a.type,\n\t\t\tsort: typeToSort[a.type],\n\t\t\twidth: a.width || 200,\n\t\t};\n\n\t\tif (a.type === \"date\") column.format = webix.i18n.dateFormatStr;\n\t\tif (a.type === \"boolean\") {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tcolumn.template = obj => (obj[a.id] == 1 ? _(\"True\") : _(\"False\"));\n\t\t}\n\t\tif (\n\t\t\t(a.type === \"reference\" || a.type === \"picklist\") &&\n\t\t\t!this.IsBucketColumn(a.id)\n\t\t)\n\t\t\tcolumn.options = [];\n\n\t\treturn column;\n\t}\n\n\tSetColWidth(id, width, old, byUser) {\n\t\tif (byUser) {\n\t\t\tif (id === \"$selection\" || id === \"$subrow\") {\n\t\t\t\tconst table = this.Tbl;\n\t\t\t\ttable.blockEvent();\n\t\t\t\ttable.setColumnWidth(id, old);\n\t\t\t\ttable.unblockEvent();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.app.callEvent(\"onColumnResize\", [id, width]);\n\t\t}\n\t}\n\n\tGetTableData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tFind(value) {\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tconst table = this.Table;\n\t\tlet result = [];\n\t\tif (!table) return;\n\t\ttable.clearCss(\"webix_rpt_found_record\", true);\n\n\t\tif (value) {\n\t\t\tconst ignoreDateNumber = h.hasNonDigits(value);\n\t\t\tconst regexp = new RegExp(h.wildToRegexp(value), \"gi\");\n\t\t\tconst fields = table.config.columns.filter(\n\t\t\t\tc =>\n\t\t\t\t\t!(c.id === \"$selection\" || c.id === \"$subrow\") &&\n\t\t\t\t\t(!ignoreDateNumber || !(c.type === \"number\" || c.type === \"date\"))\n\t\t\t);\n\n\t\t\tconst matchers = [];\n\n\t\t\tfor (let i = 0; i < fields.length; ++i) {\n\t\t\t\tconst type = fields[i].type || \"text\";\n\t\t\t\tconst colId = fields[i].id;\n\t\t\t\tif (type === \"text\" || type === \"number\") {\n\t\t\t\t\tmatchers.push(o => regexp.test(o[colId]));\n\t\t\t\t} else if (type === \"reference\" || type === \"picklist\") {\n\t\t\t\t\tconst collection = table.getColumnConfig(colId).collection;\n\n\t\t\t\t\tconst optionsMatch = h.findOptions(collection, regexp);\n\t\t\t\t\tmatchers.push(h.matchPerColumn(colId, a => optionsMatch[a]));\n\t\t\t\t} else if (type === \"bool\") {\n\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\tcase \"true\":\n\t\t\t\t\t\t\tmatchers.push(o => o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"false\":\n\t\t\t\t\t\t\tmatchers.push(o => !o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else if (type === \"date\") {\n\t\t\t\t\tconst dateFormats = table.getColumnConfig(colId).format;\n\t\t\t\t\tmatchers.push(o => regexp.test(dateFormats(o[colId])));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet found = false;\n\t\t\tresult = table.find(obj => {\n\t\t\t\tfor (let i = 0; i < matchers.length; ++i) {\n\t\t\t\t\tif (matchers[i](obj)) {\n\t\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\ttable.showItem(obj.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.addCss(obj.id, \"webix_rpt_found_record\", true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\ttable.refresh();\n\t\tthis.app.callEvent(\"onRecordsSearch\", [value, result]);\n\t}\n}\n","export default function handler(view) {\n\treturn {\n\t\tattachEvent: (key, handler) => {\n\t\t\twebix.UIManager.addHotKey(key, handler, view);\n\t\t\treturn { key, handler };\n\t\t},\n\t\tdetachEvent: ({ key, handler }) =>\n\t\t\twebix.UIManager.removeHotKey(key, handler, view),\n\t};\n}\n","export default class Charts {\n\tconstructor(_app) {\n\t\tthis._app = _app;\n\t\tthis.type = \"line\";\n\t\tthis.type = \"line\";\n\t\tthis.colors = [\n\t\t\t\"#FF9700\",\n\t\t\t\"#4CB050\",\n\t\t\t\"#00BCD4\",\n\t\t\t\"#3F51B5\",\n\t\t\t\"#9C28B1\",\n\t\t\t\"#F34336\",\n\t\t\t\"#FFEA3B\",\n\t\t\t\"#009788\",\n\t\t\t\"#2196F3\",\n\t\t\t\"#673BB7\",\n\t\t\t\"#EA1E63\",\n\t\t];\n\t\tthis.itemSupport = [\"line\", \"spline\", \"radar\"];\n\t\tthis.noAxisSupport = [\"pie\", \"donut\"];\n\t\tthis.lineTypes = [\"line\", \"spline\"];\n\t\tthis.multiTypeSupport = [\n\t\t\t\"bar\",\n\t\t\t\"stackedBar\",\n\t\t\t\"area\",\n\t\t\t\"stackedArea\",\n\t\t\t\"splineArea\",\n\t\t];\n\t\tthis.numLimit = 30;\n\t}\n\t/*\n\tGet chart type data.\n\tCreate an array of objects {id, value}\n\tand return this array.\n\t*/\n\tgetTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.types)\n\t\t\tthis.types = [\n\t\t\t\t{ id: \"line\", value: _(\"Line\"), icon: \"rpi-chart-line\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"spline\",\n\t\t\t\t\tvalue: _(\"Spline\"),\n\t\t\t\t\ticon: \"rpi-chart-bell-curve-cumulative\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"area\",\n\t\t\t\t\tvalue: _(\"Area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedArea\",\n\t\t\t\t\tvalue: _(\"Stacked area\"),\n\t\t\t\t\ticon: \"rpi-chart-line-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"splineArea\",\n\t\t\t\t\tvalue: _(\"Spline area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline-variant\",\n\t\t\t\t},\n\n\t\t\t\t{ id: \"bar\", value: _(\"Bar\"), icon: \"rpi-chart-bar\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedBar\",\n\t\t\t\t\tvalue: _(\"Stacked bar\"),\n\t\t\t\t\ticon: \"rpi-chart-bar-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"radar\",\n\t\t\t\t\tvalue: _(\"Radar\"),\n\t\t\t\t\ticon: \"rpi-vector-triangle\",\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.types;\n\t}\n\n\tgetItemTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.itemTypes)\n\t\t\tthis.itemTypes = [\n\t\t\t\t{\n\t\t\t\t\tid: \"r\",\n\t\t\t\t\tvalue: _(\"circle\"),\n\t\t\t\t\ticon: \"rpi-circle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"s\",\n\t\t\t\t\tvalue: _(\"square\"),\n\t\t\t\t\ticon: \"rpi-square-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"t\",\n\t\t\t\t\tvalue: _(\"triangle\"),\n\t\t\t\t\ticon: \"rpi-triangle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"d\",\n\t\t\t\t\tvalue: _(\"diamond\"),\n\t\t\t\t\ticon: \"rpi-rhombus-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"no\",\n\t\t\t\t\tvalue: _(\"no markers\"),\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.itemTypes;\n\t}\n\n\tgetSeries(fiedls, type) {\n\t\tlet data = [];\n\t\tlet colorIndex = 0;\n\t\tfiedls.forEach(field => {\n\t\t\tlet series = {\n\t\t\t\tid: field.id,\n\t\t\t\tname: field.value,\n\t\t\t\tmodel: field.model || null,\n\t\t\t\tshow: true,\n\t\t\t\tmeta: {\n\t\t\t\t\tname: field.value,\n\t\t\t\t\tcolor: this.colors[colorIndex] || this.colors[0],\n\t\t\t\t},\n\t\t\t};\n\t\t\tcolorIndex++;\n\n\t\t\tif (this.itemSupport.indexOf(type) != -1) {\n\t\t\t\tseries.meta.markerType = \"r\";\n\t\t\t\tseries.meta.fillMarker = false;\n\t\t\t}\n\t\t\tdata.push(series);\n\t\t});\n\t\treturn data;\n\t}\n}\n","export function waitVisible(view){\n\tconst promise = webix.promise.defer();\n\n\tconst interval = setInterval(()=> {\n\t\tconst destructed = view.$destructed;\n\t\tif(destructed || view.isVisible()){\n\t\t\tif(destructed)\n\t\t\t\tpromise.reject();\n\t\t\telse\n\t\t\t\tpromise.resolve();\n\t\t\tclearInterval(interval);\n\t\t}\n\t}, 300);\n\n\treturn promise;\n}","import { JetView } from \"webix-jet\";\n\nexport default class AddView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst cals = this.app.config.calendars;\n\n\t\tconst ui = {\n\t\t\tview: compact ? \"icon\" : \"button\",\n\t\t\ttype: \"icon\",\n\t\t\ticon: \"wxi-plus\",\n\t\t\tcss: \"webix_primary\",\n\t\t\tlabel: _(\"Create\"),\n\t\t\twidth: compact ? 50 : cals ? 185 : 100,\n\t\t\theight: compact ? 50 : webix.skin.$active.inputHeight,\n\t\t\ton: {\n\t\t\t\tonItemClick: () => this.AddEvent(),\n\t\t\t},\n\t\t};\n\n\t\treturn { view: \"align\", body: ui, align: \"middle\" };\n\t}\n\n\tAddEvent() {\n\t\tthis.app.getState().selected = { id: \"0\" };\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconfig() {\n\t\tconst toolbar = [\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-angle-left\",\n\t\t\t\ttooltip: () => this.NavLabel(-1),\n\t\t\t\talign: \"left\",\n\t\t\t\ton: { onItemClick: () => this.ChangeDate(-1) },\n\t\t\t},\n\t\t\t{ view: \"label\", localId: \"title\", align: \"center\", width: 160 },\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-angle-right\",\n\t\t\t\ttooltip: () => this.NavLabel(1),\n\t\t\t\talign: \"right\",\n\t\t\t\ton: { onItemClick: () => this.ChangeDate(1) },\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tcols: toolbar,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.on(this.State.$changes, \"date\", () => this.DateLabel());\n\t\tthis.on(this.State.$changes, \"mode\", () => this.DateLabel());\n\t\tif (this.app.config.timeline)\n\t\t\tthis.on(this.State.$changes, \"timelineMode\", () => this.DateLabel());\n\t}\n\n\tChangeDate(dir) {\n\t\tconst state = this.State;\n\t\tconst step = this.GetStep(state.mode);\n\t\tconst next = webix.Date.add(state.date, dir, step, true);\n\n\t\t// fix navigation in month mode when last day of month is selected\n\t\tif (state.mode === \"month\") {\n\t\t\tconst diff = Math.abs(state.date.getMonth() - next.getMonth());\n\t\t\tif (diff != 1 && diff < 6) next.setDate(0);\n\t\t}\n\n\t\tstate.$batch({\n\t\t\tdate: next,\n\t\t\tselected: null,\n\t\t});\n\t}\n\n\tGetStep(mode) {\n\t\tswitch (mode) {\n\t\t\tcase \"agenda\":\n\t\t\t\treturn \"month\";\n\t\t\tcase \"units\":\n\t\t\t\treturn \"day\";\n\t\t\tcase \"timeline\":\n\t\t\t\treturn this.State.timelineMode;\n\t\t\tdefault:\n\t\t\t\treturn mode;\n\t\t}\n\t}\n\n\tDateLabel() {\n\t\tconst date = this.State.date;\n\t\tconst mode = this.State.mode;\n\t\tlet format = webix.Date.dateToStr(\"%F %Y\");\n\t\tif (mode === \"year\") format = webix.Date.dateToStr(\"%Y\");\n\t\telse if (\n\t\t\tmode == \"day\" ||\n\t\t\tmode == \"units\" ||\n\t\t\t(mode == \"timeline\" && this.State.timelineMode == \"day\")\n\t\t)\n\t\t\tformat = webix.i18n.longDateFormatStr;\n\n\t\tthis.$$(\"title\").setHTML(format(date));\n\t}\n\n\tNavLabel(dir) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst modes = [\"month\", \"week\", \"day\"];\n\t\tlet mode = this.State.mode;\n\t\tmode = modes.indexOf(mode) !== -1 ? ` ${mode}` : \"\";\n\n\t\tdir = dir > 0 ? \"Next\" : \"Previous\";\n\n\t\treturn _(dir + mode);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class NavBarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst units = !!this.app.config.units;\n\n\t\tconst toolbar = {\n\t\t\thidden: compact,\n\t\t\tview: \"tabbar\",\n\t\t\tbottomOffset: 0,\n\t\t\tlocalId: \"buttons\",\n\t\t\tborderless: true,\n\t\t\twidth: 320,\n\t\t\toptionWidth: 80,\n\t\t\toptions: [\n\t\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t\t{ id: \"week\", value: _(\"Week\") },\n\t\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t\t{ id: \"agenda\", value: _(\"Agenda\") },\n\t\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t],\n\t\t};\n\n\t\tif (this.app.config.timeline) {\n\t\t\ttoolbar.width += 80;\n\t\t\ttoolbar.options.push({ id: \"timeline\", value: _(\"Timeline\") });\n\t\t}\n\n\t\tif (!compact) {\n\t\t\ttoolbar.on = { onChange: val => this.SetMode(val) };\n\t\t}\n\n\t\tif (units) {\n\t\t\ttoolbar.width += 80;\n\t\t\ttoolbar.options.push({ id: \"units\", value: _(\"Units\") });\n\t\t}\n\n\t\treturn toolbar;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.on(this.State.$changes, \"mode\", val => {\n\t\t\tthis.$$(\"buttons\").setValue(val);\n\t\t});\n\t}\n\tSetMode(val) {\n\t\tthis.State.$batch({\n\t\t\tmode: val,\n\t\t\tselected: null,\n\t\t});\n\t}\n}\n","const defaultPalette = [\n\t[\"#61AEE6\", \"#01C2A5\", \"#E88DD9\", \"#D2FB9E\", \"#6BA8CB\", \"#61BBA5\", \"#CF89D5\"],\n\t[\"#EF9C80\", \"#8289EE\", \"#74B1A7\", \"#DD89AF\", \"#E48882\", \"#997CEB\", \"#ADD579\"],\n\t[\"#F68896\", \"#FFE999\", \"#6D4BCE\", \"#99CA58\", \"#D352BE\", \"#F7CC34\", \"#DA5C53\"],\n];\nconst modernPalette = [\n\t[\"#5890DC\", \"#3AA3E3\", \"#045AA3\", \"#014593\", \"#01C2A5\", \"#61A649\", \"#157B7A\"],\n\t[\"#04864F\", \"#AD44AB\", \"#CB61C8\", \"#AC3C6E\", \"#BA282E\", \"#BD4E1B\", \"#B87728\"],\n\t[\"#B65F06\", \"#7A67EB\", \"#4536AD\", \"#282A8A\", \"#36337E\", \"#585B85\", \"#2A2F50\"],\n];\nconst palettes = {\n\tmaterial: defaultPalette,\n\tmini: defaultPalette,\n\tflat: defaultPalette,\n\tcompact: defaultPalette,\n\tcontrast: defaultPalette,\n\twillow: modernPalette,\n\tdark: modernPalette,\n};\n\nexport default function getPalette() {\n\tconst aSkin = webix.skin.$active;\n\treturn {\n\t\tview: \"colorboard\",\n\t\tcss: \"webix_scheduler_palette\",\n\t\theight: aSkin.optionHeight * 3 + 4,\n\t\twidth: aSkin.optionHeight * 7 + 4,\n\t\tpalette: palettes[webix.skin.$name],\n\t};\n}\n","import { JetView } from \"webix-jet\";\nimport getPalette from \"helpers/palette\";\n\nexport default class SidePopupView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst save = {\n\t\t\tview: \"button\",\n\t\t\tvalue: _(\"Save\"),\n\t\t\talign: \"right\",\n\t\t\tinputWidth: 100,\n\t\t\tcss: \"webix_primary\",\n\t\t\tclick: () => this.Save(),\n\t\t};\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst compactBar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"icon\", icon: \"wxi-close\", click: () => this.getRoot().hide() },\n\t\t\t\t{},\n\t\t\t\tsave,\n\t\t\t],\n\t\t};\n\n\t\tconst controls = [\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"removeBtn\",\n\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\tcss: \"webix_danger webix_scheduler_danger\",\n\t\t\t\thidden: true,\n\t\t\t\talign: compact ? \"center\" : \"left\",\n\t\t\t\tinputWidth: compact ? 330 : 100,\n\t\t\t\tclick: () => this.Delete(),\n\t\t\t},\n\t\t];\n\n\t\tif (!compact) controls.push(save);\n\n\t\tconst ui = this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\twidth: 400,\n\t\t\tclose: true,\n\t\t\tborderless: compact,\n\t\t\tfullscreen: compact,\n\t\t\tcss: \"webix_scheduler_cal_popup\",\n\t\t\thead: compact ? compactBar : _(\"Edit calendar\"),\n\t\t\tbody: {\n\t\t\t\tview: \"form\",\n\t\t\t\tlocalId: \"calendars:form\",\n\t\t\t\telements: [\n\t\t\t\t\t{ view: \"text\", label: _(\"Title\"), name: \"text\" },\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\t\t\tname: \"color\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\t\tbody: getPalette(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{ view: \"checkbox\", label: _(\"Active\"), name: \"active\" },\n\t\t\t\t\t{ cols: controls },\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => {\n\t\t\t\t\tthis.Form.clear();\n\t\t\t\t\tthis.$$(\"removeBtn\").hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (compact) ui.body.elements.splice(3, 0, {});\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.Cals = this.app.getService(\"local\").calendars(true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Form = this.$$(\"calendars:form\");\n\t}\n\n\tShow(id) {\n\t\tif (id) {\n\t\t\tconst obj = this.Cals.getItem(id);\n\t\t\tthis.Form.setValues(obj);\n\t\t\tthis.$$(\"removeBtn\").show();\n\t\t} else {\n\t\t\tthis.Form.setValues({\n\t\t\t\tcolor: \"#997CEB\",\n\t\t\t\tactive: 1,\n\t\t\t});\n\t\t}\n\t\tthis.getRoot().show();\n\t\tthis.Form.focus();\n\t}\n\n\tSave() {\n\t\tconst obj = this.Form.getValues();\n\t\tif (obj.id) this.Ops.updateCalendar(obj.id, obj);\n\t\telse this.Ops.addCalendar(obj);\n\t\tthis.getRoot().hide();\n\t}\n\n\tDelete() {\n\t\tconst obj = this.Form.getValues();\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\ttext: _(\"Do you really want to remove this calendar?\"),\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.Ops.removeCalendar(obj.id);\n\t\t\t\tthis.getRoot().hide();\n\t\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport EditorView from \"./editor\";\nimport getPalette from \"helpers/palette\";\nimport { waitVisible } from \"@xbs/jet-helpers\";\n\nexport default class SidePopupView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst ui = {\n\t\t\tview: \"popup\",\n\t\t\trelative: \"right\",\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\twebix.extend(getPalette(), {\n\t\t\t\t\t\tlocalId: \"colors\",\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: val => this.UpdateColor(val),\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\t{\n\t\t\t\t\t\tcss: \"webix_scheduler_settings\",\n\t\t\t\t\t\ttemplate: _(\"Settings\"),\n\t\t\t\t\t\theight: webix.skin.$active.inputHeight,\n\t\t\t\t\t\tonClick: {\n\t\t\t\t\t\t\twebix_template: () => this.ShowEditor(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => this.app.callEvent(\"side:popup:hide\", []),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\twaitVisible(this.getRoot()).then(() => {\n\t\t\tthis.Editor = this.ui(EditorView);\n\t\t});\n\t}\n\n\tShow(id, node, color) {\n\t\tthis.Cid = id;\n\t\tthis.getRoot().show(node);\n\t\tthis.$$(\"colors\").setValue(color);\n\t}\n\n\tShowEditor() {\n\t\tthis.Editor.Show(this.Cid);\n\t\tthis.getRoot().hide();\n\t}\n\n\tUpdateColor(val) {\n\t\tthis.app.getService(\"operations\").updateCalendar(this.Cid, {\n\t\t\tcolor: val,\n\t\t});\n\t\tthis.getRoot().hide();\n\t}\n\n\tHide() {\n\t\tthis.getRoot().hide();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport PopupView from \"./popup\";\nimport EditorView from \"./editor\";\n\nexport default class SideView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst state = this.app.getState();\n\n\t\tconst calendar = {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\theight: 276,\n\t\t\tmonthSelect: false,\n\t\t\ton: {\n\t\t\t\tonAfterDateSelect: date => {\n\t\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"calendars\",\n\t\t\ttype: this.ListType(_, state),\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\tyCount: 5,\n\t\t\teditable: true,\n\t\t\teditValue: \"text\",\n\t\t\teditaction: \"custom\",\n\t\t\teditor: \"text\",\n\t\t\tcss: \"webix_scheduler_cal_list\",\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_cal_edit: (e, id) => this.ShowPopup(e, id),\n\t\t\t\twebix_scheduler_cal_title: (e, id) => this.ToggleCalendar(id),\n\t\t\t\twebix_scheduler_active: (e, id) => this.ToggleCalendar(id),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeEditStop: (v, editor) => this.SetTitle(editor.id, v.value),\n\t\t\t},\n\t\t};\n\n\t\tconst rows = [\n\t\t\t{ maxHeight: 100 },\n\t\t\tlist,\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"add\",\n\t\t\t\tvalue: _(\"Add calendar\"),\n\t\t\t\thidden: !state.readonly,\n\t\t\t\tinputWidth: 190,\n\t\t\t\talign: \"center\",\n\t\t\t\tclick: () => this.AddCalendar(),\n\t\t\t},\n\t\t\t{},\n\t\t];\n\n\t\tlet side = {\n\t\t\ttype: \"form\",\n\t\t\tpadding: { top: 8 },\n\t\t\trows: rows,\n\t\t};\n\n\t\tif (!this.Compact) {\n\t\t\tlist.on.onAfterScroll = () => this.Popup.Hide();\n\t\t\tside = {\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tbody: {\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [calendar, side],\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn side;\n\t}\n\n\tinit() {\n\t\tthis.Cals = this.$$(\"calendars\");\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Ops = this.app.getService(\"operations\");\n\n\t\tthis.Popup = this.Compact ? this.ui(EditorView) : this.ui(PopupView);\n\t\twebix.extend(this.Cals, webix.EditAbility);\n\n\t\tthis.Data.calendars().then(data => this.Cals.parse(data));\n\n\t\tconst state = this.app.getState();\n\n\t\tif (!this.Compact) {\n\t\t\tthis.on(state.$changes, \"date\", value => {\n\t\t\t\tthis.$$(\"calendar\").setValue(value);\n\t\t\t});\n\t\t\tthis.on(this.app, \"side:popup:hide\", () => {\n\t\t\t\tthis.Cals.unselectAll();\n\t\t\t});\n\t\t}\n\n\t\tthis.on(state.$changes, \"readonly\", value => this.ToggleState(value));\n\t}\n\n\tListType(_, state) {\n\t\treturn {\n\t\t\tcheckbox: function(obj) {\n\t\t\t\tconst icon =\n\t\t\t\t\tobj.active * 1 ? \"wxi-checkbox-marked\" : \"wxi-checkbox-blank\";\n\t\t\t\treturn `<span style=\"color:${obj.color};\" \n\t\t\t\t\trole=\"checkbox\" tabindex=\"-1\" \n\t\t\t\t\taria-checked=\"${obj.active ? \"true\" : \"false\"}\" \n\t\t\t\t\tclass=\"webix_icon webix_scheduler_active ${icon}\">\n\t\t\t\t</span>`;\n\t\t\t},\n\t\t\ttemplate: (obj, common) => {\n\t\t\t\tconst edit = `\n\t\t\t\t\t<span\n\t\t\t\t\t\twebix_tooltip=\"${_(\"Edit calendar\")}\" \n\t\t\t\t\t\tclass=\"webix_icon wxi-dots webix_scheduler_cal_edit \n\t\t\t\t\t\t\t${webix.env.touch ? \" webix_scheduler_cal_visible\" : \"\"}\n\t\t\t\t\t\t\">\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\n\t\t\t\treturn `\n\t\t\t\t\t${common.checkbox(obj)}\n\t\t\t\t\t<span class=\"webix_scheduler_cal_title\">${obj.text || _(\"(no title)\")}</span>\n\t\t\t\t\t${state.readonly ? \"\" : edit}\n\t\t\t\t`;\n\t\t\t},\n\t\t};\n\t}\n\n\tAddCalendar() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Ops.addCalendar().then(id => {\n\t\t\tthis.Cals.edit(id);\n\t\t\tthis.Cals.getEditor()\n\t\t\t\t.getInputNode()\n\t\t\t\t.setAttribute(\"placeholder\", _(\"(no title)\"));\n\t\t});\n\t}\n\n\tShowPopup(e, id) {\n\t\tif (!this.Compact) {\n\t\t\tthis.Cals.select(id);\n\n\t\t\tconst color = this.Cals.getItem(id).color;\n\t\t\tthis.Popup.Show(id, this.Cals.getItemNode(id), color);\n\t\t} else this.Popup.Show(id);\n\t}\n\n\tToggleCalendar(id) {\n\t\tconst obj = this.Cals.getItem(id);\n\t\tthis.Ops.updateCalendar(id, { active: obj.active ^ 1 });\n\t}\n\n\tToggleState(value) {\n\t\tconst add = this.$$(\"add\");\n\t\tif (value) add.hide();\n\t\telse add.show();\n\n\t\tthis.Cals.refresh();\n\t}\n\n\tSetTitle(id, text) {\n\t\tthis.Ops.updateCalendar(id, { text }).then(\n\t\t\t() => this.EditStopSilent(),\n\t\t\t() => this.EditStopSilent(true)\n\t\t);\n\t\treturn false;\n\t}\n\n\tEditStopSilent(fail) {\n\t\tthis.Cals.blockEvent();\n\t\tif (fail) this.Cals.editCancel();\n\t\telse this.Cals.editStop();\n\t\tthis.Cals.unblockEvent();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport side from \"views/side\";\n\nexport default class NavPopupView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst units = !!this.app.config.units;\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tcss: \"webix_scheduler_navlist\",\n\t\t\tlocalId: \"modes\",\n\t\t\tautoheight: true,\n\t\t\tdata: [\n\t\t\t\t{ id: \"day\", value: _(\"Day\"), icon: \"shi-day\" },\n\t\t\t\t{ id: \"week\", value: _(\"Week\"), icon: \"shi-week\" },\n\t\t\t\t{ id: \"month\", value: _(\"Month\"), icon: \"shi-month\" },\n\t\t\t\t{ id: \"agenda\", value: _(\"Agenda\"), icon: \"shi-agenda\" },\n\t\t\t\t{ id: \"year\", value: _(\"Year\"), icon: \"shi-year\" },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.SetMode(id),\n\t\t\t},\n\t\t};\n\n\t\tif (units) {\n\t\t\tlist.data.push({ id: \"units\", value: _(\"Units\"), icon: \"shi-units\" });\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tlist.data.push({\n\t\t\t\tid: \"timeline\",\n\t\t\t\tvalue: _(\"Timeline\"),\n\t\t\t\ticon: \"shi-timeline\",\n\t\t\t});\n\t\t}\n\n\t\tconst ui = {\n\t\t\tview: \"sidemenu\",\n\t\t\tanimate: false,\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_scheduler_sidemenu\",\n\t\t\twidth: 300,\n\t\t\tstate: state => {\n\t\t\t\tconst tHeight = webix.skin.$active.tabbarHeight + 10;\n\t\t\t\tstate.left = this.Parent.left;\n\t\t\t\tstate.top = this.Parent.top + tHeight + 2;\n\t\t\t\tstate.height = this.Parent.height - tHeight - 2;\n\t\t\t},\n\t\t\tbody: list,\n\t\t};\n\n\t\tif (this.app.config.calendars)\n\t\t\tui.body = {\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tbody: {\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [list, side],\n\t\t\t\t},\n\t\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\n\t\tthis.on(this.app, \"view:resize\", () => {\n\t\t\tif (this.getRoot().isVisible()) this.Show(true);\n\t\t});\n\t}\n\tShow(updatePos) {\n\t\tif (!updatePos && this.getRoot().isVisible()) return;\n\n\t\tthis.Parent = this.app.getRoot().$view.getBoundingClientRect();\n\t\tthis.$$(\"modes\").select(this.State.mode);\n\t\tthis.getRoot().show();\n\t}\n\tSetMode(value) {\n\t\tthis.getRoot().hide();\n\n\t\t//wait until hide animation is complete\n\t\tsetTimeout(() => this.State.$batch({ mode: value, selected: null }), 500);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport NavBarView from \"views/bars/nav\";\nimport DateView from \"views/bars/date\";\nimport AddView from \"views/bars/add\";\nimport NavPopupView from \"views/bars/navpopup\";\n\nexport default class TopBarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst todayIcon = {\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-calendar\",\n\t\t\tbatch: \"compact\",\n\t\t\ttooltip: _(\"Today\"),\n\t\t\tclick: () => this.SetToday(),\n\t\t};\n\t\tconst todayBtn = {\n\t\t\tview: \"align\",\n\t\t\talign: \"middle\",\n\t\t\tbatch: \"full\",\n\t\t\tbody: {\n\t\t\t\twidth: 80,\n\t\t\t\tview: \"button\",\n\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\tvalue: _(\"Today\"),\n\t\t\t\tclick: () => this.SetToday(),\n\t\t\t},\n\t\t};\n\n\t\tconst ui = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_scheduler_toolbar webix_dark\",\n\t\t\tresponsive: true,\n\t\t\tpaddingY: 0,\n\t\t\tpaddingX: 4,\n\t\t\theight: webix.skin.$active.tabbarHeight + 10,\n\t\t\tvisibleBatch: this.Compact ? \"compact\" : \"full\",\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"shi-menu\",\n\t\t\t\t\tclick: () => this.ShowNav(),\n\t\t\t\t\thidden: !this.Compact && !this.app.config.calendars,\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tbody: AddView,\n\t\t\t\t\tbatch: \"full\",\n\t\t\t\t\t//[ToDO] makes sence to hide it on medium screens to allows smaller compactWidth\n\t\t\t\t\t//in this case click-to-add behaviour for modes must be implemenetd\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tbody: DateView,\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\ttodayBtn,\n\t\t\t\t{ width: 12 },\n\t\t\t\tNavBarView,\n\t\t\t\ttodayIcon,\n\t\t\t],\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\n\t\tif (this.Compact) this.NavPopup = this.ui(NavPopupView);\n\n\t\tthis.on(this.State.$changes, \"readonly\", value => {\n\t\t\tthis.ToggleAdd(value);\n\t\t});\n\t}\n\tSetToday() {\n\t\tthis.State.date = webix.Date.dayStart(new Date());\n\t}\n\tShowNav() {\n\t\tif (this.Compact) this.NavPopup.Show();\n\t\telse this.app.callEvent(\"show:panel\");\n\t}\n\tToggleAdd(value) {\n\t\tconst add = this.$$(\"add\");\n\t\tif (value) add.hide();\n\t\telse if (!this.Compact) add.show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class EventActionMenu extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\twidth: 220,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{ id: \"this\", value: _(\"This event\") },\n\t\t\t\t\t{ id: \"next\", value: _(\"This event and the following\") },\n\t\t\t\t\t{ id: \"all\", value: _(\"All events\") },\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: id => {\n\t\t\t\t\t\tif (this.Result) this.Result.resolve(id);\n\t\t\t\t\t\tthis.Result = null;\n\t\t\t\t\t\tthis.Root.hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => {\n\t\t\t\t\tif (this.Result) this.Result.reject();\n\t\t\t\t\tthis.Result = null;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.Root = view;\n\t}\n\n\tShow(node) {\n\t\tthis.Result = webix.promise.defer();\n\t\tthis.Root.show(node);\n\t\treturn this.Result;\n\t}\n}\n","export function shrinkTo(start, end) {\n\treturn ev => {\n\t\tconst before = ev.start_date <= start;\n\t\tconst after = ev.end_date >= end;\n\n\t\tif (before || after) {\n\t\t\tconst t = webix.copy(ev);\n\t\t\tif (before) t.start_date = start;\n\t\t\tif (after) t.end_date = end;\n\t\t\treturn t;\n\t\t}\n\n\t\treturn ev;\n\t};\n}\n\nexport function isToday(date) {\n\treturn webix.Date.equal(\n\t\twebix.Date.datePart(date),\n\t\twebix.Date.datePart(new Date())\n\t);\n}\n\nexport function isMultiDay(ev) {\n\treturn (\n\t\tev.all_day ||\n\t\t(ev.start_date.getDate() != ev.end_date.getDate() &&\n\t\t\tev.end_date - ev.start_date >= 1000 * 60 * 60 * 24 * 1)\n\t);\n}\n\n/**\n * Returns the difference between dates\n * @param {Date} start - date 1\n * @param {Date} end - date 2\n * @returns {number} difference between dates in days\n */\nexport function daysBetweenInclusive(start, end) {\n\tconst millisecondsPerDay = 24 * 60 * 60 * 1000;\n\treturn Math.round(\n\t\t(webix.Date.dayStart(end) - webix.Date.dayStart(start)) / millisecondsPerDay\n\t);\n}\n\n/**\n * Checks if the dates are the same\n * @param {Date} adate\n * @param {Date} bdate\n * @returns {Boolean}\n */\nexport function isSameDate(adate, bdate) {\n\treturn webix.Date.equal(\n\t\twebix.Date.dayStart(adate),\n\t\twebix.Date.dayStart(bdate)\n\t);\n}\n\nexport function getYearDay(date) {\n\tconst start = webix.Date.yearStart(date);\n\treturn (date - start) / 1000 / 60 / 60 / 24 + 1;\n}\n","const icalFormat = webix.Date.dateToStr(\"%Y%m%dT000000Z\");\n\nexport function parse(string) {\n\t//FREQ=DAILY;INTERVAL=2\n\tconst parts = string.split(\";\");\n\tconst config = {};\n\tfor (let i = 0; i < parts.length; i++) {\n\t\tconst [code, name] = parts[i].split(\"=\");\n\t\tconfig[code] = name;\n\t}\n\n\tif (config.UNTIL) config.UNTIL = strToDate(config.UNTIL);\n\tif (config.EXDATE) {\n\t\tconfig.EXDATE = config.EXDATE.split(\",\").map(d => strToDate(d));\n\t}\n\n\treturn config;\n}\n\nfunction strToDate(str) {\n\treturn new Date(\n\t\tstr.substr(0, 4) * 1,\n\t\tstr.substr(4, 2) * 1 - 1,\n\t\tstr.substr(6, 2) * 1\n\t);\n}\n\nexport function serialize(config) {\n\tconst str = [];\n\tfor (let key in config) {\n\t\tlet value = config[key];\n\t\tif (key === \"UNTIL\") value = icalFormat(value);\n\n\t\tif (key === \"EXDATE\") {\n\t\t\tvalue = value.map(d => icalFormat(d));\n\t\t\tvalue = value.join(\",\");\n\t\t}\n\t\tif (value) str.push(`${key}=${value}`);\n\t}\n\n\treturn str.join(\";\");\n}\n","import { serialize, parse } from \"helpers/ical\";\nexport const WEEKDAYS = [\"SU\", \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\"];\n\nexport const FREQUENCE = {\n\tDAILY: \"day\",\n\tWEEKLY: \"week\",\n\tMONTHLY: \"month\",\n\tYEARLY: \"year\",\n};\n\n/**\n * Splits each recurring event into a series of events and returns the resulting array\n * @param {Date} sdate - the start date\n * @param {Date} edate - the end date\n * @param {Object} ev - the event data object\n * @returns {Array} with recurring events split into occurrences\n */\nexport function explodeEvent(sdate, edate, ev) {\n\tconst mode = ev.$recurring;\n\n\tconst consts = {};\n\tconst res = [];\n\n\t// when we use week-days in recurring mode, convert structure\n\t// list of days => list of steps to the next allowed day\n\tfillWdays(mode, consts);\n\n\tconst xdate = new Date(ev.start_date);\n\tconst length = ev.end_date - ev.start_date;\n\n\t// occurrences before active window\n\tlet count = 1;\n\twhile (\n\t\t(sdate - xdate >= (length || 1) &&\n\t\t\t(!mode.UNTIL || xdate < mode.UNTIL) &&\n\t\t\t(!mode.COUNT || count <= mode.COUNT)) ||\n\t\tfindDate(mode.EXDATE, xdate)\n\t) {\n\t\t++count;\n\t\tnext(xdate, mode, consts);\n\t}\n\n\t// occurrences inside of window\n\twhile (\n\t\tedate > xdate &&\n\t\t(!mode.UNTIL || xdate < mode.UNTIL) &&\n\t\t(!mode.COUNT || count <= mode.COUNT)\n\t) {\n\t\t// make copy of recurring event\n\t\tif (!findDate(mode.EXDATE, xdate)) {\n\t\t\tconst copy = webix.copy(ev);\n\n\t\t\txdate.setHours(ev.start_date.getHours());\n\t\t\tcopy.start_date = new Date(xdate);\n\t\t\tcopy.end_date = new Date(xdate * 1 + length);\n\n\t\t\tcopy.$id = ev.id;\n\t\t\tcopy.id = copy.start_date.valueOf() + \"_\" + ev.id;\n\t\t\tres.push(copy);\n\t\t}\n\t\tcount++;\n\n\t\tnext(xdate, mode, consts);\n\t}\n\treturn res;\n}\n\n// IE support\n/**\n * Finds a date in an array of dates\n * @param {Array} arr - all dates\n * @param {Date} date - the date to be checked\n * @returns {Boolean}\n */\nfunction findDate(arr, date) {\n\tif (!arr) return false;\n\n\tfor (let i = 0; i < arr.length; ++i) {\n\t\tif (webix.Date.equal(webix.Date.dayStart(date), arr[i])) return true;\n\t}\n\treturn false;\n}\n\n/**\n * Defines the object that stores the recurring pattern, for more details please refer to the iCalendar docs https://icalendar.org/iCalendar-RFC-5545/3-8-5-3-recurrence-rule.html\n * @typedef {Object} Recurring\n * @property {string} FREQ - the step of repetition: DAILY, WEEKLY, MONTHLY, YEARLY\n * @property {(number|string)} INTERVAL - how many steps are between occurrences\n * @property {string} BYDAY - week days, e.g. SU,MO,TU,WE,TH,FR,SA\n * @property {(number|string)} BYMONTH - the number or a month (1-12)\n * @property {(number|string)} BYMONTHDAY - the date (day of a month)\n * @property {(number|string)} BYSETPOS - the number of the week day within a month\n * @property {string} UNTIL - a date like 19970902T090000\n * @property {(number|string)} COUNT - how many times the event repeats\n * @property {string} EXDATE - string with 1 or more dates, on which the event does not repeat, e.g. 19960402T010000Z,19960403T010000Z,19960404T010000Z\n */\n\n/**\n * Fills the list of steps to the next allowed day for recurring events that repeat by certain week days\n * @param {Recurring} mode - the object with the recurring pattern\n * @param {Object} consts - (for events that have BYDAY in their pattern) stores wdays (Array) - the list of steps to the next allowed day\n */\nexport function fillWdays(mode, consts) {\n\tif (mode.BYDAY) {\n\t\tconst diff = (consts.wdays = [0, 0, 0, 0, 0, 0, 0]);\n\t\tconst line = mode.BYDAY.split(\",\")\n\t\t\t.map(a => WEEKDAYS.indexOf(a))\n\t\t\t.sort();\n\n\t\t// for each allowed day, fill range with steps\n\t\tfor (let i = 0; i < line.length; i++) {\n\t\t\tconst s = line[i];\n\t\t\tconst e = line[i + 1] || line[0] + 7;\n\n\t\t\tfor (let j = s; j < e; j++) {\n\t\t\t\tdiff[j % 7] = e - j;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Calculates the date of the next occurrence of a repeating event\n * @param {Date} date - the current date\n * @param {Recurring} mode - the object with the recurring pattern\n * @param {Object} consts - (for events that have BYDAY in their pattern) stores wdays (Array) - the list of steps to the next allowed day\n */\nexport function next(date, mode, consts) {\n\tlet interval = (mode.INTERVAL || 1) * 1;\n\n\tlet now, step;\n\tswitch (mode.FREQ) {\n\t\tcase \"DAILY\":\n\t\t\tdate.setDate(date.getDate() + interval);\n\t\t\tbreak;\n\t\tcase \"WEEKLY\":\n\t\t\tnow = date.getDay();\n\t\t\tstep = consts.wdays ? consts.wdays[now] : 7;\n\t\t\tif (step + now > 6 && interval > 1) {\n\t\t\t\t// when new day is on the different week\n\t\t\t\t// add week interval as well\n\t\t\t\tstep += 7 * (interval - 1);\n\t\t\t}\n\t\t\tdate.setDate(date.getDate() + step);\n\t\t\tbreak;\n\t\tcase \"YEARLY\": {\n\t\t\tif (mode.BYYEARDAY) {\n\t\t\t\tdate.setFullYear(date.getFullYear() + interval);\n\t\t\t\tdate.setMonth(0);\n\t\t\t\tdate.setDate(1);\n\t\t\t\tdate.setDate(mode.BYYEARDAY);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tinterval *= 12;\n\t\t\t// falls through\n\t\t}\n\t\t/*eslint no-fallthrough: \"error\"*/\n\t\tcase \"MONTHLY\":\n\t\t\tnow = date.getMonth();\n\t\t\tdate.setDate(1);\n\t\t\tdate.setMonth(now + interval);\n\t\t\tif (mode.BYMONTHDAY) {\n\t\t\t\tdate.setDate(mode.BYMONTHDAY);\n\t\t\t\t// when date is outside of month bounds, switch to last day of month\n\t\t\t\tif ((now + interval) % 12 != date.getMonth()) date.setDate(0);\n\t\t\t} else if (mode.BYSETPOS) {\n\t\t\t\t// go to last day of month before one in question\n\t\t\t\tdate.setDate(0);\n\t\t\t\t// find the matching day\n\t\t\t\tfor (let i = 0; i < mode.BYSETPOS; i++) {\n\t\t\t\t\tstep = consts.wdays[date.getDay()];\n\t\t\t\t\tdate.setDate(date.getDate() + step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn date;\n}\n\n/**\n * Defines the result of the check if a date fits a BYDAY pattern\n * @typedef {Object} weekdayCheckResult\n * @property {Boolean} result true if the date fits the BYDAY pattern, false otherwise\n * @property {Date} start - the copy of the start date\n * @property {Array} days - BYDAY pattern as an array of strings\n * @property {string} oldDay - the week day of the start date\n */\n/**\n * Checks if the start day fits the recurring BYDAY pattern\n * @param {Date} sdate - the start date of an event\n * @param {Recurring} mode - the object with the recurring pattern\n * @returns {weekdayCheckResult} the result of the check\n */\nfunction checkDay(sdate, mode) {\n\tconst start = new Date(sdate);\n\tconst days = mode.BYDAY.split(\",\");\n\tconst oldDay = WEEKDAYS[start.getDay()];\n\tconst result = days.indexOf(oldDay) !== -1;\n\n\treturn { result, start, days, oldDay };\n}\n\n/**\n * Synchronizes the start and end dates to the BYDAY recurring pattern\n * @param {Date} sdate\n * @param {Date} edate\n * @param {Recurring} mode - the object with the recurring pattern\n * @return {Array} - the start and end dates of an event\n */\nexport function datesToWeekdays(sdate, edate, mode) {\n\tconst { result, start, days } = checkDay(sdate, mode);\n\tif (result) {\n\t\treturn [sdate, edate];\n\t}\n\n\tconst diff = WEEKDAYS.indexOf(days[0]) - start.getDay();\n\tstart.setDate(start.getDate() + diff);\n\n\tconst end = new Date(edate);\n\tend.setDate(end.getDate() + diff);\n\n\treturn [start, end];\n}\n\n/**\n * Synchronizes BYDAY recurring pattern with the date of an event\n * @param {Date} sdate - the start date of an event\n * @param {Recurring} mode - the object with the recurring pattern\n * @returns {string} with the new BYDAY pattern\n */\nexport function WeekdaysToDates(sdate, mode) {\n\tlet { result, days, oldDay } = checkDay(sdate, mode);\n\tif (result) {\n\t\treturn mode.BYDAY;\n\t}\n\n\tif (mode.FREQ === \"WEEKLY\") {\n\t\tdays.splice(WEEKDAYS.indexOf(days[0]), 0, oldDay);\n\t} else {\n\t\tdays = [oldDay];\n\t}\n\treturn days.join(\",\");\n}\n\n/**\n * Returns selection parameters for the global state\n * @param {Object} obj - the event data object\n * @returns {Object} with selection parameters\n */\nexport function getParams(obj) {\n\treturn { id: obj.$id || obj.id, date: obj.$recurring ? obj.id : null };\n}\n\n/**\n * Defines the selection.date parameter of the global state\n * @typedef {(Date|string)} SDate - a Date object or the ID of an event occurrence that consists of a timestamp and the event ID from DB, separated with _\n */\n\n/**\n * Gets a date from the selection.date parameter of the global state\n * @param {(SDate)} sdate\n * @returns {Date}\n */\nexport function extractDate(sdate) {\n\treturn webix.Date.dayStart(\n\t\tsdate.getDate ? sdate : new Date(sdate.split(\"_\")[0] * 1)\n\t);\n}\n\n/**\n * Updates the end of a recurring event sequence\n * @param {SDate} sdate\n * @param {Object} ev - the event data object\n * @param {Boolean} block\n * @returns {string} - serialized recurrence pattern\n */\nexport function clipSequence(sdate, ev, block) {\n\tconst date = extractDate(sdate);\n\n\tif (!block || (!ev.$recurring.UNTIL || ev.$recurring.UNTIL > date))\n\t\tev.$recurring.UNTIL = date;\n\n\tif (ev.$recurring.COUNT) delete ev.$recurring.COUNT;\n\n\tif (ev.$recurring.EXDATE) {\n\t\tev.$recurring.EXDATE = ev.$recurring.EXDATE.filter(d => d < date);\n\t}\n\n\treturn serialize(ev.$recurring);\n}\n\n/**\n * Removes the specified date from the recurrence pattern\n * @param {SDate} sdate\n * @param {Object} ev - the event data object\n * @returns {string} - serialized recurrence pattern\n */\nexport function cutOccurrence(sdate, ev) {\n\tconst date = extractDate(sdate);\n\n\tif (!ev.$recurring.EXDATE) ev.$recurring.EXDATE = [];\n\tev.$recurring.EXDATE.push(date);\n\n\treturn serialize(ev.$recurring);\n}\n\n/**\n * Gets the start and end dates for a particular occurrence from a series\n * @param {Object} obj - the event data object\n * @param {SDate} sdate\n * @returns {Object} with start_date and end_date\n */\nexport function separateSequence(obj, sdate) {\n\tconst start_date =\n\t\ttypeof sdate === \"string\"\n\t\t\t? new Date(sdate.split(\"_\")[0] * 1)\n\t\t\t: new Date(sdate);\n\tconst len = (obj.end_date - obj.start_date) / 1000 / 60; // mins\n\tconst end_date = webix.Date.add(start_date, len, \"minute\", true);\n\treturn { start_date, end_date };\n}\n\n/**\n * Checks if this is the first occurrence of a series\n * @param {SDate} sdate\n * @param {Date} evStart\n * @returns {Boolean}\n */\nexport function isFirstOccurrence(sdate, evStart) {\n\t// editing 'this' event as next\n\tif (!sdate) return false;\n\n\tconst od = sdate.getDate ? sdate : new Date(sdate.split(\"_\")[0] * 1);\n\treturn od <= evStart;\n}\n\n/**\n * Corrects the edit mode for specific cases (depending on which occurrence was selected)\n * @param {Object} obj - the event data object\n * @param {string} mode - \"all\", \"next\", \"this\"\n * @returns {string}\n */\nexport function correctMode(obj, mode) {\n\tif (!obj.origin_id || !obj.recurring) {\n\t\tmode = \"all\";\n\t} else {\n\t\t// if this is 1st occ in 'next' which is the last part of 'all'\n\t\tif (this.app.getService(\"local\").isLastPart(obj)) {\n\t\t\tmode = \"\";\n\t\t}\n\t}\n\treturn mode;\n}\n\nconst dayLength = 86400000;\n/**\n * Moves a recurrence pattern if a recurring event was moved to another date\n * @param {Recurring} rec\n * @param {Object} newEvent - the new event data object\n * @param {Object} oldEvent - the old event data object\n * @returns {Recurring}\n */\nexport function movePattern(rec, newEvent, oldEvent) {\n\tlet days =\n\t\t(webix.Date.dayStart(newEvent.start_date) -\n\t\t\twebix.Date.dayStart(oldEvent.start_date)) /\n\t\tdayLength;\n\n\tif (days) {\n\t\tif (rec.UNTIL) {\n\t\t\tconst until = webix.Date.add(rec.UNTIL, days, \"day\", true);\n\n\t\t\tif (until > newEvent.end_date) rec.UNTIL = until;\n\t\t\telse\n\t\t\t\trec.UNTIL = webix.Date.dayStart(\n\t\t\t\t\twebix.Date.add(newEvent.end_date, 1, \"day\", true)\n\t\t\t\t);\n\t\t}\n\n\t\t// day of start_date changed and pattern doesn't have in anymore\n\t\tif (rec.BYDAY) {\n\t\t\tdays %= 7;\n\t\t\tif (days < 0) days += 7;\n\t\t\trec.BYDAY = rec.BYDAY.split(\",\")\n\t\t\t\t.map(d => WEEKDAYS[(WEEKDAYS.indexOf(d) + days) % 7])\n\t\t\t\t.join(\",\");\n\t\t}\n\n\t\t// in case day of start_date changed in monthly or yearly\n\t\tif (rec.BYMONTHDAY) {\n\t\t\tconst nmd = newEvent.start_date.getDate();\n\t\t\tif (nmd != rec.BYMONTHDAY) {\n\t\t\t\trec.BYMONTHDAY = nmd;\n\t\t\t}\n\t\t}\n\t}\n\n\t// week number of start_date changed in yearly or monthly\n\tif (rec.BYSETPOS) {\n\t\tconst nwn = getWeekNum(newEvent.start_date);\n\t\tif (rec.BYSETPOS != nwn) rec.BYSETPOS = nwn;\n\t}\n\n\t// month of start_date changed in a yearly event\n\tif (rec.BYMONTH) {\n\t\tconst nm = newEvent.start_date.getMonth() + 1;\n\t\tif (nm != rec.BYMONTH) rec.BYMONTH = nm;\n\t}\n\n\treturn rec;\n}\n\n/**\n * Returns the number of a week day within a month (e.g. 3rd Wednesday)\n * @param {Date} date\n * @returns {number}\n */\nexport function getWeekNum(date) {\n\tconst day = date.getDate();\n\treturn Math.floor(day / 7) + (day % 7 ? 1 : 0);\n}\n\n/**\n * Fills incomplete recurring patterns and ensures that they are consistent with the dates of events\n * @param {Object} ev - data object of an event\n */\nexport function checkPattern(ev) {\n\tconst mode = ev.$recurring || parse(ev.recurring);\n\n\t// when exact date not configured, fill recurring config\n\tif (mode.FREQ === \"WEEKLY\" && !mode.BYDAY) {\n\t\tmode.BYDAY = WEEKDAYS[ev.start_date.getDay()];\n\t\treturn;\n\t}\n\n\tif (\n\t\t(mode.FREQ === \"MONTHLY\" || mode.FREQ === \"YEARLY\") &&\n\t\t!mode.BYSETPOS &&\n\t\t!mode.BYMONTHDAY &&\n\t\t!mode.BYYEARDAY\n\t) {\n\t\tmode.BYMONTHDAY = ev.start_date.getDate();\n\t\treturn;\n\t}\n\n\tif (mode.FREQ === \"YEARLY\" && !mode.BYMONTH && !mode.BYYEARDAY) {\n\t\tmode.BYMONTH = ev.start_date.getMonth();\n\t\treturn;\n\t}\n\n\t// in case config is wrong, fix it\n\tif (mode.BYDAY) mode.BYDAY = WeekdaysToDates(ev.start_date, mode);\n\tif (mode.BYMONTHDAY) mode.BYMONTHDAY = ev.start_date.getDate();\n\tif (mode.BYMONTH) mode.BYMONTH = ev.start_date.getMonth() + 1;\n\tif (mode.BYSETPOS) mode.BYSETPOS = getWeekNum(ev.start_date);\n\n\tev.recurring = serialize(mode);\n}\n","import { JetView } from \"webix-jet\";\nimport { WEEKDAYS, fillWdays, next } from \"helpers/recurring\";\n\nexport default class RecurringFormView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"recurringForm\",\n\t\t\thidden: true,\n\t\t\telementsConfig: { labelPosition: \"left\" },\n\t\t\tpadding: {\n\t\t\t\ttop: aSkin.layoutPadding.form,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: compact ? aSkin.layoutPadding.form : 0,\n\t\t\t\tright: compact ? 14 : 0,\n\t\t\t},\n\t\t\tborderless: true,\n\t\t\trows: [\n\t\t\t\tthis.CreateIntervalControls(_),\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"customRecControls\",\n\t\t\t\t\thidden: true,\n\t\t\t\t\trows: [this.CreateCheckboxes(_), this.CreateSelect(_)],\n\t\t\t\t},\n\t\t\t\tthis.CreateRadio(_),\n\t\t\t],\n\t\t};\n\n\t\tif (!compact) {\n\t\t\tform.on = {\n\t\t\t\tonChange: (o, v, m) => this.UpdateEvent(m),\n\t\t\t};\n\t\t}\n\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.Form = this.$$(\"recurringForm\");\n\t\tthis.Events = this.app.getService(\"local\").events(true);\n\n\t\t// commonly called controls\n\t\tthis.CheckBoxContainer = this.$$(\"weekly\");\n\t\tthis.Checkboxes = this.CheckBoxContainer.getChildViews().slice(1);\n\t\tthis.Checkboxes.pop();\n\t\tthis.PatternSelect = this.$$(\"patternSelect\");\n\t\tthis.UntilDateContainer = this.$$(\"untilDate\");\n\t\tthis.UntilDateCalendar = this.Form.elements.untilDate.getPopup().getBody();\n\t\tthis.UntilNumContainer = this.$$(\"untilCount\");\n\t\tthis.UntilNum = this.UntilNumContainer.getBody();\n\t\tthis.CustomRecControls = this.$$(\"customRecControls\");\n\t}\n\n\t// methods of main controls: counter of INTERVAL and richselect of FREQ\n\n\t/**\n\t * Returns the config object for interval counter and recurrence frequency selection\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateIntervalControls(_) {\n\t\treturn {\n\t\t\tmargin: 8,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"counter\",\n\t\t\t\t\tlabel: _(\"Every\"),\n\t\t\t\t\tlabelWidth: 50,\n\t\t\t\t\tmin: 1,\n\t\t\t\t\tname: \"INTERVAL\",\n\t\t\t\t\tcss: \"webix_scheduler_counter\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"FREQ\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"DAILY\", value: _(\"day\") },\n\t\t\t\t\t\t{ id: \"WEEKLY\", value: _(\"week\") },\n\t\t\t\t\t\t{ id: \"MONTHLY\", value: _(\"month\") },\n\t\t\t\t\t\t{ id: \"YEARLY\", value: _(\"year\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Switches controls for detailed recurrence pattern selection depending on the frequency\n\t * @param {string} v - recurrence frequency\n\t */\n\tChangeControls(v) {\n\t\tthis._freq = v;\n\t\tif (v === \"DAILY\") {\n\t\t\tthis.CustomRecControls.hide();\n\t\t} else {\n\t\t\tthis.CustomRecControls.show();\n\t\t\tif (v === \"WEEKLY\") {\n\t\t\t\tthis.CheckBoxContainer.show();\n\t\t\t\tthis.PatternSelect.hide();\n\t\t\t} else {\n\t\t\t\tthis.CheckBoxContainer.hide();\n\t\t\t\tif (v === \"MONTHLY\" && this.PatternSelect.getValue() == 3)\n\t\t\t\t\tthis.PatternSelect.setValue(1);\n\t\t\t\tthis.PatternSelect.show();\n\t\t\t\tthis.PatternSelect.getList().refresh();\n\t\t\t\tthis.PatternSelect.refresh();\n\t\t\t}\n\t\t}\n\t}\n\n\t// methods of checkboxes for WEEKLY\n\n\t/**\n\t * Returns the config object for week day checkboxes\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateCheckboxes(_) {\n\t\tconst days = [];\n\t\tfor (let i = 0; i < 7; ++i) {\n\t\t\tdays.push({\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tlabel: webix.i18n.calendar.dayShort[i],\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t\tlabelAlign: \"center\",\n\t\t\t\tcss: \"webix_scheduler_day_checkbox\",\n\t\t\t\tinputWidth: 26,\n\t\t\t\twidth: 45,\n\t\t\t\talign: \"center\",\n\t\t\t\tname: WEEKDAYS[i],\n\t\t\t\ton: {\n\t\t\t\t\tonChange(v, o) {\n\t\t\t\t\t\tthis.$scope.CheckboxGuard(this.config.name, v, o);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tlocalId: \"weekly\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"on\"), width: 45 },\n\t\t\t\t...days,\n\t\t\t\t{ gravity: 0.00001 },\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Prevents the user from unchecking the only checked weekday checkbox\n\t * @param {string} day - the name of the related checkbox (SU, MO, TU, WE, TH, FR, or SA)\n\t * @param {(Boolean|number)} v - the new value of a checkbox (false/0 or true/1)\n\t * @param {(Boolean|number)} o - the old value of a checkbox (false/0 or true/1)\n\t */\n\tCheckboxGuard(day, v, o) {\n\t\tif (!webix.isUndefined(o) && !v && !this.GetBYDAY()) {\n\t\t\tthis.Form.setValues({ [day]: 1 }, true);\n\t\t}\n\t}\n\n\t/**\n\t * Sets values to weekday checkboxes according to BYDAY recurrence pattern (week days)\n\t * @param {Object} values - values from the form\n\t */\n\tSetBYDAY(values) {\n\t\tconst days = values.BYDAY.split(\",\");\n\t\tthis.Checkboxes.forEach(check => {\n\t\t\tvalues[check.config.name] = !!days.find(d => d == check.config.name);\n\t\t});\n\t}\n\n\t/**\n\t * Gets the BYDAY pattern from checkbox values\n\t * @returns {string}\n\t */\n\tGetBYDAY() {\n\t\tconst BYDAY = [];\n\t\tthis.Checkboxes.forEach(check => {\n\t\t\tif (check.getValue()) {\n\t\t\t\tBYDAY.push(check.config.name);\n\t\t\t}\n\t\t});\n\t\treturn BYDAY.join(\",\");\n\t}\n\n\t// methods of richselect with MONTHLY and YEARLY patterns\n\n\t/**\n\t * Returns the config object for a dropdown list with monthly/yearly recurrence patterns\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateSelect(_) {\n\t\treturn {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"patternSelect\",\n\t\t\tname: \"rec_pattern\",\n\t\t\tsuggest: {\n\t\t\t\tdata: [],\n\t\t\t\tbody: {\n\t\t\t\t\ttemplate: obj => {\n\t\t\t\t\t\tif (this._freq === \"YEARLY\" && obj.BYYEARDAY) {\n\t\t\t\t\t\t\treturn `${_(\"Every\")} ${obj.BYYEARDAY} ${_(\"day of year\")}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst byDay = [];\n\t\t\t\t\t\tif (obj.BYDAY) {\n\t\t\t\t\t\t\tobj.BYDAY.forEach(d =>\n\t\t\t\t\t\t\t\tbyDay.push(webix.i18n.calendar.dayFull[d])\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet text = `${_(\"Every\")} ${obj.BYMONTHDAY || obj.BYSETPOS} ${\n\t\t\t\t\t\t\tobj.BYDAY ? byDay.join(\", \") : \"\"\n\t\t\t\t\t\t}`;\n\t\t\t\t\t\tif (this._freq === \"YEARLY\")\n\t\t\t\t\t\t\ttext += ` ${_(\"of\")} ${\n\t\t\t\t\t\t\t\twebix.i18n.calendar.monthFull[obj.BYMONTH - 1]\n\t\t\t\t\t\t\t}`;\n\t\t\t\t\t\treturn text;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tthis.getList().filter(\n\t\t\t\t\t\t\tobj => this.$scope._freq === \"YEARLY\" || obj.id != 3\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Describes calculated constants of a date\n\t * @typedef {Object} DateInfo\n\t * @property {number} day - the date (day of month)\n\t * @property {number} weekday - the number of a weekday (0-6)\n\t * @property {number} month - the number of month (0-11)\n\t * @property {number} weekNum - the number of a weekday within a month (e.g. 4th Friday)\n\t */\n\n\t/**\n\t * Sets pattern options for the dropdown list (monthly and yearly events)\n\t * @param {Object} ev - values from the form\n\t * @param {DateInfo} calculated - calculated constants of a date\n\t */\n\tSetPatternOptions(ev, calculated) {\n\t\tthis.PatternSelect.getList().parse([\n\t\t\t{\n\t\t\t\tid: 1,\n\t\t\t\tBYMONTH: ev.BYMONTH || calculated.month + 1,\n\t\t\t\tBYMONTHDAY: ev.BYMONTHDAY || calculated.day,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 2,\n\t\t\t\tBYSETPOS: ev.BYSETPOS || calculated.weekNum,\n\t\t\t\tBYDAY: [calculated.weekday],\n\t\t\t\tBYMONTH: ev.BYMONTH || calculated.month + 1,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 3,\n\t\t\t\tBYYEARDAY: ev.BYYEARDAY || calculated.yearday,\n\t\t\t},\n\t\t]);\n\t\tthis.PatternSelect.refresh();\n\t\tthis._freq = ev.FREQ;\n\n\t\tev.rec_pattern = ev.BYSETPOS ? 2 : ev.BYYEARDAY ? 3 : 1;\n\t}\n\n\t/**\n\t *\n\t * @param {Object} values - values from the form\n\t */\n\tGetRecPattern(values) {\n\t\tconst data = webix.copy(\n\t\t\tthis.PatternSelect.getList().getItem(values.rec_pattern)\n\t\t);\n\n\t\tif (this._freq === \"MONTHLY\") delete data.BYMONTH;\n\t\tif (data.BYDAY) data.BYDAY = data.BYDAY.map(d => WEEKDAYS[d]).join(\",\");\n\t\tdelete data.id;\n\n\t\treturn data;\n\t}\n\n\t// methods of radio for UNTIL\n\n\t/**\n\t * Returns the config object for the radio with options for setting the end of repetition\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateRadio(_) {\n\t\tconst selectors = {\n\t\t\twidth: 130,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"untilDate\",\n\t\t\t\t\talign: \"middle\",\n\t\t\t\t\tview: \"align\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\tname: \"untilDate\",\n\t\t\t\t\t\ticons: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"untilCount\",\n\t\t\t\t\tview: \"align\",\n\t\t\t\t\talign: \"bottom\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tname: \"untilCount\",\n\t\t\t\t\t\tview: \"counter\",\n\t\t\t\t\t\tcss: \"webix_scheduler_counter\",\n\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"End repeat\") },\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\tname: \"until\",\n\t\t\t\t\t\t\tlocalId: \"until\",\n\t\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{ id: 1, value: _(\"never\") },\n\t\t\t\t\t\t\t\t{ id: 2, value: _(\"date\") },\n\t\t\t\t\t\t\t\t{ id: 3, value: _(\"after several occurrences\") },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: v => this.ChangeSelectors(v),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectors,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Switches controls for dates or numbers for setting the end of repetition\n\t * @param {(number|string)} v - the value of the radio that sets the type of repetition end (1,2,3)\n\t */\n\tChangeSelectors(v) {\n\t\tthis.UntilDateContainer[v === \"2\" ? \"show\" : \"hide\"]();\n\t\tthis.UntilNumContainer[v === \"3\" ? \"show\" : \"hide\"]();\n\t}\n\n\t/**\n\t * Sets the values of controls that are used to choose the end of repetition\n\t * @param {Object} values - values from the form\n\t */\n\tSetUNTIL(values) {\n\t\tconst start = this._StartDate;\n\t\tvalues.until = values.COUNT ? 3 : values.UNTIL ? 2 : 1;\n\t\tvalues.untilDate = values.UNTIL || webix.Date.add(start, 1, \"year\", true);\n\t\tvalues.untilCount = values.COUNT || this.CountNum(values);\n\t\tthis.UntilDateCalendar.define({ minDate: start });\n\t}\n\n\t/**\n\t * Calculates the number of occurrences based on the end date of repetition (UNTIL)\n\t * @param {Object} values - values from the form\n\t */\n\tCountNum(values) {\n\t\tlet res = 0;\n\n\t\tif (values.UNTIL) {\n\t\t\tconst consts = {};\n\t\t\tfillWdays(values, consts);\n\t\t\tlet date = webix.Date.copy(this._StartDate);\n\n\t\t\twhile (date <= values.UNTIL) {\n\t\t\t\tdate = next(date, values, consts);\n\t\t\t\tres++;\n\t\t\t}\n\t\t} else {\n\t\t\tres = 3;\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t// subform methods\n\n\t/**\n\t * Sets values into this form\n\t * @param {Object} event - the event data object\n\t * @param {DateInfo} calculated - calculated constants of a date\n\t * @param {Boolean} silent - if true, the form is marked as 'saved' (containing no unsaved values)\n\t */\n\tSetValues(event, calculated, silent) {\n\t\tif (!calculated) return this.Form.setValues(event, true);\n\n\t\tthis._StartDate = event.start_date;\n\t\tlet values = event.$recurring;\n\n\t\tif (!values) {\n\t\t\tvalues = { FREQ: \"DAILY\" };\n\t\t}\n\n\t\tif (!values.INTERVAL) values.INTERVAL = 1;\n\t\tif (!values.BYDAY) {\n\t\t\tvalues.BYDAY = WEEKDAYS[calculated.weekday];\n\t\t}\n\n\t\t// for a reset\n\t\tif (!values.EXDATE) values.EXDATE = [];\n\n\t\tthis.SetUNTIL(values);\n\t\tthis.SetBYDAY(values);\n\t\tthis.SetPatternOptions(values, calculated);\n\t\tthis.Form.setValues(values, true);\n\t\tif (silent) this.Form.setDirty();\n\t}\n\n\t/**\n\t * Defines the object that stores the recurring pattern, for more details please refer to the iCalendar docs https://icalendar.org/iCalendar-RFC-5545/3-8-5-3-recurrence-rule.html\n\t * @typedef {Object} Recurring\n\t * @property {string} FREQ - the step of repetition: DAILY, WEEKLY, MONTHLY, YEARLY\n\t * @property {(number|string)} INTERVAL - how many steps are between occurrences\n\t * @property {string} BYDAY - week days, e.g. SU,MO,TU,WE,TH,FR,SA\n\t * @property {(number|string)} BYMONTH - the number or a month (1-12)\n\t * @property {(number|string)} BYMONTHDAY - the date (day of a month)\n\t * @property {(number|string)} BYSETPOS - the number of the week day within a month\n\t * @property {string} UNTIL - a date like 19970902T090000\n\t * @property {(number|string)} COUNT - how many times the event repeats\n\t * @property {string} EXDATE - string with 1 or more dates, on which the event does not repeat, e.g. 19960402T010000Z,19960403T010000Z,19960404T010000Z\n\t */\n\n\t/**\n\t * Collects recurrence pattern object from form values and returns it\n\t * @returns {Recurring} the object that stores the recurring pattern\n\t */\n\tGetValues() {\n\t\tlet values = this.Form.getValues();\n\n\t\tlet res = {\n\t\t\tFREQ: values.FREQ,\n\t\t\tINTERVAL: values.INTERVAL,\n\t\t\tUNTIL: values.until == 2 ? values.untilDate : this.GetUntil(values),\n\t\t\tCOUNT: values.until == 3 ? values.untilCount : null,\n\t\t\tEXDATE: values.EXDATE || [],\n\t\t};\n\n\t\tif (values.FREQ === \"WEEKLY\") {\n\t\t\tres.BYDAY = this.GetBYDAY(values);\n\t\t} else if (values.FREQ === \"MONTHLY\" || values.FREQ === \"YEARLY\") {\n\t\t\tres = webix.extend(res, this.GetRecPattern(values));\n\t\t}\n\n\t\tthis.Form.setDirty();\n\n\t\treturn res;\n\t}\n\n\t/**\n\t * Calculates the end of repetition as date based on COUNT\n\t * @param {Object} values - values from the form\n\t * @returns {Date}\n\t */\n\tGetUntil(values) {\n\t\tif (values.until == 3) {\n\t\t\tconst consts = {};\n\t\t\tfillWdays(values, consts);\n\t\t\tlet date = webix.Date.copy(this._StartDate);\n\t\t\tfor (let i = 1; i < values.untilCount; ++i) {\n\t\t\t\tdate = next(date, values, consts);\n\t\t\t}\n\t\t\tdate = webix.Date.add(date, 1, \"day\", true);\n\t\t\tthis.Form.setValues({ untilDate: date }, true);\n\t\t\treturn date;\n\t\t} else return null;\n\t}\n\n\t/**\n\t * Collects all values and sends them to the master form for event update (via global app event)\n\t * @param {string} mode - \"user\" means that the change was made via UI\n\t */\n\tUpdateEvent(mode) {\n\t\tif (mode === \"user\") {\n\t\t\tconst change = this.GetValues();\n\t\t\tthis.app.callEvent(\"form:update:recurring\", [{ $recurring: change }]);\n\t\t\tthis.Form.setDirty();\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this form has changed values\n\t * @returns {Boolean}\n\t */\n\tIsDirty() {\n\t\treturn this.Form.isDirty();\n\t}\n\n\t/**\n\t * Shows this form\n\t */\n\tShow() {\n\t\tthis.getRoot().show();\n\t}\n\n\t/**\n\t * Hides this form\n\t */\n\tHide() {\n\t\tthis.getRoot().hide();\n\t}\n}\n","import {\n\tisFirstOccurrence,\n\tcorrectMode,\n\textractDate,\n\tFREQUENCE,\n\tfillWdays,\n\tnext,\n} from \"./recurring\";\n\n/* public functions */\n\n/**\n * Changes the mode if the user selected the 1st occurrence in whole sequence or in 'next'\n * @param {string} mode - the mode of editing a recurring event (\"all\", \"next\", \"this\")\n * @param {object} obj - the event object\n * @param {Date} start - the start date of the event\n * @param {Date, string} date_id - the ID of an occurrence of a repeated event or the date of this occurrence\n */\nfunction changeMode(mode, obj, start, date_id) {\n\tif (mode && mode === \"next\" && isFirstOccurrence(date_id, start)) {\n\t\tmode = correctMode.call(this, obj, mode);\n\t}\n\n\treturn mode;\n}\n\n/**\n * Corrects recurring.COUNT or recurring.UNTIL based on all sub-events that are included in the edited range\n * @param {Object} obj - the event data\n * @param {string} mode - the mode of recurring editing (\"all\", \"next\")\n * @param {Date} sdate - the date of the currently selected event occurrence\n * @param {Object} collection - DataCollection of events\n */\nfunction correctCountUntil(obj, mode, sdate, collection) {\n\tconst oid = obj.origin_id || obj.$id || obj.id;\n\tconst parts = collection\n\t\t.find(e => {\n\t\t\treturn oid == e.origin_id && sdate < e.start_date;\n\t\t})\n\t\t.sort((a, b) => {\n\t\t\tif (a.start_date > b.start_date) return -1;\n\t\t\tif (a.start_date < b.start_date) return 1;\n\t\t\treturn 0;\n\t\t});\n\n\tconst rec = webix.copy(obj.$recurring);\n\n\tfor (let i = 0, last; i < parts.length; ++i) {\n\t\tlast = parts[i];\n\n\t\tif (last.$recurring) {\n\t\t\tif (last.$recurring.COUNT) {\n\t\t\t\tif (rec.COUNT && obj.$id != last.id) {\n\t\t\t\t\trec.COUNT = rec.COUNT * 1 + last.$recurring.COUNT * 1;\n\t\t\t\t} else {\n\t\t\t\t\trec.UNTIL = countToUntil(last);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trec.UNTIL = last.$recurring.UNTIL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (mode === \"next\" && !parts.length) {\n\t\tif (rec.COUNT) {\n\t\t\trec.COUNT = cutCount(obj, sdate);\n\t\t} else if (rec.UNTIL && obj.start_date >= rec.UNTIL) {\n\t\t\trec.UNTIL = webix.Date.add(\n\t\t\t\twebix.Date.dayStart(obj.start_date),\n\t\t\t\t1,\n\t\t\t\tFREQUENCE[rec.FREQ],\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\treturn rec;\n}\n\n/**\n * Checks if the selected repeating event has only 1 occurrence\n * @param {Object} obj - the event data\n */\nfunction hasOneOccurrence(obj) {\n\t// as this a 'this' event\n\tif (!obj.recurring) return true;\n\n\t// as 'this' any occurrence in unedited sequence\n\tif (!obj.$recurring.UNTIL) return false;\n\n\tconst end = webix.Date.dayStart(webix.Date.add(obj.end_date, 1, \"day\", true));\n\treturn webix.Date.equal(end, obj.$recurring.UNTIL);\n}\n\n/* EO public functions */\n\n/* private functions */\nfunction countToUntil(last) {\n\tconst lr = last.$recurring;\n\tlet step = lr.COUNT * 1; // !\n\tif (lr.FREQ === \"WEEKLY\") {\n\t\tstep = Math.floor((lr.BYDAY.split(\",\").length / 7) * lr.COUNT);\n\t}\n\treturn webix.Date.add(last.start_date, step, FREQUENCE[lr.FREQ], true);\n}\n\nfunction cutCount(obj, sdate) {\n\tconst date = extractDate(sdate);\n\n\tconst consts = {};\n\tfillWdays(obj.$recurring, consts);\n\tlet nexto = webix.Date.dayStart(obj.start_date);\n\tlet count = 0;\n\twhile (nexto < date) {\n\t\tcount++;\n\t\tnexto = next(nexto, obj.$recurring, consts);\n\t}\n\treturn obj.$recurring.COUNT - count;\n}\n/* EO private functions */\n\nexport default function EditRecurringMixin(child) {\n\tchild.ChangeMode = changeMode;\n\tchild.CorrectCountUntil = correctCountUntil;\n\tchild.HasOneOccurrence = hasOneOccurrence;\n}\n","import { JetView } from \"webix-jet\";\nimport getPalette from \"helpers/palette\";\nimport { getYearDay } from \"helpers/dates\";\n\nimport {\n\tWEEKDAYS,\n\tfillWdays,\n\tnext,\n\tdatesToWeekdays,\n\tWeekdaysToDates,\n\tclipSequence,\n\tcutOccurrence,\n\tseparateSequence,\n} from \"helpers/recurring\";\nimport { serialize } from \"helpers/ical\";\nimport RecurringFormView from \"./recurringform\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class EventFormView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: 14,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\ttooltip: _(\"Close\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{ view: \"label\", label: _(\"Edit event\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\thotkey: \"Ctrl+Enter\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tscroll: true,\n\t\t\tborderless: true,\n\t\t\tpadding: { right: 14 },\n\t\t\telementsConfig: { labelPosition: \"top\" },\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", label: _(\"Event\"), name: \"text\" },\n\t\t\t\t{\n\t\t\t\t\tmargin: 8,\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.GetDateTime(\"start\", _, aSkin),\n\t\t\t\t\t\tthis.GetDateTime(\"end\", _, aSkin),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tname: \"all_day\",\n\t\t\t\t\tlabelPosition: \"left\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"All Day\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleTimeControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.CreateCalendarColor(_),\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tlabel: _(\"Notes\"),\n\t\t\t\t\tname: \"details\",\n\t\t\t\t\theight: 150,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (v, o, m) => {\n\t\t\t\t\t// some fields need preprocessing\n\t\t\t\t\tconst change = this.Form.getDirtyValues();\n\t\t\t\t\tif (Object.keys(change).length) this.PrepareChange(change);\n\t\t\t\t\tif (!this.Compact && m === \"user\")\n\t\t\t\t\t\tthis.Wait(() => this.UpdateEvent(change));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tif (this.app.config.recurring)\n\t\t\tform.elements.splice(3, 0, this.CreateRepeat(_, aSkin));\n\n\t\tif (this.app.config.units) {\n\t\t\tconst index = this.app.config.recurring ? 5 : 4;\n\t\t\tform.elements.splice(index, 0, this.CreateUnitSelector(_));\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tlet index = this.app.config.recurring ? 5 : 4;\n\t\t\tif (this.app.config.units) index++;\n\t\t\tform.elements.splice(index, 0, this.CreateSectionSelector(_));\n\t\t}\n\n\t\tconst config = {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [toolbar, form],\n\t\t\t},\n\t\t};\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.Form = this.$$(\"form\");\n\t\tthis.Local = this.app.getService(\"local\").events(true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\n\t\t// extending this class with common methods for editing of recurring events\n\t\tEditRecurringMixin(this);\n\n\t\t// most commonly called controls\n\t\tthis.RecurringOptions = this.$$(\"recOption\");\n\t\tthis.StartTime = this.$$(\"startTime\");\n\t\tthis.EndTime = this.$$(\"endTime\");\n\n\t\tthis.on(this.State.$changes, \"readonly\", (_v, o) => {\n\t\t\tif (!webix.isUndefined(o)) this.Close();\n\t\t});\n\n\t\tthis.on(this.app, \"form:update:recurring\", update => {\n\t\t\t// 'update' as imitated dirty value\n\t\t\tif (Object.keys(update).length) this.PrepareChange(update);\n\t\t\tthis.UpdateEvent(update);\n\t\t});\n\n\t\t// parse lists that are not data dependable\n\t\tconst local = this.app.getService(\"local\");\n\t\tif (this.app.config.calendars) {\n\t\t\tthis.Calendars = local.calendars(true);\n\t\t\tthis.$$(\"calendar\")\n\t\t\t\t.getList()\n\t\t\t\t.parse(this.Calendars);\n\t\t}\n\n\t\tif (this.app.config.units) {\n\t\t\tconst waitUnits = local.units();\n\t\t\tconst combo = this.Form.elements[\"units\"];\n\t\t\twaitUnits.then(units => {\n\t\t\t\tcombo.getList().parse(units);\n\t\t\t\tcombo.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tthis.Sections = local.sections(true);\n\t\t\tthis.$$(\"sections\")\n\t\t\t\t.getList()\n\t\t\t\t.parse(this.Sections);\n\t\t}\n\t}\n\n\tready() {\n\t\tthis.SubForm = this.getSubView(\"recurringForm\");\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.ClearTempEvent(); // support double clicks and 'Create' at any moment\n\t\t\t\tthis.Wait(() => this.FillForm(v));\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis.ClearTempEvent();\n\t}\n\n\t/**\n\t * Returns the config controls for editing recurring patterns of events\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t * @param {Object} aSkin - stores sizes and colors of a currently active Webix skin\n\t */\n\tCreateRepeat(_, aSkin) {\n\t\tconst rows = [\n\t\t\t{ view: \"label\", label: _(\"Repeat\"), height: aSkin.labelTopHeight },\n\t\t\t{\n\t\t\t\tmargin: 4,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\tlocalId: \"recOption\",\n\t\t\t\t\t\tname: \"rec_option\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{ id: \"none\", value: _(\"never\") },\n\t\t\t\t\t\t\t\t{ id: \"daily\", value: _(\"daily\") },\n\t\t\t\t\t\t\t\t{ id: \"weekly\" },\n\t\t\t\t\t\t\t\t{ id: \"monthly\" },\n\t\t\t\t\t\t\t\t{ id: \"yearly\" },\n\t\t\t\t\t\t\t\t{ id: \"work\", value: _(\"every working day\") },\n\t\t\t\t\t\t\t\t{ id: \"custom\", value: _(\"custom\") },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: (v, o) => this.ToggleSubform(v, o),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\tif (this.Compact) {\n\t\t\trows[1].cols.push({\n\t\t\t\tlocalId: \"editCustomRec\",\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-pencil\",\n\t\t\t\ttooltip: _(\"Change recurring pattern\"),\n\t\t\t\thidden: true,\n\t\t\t\tclick: () => this.ShowSubForm(),\n\t\t\t});\n\t\t}\n\n\t\trows.push({ $subview: RecurringFormView, name: \"recurringForm\" });\n\n\t\treturn { localId: \"repeatControls\", rows: rows };\n\t}\n\n\t/**\n\t * Hides or shows time selectors\n\t * @param {number} v - the value of 'all day' checkbox (1 or 0)\n\t */\n\tToggleTimeControls(v) {\n\t\tif (v == 1) {\n\t\t\tthis.StartTime.hide();\n\t\t\tthis.EndTime.hide();\n\t\t} else {\n\t\t\tthis.StartTime.show();\n\t\t\tthis.EndTime.show();\n\t\t}\n\t}\n\n\t/**\n\t * Shows or hides the subform for editing recurring pattern; the subform is shown when v is 'custom'\n\t * @param {string} v - the new recurring pattern option\n\t * @param {string} o  - the new recurring pattern option\n\t */\n\tToggleSubform(v, o) {\n\t\tif (v === \"custom\") {\n\t\t\tif (this.Compact) {\n\t\t\t\tthis.$$(\"editCustomRec\").show();\n\t\t\t\tif (o) this.ShowSubForm();\n\t\t\t} else {\n\t\t\t\tthis.SubForm.Show();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.SubForm.Hide();\n\t\t\tif (this.Compact) this.$$(\"editCustomRec\").hide();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the config of two controls: a selector of calendar and event color\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t */\n\tCreateCalendarColor(_) {\n\t\tconst ui = {\n\t\t\tmargin: 8,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\tvalue: \"#1abc9c\",\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\tbody: getPalette(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tif (this.app.config.calendars) {\n\t\t\tui.cols.unshift({\n\t\t\t\tview: \"richselect\",\n\t\t\t\tlocalId: \"calendar\",\n\t\t\t\tlabel: _(\"Calendar\"),\n\t\t\t\tname: \"calendar\",\n\t\t\t\tcss: \"webix_scheduler_cal_color\",\n\t\t\t\toptions: {\n\t\t\t\t\tcss: \"webix_scheduler_cal_color_suggest\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttooltip: () => \"\",\n\t\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\t\tconst active = obj.active * 1;\n\t\t\t\t\t\t\tconst css = active ? \"\" : \"class='webix_scheduler_cal_disabled'\";\n\t\t\t\t\t\t\tconst tooltip = active\n\t\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t\t: `webix_tooltip=\"${_(\"Inactive calendar\")}\"`;\n\n\t\t\t\t\t\t\treturn `<div style=\"overflow: hidden;\" ${tooltip} ${css}>${obj.text ||\n\t\t\t\t\t\t\t\t_(\"(no title)\")}\n\t\t\t\t\t\t\t\t<span class=\"webix_scheduler_cal_marker\" style=\"background-color:${obj.color};\">\n\t\t\t\t\t\t\t</span></div>`;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\treturn ui;\n\t}\n\n\t/**\n\t * Returns the config of two controls: a selector of calendar and event color\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t */\n\tCreateUnitSelector(_) {\n\t\tconst ui = {\n\t\t\tview: \"multicombo\",\n\t\t\tname: \"units\",\n\t\t\tlabel: _(\"Units\"),\n\t\t\toptions: [],\n\t\t};\n\t\treturn ui;\n\t}\n\n\t/**\n\t * Returns the config of controls for selecting date and time\n\t * @param {string} type - \"start\" or \"end\"\n\t * @param {function*} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t * @param {Object} aSkin - stores sizes and colors of a currently active Webix skin\n\t */\n\tGetDateTime(type, _, aSkin) {\n\t\treturn {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: aSkin.labelTopHeight,\n\t\t\t\t\tlabel: type === \"start\" ? _(\"Start\") : _(\"End\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 8,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: `${type}_date`,\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\ttype: \"calendar\",\n\t\t\t\t\t\t\t\ticons: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tlocalId: `${type}Time`,\n\t\t\t\t\t\t\tname: `${type}_time`,\n\t\t\t\t\t\t\ttype: \"time\",\n\t\t\t\t\t\t\tformat: \"%H:%i\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tCreateSectionSelector(_) {\n\t\treturn {\n\t\t\tlocalId: \"sections\",\n\t\t\tview: \"richselect\",\n\t\t\tlabel: _(\"Section\"),\n\t\t\tname: \"section\",\n\t\t\toptions: {\n\t\t\t\tdata: [],\n\t\t\t\tbody: {\n\t\t\t\t\ttemplate: \"#text#\",\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t// general form tasks\n\n\t/**\n\t * Fills the form with relevant values for editing of a selected event or adding a new event\n\t * @param {Object} ev - the current state.selected\n\t */\n\tFillForm(ev) {\n\t\tthis.Id = ev.id;\n\n\t\tthis.Form.focus();\n\t\tthis.Date = ev.date;\n\t\tif (typeof this.Date === \"string\") {\n\t\t\tthis.Date = new Date(this.Date.slice(0, this.Date.indexOf(\"_\")) * 1);\n\t\t}\n\n\t\tlet obj;\n\n\t\t// new record or a new copy of a record\n\t\tif (ev.id == \"0\") {\n\t\t\tif (this.State.clipboard && this.State.clipboard.selected) {\n\t\t\t\tobj = this.State.clipboard.selected;\n\t\t\t\tthis.$$(\"repeatControls\").hide();\n\t\t\t} else {\n\t\t\t\tobj = this.NewEvent(ev);\n\t\t\t}\n\n\t\t\tif (obj.then) {\n\t\t\t\treturn obj.then(res => {\n\t\t\t\t\tthis.Local.add({ id: ev.id, ...webix.copy(res) });\n\t\t\t\t\tthis.FillFormContinue(res);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.Local.add({ id: ev.id, ...webix.copy(obj) });\n\t\t\t}\n\t\t} else {\n\t\t\tobj = webix.copy(this.Local.getItem(ev.id));\n\n\t\t\tconst mode = this.getParam(\"mode\", true);\n\t\t\tif (mode) obj = this.AdaptObjToMode(mode, obj);\n\t\t}\n\n\t\tthis.FillFormContinue(obj);\n\t}\n\n\t/**\n\t * Fills the event object with relevant values according to the mode of editing\n\t * @param {string} mode - mode in which a recurring event will be edited (\"all\", \"next\", \"this\")\n\t * @param {Object} obj - event data\n\t */\n\tAdaptObjToMode(mode, obj) {\n\t\tmode = this.ChangeMode(\n\t\t\tmode,\n\t\t\tobj,\n\t\t\tobj.recurring\n\t\t\t\t? obj.start_date\n\t\t\t\t: this.Local.getItem(obj.origin_id).start_date,\n\t\t\tobj.recurring ? this.State.selected.date : obj.start_date\n\t\t);\n\t\tthis.setParam(\"mode\", mode, true);\n\n\t\tif (mode === \"all\" || mode === \"next\") {\n\t\t\tif (mode === \"all\" && obj.origin_id) {\n\t\t\t\tobj = webix.copy(this.Local.getItem(obj.origin_id));\n\t\t\t}\n\n\t\t\t// if this is a \"this\" sub-event\n\t\t\tif (!obj.$recurring)\n\t\t\t\tobj.$recurring = webix.copy(\n\t\t\t\t\tthis.Local.getItem(obj.origin_id).$recurring\n\t\t\t\t);\n\n\t\t\tif (obj.$recurring.COUNT || obj.$recurring.UNTIL) {\n\t\t\t\t// [FIXME] maybe need to store total UNTIL/COUNT on backend (mostly for dynamic loading)\n\t\t\t\tobj.$recurring = this.CorrectCountUntil(\n\t\t\t\t\tobj,\n\t\t\t\t\tmode,\n\t\t\t\t\tobj.start_date,\n\t\t\t\t\tthis.Local\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (mode === \"this\" || mode === \"next\") {\n\t\t\t// split event sequence or cut out an occurrence\n\t\t\tif (this.State.selected.date)\n\t\t\t\tobj = { ...obj, ...separateSequence(obj, this.State.selected.date) };\n\n\t\t\tif (mode === \"this\") {\n\t\t\t\tobj.$recurring = null;\n\t\t\t\tobj.recurring = \"\";\n\t\t\t\tthis.$$(\"repeatControls\").hide();\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Splits start and end dates into date and time parts and fills the form with values\n\t * @param {Object} obj - the event data\n\t */\n\tFillFormContinue(obj) {\n\t\tobj.start_time = webix.Date.copy(obj.start_date);\n\t\tobj.end_time = webix.Date.copy(obj.end_date);\n\n\t\tobj.start_date = webix.Date.datePart(obj.start_date);\n\t\tobj.end_date = webix.Date.datePart(obj.end_date);\n\n\t\tif (this.app.config.recurring) this.SetRecurring(obj);\n\n\t\tthis.Form.setValues(obj);\n\t}\n\n\t/**\n\t * Describes calculated constants of a date\n\t * @typedef {Object} DateInfo\n\t * @property {number} day - the date (day of month)\n\t * @property {number} weekday - the number of a weekday (0-6)\n\t * @property {number} month - the number of month (0-11)\n\t * @property {number} weekNum - the number of a weekday within a month (e.g. 4th Friday)\n\t */\n\n\t/**\n\t * Calculates constants related to the start date of an event\n\t * @param {Date} start - the start date of an event\n\t * @returns {DateInfo}\n\t */\n\tGetFromStartDate(start) {\n\t\tconst res = {\n\t\t\tweekday: start.getDay(),\n\t\t\tday: start.getDate(),\n\t\t\tmonth: start.getMonth(),\n\t\t\tyearday: getYearDay(start),\n\t\t};\n\t\tres.weekNum = Math.floor(res.day / 7) + (res.day % 7 ? 1 : 0);\n\t\treturn res;\n\t}\n\n\t/**\n\t * Sets controls and their values for recurring patterns\n\t * @param {Object} obj - the event data\n\t */\n\tSetRecurring(obj) {\n\t\tconst today = this.GetFromStartDate(obj.start_date);\n\t\tconst roptions = this.ResetRecurringOptions(today);\n\t\tthis.RecurringOptions.getList().parse(roptions);\n\n\t\tthis.SubForm.SetValues(webix.copy(obj), today, true);\n\n\t\tif (!obj.$recurring) {\n\t\t\tobj.rec_option = \"none\";\n\t\t} else if (obj.$recurring.BYDAY === \"MO,TU,WE,TH,FR\") {\n\t\t\tobj.rec_option = \"work\";\n\t\t} else if (\n\t\t\t!obj.$recurring.UNTIL &&\n\t\t\t!obj.$recurring.COUNT &&\n\t\t\t(!obj.$recurring.INTERVAL || obj.$recurring.INTERVAL == 1) &&\n\t\t\t(obj.$recurring.FREQ === \"DAILY\" ||\n\t\t\t\t(obj.$recurring.FREQ === \"WEEKLY\" &&\n\t\t\t\t\tobj.$recurring.BYDAY == WEEKDAYS[today.weekday]) ||\n\t\t\t\t(obj.$recurring.FREQ === \"MONTHLY\" &&\n\t\t\t\t\tobj.$recurring.BYSETPOS &&\n\t\t\t\t\tobj.$recurring.BYSETPOS == today.weekNum &&\n\t\t\t\t\tobj.$recurring.BYDAY == WEEKDAYS[today.weekday]) ||\n\t\t\t\t(obj.$recurring.FREQ === \"YEARLY\" &&\n\t\t\t\t\tobj.$recurring.BYMONTH == today.month + 1 &&\n\t\t\t\t\tobj.$recurring.BYMONTHDAY == today.day))\n\t\t) {\n\t\t\tobj.rec_option = obj.$recurring.FREQ.toLowerCase();\n\t\t} else {\n\t\t\tobj.rec_option = \"custom\";\n\t\t}\n\t}\n\n\t/**\n\t * Returns date-dependent options for recurring pattern select list\n\t * @param {Date} start - the start date of an event\n\t */\n\tResetRecurringOptions(start) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: \"weekly\",\n\t\t\t\tvalue: `${_(\"weekly, every\")} ${\n\t\t\t\t\twebix.i18n.calendar.dayFull[start.weekday]\n\t\t\t\t}`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"monthly\",\n\t\t\t\tvalue: `${_(\"monthly, every\")} ${start.weekNum} ${_(\"week on\")} ${\n\t\t\t\t\twebix.i18n.calendar.dayFull[start.weekday]\n\t\t\t\t}`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"yearly\",\n\t\t\t\tvalue: `${_(\"yearly, every\")} ${\n\t\t\t\t\twebix.i18n.calendar.monthFull[start.month]\n\t\t\t\t} ${start.day}`,\n\t\t\t},\n\t\t];\n\t}\n\n\t/**\n\t * Joins date and time into one Date object\n\t * @param {Date} date - a date without a time part\n\t * @param {Date} time - a date with a time part\n\t */\n\tJoin(date, time) {\n\t\treturn webix.Date.add(date, webix.Date.timePart(time) / 60, \"minute\", true);\n\t}\n\n\t/**\n\t * Returns an object with values for adding a new event\n\t * @param {Object} params - current state.selected property\n\t */\n\tNewEvent(params) {\n\t\tconst start = this.GetStartDate();\n\t\tconst end =\n\t\t\tthis.State.selected.end_date || webix.Date.add(start, 1, \"hour\", true);\n\n\t\tconst obj = {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\ttext: \"\",\n\t\t\tdetails: \"\",\n\t\t};\n\t\tif (this.app.config.recurring) obj.recurring = \"\";\n\t\tif (this.app.config.timeline) {\n\t\t\tobj.section = params.section || this.Sections.getFirstId();\n\t\t}\n\n\t\tif (this.app.config.calendars) {\n\t\t\tlet active = this.State.active[0];\n\t\t\tif (!active) {\n\t\t\t\tconst first = this.Calendars.getFirstId();\n\t\t\t\tconst wait = first\n\t\t\t\t\t? this.Ops.updateCalendar(first, { active: 1 })\n\t\t\t\t\t: this.Ops.addCalendar();\n\n\t\t\t\treturn wait.then(() => {\n\t\t\t\t\tobj.calendar = this.State.active[0];\n\t\t\t\t\tobj.$color = this.Calendars.getItem(obj.calendar).color;\n\t\t\t\t\treturn obj;\n\t\t\t\t});\n\t\t\t}\n\t\t\tobj.calendar = active;\n\t\t\tobj.$color = this.Calendars.getItem(obj.calendar).color;\n\t\t} else obj.$color = \"#01C2A5\"; //same for default color in datacollection\n\n\t\tif (this.app.config.calendars && params.unit) {\n\t\t\tobj.units = params.unit;\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Returns a start date of a new object based on:\n\t * 1) the origin of the double click of the user\n\t * 2) the current date and time\n\t */\n\tGetStartDate() {\n\t\tif (this.Date) {\n\t\t\treturn webix.Date.copy(this.Date);\n\t\t} else {\n\t\t\tconst date = new Date();\n\t\t\tconst minutes = Math.ceil(date.getMinutes() / 30) * 30;\n\t\t\tconst res = webix.Date.copy(this.State.date);\n\t\t\tres.setHours(date.getHours(), minutes);\n\t\t\treturn res;\n\t\t}\n\t}\n\n\t/**\n\t * Launches saving of changes made in the form\n\t * @param {Object} change - an object with changed values\n\t */\n\tUpdateEvent(change) {\n\t\t// clear 'dirty' flag so that next change will definitely be 'dirty'\n\t\tthis.Form.setDirty();\n\n\t\tif (this.Id === \"0\") {\n\t\t\tconst data = this.PrepareOut(change);\n\t\t\tthis._inProgress = this.Ops.addEvent(data, true, this.Id);\n\t\t} else if (Object.keys(change).length) {\n\t\t\tthis._inProgress = this.UpdateExisting(this.Id, change);\n\t\t}\n\n\t\tif (this._inProgress) {\n\t\t\tthis.app.callEvent(\"backend:operation\", [this._inProgress]);\n\t\t\tthis._inProgress\n\t\t\t\t.then(id => {\n\t\t\t\t\tif (id) this.UpdateSelection(id);\n\n\t\t\t\t\t// make event visible if new dates are outside currently selected dates\n\t\t\t\t\tthis.ChangeDate(change, this.Form.getValues());\n\n\t\t\t\t\t// continue editing in simple mode\n\t\t\t\t\tthis.setParam(\"mode\", \"\", true);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis._inProgress = null;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this._inProgress || webix.promise.resolve();\n\t}\n\n\t/**\n\t * Updates an existing event\n\t * @param {(string|number)} sid - the ID of the event\n\t * @param {Object} change - the new data\n\t * @returns {Promise}\n\t */\n\tUpdateExisting(sid, change) {\n\t\tlet mode = this.getParam(\"mode\", true);\n\t\tconst obj = this.Local.getItem(sid);\n\n\t\tif ((mode === \"this\" && !this.HasOneOccurrence(obj)) || mode === \"next\") {\n\t\t\t// cut out occurrence or split event sequence and save as separate events\n\t\t\tchange.origin_id = obj.origin_id || obj.id;\n\t\t\tconst newEvent = this.PrepareOut(change);\n\n\t\t\tlet recurring = \"\";\n\t\t\tif (mode === \"this\") {\n\t\t\t\trecurring = cutOccurrence(this.State.selected.date, obj);\n\t\t\t} else {\n\t\t\t\tlet params;\n\t\t\t\tif (obj.recurring) {\n\t\t\t\t\tparams = [this.State.selected.date, obj];\n\t\t\t\t} else {\n\t\t\t\t\tsid = obj.origin_id;\n\t\t\t\t\tparams = [newEvent.start_date, this.Local.getItem(sid)];\n\t\t\t\t}\n\t\t\t\trecurring = clipSequence(...params);\n\t\t\t}\n\n\t\t\treturn this.Ops.updateEvent(\n\t\t\t\tsid,\n\t\t\t\t{ recurring },\n\t\t\t\tmode,\n\t\t\t\twebix.Date.dayStart(newEvent.start_date),\n\t\t\t\ttrue\n\t\t\t).then(() => {\n\t\t\t\tif (change.rec_option === \"none\") this.State.selected.date = null;\n\t\t\t\treturn this.Ops.addEvent(newEvent, true);\n\t\t\t});\n\t\t} else {\n\t\t\t// non-recurring and recurring in mode \"all\"\n\n\t\t\tif (mode === \"all\") {\n\t\t\t\tconst recVals = this.Form.getValues().$recurring;\n\t\t\t\tif (recVals && webix.isUndefined(change.recurring)) {\n\t\t\t\t\tdelete recVals.EXDATE;\n\t\t\t\t\tchange.recurring = serialize(recVals); // plus all that's been updated in form silently in FillForm\n\n\t\t\t\t\tthis.Form.setValues(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$recurring: recVals,\n\t\t\t\t\t\t\trecurring: change.recurring,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t\tthis.SubForm.SetValues({ EXDATE: null });\n\t\t\t\t}\n\n\t\t\t\tif (obj.origin_id) this.Id = this.State.selected.id = obj.origin_id;\n\t\t\t}\n\n\t\t\treturn this.Ops.updateEvent(this.Id, change, mode, undefined, true).then(\n\t\t\t\t() => {\n\t\t\t\t\tif (change.rec_option === \"none\") this.State.selected.date = null;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * if event was saved as new, update selected silently to avoid triggering listeners\n\t * @param {(string|number)} id - the ID of the event\n\t */\n\tUpdateSelection(id) {\n\t\tthis.State.selected.id = this.Id = id;\n\t\tconst sdate = this.State.selected.date;\n\t\tif (sdate instanceof Date) {\n\t\t\tthis.State.selected.date = null;\n\t\t} else if (sdate) {\n\t\t\tconst fvals = this.Form.getValues();\n\t\t\tthis.State.selected.date =\n\t\t\t\tthis.Join(fvals.start_date, fvals.start_time).valueOf() + \"_\" + id;\n\t\t}\n\t}\n\n\t/**\n\t * Processes changes made in the form and prepares values for saving to the server\n\t * @param {Object} change - an object with changed values\n\t */\n\tPrepareChange(change) {\n\t\tif (change.rec_option) this.ProcessRecurringOption(change);\n\t\telse if (!webix.isUndefined(change.$recurring)) {\n\t\t\tthis.ProcessRecurringPattern(change);\n\t\t}\n\n\t\tthis.ProcessDates(change);\n\n\t\tif (this.app.config.recurring && change.start_date)\n\t\t\tthis.ApplyDatechangeToRecurring(change);\n\n\t\tthis.ProcessText(change, \"text\");\n\t\tthis.ProcessText(change, \"details\");\n\n\t\tthis._changedValues = change;\n\t}\n\n\t/**\n\t * Gets recurring pattern according to the new recurring option\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessRecurringOption(change) {\n\t\tconst fvals = this.Form.getValues();\n\n\t\tif (change.rec_option === \"none\") {\n\t\t\tchange.recurring = \"\";\n\t\t\tchange.series_end_date = \"\";\n\t\t} else if (change.rec_option === \"custom\") {\n\t\t\tif (fvals.$recurring) {\n\t\t\t\tthis.SubForm.SetValues(\n\t\t\t\t\t{ ...fvals, ...change },\n\t\t\t\t\tthis.GetFromStartDate(fvals.start_date)\n\t\t\t\t);\n\t\t\t}\n\t\t\tchange.$recurring = this.SubForm.GetValues();\n\t\t\tthis.ProcessRecurringPattern(change);\n\n\t\t\tif (!fvals.$recurring) {\n\t\t\t\tthis.Form.setValues({ $recurring: change.$recurring }, true);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.GetRecurring(change.rec_option, change, fvals.start_date);\n\t\t\tchange.series_end_date = \"\";\n\t\t}\n\n\t\tdelete change.rec_option;\n\t\tdelete change.$recurring;\n\t}\n\n\t/**\n\t * Serializes recurring pattern object and synchronizes dates with the new pattern\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessRecurringPattern(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tconst recurring = serialize(change.$recurring);\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\n\t\t// check if switch from a preset to custom and back and the pattern is the same\n\t\tif (!old || recurring !== old.recurring) {\n\t\t\tchange.recurring = recurring;\n\t\t\tchange.series_end_date = change.$recurring.UNTIL;\n\n\t\t\tif (change.$recurring.BYDAY) {\n\t\t\t\t[change.start_date, change.end_date] = datesToWeekdays(\n\t\t\t\t\tfvals.start_date,\n\t\t\t\t\tfvals.end_date,\n\t\t\t\t\tchange.$recurring\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.Form.setValues(change, true);\n\t\t}\n\t\tdelete change.$recurring;\n\t}\n\n\t/**\n\t * Sums up dates and time depending on the changes in dates, time and all_day flag\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessDates(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tif (webix.isUndefined(change.all_day)) {\n\t\t\tif ((change.start_date || change.start_time) && fvals.all_day == 0) {\n\t\t\t\tchange.start_date = this.Join(fvals.start_date, fvals.start_time);\n\t\t\t}\n\t\t\tif ((change.end_date || change.end_time) && fvals.all_day == 0) {\n\t\t\t\tchange.end_date = this.Join(fvals.end_date, fvals.end_time);\n\t\t\t}\n\t\t} else if (change.all_day == 1) {\n\t\t\tchange.start_date = fvals.start_date;\n\t\t\tchange.end_date = fvals.end_date;\n\t\t} else if (change.all_day == 0) {\n\t\t\tchange.start_date = this.Join(fvals.start_date, fvals.start_time);\n\t\t\tchange.end_date = this.Join(fvals.end_date, fvals.end_time);\n\t\t}\n\n\t\tif (change.start_date || change.end_date) this.CorrectDateTime(change);\n\t}\n\n\t/**\n\t * Corrects the unchanged field if start > end or end < start\n\t * @param {Object} change - an object with changed values\n\t */\n\tCorrectDateTime(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\t\tconst ev_length = (old.end_date - old.start_date) / 1000 / 60; // minutes\n\n\t\tconst type = change.start_date ? \"start\" : \"end\";\n\t\tconst opposite = type === \"start\" ? \"end\" : \"start\";\n\n\t\tconst start = change.start_date || old.start_date;\n\t\tconst end = change.end_date || old.end_date;\n\n\t\tif ((start >= end && !fvals.all_day) || start > end) {\n\t\t\tchange[opposite + \"_date\"] = webix.Date.add(\n\t\t\t\tchange[type + \"_date\"],\n\t\t\t\t(type === \"start\" ? 1 : -1) * (ev_length || 60),\n\t\t\t\t\"minute\",\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\t// apply also to form\n\t\t\tthis.Form.setValues(\n\t\t\t\t{\n\t\t\t\t\tstart_date: webix.Date.datePart(change.start_date, true),\n\t\t\t\t\tend_date: webix.Date.datePart(change.end_date, true),\n\t\t\t\t\tstart_time: change.start_time || webix.Date.copy(change.start_date),\n\t\t\t\t\tend_time: change.end_time || webix.Date.copy(change.end_date),\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tdelete change.start_time;\n\t\tdelete change.end_time;\n\t}\n\n\t/**\n\t * Removes trailing spaces from input text\n\t * @param {Object} change - an object with changed values\n\t * @param {string} field - the name of a text field ('text', 'details')\n\t */\n\tProcessText(change, field) {\n\t\tif (!this.webix.isUndefined(change[field])) {\n\t\t\tchange[field] = change[field].replace(/(<[^>]+>|^\\s+|\\s+$)/gi, \"\");\n\t\t\tconst prev = this.Local.getItem(this.State.selected.id)[field] || \"\";\n\t\t\tif (change[field] === prev.trim()) delete change[field];\n\t\t}\n\t}\n\n\t/**\n\t * Synchronizes recurring pattern with new start date\n\t * @param {Object} change - an object with changed values\n\t */\n\tApplyDatechangeToRecurring(change) {\n\t\tconst today = this.GetFromStartDate(change.start_date);\n\t\t// if date was changed after subform change, ignore\n\t\tconst fvals = this.Form.getValues();\n\t\tif (!change.recurring && fvals.$recurring) {\n\t\t\tif (fvals.rec_option === \"custom\") {\n\t\t\t\tconst recurring = fvals.$recurring;\n\n\t\t\t\tif (recurring.BYYEARDAY) {\n\t\t\t\t\trecurring.BYYEARDAY = today.yearday;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYMONTH) {\n\t\t\t\t\trecurring.BYMONTH = today.month + 1;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYMONTHDAY) {\n\t\t\t\t\trecurring.BYMONTHDAY = today.day;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYSETPOS) {\n\t\t\t\t\trecurring.BYSETPOS = today.weekNum;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYDAY) {\n\t\t\t\t\trecurring.BYDAY = WeekdaysToDates(\n\t\t\t\t\t\tchange.start_date,\n\t\t\t\t\t\tfvals.$recurring\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (recurring.UNTIL && recurring.UNTIL < change.start_date) {\n\t\t\t\t\tconst oldStart = this.Local.getItem(this.State.selected.id)\n\t\t\t\t\t\t.start_date;\n\t\t\t\t\tconst length = (fvals.$recurring.UNTIL - oldStart) / 1000 / 60; // minutes\n\t\t\t\t\trecurring.UNTIL = webix.Date.add(\n\t\t\t\t\t\tchange.start_date,\n\t\t\t\t\t\tlength,\n\t\t\t\t\t\t\"minute\",\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tchange.recurring = serialize(recurring);\n\n\t\t\t\tthis.SubForm.SetValues({ ...fvals, ...change }, today);\n\t\t\t} else {\n\t\t\t\tthis.GetRecurring(fvals.rec_option, change, fvals.start_date);\n\t\t\t\tdelete change.$recurring;\n\t\t\t}\n\t\t}\n\t\tthis.RecurringOptions.getList().parse(this.ResetRecurringOptions(today));\n\t\tthis.RecurringOptions.refresh();\n\t}\n\n\t/**\n\t * Assigns recurring pattern according to a preset\n\t * @param {string} r the ID of a recurring pattern option\n\t * @param {Object} change - an object with changed values\n\t * @param {Date} start - the start date of the event\n\t */\n\tGetRecurring(r, change, start) {\n\t\tlet $recurring = this.GetRecurringPreset(r, start);\n\n\t\tif (r === \"work\" && change.start_date) {\n\t\t\tconst BYDAY = WeekdaysToDates(change.start_date, $recurring);\n\t\t\tif ($recurring.BYDAY !== BYDAY) {\n\t\t\t\t$recurring.BYDAY = BYDAY;\n\t\t\t\tr = \"custom\";\n\t\t\t}\n\t\t}\n\n\t\tconst recurring = serialize($recurring);\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\n\t\t// check if switch from a preset to custom and back and the pattern is the same\n\t\tif (!old || recurring !== old.recurring) {\n\t\t\tchange.$recurring = $recurring;\n\t\t\tchange.recurring = recurring;\n\t\t\tthis.Form.setValues(\n\t\t\t\t{\n\t\t\t\t\t$recurring: change.$recurring,\n\t\t\t\t\trecurring,\n\t\t\t\t\trec_option: r,\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Gets a recurring pattern object for a pattern preset based on the start date of the event\n\t * @param {string} r - a recurring option (accepted values: \"daily\", \"weekly\", \"work\", \"monthly\", \"yearly\")\n\t * @param {Date} start - the start date of an event\n\t * @returns {Object} - $recurring\n\t */\n\tGetRecurringPreset(r, start) {\n\t\tconst today = this.GetFromStartDate(start);\n\t\tswitch (r) {\n\t\t\tcase \"daily\":\n\t\t\t\treturn { FREQ: \"DAILY\", INTERVAL: 1 };\n\t\t\tcase \"weekly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"WEEKLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYDAY: WEEKDAYS[today.weekday],\n\t\t\t\t};\n\t\t\tcase \"work\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"WEEKLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYDAY: \"MO,TU,WE,TH,FR\",\n\t\t\t\t};\n\t\t\tcase \"monthly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"MONTHLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYSETPOS: today.weekNum,\n\t\t\t\t\tBYDAY: WEEKDAYS[today.weekday],\n\t\t\t\t};\n\t\t\tcase \"yearly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"YEARLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYMONTH: today.month + 1,\n\t\t\t\t\tBYMONTHDAY: today.day,\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn { FREQ: \"DAILY\", INTERVAL: 1 };\n\t\t}\n\t}\n\n\t/**\n\t * Switches Scheduler to another date if the event after change is no longer visible\n\t * @param {Object} dirty - an object with changed values\n\t * @param {Object} fvals - an object with all current form values\n\t */\n\tChangeDate(dirty, fvals) {\n\t\tif (dirty) {\n\t\t\t// start date of non-repeating event changed or repeating event became non-repeating\n\t\t\tif ((dirty.start_date && !fvals.recurring) || dirty.recurring === \"\") {\n\t\t\t\tthis.State.selected.date = null;\n\t\t\t\tthis.UpdateStateDate(dirty.start_date || fvals.start_date);\n\t\t\t} else if (dirty.start_date || dirty.recurring) {\n\t\t\t\tconst date = this.GetClosestOccurrenceDate(dirty, fvals);\n\t\t\t\tthis.State.selected.date =\n\t\t\t\t\tdate.valueOf() + \"_\" + this.State.selected.id;\n\t\t\t\tthis.UpdateStateDate(date);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns the next closest occurrence date when dates or recurring pattern of an event was changed\n\t * @param {Object} dirty - an object with changed data\n\t * @param {Object} fvals - an object of all event form values\n\t * @returns {Date} the date of the next closest occurrence\n\t */\n\tGetClosestOccurrenceDate(dirty, fvals) {\n\t\tlet date = dirty.start_date\n\t\t\t? webix.Date.copy(dirty.start_date)\n\t\t\t: this.Join(fvals.start_date, fvals.start_time);\n\t\tlet end = webix.Date.dayStart(\n\t\t\tthis.State.selected.date\n\t\t\t\t? new Date(this.State.selected.date.split(\"_\")[0] * 1)\n\t\t\t\t: date\n\t\t);\n\t\tif (fvals.series_end_date) {\n\t\t\tend = new Date(\n\t\t\t\tMath.min(webix.Date.add(fvals.series_end_date, -1, \"day\", true), end)\n\t\t\t);\n\t\t}\n\n\t\tconst consts = {};\n\t\tfillWdays(fvals.$recurring, consts);\n\t\tlet temp = webix.Date.copy(date);\n\t\twhile (webix.Date.dayStart(temp) < end) {\n\t\t\ttemp = next(temp, fvals.$recurring, consts);\n\t\t\tif (Math.abs(end - temp) < Math.abs(end - date)) {\n\t\t\t\tdate = webix.Date.copy(temp);\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t}\n\n\t/**\n\t * Updates state.date according to state.mode\n\t * @param {Date} date - new state.date\n\t */\n\tUpdateStateDate(date) {\n\t\tdate = webix.Date.dayStart(date);\n\t\tconst state = this.State;\n\t\tif (\n\t\t\tstate.mode === \"day\" ||\n\t\t\tstate.mode === \"units\" ||\n\t\t\t(state.mode === \"timeline\" && state.timelineMode === \"day\")\n\t\t) {\n\t\t\tconst sdate = webix.Date.dayStart(state.date);\n\t\t\tif (!webix.Date.equal(date, sdate)) {\n\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t}\n\t\t} else {\n\t\t\tconst { start, end } = this.GetModeBounds();\n\t\t\tif (date < start || date >= end) {\n\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns start and end dates of a currently displayed period\n\t */\n\tGetModeBounds() {\n\t\tconst state = this.State;\n\t\tlet mode = state.mode;\n\t\tif (mode === \"timeline\") mode = state.timelineMode;\n\t\telse if (mode === \"agenda\") mode = \"month\";\n\t\tlet start = webix.Date[mode + \"Start\"](state.date);\n\t\tlet end = webix.Date.add(start, 1, mode, true);\n\n\t\tif (state.mode === \"month\") {\n\t\t\tstart = webix.Date.weekStart(start);\n\t\t\tconst weeks = Math.ceil((end - start) / (24 * 60 * 60 * 1000) / 7);\n\t\t\tend = webix.Date.add(start, weeks, \"week\", true);\n\t\t}\n\n\t\treturn { start, end };\n\t}\n\n\t/**\n\t * Unites changed and unchanged fields into 1 object for saving newly added events\n\t * @param {Object} change - an object with changed values\n\t */\n\tPrepareOut(change) {\n\t\tlet obj = this.Form.getValues();\n\n\t\tif (!obj.all_day) {\n\t\t\tobj.start_date = this.Join(obj.start_date, obj.start_time);\n\t\t\tobj.end_date = this.Join(obj.end_date, obj.end_time);\n\t\t}\n\n\t\tobj = webix.extend(obj, change || {}, true);\n\n\t\tif (!(change && change.recurring) && obj.$recurring) {\n\t\t\tobj.$recurring.EXDATE = [];\n\t\t\tobj.recurring = serialize(obj.$recurring);\n\t\t}\n\n\t\tif (!obj.origin_id) obj.origin_id = 0;\n\n\t\t// go backend wants a number\n\t\tif (this.app.config.timeline && !obj.section) obj.section = 0;\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Removes a temporary local event\n\t */\n\tClearTempEvent() {\n\t\tconst sid = this.Id;\n\t\tif (sid === \"0\" && this.Local.exists(sid)) {\n\t\t\tthis.Local.remove(sid);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form and either the whole right panel with it or returns to Info\n\t * @param {boolean} close - if true, the right panel is closed\n\t */\n\tBack(close) {\n\t\tthis.Form.clear();\n\n\t\tif (close || this.State.selected.id === \"0\") {\n\t\t\tthis.State.selected = null;\n\t\t} else {\n\t\t\tconst path = this.Compact ? \"event.formpopup/\" : \"../\";\n\t\t\tthis.show(path + \"event.info\", { target: \"edit\" });\n\t\t}\n\t}\n\n\t/**\n\t * Closes the right panel\n\t */\n\tClose() {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(() => {\n\t\t\t\tthis.Back(true);\n\t\t\t});\n\t\t} else {\n\t\t\tconst dirty =\n\t\t\t\tthis.Form.isDirty() || (this.Subform && this.SubForm.IsDirty());\n\t\t\tif (this.Compact && dirty) {\n\t\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\ttext: _(\"Save changes?\"),\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.Done(true))\n\t\t\t\t\t.catch(() => this.Back(true));\n\t\t\t} else this.Back(true);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form\n\t * @param {boolean} close\n\t */\n\tDone(close) {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(() => {\n\t\t\t\tthis.Back();\n\t\t\t});\n\t\t} else if (this.State.selected.id === \"0\" || this.Compact) {\n\t\t\tlet change = {};\n\t\t\tif (this.Compact) {\n\t\t\t\tif (this._changedValues) change = this._changedValues;\n\n\t\t\t\tif (this.SubForm.IsDirty()) {\n\t\t\t\t\tchange.$recurring = this.SubForm.GetValues();\n\t\t\t\t\tchange.series_end_date = change.$recurring.UNTIL;\n\t\t\t\t\tdelete change.rec_option;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.UpdateEvent(change).then(() => this.Back(close));\n\t\t} else {\n\t\t\tthis.Back();\n\t\t}\n\t}\n\n\t/**\n\t * Waits until some asynchronous operation finishes (if there's any) and then executes 'handler'\n\t * @param {function} handler - the code that will be executed\n\t */\n\tWait(handler) {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(handler);\n\t\t} else {\n\t\t\thandler.call();\n\t\t}\n\t}\n\n\t// compact\n\n\t/**\n\t * Shows a subform with controls for editing recurring pattern in a window\n\t */\n\tShowSubForm() {\n\t\tthis.SubForm.Show();\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst subform = this.SubForm.getRoot();\n\n\t\tconst aSkin = webix.skin.$active;\n\t\twebix.fullscreen.set(subform, {\n\t\t\thead: {\n\t\t\t\tview: \"toolbar\",\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\t\tright: 14,\n\t\t\t\t},\n\t\t\t\telements: [\n\t\t\t\t\t{ view: \"icon\", icon: \"shi-back\", click: () => this.HideSubPop() },\n\t\t\t\t\t{ view: \"label\", label: _(\"Change recurring pattern\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\t\twidth: 130,\n\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\tclick: () => this.HideSubPop(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tconst win = subform.getTopParentView();\n\t\twin.define({ css: \"webix_scheduler_subform_popup\" });\n\t}\n\n\t/**\n\t * Hides the window with the subform\n\t */\n\tHideSubPop() {\n\t\tthis.SubForm.Hide();\n\t\twebix.fullscreen.exit();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class FormPopup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { cutOccurrence } from \"helpers/recurring\";\nimport hotkey from \"jet-hotkey\";\n\n/**\n * Common function used to prepare data of a copied event\n * @param {Object} newEvent\n */\nexport function cleanEventData(newEvent) {\n\t// in recurring event, copy only this event and make sure it stays a part of the series\n\tconst isRecurring = newEvent.recurring || newEvent.$id || newEvent.origin_id;\n\tif (isRecurring) {\n\t\tnewEvent.recurring = \"\";\n\t\tdelete newEvent.$recurring;\n\t\tif (!newEvent.origin_id) newEvent.origin_id = newEvent.$id || newEvent.id;\n\n\t\tdelete newEvent.$id;\n\t}\n\n\tdelete newEvent.id;\n\n\tconst _ = this.app.getService(\"locale\")._;\n\tif (newEvent.text)\n\t\tnewEvent.text = `${_(\"Copy of\")} ${newEvent.text.replace(\n\t\t\t`${_(\"Copy of\")} `,\n\t\t\t\"\"\n\t\t)}`;\n}\n\n/** CopyPaste Mixin adds logic for copying and cutting events with hotkeys */\n\n/**\n * Handles events related to copying, cutting and pasting events (desktop devices)\n * @param {Object} view - a Webix data widget that is used to display events\n */\nfunction HandleCopyPaste(view) {\n\tthis.clipboardModes = [\"copy\", \"cut\"];\n\tthis.Ops = this.app.getService(\"operations\");\n\tconst ctrlKey = webix.env.isMac ? \"COMMAND\" : \"CTRL\";\n\t// when form is opened, hotkeys do not work because focus is on form, not on view\n\tthis.on(hotkey(view), `${ctrlKey}+C`, v => this.AddToClipboard(v, \"copy\"));\n\tthis.on(hotkey(view), `${ctrlKey}+X`, v => this.AddToClipboard(v, \"cut\"));\n\tthis.on(hotkey(view), `${ctrlKey}+V`, (v, e) => this.PasteFromClipboard(e));\n\tthis.on(hotkey(view), \"Esc\", (v, e) => this.PurgeClipboard(v, e));\n\n\tthis.on(this.State.$changes, \"mode\", () => {\n\t\twebix.UIManager.setFocus(view);\n\t});\n\n\tthis.on(this.State.$changes, \"clipboard\", (v, o) => {\n\t\tif (v) {\n\t\t\twebix.html.addCss(view.$view, \"webix_scheduler_clipboard_target\");\n\t\t} else if (o) {\n\t\t\twebix.html.removeCss(view.$view, \"webix_scheduler_clipboard_target\");\n\t\t}\n\t});\n\n\tthis.on(this.app, \"events:rendered\", () => {\n\t\tthis.RestoreClipboardSource(view);\n\t});\n\n\tif (this.$multi) {\n\t\tthis._globalClickHandler = webix.event(this.List.$view, \"click\", () => {\n\t\t\tif (this.State.clipboard && this.State.clipboard.source) {\n\t\t\t\tthis.ChangePasteTarget(this.List.$view);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tthis.on(view, \"onItemClick\", (id, e, node) => {\n\t\t\tif (this.State.clipboard && this.State.clipboard.source) {\n\t\t\t\tif (this.State.mode === \"timeline\") {\n\t\t\t\t\tnode = this.CreatePasteTarget(view, e);\n\t\t\t\t}\n\t\t\t\tthis.ChangePasteTarget(node);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * Cleans up click handler when the view is destroyed\n */\nfunction OnDestroy() {\n\tif (this._globalClickHandler) {\n\t\twebix.eventRemove(this._globalClickHandler);\n\t\tthis._globalClickHandler = null;\n\t}\n}\n\n/**\n * Creates an HTML element that represents a paste target for widgets that do not have suitable elements (timeline mode)\n * @param {Object} view - a Webix data widget that is used to display events\n * @param {MouseEvent} e\n * @returns {HTMLElement}\n */\nfunction CreatePasteTarget(view, e) {\n\tconst scroll = view.getScrollState();\n\tconst x = e.clientX - view.$view.offsetLeft + scroll.x;\n\tconst y = e.clientY - view.$view.offsetTop + scroll.y;\n\tthis.mousePosUnit = Math.floor(x / this.Scales.cellWidth);\n\n\tconst target = webix.html.create(\"div\");\n\tconst sheight = this.GetSectionHeight();\n\ttarget.style.top = `${y - (y % sheight)}px`;\n\ttarget.style.left = `${x - (x % this.Scales.cellWidth)}px`;\n\ttarget.style.width = `${this.Scales.cellWidth}px`;\n\ttarget.style.height = `${sheight}px`;\n\ttarget.style.position = \"absolute\";\n\n\t// view.$view.firstChild.prepend(target); // when IE dies, replace with this line\n\tconst parent = view.$view.firstChild;\n\tparent.insertBefore(target, parent.childNodes[0]);\n\n\treturn target;\n}\n\n/**\n * Sets styling for a paste target and sets it to state.clipboard\n * @param {HTMLElement} node\n */\nfunction SetPasteTargetStyle(node) {\n\twebix.html.addCss(node, \"webix_scheduler_paste_target\");\n\tthis.State.clipboard.target = node;\n}\n\n/**\n * Removes styling from a paste target, cleans up its reference from state and removes it from the DOM if it was created specifically (timeline mode)\n */\nfunction ClearPasteTargetStyle() {\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.target) {\n\t\twebix.html.removeCss(\n\t\t\tthis.State.clipboard.target,\n\t\t\t\"webix_scheduler_paste_target\"\n\t\t);\n\t\tif (this.State.mode === \"timeline\" && clipboard.target.parentNode) {\n\t\t\t// this.State.clipboard.target.remove(); // when IE dies, replace with this line\n\t\t\tconst target = clipboard.target;\n\t\t\ttarget.parentNode.removeChild(target);\n\t\t}\n\t\tthis.State.clipboard.target = null;\n\t}\n}\n\n/**\n * Makes another element the target for pasting\n * @param {HTMLElement} node\n */\nfunction ChangePasteTarget(node) {\n\tif (this.State.clipboard.target !== node) {\n\t\tthis.ClearPasteTargetStyle();\n\t\tthis.SetPasteTargetStyle(node);\n\t}\n}\n\n/**\n * Locates event node by event ID (checks the given one and locates it anew if the parent was re-rendered)\n * @param {HTMLElement} view - parent html element (top html element of a widget)\n * @param {HTMLElement} node - given html element of the event\n * @param {string} id - the ID of the event\n * @returns {HTMLElement}\n */\nfunction locateEvent(view, node, id) {\n\tif (node && view.contains(node)) return node;\n\treturn (\n\t\tview.querySelectorAll(`[webix_e_id=\"${id}\"]`)[0] ||\n\t\tview.querySelectorAll(`[webix_l_id=\"${id}\"]`)[0]\n\t);\n}\n\n/**\n * Adds the selected event to clipboard, sets mode, styles the node of the copied/cut event\n * @param {string} mode - \"copy\" or \"cut\"\n */\nfunction AddToClipboard(view, mode) {\n\tconst sel = this.State.selected;\n\tif (sel && sel.id !== \"0\") {\n\t\tthis.ClearPasteTargetStyle();\n\n\t\tconst source = locateEvent(view.$view, sel.node, sel.date || sel.id);\n\t\tif (source) this.SetClipboardSourceStyle(mode, source);\n\n\t\tconst event = this.GetEvent(sel.date || sel.id);\n\t\tthis.State.clipboard = {\n\t\t\tmode,\n\t\t\tselected: webix.copy(event),\n\t\t\tsource,\n\t\t};\n\t}\n}\n\n/**\n * Adds relevant styling to the node of the copied or cut event\n * @param {string} mode - \"copy\" or \"cut\"\n * @param {HTMLElement} node\n */\nfunction SetClipboardSourceStyle(mode, node) {\n\tconst css = `webix_scheduler_${mode}`;\n\tif (node.className.indexOf(css) === -1) webix.html.addCss(node, css);\n\tconst opMode = this.clipboardModes[this.clipboardModes.indexOf(mode) ^ 1];\n\tconst prevCss = `webix_scheduler_${opMode}`;\n\twebix.html.removeCss(node, prevCss);\n\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.source && node != clipboard.source) {\n\t\twebix.html.removeCss(this.State.clipboard.source, css);\n\t\twebix.html.removeCss(this.State.clipboard.source, prevCss);\n\t}\n}\n\n/**\n * Locates the copied or cut event and highlights it\n * @param {Object} view - the widget that displays events\n */\nfunction RestoreClipboardSource(view) {\n\tconst clip = this.State.clipboard;\n\tif (clip) {\n\t\tconst source = locateEvent(view.$view, clip.source, clip.selected.id);\n\t\tif (source) {\n\t\t\tif (source !== clip.source) {\n\t\t\t\tthis.State.clipboard.source = source;\n\t\t\t}\n\t\t\tthis.SetClipboardSourceStyle(clip.mode, source);\n\t\t}\n\t}\n}\n\n/**\n * Pastes the event from clipboard to the target\n * @param {KeyboardEvent} e\n */\nfunction PasteFromClipboard(e) {\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.source) {\n\t\tconst newEvent = this.GetEventData(clipboard, e);\n\n\t\tif (clipboard.mode === \"copy\") {\n\t\t\tthis.CopyEvent(newEvent);\n\t\t} else if (clipboard.mode === \"cut\") {\n\t\t\tthis.MoveEvent(newEvent);\n\t\t}\n\n\t\tthis.PurgeClipboard();\n\t}\n}\n\n/**\n * Collects new event data for the pasted event based on the chosen target\n * @param {Object} clipboard - clipboard property from the global app state\n * @param {KeyboardEvent} e\n * @returns {Object}\n */\nfunction GetEventData(clipboard, e) {\n\tconst newEvent = clipboard.selected;\n\n\tconst evLength =\n\t\tMath.floor(newEvent.end_date - newEvent.start_date) / (60 * 1000); // minutes\n\tnewEvent.start_date = this.GetTargetDate(e.target.getAttribute(\"webix_l_id\"));\n\tnewEvent.end_date = webix.Date.add(\n\t\tnewEvent.start_date,\n\t\tevLength,\n\t\t\"minute\",\n\t\ttrue\n\t);\n\n\tif (this.State.mode === \"units\") {\n\t\tnewEvent.units = this.Unit.id;\n\t} else if (this.State.mode === \"timeline\") {\n\t\tconst sec = e.target.getAttribute(\"webix_l_id\");\n\t\tif (sec) newEvent.section = sec;\n\t}\n\n\treturn newEvent;\n}\n\n/**\n * Saves the copy of the event\n * @param {Object} newEvent\n */\nfunction CopyEvent(newEvent) {\n\tcleanEventData.call(this, newEvent);\n\tthis.Ops.addEvent(newEvent, true).then(id =>\n\t\tthis.UpdateSelection(id, newEvent)\n\t);\n}\n\n/**\n * Saves the event to a new target\n * @param {Object} newEvent\n */\nfunction MoveEvent(newEvent) {\n\t// cut operation is either update - for normal events\n\t// or edit as 'this' - for recurring events\n\tif (newEvent.recurring) {\n\t\tconst recurring = cutOccurrence(newEvent.id, newEvent);\n\t\tconst updateId = newEvent.$id;\n\t\tcleanEventData.call(this, newEvent);\n\n\t\t// [todo] create 1 Op for updating as this because calling 2 methods (update, add) for this wasn't the best idea\n\t\tthis.Ops.updateEvent(\n\t\t\tupdateId,\n\t\t\t{ recurring },\n\t\t\t\"this\",\n\t\t\tnewEvent.start_date,\n\t\t\ttrue\n\t\t).then(() =>\n\t\t\tthis.Ops.addEvent(newEvent, true).then(id =>\n\t\t\t\tthis.UpdateSelection(id, newEvent)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tconst update = {\n\t\t\tstart_date: newEvent.start_date,\n\t\t\tend_date: newEvent.end_date,\n\t\t};\n\t\tif (newEvent.units) update.units = newEvent.units;\n\t\tif (newEvent.section) update.section = newEvent.section;\n\t\tthis.Ops.updateEvent(newEvent.id, update, null, null, true).then(() => {\n\t\t\tthis.UpdateSelection(newEvent.id, newEvent);\n\t\t});\n\t}\n}\n\nfunction PurgeClipboard() {\n\tconst clip = this.State.clipboard;\n\tif (clip) {\n\t\tconst { mode, source } = clip;\n\t\twebix.html.removeCss(source, `webix_scheduler_${mode}`);\n\n\t\tthis.ClearPasteTargetStyle();\n\t\tthis.State.clipboard = null;\n\n\t\treturn false;\n\t}\n}\n\n/**\n *\n * @param {Object} child - the object of a JetView instance\n * @param {Object} mainWidget - the main widget within a jet view\n * @param {Object} config - some config that is passed for this view (e.g. multi: true)\n */\nexport default function CopyPasteMixin(child, mainWidget, config) {\n\tchild.AddToClipboard = AddToClipboard;\n\tchild.SetClipboardSourceStyle = SetClipboardSourceStyle;\n\tchild.RestoreClipboardSource = RestoreClipboardSource;\n\tchild.PasteFromClipboard = PasteFromClipboard;\n\tchild.GetEventData = GetEventData;\n\tchild.CopyEvent = CopyEvent;\n\tchild.MoveEvent = MoveEvent;\n\tchild.ClearPasteTargetStyle = ClearPasteTargetStyle;\n\tchild.SetPasteTargetStyle = SetPasteTargetStyle;\n\tchild.ChangePasteTarget = ChangePasteTarget;\n\tchild.CreatePasteTarget = CreatePasteTarget;\n\tchild.PurgeClipboard = PurgeClipboard;\n\n\tif (config && config.multi) {\n\t\tchild.$multi = true;\n\t\tchild.destroy = OnDestroy;\n\t}\n\n\tHandleCopyPaste.call(child, mainWidget);\n}\n","/* eslint-disable indent */\n/* eslint-disable no-mixed-spaces-and-tabs */\nimport { JetView } from \"webix-jet\";\nimport { FREQUENCE, WEEKDAYS, separateSequence } from \"../../helpers/recurring\";\nimport { cleanEventData } from \"helpers/copypaste\";\n\nimport EventActionMenu from \"./actionmenu\";\n\nexport default class EventView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: 14,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Back(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"edit\",\n\t\t\t\t\tlabel: _(\"Edit\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\tthis.$scope.StartAction(\"Edit\", this.$view);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tif (this.app.config.copypaste) {\n\t\t\tbar.elements.splice(-1, 0, {\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"shi-content-copy\",\n\t\t\t\ttooltip: _(\"Copy event\"),\n\t\t\t\tclick: () => this.CopyEvent(),\n\t\t\t});\n\t\t}\n\n\t\tconst info = {\n\t\t\tlocalId: \"text\",\n\t\t\tview: \"template\",\n\t\t\tcss: \"webix_scheduler_info\",\n\t\t\ttemplate: obj => (obj.start_date ? this.InfoTemplate(obj) : \"\"),\n\t\t\tborderless: true,\n\t\t};\n\n\t\tconst deleteButton = {\n\t\t\tview: \"button\",\n\t\t\tlocalId: \"remove\",\n\t\t\tlabel: _(\"Delete event\"),\n\t\t\tcss: \"webix_danger webix_scheduler_danger\",\n\t\t\talign: \"center\",\n\t\t\tinputWidth: 330,\n\t\t\tclick: function() {\n\t\t\t\tthis.$scope.StartAction(\"Delete\", this.$view);\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\tbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\tpadding: { right: 14 + 2 },\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [info, deleteButton],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.UnitsLocal = this.app.getService(\"local\").units(true);\n\n\t\tthis.on(this.State.$changes, \"readonly\", v => {\n\t\t\tconst action = v ? \"hide\" : \"show\";\n\t\t\tthis.$$(\"edit\")[action]();\n\t\t\tthis.$$(\"remove\")[action]();\n\t\t});\n\n\t\tconst template = this.$$(\"text\");\n\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.EventObj = this.app\n\t\t\t\t\t.getService(\"local\")\n\t\t\t\t\t.events(true)\n\t\t\t\t\t.getItem(v.id);\n\t\t\t\ttemplate.setValues(this.EventObj);\n\t\t\t}\n\t\t});\n\n\t\tthis.Menu = this.ui(EventActionMenu);\n\n\t\tif (this.app.config.units) {\n\t\t\tconst waitUnits = this.app.getService(\"local\").units();\n\t\t\twaitUnits.then(() => {\n\t\t\t\ttemplate.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tconst local = this.app.getService(\"local\");\n\t\t\tlocal.sections().then(data => {\n\t\t\t\tthis.Sections = data;\n\t\t\t\ttemplate.refresh();\n\t\t\t});\n\t\t}\n\t}\n\n\tStartAction(mode, node) {\n\t\tif (\n\t\t\tthis.app.config.recurring &&\n\t\t\t(typeof this.State.selected.date === \"string\" || this.EventObj.origin_id)\n\t\t) {\n\t\t\tthis.Menu.Show(node).then(o => {\n\t\t\t\tif (mode === \"Delete\") this.DeleteEvent(o);\n\t\t\t\telse this.EditEvent(o);\n\t\t\t});\n\t\t} else {\n\t\t\tif (mode === \"Delete\") this.DeleteEvent();\n\t\t\telse this.EditEvent();\n\t\t}\n\t}\n\n\tEditEvent(o) {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst path = compact ? \"event.formpopup/\" : \"../\";\n\t\tthis.show(path + \"event.form\", { target: \"edit\", params: { mode: o } });\n\t}\n\n\tDeleteEvent(mode) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\ttitle: _(\"Delete event\"),\n\t\t\t\ttext: _(\"The event will be deleted permanently, are you sure?\"),\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst obj = this.EventObj;\n\t\t\t\tlet sdate = \"\";\n\t\t\t\tif (mode && mode !== \"all\") {\n\t\t\t\t\tif (this.State.selected) sdate = this.State.selected.date;\n\t\t\t\t\telse if (obj.$id) sdate = obj.id;\n\t\t\t\t}\n\t\t\t\tthis.app\n\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t.removeEvent(this.EventObj, mode, sdate);\n\t\t\t\tthis.Back(true);\n\t\t\t});\n\t}\n\n\t/** Sets selected of the global reactive state to open form for copy creation */\n\tCopyEvent() {\n\t\tconst data = webix.copy(this.EventObj);\n\t\tcleanEventData.call(this, data);\n\t\tthis.State.$batch({\n\t\t\tselected: { id: \"0\" },\n\t\t\tclipboard: { mode: \"copy\", selected: data },\n\t\t});\n\t}\n\n\t/**\n\t * Closes the info panel\n\t * @param {Boolean} removal - indicates that the panel was closed after an event was removed\n\t */\n\tBack(removal) {\n\t\tif (removal) {\n\t\t\tconst clip = this.State.clipboard;\n\t\t\tif (\n\t\t\t\tclip &&\n\t\t\t\t(clip.selected.id === this.EventObj.id ||\n\t\t\t\t\tclip.selected.id.indexOf(\"_\" + this.EventObj.id) > -1)\n\t\t\t) {\n\t\t\t\tthis.State.clipboard = null;\n\t\t\t}\n\t\t}\n\n\t\tthis.State.selected = null;\n\t}\n\n\tInfoTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (this.app.config.recurring && this.State.selected.date) {\n\t\t\tobj = { ...obj, ...separateSequence(obj, this.State.selected.date) };\n\t\t}\n\t\tconst [start, end] = [obj.start_date, obj.end_date];\n\n\t\tconst oneday = webix.Date.equal(\n\t\t\twebix.Date.datePart(start, true),\n\t\t\twebix.Date.datePart(end, true)\n\t\t);\n\n\t\tconst allday =\n\t\t\twebix.Date.equal(webix.Date.datePart(start, true), start) &&\n\t\t\twebix.Date.equal(webix.Date.datePart(end, true), end) &&\n\t\t\tobj.all_day;\n\n\t\tconst time = webix.i18n.timeFormatStr;\n\t\tconst date = webix.i18n.longDateFormatStr;\n\n\t\tconst title = `<div class=\"webix_scheduler_event_title\">${obj.text ||\n\t\t\t_(\"(No title)\")}</div>`;\n\n\t\tconst startDate = date(start);\n\t\tconst endDate = date(end);\n\t\tconst startTime = time(start);\n\t\tconst endTime = time(end);\n\n\t\tlet fromTo = \"\";\n\t\tif (oneday) {\n\t\t\tfromTo = `<div class=\"webix_scheduler_event_text\">${startDate}</div>`;\n\t\t\tif (!allday)\n\t\t\t\tfromTo += `<div class=\"webix_scheduler_event_text\">${_(\n\t\t\t\t\t\"from\"\n\t\t\t\t)} ${startTime} ${_(\"to\")} ${endTime}</div>`;\n\t\t} else {\n\t\t\tfromTo = `<div class=\"webix_scheduler_event_text\">${_(\"from\")} ${\n\t\t\t\t!allday ? startTime : \"\"\n\t\t\t} ${startDate}</div><div class=\"webix_scheduler_event_text\">${_(\"to\")} ${\n\t\t\t\t!allday ? endTime : \"\"\n\t\t\t} ${endDate}</div>`;\n\t\t}\n\n\t\tconst recurring =\n\t\t\tthis.app.config.recurring && obj.recurring\n\t\t\t\t? this.GetRecurringText(obj, _)\n\t\t\t\t: \"\";\n\n\t\tlet units = \"\";\n\t\tif (this.app.config.units) {\n\t\t\tunits += `<div class=\"webix_scheduler_event_units_title\">${_(\n\t\t\t\t\"Assigned to units\"\n\t\t\t)}:</div><div class=\"webix_scheduler_event_units\">`;\n\t\t\tif (obj.units) {\n\t\t\t\tconst unitIDs = obj.units.split(\",\");\n\t\t\t\tunitIDs.forEach((id, index) => {\n\t\t\t\t\tconst isLast = index === unitIDs.length - 1;\n\t\t\t\t\tconst unitObj = this.UnitsLocal.getItem(id);\n\t\t\t\t\tconst unitValue =\n\t\t\t\t\t\tunitObj && unitObj.value ? unitObj.value : _(\"Unknown unit\");\n\t\t\t\t\tunits += `<div class=\"webix_scheduler_event_unit_item\">${unitValue}${\n\t\t\t\t\t\tisLast ? \"\" : \",\"\n\t\t\t\t\t}</div>`;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tunits += _(\"No units\");\n\t\t\t}\n\t\t\tunits += \"</div>\";\n\t\t}\n\n\t\tconst section =\n\t\t\tthis.app.config.timeline && this.Sections ? this.GetSection(obj, _) : \"\";\n\n\t\tlet details = \"\";\n\t\tif (obj.details)\n\t\t\tdetails = `<div class=\"webix_scheduler_event_details_title\">${_(\n\t\t\t\t\"Notes\"\n\t\t\t)}</div>\n\t\t\t\t<div class=\"webix_scheduler_event_text\">${obj.details.replace(\n\t\t\t\t\t/(?:\\r\\n|\\r|\\n)/g,\n\t\t\t\t\t\"<br>\"\n\t\t\t\t)}</div>`;\n\n\t\treturn `${title}\n\t\t\t<div class='webix_scheduler_event_from_to'>${fromTo}</div>\n\t\t\t<div class='webix_scheduler_event_recurring_pattern'>${recurring}</div>${units}${section}${details}`;\n\t}\n\n\tGetRecurringText(obj, _) {\n\t\tconst mode = obj.$recurring;\n\t\tconst interval = mode.INTERVAL && mode.INTERVAL > 1 ? mode.INTERVAL : \"\";\n\n\t\tlet pattern = \"\";\n\t\tif (mode.BYDAY) {\n\t\t\tpattern = ` ${_(\"on\")} ${mode.BYSETPOS || \"\"} ${mode.BYDAY.split(\",\")\n\t\t\t\t.map(d => webix.i18n.calendar.dayFull[WEEKDAYS.indexOf(d)])\n\t\t\t\t.join(\", \")} ${\n\t\t\t\tmode.BYMONTH\n\t\t\t\t\t? `${_(\"of\")} ${webix.i18n.calendar.monthFull[mode.BYMONTH - 1]}`\n\t\t\t\t\t: \"\"\n\t\t\t}`;\n\t\t} else if (mode.BYMONTHDAY) {\n\t\t\tpattern =\n\t\t\t\t(mode.BYMONTHDAY ? ` ${_(\"on\")} ` : \"\") +\n\t\t\t\t(mode.BYMONTH\n\t\t\t\t\t? `${mode.BYSETPOS ? _(\"of\") : \"\"} ${\n\t\t\t\t\t\t\twebix.i18n.calendar.monthFull[mode.BYMONTH - 1]\n\t\t\t\t\t  }`\n\t\t\t\t\t: \"\") +\n\t\t\t\t(mode.BYMONTHDAY ? ` ${mode.BYMONTHDAY}` : \"\");\n\t\t} else if (mode.BYYEARDAY) {\n\t\t\tpattern = `${_(\"day\")} ${mode.BYYEARDAY}`;\n\t\t}\n\n\t\treturn `${_(\"Repeats each\")} ${interval} ${_(\n\t\t\tFREQUENCE[mode.FREQ] + (interval ? \"s\" : \"\")\n\t\t)} ${pattern}${\n\t\t\tmode.COUNT\n\t\t\t\t? `, ${mode.COUNT} ${_(\"times\")}`\n\t\t\t\t: mode.UNTIL\n\t\t\t\t? ` ${_(\"till\")} ${webix.i18n.longDateFormatStr(mode.UNTIL)}`\n\t\t\t\t: \"\"\n\t\t}`;\n\t}\n\n\t/**\n\t * Returns a string with HTML for the info with the section\n\t * @param {Object} obj - data of an event\n\t * @param {function} _ - the translator function of the Locale plugin\n\t * @returns {string} a string with HTML for the info with the section\n\t */\n\tGetSection(obj, _) {\n\t\tconst section = this.Sections.getItem(obj.section);\n\t\tif (section)\n\t\t\treturn `<div class=\"webix_scheduler_section_tpl\"><span class=\"webix_scheduler_section_title\">${_(\n\t\t\t\t\"Section\"\n\t\t\t)}:</span> ${section.text}</div>`;\n\t\treturn \"\";\n\t}\n}\n","let BRIGHTNESS;\nlet FONT;\nwebix.ready(() => {\n\tconst dark = webix.skin.$name === \"contrast\" || webix.skin.$name === \"dark\";\n\tBRIGHTNESS = dark ? 0.35 : 0.75;\n\tFONT = dark ? \"#9f9d9d\" : \"#ffffff\";\n});\n\n/**\n * Gets contrasting text color for the event background color\n * @param {string} color - background color\n * @returns {string} text color\n */\nexport function getContrastingColor(color) {\n\tconst rgb = webix.color.toRgb(color);\n\tconst brightness = Math.round(\n\t\t(rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000\n\t);\n\treturn brightness > 180 ? \"#475466\" : \"#ffffff\";\n}\n\nexport function getDimmedColor(color) {\n\tlet [hue, saturation] = hexToHsv(color);\n\thue *= 0.95;\n\tsaturation *= 0.4;\n\treturn `rgb(${webix.color.hsvToRgb(hue, saturation, BRIGHTNESS)})`;\n}\n\nexport function getDimmedFont() {\n\treturn FONT;\n}\n\nfunction hexToHsv(hex) {\n\tconst [red, green, blue] = webix.color.toRgb(hex);\n\treturn webix.color.rgbToHsv(red, green, blue);\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class EventActionPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst buttons = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Cancel\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Cancel(),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Apply\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\thead: _(\"Edit recurring event\"),\n\t\t\tautoheight: true,\n\t\t\tcss: \"webix_scheduler_action_popup\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\tpadding: { top: 0 },\n\t\t\t\twidth: 340,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\tlocalId: \"option\",\n\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ id: \"this\", value: _(\"This event\") },\n\t\t\t\t\t\t\t{ id: \"next\", value: _(\"This event and the following\") },\n\t\t\t\t\t\t\t{ id: \"all\", value: _(\"All events\") },\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\tbuttons,\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => (this.Result = null),\n\t\t\t},\n\t\t});\n\t}\n\n\tinit(view) {\n\t\tthis.Root = view;\n\t}\n\n\tShow(promise) {\n\t\tthis.Result = promise;\n\t\tthis.$$(\"option\").setValue(\"this\");\n\t\tthis.Root.show();\n\t}\n\n\tDone() {\n\t\tconst id = this.$$(\"option\").getValue();\n\t\tif (this.Result) this.Result.resolve(id);\n\t\tthis.Root.hide();\n\t}\n\n\tCancel() {\n\t\tif (this.Result) this.Result.reject();\n\t\tthis.Root.hide();\n\t}\n}\n","import { getDimmedColor, getDimmedFont } from \"./colors\";\n\nexport function marker(obj) {\n\tconst color = obj.color || obj.$color;\n\treturn `<div class=\"webix_event_marker\"><div class=\"webix_event_marker_inner\" style=\"background-color:${\n\t\tobj.$past ? getDimmedColor(color) : color\n\t};\"></div></div>`;\n}\n\nexport function events(_) {\n\treturn function(obj, common) {\n\t\treturn `<div class=\"webix_event_overall ${\n\t\t\tobj.$past ? \"webix_scheduler_past_event\" : \"\"\n\t\t}\"><div class=\"webix_event_time\">${common.timeStart(obj)}</div>${marker(\n\t\t\tobj,\n\t\t\tcommon\n\t\t)}<div class=\"webix_event_text\">${obj.text || _(\"(No title)\")}</div></div>`;\n\t};\n}\n\nexport function dayEventColor(obj) {\n\tconst color = obj.color || obj.$color;\n\treturn `border-color:${\n\t\tobj.$past ? getDimmedColor(obj.$color) : obj.$color\n\t}; background-color:${obj.$past ? getDimmedColor(color) : color}; color:${\n\t\tobj.$past ? getDimmedFont() : obj.$textColor\n\t};`;\n}\n\nexport function timeStart(start, end) {\n\treturn `<div class=\"start\">${webix.i18n.timeFormatStr(\n\t\tstart\n\t)}</div><div class=\"end\">${webix.i18n.timeFormatStr(end)}</div>`;\n}\n\nfunction fill(obj, common, size) {\n\tconst v = common.master;\n\treturn (\n\t\tv[\"$\" + size] -\n\t\t(v.config[size == \"width\" ? \"xCount\" : \"yCount\"] - 1) * common[size]\n\t);\n}\n\nexport function templateStart(obj, common, marks) {\n\tlet { width, height } = common;\n\tif (obj.right) width = fill(obj, common, \"width\");\n\tif (obj.bottom) height = fill(obj, common, \"height\");\n\treturn (\n\t\t\"<div \" +\n\t\t/*@attr*/ \"webix_l_id\" +\n\t\t`=\"${obj.id}\" class=\"${common.classname(obj, common, marks)}\" ${common.aria(\n\t\t\tobj,\n\t\t\tcommon,\n\t\t\tmarks\n\t\t)} style=\"width:${width}px; height:${height}px; float:left; overflow:hidden;\">`\n\t);\n}\n","import { JetView } from \"webix-jet\";\nimport { events, timeStart } from \"helpers/templates\";\nimport { isMultiDay } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\n\nexport default class UnitListView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"unitlist\",\n\t\t\tlocalId: \"list\",\n\t\t\tuniteBy: () => \"custom\",\n\t\t\ttype: {\n\t\t\t\ttemplate: events(_),\n\t\t\t\ttemplateHeader: obj => this.TemplateHeader(obj),\n\t\t\t\ttimeStart: obj => this.TimeStart(obj),\n\t\t\t\theight: 50,\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonUnits: () => this.SetUnits(),\n\t\t\t\tonItemClick: (id, node) => this.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"list\");\n\t\twebix.extend(this.List, webix.OverlayBox);\n\t}\n\n\tShowEvent(id, node) {\n\t\tconst obj = this.List.getItem(id);\n\t\tconst sel = getParams(obj);\n\t\tsel.node = node;\n\t\tthis.State.selected = sel;\n\t}\n\n\tToggleOverlay() {\n\t\tif (!this.List.count()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.List.showOverlay(_(\"No Events\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tSetUnits() {\n\t\tlet units = this.List.units;\n\t\tconst data = this.data.all;\n\n\t\t// ignore clearAll\n\t\tif (Object.keys(units).length) {\n\t\t\tthis.List.units = {};\n\t\t\tlet start = this.data.start;\n\t\t\tconst end = this.data.end;\n\n\t\t\twhile (start < end) {\n\t\t\t\tconst next = webix.Date.add(start, 1, \"day\", true);\n\n\t\t\t\tlet result = data\n\t\t\t\t\t.filter(\n\t\t\t\t\t\td =>\n\t\t\t\t\t\t\td.start_date < next &&\n\t\t\t\t\t\t\t(d.end_date > start || (d.end_date >= start && d.all_day))\n\t\t\t\t\t)\n\t\t\t\t\t.map(ev => ev.id);\n\t\t\t\tif (result.length) {\n\t\t\t\t\tthis.List.units[start.valueOf()] = result;\n\t\t\t\t}\n\n\t\t\t\tstart = webix.Date.add(start, 1, \"day\", true);\n\t\t\t}\n\t\t}\n\t}\n\n\tTimeStart(ev) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (isMultiDay(ev)) return _(\"All Day\");\n\t\telse return timeStart(ev.start_date, ev.end_date);\n\t}\n}\n","import UnitListView from \"../common/unitlist\";\nimport { shrinkTo, isToday } from \"helpers/dates\";\n\nexport default class AgendaView extends UnitListView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst ui = super.config();\n\t\tui.css = \"webix_scheduler_agenda\";\n\n\t\twebix.extend(\n\t\t\tui.type,\n\t\t\t{\n\t\t\t\theight: \"auto\",\n\t\t\t\theaderHeight: 50,\n\t\t\t\tclassname: obj => this.TemplateCss(obj),\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\twebix.extend(\n\t\t\tui.on,\n\t\t\t{\n\t\t\t\tonItemRender: obj => {\n\t\t\t\t\tif (obj.$unit) this.CurrentUnit = obj.$unit;\n\t\t\t\t},\n\t\t\t\tonItemClick: (id, e, node) => {\n\t\t\t\t\tnode = node.firstChild;\n\t\t\t\t\tthis.ShowEvent(id, node);\n\t\t\t\t\tif (!compact) this.SelectEvent(node);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tconst events = this.Data.events(true);\n\n\t\tthis.on(this.State.$changes, \"date\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"active\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (!v) this.SelectEvent(); //remove selection\n\t\t});\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData());\n\n\t\t// updates made in full mode by form\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData()\n\t\t);\n\t}\n\n\tRefreshData() {\n\t\tlet start = webix.Date.monthStart(this.State.date);\n\t\tlet end = webix.Date.add(start, 1, \"month\", true);\n\n\t\tthis.Data.getEvents(start, end).then(data => {\n\t\t\tthis.data = { all: data, start: start, end: end };\n\t\t\tif (this.app) {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(data.map(shrinkTo(start, end)));\n\t\t\t\tthis.ToggleOverlay();\n\t\t\t}\n\t\t});\n\t}\n\n\tSelectEvent(node) {\n\t\tif (node == this._selected) return;\n\n\t\tconst name = \"webix_agenda_selected\";\n\t\tif (this._selected) webix.html.removeCss(this._selected, name);\n\t\tif (node) webix.html.addCss(node, name);\n\n\t\tthis._selected = node;\n\t}\n\n\tTemplateHeader(datestring) {\n\t\tconst date = new Date(datestring * 1);\n\t\tconst today = isToday(date);\n\n\t\tconst fstring = `%F <span class='webix_scheduler_monthday${\n\t\t\ttoday ? \" webix_scheduler_today\" : \"\"\n\t\t}'>%j</span><br><span class='webix_scheduler_dayofweek'>%l</span>`;\n\n\t\treturn webix.Date.dateToStr(fstring)(date);\n\t}\n\n\tTemplateCss(obj) {\n\t\tconst ids = this.List.getUnitList(this.CurrentUnit);\n\n\t\tlet css = \"webix_list_item\";\n\t\tif (obj.id == ids[ids.length - 1]) css += \" webix_event_last\";\n\t\tif (obj.id == ids[0]) css += \" webix_event_first\";\n\n\t\treturn css;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class HourscaleView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tborderless: true,\n\t\t\tlocalId: \"scale\",\n\t\t\tcss: \"webix_scheduler_scale\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\theightSize: (obj, common) => {\n\t\t\t\t\tconst ind = this.List.getIndexById(obj.id);\n\t\t\t\t\treturn common.height - (ind === 0 ? 17 : 0) + \"px\";\n\t\t\t\t},\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 51,\n\t\t\ttemplate: obj => this.HourScaleItem(obj),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.List = this.$$(\"scale\");\n\t\tthis.ParseHours();\n\t}\n\n\tParseHours() {\n\t\tconst data = [];\n\t\tfor (let h = 0; h < 24; h++) {\n\t\t\tdata.push({ id: h + \"\" });\n\t\t}\n\t\tthis.List.parse(data);\n\t}\n\n\tHourScaleItem(obj) {\n\t\tif (this.List.getIndexById(obj.id) === 0) return \"\";\n\t\telse return `${(obj.id < 10 ? \"0\" : \"\") + obj.id}:00`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MultiMoreView extends JetView {\n\tconfig() {\n\t\tconst more = {\n\t\t\tview: \"template\",\n\t\t\tlocalId: \"more\",\n\t\t\twidth: 50,\n\t\t\tcss: \"webix_scheduler_multi_space\",\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\t\"wxi-angle-down\": () => this.ExpandData(),\n\t\t\t\t\"wxi-angle-up\": () => this.WrapData(),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tcols: [more, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.List = this.$$(\"multiDayList\");\n\t\tthis.MoreIcon = this.$$(\"more\");\n\n\t\tthis._expandState = \"down\";\n\t\tthis.maxVisibleLines = 3;\n\t}\n\n\t/**\n\t *\n\t * @param {*} mode\n\t */\n\tSetMoreIcon(mode) {\n\t\tif (!mode) {\n\t\t\tthis.MoreIcon.setHTML(\"\");\n\t\t} else {\n\t\t\tconst tooltip = mode === \"up\" ? \"Collapse\" : \"Expand\";\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.MoreIcon.setHTML(\n\t\t\t\t`<div class=\"webix_scheduler_more_icon webix_icon wxi-angle-${mode}\" webix_tooltip=\"${_(\n\t\t\t\t\t`${tooltip} all-day events`\n\t\t\t\t)}\"><div>`\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Sets new height and delay for animation\n\t * @param {string} mode - \"up\" or \"down\"\n\t * @param {number} height\n\t * @param {function} handler\n\t */\n\tAnimate(mode, height, handler) {\n\t\tconst delay = 150;\n\t\tthis.List.$view.style.transition = `height ${delay}ms`;\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, delay);\n\t}\n}\n","function _select(id, functor) {\n\tconst trgs = this.LocateSelected(id);\n\tif (trgs) {\n\t\tfor (let i = 0; i < trgs.length; i++)\n\t\t\tfunctor(trgs[i], \"webix_scheduler_event_selected\");\n\t}\n}\n\nfunction Select(id) {\n\treturn _select.call(this, id, webix.html.addCss);\n}\n\nfunction Unselect(id) {\n\treturn _select.call(this, id, webix.html.removeCss);\n}\n\nfunction HandleSelection() {\n\tconst mode = this._SelectionMode;\n\tthis.State = this.app.getState();\n\n\tthis.on(this.State.$changes, \"selected\", (v, o) => {\n\t\tif (o) this.Unselect(o.date && typeof o.date === \"string\" ? o.date : o.id);\n\n\t\tif (v) {\n\t\t\tconst id = v.id === \"0\" || !v.date ? v.id : v.date;\n\t\t\tsetTimeout(\n\t\t\t\t() => this.Select(id),\n\t\t\t\tmode !== \"multi\" && id === \"0\" ? 150 : 0\n\t\t\t);\n\t\t}\n\t});\n\n\t// reapply selection to a saved new event\n\tif (mode !== \"multi\") {\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(events.data, \"onStoreUpdated\", (id, o, operation) => {\n\t\t\tif (\n\t\t\t\toperation === \"add\" &&\n\t\t\t\tid != \"0\" &&\n\t\t\t\tthis.State.selected &&\n\t\t\t\tthis.State.selected.id === \"0\"\n\t\t\t) {\n\t\t\t\tthis.State.selected.id = id;\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction locate(inner) {\n\treturn function LocateSelected(id) {\n\t\tif (this._DataObj) {\n\t\t\treturn Array.prototype.map.call(\n\t\t\t\tthis._DataObj.querySelectorAll(\n\t\t\t\t\t`[webix_${inner ? \"l\" : \"e\"}_id=\"${id}\"]`\n\t\t\t\t),\n\t\t\t\tel => (inner ? el.firstElementChild : el)\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n}\n\nexport default function SelectionMixin(child, mode, inner) {\n\tchild._SelectionMode = mode;\n\n\tchild.Select = Select;\n\tchild.Unselect = Unselect;\n\tchild.HandleSelection = HandleSelection;\n\tchild.LocateSelected = locate(inner);\n\n\tchild.HandleSelection();\n}\n","export const Resizer = {\n\t$dragIn: function() {\n\t\tconst ctx = this.getContext();\n\n\t\tif (ctx.from.mode !== this.mode) return false;\n\t\treturn true;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\n\t\tconst box = webix.html.offset(ctx.target);\n\t\tlet y = pos.y - box.y;\n\n\t\tif (y < ctx.y_diff) y = ctx.y_diff;\n\t\telse if (y > box.height) y = box.height;\n\n\t\tconst height = y - ctx.y_diff;\n\t\tResizer.updateNodeHeight.call(this, height);\n\n\t\tif (ctx.duration !== height) {\n\t\t\tctx.duration = height;\n\t\t\tthis.updateText(ctx);\n\t\t}\n\n\t\tpos.x = ctx.x_diff;\n\t\tpos.y = ctx.y_diff;\n\t},\n\tupdateNodeHeight: function(height) {\n\t\tconst node = webix.DragControl.getNode();\n\t\tnode.style.height = Math.max(this.master.minEventHeight, height) + \"px\";\n\t},\n\tgetActualDate: function(master, any) {\n\t\tconst ctx = this.getContext();\n\n\t\tconst date = webix.Date.copy(ctx.event.start_date);\n\t\tconst minutes =\n\t\t\t(Math.round((ctx.duration * 60) / master.List.type.height / 5) || 1) * 5;\n\n\t\twebix.Date.add(date, minutes, \"minute\");\n\n\t\tif (!any && webix.Date.equal(date, ctx.event.end_date)) return null;\n\n\t\treturn {\n\t\t\tstart_date: webix.Date.copy(ctx.event.start_date),\n\t\t\tend_date: date,\n\t\t};\n\t},\n};\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nconst d = webix.Date;\r\nfunction addMinutes(date, inc) {\r\n\treturn d.add(date, inc * 1, \"minute\", true);\r\n}\r\n\r\nfunction addHours(date, inc) {\r\n\treturn d.add(date, inc * 1, \"hour\", true);\r\n}\r\n\r\nfunction addDays(date, inc) {\r\n\treturn d.add(date, inc * 1, \"day\", true);\r\n}\r\n\r\nfunction addWeeks(date, inc) {\r\n\treturn d.add(date, inc * 1, \"week\", true);\r\n}\r\n\r\nfunction addMonths(date, inc) {\r\n\treturn d.add(date, inc * 1, \"month\", true);\r\n}\r\n\r\nfunction addQuarters(date, inc) {\r\n\treturn d.add(date, inc * 3, \"month\", true);\r\n}\r\n\r\nfunction addYears(date, inc) {\r\n\treturn d.add(date, inc * 1, \"year\", true);\r\n}\r\n\r\nfunction differenceInYears(a, b) {\r\n\treturn a.getFullYear() - b.getFullYear();\r\n}\r\n\r\nfunction differenceInMonths(a, b) {\r\n\treturn (\r\n\t\t(a.getFullYear() - b.getFullYear()) * 12 + (a.getMonth() - b.getMonth())\r\n\t);\r\n}\r\n\r\nconst day_length = 86400000;\r\nfunction differenceInCalendarDays(a, b) {\r\n\ta = new Date(a);\r\n\ta.setHours(0, 0, 0, 0);\r\n\tb = new Date(b);\r\n\tb.setHours(0, 0, 0, 0);\r\n\r\n\treturn Math.round((a.getTime() - b.getTime()) / day_length);\r\n}\r\n\r\nfunction differenceInQuarters(a, b) {\r\n\treturn (\r\n\t\t(a.getFullYear() - b.getFullYear()) * 4 +\r\n\t\t(Math.floor(a.getMonth() / 3) + 1) -\r\n\t\t(Math.floor(b.getMonth() / 3) + 1)\r\n\t);\r\n}\r\n\r\nfunction differenceInWeeks(a, b) {\r\n\tconst diff = differenceInCalendarDays(a, b) / 7;\r\n\tconst end = getDay(a);\r\n\tconst start = getDay(b);\r\n\r\n\treturn Math.ceil(Math.abs(diff) - (end <= start ? 0 : 1)) * Math.sign(diff);\r\n}\r\n\r\nfunction differenceInHours(a, b) {\r\n\treturn differenceInCalendarDays(a, b) * 24 + (a.getHours() - b.getHours());\r\n}\r\n\r\nfunction differenceInMinutes(a, b) {\r\n\treturn differenceInHours(a, b) * 60 + (a.getMinutes() - b.getMinutes());\r\n}\r\n\r\nconst f_cache = {};\r\nfunction format(date, format) {\r\n\treturn formatFunction(format)(date);\r\n}\r\nfunction formatFunction(format) {\r\n\tlet cb = f_cache[format];\r\n\tif (!cb) {\r\n\t\tcb = f_cache[format] = d.dateToStr(format);\r\n\t}\r\n\r\n\treturn cb;\r\n}\r\n\r\nfunction getDay(date) {\r\n\tlet shift = date.getDay();\r\n\tif (d.startOnMonday) {\r\n\t\tif (shift === 0) shift = 6;\r\n\t\telse shift--;\r\n\t}\r\n\treturn shift;\r\n}\r\n\r\nfunction getDatePart(date) {\r\n\treturn d.datePart(date, true);\r\n}\r\n\r\nfunction getTimePart(date) {\r\n\treturn d.timePart(date);\r\n}\n\nconst diff = {\r\n\tyear: differenceInYears,\r\n\tquarter: differenceInQuarters,\r\n\tmonth: differenceInMonths,\r\n\tweek: differenceInWeeks,\r\n\tday: differenceInCalendarDays,\r\n\thour: differenceInHours,\r\n\tminute: differenceInMinutes,\r\n};\r\n\r\nfunction countDaysInMonth(sdate) {\r\n\tif (!sdate) return 30;\r\n\r\n\tconst m = sdate.getMonth();\r\n\r\n\tif (m === 1) {\r\n\t\tconst y = sdate.getFullYear();\r\n\t\tif (y % 4) return 28;\r\n\t\tif (y % 100) return 29;\r\n\t\tif (y % 400) return 28;\r\n\t\treturn 29;\r\n\t}\r\n\r\n\tif ((m % 2 && m < 7) || (!(m % 2) && m > 7)) {\r\n\t\treturn 30;\r\n\t}\r\n\r\n\treturn 31;\r\n}\r\n/**\r\n * Smaller units for task position and width for scales with precision setting:\r\n * the name of the unit and the number within a larger unit\r\n */\r\nconst smallerCount = {\r\n\tyear: [\"quarter\", 4],\r\n\tquarter: [\"month\", 3],\r\n\tmonth: [\"day\", countDaysInMonth],\r\n\tweek: [\"day\", 7],\r\n\tday: [\"hour\", 24],\r\n\thour: [\"minute\", 60],\r\n};\r\n\r\nconst add = {\r\n\tyear: addYears,\r\n\tquarter: addQuarters,\r\n\tmonth: addMonths,\r\n\tweek: addWeeks,\r\n\tday: addDays,\r\n\thour: addHours,\r\n\tminute: addMinutes,\r\n};\r\n\r\n/**\r\n * Calculates the difference between two dates in units\r\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\r\n * @param {Date} next - a later date\r\n * @param {Date} prev - an earlier date\r\n * @param {boolean} precise - current precision setting of the scales (if true, diff will be counted for smallerCount)\r\n * @param {boolean} wt - shows that diff will be counted for the width of a task\r\n * @returns {number} - an int (if precise is false) or a float number\r\n */\r\nfunction innerDiff(unit, next, prev, precise, wt) {\r\n\tconst minUnit = precise ? smallerCount[unit][0] : unit;\r\n\r\n\tlet start = prev;\r\n\tlet end = next;\r\n\tif (wt) {\r\n\t\tstart = getUnitStart(minUnit, prev);\r\n\t\tend = getUnitStart(minUnit, next);\r\n\t\tif (end < next) end = addUnit(minUnit)(end, 1);\r\n\t}\r\n\r\n\tif (precise) {\r\n\t\tlet filled = diff[minUnit](end, start);\r\n\t\tconst all = smallerCount[unit][1];\r\n\t\treturn filled / (typeof all === \"number\" ? all : all(prev));\r\n\t} else {\r\n\t\treturn diff[minUnit](end, start);\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns a function for calculating the difference between two dates in units\r\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\r\n * @returns {function} - details below\r\n */\r\nfunction getDiff(unit) {\r\n\t/**\r\n\t * the returned function calculates the difference between two dates based on passed parameters\r\n\t * @param {Date} next - first date\r\n\t * @param {Date} prev - second date\r\n\t * @param {boolean} precise false by default, true when used to count x-position\r\n\t * and width of tasks with 'step-1' precision\r\n\t * @param {boolean} wt - marker that diff is used to count width of a task;\r\n\t * if diff returns 0, you have to add 1; otherwise tasks that are within 1 unit will have 0 width\r\n\t * and will be displayed incorrectly\r\n\t * @returns {number} - the difference between two dates in 'units'; if 'precise' is true, the number is float, otherwise int\r\n\t */\r\n\treturn (next, prev, precise, wt) => {\r\n\t\tif (unit === \"month\" && precise) {\r\n\t\t\treturn getMonthDayDiff(next, prev, wt);\r\n\t\t} else {\r\n\t\t\treturn innerDiff(unit, next, prev, precise, wt);\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Calculates the difference in months between two days for a scale with precision setting\r\n * This is a specific case of diff counting, because a month can have 28-31 days\r\n * @param {Date} end - a later date\r\n * @param {Date} start - an earlier date\r\n * @param {Boolean} wt - shows that diff will be counted for the width of a task\r\n * @returns {number} - a float number\r\n */\r\nfunction getMonthDayDiff(end, start, wt) {\r\n\tif (sameMonth(start, end)) {\r\n\t\treturn innerDiff(\"month\", end, start, true, wt);\r\n\t}\r\n\r\n\t// if starts not on 1st day\r\n\tlet daysOfFirstMonth = 0;\r\n\tif (start.getDate() > 1) {\r\n\t\tconst me = new Date(start.getFullYear(), start.getMonth() + 1, 1);\r\n\t\tdaysOfFirstMonth = innerDiff(\"month\", me, start, true);\r\n\t\tstart = me;\r\n\t}\r\n\r\n\t// if lasts 1+ whole months\r\n\tlet months = 0;\r\n\tif (!sameMonth(start, end)) {\r\n\t\tmonths = innerDiff(\"month\", webix.Date.monthStart(end), start); // int part\r\n\t\tstart = webix.Date.add(start, months, \"month\", true);\r\n\t}\r\n\r\n\t// all above plus days of last month if any\r\n\treturn daysOfFirstMonth + months + innerDiff(\"month\", end, start, true);\r\n}\r\n\r\nfunction sameMonth(a, b) {\r\n\treturn webix.Date.equal(webix.Date.monthStart(a), webix.Date.monthStart(b));\r\n}\r\n\r\nfunction addUnit(unit) {\r\n\treturn add[unit];\r\n}\r\n\r\nfunction getUnitStart(unit, start) {\r\n\tlet t;\r\n\tswitch (unit) {\r\n\t\tcase \"year\":\r\n\t\t\treturn new Date(start.getFullYear(), 0, 1);\r\n\t\tcase \"quarter\":\r\n\t\t\treturn new Date(\r\n\t\t\t\tstart.getFullYear(),\r\n\t\t\t\tMath.floor(start.getMonth() / 3) * 3,\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\tcase \"month\":\r\n\t\t\treturn new Date(start.getFullYear(), start.getMonth(), 1);\r\n\t\tcase \"week\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setDate(start.getDate() - getDay(start));\r\n\t\t\treturn t;\r\n\t\tcase \"day\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setHours(0, 0, 0, 0);\r\n\t\t\treturn t;\r\n\t\tcase \"hour\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setHours(start.getHours(), 0, 0, 0);\r\n\t\t\treturn t;\r\n\t\tdefault:\r\n\t\t\treturn new Date(start);\r\n\t}\r\n}\n\nfunction getMinUnit(scales) {\r\n\tconst start = new Date();\r\n\treturn scales\r\n\t\t.map(item => ({ item, len: addUnit(item.unit)(start, 1) }))\r\n\t\t.sort((a, b) => (a.len < b.len ? -1 : 1))[0].item.unit;\r\n}\r\n\r\n/**\r\n * Resets scales to new parameters and returns the object that stores related constants and functions\r\n * @param {Date} start - start date\r\n * @param {Date} end - end date\r\n * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\r\n * @param {number} width - width of smallest cell unit\r\n * @param {number} height - height of scale cell\r\n * @param {Array} scales - a set of scales (objects)\r\n * @param {function} isHoliday - the function that checks if a day is a holiday\r\n * @returns {Object} scales\r\n */\r\nfunction resetScales(\r\n\tstart,\r\n\tend,\r\n\tprecise,\r\n\twidth,\r\n\theight,\r\n\tscales,\r\n\tisHoliday\r\n) {\r\n\t// console.log(\"[x] reset scales\");\r\n\r\n\tconst minUnit = getMinUnit(scales);\r\n\tconst diff = getDiff(minUnit);\r\n\r\n\tconst tempEnd = getUnitStart(minUnit, end);\r\n\tstart = getUnitStart(minUnit, start);\r\n\tend = tempEnd < end ? addUnit(minUnit)(tempEnd, 1) : tempEnd;\r\n\r\n\tconst fullWidth = diff(end, start) * width;\r\n\tconst fullHeight = height * scales.length;\r\n\r\n\tconst rows = scales.map(line => {\r\n\t\tconst cells = [];\r\n\t\tconst add = addUnit(line.unit);\r\n\t\tconst step = line.step || 1;\r\n\t\tconst countInWeeks = minUnit === \"week\" && line.unit !== \"week\";\r\n\r\n\t\tlet date = getUnitStart(line.unit, start);\r\n\t\twhile (date < end) {\r\n\t\t\tlet next = add(date, step);\r\n\r\n\t\t\tif (date < start) date = start;\r\n\t\t\tif (next > end) next = end;\r\n\r\n\t\t\t/**\r\n\t\t\t * Special handling for counting width of greater units in weeks\r\n\t\t\t * this code decides whether a week belongs to the current greater unit based on weekdays of this unit boundaries\r\n\t\t\t * if start day is Thursday+, then this greater unit should not count this week as its own\r\n\t\t\t * if end day is Thursday+, then this greater unit should count this week as its own\r\n\t\t\t */\r\n\t\t\tlet cdate = date;\r\n\t\t\tlet cnext = next;\r\n\t\t\tif (countInWeeks) {\r\n\t\t\t\tif (getDay(date) > 3) {\r\n\t\t\t\t\tcdate = webix.Date.add(date, 1, \"week\", true);\r\n\t\t\t\t}\r\n\t\t\t\tif (getDay(next) > 3) {\r\n\t\t\t\t\tcnext = webix.Date.add(next, 1, \"week\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst cellWidth = (diff(cnext, cdate) || 1) * width;\r\n\r\n\t\t\t/*[ToDo] suggestion\r\n\t\t\t value must not be formatted within engine as it depends on app locale\r\n\t\t\t use scales.format function to format dates in UI\r\n\t\t\t*/\r\n\r\n\t\t\tconst value =\r\n\t\t\t\ttypeof line.format === \"function\"\r\n\t\t\t\t\t? line.format(date, next)\r\n\t\t\t\t\t: format(date, line.format);\r\n\r\n\t\t\tlet css = \"\";\r\n\t\t\tif (line.css)\r\n\t\t\t\tcss += typeof line.css === \"function\" ? line.css(date) : line.css;\r\n\r\n\t\t\tcells.push({\r\n\t\t\t\twidth: cellWidth,\r\n\t\t\t\tvalue,\r\n\t\t\t\tcss,\r\n\t\t\t\tdate,\r\n\t\t\t\tformat: formatFunction(line.format),\r\n\t\t\t});\r\n\r\n\t\t\tdate = next;\r\n\t\t}\r\n\r\n\t\treturn { cells, add, height, type: line.unit, step: line.step || 1 };\r\n\t});\r\n\r\n\tprecise = !!(minUnit === \"day\" ? precise : precise != false);\r\n\r\n\treturn {\r\n\t\trows,\r\n\t\twidth: fullWidth,\r\n\t\theight: fullHeight,\r\n\t\tcellWidth: width,\r\n\t\tcellHeight: height,\r\n\t\tdiff,\r\n\t\tstart,\r\n\t\tend,\r\n\t\tminUnit,\r\n\t\tprecise,\r\n\t\tisHoliday,\r\n\t};\r\n}\r\n\r\nfunction grid(width, height, color) {\r\n\tconst canvas = document.createElement(\"canvas\");\r\n\tcanvas.setAttribute(\"width\", width);\r\n\tcanvas.setAttribute(\"height\", height);\r\n\r\n\tconst ctx = canvas.getContext(\"2d\");\r\n\tctx.strokeStyle = color;\r\n\tctx.moveTo(0, height);\r\n\tctx.lineTo(width, height);\r\n\tctx.lineTo(width, 0);\r\n\tctx.stroke();\r\n\r\n\treturn canvas.toDataURL();\r\n}\n\n/**\r\n * Prepares dimensional coordinates for a task\r\n * @param {Object} task - task data object\r\n * @param {number} i - the index of the task\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {number} taskHeight - the height of a task bar\r\n * @param {number} y - the top position of a task after which the current task will be placed (timeline mode)\r\n * @returns {Object} task data object\r\n */\r\nfunction updateTask(task, i, scales, taskHeight, y) {\r\n\tif (task.type === \"split\" && task.$data && task.$data.length) {\r\n\t\ttask.$data.forEach(k => getSizes(k, i, scales, taskHeight));\r\n\t} else {\r\n\t\tgetSizes(task, i, scales, taskHeight, y);\r\n\t}\r\n\treturn task;\r\n}\r\n\r\nfunction getSizes(task, i, scales, taskHeight, y) {\r\n\tconst { start, end, cellWidth, cellHeight, diff, minUnit, precise } = scales;\r\n\tconst startDate = task.start_date < start ? start : task.start_date;\r\n\tconst endDate = task.end_date > end ? end : task.end_date;\r\n\tconst astart = getUnitStart(minUnit, start);\r\n\r\n\tconst ms = task.type == \"milestone\";\r\n\ttask.$h = taskHeight;\r\n\ttask.$x =\r\n\t\tMath.round(diff(startDate, astart, precise) * cellWidth) -\r\n\t\t(ms ? task.$h / 2 : 0);\r\n\ttask.$w = ms\r\n\t\t? task.$h\r\n\t\t: Math.round(diff(endDate, startDate, precise, true) * cellWidth);\r\n\ttask.$y = webix.isUndefined(y)\r\n\t\t? cellHeight * i + (cellHeight - taskHeight) / 2\r\n\t\t: y;\r\n}\r\n\r\n/**\r\n * Updates start, end and duration fields of tasks during initial loading and updating\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - (optional) the data for current scales; the return value of resetScales()\r\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\r\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\r\n */\r\nfunction updateTaskDuration(task, scales, mode, dir) {\r\n\tif (\r\n\t\ttask.start_date &&\r\n\t\ttask.end_date &&\r\n\t\ttask.start_date.valueOf() >= task.end_date.valueOf()\r\n\t) {\r\n\t\ttask.end_date = null;\r\n\t\ttask.duration = 1;\r\n\r\n\t\tif (mode) mode = \"move\";\r\n\t}\r\n\r\n\tif (scales) {\r\n\t\texcludeHolidays(task, scales, mode, dir);\r\n\t} else {\r\n\t\tif (task.type == \"milestone\") {\r\n\t\t\tgetMilestone(task);\r\n\t\t} else {\r\n\t\t\tif (!task.duration) {\r\n\t\t\t\ttask.duration = getDuration(task);\r\n\t\t\t}\r\n\t\t\tif (!task.end_date) {\r\n\t\t\t\ttask.end_date = getEnd(task);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Excludes holidays from start, end and duration of tasks (can't start or end on a holiday)\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\r\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\r\n */\r\nfunction excludeHolidays(task, scales, mode, dir) {\r\n\tif (task.type == \"milestone\") {\r\n\t\ttask.start_date = mode\r\n\t\t\t? toWorkday(task.start_date, false, scales, dir)\r\n\t\t\t: toClosestWorkday(task.start_date, scales); //on load\r\n\t\treturn getMilestone(task);\r\n\t}\r\n\r\n\tif (!mode) {\r\n\t\t//on load\r\n\t\ttask.start_date = toClosestWorkday(task.start_date, scales);\r\n\t\ttask.end_date = getEndWorkday(task, scales);\r\n\t\ttask.duration = getDuration(task, scales);\r\n\t} else {\r\n\t\tif (mode == \"start\" || mode == \"move\") {\r\n\t\t\ttask.start_date = toWorkday(task.start_date, false, scales, dir);\r\n\t\t\tif (!task.duration) task.duration = getDuration(task, scales);\r\n\t\t\tif (!task.end_date) task.end_date = getEndWorkday(task, scales);\r\n\t\t} else {\r\n\t\t\t//end, duration\r\n\t\t\tif (!task.end_date) task.end_date = getEndWorkday(task, scales);\r\n\t\t\tif (!task.duration) {\r\n\t\t\t\ttask.end_date = toWorkday(task.end_date, true, scales, dir);\r\n\t\t\t\ttask.duration = getDuration(task, scales);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getMilestone(task) {\r\n\ttask.duration = 0;\r\n\ttask.end_date = task.start_date;\r\n}\r\n\r\n/**\r\n * Returns the end date of a task\r\n * @param {Object} task - task data object\r\n */\r\nfunction getEnd(task) {\r\n\tif (task.duration < 1)\r\n\t\treturn addUnit(\"hour\")(task.start_date, Math.floor(24 * task.duration));\r\n\telse return addUnit(\"day\")(task.start_date, task.duration);\r\n}\r\n\r\n/**\r\n * Returns end date excluding holidays from duration\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {Date} end date\r\n */\r\nfunction getEndWorkday(task, scales) {\r\n\tif (task.duration < 1) return getEnd(task);\r\n\r\n\tlet date = getDatePart(task.start_date);\r\n\tfor (let w = 0, d = 0; w < task.duration; ) {\r\n\t\tif (!scales.isHoliday(date)) {\r\n\t\t\t++w;\r\n\t\t\td = 0;\r\n\t\t} else {\r\n\t\t\tif (++d === 30) holidayGuard();\r\n\t\t}\r\n\r\n\t\tdate = addDays(date, 1);\r\n\t}\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Calculates the duration of a task\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {number} task duration\r\n */\r\nfunction getDuration(task, scales) {\r\n\tconst d = getDiff(\"day\")(task.end_date, task.start_date, true);\r\n\t// allow float duration for tasks smaller than day\r\n\tif (d < 1) return parseFloat(d.toFixed(2));\r\n\r\n\tif (!scales) return Math.floor(d);\r\n\r\n\tlet date = task.start_date;\r\n\tlet duration = 0;\r\n\twhile (date < task.end_date) {\r\n\t\tif (!scales.isHoliday(date)) ++duration;\r\n\t\tdate = addDays(date, 1);\r\n\t}\r\n\treturn duration;\r\n}\r\n\r\n/**\r\n * Moves a date from a holiday to the closest working day (priority to the future)\r\n * @param {Date} date - original date\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {Date} the date of a closest work day\r\n */\r\nfunction toClosestWorkday(date, scales) {\r\n\tlet left = date;\r\n\tlet right = date;\r\n\tlet notRight;\r\n\tlet d = 0;\r\n\r\n\twhile (\r\n\t\td < 30 &&\r\n\t\t(notRight = scales.isHoliday(right)) &&\r\n\t\tscales.isHoliday(left)\r\n\t) {\r\n\t\tleft = addDays(left, -1);\r\n\t\tright = addDays(right, 1);\r\n\t\td++;\r\n\t}\r\n\tif (d === 30) holidayGuard();\r\n\r\n\treturn !notRight ? right : left;\r\n}\r\n\r\nfunction holidayGuard() {\r\n\talert(\r\n\t\t\"No work days found within 30 days, check your isHoliday function!\",\r\n\t\t\"error\"\r\n\t);\r\n\tthrow \"Wrong isHoliday function\";\r\n}\r\n\r\n/**\r\n * Moves a date from a holiday to a working day in the given direction\r\n * @param {Date} date - the current date\r\n * @param {Boolean} end - indicates if this is the end of a task\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {number} dir - the direction in which nearest workday will be located; -1 is the past, 1 is the future\r\n * @returns {Date} the date of a working day\r\n */\r\nfunction toWorkday(date, end, scales, dir) {\r\n\tlet d = 0;\r\n\r\n\twhile (d < 30 && scales.isHoliday(getCheckDate(date, end))) {\r\n\t\tdate = addDays(date, dir);\r\n\t\td++;\r\n\t}\r\n\r\n\tif (d === 30) holidayGuard();\r\n\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Returns the date for a holiday check\r\n * @param {Date} date - the date\r\n * @param {Boolean} end - if true, means it's the end date (end dates are exclusive)\r\n * @returns {Date} the date that will be used for a check\r\n */\r\nfunction getCheckDate(date, end) {\r\n\treturn end && !getTimePart(date) ? addDays(date, -1) : date;\r\n}\n\nconst delta = 20;\r\n\r\nconst updateLink = function(link, startTask, endTask, height) {\r\n\tconst dy = Math.round(height / 2);\r\n\tif (!startTask || !endTask) {\r\n\t\tlink.$p = \"\";\r\n\t\treturn link;\r\n\t}\r\n\r\n\tlet sx, sy, ex, ey;\r\n\tlet s_start = false;\r\n\tlet e_start = false;\r\n\r\n\tswitch (link.type) {\r\n\t\tcase 0:\r\n\t\t\te_start = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 1:\r\n\t\t\ts_start = true;\r\n\t\t\te_start = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 3:\r\n\t\t\ts_start = true;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tsx = s_start ? startTask.$x : startTask.$x + startTask.$w;\r\n\tsy = startTask.$y;\r\n\tex = e_start ? endTask.$x : endTask.$x + endTask.$w;\r\n\tey = endTask.$y;\r\n\r\n\tif (differentX(startTask, endTask, sx, ex, height) || sy !== ey) {\r\n\t\tconst lineCoords = getLineCoords(\r\n\t\t\tsx,\r\n\t\t\tsy + dy,\r\n\t\t\tex,\r\n\t\t\tey + dy,\r\n\t\t\ts_start,\r\n\t\t\te_start,\r\n\t\t\t38 / 2\r\n\t\t);\r\n\r\n\t\tconst arrowCoords = getArrowCoords(ex, ey + dy, e_start);\r\n\t\tlink.$p = `${lineCoords},${arrowCoords}`;\r\n\t} else {\r\n\t\tlink.$p = \"\";\r\n\t}\r\n\r\n\treturn link;\r\n};\r\n\r\nfunction differentX(startTask, endTask, sx, ex, height) {\r\n\treturn startTask.type === \"milestone\" || endTask.type === \"milestone\"\r\n\t\t? Math.abs(sx - ex) > height / 2\r\n\t\t: sx !== ex;\r\n}\r\n\r\nfunction getLineCoords(sx, sy, ex, ey, s_start, e_start, gapp) {\r\n\tconst shift = delta * (s_start ? -1 : 1);\r\n\tconst backshift = delta * (e_start ? -1 : 1);\r\n\r\n\tconst sx1 = sx + shift;\r\n\tconst ex1 = ex + backshift;\r\n\tconst line = [sx, sy, sx1, sy, 0, 0, 0, 0, ex1, ey, ex, ey];\r\n\r\n\tconst dx = ex1 - sx1;\r\n\tlet dy = ey - sy;\r\n\r\n\tconst same = e_start === s_start;\r\n\tif (!same && ((ex1 <= sx && e_start) || (ex1 > sx && !e_start))) {\r\n\t\tdy -= gapp;\r\n\t}\r\n\r\n\tif ((same && e_start && sx1 > ex1) || (same && !e_start && sx1 < ex1)) {\r\n\t\tline[4] = line[2] + dx;\r\n\t\tline[5] = line[3];\r\n\t\tline[6] = line[4];\r\n\t\tline[7] = line[5] + dy;\r\n\t} else {\r\n\t\tline[4] = line[2];\r\n\t\tline[5] = line[3] + dy;\r\n\t\tline[6] = line[4] + dx;\r\n\t\tline[7] = line[5];\r\n\t}\r\n\r\n\treturn line.join(\",\");\r\n}\r\n\r\nfunction getArrowCoords(x, y, start) {\r\n\tif (start) {\r\n\t\treturn `${x - 5},${y - 3},${x - 5},${y + 3},${x},${y}`;\r\n\t} else {\r\n\t\treturn `${x + 5},${y + 3},${x + 5},${y - 3},${x},${y}`;\r\n\t}\r\n}\r\n\r\nfunction newLink(box, start, end) {\r\n\tif (start && end) {\r\n\t\tconst width = end.x - start.x;\r\n\t\tconst height = end.y - start.y;\r\n\t\tconst left = (width > 0 ? start.x : end.x) - box.left;\r\n\t\tconst top = (height > 0 ? start.y : end.y) - box.top;\r\n\t\tconst p = `${width > 0 ? 0 : -width},${height > 0 ? 0 : -height},${\r\n\t\t\twidth > 0 ? width : 0\r\n\t\t},${height > 0 ? height : 0}`;\r\n\t\treturn { width: Math.abs(width), height: Math.abs(height), left, top, p };\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\n\nexports.addUnit = addUnit;\nexports.getDiff = getDiff;\nexports.getUnitStart = getUnitStart;\nexports.grid = grid;\nexports.newLink = newLink;\nexports.resetScales = resetScales;\nexports.smallerCount = smallerCount;\nexports.updateLink = updateLink;\nexports.updateTask = updateTask;\nexports.updateTaskDuration = updateTaskDuration;\n//# sourceMappingURL=wgantt.js.map\n","import HourscaleView from \"../common/hourscale\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { shrinkTo, isToday } from \"helpers/dates\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class DayEventsView extends HourscaleView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\t// when dayevents is a part of week\n\t\tif (config) {\n\t\t\tthis.WeekDayNum = config.day;\n\t\t}\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"dayList\",\n\t\t\tcss: \"webix_scheduler_day_events\",\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\ttemplate: \"\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\tcss: \"webix_scheduler_day_scale_item\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_day_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_scheduler_day_scale_item: (_e, h) => this.ShowNew(h),\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"dayList\");\n\n\t\tSelectionMixin(this, \"scale\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.List.$setSize = function(x, y) {\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\tthis.minEventHeight = 62;\n\t\tthis.ParseHours();\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.List.render());\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"day\");\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.Day = webix.Date.datePart(this.State.date, true);\n\n\t\t\tif (this.WeekDayNum > -1) {\n\t\t\t\tconst weekStart = this.data.start;\n\t\t\t\tthis.Day = webix.Date.add(weekStart, this.WeekDayNum, \"day\", true);\n\t\t\t}\n\n\t\t\tconst to = webix.Date.add(this.Day, 1, \"day\", true);\n\t\t\tthis.Events = this.FilterToday(this.Day, to);\n\n\t\t\tif (this._marker_update_interval)\n\t\t\t\tthis._marker_update_interval = clearInterval(\n\t\t\t\t\tthis._marker_update_interval\n\t\t\t\t);\n\n\t\t\tif (isToday(this.Day))\n\t\t\t\tthis._marker_update_interval = setInterval(() => {\n\t\t\t\t\tif (isToday(this.Day)) this.UpdateMarkerPosition();\n\t\t\t\t\telse {\n\t\t\t\t\t\twebix.html.remove(this._Marker);\n\t\t\t\t\t\tthis._Marker = this._marker_update_interval = clearInterval(\n\t\t\t\t\t\t\tthis._marker_update_interval\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, 5 * 60 * 1000); // 5 minutes\n\n\t\t\tthis.List.render();\n\t\t}\n\t}\n\n\tGetEvent(id) {\n\t\tfor (let i = 0; i < this.Events.length; i++)\n\t\t\tif (this.Events[i].id == id) return this.Events[i];\n\t\treturn null;\n\t}\n\n\tFilterToday(value, to) {\n\t\tif (this.WeekDayNum > -1) {\n\t\t\treturn this.data.single.filter(ev => {\n\t\t\t\treturn ev.start_date < to && ev.end_date > value;\n\t\t\t});\n\t\t}\n\t\treturn this.data.single;\n\t}\n\n\tMarkToday() {\n\t\tif (this.Day && isToday(this.Day)) {\n\t\t\tconst marker = webix.html.create(\"div\", {\n\t\t\t\tclass: \"webix_scheduler_today_marker\",\n\t\t\t});\n\t\t\tthis._Marker = this.List.$view.firstChild.appendChild(marker);\n\t\t\tthis.UpdateMarkerPosition();\n\t\t} else {\n\t\t\tthis._Marker = null;\n\t\t}\n\t}\n\n\tUpdateMarkerPosition() {\n\t\tif (this._Marker) {\n\t\t\tconst current = new Date();\n\t\t\tconst time = current.getHours() * 60 + current.getMinutes();\n\t\t\tthis._Marker.style.top =\n\t\t\t\tMath.round((time * this.List.type.height) / 60) + \"px\";\n\t\t}\n\t}\n\n\tRenderEvents() {\n\t\tconst evs = this.Events;\n\t\tif (evs && evs.length) {\n\t\t\tthis.PrepareEvents();\n\t\t\tconst container = webix.html.create(\"div\", {\n\t\t\t\trole: \"presentation\",\n\t\t\t});\n\t\t\tcontainer.innerHTML = evs.map(i => this.ToHTML(i)).join(\"\");\n\t\t\tthis._DataObj = this.List.$view.firstChild.appendChild(container);\n\t\t\tthis.app.callEvent(\"events:rendered\", []);\n\t\t}\n\t\tthis.MarkToday();\n\t}\n\n\tPrepareEvents() {\n\t\tconst evs = this.Events;\n\t\tlet stack = [];\n\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tconst ev = evs[i];\n\t\t\tev.$inner = false;\n\n\t\t\tlet orderSet = this.PruneStack(ev, stack);\n\n\t\t\tif (stack.length) {\n\t\t\t\tstack[stack.length - 1].$inner = true;\n\t\t\t}\n\n\t\t\tif (!orderSet) {\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tev.$sorder = stack[stack.length - 1].$sorder + 1;\n\t\t\t\t\tev.$inner = false;\n\t\t\t\t} else {\n\t\t\t\t\tev.$sorder = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// insert new event into stack\n\t\t\tstack.splice(ev.$sorder, 0, ev);\n\t\t\tif (stack.length > (stack.max_count || 0)) {\n\t\t\t\tstack.max_count = stack.length;\n\t\t\t}\n\t\t}\n\n\t\tthis.SetPosition(stack, evs);\n\t}\n\n\t// returns true if new event was marked for inserting;\n\t// false if stack is empty or there is no suitable place for new event inside\n\tPruneStack(newEvent, stack) {\n\t\t// clean events from top of stack if new event starts after they end\n\t\twhile (\n\t\t\tstack.length &&\n\t\t\tthis.GetEventEndDate(stack[stack.length - 1]) <= newEvent.start_date\n\t\t) {\n\t\t\tstack.splice(stack.length - 1, 1);\n\t\t}\n\n\t\t// clean 1 event from within remaining stack if this event ends before new event starts\n\t\tfor (let j = 0; j < stack.length; j++) {\n\t\t\tif (this.GetEventEndDate(stack[j]) <= newEvent.start_date) {\n\t\t\t\tnewEvent.$sorder = stack[j].$sorder; // mark new event for this place in stack\n\t\t\t\tstack.splice(j, 1);\n\t\t\t\tnewEvent.$inner = true;\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tSetPosition(stack, evs) {\n\t\t//scale start correction\n\t\tconst delta = this.List.getFirstId() * this.List.type.height;\n\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tconst ev = evs[i];\n\n\t\t\tev.$count = stack.max_count;\n\t\t\tlet temp_width = Math.floor(this.List.$width / ev.$count);\n\t\t\tev.$left = ev.$sorder * temp_width;\n\t\t\tif (!ev.$inner) temp_width = temp_width * (ev.$count - ev.$sorder);\n\t\t\tev.$width = temp_width - 8;\n\n\t\t\tconst evCorrectedCopy = shrinkTo(\n\t\t\t\tthis.Day,\n\t\t\t\twebix.Date.add(this.Day, 1, \"day\", true)\n\t\t\t)(ev);\n\t\t\tconst sm =\n\t\t\t\tevCorrectedCopy.start_date.getHours() * 60 +\n\t\t\t\tevCorrectedCopy.start_date.getMinutes();\n\t\t\tconst em =\n\t\t\t\tevCorrectedCopy.end_date.getHours() * 60 +\n\t\t\t\t\tevCorrectedCopy.end_date.getMinutes() || 24 * 60;\n\n\t\t\tev.$top = Math.round((sm * this.List.type.height) / 60) - delta;\n\t\t\tev.$height = Math.max(\n\t\t\t\tthis.minEventHeight,\n\t\t\t\t((em - sm) * this.List.type.height) / 60\n\t\t\t);\n\t\t}\n\t}\n\n\tToHTML(obj) {\n\t\tconst content = this.EventTemplate(obj);\n\t\treturn this.EventTemplateStart(obj) + content + \"</div>\";\n\t}\n\n\tGetEventEndDate(ev) {\n\t\tlet end_date = ev.end_date;\n\t\tconst duration =\n\t\t\t(((ev.end_date - ev.start_date) / 60000) * this.List.type.height) / 60;\n\n\t\tif (duration < this.minEventHeight) {\n\t\t\tend_date = webix.Date.add(\n\t\t\t\tev.start_date,\n\t\t\t\tMath.ceil((this.minEventHeight / this.List.type.height) * 60),\n\t\t\t\t\"minute\",\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t\treturn end_date;\n\t}\n\n\tEventTemplateStart(obj) {\n\t\tconst css = `class=\"webix_scheduler_day_event ${\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \"webix_scheduler_event_selected\"\n\t\t\t\t: \"\"\n\t\t} ${obj.$past ? \"webix_scheduler_past_event\" : \"\"}\"`;\n\n\t\treturn `<div webix_e_id='${obj.id}' ${css} style='left:${\n\t\t\tobj.$left\n\t\t}px; top:${obj.$top}px; width:${obj.$width}px; height:${\n\t\t\tobj.$height\n\t\t}px; ${dayEventColor(obj)}'>`;\n\t}\n\n\tEventTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst resizer = this.State.readonly\n\t\t\t? \"\"\n\t\t\t: \"<div class='webix_icon webix_scheduler_resizer' webix_resizer='true'></div>\";\n\n\t\treturn `<div class=\"webix_scheduler_inner_day\"><span class=\"webix_scheduler_event_name\">${obj.text ||\n\t\t\t_(\n\t\t\t\t\"(No title)\"\n\t\t\t)}</span><div class=\"webix_scheduler_event_time\">${webix.i18n.timeFormatStr(\n\t\t\tobj.start_date\n\t\t)} - ${webix.i18n.timeFormatStr(obj.end_date)}</div></div>${resizer}`;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.List.$view);\n\t\tif (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.GetEvent(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} h - the ID of the hour segment of the main view\n\t * @returns {Date}\n\t */\n\tGetTargetDate(h) {\n\t\tconst date = webix.Date.copy(this.Day || this.State.date);\n\t\tif (h) date.setHours(h);\n\t\treturn date;\n\t}\n\n\t/**\n\t * Sets selected in the global reactive state to display a newly created event\n\t * @param {(string|number)} h - the ID of the hour segment of the main view\n\t */\n\tShowNew(h) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tstate.selected = { id: \"0\", date: this.GetTargetDate(h) };\n\t\t}\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of the event\n\t * @param {Object} newEvent - the data of the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport SelectionMixin from \"helpers/selection\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class MultidayEventList extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.cols[1] = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tautoheight: true,\n\t\t\tscroll: false,\n\t\t\tcss: \"webix_scheduler_multilist\",\n\t\t\ttype: {\n\t\t\t\theight: 36,\n\t\t\t\ttemplate: (obj, common) => this.EventTemplate(obj, common),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: (e, id, node) =>\n\t\t\t\t\tthis.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tsuper.init();\n\n\t\tthis._DataObj = this.List.$view.firstChild;\n\t\tSelectionMixin(this, \"multi\", true);\n\n\t\tthis.MoreIcon = this.$$(\"more\");\n\t\tthis._moreBtn = {\n\t\t\tid: \"$wsh_multi_more\",\n\t\t\t$css: \"webix_scheduler_multi_more\",\n\t\t};\n\n\t\tthis.on(this.$$(\"multiDayList\"), \"onAfterRender\", () => {\n\t\t\tthis.app.callEvent(\"events:rendered\", []);\n\t\t});\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile) {\n\t\t\tEditRecurringMixin(this);\n\t\t\tCopyPasteMixin(this, this.List, { multi: true });\n\t\t}\n\t}\n\n\turlChange() {\n\t\tconst data = this.getParam(\"data\");\n\t\tif (data) {\n\t\t\tthis.LimitData(data.multi);\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(data.multi);\n\t\t}\n\t}\n\n\tEventTemplate(obj, common) {\n\t\tconst height = common.height - 8;\n\t\tconst size = `height:${height}px; line-height:${height}px; width:calc(100% - 5px);`;\n\t\tconst color = obj.id !== \"$wsh_multi_more\" ? dayEventColor(obj) : \"\";\n\t\tconst css = this.GetStyle(obj);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${color}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj) {\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tif (obj.id == \"$wsh_multi_more\") return css;\n\n\t\tconst date = this.State.date;\n\t\tconst end =\n\t\t\t!obj.all_day && !webix.Date.timePart(obj.end_date)\n\t\t\t\t? webix.Date.add(obj.end_date, -1, \"day\", true)\n\t\t\t\t: obj.end_date;\n\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (obj.start_date < date) css += \" webix_scheduler_event_break_left\";\n\t\tif (end >= webix.Date.add(date, 1, \"day\", true))\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\treturn css;\n\t}\n\n\tLimitData(data) {\n\t\tif (data.length > this.maxVisibleLines) {\n\t\t\tconst excess = data.length - 2;\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis._moreBtn.text = `${excess} ${_(\"more\")}`;\n\n\t\t\tif (this._expandState === \"down\") {\n\t\t\t\tthis._reserve = data.splice(2, excess, this._moreBtn);\n\t\t\t} else {\n\t\t\t\tthis._reserve = data.slice(2);\n\t\t\t}\n\n\t\t\tthis.SetMoreIcon(this._expandState);\n\t\t\tthis._reserveIds = this._reserve.map(d => d.id);\n\t\t} else {\n\t\t\tthis.SetMoreIcon();\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tconst height =\n\t\t\t\tthis.List.$height -\n\t\t\t\t(this._reserveIds.length - 1) * this.List.type.height;\n\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\tthis.List.add(this._moreBtn);\n\t\t\t\tthis.List.remove(this._reserveIds);\n\t\t\t});\n\t\t}\n\t}\n\n\tExpandData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"up\";\n\n\t\t\tthis.Animate(\"up\");\n\n\t\t\tthis.List.remove(\"$wsh_multi_more\");\n\t\t\tthis.List.parse(this._reserve);\n\t\t}\n\t}\n\n\t// height change and delay for animation\n\tAnimate(mode, height, handler) {\n\t\tthis.List.$view.style.transition = \"height 150ms\";\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, 150);\n\t}\n\n\tSetMoreIcon(mode) {\n\t\tif (!mode) {\n\t\t\tthis.MoreIcon.setHTML(\"\");\n\t\t} else {\n\t\t\tthis._expandState = mode;\n\n\t\t\tconst tooltip = mode === \"up\" ? \"Collapse\" : \"Expand\";\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.MoreIcon.setHTML(\n\t\t\t\t`<div class=\"webix_scheduler_more_icon webix_icon wxi-angle-${mode}\" webix_tooltip=\"${_(\n\t\t\t\t\t`${tooltip} all-day events`\n\t\t\t\t)}\"><div>`\n\t\t\t);\n\t\t}\n\t}\n\n\tShowEvent(id, node) {\n\t\tif (id === \"$wsh_multi_more\") {\n\t\t\tthis.ExpandData();\n\t\t} else {\n\t\t\tconst obj = this.List.getItem(id);\n\t\t\tconst sel = getParams(obj);\n\t\t\tsel.node = node;\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the data object of an event\n\t * @param {(string|number)} id\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.List.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\treturn this.State.date;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MultidayEventList from \"./multiday\";\nimport DayEventsView from \"./events\";\nimport HourscaleView from \"../common/hourscale\";\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class DayView extends JetView {\n\tconfig() {\n\t\tconst header = {\n\t\t\tview: \"template\",\n\t\t\tlocalId: \"header\",\n\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\theight: 32,\n\t\t\ttemplate: obj => {\n\t\t\t\treturn obj.date ? webix.Date.dateToStr(\"%l\")(obj.date) : \"\";\n\t\t\t},\n\t\t};\n\n\t\tconst config = {\n\t\t\tcss: \"webix_scheduler_day\",\n\t\t\trows: [\n\t\t\t\theader,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"multi\",\n\t\t\t\t\thidden: true,\n\t\t\t\t\tcols: [MultidayEventList],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"scroll\",\n\t\t\t\t\tview: \"scrollview\",\n\t\t\t\t\tcss: \"webix_scheduler_day_scroll\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcols: [HourscaleView, DayEventsView],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tconst state = this.app.getState();\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\n\t\tthis.on(state.$changes, \"selected\", v => {\n\t\t\tif (v && !state.clipboard) this.ScrollScale(v);\n\t\t});\n\t}\n\n\tRefreshData(value) {\n\t\tthis.$$(\"header\").setValues({ date: value });\n\n\t\tthis.GetDay(value).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetDay(date) {\n\t\tconst end = webix.Date.add(date, 1, \"day\", true);\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(date, end)\n\t\t\t.then(evs => {\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { multi, single };\n\t\t\t});\n\t}\n\n\tScrollScale(v) {\n\t\tif (v.id === \"0\" && !v.date) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst y = (new Date().getHours() + 2) * 40;\n\t\t\t\tthis.$$(\"scroll\").scrollTo(0, y);\n\t\t\t}, 100);\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class CalendarView extends JetView {\n\tconfig() {\n\t\tthis.Events = {};\n\n\t\treturn {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\tevents: (day, isOutside) => this.MarkEvent(day, isOutside),\n\t\t\ticons: false,\n\t\t\tnavigation: false,\n\t\t\tmonthHeader: false,\n\t\t\tskipEmptyWeeks: true,\n\t\t\twidth: 0,\n\t\t\theight: 410,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Calendar = this.getRoot();\n\t\tthis.Calendar.attachEvent(\"onAfterDateSelect\", date => {\n\t\t\tthis.app.getState().date = webix.Date.dayStart(date);\n\t\t});\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tRefreshData() {\n\t\tlet { start, weeks, data } = this.data;\n\t\tconst end = webix.Date.add(start, weeks, \"week\", true);\n\n\t\tthis.Events = {};\n\n\t\twhile (start < end) {\n\t\t\tconst next = webix.Date.add(start, 1, \"day\", true);\n\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t\tif (\n\t\t\t\t\t(data[i].all_day\n\t\t\t\t\t\t? data[i].end_date >= start\n\t\t\t\t\t\t: data[i].end_date > start) &&\n\t\t\t\t\tdata[i].start_date < next\n\t\t\t\t)\n\t\t\t\t\tthis.Events[start.valueOf()] = true;\n\t\t\tstart = next;\n\t\t}\n\n\t\tthis.Calendar.setValue(this.app.getState().date);\n\t}\n\n\t// adds dots to days with events\n\tMarkEvent(day, isOutside) {\n\t\tlet css = \"\";\n\n\t\tif (!isOutside) css += webix.Date.isHoliday(day) || \"\";\n\t\tif (this.Events[day.valueOf()]) css += \" webix_cal_day_with_event\";\n\n\t\treturn css;\n\t}\n}\n","/* eslint-disable indent */\n\nimport { JetView } from \"webix-jet\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { daysBetweenInclusive } from \"helpers/dates\";\nimport { marker, dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport { initDnD } from \"helpers/dnd\";\n\nexport default class MoreWindowView extends JetView {\n\tconstructor(app, c) {\n\t\tsuper(app);\n\t\tthis.Events = c.events;\n\t\tthis.drag = webix.isUndefined(c.drag) ? true : c.drag;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\twidth: 266,\n\t\t\tpadding: 8,\n\t\t\tminHeight: 70,\n\t\t\trelative: \"right\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_scheduler_more_list\",\n\t\t\t\tborderless: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tyCount: 3,\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate: \"\",\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\twebix_scheduler_month_event: (e, id) => this.ShowEvent(id),\n\t\t\t\t\twebix_scheduler_month_event_single: (e, id) => this.ShowEvent(id),\n\t\t\t\t},\n\t\t\t\ttype: {\n\t\t\t\t\theight: 56,\n\t\t\t\t\ttemplate: (o, c) => this.MoreTemplate(o, c, _),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.Win = view;\n\n\t\tEditRecurringMixin(this);\n\n\t\tif (this.drag) initDnD.call(this, view.getBody(), \"more\", true);\n\t}\n\n\tMoreTemplate(obj, _c, _) {\n\t\tconst i18n = webix.i18n;\n\t\tconst single = !daysBetweenInclusive(\n\t\t\tobj.start_date,\n\t\t\tobj.all_day ? webix.Date.add(obj.end_date, 1, \"day\", true) : obj.end_date\n\t\t);\n\t\tconst style = single ? \"\" : dayEventColor(obj);\n\n\t\tconst oneDay =\n\t\t\t!single && this.webix.Date.equal(obj.start_date, obj.end_date);\n\n\t\tlet css = `webix_scheduler_month_event${single ? \"_single\" : \"\"}`;\n\t\tif (obj.$past) css += \" webix_scheduler_past_event\";\n\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${style}\"\n\t\t\t>\n\t\t\t\t${single ? marker(obj) : \"\"}\n\t\t\t\t<div webix_tooltip=\"${obj.text}\" class=\"webix_event_text\">${obj.text ||\n\t\t\t_(\"(No title)\")}</div>\n\t\t\t\t<div class=\"webix_event_time\">\n\t\t\t\t\t${this.DayFormatStr(obj.start_date)}\n\t\t\t\t\t${\n\t\t\t\t\t\toneDay\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: `${i18n.timeFormatStr(obj.start_date)} -\n\t\t\t\t\t\t${single ? \"\" : \" \" + this.DayFormatStr(obj.end_date)}\n\t\t\t\t\t\t${i18n.timeFormatStr(obj.end_date)}`\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tDayFormatStr(date) {\n\t\treturn webix.Date.dateToStr(\"%F %j\")(date);\n\t}\n\n\tShowEvent(id) {\n\t\tconst obj = this.Events.getItem(id);\n\t\tthis.app.getState().selected = getParams(obj);\n\t\tthis.HideWindow();\n\t}\n\n\tShowWindow(id, node, data) {\n\t\tif (this.ID === id && this.Win.isVisible()) return this.Win.hide();\n\n\t\tthis.ID = id;\n\t\tdata = data.map(v => this.Events.getItem(v));\n\n\t\tconst list = this.Win.getBody();\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.Win.show(node);\n\t}\n\n\tHideWindow() {\n\t\tthis.Win.hide();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MoreWindowView from \"./more\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { marker, dayEventColor, templateStart } from \"helpers/templates\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { daysBetweenInclusive, isToday } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class MonthEventsView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"dataview\",\n\t\t\tcss: \"webix_scheduler_calendar\",\n\t\t\tprerender: true,\n\t\t\txCount: 7,\n\t\t\tyCount: 5,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tscroll: false,\n\t\t\ttooltip: {\n\t\t\t\ttemplate: \"\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_cal_date: (_ev, id) => this.ShowDay(id),\n\t\t\t\twebix_scheduler_month_event: ev => this.ShowEvent(ev),\n\t\t\t\twebix_scheduler_month_event_single: ev => this.ShowEvent(ev),\n\t\t\t\twebix_scheduler_more: (_ev, id) => this.ShowMore(id),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_cal_day: (_e, id) => this.ShowNew(id),\n\t\t\t},\n\t\t\ttype: {\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: \"auto\",\n\t\t\t\ttemplate: (o, c) => this.CalendarTemplate(o, c),\n\t\t\t\ttemplateStart,\n\t\t\t\theaderHeight: 32,\n\t\t\t\teventHeight: 28,\n\t\t\t\tpadding: 8,\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.State = this.app.getState();\n\t\tthis.Calendar = view;\n\t\tview.type.master = this.Calendar;\n\n\t\tSelectionMixin(this, \"month\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.Events = new webix.DataCollection({});\n\t\tthis.MoreWindow = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t})\n\t\t);\n\n\t\tview.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.Calendar, \"month\");\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, view);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\", true); // IE hack\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tCalendarTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tlet html = `<span class=\"webix_cal_date\">${obj.date.getDate()}</span>`;\n\t\tif (obj.$more && obj.$more.length) {\n\t\t\thtml += `<div class=\"webix_scheduler_more\">${obj.$more.length} ${_(\n\t\t\t\t\"more\"\n\t\t\t)}</div>`;\n\t\t}\n\t\treturn html;\n\t}\n\n\tGetDayCss(day, month) {\n\t\tlet css = \"webix_cal_day\";\n\t\tif (isToday(day)) css += \" webix_cal_today\";\n\t\tif (day.getMonth() != month) css += \" webix_cal_outside\";\n\t\telse css += \" \" + (webix.Date.isHoliday(day) || \"\");\n\t\treturn css;\n\t}\n\n\tGetMonthData() {\n\t\tconst data = [];\n\t\tconst { start, weeks } = this.data;\n\t\tconst month = webix.Date.add(start, 1, \"week\", true).getMonth();\n\n\t\tlet day = webix.Date.copy(start);\n\t\tfor (let i = 0; i < weeks * 7; i++) {\n\t\t\tconst obj = {\n\t\t\t\tdate: webix.Date.copy(day),\n\t\t\t\t$css: this.GetDayCss(day, month),\n\t\t\t};\n\n\t\t\tif ((i + 1) % 7 === 0) obj.right = true;\n\t\t\tif (i >= (weeks - 1) * 7) obj.bottom = true;\n\n\t\t\tdata.push(obj);\n\t\t\twebix.Date.add(day, 1, \"day\");\n\t\t}\n\t\treturn data;\n\t}\n\n\tRenderEvents() {\n\t\t// No Events, No Render\n\t\tif (!this.Events.count() || !this.Calendar.count()) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t\tclass: \"webix_scheduler_month_events\",\n\t\t});\n\n\t\tconst { start } = this.data;\n\t\tconst type = this.Calendar.type;\n\t\tconst maxLines = Math.floor(\n\t\t\t(type.height - type.headerHeight + type.padding - 2) /\n\t\t\t\t(type.eventHeight + type.padding)\n\t\t);\n\n\t\tlet wStart = webix.Date.copy(start);\n\t\tlet wEnd = webix.Date.add(wStart, 1, \"week\", true);\n\n\t\tlet html = \"\";\n\t\tlet cache = {};\n\t\tconst me = this.GetTargetDate(this.Calendar.getLastId());\n\t\tconst ms = this.GetTargetDate(this.Calendar.getFirstId());\n\t\tthis.Calendar.data.each(function(day, dayIndex) {\n\t\t\t// next week\n\t\t\tif (day.date >= wEnd) {\n\t\t\t\tcache = {};\n\t\t\t\twStart = wEnd;\n\t\t\t\twEnd = webix.Date.add(wStart, 1, \"week\", true);\n\t\t\t}\n\n\t\t\tconst more = [];\n\t\t\tconst dayHTML = [];\n\t\t\tthis.Events.data.each(function(ev) {\n\t\t\t\tconst id = ev.id;\n\n\t\t\t\t// will not be this week\n\t\t\t\tif (\n\t\t\t\t\tev.start_date >= wEnd ||\n\t\t\t\t\tev.end_date < wStart ||\n\t\t\t\t\t(!ev.all_day && webix.Date.equal(ev.end_date, wStart))\n\t\t\t\t)\n\t\t\t\t\treturn;\n\n\t\t\t\t// if already processed - check and skip\n\t\t\t\tif (!webix.isUndefined(cache[id])) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(day.date <= ev.end_date && ev.all_day) ||\n\t\t\t\t\t\tday.date < ev.end_date\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (cache[id] >= maxLines) {\n\t\t\t\t\t\t\tmore.push(id);\n\t\t\t\t\t\t} else dayHTML[cache[id]] = \"\";\n\t\t\t\t\t} else delete cache[id];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// today\n\t\t\t\tif (\n\t\t\t\t\tev.start_date < webix.Date.add(day.date, 1, \"day\", true) &&\n\t\t\t\t\tev.end_date >= day.date\n\t\t\t\t) {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\t// search for the first available index\n\t\t\t\t\twhile (!webix.isUndefined(dayHTML[index])) index++;\n\n\t\t\t\t\tcache[id] = index;\n\t\t\t\t\tif (index >= maxLines) return more.push(id);\n\n\t\t\t\t\tconst config = { ms, me };\n\t\t\t\t\tconfig.single = this.IsSingleDay(ev);\n\n\t\t\t\t\tconfig.length = 1;\n\t\t\t\t\tif (!config.single) {\n\t\t\t\t\t\tconfig.es = ev.start_date;\n\t\t\t\t\t\tconfig.ee =\n\t\t\t\t\t\t\t!ev.all_day && !webix.Date.timePart(ev.end_date)\n\t\t\t\t\t\t\t\t? webix.Date.add(ev.end_date, -1, \"day\", true)\n\t\t\t\t\t\t\t\t: ev.end_date;\n\n\t\t\t\t\t\tconfig.length += daysBetweenInclusive(\n\t\t\t\t\t\t\t(config.ls = new Date(Math.max(wStart, config.es))),\n\t\t\t\t\t\t\t(config.le = new Date(Math.min(wEnd - 1, config.ee)))\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tconfig.index = dayIndex;\n\t\t\t\t\tdayHTML[index] = this.ToHTML(ev, index, config);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tconst prevLength = day.$more && day.$more.length;\n\t\t\tday.$more = more;\n\t\t\tif (prevLength != more.length) this.Calendar.render(day.id, day, \"paint\");\n\n\t\t\thtml += dayHTML.join(\"\");\n\t\t}, this);\n\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.Calendar.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\tIsSingleDay(ev) {\n\t\tif (ev.all_day)\n\t\t\treturn !daysBetweenInclusive(\n\t\t\t\tev.start_date,\n\t\t\t\twebix.Date.add(ev.end_date, 1, \"day\", true)\n\t\t\t);\n\n\t\tlet len = daysBetweenInclusive(ev.start_date, ev.end_date);\n\n\t\tif (\n\t\t\tlen === 1 &&\n\t\t\twebix.Date.timePart(ev.start_date) &&\n\t\t\t!webix.Date.timePart(ev.end_date)\n\t\t)\n\t\t\tlen = 0;\n\n\t\treturn !len;\n\t}\n\n\tToHTML(obj, index, c) {\n\t\tconst type = this.Calendar.type;\n\t\tconst style = c.single ? \"\" : dayEventColor(obj);\n\t\tconst width = c.length * type.width - type.padding;\n\t\tconst height = type.eventHeight;\n\t\tconst pos = this.GetPosition(type, index, c.index);\n\n\t\tlet extra = \"\";\n\t\tif (c.single) {\n\t\t\textra =\n\t\t\t\tmarker(obj) +\n\t\t\t\t`<span class=\"webix_event_time\">${webix.i18n.timeFormatStr(\n\t\t\t\t\tobj.start_date\n\t\t\t\t)}</span>`;\n\t\t}\n\t\tconst css = this.GetStyle(obj, c);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\twebix_tooltip=\"${obj.text}\"\n\t\t\t\twebix_e_id=\"${obj.id}\"\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"height:${height}px;line-height:${height}px; width:${width}px; ${pos +\n\t\t\tstyle}\">\n\t\t\t\t\t${extra + (obj.text || _(\"(No title)\"))}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj, c) {\n\t\tlet css = `webix_scheduler_month_event${c.single ? \"_single\" : \"\"}`;\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (!c.single) {\n\t\t\tif (c.es < c.ms && webix.Date.equal(c.ms, webix.Date.dayStart(c.ls)))\n\t\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\t\telse if (\n\t\t\t\tc.ee >= webix.Date.add(c.me, 1, \"day\", true) &&\n\t\t\t\twebix.Date.equal(c.me, webix.Date.dayStart(c.le))\n\t\t\t)\n\t\t\t\tcss += \" webix_scheduler_event_break_right\";\n\t\t}\n\t\treturn css;\n\t}\n\n\tGetPosition(type, index, dayIndex) {\n\t\tconst row = Math.floor(dayIndex / this.Calendar.config.xCount);\n\t\tconst col = dayIndex % this.Calendar.config.xCount;\n\n\t\treturn `\n\t\t\ttop:${row * type.height +\n\t\t\t\ttype.headerHeight +\n\t\t\t\tindex * (type.eventHeight + type.padding)}px;\n\t\t\tleft:${col * type.width}px;\n\t\t`;\n\t}\n\n\tRefreshData() {\n\t\tconst { data, weeks } = this.data;\n\n\t\tthis.Events.clearAll();\n\t\tthis.Events.parse(data);\n\t\tthis.Events.sort(function(a, b) {\n\t\t\tconst start_a = webix.Date.dayStart(a.start_date);\n\t\t\tconst start_b = webix.Date.dayStart(b.start_date);\n\n\t\t\tif (webix.Date.equal(start_a, start_b)) {\n\t\t\t\tconst days_a = daysBetweenInclusive(a.start_date, a.end_date);\n\t\t\t\tconst days_b = daysBetweenInclusive(b.start_date, b.end_date);\n\t\t\t\treturn days_b - days_a || a.start_date - b.start_date;\n\t\t\t}\n\t\t\treturn start_a - start_b;\n\t\t});\n\n\t\tconst monthData = this.GetMonthData();\n\n\t\tthis.Calendar.clearAll();\n\t\tif (this.Calendar.config.yCount != weeks) {\n\t\t\tthis.Calendar.define(\"yCount\", weeks);\n\t\t\tthis.Calendar.resize();\n\t\t}\n\t\tthis.Calendar.parse(monthData);\n\t}\n\n\tShowMore(id) {\n\t\tthis.MoreWindow.ShowWindow(\n\t\t\tid,\n\t\t\tthis.Calendar.getItemNode(id),\n\t\t\tthis.Calendar.getItem(id).$more || []\n\t\t);\n\t\treturn false;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.Calendar.$view);\n\t\tif (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.Events.getItem(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tShowNew(id) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = this.GetTargetDate(id);\n\t\t\tstate.selected = { id: \"0\", date };\n\t\t}\n\t}\n\n\tShowDay(id) {\n\t\tconst state = this.app.getState();\n\n\t\tstate.$batch({\n\t\t\tdate: this.GetTargetDate(id),\n\t\t\tmode: \"day\",\n\t\t});\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} id - the ID of the day in the calendar\n\t * @returns\n\t */\n\tGetTargetDate(id) {\n\t\treturn id ? this.Calendar.getItem(id).date : this.State.date;\n\t}\n\n\t/**\n\t * Returns the data object of an event\n\t * @param {(string|number)} id - the ID of the event\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of the event\n\t * @param {Object} newEvent - the data of the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { templateStart } from \"helpers/templates\";\n\nexport default class MonthHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"dataview\",\n\t\t\tcss: \"webix_scheduler_calendar_header\",\n\t\t\txCount: 7,\n\t\t\tyCount: 1,\n\t\t\twidth: 0,\n\t\t\theight: 32,\n\t\t\tscroll: false,\n\t\t\ttype: {\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: \"auto\",\n\t\t\t\ttemplateStart,\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tview.type.master = view;\n\t\tview.parse(this.GetHeaderData());\n\t}\n\n\tGetHeaderData() {\n\t\tconst data = [];\n\t\tconst k = webix.Date.startOnMonday ? 1 : 0;\n\n\t\tfor (let i = 0; i < 7; i++)\n\t\t\tdata.push({ value: webix.i18n.calendar.dayShort[(k + i) % 7] });\n\n\t\tdata[data.length - 1][\"right\"] = true;\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { events, timeStart } from \"helpers/templates\";\nimport { shrinkTo, isMultiDay } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\n\nexport default class MonthListView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst config = {\n\t\t\tview: \"list\",\n\t\t\ttype: {\n\t\t\t\theight: 50,\n\t\t\t\ttemplate: events(_),\n\t\t\t\ttimeStart: ev => this.TimeStart(ev),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ShowEvent(id),\n\t\t\t},\n\t\t};\n\n\t\treturn config;\n\t}\n\tinit() {\n\t\tthis.List = this.getRoot();\n\t\tthis.State = this.app.getState();\n\n\t\twebix.extend(this.List, webix.OverlayBox);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tRefreshData() {\n\t\tconst start = webix.Date.datePart(this.State.date, true);\n\t\tconst end = webix.Date.add(start, 1, \"day\", true);\n\t\tthis.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(start, end)\n\t\t\t.then(evs => {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(evs.map(shrinkTo(start, end)));\n\t\t\t\tthis.ToggleOverlay();\n\t\t\t});\n\t}\n\n\tToggleOverlay() {\n\t\tif (!this.List.count()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.List.showOverlay(_(\"No Events\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tShowEvent(id) {\n\t\tconst obj = this.List.getItem(id);\n\t\tthis.State.selected = getParams(obj);\n\t}\n\n\tTimeStart(ev) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (isMultiDay(ev)) return _(\"All Day\");\n\t\telse return timeStart(ev.start_date, ev.end_date);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MonthListView from \"./list\";\nimport CalendarView from \"./compact\";\nimport MonthEventsView from \"./events\";\nimport MonthHeaderView from \"./header\";\n\nexport default class MonthView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst views = compact\n\t\t\t? [CalendarView, MonthListView]\n\t\t\t: [MonthHeaderView, MonthEventsView];\n\n\t\treturn {\n\t\t\trows: views,\n\t\t};\n\t}\n\tinit() {\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tconst state = this.app.getState();\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\t}\n\tRefreshData(value) {\n\t\tlet start = webix.Date.monthStart(value);\n\t\tlet end = webix.Date.add(start, 1, \"month\", true);\n\n\t\tstart = webix.Date.weekStart(\n\t\t\tnew Date(start.getFullYear(), start.getMonth(), 1)\n\t\t);\n\t\tconst weeks = Math.ceil((end - start) / (24 * 60 * 60 * 1000) / 7);\n\t\tend = webix.Date.add(start, weeks, \"week\", true);\n\n\t\tthis.Data.getEvents(start, end).then(data => {\n\t\t\tif (this.app) this.setParam(\"data\", { start, weeks, data }, true);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BarView extends JetView {\n\tconfig() {\n\t\tconst active = webix.skin.$active;\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst state = this.getParam(\"state\", true);\n\n\t\treturn {\n\t\t\tview: \"toolbar\",\n\t\t\theight: active.barHeight,\n\t\t\telements: [\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlabel: _(\"Timeline scale\"),\n\t\t\t\t\tlabelWidth: 120,\n\t\t\t\t\twidth: 260,\n\t\t\t\t\tvalue: state.timelineMode,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t\t\t\t{ id: \"week\", value: _(\"Week\") },\n\t\t\t\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => {\n\t\t\t\t\t\t\tstate.timelineMode = v;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n}\n","import MoreWindowView from \"../month/more\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD } from \"helpers/dnd\";\n\nexport default class MoreView extends MoreWindowView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.width = 360;\n\t\tui.relative = \"bottom\";\n\n\t\treturn ui;\n\t}\n\n\tinit(view) {\n\t\tthis.Win = view;\n\n\t\tEditRecurringMixin(this);\n\n\t\t// set dnd mode to timeline to allow dnd between more popup and timeline chart\n\t\tinitDnD.call(this, view.getBody(), \"timelineMore\", true);\n\t}\n\n\t/**\n\t * Show the popup with extra events\n\t * @param {(string|number)} id - the ID of a section\n\t * @param {HTMLElement} node - the HTML element of the section from left part of the timeline chart\n\t * @param {Array<Object>} data - an array of events\n\t * @returns\n\t */\n\tShowWindow(id, node, data) {\n\t\tif (this.ID === id && this.Win.isVisible()) return this.Win.hide();\n\n\t\tthis.ID = id;\n\t\tdata = data.map(v => this.Events.getItem(v));\n\n\t\tconst list = this.Win.getBody();\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.Win.show(node, { x: node.clientWidth }); // here we position the popup to the left of the node as well as bottom\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport {\n\tsmallerCount,\n\tgetUnitStart,\n\tgrid,\n\tupdateTask,\n\taddUnit,\n} from \"@xbs/webix-gantt-lib\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { initDnD, switchCursor, locateEvent } from \"helpers/dnd\";\nimport { getParams } from \"helpers/recurring\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport MoreWindowView from \"./more\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst height = this.GetSectionHeight();\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\treturn {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"treetable\",\n\t\t\t\t\tlocalId: \"sections\",\n\t\t\t\t\tcss: \"webix_scheduler_timeline_sections\",\n\t\t\t\t\twidth: compact ? 80 : 200,\n\t\t\t\t\theader: false,\n\t\t\t\t\tscroll: \"y\",\n\t\t\t\t\trowHeight: height,\n\t\t\t\t\tscrollAlignY: false,\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"text\",\n\t\t\t\t\t\t\theader: \"\",\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"list\",\n\t\t\t\t\tlocalId: \"list\",\n\t\t\t\t\ttype: { height, template: \"\" },\n\t\t\t\t\tcss: `webix_scheduler_timeline${\n\t\t\t\t\t\twebix.env.touch ? \"_touch\" : \"\"\n\t\t\t\t\t}_bars`,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_scheduler_timeline_event: e => this.ShowEvent(e),\n\t\t\t\t\t},\n\t\t\t\t\tonDblClick: {\n\t\t\t\t\t\twebix_list_item: (e, id) => this.ShowNew(e, id),\n\t\t\t\t\t},\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: \"\",\n\t\t\t\t\t},\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Tree = this.$$(\"sections\");\n\t\tthis.Bars = this.$$(\"list\");\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.InnerState = this.getParam(\"innerState\", true);\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Events = new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => this.RefreshTask(obj.id),\n\t\t\t},\n\t\t});\n\n\t\tthis.MoreWindow = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t})\n\t\t);\n\n\t\tSelectionMixin(this, \"month\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis._sectionsReady = this.Data.sections().then(data => {\n\t\t\tthis.Sections = data;\n\t\t\tthis.Tree.parse(data);\n\t\t\tthis.Bars.parse(data);\n\t\t});\n\n\t\tthis.HandleScroll();\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData()\n\t\t);\n\t\t// calendars\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"active\", (_v, o) => o && this.RefreshData());\n\n\t\tinitDnD.call(this, this.Bars, \"timeline\");\n\t\tthis._mousemove_handler = webix.event(this.Bars.$view, \"pointermove\", e => {\n\t\t\tif (e.pointerType == \"mouse\") switchCursor(e, this.Bars.$view);\n\t\t});\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.Bars);\n\t}\n\n\turlChange() {\n\t\tconst scales = (this.Scales = this.getParam(\"scales\", true));\n\t\tthis.DrawGrid(scales);\n\t\tthis.RefreshData(scales);\n\t}\n\n\tGetSectionHeight() {\n\t\tconst active = webix.skin.$active;\n\t\tthis._sectionSize = 5;\n\t\treturn (active.barHeight - active.borderWidth * 2) * this._sectionSize;\n\t}\n\n\t/**\n\t * Reloads data into timeline\n\t * @param {Object} scales - current chart scales\n\t */\n\tRefreshData(scales) {\n\t\tif (!scales) scales = this.Scales;\n\t\twebix.promise\n\t\t\t.all([this._sectionsReady, this.Data.getEvents(scales.start, scales.end)])\n\t\t\t.then(res => {\n\t\t\t\tthis.ClearCollections();\n\n\t\t\t\tthis.Events.parse(res[1]);\n\t\t\t\tthis.RenderEvents();\n\t\t\t});\n\t}\n\n\tClearCollections() {\n\t\tthis.Events.clearAll();\n\t\tthis._processed = [];\n\t\tthis._lastRow = {};\n\t\tthis._moreEvents = {};\n\t}\n\n\t/**\n\t * Updates task object with new coordinates and allocates it to the correct position inside a section\n\t * @param {(string|number)} updID - the ID of an event\n\t */\n\tRefreshTask(updID) {\n\t\tconst t = this.GetEvent(updID);\n\n\t\tconst sectionIndex = indexOf(this.Sections.data.order, t.section);\n\t\tif (sectionIndex == -1) {\n\t\t\tt.$hide = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst type = this.State.timelineMode;\n\t\tlet unit = this.GetUnitCount(type);\n\t\tif (type !== \"day\" || type !== \"week\") unit = this.GetUnitCount(unit);\n\n\t\tconst prev = this._processed.find(obj => {\n\t\t\tif (obj.section == t.section) {\n\t\t\t\tif (type === \"day\")\n\t\t\t\t\treturn this.CheckDates(obj.end_date, t.start_date, obj.all_day);\n\n\t\t\t\tconst prev = webix.Date.timePart(obj.end_date)\n\t\t\t\t\t? this.GetUnitStart(unit, webix.Date.add(obj.end_date, 1, unit, true))\n\t\t\t\t\t: obj.end_date;\n\t\t\t\tconst next = this.GetUnitStart(unit, t.start_date);\n\t\t\t\treturn this.CheckDates(prev, next, obj.all_day);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tlet y;\n\t\tif (prev) {\n\t\t\ty = prev.$y;\n\t\t\tthis._processed.splice(\n\t\t\t\tthis._processed.findIndex(p => prev.id == p.id),\n\t\t\t\t1\n\t\t\t);\n\t\t} else {\n\t\t\tif (webix.isUndefined(this._lastRow[t.section]))\n\t\t\t\tthis._lastRow[t.section] = 0;\n\t\t\telse this._lastRow[t.section]++;\n\n\t\t\tif (this._lastRow[t.section] >= this._sectionSize - 1) t.$more = true;\n\t\t\telse t.$more = false;\n\t\t}\n\n\t\tthis.UpdateTask(t, sectionIndex, y);\n\n\t\tthis._processed.push(t);\n\t\tthis._processed.sort((a, b) => a.$y - b.$y);\n\t}\n\n\t/**\n\t * Checks if the start of one event follows the end of the previous one\n\t * @param {Date} prev - the end date of the previous event\n\t * @param {Date} next - the start date of the next event\n\t * @param {Boolean} all_day - the flag that indicates that the previous event is all-day (which means that the end date is really 1 day later)\n\t * @returns {Boolean} true if the start follows the end, false otherwise\n\t */\n\tCheckDates(prev, next, all_day) {\n\t\treturn (all_day ? webix.Date.add(prev, 1, \"day\", true) : prev) <= next;\n\t}\n\n\t/**\n\t * Creates a layer with events\n\t */\n\tRenderEvents() {\n\t\tif (this._DataObj) {\n\t\t\tthis.Bars.$view.firstChild.removeChild(this._DataObj);\n\t\t\tdelete this._DataObj;\n\t\t}\n\n\t\t// No Events, No Render\n\t\tif (!this.Events.count() || !this.Bars.count()) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t});\n\t\tlet html = \"\";\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Events.data.each(obj => {\n\t\t\tif (!obj.$hide) {\n\t\t\t\tif (!obj.$more || this._lastRow[obj.section] == 4) {\n\t\t\t\t\thtml += this.BarsTemplate(obj, _);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this._moreEvents[obj.section]) {\n\t\t\t\t\t\tthis._moreEvents[obj.section] = [];\n\n\t\t\t\t\t\thtml += this.MoreBarTemplate(obj, _);\n\t\t\t\t\t}\n\t\t\t\t\tthis._moreEvents[obj.section].push(obj.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.Bars.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\t/**\n\t * Paints a grid\n\t * @param {Object} scales - scales object as returned by this.Local.getScales()\n\t */\n\tDrawGrid(scales) {\n\t\tconst view = this.Bars;\n\t\tconst colors = { contrast: \"#808080\", dark: \"#384047\" };\n\t\tview.$view.style.backgroundImage = `url(${this.GetGrid(\n\t\t\tscales,\n\t\t\tcolors[webix.skin.$name] || \"#ddd\"\n\t\t)})`;\n\t\tview.$view.style.marginTop = \"0px\";\n\n\t\t// sync grid to scroll position\n\t\tview.$view.style.backgroundPosition = `-${this.InnerState.left}px -${this.InnerState.top}px`;\n\n\t\tthis.Resize(scales.width);\n\t}\n\n\t/**\n\t * Changes the width of the root component (list with bars)\n\t * @param {number} width\n\t */\n\tResize(width) {\n\t\tconst area = this.Bars.$view.querySelector(\".webix_scroll_cont\");\n\t\tarea.style.width = width + \"px\";\n\t\tarea.style.minHeight = \"1px\";\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis.InnerState = this.getParam(\"innerState\", true);\n\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\t\t\tthis.Bars.$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.InnerState.$batch({ top, left });\n\t\t\tthis.Tree.scrollTo(0, top);\n\n\t\t\tthis.MoreWindow.HideWindow();\n\t\t});\n\n\t\tthis.on(this.Tree, \"onScrollY\", function() {\n\t\t\tconst y = this.getScrollState().y;\n\t\t\tthis.$scope.Bars.scrollTo(this.$scope.InnerState.left, y);\n\t\t});\n\t}\n\n\t/**\n\t * Returns a string with HTML of a task node content\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string} a string with HTML of an event bar\n\t */\n\tBarsTemplate(obj, _) {\n\t\tconst style = dayEventColor(obj);\n\t\tconst scales = this.Scales;\n\n\t\tlet w = obj.$w - 2;\n\t\t// all day events last 1 day longer than their end_date\n\t\tif (obj.all_day && obj.end_date < scales.end) {\n\t\t\tw += this.GetUnitWidth(scales, obj.start_date);\n\t\t}\n\n\t\tconst content = `<div class=\"webix_scheduler_timeline_content\">${obj.text ||\n\t\t\t_(\"(no title)\")}</div>`;\n\n\t\tlet css = \"webix_scheduler_timeline_event\";\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tif (obj.start_date < this.Scales.start)\n\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\telse if (obj.end_date > this.Scales.end)\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\tconst tooltip = this.GetTooltip(obj);\n\t\treturn `<div webix_e_id=\"${obj.id}\" \n\t\t\twebix_tooltip=\"${tooltip}\" class=\"${css}\" \n\t\t\tstyle=\"left:${obj.$x}px;top:${obj.$y}px;width:${w}px;height:${obj.$h}px;${style}\">\n\t\t\t${content}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Returns a string with a tooltip for an event\n\t * @param {Object} obj - event data\n\t * @returns {string} a string with HTML of a tooltip\n\t */\n\tGetTooltip(obj) {\n\t\treturn obj.text;\n\t}\n\n\t/**\n\t * Defines the looks and contents of the bar that allows to see events that did not fit into a 5-line section\n\t * @param {Object} obj - the event data\n\t * @param {function} _ - the translator function of the Locale plugin\n\t * @returns {string} with the HTML of the bar\n\t */\n\tMoreBarTemplate(obj, _) {\n\t\tconst text = _(\"Show more\");\n\t\tconst content = `<div class=\"webix_scheduler_timeline_content\" webix_tooltip=\"${text}\">${text}</div>`;\n\t\tconst css = \"webix_scheduler_timeline_event webix_scheduler_multi_more\";\n\n\t\treturn `<div webix_e_id=\"$wsh_multi_more\" webix_r_id=\"${obj.section}\" class=\"${css}\" style=\"left:0px;top:${obj.$y}px;width:100%;height:${obj.$h}px;\">\n\t\t\t${content}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Either shows the selected event in Info or opens the list of extra events in a popup\n\t * @param {MouseEvent} e - a native browser event\n\t * @returns {Boolean} always false to prevent bubbling\n\t */\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.Bars.$view);\n\t\tif (event.id === \"$wsh_multi_more\") {\n\t\t\tconst id = event.node.getAttribute(\"webix_r_id\");\n\t\t\tthis.MoreWindow.ShowWindow(\n\t\t\t\tid,\n\t\t\t\tthis.Tree.getItemNode(id),\n\t\t\t\tthis._moreEvents[id] || []\n\t\t\t);\n\t\t} else if (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.GetEvent(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initiates creating a new event\n\t * @param {MouseEvent} e - a native browser event\n\t * @param {(string|number)} id - the ID of a section\n\t */\n\tShowNew(e, id) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst scales = this.Scales;\n\t\t\tconst start = scales.start;\n\n\t\t\tconst unit = scales.precise\n\t\t\t\t? this.GetUnitCount(scales.minUnit)\n\t\t\t\t: scales.minUnit;\n\t\t\tconst n = Math.floor(e.offsetX / this.GetUnitWidth(scales));\n\t\t\tconst date = this.AddUnit(unit, start, n);\n\n\t\t\tstate.selected = { id: \"0\", date, section: id };\n\t\t}\n\t}\n\n\t/**\n\t * Returns the event data by its ID\n\t * @param {(string|id)} id - the ID of an event\n\t * @returns {Object} the event data\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of an event\n\t * @param {Object} newEvent - the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\tconst clickedUnit = this.mousePosUnit || 0;\n\t\tconst scales = this.Scales;\n\t\treturn this.AddUnit(scales.minUnit, scales.start, clickedUnit);\n\t}\n\n\t/* Method wrappers for gantt-lib functions */\n\n\tGetUnitCount(type) {\n\t\treturn smallerCount[type][0];\n\t}\n\n\tGetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date);\n\t}\n\n\tAddUnit(unit, date, count) {\n\t\treturn addUnit(unit)(date, count);\n\t}\n\n\tGetGrid(scales, color) {\n\t\treturn grid(scales.cellWidth, scales.cellHeight, color);\n\t}\n\n\tUpdateTask(task, sectionIndex, y) {\n\t\treturn updateTask(\n\t\t\ttask,\n\t\t\tthis._lastRow[task.section] + sectionIndex * this._sectionSize,\n\t\t\tthis.Scales,\n\t\t\tthis.Scales.cellHeight - 12,\n\t\t\ty\n\t\t);\n\t}\n\n\tGetUnitWidth(scales, date) {\n\t\tif (\n\t\t\tscales.precise &&\n\t\t\t(scales.minUnit !== \"day\" || scales.minUnit !== \"month\")\n\t\t) {\n\t\t\tconst count = smallerCount[scales.minUnit][1];\n\t\t\tconst number = typeof count === \"number\" ? count : count(date);\n\t\t\treturn Math.floor(scales.cellWidth / number);\n\t\t}\n\t\treturn scales.cellWidth;\n\t}\n}\n\n/**\n * Case-insensitive indexOf\n * @param {Array<any>} arr - the array to be checked\n * @param {any} el - something that you need to find in the array\n * @returns {number} the index of the first found element or -1\n */\nfunction indexOf(arr, el) {\n\tfor (let i = 0; i < arr.length; ++i) {\n\t\tif (arr[i] == el) return i;\n\t}\n\treturn -1;\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ScalesView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\treturn {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\twidth: compact ? 80 : 200,\n\t\t\t\t\tcss: \"webix_scheduler_timeline_space\",\n\t\t\t\t\tborderless: false,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tlocalId: \"scale\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tcss: \"webix_scheduler_timeline_scale\",\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst scale = this.$$(\"scale\");\n\t\tconst innerState = (this.InnerState = this.getParam(\"innerState\", true));\n\t\tthis.on(innerState.$changes, \"left\", x => scale.scrollTo(x, null));\n\t}\n\n\turlChange() {\n\t\tthis.RenderScales();\n\t}\n\n\t/**\n\t * Renders gantt scales\n\t */\n\tRenderScales() {\n\t\tconst scales = this.getParam(\"scales\", true);\n\t\tconst view = this.$$(\"scale\");\n\t\tconst html = scales.rows\n\t\t\t.map(line => {\n\t\t\t\treturn (\n\t\t\t\t\t`<div class=\"webix_scheduler_timeline_scale_row\" style='height:${line.height}px;width:${scales.width}px'>` +\n\t\t\t\t\tline.cells.map(cell => this.CellTemplate(cell, line.type)).join(\"\") +\n\t\t\t\t\t\"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tview.config.height = scales.height;\n\t\tview.setHTML(html);\n\t\tview.resize();\n\t}\n\n\t/**\n\t * Returns the template string for a scale unit\n\t * @param {Object} cell - a scale unit\n\t * @returns {string} - the template string of the scale cell\n\t */\n\tCellTemplate(cell) {\n\t\tconst css = `webix_scheduler_timeline_scale_cell ${cell.css}`;\n\t\treturn `<div class=\"${css}\" style=\"width:${cell.width}px;\">${cell.format(\n\t\t\tcell.date\n\t\t)}</div>`;\n\t}\n\n\tDateIsToday(date) {\n\t\tconst today = webix.Date.dayStart(new Date());\n\t\treturn webix.Date.equal(today, webix.Date.dayStart(date));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport BarView from \"./bar\";\nimport ScaleView from \"./scale\";\nimport ChartView from \"./chart\";\n\nimport {\n\taddUnit,\n\tresetScales,\n\tgetUnitStart,\n\tsmallerCount,\n} from \"@xbs/webix-gantt-lib\";\n\nimport { createState } from \"jet-restate\";\n\nexport default class TimelineView extends JetView {\n\tconfig() {\n\t\tconst ui = {\n\t\t\trows: [BarView, ScaleView, ChartView],\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst innerState = (this.InnerState = createState({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t}));\n\t\tthis.setParam(\"innerState\", innerState, true);\n\n\t\tthis.on(state.$changes, \"date\", v => this.SetScales(v, state.timelineMode));\n\n\t\tthis.on(state.$changes, \"timelineMode\", (t, o) => {\n\t\t\tif (o) this.SetScales(state.date, t);\n\t\t});\n\t}\n\n\tSetScales(date, type) {\n\t\tconst scales = this.ResetScales(type, date);\n\t\tthis.setParam(\"scales\", scales, true);\n\t}\n\n\tGetScalesArray(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn [{ unit: \"hour\", format: \"%H:00\" }];\n\t\t\tcase \"week\":\n\t\t\t\treturn [{ unit: \"day\", step: 1, format: \"%d\" }];\n\t\t\tcase \"month\":\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tunit: \"week\",\n\t\t\t\t\t\tformat: function(start) {\n\t\t\t\t\t\t\tconst parser = webix.Date.dateToStr(\"%d %M\");\n\t\t\t\t\t\t\tconst wstart = webix.Date.weekStart(start);\n\t\t\t\t\t\t\tconst wend = webix.Date.add(\n\t\t\t\t\t\t\t\twebix.Date.add(wstart, 1, \"week\", true),\n\t\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t\t\t\"day\",\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn parser(wstart) + \" - \" + parser(wend);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\tdefault: {\n\t\t\t\tconst unit = this.GetDefaultScaleUnit(type);\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tunit,\n\t\t\t\t\t\tformat: (start, end) => {\n\t\t\t\t\t\t\tconst parser = webix.Date.dateToStr(\"%d %M %YYYY\");\n\t\t\t\t\t\t\treturn parser(start) + \" - \" + parser(end);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t}\n\n\tGetScalesCellWidth(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn 80;\n\t\t\tcase \"week\":\n\t\t\t\treturn 300;\n\t\t\tcase \"month\":\n\t\t\t\treturn 400;\n\t\t\tdefault:\n\t\t\t\treturn 100;\n\t\t}\n\t}\n\n\tGetScalePrecision(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn false;\n\t\t\tcase \"week\":\n\t\t\t\treturn false;\n\t\t\tcase \"month\":\n\t\t\t\treturn true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* Method wrappers for gantt-lib functions */\n\n\tAddUnit(unit, date, step) {\n\t\treturn addUnit(unit)(date, step);\n\t}\n\n\tGetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date);\n\t}\n\n\tResetScales(unit, date) {\n\t\tconst start = this.GetUnitStart(unit, date);\n\t\tconst end = this.AddUnit(unit, start, 1);\n\t\tconst active = webix.skin.$active;\n\t\treturn resetScales(\n\t\t\tstart,\n\t\t\tend,\n\t\t\tthis.GetScalePrecision(unit),\n\t\t\tthis.GetScalesCellWidth(unit),\n\t\t\tactive.barHeight - active.borderWidth * 2,\n\t\t\tthis.GetScalesArray(unit)\n\t\t);\n\t}\n\n\tGetDefaultScaleUnit(type) {\n\t\treturn smallerCount[type][0] || type;\n\t}\n}\n","import DayEventsView from \"../day/events\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD } from \"helpers/dnd\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class UnitEventsView extends DayEventsView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\tif (config) {\n\t\t\tthis.Unit = config.unit;\n\t\t}\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"unitList\",\n\t\t\tcss: \"webix_scheduler_day_events\",\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\ttemplate: \"\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\tcss: \"webix_scheduler_day_scale_item\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_day_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_scheduler_day_scale_item: (_e, h) => this.ShowNew(h),\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"unitList\");\n\n\t\tSelectionMixin(this, \"scale\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.List.$setSize = function(x, y) {\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\tthis.minEventHeight = 62;\n\t\tthis.ParseHours();\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.List.render());\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"units\");\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\tFilterToday(value, to) {\n\t\tconst dayEvents = super.FilterToday(value, to);\n\n\t\treturn dayEvents.filter(obj => {\n\t\t\tif (obj.units) {\n\t\t\t\tconst units = obj.units.split(\",\");\n\t\t\t\tconst unitID = this.Unit.id + \"\";\n\t\t\t\treturn units.indexOf(unitID) !== -1;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tShowNew(h) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = webix.Date.copy(this.Day || state.date);\n\t\t\tconst unit = this.Unit.id;\n\t\t\tdate.setHours(h);\n\t\t\tstate.selected = { id: \"0\", date, unit };\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class UnitsHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\ttype: \"clean\",\n\t\t\tcols: [\n\t\t\t\t{ borderless: false, width: 51 },\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tlocalId: \"header\",\n\t\t\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\t\t\txCount: 1,\n\t\t\t\t\tyCount: 1,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 32,\n\t\t\t\t\tscroll: false,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\twidth: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: obj => obj.value,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Header = this.$$(\"header\");\n\n\t\tthis.Units = this.app.getService(\"local\").units();\n\n\t\tthis.Units.then(unitsCache => {\n\t\t\tthis.Header.sync(unitsCache, () => {\n\t\t\t\tthis.Header.define({ xCount: unitsCache.count() });\n\t\t\t\tthis.Header.resize();\n\t\t\t});\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport SelectionMixin from \"helpers/selection\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\nimport { initDnD } from \"helpers/dnd\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class UnitMultidayList extends JetView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\tif (config) {\n\t\t\tthis.Unit = config.unit;\n\t\t}\n\t}\n\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tautoheight: true,\n\t\t\tscroll: false,\n\t\t\tcss: \"webix_scheduler_multilist\",\n\t\t\ttype: {\n\t\t\t\theight: 36,\n\t\t\t\ttemplate: (obj, common) => this.EventTemplate(obj, common),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: (e, id, node) =>\n\t\t\t\t\tthis.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"multiDayList\");\n\n\t\tthis._expandState = \"down\";\n\t\tthis.maxVisibleLines = 3;\n\n\t\tthis._DataObj = this.List.$view.firstChild;\n\t\tSelectionMixin(this, \"multi\", true);\n\n\t\tthis._moreBtn = {\n\t\t\tid: \"$wsh_multi_more\",\n\t\t\t$css: \"webix_scheduler_multi_more\",\n\t\t};\n\n\t\tthis.on(this.app, \"units:multi:state\", state => {\n\t\t\tif (state !== this._expandState) {\n\t\t\t\tstate === \"down\" ? this.WrapData() : this.ExpandData();\n\t\t\t}\n\t\t});\n\n\t\tinitDnD.call(this, this.List, \"multidayUnits\");\n\t\tEditRecurringMixin(this);\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, this.List, { multi: true });\n\t}\n\n\turlChange() {\n\t\tconst data = this.getParam(\"data\");\n\t\tif (data) {\n\t\t\tconst copy = webix.copy(data.multi);\n\t\t\tconst multi = this.FilterByUnits(copy);\n\t\t\tthis.LimitData(multi);\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(multi);\n\t\t}\n\t}\n\n\tEventTemplate(obj, common) {\n\t\tconst height = common.height - 8;\n\t\tconst size = `height:${height}px; line-height:${height}px; width:calc(100% - 5px);`;\n\t\tconst color = obj.id !== \"$wsh_multi_more\" ? dayEventColor(obj) : \"\";\n\t\tconst css = this.GetStyle(obj);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${color}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj) {\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tif (obj.id == \"$wsh_multi_more\") return css;\n\n\t\tconst date = this.State.date;\n\t\tconst end =\n\t\t\t!obj.all_day && !webix.Date.timePart(obj.end_date)\n\t\t\t\t? webix.Date.add(obj.end_date, -1, \"day\", true)\n\t\t\t\t: obj.end_date;\n\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (obj.start_date < date) css += \" webix_scheduler_event_break_left\";\n\t\tif (end >= webix.Date.add(date, 1, \"day\", true))\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\treturn css;\n\t}\n\n\tLimitData(data) {\n\t\tdelete this._reserve;\n\t\tdelete this._reserveIds;\n\t\tif (data.length > this.maxVisibleLines) {\n\t\t\tconst excess = data.length - 2;\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis._moreBtn.text = `${excess} ${_(\"more\")}`;\n\n\t\t\tif (this._expandState === \"down\") {\n\t\t\t\tthis._reserve = data.splice(2, excess, this._moreBtn);\n\t\t\t} else {\n\t\t\t\tthis._reserve = data.slice(2);\n\t\t\t}\n\n\t\t\tthis._reserveIds = this._reserve.map(d => d.id);\n\n\t\t\tthis.app.callEvent(\"units:multi:state\", [this._expandState, false]);\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tif (this._reserveIds) {\n\t\t\t\tthis._inAnimation = true;\n\t\t\t\tconst height =\n\t\t\t\t\tthis.List.$height -\n\t\t\t\t\t(this._reserveIds.length - 1) * this.List.type.height;\n\t\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\t\tthis.List.add(this._moreBtn);\n\t\t\t\t\tthis.List.remove(this._reserveIds);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tExpandData() {\n\t\tconst expandable = this.List.exists(\"$wsh_multi_more\");\n\t\tif (!this._inAnimation) {\n\t\t\tthis._expandState = \"up\";\n\t\t\tif (expandable) {\n\t\t\t\tthis._inAnimation = true;\n\t\t\t\tthis.Animate(\"up\");\n\n\t\t\t\tthis.List.remove(\"$wsh_multi_more\");\n\t\t\t\tthis.List.parse(this._reserve);\n\t\t\t}\n\t\t}\n\t}\n\n\tAnimate(mode, height, handler) {\n\t\tthis.List.$view.style.transition = \"height 150ms\";\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t}, 150);\n\t}\n\n\tShowEvent(id, node) {\n\t\tif (id === \"$wsh_multi_more\") {\n\t\t\tthis.app.callEvent(\"units:multi:state\", [\"up\", true]);\n\t\t} else {\n\t\t\tconst obj = this.List.getItem(id);\n\t\t\tconst sel = getParams(obj);\n\t\t\tsel.node = node;\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tFilterByUnits(multiEvents) {\n\t\treturn multiEvents.filter(obj => {\n\t\t\tif (obj.units) {\n\t\t\t\tconst units = obj.units.split(\",\");\n\t\t\t\tconst unitID = this.Unit.id + \"\";\n\t\t\t\treturn units.indexOf(unitID) !== -1;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\t/**\n\t * Returns the event object by its ID\n\t * @param {(string|number)} id - the ID of the event\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.List.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for the event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\treturn this.State.date;\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport UnitMultidayList from \"./multidaylist\";\nexport default class UnitMultidayView extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tconst units = this.app.getService(\"local\").units();\n\n\t\tconst more = ui.cols[0];\n\t\tmore.onClick = {\n\t\t\t\"wxi-angle-down\": () =>\n\t\t\t\tthis.app.callEvent(\"units:multi:state\", [\"up\", true]),\n\t\t\t\"wxi-angle-up\": () =>\n\t\t\t\tthis.app.callEvent(\"units:multi:state\", [\"down\", true]),\n\t\t};\n\n\t\tui.cols[1] = { cols: [] };\n\n\t\treturn units.then(unitsCache => {\n\t\t\tconst data = unitsCache.serialize();\n\t\t\tfor (let i = 0; i < data.length; ++i) {\n\t\t\t\tui.cols[1].cols.push(\n\t\t\t\t\tnew (this.app.dynamic(UnitMultidayList))(this.app, {\n\t\t\t\t\t\tunit: data[i],\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn ui;\n\t\t});\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.MoreIcon = this.$$(\"more\");\n\n\t\tthis.on(this.State.$changes, \"date\", () => {\n\t\t\tthis.SetMoreIcon();\n\t\t});\n\n\t\tthis.on(this.app, \"units:multi:state\", (state, animate) => {\n\t\t\tthis.Animate(state, animate ? 150 : 1);\n\t\t});\n\t}\n\n\t/**\n\t * Sets a delay for animation of inner views (collapse/expand)\n\t * @param {string} mode - \"up\" or \"down\" - the direction of the icon\n\t * @param {number} delay - delay in milliseconds\n\t */\n\tAnimate(mode, delay) {\n\t\tsetTimeout(() => {\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, delay);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport HourscaleView from \"../common/hourscale\";\nimport UnitEventsView from \"./events\";\nimport UnitsHeaderView from \"./header\";\nimport UnitMultidayView from \"./multiday\";\n\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class UnitsView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst units = this.app.getService(\"local\").units();\n\n\t\tconst multi = {\n\t\t\tlocalId: \"multi\",\n\t\t\thidden: true,\n\t\t\tcols: [UnitMultidayView],\n\t\t};\n\n\t\tconst days = {\n\t\t\tlocalId: \"scroll\",\n\t\t\tview: \"scrollview\",\n\t\t\tscroll: \"y\",\n\t\t\tcss: \"webix_scheduler_week_days\",\n\t\t\tbody: {\n\t\t\t\tcols: [HourscaleView],\n\t\t\t},\n\t\t};\n\n\t\treturn units.then(unitsCache => {\n\t\t\tconst data = unitsCache.serialize();\n\t\t\tfor (let i = 0; i < data.length; ++i) {\n\t\t\t\tdays.body.cols.push(\n\t\t\t\t\tnew (this.app.dynamic(UnitEventsView))(this.app, {\n\t\t\t\t\t\tunit: data[i],\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\trows: [UnitsHeaderView, multi, days],\n\t\t\t};\n\t\t});\n\t}\n\tinit() {\n\t\tconst state = this.app.getState();\n\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\t}\n\n\tRefreshData(value) {\n\t\tthis.GetDay(value).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetDay(date) {\n\t\tconst end = webix.Date.add(date, 1, \"day\", true);\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(date, end)\n\t\t\t.then(evs => {\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { multi, single };\n\t\t\t});\n\t}\n}\n","import UnitListView from \"../common/unitlist\";\nimport { isToday } from \"helpers/dates\";\n\nexport default class WeekEventsView extends UnitListView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tui.css = \"webix_scheduler_week\";\n\t\tui.type.headerHeight = 28;\n\n\t\treturn ui;\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(this.data.all);\n\t\t\tthis.ToggleOverlay();\n\t\t}\n\t}\n\n\tTemplateHeader(datestring) {\n\t\tconst date = new Date(datestring * 1);\n\t\tconst today = isToday(date);\n\n\t\tconst fstring = `%l, %F <span class='webix_scheduler_monthday${\n\t\t\ttoday ? \" webix_scheduler_today\" : \"\"\n\t\t}'>%j</span>`;\n\n\t\treturn `<span class=\"webix_unit_header_inner\">${webix.Date.dateToStr(\n\t\t\tfstring\n\t\t)(date)}</span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { isToday } from \"helpers/dates\";\n\nexport default class WeekHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\ttype: \"clean\",\n\t\t\tcols: [\n\t\t\t\t{ borderless: false, width: 51 },\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tlocalId: \"header\",\n\t\t\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\t\t\txCount: 7,\n\t\t\t\t\tyCount: 1,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 32,\n\t\t\t\t\tscroll: false,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\twidth: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: obj => {\n\t\t\t\t\t\treturn `<span class=\"webix_scheduler_weekday\">${obj.day}</span> <span class=\"webix_scheduler_monthday\">${obj.date}</span>`;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.RefreshData();\n\t\t}\n\t}\n\n\tRefreshData() {\n\t\tlet start = this.data.start;\n\t\tconst data = [];\n\t\twhile (start < this.data.end) {\n\t\t\tconst obj = {\n\t\t\t\tday: webix.i18n.calendar.dayShort[start.getDay()],\n\t\t\t\tdate: start.getDate(),\n\t\t\t};\n\t\t\tif (isToday(start)) {\n\t\t\t\tobj.$css = \"webix_scheduler_list_today\";\n\t\t\t}\n\t\t\tdata.push(obj);\n\t\t\tstart = webix.Date.add(start, 1, \"day\", true);\n\t\t}\n\n\t\tconst header = this.$$(\"header\");\n\t\theader.clearAll();\n\t\theader.parse(data);\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { daysBetweenInclusive } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class MultiDayEventsView extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.cols[1] = {\n\t\t\tview: \"dataview\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tcss: \"webix_scheduler_multidays\",\n\t\t\tscroll: false,\n\t\t\theight: 32,\n\t\t\txCount: 7,\n\t\t\tyCount: 1,\n\t\t\twidth: 0,\n\t\t\ttype: {\n\t\t\t\twidth: \"auto\",\n\t\t\t\theight: \"auto\",\n\t\t\t\titemHeight: 36,\n\t\t\t},\n\t\t\ttemplate: \"\",\n\t\t\ttooltip: {\n\t\t\t\ttemplate: \"\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tsuper.init();\n\n\t\tSelectionMixin(this, \"multi\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.Events = new webix.DataCollection({});\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"multiday\");\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.ParseDays(this.data.multi);\n\t\t}\n\t}\n\n\tParseDays(events) {\n\t\tif (!events.length) return;\n\n\t\tthis.Events.clearAll();\n\t\tthis.Events.parse(events);\n\n\t\tconst days = [];\n\t\tfor (let d = 0; d < 7; d++) {\n\t\t\tdays.push({\n\t\t\t\tid: d + 1,\n\t\t\t\tdate: webix.Date.add(this.data.start, d, \"day\", true),\n\t\t\t});\n\t\t}\n\t\tthis.BreakEventsByDay(days);\n\n\t\tthis.SetMoreIcon(\n\t\t\tthis._maxEvents > this.maxVisibleLines ? this._expandState : null\n\t\t);\n\n\t\tthis.List.blockEvent();\n\t\tthis.List.parse(days);\n\t\tthis.ResetListHeight();\n\t\tthis.List.unblockEvent();\n\n\t\tthis.RenderEvents();\n\t}\n\n\tBreakEventsByDay(data) {\n\t\tthis.Days = [];\n\t\tconst processed = {};\n\t\tthis._maxEvents = 0;\n\n\t\tdata.forEach((day, dayIndex) => {\n\t\t\tconst today = day.date;\n\t\t\tthis.Days.push([]);\n\n\t\t\tthis.Events.data.each(ev => {\n\t\t\t\tif (!webix.isUndefined(processed[ev.id])) {\n\t\t\t\t\tif ((today <= ev.end_date && ev.all_day) || today < ev.end_date) {\n\t\t\t\t\t\tthis.Days[dayIndex][processed[ev.id]] = \"\";\n\t\t\t\t\t} else delete processed[ev.id];\n\t\t\t\t} else if (\n\t\t\t\t\tev.start_date < webix.Date.add(today, 1, \"day\", true) &&\n\t\t\t\t\tev.end_date >= today\n\t\t\t\t) {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\t// search for the first available index\n\t\t\t\t\twhile (!webix.isUndefined(this.Days[dayIndex][index])) index++;\n\n\t\t\t\t\tprocessed[ev.id] = index;\n\n\t\t\t\t\tconst config = {};\n\t\t\t\t\tconfig.es = ev.start_date;\n\t\t\t\t\tconfig.ee =\n\t\t\t\t\t\t!ev.all_day && !webix.Date.timePart(ev.end_date)\n\t\t\t\t\t\t\t? webix.Date.add(ev.end_date, -1, \"day\", true)\n\t\t\t\t\t\t\t: ev.end_date;\n\n\t\t\t\t\tconfig.length =\n\t\t\t\t\t\t1 +\n\t\t\t\t\t\tdaysBetweenInclusive(\n\t\t\t\t\t\t\t(config.ls = new Date(Math.max(this.data.start, config.es))),\n\t\t\t\t\t\t\t(config.le = new Date(Math.min(this.data.end - 1, config.ee)))\n\t\t\t\t\t\t);\n\n\t\t\t\t\tev.$config = config;\n\t\t\t\t\tthis.Days[dayIndex][index] = ev;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.Days[dayIndex].length > this._maxEvents)\n\t\t\t\tthis._maxEvents = this.Days[dayIndex].length;\n\t\t});\n\t}\n\n\tRenderEvents() {\n\t\tconst allEvents = this.Events.count();\n\n\t\tif (!allEvents) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t});\n\n\t\tlet html = \"\";\n\t\tlet renderedEvents = 0;\n\t\tconst toHide =\n\t\t\tthis._expandState === \"down\" && this._maxEvents > this.maxVisibleLines;\n\n\t\tthis.List.data.each((_day, dayIndex) => {\n\t\t\tconst dayHTML = [];\n\t\t\tconst visible = toHide\n\t\t\t\t? this.maxVisibleLines - 1\n\t\t\t\t: this.Days[dayIndex].length;\n\n\t\t\tfor (let i = 0; i < visible; ++i) {\n\t\t\t\tdayHTML[i] = this.Days[dayIndex][i];\n\n\t\t\t\tif (dayHTML[i]) {\n\t\t\t\t\tdayHTML[i] = this.ToHTML(dayHTML[i], dayIndex, i);\n\t\t\t\t\trenderedEvents++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\thtml += dayHTML.join(\"\");\n\t\t});\n\n\t\tif (toHide) {\n\t\t\thtml += this.MoreOption(allEvents - renderedEvents);\n\t\t}\n\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.List.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\tToHTML(obj, cIndex, rIndex) {\n\t\tconst style = dayEventColor(obj);\n\t\tconst size = this.GetSizePosition(obj.$config.length, cIndex, rIndex);\n\t\tconst css = this.GetStyle(obj, obj.$config);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\twebix_tooltip=\"${obj.text || _(\"(No title)\")}\"\n\t\t\t\twebix_e_id=\"${obj.id}\"\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${style}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj, c) {\n\t\tconst { start, end } = this.data;\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tif (c.es < start && webix.Date.equal(start, webix.Date.dayStart(c.ls)))\n\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\tif (\n\t\t\tc.ee >= end &&\n\t\t\twebix.Date.equal(\n\t\t\t\twebix.Date.add(end, -1, \"day\", true),\n\t\t\t\twebix.Date.dayStart(c.le)\n\t\t\t)\n\t\t)\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\treturn css;\n\t}\n\n\tMoreOption(excess) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst size = this.GetSizePosition(\n\t\t\tthis.List.config.xCount,\n\t\t\t0,\n\t\t\tthis.maxVisibleLines - 1\n\t\t);\n\n\t\treturn `<div webix_e_id=\"$wsh_multi_more\" class=\"webix_scheduler_multiday_event webix_scheduler_multi_more\" style=\"${size}\">${excess} ${_(\n\t\t\t\"more\"\n\t\t)}</div>`;\n\t}\n\n\tGetSizePosition(length, cIndex, rIndex) {\n\t\t// numbers are for space between events and borders of component\n\t\tconst width = length * this.List.type.width - 4;\n\t\tconst height = this.List.type.itemHeight - 8;\n\t\tconst left = this.List.type.width * cIndex + 1;\n\t\tconst top = rIndex * this.List.type.itemHeight + 4;\n\n\t\treturn `width:${width}px; height:${height}px; line-height:${height}px; left:${left}px; top:${top}px;`;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.List.$view);\n\t\tif (event.id) {\n\t\t\tif (event.id === \"$wsh_multi_more\") return this.ExpandData();\n\n\t\t\tconst obj = this.Events.getItem(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tExpandData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\n\t\t\tthis._expandState = \"up\";\n\t\t\tthis.Animate(\"up\");\n\n\t\t\tthis.ResetListHeight(this._maxEvents);\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tconst height =\n\t\t\t\tthis.List.$height -\n\t\t\t\t(this._maxEvents - this.maxVisibleLines) * this.List.type.height;\n\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\tthis.ResetListHeight(this.maxVisibleLines);\n\t\t\t});\n\t\t}\n\t}\n\n\tResetListHeight(count) {\n\t\tif (!count)\n\t\t\tcount =\n\t\t\t\tthis._expandState === \"down\"\n\t\t\t\t\t? Math.min(this._maxEvents, this.maxVisibleLines)\n\t\t\t\t\t: this._maxEvents;\n\n\t\tconst height = count * this.List.type.itemHeight;\n\t\tif (this.List.type.height !== height) {\n\t\t\tthis.List.type.height = height;\n\t\t\tthis.List.define(\"height\", height);\n\t\t\tthis.List.resize();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the data object for an event\n\t * @param {(string|number)} id - the ID of an event\n\t * @returns {Object} - the event object\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} id - the ID of a data item of the main view (corresponds to a day)\n\t * @returns {Date}\n\t */\n\tGetTargetDate(id) {\n\t\treturn id ? this.List.getItem(id).date : this.State.date;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport DayEventsView from \"../day/events\";\nimport WeekHeaderView from \"./header\";\nimport WeekEventsView from \"./compact\";\nimport HourscaleView from \"../common/hourscale\";\nimport MultiDayEventsView from \"./multiday\";\n\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class WeekView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tif (this.Compact) {\n\t\t\treturn {\n\t\t\t\trows: [WeekEventsView],\n\t\t\t};\n\t\t} else {\n\t\t\tconst days = {\n\t\t\t\tlocalId: \"scroll\",\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tscroll: \"y\",\n\t\t\t\tcss: \"webix_scheduler_week_days\",\n\t\t\t\tbody: {\n\t\t\t\t\tcols: [HourscaleView],\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst weekLength = 7;\n\t\t\tfor (let i = 0; i < weekLength; ++i) {\n\t\t\t\tdays.body.cols.push(\n\t\t\t\t\tnew (this.app.dynamic(DayEventsView))(this.app, {\n\t\t\t\t\t\tday: i,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\trows: [\n\t\t\t\t\tWeekHeaderView,\n\t\t\t\t\t{ localId: \"multi\", hidden: true, cols: [MultiDayEventsView] },\n\t\t\t\t\tdays,\n\t\t\t\t],\n\t\t\t};\n\t\t}\n\t}\n\tinit() {\n\t\tconst state = this.app.getState();\n\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\n\t\tif (!this.Compact) {\n\t\t\tthis.on(state.$changes, \"selected\", v => v && this.ScrollScale(v));\n\t\t}\n\t}\n\n\tRefreshData(date) {\n\t\tconst start = webix.Date.weekStart(date);\n\t\tconst end = webix.Date.add(start, 1, \"week\", true);\n\t\tthis.GetWeek(start, end).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetWeek(start, end) {\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(start, end)\n\t\t\t.then(evs => {\n\t\t\t\tif (this.Compact) {\n\t\t\t\t\treturn { start, end, all: evs };\n\t\t\t\t}\n\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn { start, end, multi, single };\n\t\t\t});\n\t}\n\n\tScrollScale(v) {\n\t\tif (v.id === \"0\" && !v.date) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst y = (new Date().getHours() + 2) * 40;\n\t\t\t\tthis.$$(\"scroll\").scrollTo(0, y);\n\t\t\t}, 100);\n\t\t}\n\t}\n}\n","import { ignoreInitial } from \"jet-restate\";\nimport { JetView } from \"webix-jet\";\nimport MoreWindowView from \"../month/more\";\n\nexport default class YearCalendarView extends JetView {\n\tconstructor(app, config) {\n\t\tsuper(app, config);\n\n\t\tthis._month = config.month;\n\t}\n\n\tconfig() {\n\t\tthis.DayEvents = {};\n\n\t\treturn {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\tevents: day => this.MarkEvent(day),\n\t\t\ticons: false,\n\t\t\tnavigation: false,\n\t\t\tcalendarHeader: \"%F\",\n\t\t\tskipEmptyWeeks: true,\n\t\t\tborderless: true,\n\t\t\tonClick: {\n\t\t\t\twebix_cal_day_with_event: e => this.ShowEvents(e),\n\t\t\t\twebix_cal_month: () => this.ShowMonth(),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_cal_day: e => this.ShowNew(e),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonChange: (date, mode) => mode === \"user\" && this.SetStateDate(date),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Calendar = this.getRoot();\n\t\tthis.Events = new webix.DataCollection({});\n\t\tconst state = (this.State = this.app.getState());\n\n\t\tthis.on(state.$changes, \"date\", date => this.ManageDateChange(date));\n\n\t\tthis.on(\n\t\t\tstate.$changes,\n\t\t\t\"active\",\n\t\t\tignoreInitial(() => this.RefreshData(this.GetMonthStart(state.date)))\n\t\t);\n\t\tthis.on(this.app, \"events:refresh\", () =>\n\t\t\tthis.RefreshData(this.GetMonthStart(state.date))\n\t\t);\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(this.GetMonthStart(state.date))\n\t\t);\n\n\t\tthis.Popup = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t\tdrag: false,\n\t\t\t})\n\t\t);\n\t}\n\n\t/**\n\t * Sets the date in the global reactive state\n\t * @param {Date} date\n\t */\n\tSetStateDate(date) {\n\t\tthis.State.date = webix.Date.dayStart(date);\n\t}\n\n\t/**\n\t * Switches the calendar to a new month and gets events for it\n\t * @param {Date} date\n\t */\n\tManageDateChange(date) {\n\t\tif (!this._date || this._date.getFullYear() != date.getFullYear()) {\n\t\t\tlet monthStart = (this.MonthStart = this.GetMonthStart(date));\n\t\t\tthis.Calendar.showCalendar(monthStart);\n\t\t\tthis.RefreshData(monthStart);\n\t\t}\n\t\tif (this._month === date.getMonth()) this.Calendar.setValue(date);\n\t\telse if (this.Calendar.getValue()) this.Calendar.setValue();\n\t\tthis._date = date;\n\t}\n\n\t/**\n\t * Gets the date at the start of the current month\n\t * @param {Date} date\n\t * @returns {Date}\n\t */\n\tGetMonthStart(date) {\n\t\treturn new Date(date.getFullYear(), this._month, 1);\n\t}\n\n\t/**\n\t * Gets events for the given month\n\t * @param {Date} monthStart - the start of the month\n\t */\n\tRefreshData(monthStart) {\n\t\tthis.DayEvents = {};\n\t\tconst monthEnd = webix.Date.add(monthStart, 1, \"month\", true);\n\n\t\tthis.Data.getEvents(monthStart, monthEnd).then(data => {\n\t\t\tthis.Events.clearAll();\n\t\t\tthis.Events.parse(data);\n\t\t\twhile (monthStart < monthEnd) {\n\t\t\t\tlet next = webix.Date.add(monthStart, 1, \"day\", true);\n\t\t\t\tdata.forEach(obj => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(obj.all_day\n\t\t\t\t\t\t\t? obj.end_date >= monthStart\n\t\t\t\t\t\t\t: obj.end_date > monthStart) &&\n\t\t\t\t\t\tobj.start_date < next\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst dateKey = monthStart.valueOf();\n\t\t\t\t\t\tif (!this.DayEvents[dateKey]) this.DayEvents[dateKey] = [];\n\t\t\t\t\t\tthis.DayEvents[dateKey].push(obj.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmonthStart = next;\n\t\t\t}\n\t\t\tthis.Calendar.refresh();\n\t\t});\n\t}\n\n\t/**\n\t * Adds dots to days with events\n\t * @param {Date} day - the date\n\t * @returns {string} the name of the CSS class\n\t */\n\tMarkEvent(day) {\n\t\tlet css = webix.Date.isHoliday(day) || \"\";\n\t\tif (this.DayEvents[day.valueOf()]) css += \" webix_cal_day_with_event\";\n\t\treturn css;\n\t}\n\n\t/**\n\t * Returns a timestamp of the day that was clicked\n\t * @param {MouseEvent} e - the mouse event\n\t * @returns {number|null} the timestamp or null\n\t */\n\tGetDay(e) {\n\t\tconst day = e.target.innerHTML;\n\t\tif (day) return new Date(this.MonthStart).setDate(day * 1);\n\t\treturn null;\n\t}\n\n\t/**\n\t * Shows a popup with a list of events for the day\n\t * @param {MouseEvent} e - the mouse event\n\t */\n\tShowEvents(e) {\n\t\tconst date = this.GetDay(e);\n\t\tif (date) {\n\t\t\tconst data = this.DayEvents[date];\n\t\t\tthis.Popup.ShowWindow(date, e.target.parentNode, data || []);\n\t\t}\n\t}\n\n\t/**\n\t * Opens this day and opens the form with data for a new event\n\t * @param {MouseEvent} e - the mouse event\n\t */\n\tShowNew(e) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = this.GetDay(e);\n\t\t\tif (date) {\n\t\t\t\t// no $batch because view needs to be ready\n\t\t\t\tstate.mode = \"day\";\n\t\t\t\tstate.selected = { id: \"0\", date };\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Opens the month view for the selected month\n\t */\n\tShowMonth() {\n\t\tthis.State.$batch({\n\t\t\tmode: \"month\",\n\t\t\tdate: this.MonthStart,\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport YearCalendarView from \"./calendar\";\n\nexport default class YearView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\tpadding: 20,\n\t\t\t\tview: \"flexlayout\",\n\t\t\t\tcss: \"webix_scheduler_year\",\n\t\t\t\tcols: this.GetCalendars(),\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Creates 12 calendars for each month of the current year\n\t * @returns {Array} an array of calendar views\n\t */\n\tGetCalendars() {\n\t\tconst calendars = [];\n\t\tfor (let i = 0; i < 12; i++) {\n\t\t\tcalendars.push(\n\t\t\t\tnew (this.app.dynamic(YearCalendarView))(this.app, { month: i })\n\t\t\t);\n\t\t}\n\t\treturn calendars;\n\t}\n}\n","/*Thai (Thailand) locale\n * modified to use Budhist Era Years\n */\n\nwebix.i18n.locales[\"th-TH\"] = {\n   groupDelimiter: \",\",\n   groupSize: 3,\n   decimalDelimiter: \".\",\n   decimalSize: 2,\n   dateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(`%j/%m/${date.getFullYear() + 543}`);\n      return format(date);\n   },\n   timeFormat: \"%G:%i\",\n   longDateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(`%j %F ${date.getFullYear() + 543}`);\n      return format(date);\n   },\n   fullDateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(\n         `%j %F ${date.getFullYear() + 543} %G:%i`\n      );\n      return format(date);\n   },\n   am: [\"am\", \"AM\"],\n   pm: [\"pm\", \"PM\"],\n   price: \"{obj}\",\n   priceSettings: {\n      groupDelimiter: \",\",\n      groupSize: 3,\n      decimalDelimiter: \".\",\n      decimalSize: 2,\n   },\n   calendar: {\n      monthFull: [\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n      ],\n      monthShort: [\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n      ],\n      dayFull: [\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n      ],\n      dayShort: [\".\", \".\", \".\", \".\", \".\", \".\", \".\"],\n   },\n   aria: {\n      dateFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(\n            `%d %F ${date.getFullYear() + 543}`\n         );\n         return format(date);\n      },\n      monthFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(`%F ${date.getFullYear() + 543}`);\n         return format(date);\n      },\n      yearFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(`${date.getFullYear() + 543}`);\n         return format(date);\n      },\n   },\n};\n","import tinymce from \"tinymce\";\nimport \"tinymce/icons/default\";\nimport \"tinymce/themes/silver\";\nimport \"tinymce/plugins/link\";\nimport \"tinymce/skins/ui/oxide/skin.min.css\";\nimport \"tinymce/skins/ui/oxide/content.css\"; // content.min.css ?\nimport \"tinymce/skins/content/default/content.min.css\";\n\nwebix.protoUI(\n   {\n      name: \"tinymce-editor\",\n      defaults: {\n         config: { theme: \"silver\", statusbar: false },\n         value: \"\",\n      },\n      $init: function () {\n         webix.html.addStyle(\".tox-tinymce{ border:0px !important}\");\n\n         this._mce_id = \"webix_mce_\" + (this.config.id || webix.uid());\n         this.$view.innerHTML =\n            \"<textarea id='\" +\n            this._mce_id +\n            \"' style='width:100%; height:100%'></textarea>\";\n\n         this._waitEditor = webix.promise.defer();\n\n         this.$ready.push(this._require_tinymce_once);\n      },\n      render: function () {\n         this._set_inner_size();\n      },\n      _require_tinymce_once: function () {\n         var c = this.config;\n\n         if (c.cdn === false || window.tinymce) {\n            this._init_tinymce_once();\n            return;\n         }\n\n         var apiKey = c.apiKey ? c.apiKey : \"no-api-key\";\n         var cdn =\n            c.cdn ||\n            \"https://cdn.tiny.cloud/1/\" + apiKey + \"/tinymce/5.0.14-54\";\n\n         //path to tinymce codebase\n         window.tinyMCEPreInit = {\n            query: \"\",\n            base: cdn,\n            suffix: \".min\",\n         };\n\n         webix\n            .require([cdn + \"/tinymce.min.js\"])\n            .then(webix.bind(this._init_tinymce_once, this))\n            .catch(function (e) {\n               console.log(e);\n            });\n      },\n      _init_tinymce_once: function () {\n         if (!tinymce.dom.Event.domLoaded) {\n            // woraround event logic in tinymce\n            tinymce.dom.Event.domLoaded = true;\n         }\n\n         var editor_config = webix.copy(this.config.config || {});\n         webix.extend(\n            editor_config,\n            {\n               selector: \"#\" + this._mce_id,\n               resize: false,\n            },\n            true\n         );\n\n         var custom_setup = editor_config.setup;\n         editor_config.setup = webix.bind(function (editor) {\n            if (custom_setup) custom_setup(editor);\n            editor.on(\"init\", webix.bind(this._mce_editor_ready, this), true);\n         }, this);\n\n         webix.delay(function () {\n            tinymce.init(editor_config);\n         }, this);\n      },\n      _mce_editor_ready: function (event) {\n         this._editor = event.target;\n\n         this.setValue(this.config.value);\n         this._set_inner_size();\n         this._waitEditor.resolve(this._editor);\n      },\n      _set_inner_size: function () {\n         if (this._editor) {\n            this.$view.querySelector(\".tox-tinymce\").style.height =\n               this.$height + \"px\";\n         }\n      },\n      $setSize: function (x, y) {\n         if (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n            this._set_inner_size();\n         }\n      },\n      setValue: function (value) {\n         this.config.value = value;\n         this._waitEditor.then(function (editor) {\n            editor.setContent(value);\n         });\n      },\n      getValue: function () {\n         return this._editor ? this._editor.getContent() : this.config.value;\n      },\n      focus: function () {\n         this._waitEditor.then(function (editor) {\n            editor.focus();\n         });\n      },\n      getEditor: function (wait) {\n         return wait ? this._waitEditor : this._editor;\n      },\n   },\n   webix.ui.view\n);\n","/**\n * webixResources.js\n * This file should include all extra webix resources (components, locales, etc.)\n * This will be bundeled by webpack into a single file and loaded as a dynamic\n * import after webix is loaded.\n *\n * Notes:\n * - use `webpackMode: \"eager\"` comment to include the dynamic import in this\n *   package\n */\n\n// CSS\nimport \"./components/gantt/gantt.min.css\";\nimport \"./components/reports/reports.min.css\";\nimport \"./components/query/query.min.css\";\nimport \"./components/scheduler/scheduler.min.css\";\nimport \"./components/querybuilder/querybuilder.min.css\";\nimport \"./components/hint/hint.css\";\n\n// Components\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/gantt/gantt.min.js\"\n).then((gantt) => (window.gantt = gantt));\nimport \"./components/hint/hint.js\";\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/kanban/kanban.min.js\"\n).then((kanban) => (window.kanban = kanban));\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/pivot/pivot.min.js\"\n).then((pivot) => (window.pivot = pivot));\nimport \"./components/query/query.min.js\";\n// Should use webix/query, querybuilder no longer maintained\n// But we still use this in some places (processing record rules, etc)\nimport \"./components/querybuilder/querybuilder.min.js\";\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/reports/reports.min.js\"\n).then((report) => (window.reports = report));\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/scheduler/scheduler.min.js\"\n).then((scheduler) => (window.scheduler = scheduler));\n\n// Extras\nimport \"./extras/tinymce\";\n\n// Locales\nimport \"./locales/th-TH.js\";\n"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","id","module","exports","webix","config","this","webixJet","_events","_subs","_data","params","extend","JetBase","_root","_detachEvents","_destroySubs","_container","app","_parent","value","url","_segment","update","show","parent","view","getParentView","getParam","suburl","toString","root_1","getRoot","queryView","obj","localId","$scope","name","attachEvent","push","key","kid","contains","sub","getSubViewInfo","subview","popup","events","i","length","detachEvent","subView","destructor","current","default","branch","child","_getDefaultSub","_routed_view","parse","substr","parts","split","chunks","test","result","pos","indexOf","params_1","_i","dchunk","decodeURIComponent","page","isNew","url2str","stack","stack_1","chunk","obj2str","join","str","encodeURIComponent","c","route","index","_next","path","Route","slice","setParams","old","kids","reset","concat","_join","Promise","res","rej","redirect","confirm","callEvent","catch","err","then","NavigationBlocked","_this","n","_super","_children","__extends","JetView","ui","container","jetview","createView","render","setParam","parent_1","target","_renderFrameLock","_show","segment","_init_url_data","_urlChange","linkRouter","getRouter","set","silent","_$view","_$","_$url","message","destroy","_destroyKids","plugin","getUrl","tagName","refresh","_render","root","r","document","body","toNode","cfg","_render_final","response","slot","$$","reject","copyConfig","oldui","parent_2","asWin","setPosition","isVisible","_init","_initUrl","ready","_initError","init","waits","frame","wait","all","urlChange","lock","_renderFrame","next","_createSubView","shift","_override","error","createFromURL","uis","_ui","JetViewRaw","cb","SubRouter","a","append","_once","t","window","version","start","_services","EventSystem","JetAppBase","_subSegment","handler","getSubView","prototype","$subview","addSubView","isArray","Array","method","point","DataCollection","RegExp","Map","Date","copy","$router","srcElement","getAttribute","trigger_1","_forView","trigger","cancelBubble","preventDefault","route_1","parentNode","clickHandler","views","_loadError","hidden","replace","require","__esModule","loadView","over","override","dv","get","router","rest","apply","data","bind","er","debug","console","text","innerHTML","type","expire","event","_first_start","top","base","setTimeout","animation","node_1","html","addCss","removeCss","now","urlString","template","uid","_detectPrefix","onpopstate","HashRouter","routes","compare","history","pushState","prefix","sufix","_getRaw","routerPrefix","location","href","isPatched","patch","w","win","promise","freeze","some","$freeze","resize","baseAdd","baselayout","addView","baseRemove","removeView","jview_1","subs_1","arguments","subs","layout","protoUI","$init","$app","$ready","proxy","JetApp","UrlRouter","pathname","search","_$config","EmptyRouter","has","store","Object","hasOwnProperty","call","forEach","context","warn","x","String","russianPluralGroups","end","pluralTypes","arabic","lastTwo","bosnian_serbian","chinese","croatian","french","german","russian","lithuanian","czech","polish","icelandic","slovenian","pluralTypeToLanguages","escape","token","dollarRegex","defaultTokenRegex","transformPhrase","phrase","substitutions","locale","tokenRegex","TypeError","interpolationRegex","options","smart_count","texts","count","ret","langToPluralType","langs","lang","en","pluralTypeName","expression","argument","Polyglot","opts","phrases","currentLocale","allowMissing","onMissingKey","suffix","RangeError","interpolation","newLocale","morePhrases","prefixedKey","unset","clear","newPhrases","_","webixPolyglot","plugins","_view","storage","setLangData","pconfig","polyglot","poly","service","put","locName","i18n","setLocale","setLang","getLang","setService","once","setSize","appView","appWidth","$width","appHeight","$height","_fillApp","define","width","height","left","setHandlers","$destructed","$view","enable","resizeEv","link","source","defineProperty","createState","handlers","out","observe","mask","queue","waitInQueue","notify","meta","list","enumerable","configurable","values_1","sconfig","nested","reactive","$extend","val","valueOf","DragScroll","ctx","_auto_scroll_delay","delay","autoScroll","clearTimeout","yScroll","direction","xScroll","box","offset","from","autoYScroll","senseY","autoXScroll","senseX","DragControl","active","node","getNode","$dragPos","style","y","sense","scroll","getScrollState","autoScrollTo","snode","Math","min","scrollWidth","mode","scrollTo","abs","initDnD","ctrl","master","Local","getService","addDrag","addDrop","getMoveMode","rect","getBoundingClientRect","p","minWidth","env","touch","delta","updateDragScrollConfig","ds","scales","getScales","round","cellWidth","cellHeight","$longTouchLimit","$dragCreate","pointer","State","readonly","getContext","$touch","locateEvent","item","getItem","$group","classList","Modes","getItemNode","scroll_1","evContext","getEventContext","step","precise","nsc","getSmallerCount","minUnit","dx","querySelector","parseInt","l","dragScroll","cloneNode","className","visibility","cursor","appendChild","display","$dragDestroy","$waitUpdate","Action","action","finally","remove","$dragIn","s","$dragOut","$drop","time","timeShift","ev","elementFromPoint","locate","changedTouches","touches","pageX","pageY","clientX","clientY","setDragOffset","x_offset","y_offset","nscroll","max","links","css","fromStart","opacity","create","toStart","linkType","targetId","move","progress","prevProgress","progressNode","updateTaskTemplate","zIndex","boxShadow","contrast","dark","skin","$name","isUndefined","DragProgressTemplate","selection","class","tb","floor","offsetX","getIdByIndex","dates","BarsView","borderless","cells","relative","BarsType","on","onItemClick","ItemClickHandler","tooltip","GetTooltip","_a","getChildViews","holidays","bars","Holidays","Links","Bars","Ops","Helpers","local","linkCollection","ldata","LinksData","Calendars","resourceCalendars","HandleScroll","HandleDrag","HandleSelection","InitMarkers","HandleHolidays","$changes","v","SyncData","refreshLinks","RefreshLinks","RenderResourceHolidays","DrawGrid","VisibleTasks","ApplySelection","o","showCriticalPath","assignments","excludeHolidays","task","tasks","updateAssignedTaskDates","updateScaleMinMax","$batch","selected","backgroundImage","drawGridInner","marginTop","state","getState","backgroundPosition","Resize","unselect","clearAll","getVisibleTasksCollection","taskCalendarMap","sync","$data","GetSplitBox","top_1","html_1","order","isLast_1","TemplateStart","BarsTemplate","TemplateEnd","templateStart","isLast","templateEnd","last","first","$x","$w","rwidth","$y","$h","h","diff","BarCSS","contentCss","ContentCss","ceil","sqrt","pow","drag","baseline","planned_start","TemplateBaseline","$x0","$w0","$critical","_mousemove_handler","pointerType","eventRemove","_scroll_handler","markers","m","$interval","clearInterval","temp","scrollTop","scrollLeft","holidaysContainer","containerForMarkers","lines","GetLinks","attrs","viewBox","scrollHeight","setAttribute","SetHolidaysScroll","resources","resourcesDiagram","resHolidaysContainer","selLine","insertBefore","firstChild","ind","getIndexById","exists","ScrollToTask","RenderMarkers","start_date","setInterval","GetMarkerPosition","MarkerTemplate","date","astart","getUnitStart","startOnMonday","links_1","each","$p","critical","criticalPath","isLinkCritical","LinksTemplate","setHTML","tid","find","updateLink","area","minHeight","ops","inProgress","updateTaskTime","refreshTasks","RefreshTaskLinks","updateTask","addLink","newLink","top_2","shift_1","points","map","unit","getSmallerUnit","addUnit","splitCont","sort","b","_b","RenderHolidays","func","dayStart","add","hourOffset","getHours","equal","timePart","html_2","EachScaleDate","isHoliday","HolidayTemplate","calendar","dateStart","isResourceHoliday","ResourceHolidayTemplate","ResourceWorkDayTemplate","taskId","MarkResourceHolidays","GetDateBox","parser","longDateFormatStr","tip","end_date","duration","ScalesView","RenderScales","rows","line","canMarkHolidays","cell","CellTemplate","FormatDate","format","dateToStr","ChartView","ScaleView","hide","DiagramView","WorkloadMarkersType","filterMode","showSubItems","level","LocalState","Unit","Scales","RDCollection","getRDCollection","RestoreTreeState","filter","ToggleBranch","by","dir","as","open","close","getBranch","opened","_treeOpened","clientHeight","t_1","openAll","u","common","MarkerStartTemplate","classname","aria","$level","GetMarkerData","MarkerToHTML","resId","resource_id","calendarId","calendar_id","calendars","d","hourParts","units","markerWidth","halfStep","CheckResourceHoliday","hours","overloaded","CheckOverload","marker","unitLoadNorm","day","number","localeCompare","ignorePunctuation","numeric","arrayEquals","every","includes","TreeView","compact","Compact","columns","header","TreeTemplate","fillspace","batch","tree","prerender","treeWidth","rowHeight","headerRowHeight","scrollAlignY","resizeColumn","headerOnly","size","onViewResize","Tree","onAfterOpen","onAfterClose","onAfterSort","SortTasks","onColumnResize","user","NormalizeColumns","onClick","gti-menu","ToggleColumns","ls","_unit","_collapsed","ShowInUnits","col","columnId","getColumnConfig","refreshColumns","icon","treetable","category","resourceAvatar","space","cols","lastFillspace","showColumnBatch","SetColumns","getColumnIndex","lv","isColumnVisible","cv","vis","hideColumn","showColumn","RDiagramView","elements","onChange","localState","radio","words","BaselineView","icons","autoheight","elementsConfig","labelPosition","padding","right","visibleBatch","label","suggest","autowidth","click","AddBtnClickHandler","RemoveBtnClickHandler","UpdateTaskTime","UpdateTask","Form","Tasks","FillData","showBatch","setValues","vals","f","_eventSource","$eventSource","updateDates","planned_end","planned_duration","getValues","PrepareDates","updatePlannedTaskDuration","blockEvent","unblockEvent","TableView","table","editable","hover","scheme","ttype","conf","collection","editor","onBeforeEditStart","onBeforeEditStop","UpdateLink","row","onAfterLoad","wxi-trash","title","DeleteLink","$active","layoutMargin","form","bottom","_id","related","getLinks","editCancel","updateItem","removeLink","editors","gantt_numeditor","inp","ResourcesView","single","IsSingle","button","editaction","ResourceTemplate","listItemHeight","OptionTemplate","EditorOptionTemplate","ValueTemplate","editFormat","parseFloat","editParse","isNaN","DeleteIconTemplate","Table","column","editRow","getEditor","getPopup","focus","addCellCss","resource","FilterOptions","onAfterEditStart","getInputNode","range","GetRange","ApplyEditorLimits","GetValueStep","ApplyEditorStep","removeCellCss","ApplyValueRange","UpdateAssignment","webix_gantt_remove_icon","RemoveAssignment","margin","Resources","getAssignments","assignees","GetData","disable","sortResources","tableIds","rInd","updateAssignment","CloseEditor","resourceItem","getResourceValueRange","getResourceValueStep","removeAssignment","ShowPopup","addAssignment","getDefaultResourceValue","EditorTemplate","GetUnitName","getResourceUnit","fitMaster","AddAssignment","Popup","GetPopupConfig","SetPopupPlaceholder","placeholder","getBody","FormView","isResources","aSkin","bar","layoutPadding","inputHeight","Close","Done","types","projects","splice","accItems","collapsed","accordion","multi","ToggleControls","typeSelect","SetResourceHolidays","SetBaselineVisibility","typeList","getList","$count","LimitTypeOptions","SetResourcesVisibility","RemoveTagsFromText","updateTaskDuration","_inProgress","isDirty","Back","exit","edit","arr","els","getTaskCalendar","el","TaskView","editButton","EditTask","info","InfoTemplate","deleteButton","align","inputWidth","DeleteTask","Text","FillTemplate","sources","targets","removeTask","BaseTemplate","LinkTemplate","BaselineTemplateChunk","details","DateFormat","InfoTemplateChunk","ResourcesTemplateChunk","maxWidth","s0","getTextSize","s1","avatar","dpt","TaskPopup","updateConfig","fullscreen","head","maxAvatarNumber","TitleTemplate","dateFormatStr","ResourcesTemplate","unshift","select","wxi-plus","AddTask","wxi-plus-circle","onBeforeOpen","HandleToggle","onBeforeSelect","BeforeSelectHandler","onBeforeDrag","BeforeDragHandler","onBeforeDrop","BeforeDropHandler","Mode","Assignments","pid","$dragHTML","moveTask","resDisplayed","clearEvID","RefreshData","loaders","waitData","GetLoaders","ApplySorting","getSelectedId","pdata","_isTaskVisible","showItem","setState","newTask","GetNewTask","AddTaskWithAssignment","assigned","SplitTaskWithAssignment","splitTaskWithDnd","addTask","GetDates","waitArr","getParentId","rId","sibling","aops","dataSorter","sortState","RefreshTasks","assigned_1","GetAssignmentsHTML","assignedArr","num","pop","lastStr","numStr","TopView","sizeTrigger","_compactValue","_compactHandler","_app","_forceCompact","forceCompact","_compactWidth","compactWidth","_checkTrigger","$setSize","fCompact","SetCompactMode","oid","ShowTask","HideTask","ProgressBar","showProgress","hideProgress","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","resetScales","dateToLocalStr","parseFormat","scaleStart","scaleEnd","oldScale","_scales","_scaleBase","setScales","_taskHeight","refreshResourceTasks","preciseTimeUnit","scaleCellWidth","barHeight","borderWidth","force","_tasks","createTasks","getTreeData","TreeCollection","data->onStoreLoad","data->onStoreUpdated","_links","$change","parseFormatDate","$css","$sort","$serialize","taskOut","$export","updID","k","refreshBaseline","createLinks","found","tcollection","taskParent","$parent","taskSplit","_categories","categories","_resources","rData","ctg","_assignments","aCopy","assign","_calendars","createCalendars","weekDays","datePart","clean","getRange","latestDate_1","isTaskCritical","latestDate","dependent","isNoSlack","nextStart","currentEnd","g","getResourceTree","_calendarMap","refreshCalendarMap","cal","grouping","collections","Infinity","_url","Backend","ajax","json","post","del","_local","_helpers","_back","_state","Operations","addMode","cleanData","added","adjustScale","completeAdd","position","syncProject","inner","updatePlanned","removeAssignments","syncTasks","field","_updatePlannedTaskDuration","change","getWorkDateDiff","p_1","eachSubItem","newDate","changedKid","sign","ad","setProjectData","offsetDate","us","completeRemoval","linkExists","duplicate","oldParent","oldIndex","getBranchIndex","reorderTask","collection_1","waitArr_1","toInteger","dirtyNumber","NaN","Number","requiredArgs","required","args","toDate","argStr","getTime","addDays","dirtyDate","dirtyAmount","amount","setDate","getDate","addMonths","dayOfMonth","endOfDesiredMonth","setMonth","getMonth","setFullYear","getFullYear","addMilliseconds","timestamp","startOfWeek","dirtyOptions","localeWeekStartsOn","weekStartsOn","defaultWeekStartsOn","getDay","setHours","getTimezoneOffsetInMilliseconds","utcDate","UTC","getMinutes","getSeconds","getMilliseconds","setUTCFullYear","startOfDay","compareAsc","dirtyDateLeft","dirtyDateRight","dateLeft","dateRight","differenceInCalendarMonths","monthDiff","differenceInCalendarYears","differenceInMilliseconds","roundingMap","trunc","getRoundingMethod","endOfDay","endOfMonth","month","isLastDayOfMonth","differenceInMonths","difference","isLastMonthNotFull","year","isLastYearNotFull","quarter","roundingMethod","week","startOfWeekLeft","startOfWeekRight","timestampLeft","timestampRight","startOfDayLeft","startOfDayRight","hour","minute","smallerCount","months","days","innerDiff","prev","wt","filled","getDiff","sameMonth","daysOfFirstMonth","me","setSizes","taskHeight","startDate","endDate","ms","getMilestone","getEnd","getEndWorkday","setMinutes","setSeconds","setMilliseconds","holidayGuard","getDuration","toFixed","toClosestWorkday","notRight","alert","toWorkday","getCheckDate","getTimezoneOffset","defaultResourceUnit","defaultResourceValues","resourceValueRanges","resourceValueSteps","initials","match","charAt","toUpperCase","charCodeAt","cssClass","withTooltip","txt","avatarCss","inc","getTaskHeight","len","tempEnd","fullWidth","fullHeight","countInWeeks","cdate","cnext","startTask","endTask","dy","s_start","e_start","sx","sy","ex","ey","lineCoords","gapp","sx1","ex1","same","arrowCoords","color","canvas","createElement","strokeStyle","moveTo","lineTo","stroke","toDataURL","helpers","closedResources","Grouping","_rdCollection","Group","syncRDWithData","getDiagramItemData","groupResourceDiagram","refreshTaskDiagram","updateUnitDurations","updateTaskDiagram","refreshResourceDiagram","assignment","calculateUnitDuration","calculateLoad","truncateX","getUnitLoad","startUnitEnd","load","startUnitStart","endUnitStart","days_1","findUnitDuration","days_2","plusUnit","getDifference","checkHoliday","pruneDiagram","rec","oa","toRemove","eachLeaf","group","collect","_resourcesTree","resourceTaskLoader","syncResourceTree","task_1","tasksWithResources","getResourceTaskData","eachChild","inTree","becomesTask","pId","refreshResourceTree","unassignedBranch","checkResourceOpen","property","ws","sum","j","appId","defaults","dynamic","appNode","addStyle","firstShow","defaultHandler","onShow","use","App","locales","$exportView","export_mode","reload","jetapp","services","Edit","Delete task","Delete link","The task will be deleted permanently, are you sure?","The link will be deleted permanently, are you sure?","Predecessors","Successors","Title","Start date","End date","Duration","Progress","Notes","Type","Project","Milestone","Add task","Add project","(no title)","Save changes?","Related tasks","Task","Link","End to start","Start to start","End to end","Start to end","Lasts","Add assignment","Assignment","Assigned","Delete assignment","Are you sure to delete this assignment?","No resources to add","Unassigned","Hours per","Tasks per","Name","Hours","Split task","Planned dates","Planned dates will be removed, are you sure?","Add dates","Remove dates","$kanban","$skin","_template_types","subtype","on_click","kanban","getKanban","setListStatus","MouseEvents","images","jpg","jpeg","png","gif","ppt","pptx","pptm","pps","ppsx","ppsm","doc","docx","docm","xls","xlsx","xlsm","xlsb","pdf","wav","aif","mp3","mid","mpg","mov","wmv","avi","mp4","zip","jar","rar","gz","isImage","toLowerCase","attachments","comments","cardActions","templateTags","tags","_tags","tag","templateIcons","templateAvatar","users","_users","user_id","image","templateBody","templateAttachments","templateFooter","_colors","KanbanView","on_context","_kanban_event","_fixOrder","$index","sid","tindex","tobj","DataMove","statusChange","dp","status","ignore","webix_move_index","webix_move_id","webix_move_parent","serverStatus","save","_setHandlers","eachOtherList","webix_kanban_user_avatar","_handle_icons","webix_kanban_footer_icon","_typeof","$drag","drag_container","$dropHTML","self","eachList","dtype","defaultSetter","defaultFilter","dataview","files","sizetext","_format_size","dnd","hideOverlay","showOverlay","getValue","fileSize","uploader","removeIcon","percent","preventEvent","modal","paddingX","paddingY","_close","$hide","yCount","_statuses","upload","onItemDblClick","getElementsByTagName","values","_removeCard","_fixStatus","$list","_afterInit","_form","_removeBtn","_header","addDropZone","OverlayBox","_sublists","getForm","listIndex","_assignList","_prepareEditor","unselectAll","selectedTask","masterId","contextmenu","cid","showEditor","_hide_chat","_save","serialize","delimiter","provideApi","_strToArr","_destroy_with_me","_data_unification","colors","reconstruct","_initEditor","_initUserList","_initMenu","_initComments","_this2","_applyOrder","oldid","newid","getOwnerList","changeId","_serialize","getTags","getUsers","getColors","getStatuses","cardActions_setter","menu","defer","callback","_this3","_editor","getUserList","_userList","getMenu","_menu","getComments","_comments","_this4","userList","userlist","_this5","setContext","_this6","_this7","chat","_syncData","subList","prevList","_prepareLists","_subfilters","statuses","sets","importData","DataLoader","headerlayout","[object Object]","param","super","jview","$reorderOnly","object","operation","fixMath","math","getField","name2","askin","portlet","Property","plusLabel","inputPadding","webix_pivot_handle_add_value","forms","Add","input","triggerEvent","fields","GetValue","_activeInput","wavg","getFormView","corrections","GetCorrections","CheckCorrections","structure","getStructure","external","ItemConfig","PrepareValue","onBeforeShow","FilterSuggest","ListTemplate","pivotPropertyRemove","activeVal","isSymbolAllowed","char","getLastSymbolIndex","startsWith","_addFirst","$enterKey","selectionStart","substring","nextSymbol","disabled","operations","suggestClick","activeElement","UIManager","getFocus","setValue","setValueHere","formula","str1","str2","lastSymbol","$setValue","setSelectionRange","ValuesProperty","typeName","ToggleColors","OutComplexMath","def","defaultOperation","defIndex","findIndex","SetOperation","getOperation","SuggestData","mini","palette","getPalette","getValueColor","fieldsRegex","fieldsMatch","matchAll","methods","methodsRegex","methodsMatch","GroupProperty","oldValue","ChartSettings","complexData","labelWidth","labelRight","checkValue","uncheckValue","OutValues","innerChange","chart","HandleVisibility","InValues","stackedArea","stacked","horizontal","TableSettings","datatable","footer","totalColumn","FilterView","filters","filterObj","collectFieldValues","ModeView","toolbarHeight","optionWidth","SetMode","dataPadding","ToolbarView","buttonHeight","ToggleConfig","webix_pivot_settings","scrollSize","$customScroll","_GetScrollWidth","GetFilters","filterPopup","filtersView","FiltersChanged","ToggleReadonly","oldStructure","JSON","stringify","FilterConfig","activeCss","condition","webix_pivot_filter","Show","outer","scrollbarWidth","offsetWidth","removeChild","$mainView","xAxis","yAxis","commonAxisSettings","scaleColor","lineColor","IsPieBased","multilevel","ValueFormat","pieInnerText","LoadData","getData","UpdateChart","removeAllSeries","SetSeries","SetLegend","addSeries","GetSeriesConfig","settings","alpha","borderColor","legend","valign","hotkey","ToggleForm","GroupConfig","_v","HandleFieldChange","SetValues","oldMode","isChart","SetValue","CorrectFilters","CorrectInputs","setStructure","groupBy","inputs","ShowConfig","HideConfig","leftSplit","UpdateTable","CheckFreeze","rightSplit","totalCols","totalOps","total","lastId","colspan","totalIndex","_store","_prepareData","marks","Proxy","prop","freezeColumns","SetFirstColumn","CellFormat","cssFormat","rid","HeaderTemplate","asc","desc","DataDimension","_sort","_label","_meta","_table","_getter","_prepared","_indexes","_values","_prepareOptions","_keys","fSize","indexes","DataExport","pivot","_pivot","cleanRows","maxRow","getLimit","resetCursor","Set","rAggr","rowData","cAggr","scaleWidth","getWidth","_cleanRows","columnData","aggregateColumns","mark","getXHeader","rowsLength","Function","propertyName","methodName","contextName","optimize","allMath","getMath","to","array","getter","cache","optimizeRangeGroup","optimizeGroup","rule","getColumn","and","buildFinder","check","DataPivot","_rows","_cols","_dims","_context","_cursor","_order","_base_order","getIndexes","_group","_nextRow","_nextColumn","_ops","dimsSize","_fillRow","dimSize","dimOutSize","levels","_groupOps","_groupLength","limit","_sizes","getSize","closeLevels","kAgr","vAgr","z","_fillGroupRow","hConfig","_opInfo","nonEmpty","isNested","rpref","ostep","unitsInParent","reduce","fullLength","unitSizes","opNames","rowspan","getLabel","metaLine","getMeta","rules","_masterRules","_groupResultOps","branchMode","branchMath","_rowResultOps","compactOps","op","_rowOps","_colResultOps","_colOps","_marks","_setSizes","dmr","opsLength","rarr","_fillGroupRowInner","rl","collectRaggr","ctemp","cfrom","cind","cto","opset","dataset","raws","dimsData","ok","sizes","kind","optimizer","getName","trim","RawTable","_columns","_raw","_parse_inner","dataLength","columnsLength","setter","ColumnTable","_parse_init","acc","avg","summ","any","eq","neq","gt","gte","lt","lte","in","hasPrefix","predicates","Analytic","_tables","_dimensions","_preds","_maths","_comps","tables","addTable","dimensions","addDimension","_predicateGetter","preserve","used","driver","prepare","rDims","cDims","fn","LocalData","_filtersHash","externalProcessing","_setOperations","_initRengine","extraOperations","_reng","addMath","totalOperations","addComparator","addPredicate","firstRow","dataType","useOldData","_dataLoad","_rengineToWebix","getTable","getPivotData","loadError","newConfig","_old","rengine.Analytic","_setFilters","_setTotalOperations","_setPredicates","setDimensions","getRows","getColumns","getLimits","getOps","headerConfig","toArray","toNested","toXHeader","isComplex","_updateTotalMath","minY","maxY","minX","maxX","getChartData","getHeader","_toTree","getFields","prepareData","fieldObj","hash","predicate","replaceAll","struct","hdata","resetDimensions","chartType","axis","pieGroup","rowIndex","columnIndex","scale","prepareStructure","initial","exportView","Chart","Click to configure","Configure Pivot","Total","Fields","Methods","Columns","Add column","Rows","Add row","Clean rows","Filters","Add filter","Group By","Chart type","Logarithmic scale","X axis title","Y axis title","Scale color","Circled lines","Horizontal","Stacked","Lines","Line","Radar","Bar","Area","Spline","Spline Area","Pie","Donut","Values","Add value","Field not defined","Highlight","Min X","Max X","Min Y","Max Y","Footer","Total Column","Off","On","Sum Only","3D","Show values inside","complex","Incorrect formula in values","ignoreInitial","withContext","BaseExportView","subMenuPos","subsign","GetTemplate","submenuConfig","onMenuItemClick","PopupAction","BaseToolbarView","ShowExportPopup","viewId","ExportMenu","Toolbar","Charts","Host","mod","Export","host","CheckColumns","config_1","GetChartConfig","GetChartData","seriesFrom","ConvertDataBySeries","FormatLabels","numLimit","labelColumn","labelOptions","option","undefined","legendPosition","series","axises","seriesConfig","ApplyTypeConfig","onAfterRender","CorrectLabels","GetLegendConfig","logarithmic","verticalLabels","itemTypes","itemSupport","markerType","getDataConfig","getOptions","fill","radius","fillMarker","disableItems","border","baseColumn","dataColumn","aRow","toPNG","toPDF","bindOut","newValue","subkey","_value","factory","heatmap","empty","main","alt","CommonView","JoinListTemplate","webix_rpt_action_remove","RemoveJoin","ShowJoins","AppState","Models","getModels","ShowDeleteButton","SourcesList","JoinTemplate","AddJoin","addJoin","joins","cleanLinkedModels","block","sf","tf","getLinkedModels","toolbar","prompt","getTopParentView","newname","selectMask","$cssName","webix_rpt_qselect_icon","richselect","extendStatics","setPrototypeOf","__proto__","__","constructor","__assign","getUrlString","_loadViewDynamic","_loop_1","webix$1","key2","ActionsPopupView","Item","Hide","BaseView","GetButton","GetList","AND","OR","GLUE","glue","editCss","DisableSwitch","Template","action-menu","Actions","action-close","Delete","wbq-filter_join","SwitchGlue","EditStart","EditStop","AddGroup","LastValue","ConvertTo","ConvertFrom","after","getFirstId","CreateMode","Save","DeleteSilent","grand","pIndex","Active","ActiveId","asString","Format","AdjustToField","ApplyFilter","GetField","fselect","CreateFilter","conditions","place","FilterPopup","at","TopBarView","TopListView","log","queryToFilter","query","con","glueOr","glueAnd","simple","GetFilter","getFilterFunction","notEqual","less","greater","greaterOrEqual","lessOrEqual","notContains","beginsWith","notBeginsWith","endsWith","notEndsWith","between","notBetween","or","Add Filter","Add Group","Apply","Cancel","QueryView","getFieldData","model","fixDates","$observe","QueryBuilderView","DeleteQuery","CopyQuery","RenameQuery","SaveQuery","QSelectTemplate","onClearClick","NewQuery","Query","qData","Queries","getQueries","saved","models","changed","saveBtn","updateQuery","addQuery","cancel","deleteQuery","QueryMenu","tabbar","tabMinWidth","ShowView","newModule","ChangeModule","ChangeModel","ShowHideButton","timer","debounce","TrackChanges","_key","oldColumns","numColumns","UpdateMeta","publicFields","prev_1","groupColumns","was_1","now_1","Reset","getModuleSaveData","moduleId","updateModule","SaveCallback","addModule","getModule","setDataSource","InitStateValue","InitName","getSeries","masterName","SummaryPopupView","ClickHandler","GetOptions","ApplyAction","SetActionStates","disableItem","enableItem","pstate","ParentState","BucketView","ValueSeparator","other","Changed","isNotEmpty","AddNewBucket","Forms","GetRowKeys","Data","Sort","CreateForm","Focus","keys_1","GetColumnData","baseOptions","keyOption","appState","moduleConfig","buckets","getOptionsList","LoadBuckets","AddBucket","bucket","LoadOther","GetRowForm","separator","ActiveForm","GetValues","otherForm","otherName","validate","names","ForEachFormRow","markInvalid","CorrectValues","GetValidBuckets","$checked","DeleteBucket","Master","List","AddColumn","View","onEnter","getSelectedItem","BucketState","Find","adjust","GetColumns","selectIcon","modifiers","renderModifier","_modifiers","$renderTag","content","removeItem","webix_rpt_date_selector","multicombo","getModifier","setModifier","_custom_last_size","px","py","BucketSettingsView","Views","ShowColumns","Update","RowTemplate","ToggleSub","_hasFocus","onSubViewOpen","HideAllEditors","onSubViewClose","ResetEditor","webix_rpt_bucket_delete","RemoveColumn","newColumn","ColumnList","BucketPopup","tableData","_ActiveEditor","newV","oldV","openSub","subrow","prevId","closeSub","FocusEditor","$subopen","DateView","GetPopupTemplate","ActiveGroup","isSelected","Summaries","labels","AddNewAggregation","GroupState","SummaryColumns","ValidateFormData","aggregate","LoadAggregations","ApplyOneRowMode","AddAggregation","summary","aggregation","GetDefaultFormData","formId","GetOperations","onTimedKeypress","NewColumnTemplate","this_1","DeleteAggregation","formList","valid","oId","cId","ChangeNewColumnName","OtherSettingsView","GetDateOptions","ChangeGroupBy","onModifierClick","ShowModifierPopup","groupState","LoadColumns","DatePopup","DatePopupView","ToggleGroupBy","ToggleBuckets","ToggleSortBy","gravity","ChangeSortBy","ChangeDirection","sortBy","chartState","Axis","ChartState","AxisPropertiesView","labelAlign","ApplyYAxis","ApplyXAxis","BaseStructureView","SaveOrder","Id","ColorPopupView","onColorSelect","GetSeries","updatedSeries","closeIcon","$renderInput","badge","webix_input_icon","hideCloseIcon","_onSearch","showCloseIcon","setIcon","nodes","getElementsByClassName","setBadge","Series","SeriesPropertiesView","ItemListTemplate","getItemTypes","getTypes","labelField","ChangeLabelField","valueFields","SubState","UpdateSeries","SeriesProperties","onAfterDrop","data->onClearAll","webix_rpt_chart_color","ShowColorPopup","action-visible","HideField","action-hidden","ShowField","webix_rpt_config_row_name","axisFields","UpdateAxis","AxisProperties","AxisRowTemplate","legendFields","ChangeLegend","GetDataInputs","Types","ValueFields","GetInitState","UpdateModuleState","ApplyChartType","ApplySeriesFrom","GenerateSeries","prevType","ShowAxisInputs","RenderSeries","LoadSeries","noAxisSupport","sourceArray","ApplySeriesKeys","base_1","prevValue","ColorPopup","ActiveSeries","Column","ColumnPropertiesView","valueField","colorField","lc","vc","cc","OnChange","StructureView","ChangeReportType","ColumnsView","onSearchChange","FilterFields","ColumnProperties","FrozenTemplate","GetFreeze","freezeColumn","EmptyView","mods","getModules","GetText","GetSVG","CssFactory","TooltipFactory","bases","valueColumn","colorColumn","props","MenuPopup","ID","trg","GridsView","GetListTemplate","webix_rpt_action_menu","Menu","onDblClick","onAfterSelect","LoadModule","Sorting","SearchCompare","parsed","updated","sState","prevState","ChangeSortButtons","btn","prevBtn","ExportView","typeToSort","boolean","picklist","reference","$selection","plainOutput","filterHTML","toExcel","toCSV","GetTableConfig","table_1","GetTableData","IsBucketColumn","groups","dateColumns","gColumns","GetColumnConfig","grid","byUser","SetColWidth","_1","Tbl","setColumnWidth","clearCss","ignoreDateNumber_1","hasNonDigits","regexp_1","wildToRegexp","matchers_1","colId","optionsMatch_1","findOptions","matchPerColumn","dateFormats_1","found_1","addHotKey","removeHotKey","offIcon","onIcon","SetVisibleButtons","newBtn","deleteModule","copyModule","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","m31","m32","m33","_fieldData","_optionsData","_modules","modules","_models","_models_async","refs","ref","_refs","major","newField","onlyNew","getRefs","was","origin","queryObj","collectTables","check_1","_queries","q","moduleProps","replacements","wild","regexp","lineTypes","multiTypeSupport","fiedls","colorIndex","All reports","Are you sure to delete this report?","Are you sure to delete this query?","Average","Color column","Common","Copy of","Count","Created on","Data source","Day","Delete report","Description","Enter query name","To Excel","To CSV","To PNG","To PDF","Filter","Filtering query","Frozen columns above","Group summaries","Join data","Heatmap","Labels column","Max","Min","Month","New","Click 'New' button to add a new report","Select any report from the list","No reports","No saved queries","Last modified","New column name","New report","Please delete the related query filter first","Please delete the related group rule first","Rename","Report name","Reports","Save query","Specify columns to group by and output(s)","Specify columns to sort by","Sum","Type to search","Year","Axes","X Axis","Y Axis","Data series","Keys column","X axis column","Values column","Color","Marker type","Fill marker","Legend","Gridlines","Bottom","None","Right","Stacked area","Spline area","Stacked bar","Create copy","circle","square","triangle","diamond","no markers","Vertical labels","Extract series from","True","False","Save filter to use it in other reports","No filter","Select","Data buckets","Bucket name","Bucket values","Add bucket","Specify columns and their data buckets","Search","Other","Other values","Are you sure to delete?","waitVisible","interval","destructed","AddView","cals","AddEvent","NavLabel","ChangeDate","DateLabel","timeline","GetStep","timelineMode","NavBarView","bottomOffset","defaultPalette","modernPalette","palettes","material","flat","willow","optionHeight","SidePopupView","compactBar","controls","onHide","Cals","updateCalendar","addCalendar","removeCalendar","UpdateColor","webix_template","ShowEditor","Editor","EditorView","Cid","SideView","monthSelect","onAfterDateSelect","ListType","editValue","webix_scheduler_cal_edit","webix_scheduler_cal_title","ToggleCalendar","webix_scheduler_active","SetTitle","side","maxHeight","AddCalendar","onAfterScroll","PopupView","EditAbility","ToggleState","checkbox","EditStopSilent","fail","editStop","NavPopupView","animate","tHeight","tabbarHeight","Parent","updatePos","todayIcon","SetToday","todayBtn","responsive","ShowNav","responsiveCell","NavPopup","ToggleAdd","EventActionMenu","Result","Root","shrinkTo","before","isToday","isMultiDay","all_day","daysBetweenInclusive","isSameDate","adate","bdate","icalFormat","string","name_1","UNTIL","strToDate","EXDATE","WEEKDAYS","FREQUENCE","DAILY","WEEKLY","MONTHLY","YEARLY","findDate","fillWdays","consts","BYDAY","wdays","INTERVAL","FREQ","BYYEARDAY","BYMONTHDAY","BYSETPOS","checkDay","sdate","oldDay","WeekdaysToDates","getParams","$id","$recurring","extractDate","clipSequence","COUNT","cutOccurrence","separateSequence","isFirstOccurrence","evStart","correctMode","origin_id","recurring","isLastPart","movePattern","newEvent","oldEvent","until","nmd","nwn","getWeekNum","BYMONTH","nm","checkPattern","RecurringFormView","CreateIntervalControls","CreateCheckboxes","CreateSelect","CreateRadio","UpdateEvent","Events","CheckBoxContainer","Checkboxes","PatternSelect","UntilDateContainer","UntilDateCalendar","untilDate","UntilNumContainer","UntilNum","CustomRecControls","ChangeControls","_freq","dayShort","CheckboxGuard","GetBYDAY","byDay","dayFull","monthFull","calculated","weekNum","weekday","yearday","rec_pattern","vertical","ChangeSelectors","_StartDate","untilCount","CountNum","minDate","SetUNTIL","SetBYDAY","SetPatternOptions","setDirty","GetUntil","GetRecPattern","changeMode","date_id","correctCountUntil","countToUntil","nexto","hasOneOccurrence","lr","EditRecurringMixin","ChangeMode","CorrectCountUntil","HasOneOccurrence","EventFormView","GetDateTime","ToggleTimeControls","CreateCalendarColor","getDirtyValues","PrepareChange","Wait","CreateRepeat","CreateUnitSelector","CreateSectionSelector","RecurringOptions","StartTime","EndTime","waitUnits","combo_1","Sections","sections","SubForm","ClearTempEvent","FillForm","labelTopHeight","ToggleSubform","ShowSubForm","clipboard","NewEvent","FillFormContinue","AdaptObjToMode","start_time","end_time","SetRecurring","yearStart","today","GetFromStartDate","roptions","ResetRecurringOptions","rec_option","GetStartDate","section","$color","minutes","PrepareOut","addEvent","UpdateExisting","UpdateSelection","newEvent_1","updateEvent","recVals","fvals","Join","ProcessRecurringOption","ProcessRecurringPattern","ProcessDates","ApplyDatechangeToRecurring","ProcessText","_changedValues","series_end_date","GetRecurring","edate","CorrectDateTime","ev_length","opposite","oldStart","length_1","GetRecurringPreset","dirty","UpdateStateDate","GetClosestOccurrenceDate","GetModeBounds","weekStart","weeks","Subform","IsDirty","subform","HideSubPop","FormPopup","cleanEventData","HandleCopyPaste","clipboardModes","ctrlKey","isMac","AddToClipboard","PasteFromClipboard","PurgeClipboard","setFocus","RestoreClipboardSource","$multi","_globalClickHandler","ChangePasteTarget","CreatePasteTarget","OnDestroy","offsetLeft","offsetTop","mousePosUnit","sheight","GetSectionHeight","childNodes","SetPasteTargetStyle","ClearPasteTargetStyle","querySelectorAll","sel","SetClipboardSourceStyle","event_1","GetEvent","prevCss","clip","GetEventData","CopyEvent","MoveEvent","evLength","GetTargetDate","sec","updateId","CopyPasteMixin","mainWidget","BRIGHTNESS","FONT","EventView","StartAction","copypaste","UnitsLocal","EventObj","DeleteEvent","EditEvent","removeEvent","removal","oneday","allday","timeFormatStr","startTime","endTime","fromTo","GetRecurringText","unitIDs_1","unitObj","unitValue","GetSection","pattern","EventActionPopup","buttons","MainView","topbar","ToggleEvent","ToggleSidePanel","_dndActionPopup","ShowEvent","HideEvent","sameEvent","_sidePanel","getDimmedColor","hex","toRgb","red","green","blue","rgbToHsv","hue","saturation","hsvToRgb","$past","timeStart","dayEventColor","$textColor","UnitListView","uniteBy","templateHeader","TemplateHeader","TimeStart","onUnits","SetUnits","start_1","AgendaView","headerHeight","TemplateCss","onItemRender","$unit","CurrentUnit","SelectEvent","_o","monthStart","getEvents","ToggleOverlay","_selected","datestring","fstring","ids","getUnitList","HourscaleView","heightSize","HourScaleItem","ParseHours","MultiMoreView","wxi-angle-down","ExpandData","wxi-angle-up","WrapData","MoreIcon","_expandState","maxVisibleLines","transition","_inAnimation","SetMoreIcon","_select","functor","trgs","LocateSelected","Unselect","_SelectionMode","id_1","SelectionMixin","_DataObj","firstElementChild","Resizer","y_diff","updateNodeHeight","updateText","x_diff","minEventHeight","getActualDate","differenceInCalendarDays","differenceInHours","f_cache","formatFunction","getSizes","d_1","dragOnly","modes","attr","updateSelection","editRecurring","newSubEvent","joinDateTime","shiftDate","mainDate","occDate","changeDate","ddate","dtime","$resize","moveMode","more","_waitPopup","finishOperation","copyEvent","$creation","$copy","$last_y","metaKey","dragCreate","scrollY_1","parentTopOffset","$top","$left","calId","ToHTML","getMaster","EventTemplate","noff","toff","$marked","markDropArea","drop","$extra","extra","getLastId","xCount","multiday","children","HideWindow","getEventUnits","sourceUnit","currentUnits","targetUnit","newUnits","multidayUnits","getStep","wrongDates","allDay","timelineMore","offsetParent","WeekDayNum","DayEventsView","webix_scheduler_day_event","webix_scheduler_day_scale_item","_e","ShowNew","RenderEvents","mobile","FilterToday","_marker_update_interval","UpdateMarkerPosition","_Marker","evs","PrepareEvents","role","MarkToday","$inner","orderSet","PruneStack","$sorder","max_count","SetPosition","GetEventEndDate","temp_width","evCorrectedCopy","sm","em","EventTemplateStart","resizer","MultidayEventList","webix_scheduler_multiday_event","_moreBtn","LimitData","GetStyle","excess","_reserve","_reserveIds","Animate","DayView","ScrollScale","GetDay","CalendarView","isOutside","MarkEvent","navigation","monthHeader","skipEmptyWeeks","Calendar","MoreWindowView","webix_scheduler_month_event","webix_scheduler_month_event_single","MoreTemplate","Win","_c","oneDay","DayFormatStr","MonthEventsView","webix_cal_date","_ev","ShowDay","webix_scheduler_more","ShowMore","webix_cal_day","CalendarTemplate","eventHeight","MoreWindow","$more","GetDayCss","maxLines","wStart","wEnd","dayIndex","dayHTML","IsSingleDay","es","ee","le","prevLength","GetPosition","start_a","start_b","days_a","monthData","GetMonthData","ShowWindow","MonthHeaderView","GetHeaderData","MonthListView","MonthView","BarView","MoreView","clientWidth","webix_scheduler_timeline_event","webix_list_item","InnerState","RefreshTask","_sectionsReady","_sectionSize","ClearCollections","_processed","_lastRow","_moreEvents","sectionIndex","GetUnitCount","CheckDates","GetUnitStart","MoreBarTemplate","GetGrid","GetUnitWidth","AddUnit","clickedUnit","innerState","TimelineView","SetScales","ResetScales","wstart","wend","GetDefaultScaleUnit","GetScalePrecision","GetScalesCellWidth","GetScalesArray","UnitEventsView","unitID","UnitsHeaderView","Header","Units","unitsCache","UnitMultidayList","FilterByUnits","expandable","multiEvents","UnitMultidayView","UnitsView","WeekEventsView","WeekHeaderView","MultiDayEventsView","itemHeight","ParseDays","BreakEventsByDay","_maxEvents","ResetListHeight","Days","processed","$config","allEvents","renderedEvents","toHide","_day","visible","MoreOption","cIndex","rIndex","GetSizePosition","WeekView","GetWeek","_month","YearCalendarView","DayEvents","calendarHeader","webix_cal_day_with_event","ShowEvents","webix_cal_month","ShowMonth","SetStateDate","ManageDateChange","GetMonthStart","_date","MonthStart","showCalendar","monthEnd","dateKey","YearView","GetCalendars","m34","m35","m36","m37","m38","m39","m40","m41","m42","m43","createEvents","events_ready","cals_ready","createUnits","units_ready","_sections","createSections","sections_ready","utc","serverUTC","loaded_ranges","getColor","eventOut","getLocal","getDynamic","dimPastEvents","xdate","isPast","roundTime","parseFormatStr","fromStr","sortCalendars","onAfterDelete","setActive","onAfterAdd","data->onDataUpdate","rgb","tosave","cev","isFirst","recurring_update_mode","recurring_update_date","Week","Agenda","Timeline","Today","Create","Next","Previous","Next day","Previous day","Next week","Previous week","Next month","Previous month","Add calendar","Do you really want to remove this calendar?","Edit calendar","Settings","Inactive calendar","No Events","All Day","Expand all-day events","Collapse all-day events","The event will be deleted permanently, are you sure?","Delete event","(No title)","Event","Start","End","Edit event","Assigned to units","No units","Unknown unit","never","none","daily","weekly","monthly","yearly","years","Repeat","End repeat","Repeats each","till","times","weekly, every","monthly, every","yearly, every","every working day","custom","Every","of","day of year","after several occurrences","week on","Change recurring pattern","All events","This event","This event and the following","Edit recurring event","Timeline scale","Section","Show more","Copy event","groupDelimiter","groupSize","decimalDelimiter","decimalSize","dateFormat","timeFormat","longDateFormat","fullDateFormat","am","pm","price","priceSettings","monthShort","monthFormat","yearFormat","theme","statusbar","_mce_id","_waitEditor","_require_tinymce_once","_set_inner_size","cdn","tinymce","_init_tinymce_once","apiKey","tinyMCEPreInit","editor_config","selector","custom_setup","setup","_mce_editor_ready","setContent","getContent","gantt","report","reports","scheduler"],"sourceRoot":""}