{"version":3,"file":"app.27e20866d857c8a2d8bb.js","mappings":"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","sources":["webpack://ab_platform_web/./config/configDesktop.js","webpack://ab_platform_web/./config/configMobile.js","webpack://ab_platform_web/./config/Config.js","webpack://ab_platform_web/./ui/portal_loading.js","webpack://ab_platform_web/./ui/portal_auth_login_form.js","webpack://ab_platform_web/./ui/portal_auth_login_resetPassword.js","webpack://ab_platform_web/./ui/portal_auth_login_resetRequest.js","webpack://ab_platform_web/./ui/portal_auth_login.js","webpack://ab_platform_web/./ui/portal_auth.js","webpack://ab_platform_web/./ui/ClassUIPage.js","webpack://ab_platform_web/./ui/portal_work_inbox_accordion.js","webpack://ab_platform_web/./ui/portal_work_inbox_taskWindow.js","webpack://ab_platform_web/./ui/portal_work_inbox.js","webpack://ab_platform_web/./ui/portal_work_user_profile_window.js","webpack://ab_platform_web/./ui/portal_work_user_switcheroo.js","webpack://ab_platform_web/./ui/portal_work_user_qr_window.js","webpack://ab_platform_web/./ui/portal_work_user_mobile_qr.js","webpack://ab_platform_web/./ui/portal_access_level_manager.js","webpack://ab_platform_web/./ui/portal_translation_tool.js","webpack://ab_platform_web/./ui/portal_tutorial_manager.js","webpack://ab_platform_web/./ui/portal_work.js","webpack://ab_platform_web/./ui/portal.js","webpack://ab_platform_web/./ui/ui.js","webpack://ab_platform_web/./ui/error_noDefs.js","webpack://ab_platform_web/./init/Bootstrap.js","webpack://ab_platform_web/./init/initDiv.js","webpack://ab_platform_web/./init/initConfig.js","webpack://ab_platform_web/./init/initDefinitions.js","webpack://ab_platform_web/./init/initConnectListerner.js","webpack://ab_platform_web/./index.js","webpack://ab_platform_web/./ui/ClassUI.js","webpack://ab_platform_web/./utils/performance.js"],"sourcesContent":["/**\n * @class configDesktop\n *\n * Manage our configuration settings for Desktop styles.\n\n */\n\nexport default {\n   // Application List\n   appListRowHeight: 67,\n\n   // button types\n   buttonWidthLarge: 200,\n   buttonWidthMedium: 150,\n   buttonWidthSmall: 100,\n   buttonWidthExtraSmall: 50,\n\n   // tab types\n   tabWidthLarge: 200,\n   tabWidthMedium: 120,\n   tabWidthSmall: 100,\n   tabWidthExtraSmall: 50,\n\n   // column types\n   columnWidthXLarge: 350,\n   columnWidthLarge: 250,\n   columnWidthMedium: 200,\n   columnWidthSmall: 150,\n   columnWidthExtraSmall: 100,\n\n   // spacers\n   xSmallSpacer: 5,\n   smallSpacer: 10,\n   mediumSpacer: 25,\n   largeSpacer: 50,\n   xLargeSpacer: 100,\n   xxLargeSpacer: 200,\n   xxxLargeSpacer: 400,\n   appListSpacerRowHeight: 100,\n   appListSpacerColMinWidth: 100,\n   appListSpacerColMaxWidth: 200,\n   objectWorkspaceColWidth: 20,\n\n   // labels\n   labelWidthSmall: 50,\n   labelWidthMedium: 80,\n   labelWidthLarge: 120,\n   labelWidthXLarge: 150,\n   labelWidthXXLarge: 200,\n   labelWidthXXXLarge: 280,\n   labelWidthCheckbox: 0,\n\n   // show elements on desktop\n   hideMobile: false,\n};\n","/**\n * @class configMobile\n *\n * Manage our configuration settings for mobile styles.\n\n */\n\nexport default {\n   // Application List\n   appListRowHeight: 67,\n\n   // button types\n   buttonWidthLarge: 200,\n   buttonWidthMedium: 150,\n   buttonWidthSmall: 100,\n   buttonWidthExtraSmall: 50,\n\n   // tab types\n   tabWidthLarge: 200,\n   tabWidthMedium: 120,\n   tabWidthSmall: 100,\n   tabWidthExtraSmall: 50,\n\n   // column types\n   columnWidthLarge: 250,\n   columnWidthMedium: 200,\n   columnWidthSmall: 150,\n   columnWidthExtraSmall: 100,\n\n   // spacers\n   xSmallSpacer: 1,\n   smallSpacer: 1,\n   mediumSpacer: 10,\n   largeSpacer: 20,\n   xLargeSpacer: 50,\n   xxLargeSpacer: 100,\n   xxxLargeSpacer: 120,\n   appListSpacerRowHeight: 10,\n   appListSpacerColMinWidth: 1,\n   appListSpacerColMaxWidth: 1,\n   objectWorkspaceColWidth: 1,\n\n   // labels\n   labelWidthSmall: 50,\n   labelWidthMedium: 80,\n   labelWidthLarge: 120,\n   labelWidthXLarge: 120,\n   labelWidthXXLarge: 120,\n   labelWidthCheckbox: 0,\n\n   // hide elements for mobile\n   hideMobile: true,\n};\n","import ConfigDesktop from \"./configDesktop\";\nimport ConfigMobile from \"./configMobile\";\n\n// var EventEmitter = require(\"events\").EventEmitter;\nimport { defaultsDeep } from \"lodash\";\n\nconst settingsDefault = {\n   \"appbuilder-portal-autoenter\": true,\n   // {bool} autoenter\n   // open up the portal as soon as we load.\n   //   false : just displays a link that will load the portal\n\n   \"appbuilder-portal-fullscreen\": true,\n   // {bool} fullscreen\n   // take up the full browser window?\n   //   false : only take up the area the current div is\n\n   \"appbuilder-tenant\": null,\n   // {string} tenant\n   // the tenant uuid for this AppBuilder instance.\n\n   \"appbuilder-view\": \"work\",\n   // {string} view\n   // the default view to display to the current user.\n\n   \"appbuilder-tenant-prefix\": null,\n   // TESTING! Remove this\n};\n\nconst configDefaults = {\n   site: {\n      appbuilder: {\n         networkType: \"socket\",\n         // options: [\"rest\", \"relay\", \"socket\"]\n         // Note: \"socket\" is required for realtime updates across devices.\n\n         networkNumRetries: 3,\n         // the number of times we will retry sending a network request\n         // when we receive a timeout error.\n\n         urlCoreServer: window.location.origin,\n         // on the web client, just record the current URL by default.\n         // the site config can override this if they want.\n      },\n      storage: {\n         encrypted: false,\n         // {bool} should we encrypt our data in the local browser storage?\n      },\n   },\n};\nclass Config {\n   constructor() {\n      // this.setMaxListeners(0);\n      this._config = null;\n      // {obj} _config\n      // these are the configuration settings returned from the server. These\n      // are more detailed configuration settings for the running of the site.\n\n      this._settings = {};\n      // {obj} _settings\n      // settings are the configuration parameters found on the base <div>\n      // these settings are the minimum needed to successfully pull up the\n      // portal popup and perform the initial config request\n   }\n\n   config(json) {\n      this._config = json;\n      defaultsDeep(this._config, configDefaults);\n   }\n\n   setting(key, value) {\n      if (value) {\n         this._settings[key] = value;\n         return;\n      }\n      return this._settings[key];\n   }\n\n   settingsFromDiv(div) {\n      Object.keys(settingsDefault).forEach((d) => {\n         var val = div.getAttribute(d);\n         if (!val) {\n            val = settingsDefault[d];\n         }\n         if (val === \"false\") val = false;\n         if (val === \"true\") val = true;\n\n         var key = d.split(\"-\").pop();\n         this.setting(key, val);\n      });\n   }\n\n   settings(json = {}) {\n      for (let key in settingsDefault) {\n         const val = json[key] ?? settingsDefault[key];\n         this.setting(key.split(\"-\").pop(), val);\n      }\n   }\n\n   /**\n    * definitions()\n    * return the ABDefinition(s) required to manage the interface.\n    * @return {obj}\n    *          { ABDefinition.id : {ABDefinition} }  hash of definitions.\n    */\n   definitions() {\n      return window.definitions;\n   }\n\n   error(/* ...args */) {\n      console.error(\"Who is calling this? -> move to AB.error() instead.\");\n      // this.emit(\"ab.error\", args);\n   }\n\n   labelConfig() {\n      if (this._config && this._config.labels) {\n         return this._config.labels;\n      }\n      console.error(\"No Label config found.\");\n      return {};\n   }\n\n   languageConfig() {\n      if (this._config && this._config.languages) {\n         return this._config.languages;\n      }\n      console.error(\"No Language config found.\");\n      return {};\n   }\n\n   metaConfig() {\n      if (this._config && this._config.meta) {\n         return this._config.meta;\n      }\n      console.error(\"No Meta config found.\");\n      return {};\n   }\n\n   plugins() {\n      // TODO: Pull from this._config.plugins\n      return [\"ABDesigner.js\"];\n      // return [];\n   }\n\n   inboxConfig() {\n      if (this._config && this._config.inbox) {\n         return this._config.inbox;\n      }\n      return null;\n   }\n\n   inboxMetaConfig() {\n      if (this._config && this._config.inboxMeta) {\n         return this._config.inboxMeta;\n      }\n      return null;\n   }\n\n   siteConfig() {\n      if (this._config && this._config.site) {\n         return this._config.site;\n      }\n      return configDefaults.site;\n   }\n\n   tenantConfig() {\n      if (this._config && this._config.tenant) {\n         return this._config.tenant;\n      }\n      return null;\n   }\n\n   uiSettings() {\n      if (window.innerWidth < 768) {\n         return ConfigMobile;\n      }\n      return ConfigDesktop;\n   }\n\n   /**\n    * @typedef User - based on SITE_USER\n    * @property {string} email email address\n    * @property {string} id\n    * @property {number} isActive wether the user is active in the system\n    * @property {string} languageCode\n    * @property {string} username\n    * ...\n    */\n\n   /**\n    * Information about the current user\n    * @returns {User}\n    */\n   userConfig() {\n      if (this._config && this._config.user) {\n         return this._config.user;\n      }\n      return null;\n   }\n\n   userReal() {\n      return this._config?.userReal ?? false;\n   }\n}\nexport default new Config();\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalLoading extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui() {\n      return {\n         id: \"portal_loading\",\n         view: \"label\",\n         label: \"loading\",\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n\n      return Promise.resolve();\n   }\n\n   show() {\n      $$(\"portal_loading\").show();\n   }\n}\n\nexport default new PortalLoading();\n","import ClassUI from \"./ClassUI.js\";\nimport Bootstrap from \"../init/Bootstrap.js\";\n\nclass PortalAuthLoginForm extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui() {\n      var self = this;\n\n      if (!this.AB) {\n         // we need to init() before being able to translate our UI:\n         return {\n            id: \"portal_auth_login_container\",\n         };\n      }\n\n      var L = this.AB.Label();\n\n      return {\n         id: \"portal_auth_login_container\",\n         css: \"portalLogin\",\n         cols: [\n            {},\n            {\n               rows: [\n                  {},\n                  {\n                     width: 360,\n                     rows: [\n                        {\n                           css: \"portalLoginForm\",\n                           padding: 30,\n                           rows: [\n                              {\n                                 template:\n                                    \"<div style='text-align: center; font-size:160px; line-height: 160px;'><i style='background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-user-circle-o'></i></div>\",\n                                 borderless: true,\n                                 height: 190,\n                                 type: \"clean\",\n                              },\n                              {\n                                 id: \"portal_auth_login_form\",\n                                 view: \"form\",\n                                 type: \"clean\",\n                                 css: { background: \"transparent !important\" },\n                                 borderless: true,\n                                 elementsConfig: {\n                                    bottomPadding: 20,\n                                    height: 52,\n                                 },\n                                 elements: [\n                                    {\n                                       view: \"text\",\n                                       placeholder: L(\"Email\"),\n                                       name: \"email\",\n                                       id: \"email\",\n                                       attributes: {\n                                          \"data-cy\":\n                                             \"portal_auth_login_form_email\",\n                                       },\n                                       // required: true,\n                                       validate: webix.rules.isEmail,\n                                       invalidMessage: L(\n                                          \"Please enter a valid email.\"\n                                       ),\n                                       validateEvent: \"blur\",\n                                    },\n                                    {\n                                       view: \"text\",\n                                       type: \"password\",\n                                       placeholder: L(\"Password\"),\n                                       name: \"password\",\n                                       attributes: {\n                                          \"data-cy\":\n                                             \"portal_auth_login_form_password\",\n                                       },\n                                       // required: true,\n                                       validate: webix.rules.isNotEmpty,\n                                       invalidMessage: L(\n                                          \"Please enter your password.\"\n                                       ),\n                                       validateEvent: \"blur\",\n                                    },\n                                    {\n                                       margin: 10,\n                                       paddingX: 2,\n                                       borderless: true,\n                                       cols: [\n                                          {},\n                                          {\n                                             view: \"button\",\n                                             label: L(\"Login\"),\n                                             type: \"form\",\n                                             id: \"portal_auth_login_form_submit\",\n                                             css: \"webix_primary\",\n                                             width: 150,\n                                             hotkey: \"enter\",\n                                             click() {\n                                                var form = $$(\n                                                   \"portal_auth_login_form\"\n                                                );\n                                                if (form.validate()) {\n                                                   $$(\n                                                      \"portal_auth_login_form_submit\"\n                                                   ).hide();\n                                                   $$(\n                                                      \"portal_auth_login_form_submit_wait\"\n                                                   ).show();\n\n                                                   var values =\n                                                      form.getValues();\n                                                   self.error(); // hids the error message\n\n                                                   // this.AB.Network.post()\n                                                   // can either be a Relay or Rest operation.\n                                                   // we should get the response from the\n                                                   // published JobRequest initialized in\n                                                   // the .init() routine.\n                                                   self.AB.Network.post(\n                                                      {\n                                                         url: \"/auth/login\",\n                                                         data: values,\n                                                      },\n                                                      {\n                                                         key: \"portal_auth_login\" /*, context:{} */,\n                                                      }\n                                                   ).catch((err) => {\n                                                      $$(\n                                                         \"portal_auth_login_form_submit\"\n                                                      ).show();\n                                                      $$(\n                                                         \"portal_auth_login_form_submit_wait\"\n                                                      ).hide();\n                                                      console.log(err);\n                                                   });\n                                                }\n                                             },\n                                             on: {\n                                                onAfterRender() {\n                                                   ClassUI.CYPRESS_REF(this);\n                                                },\n                                             },\n                                          },\n                                          {\n                                             view: \"button\",\n                                             label: \"<i class='fa fa-circle-o-notch fa-fw fa-spin'></i>\",\n                                             type: \"form\",\n                                             id: \"portal_auth_login_form_submit_wait\",\n                                             css: \"webix_primary\",\n                                             width: 150,\n                                             hidden: true,\n                                          },\n                                          {},\n                                       ],\n                                    },\n                                    {\n                                       margin: 10,\n                                       paddingX: 2,\n                                       borderless: true,\n                                       cols: [\n                                          {},\n                                          {\n                                             view: \"button\",\n                                             label: L(\"Forgot password?\"),\n                                             css: \"webix_transparent\",\n                                             click: () => {\n                                                this.emit(\"request.reset\");\n                                                // $$(\"portal_auth_login\").hide();\n                                                // $$(\"password_reset_email\").show();\n                                             },\n                                             width: 150,\n                                          },\n                                          {},\n                                       ],\n                                    },\n                                    {\n                                       id: \"portal_auth_login_form_errormsg\",\n                                       view: \"template\",\n                                       css: \"webix_control\",\n                                       height: 32,\n                                       on: {\n                                          onAfterRender() {\n                                             ClassUI.CYPRESS_REF(this);\n                                          },\n                                       },\n                                    },\n                                 ],\n                              },\n                           ],\n                        },\n                     ],\n                  },\n                  {},\n               ],\n            },\n            {},\n         ],\n      };\n   }\n\n   error(message) {\n      var $errMsg = $$(\"portal_auth_login_form_errormsg\");\n      if (message) {\n         $errMsg.setHTML(\n            `<div class='webix_invalid'><div class='webix_inp_bottom_label'><center>${message}</center></div></div>`\n         );\n         $errMsg.show();\n      } else {\n         $errMsg.hide();\n      }\n   }\n\n   init(AB) {\n      this.AB = AB;\n\n      // now replace our initial placeholder with our viewable form\n      webix.ui(this.ui(), $$(\"portal_auth_login_container\"));\n\n      this.error(); // hides the default error message.\n\n      this.AB.Network.on(\"portal_auth_login\", (context, err, response) => {\n         // Listen for our login responses:\n         // console.log(\"Network.on():\", context, err, response);\n\n         if (err) {\n            // any http 400-500 response should show up here:\n            if (err.code) {\n               switch (err.code) {\n                  case \"EINVALIDLOGIN\":\n                     this.error(err.message);\n                     break;\n\n                  case \"EFAILEDATTEMPTS\":\n                     this.error(err.message);\n                     $$(\"portal_auth_login_form_submit\").hide();\n                     break;\n\n                  default:\n                     this.AB.error(err);\n                     break;\n               }\n            }\n            return;\n         }\n\n         if (\n            response.user ||\n            (response.status == \"success\" && response.data.user)\n         ) {\n            // reload the page to gather all the config info:\n            window.location.reload(true);\n\n            // Login was successful -> rerun BootStrap.init() to load the\n            // config, definitions, plugins, etc for this user\n            // Bootstrap.init(this.AB).catch((err) => {\n            //    Bootstrap.alert({\n            //       type: \"alert-error\",\n            //       title: \"Error initializing Portal:\",\n            //       text: err.toString(),\n            //    });\n            //    Bootstrap.error(err);\n            // });\n         } else {\n            if (response.status == \"error\") {\n               console.log(\"what to do with this error:\");\n               console.error(response);\n            }\n         }\n      });\n\n      return Promise.resolve();\n   }\n\n   show() {\n      $$(\"portal_auth_login_container\").show();\n   }\n}\n\nexport default new PortalAuthLoginForm();\n","import ClassUI from \"./ClassUI.js\";\n\nvar L = null;\n\nclass PortalAuthLoginResetPassword extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui() {\n      var self = this;\n\n      if (!this.AB) {\n         // we need to init() before being able to translate our UI:\n         return {\n            id: \"portal_auth_login_reset_password\",\n         };\n      }\n\n      return {\n         id: \"portal_auth_login_reset_password\",\n         css: \"portalLogin\",\n         cols: [\n            {},\n            {\n               rows: [\n                  {},\n                  {\n                     width: 360,\n                     rows: [\n                        {\n                           id: \"portal_auth_login_reset_password_col\",\n                           css: \"portalLoginForm\",\n                           padding: 30,\n                           rows: [\n                              {\n                                 template:\n                                    \"<div style='text-align: center; font-size:160px; line-height: 160px;'><i style='background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-user-circle-o'></i></div>\",\n                                 borderless: true,\n                                 height: 190,\n                                 type: \"clean\",\n                              },\n                              {\n                                 id: \"portal_auth_login_reset_password_form\",\n                                 view: \"form\",\n                                 type: \"clean\",\n                                 css: { background: \"transparent !important\" },\n                                 borderless: true,\n                                 elementsConfig: {\n                                    height: 52,\n                                 },\n                                 elements: [\n                                    {\n                                       id: \"new-password-email\",\n                                       template: ` ${this.AB.Account.email()} `,\n                                       css: {\n                                          background: \"transparent !important\",\n                                          border: \"none\",\n                                          \"font-size\": \"16px\",\n                                          color: \"black\",\n                                          \"text-align\": \"center\",\n                                       },\n                                    },\n                                    {\n                                       id: \"password-new\",\n                                       view: \"text\",\n                                       type: \"password\",\n                                       placeholder: L(\"Enter a new Password\"),\n                                       name: L(\"Enter a new Password\"),\n                                       validate: (v) => {\n                                          return v.length >= 8;\n                                       },\n                                       invalidMessage: L(\n                                          \"Needs to be at least 8 characters\"\n                                       ),\n                                       validateEvent: \"blur\",\n                                       bottomPadding: 20,\n                                    },\n                                    {\n                                       id: \"password-confirm\",\n                                       view: \"text\",\n                                       type: \"password\",\n                                       placeholder: L(\"Re-enter Password\"),\n                                       name: \"email\",\n                                       validate: (v) => {\n                                          return (\n                                             v === $$(\"password-new\").getValue()\n                                          );\n                                       },\n                                       invalidMessage: L(\n                                          \"Passwords do not match\"\n                                       ),\n                                       validateEvent: \"blur\",\n                                       bottomPadding: 20,\n                                    },\n                                    {\n                                       margin: 10,\n                                       paddingX: 2,\n                                       borderless: true,\n                                       cols: [\n                                          {},\n                                          {\n                                             view: \"button\",\n                                             label: L(\"Save\"),\n                                             type: \"form\",\n                                             css: \"webix_primary\",\n                                             width: 150,\n                                             hotkey: \"enter\",\n                                             click: () => {\n                                                if (\n                                                   $$(\n                                                      \"portal_auth_login_reset_password_form\"\n                                                   ).validate()\n                                                ) {\n                                                   let password = $$(\n                                                      \"password-new\"\n                                                   ).getValue();\n                                                   this.AB.Network.post(\n                                                      {\n                                                         url:\n                                                            \"/auth/password/reset\",\n                                                         data: {\n                                                            password,\n                                                         },\n                                                      },\n                                                      {\n                                                         key:\n                                                            \"portal_auth_password_reset\",\n                                                         context: {},\n                                                      }\n                                                   ).catch((err) => {\n                                                      console.log(err);\n                                                   });\n                                                }\n                                             },\n                                          },\n                                          {},\n                                       ],\n                                    },\n                                 ],\n                              },\n                           ],\n                        },\n                     ],\n                  },\n                  {},\n               ],\n            },\n            {},\n         ],\n      };\n   }\n\n   async init(AB) {\n      this.AB = AB;\n\n      L = (...params) => {\n         return this.AB.Multilingual.label(...params);\n      };\n\n      // now replace our initial placeholder with our viewable form\n      webix.ui(this.ui(), $$(\"portal_auth_login_reset_password\"));\n\n      this.AB.Network.on(\n         \"portal_auth_password_reset\",\n         (context, err, response) => {\n            // Listen for our responses:\n            // Show a popup for confirmation that an email was sent.\n            // context.email : {string} entered email address.\n\n            this.AB.emit(\"portal.show\", \"work\"); // switch to the Work Portal.\n         }\n      );\n   }\n\n   show() {\n      $$(\"portal_auth_login_reset_password\").show();\n   }\n}\n\nexport default new PortalAuthLoginResetPassword();\n","import ClassUI from \"./ClassUI.js\";\n\nvar L = null;\n\nclass PortalAuthLoginResetRequest extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui() {\n      var self = this;\n\n      if (!this.AB) {\n         // we need to init() before being able to translate our UI:\n         return {\n            id: \"portal_auth_login_reset_request\",\n         };\n      }\n\n      return {\n         id: \"portal_auth_login_reset_request\",\n         css: \"portalLogin\",\n         cols: [\n            {},\n            {\n               rows: [\n                  {},\n                  {\n                     width: 360,\n                     rows: [\n                        {\n                           id: \"password_reset_email\",\n                           css: \"portalLoginForm\",\n                           padding: 30,\n                           rows: [\n                              {\n                                 template:\n                                    \"<div style='text-align: center; font-size:160px; line-height: 160px;'><i style='background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-envelope-o'></i></div>\",\n                                 borderless: true,\n                                 height: 190,\n                                 type: \"clean\",\n                              },\n                              {\n                                 id: \"portal_reset_password_form\",\n                                 view: \"form\",\n                                 type: \"clean\",\n                                 css: { background: \"transparent !important\" },\n                                 borderless: true,\n                                 elementsConfig: {\n                                    bottomPadding: 20,\n                                 },\n                                 elements: [\n                                    {\n                                       template: `<p>${L(\n                                          \"Enter your email. We'll send a link to reset your password.\"\n                                       )}</p>`,\n                                       autoheight: true,\n                                       css: {\n                                          background: \"transparent\",\n                                          border: \"none\",\n                                          \"font-size\": \"16px\",\n                                          color: \"black\",\n                                          \"text-align\": \"center\",\n                                       },\n                                    },\n                                    {\n                                       borderless: true,\n                                       cols: [\n                                          {\n                                             id: \"reset_tenantList\",\n                                             view: \"select\",\n                                             // label: \"Tenant\",\n                                             name: \"tenant\",\n                                             attributes: {\n                                                \"data-cy\": \"reset_tenantList\",\n                                             },\n                                             value: 1,\n                                             options: [\n                                                { id: 1, value: \"Master\" },\n                                                { id: 2, value: \"Release\" },\n                                             ],\n                                          },\n                                          {\n                                             id: \"reset-email\",\n                                             view: \"text\",\n                                             placeholder: L(\"Email\"),\n                                             name: \"email\",\n                                             validate: webix.rules.isEmail,\n                                             invalidMessage: L(\n                                                \"Please enter a valid email.\"\n                                             ),\n                                             validateEvent: \"blur\",\n                                          },\n                                          {\n                                             rows: [\n                                                {\n                                                   view: \"button\",\n                                                   icon: \"fa fa-paper-plane\",\n                                                   type: \"icon\",\n                                                   css: \"webix_primary\",\n                                                   autowidth: true,\n                                                   hotkey: \"enter\",\n                                                   click() {\n                                                      var email =\n                                                         $$(\"reset-email\");\n                                                      if (email.validate()) {\n                                                         email =\n                                                            email.getValue();\n                                                         var tenant =\n                                                            $$(\n                                                               \"reset_tenantList\"\n                                                            ).getValue();\n                                                         self.AB.Network.post(\n                                                            {\n                                                               url: \"/auth/login/reset\",\n                                                               data: {\n                                                                  email,\n                                                                  tenant,\n                                                                  url:\n                                                                     window\n                                                                        .location\n                                                                        .origin ||\n                                                                     window\n                                                                        .location\n                                                                        .href,\n                                                               },\n                                                            },\n                                                            {\n                                                               key: \"portal_auth_login_reset\",\n                                                               context: {\n                                                                  email,\n                                                               },\n                                                            }\n                                                         ).catch((err) => {\n                                                            console.log(err);\n                                                         });\n                                                      }\n                                                   },\n                                                },\n                                                {},\n                                             ],\n                                          },\n                                       ],\n                                    },\n                                    {\n                                       view: \"button\",\n                                       label: L(\"Back to log in\"),\n                                       css: \"webix_transparent\",\n                                       click() {\n                                          self.emit(\"login\");\n                                       },\n                                    },\n                                 ],\n                              },\n                           ],\n                        },\n                     ],\n                  },\n                  {},\n               ],\n            },\n            {},\n         ],\n      };\n   }\n\n   async init(AB) {\n      this.AB = AB;\n\n      L = (...params) => {\n         return this.AB.Multilingual.label(...params);\n      };\n\n      // now replace our initial placeholder with our viewable form\n      webix.ui(this.ui(), $$(\"portal_auth_login_reset_request\"));\n\n      var $tenant = $$(\"reset_tenantList\");\n      var siteConfig = this.AB.Config.siteConfig();\n      if (siteConfig?.tenants?.length) {\n         // replace options in tenant list with siteConfig.tenants:\n         var newOptions = [];\n         siteConfig.tenants.forEach((t) => {\n            var opt = {\n               id: t.uuid,\n               value: t.title || t.key,\n            };\n            newOptions.push(opt);\n         });\n\n         $tenant.define(\"options\", newOptions);\n      }\n\n      var tID = this.AB.Tenant.id();\n      if (tID) {\n         $tenant.define(\"value\", tID);\n\n         // if the tID matches one of our options, then we can hide\n         // the input.\n         // eg: they entered a route [tenant].our.url\n         // we simple auto select the tenant and don't show this component.\n         var opt = newOptions.find((o) => o.id == tID);\n         if (opt) {\n            $tenant.hide();\n         }\n      }\n\n      this.AB.Network.on(\n         \"portal_auth_login_reset\",\n         (context, err, response) => {\n            // Listen for our responses:\n            // Show a popup for confirmation that an email was sent.\n            // context.email : {string} entered email address.\n\n            var text = L(\n               \"<p>An email with instructions on how to reset your password has been sent to <b>{0}</b>.</p><p>Check your spam or junk folder if you dont see the email in your inbox.</p>\",\n               [context.email]\n            );\n\n            webix.alert({\n               title: L(\"Email Sent\"),\n               ok: L(\"Okay\"),\n               width: 500,\n               text: text,\n            });\n         }\n      );\n   }\n\n   show() {\n      $$(\"portal_auth_login_reset_request\").show();\n   }\n}\n\nexport default new PortalAuthLoginResetRequest();\n","import ClassUI from \"./ClassUI.js\";\nimport PortalAuthLoginForm from \"./portal_auth_login_form.js\";\nimport PortalAuthLoginResetPassword from \"./portal_auth_login_resetPassword.js\";\nimport PortalAuthLoginResetRequest from \"./portal_auth_login_resetRequest.js\";\n\nclass PortalAuthLogin extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui() {\n      var self = this;\n\n      return {\n         id: \"portal_auth_login\",\n         view: \"multiview\",\n         animate: false,\n         rows: [\n            PortalAuthLoginForm.ui(),\n            PortalAuthLoginResetPassword.ui(),\n            PortalAuthLoginResetRequest.ui(),\n         ],\n      };\n   }\n\n   async init(AB) {\n      this.AB = AB;\n\n      var allInits = [];\n      allInits.push(PortalAuthLoginForm.init(AB));\n      PortalAuthLoginForm.on(\"request.reset\", () => {\n         PortalAuthLoginResetRequest.show();\n      });\n\n      allInits.push(PortalAuthLoginResetRequest.init(AB));\n      PortalAuthLoginResetRequest.on(\"login\", () => {\n         PortalAuthLoginForm.show();\n      });\n\n      allInits.push(PortalAuthLoginResetPassword.init(AB));\n      PortalAuthLoginResetPassword.on(\"updated\", () => {\n         console.log(\">>>> Password Changed ... NOW WHAT? <<<<<<\");\n      });\n\n      await Promise.all(allInits);\n   }\n\n   show(defaultView) {\n      // defaultView should be:\n      //   \"auth_login_form\",\n      //   \"auth_login_passwordReset\"\n\n      if (defaultView) {\n         var view = defaultView.split(\"_\").pop();\n         switch (view) {\n            case \"resetPassword\":\n               PortalAuthLoginResetPassword.show();\n               break;\n\n            default:\n            case \"form\":\n               PortalAuthLoginForm.show();\n               break;\n         }\n         return;\n      }\n\n      // Default to the LoginForm\n      PortalAuthLoginForm.show();\n   }\n}\n\nexport default new PortalAuthLogin();\n","import ClassUI from \"./ClassUI.js\";\n\n// sub pages:\nimport PortalAuthLogin from \"./portal_auth_login.js\";\n\nclass PortalAuth extends ClassUI {\n   constructor() {\n      super();\n\n      this.ActivePortal = null;\n      // {PortalAuthxxx} ActivePortal\n      // the UI Portal to use for Authenticating our User for this Tenant.\n   }\n\n   ui() {\n      var self = this;\n\n      return {\n         id: \"portal_auth\",\n         view: \"multiview\",\n         animate: false,\n         cells: [PortalAuthLogin.ui()],\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n\n      // decide which Auth Portal to display:\n      var authType = this.AB.Tenant.setting(\"authType\") || \"login\";\n      switch (authType) {\n         case \"login\":\n            this.ActivePortal = PortalAuthLogin;\n            break;\n\n         case \"passwordless\":\n            break;\n\n         case \"facebook\":\n            break;\n\n         case \"google\":\n            break;\n      }\n\n      return this.ActivePortal?.init(AB).then(() => {\n         this.ActivePortal?.show();\n      });\n   }\n\n   show(defaultView) {\n      // We cannot properly store the session id if users navigate directly to /home\n      // so when they navigate to /home and it was not a redirect we send them back to /\n      if (\n         window?.location?.pathname == \"/home\" &&\n         !window?.performance?.navigation?.redirectCount\n      )\n         window.location.replace(window.location.origin);\n\n      $$(\"portal_auth\").show();\n      this.ActivePortal.show(defaultView);\n   }\n}\n\nexport default new PortalAuth();\n","import ClassUI from \"./ClassUI\";\n\nclass ClassUIPage extends ClassUI {\n   constructor(containerID, page, App, AB) {\n      super();\n\n      this.containerID = containerID;\n      // {string}\n      // the webix $$(containerID) reference to attach this UI to.\n      // Typically the portal_work generates a series of container placeholders\n      // and these ClassUIPage will attach themselves to them.\n\n      this.page = page;\n      // {ABViewPage}\n      // The Root Page that this container is displaying.\n\n      this.App = App;\n      // {ABComponent.App}\n      // The common UI Component App factory.\n\n      this.AB = AB;\n      // {ABFactory}\n      // The common ABFactory being shared for all our ABxxx Objects.\n\n      this.initialized = false;\n      // {bool}\n      // indicates if the User had chosen to display this page yet.\n      // We prevent loading our data and building the page until the\n      // User decides to show the page.\n\n      this.pageStack = [];\n      // {array}\n      // Keep track of the {ABViewPage.id} that have been showPage()ed.\n      // The last element in the stack should be the Actively Shown page.\n      // If the stack is empty, then we are showing the RootPage.\n\n      this.pageComponents = {};\n      // {hash}  { ABViewPage.id : ABViewPage.component() }\n      // we keep track of all the ui.component() of our possible views to\n      // prevent having to regenerate them and quickly access their values.\n\n      this.changePageEventIds = {};\n      // {hash}  { ABViewPage.id : .on(\"changePage\") }\n      // A hash of the on(\"changePage\") listeners for each page. Used to\n      // prevent multiple listeners added to a Page\n   }\n\n   ui() {\n      // NOTE: the .container === .id\n      // so this REPLACES the container created by the portal_work\n      var placeholder = {};\n      if (this.page && this.page.isRoot()) {\n         // some pages can take a while to initialize.\n         // add a spinner to indicate it is busy\n         placeholder = {\n            type: \"clean\",\n            css: { \"text-align\": \"center\" },\n            template:\n               '<div style=\"height: 100vh; width: 100%; background: #ebedf0;\" class=\"webix_progress_icon\"><div class=\"webix_progress_state wxi-sync webix_spin\"></div></div>',\n         };\n      }\n      return {\n         view: \"multiview\",\n         // container: this.containerID,\n         css: \"ab-main-container ab-generated-page\",\n         borderless: true,\n         id: this.containerID,\n         animate: false,\n         cells: [placeholder],\n         on: {\n            // onViewChange: (prevId, nextId) => {\n            //    this.resize();\n            // },\n         },\n      };\n   }\n\n   init(AB, render = false, showPage = true) {\n      if (AB) {\n         this.AB = AB;\n      }\n\n      // don't redo all this if we already have!\n      if (this.initialized) return Promise.resolve();\n\n      var myUI = this.ui();\n      webix.ui(myUI, $$(this.containerID));\n\n      if (!render) {\n         return Promise.resolve();\n      }\n\n      // .init() returns a Promise\n      return new Promise((resolve /*, reject */) => {\n         // 1) make sure all Application DataCollections have started\n         //    initialization.\n         this.page.application.datacollectionsIncluded().forEach((dc) => {\n            if (!dc) return;\n\n            dc.init();\n         });\n\n         // 2) Render all our Pages\n         this.renderPage(this.page);\n\n         // 3) After we are rendered, we are technically initialized\n         this.initialized = true;\n\n         // 4) Make sure our Root Page is \"shown\"\n         this.showPage();\n\n         if (!showPage) {\n            let parView = $$(this.containerID).getParentView();\n            parView.showBatch(parView.getValue(), false);\n         }\n\n         resolve();\n      });\n   }\n\n   /**\n    * initEvents()\n    * Setup the listeners for each page.  There are 3 main events we are\n    * concerned with:\n    *    \"changePage\" =>\n    *          generated by our Page / Sub Page / Sub view\n    *          indicates when a new page should be displayed.\n    *    \"ab.interface.update\" =>\n    *          generated by the server.\n    *          indicates that the Definition of our interface\n    *          has changed and we need to redisplay.\n    *    \"ab.datacollection.update\" = >\n    *          generated by the server.\n    *          indicates one of the DataCollections have been updated.\n    *          if it is one we are depending on, we need to redisplay\n    *\n    * @param {ABViewPage} page\n    *       The ABViewPage to establish listeners on.\n    */\n   initEvents(page) {\n      if (page == null) return;\n\n      // { pageId: eventId, ..., pageIdn: eventIdn }\n      this.changePageEventIds = this.changePageEventIds || {};\n\n      // prevent duplicate event registrations\n      if (!this.changePageEventIds[page.id]) {\n         this.changePageEventIds[page.id] = page.on(\"changePage\", (pageID) => {\n            this.showPage(pageID);\n         });\n      }\n\n      let needToReloadPage = () => {\n         // clear the cache of events\n         this.changePageEventIds = {};\n\n         this.initialized = false;\n\n         // begin the process of reloading the page\n         this.init(this.AB, true, false);\n      };\n\n      if (!this.updatePageEventId && page.isRoot()) {\n         /**\n          * @event ab.interface.update\n          * This event is triggered when the root page is updated\n          *\n          * @param data.rootPage {uuid} - id of the root page\n          */\n         this.updatePageEventId = this.AB.on(\n            \"ab.interface.update\",\n            function (data) {\n               if (page.id == data.rootPageId) {\n                  needToReloadPage();\n               }\n            }\n         );\n      }\n\n      if (!this.updateDatacollectionEventId && page.isRoot()) {\n         /**\n          * @event ab.datacollection.update\n          * This event is triggered when the datacollection is updated\n          * Make sure we only update the Display if it was a DC that was\n          * included in this Page's Application.\n          *\n          * @param data.datacollectionId {uuid} - id of the data view\n          */\n         this.updateDatacollectionEventId = this.AB.on(\n            \"ab.datacollection.update\",\n            (data) => {\n               let updatedDC = this.page.application.datacollectionsIncluded(\n                  (dc) => dc.id == data.datacollectionId\n               )[0];\n               if (updatedDC) {\n                  needToReloadPage();\n               }\n            }\n         );\n      }\n   }\n\n   /**\n    * renderPage()\n    * create the Webix UI for the given ABViewPage and all it's Sub Pages.\n    * This routine creates the component.ui, and performs the component.init()\n    * but does not perform the final component.onShow() ( that happens in the\n    * showPage() method.)\n    * @param {ABViewPage} page\n    */\n   renderPage(page) {\n      if (window.webixLocale) {\n         setTimeout(() => {\n            webix.i18n.setLocale(window.webixLocale);\n         }, 500);\n      }\n      var component = page.component(this.App);\n      var ui = component.ui;\n\n      // Keep the page component\n      this.pageComponents[page.id] = component;\n\n      var myContainer = $$(this.containerID);\n      // {webix.ui}\n      // Referencing our container. Since we seem to make numerous references\n      // to this below, let's just pull it 1x.\n\n      // James:\n      // this is pulled in from our previous v1 code. Not sure if it is still\n      // relevant.\n      // TODO: review this and how this works in context of our Webix Only\n      // Portal.\n      // Also, notice how we are referencing the internal data of a Page object?\n      // there should be an accessor method (like page.setting(\"pageWidth\"))\n      // that returns the data we need.\n      /*\n      if (\n         parseInt(page.settings.pageWidth) > 0 &&\n         parseInt(page.settings.fixedPageWidth) == 1\n      ) {\n         var parentContainer = this.element.parent()[0];\n         parentContainer.style.width = parseInt(page.settings.pageWidth) + \"px\";\n         parentContainer.style.margin = \"0 auto\";\n         parentContainer.classList.add(page.settings.pageBackground);\n      }\n      */\n\n      var type = page.settings?.type ?? \"\";\n      if (typeof page.type === \"function\") {\n         // plugin method.\n         type = page.type();\n      }\n      switch (type) {\n         case \"popup\":\n            var popupTemplate = {\n               view: \"window\",\n               id: page.id,\n               modal: true,\n               position: \"center\",\n               resize: true,\n               width: parseInt(page.settings.popupWidth) || 700,\n               height: parseInt(page.settings.popupHeight) + 44 || 450,\n               css: \"ab-main-container\",\n               head: {\n                  view: \"toolbar\",\n                  css: \"webix_dark\",\n                  cols: [\n                     {\n                        view: \"label\",\n                        label: page.label,\n                        css: \"modal_title\",\n                        align: \"center\",\n                     },\n                     {\n                        view: \"button\",\n                        label: \"Close\",\n                        autowidth: true,\n                        align: \"center\",\n                        click: () => {\n                           this.showPage();\n                           // var popup = this.getTopParentView();\n                           // popup.hide();\n                        },\n                        on: {\n                           //Add data-cy attribute to the close button\n                           onAfterRender: () => {\n                              const button = $$(page.id).queryView(\"button\");\n                              const dataCy = `Popup Close Button ${page.name} ${page.id}`;\n                              button\n                                 .getInputNode()\n                                 .setAttribute(\"data-cy\", dataCy);\n                           },\n                        },\n                     },\n                  ],\n               },\n               body: {\n                  view: \"scrollview\",\n                  scroll: true,\n                  body: ui,\n               },\n            };\n\n            var oldView = $$(page.id);\n            if (oldView) {\n               // if it is a Popup, destroy() it\n               if (oldView.config.view == \"window\") {\n                  oldView.destructor();\n               }\n               // else remove the view from our multiview\n               else if (myContainer) {\n                  myContainer.removeView(page.id);\n               }\n            }\n\n            // Now create the New one (hidden)\n            try {\n               webix.ui(popupTemplate).hide();\n            } catch (e) {\n               console.error(\"Error creating Page:\", page);\n               console.error(e);\n               // debugger;\n            }\n            break;\n\n         case \"page\":\n         default:\n            // Define page id to be batch id of webix.multiview\n            ui.batch = page.id;\n\n            // if this view already exists\n            var oldPage = $$(page.id);\n            if (oldPage) {\n               // if the old view was a popup, but now we want it as\n               // a page, we need to move it to our multiview\n               if (oldPage.config.view == \"window\") {\n                  oldPage.destructor();\n\n                  myContainer.addView(ui);\n               }\n               // else we want to rebuild it.\n               else {\n                  webix.ui(ui, oldPage);\n               }\n            }\n            // else this is our first time so add it\n            else if (myContainer) {\n               myContainer.addView(ui);\n            }\n\n            break;\n      }\n\n      // handle events\n      this.initEvents(page);\n\n      // Render child pages\n      (page.pages() || []).forEach((subpage) => {\n         this.renderPage(subpage);\n      });\n\n      // Initial UI components\n      component.init();\n   }\n\n   /**\n    * show()\n    * is called by the main portal_work when a menu item is selected and this\n    * container should be displayed.\n    */\n   show() {\n      var container = $$(this.containerID);\n      if (container) {\n         if (!this.initialized) {\n            // this is our 1st time to show, so wait for our initial loading\n            // container to display, before causing it to be transformed into\n            // our Page.\n            var eventID = container.attachEvent(\"onViewShow\", () => {\n               // only 1x\n               container.detachEvent(eventID);\n               // give ourselves some additional space to make sure animations\n               // are complete or operational before the .init() which can be\n               // resource intensive.\n               setTimeout(() => {\n                  this.init(this.AB, true);\n                  container.show();\n               }, 50);\n            });\n         }\n\n         container.show();\n      }\n   }\n\n   /**\n    * showPage()\n    * A RootPage can have several SubPages that it wants to display during\n    * it's normal operation.  An embedded view component can trigger an\n    * .emit(\"showPage\", pageID) that will get propagated up to our RootPage\n    * and showPage(pageID) will be called.\n    *\n    * For example, an ABViewMenu object will have a button clicked and it will\n    * signal this to show the desired Page.\n    *\n    * If a showPage() is called with no parameter, then we are being requested\n    * to return to the previous page before the current one.\n    * @param {string} pageID\n    *       The {ABViewPage.id} of the page to show.\n    * @param {string} viewID\n    *       An additional ABViewxxx.id that can also be signaled to show.\n    *       ?? Usually on the Page we just showed, so you can specify a\n    *       page + view.\n    */\n   showPage(pageID, viewId) {\n      var showPageID = null;\n      // {string}\n      // This is the actual pageID of the ABViewPage to display.\n\n      // in any case, if the active page is not the requested page,\n      // we hide it:\n      var activeID = this.pageStack[this.pageStack.length - 1];\n      if (activeID) {\n         // if the actively displayed page is what is being asked for\n         // we can just exit.\n         if (activeID == pageID) {\n            return; //\n         }\n\n         // otherwise we need to hide() any popups / pages\n         var activeUI = $$(activeID);\n         if (activeUI && activeUI.hide) activeUI.hide();\n      }\n\n      // if no pageID provided, then we are displaying a previous page:\n      if (!pageID) {\n         // pull the last View displayed & remove it.\n         this.pageStack.pop();\n      } else {\n         // be sure not to add our Root Page to the stack\n         if (this.page.id != pageID) {\n            // add the new pageID to our stack:\n            // REMEMBER: last item is what should be show()n\n            this.pageStack.push(pageID);\n         } else {\n            // in this case: we have items in our .pageStack, but we are told\n            // to return to our RootPage;\n            // clear out our .pageStack and we will return to our root\n            this.pageStack = [];\n         }\n      }\n\n      // now get the ID of the page to show\n      showPageID = this.pageStack[this.pageStack.length - 1];\n      if (!showPageID) {\n         // then we want to display the Root Page:\n         showPageID = this.page.id;\n      }\n\n      if (!showPageID) {\n         // if we get here and don't have a showPageID ... something didn't\n         // go as planned:\n         this.AB.error(\n            new Error(`Unable to resolve showPage() with pageID[${pageID}]`)\n         );\n      } else {\n         // make sure a popup is shown\n         if ($$(showPageID)) $$(showPageID).show();\n\n         // if our MultiView has this batch then show batch\n         var batchExist = false;\n         var childViews = $$(this.containerID).getChildViews();\n         batchExist = childViews.filter(function (v) {\n            return v.config.batch == showPageID;\n         })[0];\n         if (batchExist) $$(this.containerID).showBatch(showPageID);\n\n         // now make sure the actual component's .onShow() is called\n         // But perform a Timeout() so any current webix animations\n         // complete beforehand:\n         setTimeout(() => {\n            if (\n               this.pageComponents[showPageID] &&\n               this.pageComponents[showPageID].onShow\n            ) {\n               // for (const element of document\n               //    .getElementById(self.containerDomID)\n               //    .getElementsByClassName(\"ab-loading\")) {\n               //    element.style.display = \"none\";\n               // }\n               this.pageComponents[showPageID].onShow();\n               if (viewId) {\n                  $$(viewId).show();\n               }\n            }\n         }, 60);\n      }\n   }\n\n   /*\n   removePage(pageId) {\n      var pageCom = this.pageComponents[pageId];\n      var pageElemId = pageCom.ui.id;\n\n      // swtich the page before it will be removed\n      if (this.activePageId == pageId) {\n         this.showPage(this.rootPage.id);\n      }\n\n      // remove from .multiview\n      $$(this.containerDomID).removeView(pageElemId);\n\n      // destroy view's modal\n      if ($$(pageElemId)) $$(pageElemId).destructor();\n   }\n   */\n}\n\nexport default ClassUIPage;\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalWorkInboxAccordion extends ClassUI {\n   constructor(app) {\n      super();\n\n      this.app = app;\n      this.id = `inbox-accordion-app-holder-${this.app.id}`;\n      this.idUnitList = `inbox-accordion-app-${this.app.id}`;\n   }\n\n   ui() {\n      const self = this;\n      // for .click() handler below:\n\n      return {\n         header: this.app.label,\n         id: this.id,\n         view: \"accordionitem\",\n         collapsed: true,\n         css: \"stayCollapsed\",\n         hidden: true,\n         body: {\n            view: \"unitlist\",\n            id: this.idUnitList,\n            uniteBy: \"#uniteLabel#\",\n            autoheight: true,\n            css: \"inbox_unitlist\",\n            type: {\n               templateHeader: function (value) {\n                  return (\n                     '<i style=\"opacity: 0.4\" class=\"fa fa-fw fa-code-fork fa-rotate-90\"></i> ' +\n                     value.replace(/{(.*?)}/, \"\")\n                  );\n               },\n               headerHeight: 35,\n            },\n            template: function (obj) {\n               return (\n                  obj.name +\n                  \" <span class='pull-right webix_badge'>\" +\n                  obj.items.length +\n                  \"</span>\"\n               );\n            },\n            select: true,\n            data: [],\n            click: function (id /* , ev */) {\n               const list = this;\n               // const parent = this.getParentView();\n               const selectedItem = this.getItem(id);\n\n               const cells = [];\n               // {array}\n               // the webix defs for the Form.io forms for this selection.\n\n               // const number = 1;\n               selectedItem.items.forEach(function (task) {\n                  if (task.data?.url) {\n                     cells.push({\n                        id: \"task-holder-\" + task.uuid,\n                        unitlist: list,\n                        view: \"layout\",\n                        padding: 20,\n                        rows: [\n                           {\n                              id: task.uuid,\n                              view: \"iframe\",\n                              src: task.data.url,\n                           },\n                        ],\n                     });\n                  } else\n                     cells.push({\n                        id: \"task-holder-\" + task.uuid,\n                        unitlist: list,\n                        view: \"layout\",\n                        padding: 20,\n                        rows: [\n                           {\n                              id: task.uuid,\n                              view: \"formiopreview\",\n                              formComponents: task.ui,\n                              formData: task.data,\n                              onButton: function (value) {\n                                 self.processItem(id, task, value);\n                              },\n                           },\n                        ],\n                     });\n               });\n\n               self.emit(\"showTasks\", /*list, */ selectedItem.name, cells);\n            },\n            on: {\n               onAfterRender() {\n                  ClassUI.CYPRESS_REF(this);\n                  this.data.each((a) => {\n                     ClassUI.CYPRESS_REF(\n                        this.getItemNode(a.id),\n                        `${self.id}_${a.id}`\n                     );\n                  });\n               },\n            },\n         },\n         // TODO: This never gets called!\n         // on: {\n         //    onAfterRender() {\n         //       ClassUI.CYPRESS_REF(this);\n         //    },\n         // },\n      };\n   }\n\n   init(AB) {\n      // prevent multiple .init() calls\n      if (!this.AB) {\n         this.AB = AB;\n\n         this.AB.Network.on(\"inbox.update\", (context, err /* , response */) => {\n            if (err && err.message) {\n               webix.message(err.message);\n               this.AB.notify.developer(err, {\n                  context:\n                     \"portal_work_inbox_accordion:Network[inbox.update]: error updating Inbox item\",\n                  info: context,\n               });\n               return;\n            }\n\n            const list = $$(this.idUnitList);\n            const selectedItem = list.getItem(context.unitID);\n\n            // clear out processed item from our accordion\n            // prune the item from the group of similar processes in the unit list\n            if (selectedItem) {\n               const parent = list.getParentView();\n\n               selectedItem.items = selectedItem.items.filter(function (i) {\n                  return i.uuid != context.uuid;\n               });\n\n               // refresh the unit list so we can get an update badge count\n               list.refresh();\n               if (selectedItem.items.length == 0) {\n                  // remove the item from the unit list\n                  list.remove(list.getSelectedId());\n                  // if that was the last item in the unit list remove the accordion\n                  if (list.count() == 0) {\n                     parent.hide();\n                  }\n               }\n            }\n\n            this.emit(\"item.processed\", context.uuid);\n         });\n      }\n\n      return Promise.resolve();\n   }\n\n   unitList() {\n      return $$(this.idUnitList);\n   }\n\n   /**\n    * @method processItem()\n    * submit the current task's response back to the server.\n    * @param {ABProcessForm} task\n    *        the current form that is being responded to.\n    * @param {string} value\n    *        the value of the Form button returned.\n    */\n   processItem(unitID, task, value) {\n      this.AB.Network.put(\n         {\n            url: `/process/inbox/${task.uuid}`,\n            data: { response: value },\n         },\n         {\n            key: \"inbox.update\",\n            context: { uuid: task.uuid, unitID },\n         }\n      );\n\n      return;\n   }\n\n   show() {\n      $$(this.id).show();\n      $$(this.id).expand();\n      this.initFormIOPreview();\n   }\n\n   /**\n    * Ensure the formio custom webix component is loaded and ready to\n    * use.\n    */\n   initFormIOPreview() {\n      this.AB.custom.formiopreview.init();\n   }\n}\n\nexport default PortalWorkInboxAccordion;\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalWorkInboxTaskwindow extends ClassUI {\n   constructor() {\n      super();\n      this.id = \"portal_work_inbox_taskwindow\";\n      this.idTaskMultiview = \"taskMultiview\";\n      this.idTaskTitle = \"taskTitle\";\n      this.idTaskPager = \"taskPager\";\n   }\n\n   ui() {\n      var L = (...params) => {\n         return this.label(...params);\n      };\n      return {\n         id: this.id,\n         view: \"window\",\n         position: function (state) {\n            state.left = state.maxWidth / 2 - 800 / 2; // fixed values\n            state.top = state.maxHeight / 2 - (state.maxHeight * 0.7) / 2;\n            state.width = 800; // relative values\n            state.height = state.maxHeight * 0.7;\n         },\n         modal: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               { width: 17 },\n               {\n                  id: this.idTaskTitle,\n                  view: \"label\",\n                  label: L(\"Your Tasks\"),\n               },\n               {\n                  view: \"button\",\n                  autowidth: true,\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     $$(this.id).hide();\n                     // we don't want the list to look like it has still selected the item\n                     $$(this.idTaskMultiview)\n                        .getChildViews()[0]\n                        .config.unitlist.unselectAll();\n                     // reset the pager so we don't get errors when we open it next\n                     $$(this.idTaskPager).select(0);\n                  },\n                  on: {\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this, \"inbox_taskwindow_close\");\n                     },\n                  },\n               },\n            ],\n         },\n         body: {\n            rows: [\n               {\n                  view: \"scrollview\",\n                  scroll: \"xy\",\n                  body: {\n                     id: this.idTaskMultiview,\n                     cells: [\n                        {\n                           view: \"layout\",\n                           padding: 20,\n                           rows: [\n                              {\n                                 id: \"emptyTasks\",\n                                 template: L(\"No more tasks...good job!\"),\n                              },\n                           ],\n                        },\n                     ],\n                  },\n               },\n               {\n                  view: \"toolbar\",\n                  css: \"inboxpager\",\n                  cols: [\n                     {\n                        id: this.idTaskPager,\n                        view: \"pager\",\n                        size: 1,\n                        group: 3,\n                        height: 45,\n                        master: false,\n                        template:\n                           '<div style=\"margin-top:9px; text-align: center;\">{common.first()} {common.prev()} {common.pages()} {common.next()} {common.last()}</div>',\n                        on: {\n                           onAfterRender() {\n                              // debugger;\n                              ClassUI.CYPRESS_REF(this);\n                              // this.data.each((a) => {\n                              //    ClassUI.CYPRESS_REF(\n                              //       this.getItemNode(a.id),\n                              //       `${self.id}_${a.id}`\n                              //    );\n                              // });\n                           },\n                           onBeforePageChange: (new_page /*, old_page  */) => {\n                              var views = $$(\n                                 this.idTaskMultiview\n                              ).getChildViews();\n                              views[parseInt(new_page)].show();\n                           },\n                        },\n                     },\n                  ],\n               },\n            ],\n         },\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n      webix.ui(this.ui());\n\n      return Promise.resolve();\n   }\n\n   clearTask(uuid) {\n      // find out how many pages are in this multiview\n      var views = $$(this.idTaskMultiview).getChildViews();\n      // if there is more than one page we need to find out what the next page should be\n      if (views.length > 1) {\n         var taskHolder = $$(\"task-holder-\" + uuid);\n         if (taskHolder) {\n            // find out if we are on the last page\n            if (\n               $$(this.idTaskMultiview).index(taskHolder) + 1 ==\n               views.length\n            ) {\n               // if we are on the last page we will go back to the previous page\n               $$(this.idTaskMultiview).setValue(\n                  views[$$(this.idTaskMultiview).index(taskHolder) - 1].config\n                     .id\n               );\n            } else {\n               // if we are not on the last page we will go to the next page\n               $$(this.idTaskMultiview).setValue(\n                  views[$$(this.idTaskMultiview).index(taskHolder) + 1].config\n                     .id\n               );\n            }\n            // once we move off of the page we can remove it\n            $$(this.idTaskMultiview).removeView(\n               views[$$(this.idTaskMultiview).index(taskHolder)]\n            );\n         }\n\n         // // prune the item from the group of similar processes in the unit list\n         // if (this.selectedItem) {\n         //    this.selectedItem.items = this.selectedItem.items.filter(function (\n         //       i\n         //    ) {\n         //       return i.uuid != uuid;\n         //    });\n         // }\n         // // refresh the unit list so we can get an update badge count\n         // this.list.refresh();\n\n         // now we update the pager\n         // block events because we don't want it telling the multiview to change pages after we set the new value\n         $$(this.idTaskPager).blockEvent();\n         // set the page to the first while we rebuild the pager (or it will throw an error)\n         $$(this.idTaskPager).select(0);\n         // set the current number of pages to the number of views in the multiview\n         $$(this.idTaskPager).define(\n            \"count\",\n            $$(this.idTaskMultiview).getChildViews().length\n         );\n         $$(this.idTaskPager).refresh();\n         // set the page to the correct number because it probably changed when we removed a view above\n         $$(this.idTaskPager).select(\n            $$(this.idTaskMultiview).index(\n               $$(this.idTaskMultiview).getActiveId()\n            )\n         );\n         $$(this.idTaskPager).unblockEvent();\n      } else {\n         // no more tasks hide the modal\n         $$(this.id).hide();\n         // // remove the item from the unit list\n         // this.list.remove(this.list.getSelectedId());\n         // // if that was the last item in the unit list remove the accordion\n         // if (this.list.count() == 0) {\n         //    parent.hide();\n         // }\n      }\n   }\n\n   hide() {\n      $$(this.id).hide();\n   }\n\n   show() {\n      $$(this.id).show();\n   }\n\n   showTasks(/* unitList, */ selectedItemName, cells) {\n      // this.list = unitList;\n      // this.selectedItem = selectedItem;\n      webix.ui(\n         {\n            id: this.idTaskMultiview,\n            cells: cells,\n         },\n         $$(this.idTaskMultiview)\n      );\n\n      $$(this.idTaskTitle).define(\"label\", selectedItemName);\n      $$(this.idTaskPager).define(\"count\", cells.length);\n      $$(this.idTaskPager).refresh();\n      $$(this.id).show();\n   }\n}\n\nexport default new PortalWorkInboxTaskwindow();\n","import ClassUI from \"./ClassUI.js\";\nimport ClassAccordionEntry from \"./portal_work_inbox_accordion.js\";\nimport PortalWorkInboxTaskWindow from \"./portal_work_inbox_taskWindow.js\";\n\nclass PortalWorkInbox extends ClassUI {\n   constructor() {\n      super();\n\n      this.id = \"portal_work_inbox\";\n      // {string}\n      // the webix.id of this UI element\n\n      this.entries = [];\n      // {array}\n      // the list of User Forms this user is able to process.\n\n      this.processLookupHash = {\n         /* ABProcess.id : \"Process Label\" */\n      };\n\n      this.appLookupHash = {\n         /* ABProcess.id : \"ABApplication.id\" */\n      };\n\n      this.appAccordionLists = {};\n      // {hash}  { app.id : {accordionItemDefinition} }\n   }\n\n   ui() {\n      var L = (...params) => {\n         return this.label(...params);\n      };\n\n      return {\n         id: this.id,\n         view: \"window\",\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark inbox_drawer\",\n            cols: [\n               { width: 7 },\n               {\n                  view: \"label\",\n                  label: L(\"Inbox\"),\n               },\n               {\n                  view: \"button\",\n                  autowidth: true,\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     $$(this.id).hide();\n                  },\n                  on: {\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this);\n                     },\n                  },\n               },\n            ],\n         },\n         position: function (state) {\n            state.left = state.maxWidth - 350; // fixed values\n            state.top = 0;\n            state.width = 350; // relative values\n            state.height = state.maxHeight;\n         },\n         body: {\n            cells: [\n               {\n                  id: \"inboxItems\",\n                  view: \"scrollview\",\n                  scroll: \"y\",\n                  body: {\n                     view: \"accordion\",\n                     id: \"inbox_accordion\",\n                     css: {\n                        background: \"#dadee0 !important\",\n                     },\n                     multi: true,\n                     rows: [],\n                  },\n               },\n               {\n                  id: \"emptyInbox\",\n                  view: \"layout\",\n                  hidden: true,\n                  css: {\n                     background: \"#dadee0 !important\",\n                  },\n                  rows: [\n                     {},\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        height: 200,\n                        label: \"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-thumbs-up'></div>\",\n                     },\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        label: L(\"No tasks...you're all caught up.\"),\n                     },\n                     {},\n                  ],\n               },\n            ],\n         },\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n\n      webix.ui(this.ui());\n\n      this.allAppAccordions = {};\n      // {hash}  { ABApplication.id : ClassAccordionEntry }\n      // A lookup of all our ClassAccordionEntry(s) by their app.id\n\n      //\n      // Prepare our Hashes:\n      //\n      this.lang = this.AB.Account.language();\n      (this.AB.Config.inboxMetaConfig() || []).forEach((app) => {\n         this.createAccordian(app);\n      });\n\n      this.entries = this.AB.Config.inboxConfig() || [];\n\n      this.entries.forEach((i) => this.addItem(i));\n\n      var allInits = [];\n\n      for (var index in this.appAccordionLists) {\n         const processes = this.getProcessList(index);\n\n         const accordion = this.allAppAccordions[index]\n            ? this.allAppAccordions[index].unitList()\n            : null;\n         if (accordion) {\n            const init = async () => {\n               await this.allAppAccordions[index].init(this.AB);\n               accordion.parse(processes);\n               accordion.show();\n            };\n            allInits.push(init());\n         } else {\n            this.AB.notify.developer(\n               new Error(\n                  `could not find an inbox-accordion for index[${index}]`\n               ),\n               {\n                  context: \"portal_work_inbox:init(): config error\",\n                  inboxMeta: this.AB.Config.inboxMetaConfig(),\n                  inbox: this.entries,\n               }\n            );\n         }\n      }\n\n      return Promise.all(allInits).then(() => {\n         this.emit(\"updated\");\n\n         this.AB.on(\"ab.inbox.create\", async (item) => {\n            const alreadyThere = this.entries.find((e) => e.uuid == item.uuid);\n            if (!alreadyThere) {\n               this.entries.push(item);\n               // If we can't find the app's accordion in the list then add it\n               const createNew = !this.appLookupHash[item.definition];\n               if (createNew) {\n                  const [app] = await this.AB.Network.post({\n                     url: \"/process/inbox/meta\",\n                     data: { ids: [item.definition] },\n                  });\n                  this.createAccordian(app);\n               }\n               const appId = this.appLookupHash[item.definition];\n               const accordion = this.allAppAccordions[appId];\n               this.addItem(item);\n\n               if (createNew) await accordion.init(this.AB);\n\n               const unitList = accordion.unitList();\n               unitList.parse(this.appAccordionLists[appId][item.definition]);\n               unitList.show();\n               unitList.refresh();\n\n               accordion.show();\n            }\n            this.emit(\"updated\");\n         });\n\n         this.AB.on(\"ab.inbox.update\", (item) => {\n            const appId = this.appLookupHash[item.definition];\n            const accordion = this.allAppAccordions[appId];\n\n            accordion.AB.Network.emit(\"inbox.update\", {\n               uuid: item.uuid,\n               unitID: item.definition,\n            });\n         });\n\n         // Now Register for RT Updates to our Inbox\n         this.AB.Network.post(\n            {\n               url: `/process/inbox/register`,\n            },\n            {\n               key: \"inbox.register\",\n               context: {},\n            }\n         );\n      });\n   }\n\n   createAccordian(app) {\n      // convert config info with current language labels\n      this.translate(app, this.lang);\n\n      const appAccordion = new ClassAccordionEntry(app);\n      $$(\"inbox_accordion\").addView(appAccordion.ui());\n      this.allAppAccordions[app.id] = appAccordion;\n      appAccordion.on(\"showTasks\", (...params) => {\n         // showTasks\n         // indicates when the user has selected a group of Accordian Tasks\n         // to process.\n         PortalWorkInboxTaskWindow.showTasks(...params);\n      });\n\n      appAccordion.on(\"item.processed\", (uuid) => {\n         // item.processed\n         // indicates when the specified form has been updated on the server.\n         PortalWorkInboxTaskWindow.clearTask(uuid);\n         this.entries = this.entries.filter((e) => e.uuid != uuid);\n         if (this.entries.length == 0) {\n            $$(\"emptyInbox\").show();\n         }\n         this.emit(\"updated\");\n      });\n\n      (app.processes || []).forEach((p) => {\n         this.translate(p, this.lang);\n         this.processLookupHash[p.id] = p.label;\n         this.appLookupHash[p.id] = app.id;\n      });\n\n      return appAccordion;\n   }\n\n   getProcessList(index) {\n      const processes = [];\n      for (const process in this.appAccordionLists[index]) {\n         processes.push(this.appAccordionLists[index][process]);\n      }\n      return processes;\n   }\n\n   addItem(item) {\n      // item {obj}  inbox configuration item\n      //    .definition {uuid} the process.id that generated this form\n      //    .name {string} the Name of this form\n      //\n      item.uniteLabel =\n         \"{\" + item.definition + \"}\" + this.processLookupHash[item.definition];\n      // create our own .uniteLabel\n      // this is used within the accordion.unitlist to group the data.\n\n      // find the application.id for this form\n      var appId = this.appLookupHash[item.definition];\n\n      // make sure we have an appAccordionLists[appID] entry\n      if (!this.appAccordionLists[appId]) this.appAccordionLists[appId] = {};\n      if (!this.appAccordionLists[appId][item.definition]) {\n         this.appAccordionLists[appId][item.definition] = {\n            id: item.definition,\n            name: item.name,\n            uniteLabel: item.uniteLabel,\n            items: [],\n         };\n      }\n\n      // add this as one of our items\n      this.appAccordionLists[appId][item.definition].items.push(item);\n   }\n\n   show() {\n      if (this.entries.length == 0) {\n         $$(\"emptyInbox\").show();\n      } else {\n         $$(\"inboxItems\").show();\n      }\n      $$(this.id).show();\n\n      for (const appId in this.allAppAccordions) {\n         this.allAppAccordions[appId]?.show();\n      }\n   }\n\n   /**\n    * @method translate()\n    * given an object with a .translations property, we will fill out\n    * the translations for the given language.\n    * @param {obj} obj\n    * @param {string} lang\n    *        the language_code of the translations to use.\n    */\n   translate(obj, lang) {\n      if (obj.translations) {\n         var entry = obj.translations.find((t) => t.language_code == lang);\n         if (!entry) {\n            entry = obj.translations[0];\n         }\n         if (entry) {\n            Object.keys(entry).forEach((k) => {\n               if (k != \"language_code\") {\n                  obj[k] = entry[k];\n               }\n            });\n         }\n      }\n   }\n\n   count() {\n      return this.entries.length;\n   }\n}\n\nexport default new PortalWorkInbox();\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalWorkUserProfileWindow extends ClassUI {\n   constructor() {\n      super(\"portal_work_user_profile_window\", {\n         imageUser: \"\",\n         uploaderImage: \"\",\n         formUserInfo: \"\",\n\n         dataEmail: \"\",\n         editModeEmail: \"\",\n         buttonEditModeEmail: \"\",\n         editModeButtonsEmail: \"\",\n\n         dataLanguage: \"\",\n         editModeLanguage: \"\",\n         buttonEditModeLanguage: \"\",\n         editModeButtonsLanguage: \"\",\n\n         formNewPassword: \"\",\n         fieldNewPassword: \"\",\n         systemNotification: \"\",\n         advanceOptions: \"\",\n      });\n   }\n\n   ui() {\n      const ids = this.ids;\n      const L = (...params) => {\n         return this.label(...params);\n      };\n\n      // [fix] preventing console 404 errors when user doesn't have an Account Image:\n      let acctImageID = this.AB.Account.imageID();\n      let imgTemplate = `<img src=\"file/${acctImageID}\" onerror=\"this.style.display='none'; document.getElementById('errorImage').style.display = 'block';\" width=\"150\" height=\"150\" style=\"border-radius: 50%; margin: 10px auto; display: block; border: 3px solid white;\" />`;\n      let imgErrorDiv = `<div id=\"errorImage\" style=\"display: none; width: 150px; height: 150px; background: #dee2e6; border-radius: 50%; margin: 10px auto; border: 3px solid white;\"><i class=\"fa fa-user\" style=\"font-size: 118px; color: white; margin: 15px 0 0 32px;\"></i></div>`;\n\n      if (acctImageID) {\n         imgTemplate = `${imgTemplate}${imgErrorDiv}`; // show both in case value is invalid\n      } else {\n         imgTemplate = imgErrorDiv.replace(\"none;\", \"block;\"); // show the Div\n      }\n\n      return {\n         id: ids.component,\n         view: \"window\",\n         position: \"center\",\n         modal: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               { width: 7 },\n               {\n                  view: \"label\",\n                  label: L(\"User Profile\"),\n               },\n               {\n                  view: \"button\",\n                  autowidth: true,\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  on: {\n                     onItemClick() {\n                        $$(ids.component).hide();\n                     },\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this);\n                     },\n                  },\n               },\n            ],\n         },\n         // body: {\n         // view: \"scrollview\",\n         // minHeight: 455,\n         body: {\n            view: \"layout\",\n            width: 460,\n            rows: [\n               {\n                  rows: [\n                     {\n                        id: ids.imageUser,\n                        view: \"template\",\n                        autoheight: true,\n                        borderless: true,\n                        css: {\n                           background: \"#222f3e\",\n                        },\n                        // width: 160,\n                        template: imgTemplate,\n                     },\n                     {\n                        css: {\n                           position: \"absolute\",\n                           top: \"185px\",\n                        },\n                        cols: [\n                           {},\n                           {\n                              id: ids.uploaderImage,\n                              view: \"uploader\",\n                              type: \"icon\",\n                              width: 34,\n                              height: 32,\n                              zIndex: 999,\n                              icon: \"fa fa-upload\",\n                              algin: \"center\",\n                              inputName: \"file\",\n                              apiOnly: true,\n                              multiple: false,\n                              accept:\n                                 \"image/png, image/gif, image/jpeg, image/bmp\",\n                              // Image field\n                              upload: `/file/upload/${\n                                 this.AB.objectUser().id\n                              }/6383ce19-b344-44ee-87e6-decced7361f8/1`,\n                              on: {\n                                 // when upload is complete:\n                                 onFileUpload: async (item, response) => {\n                                    const imageID = response.data.uuid;\n\n                                    const $uploaderImage = $$(\n                                       ids.uploaderImage\n                                    );\n                                    const $imageUser = $$(ids.imageUser);\n\n                                    $uploaderImage.disable();\n\n                                    // await this.AB.Network.put({\n                                    //    url: `/app_builder/model/${\n                                    //       this.AB.objectUser().id\n                                    //    }/${this.AB.Account.uuid()}`,\n                                    //    data: {\n                                    //       image_id: response.data.uuid,\n                                    //    },\n                                    // });\n                                    await this.AB.objectUser()\n                                       .model()\n                                       .update(this.AB.Account.uuid(), {\n                                          image_id: response.data.uuid,\n                                       });\n\n                                    this.AB.Account._config.image_id = imageID;\n\n                                    $imageUser.setHTML(\n                                       `<img src=\"file/${this.AB.Account.imageID()}\" onerror=\"this.style.display='none'; document.getElementById('errorImage').style.display = 'block';\" width=\"150\" height=\"150\" style=\"border-radius: 50%; margin: 10px auto; display: block; border: 3px solid white;\" /><div id=\"errorImage\" style=\"display: none; width: 150px; height: 150px; background: #dee2e6; border-radius: 50%; margin: 10px auto; border: 3px solid white;\"><i class=\"fa fa-user\" style=\"font-size: 118px; color: white; margin: 15px 0 0 32px;\"></i></div>`\n                                    );\n                                    $uploaderImage.enable();\n                                 },\n\n                                 // if an error was returned\n                                 onFileUploadError: (item, response) => {\n                                    const error = new Error(response);\n\n                                    const $uploaderImage = $$(\n                                       ids.uploaderImage\n                                    );\n\n                                    $uploaderImage.enable();\n\n                                    this.AB.notify.developer(error, {\n                                       context: \"Error uploading file\",\n                                    });\n                                    webix.alert(error);\n                                 },\n                              },\n                           },\n                           {},\n                        ],\n                     },\n                     {\n                        id: ids.formUserInfo,\n                        view: \"form\",\n                        width: 460,\n                        height: 160,\n                        borderless: true,\n                        css: {\n                           position: \"relative\",\n                           top: \"15px\",\n                        },\n                        elements: [\n                           {\n                              css: {\n                                 \"border-bottom\": \"1px solid #dee2e6\",\n                                 \"margin-top\": \"0 !important\",\n                              },\n                              cols: [\n                                 {\n                                    view: \"label\",\n                                    width: 160,\n                                    // align: \"right\",\n                                    label: L(\"Tenant\"),\n                                 },\n                                 {\n                                    view: \"label\",\n                                    name: \"tenant\",\n                                    value: \"\",\n                                    css: \"formText\",\n                                 },\n                              ],\n                           },\n                           {\n                              css: {\n                                 \"border-bottom\": \"1px solid #dee2e6\",\n                                 \"margin-top\": \"0 !important\",\n                              },\n                              cols: [\n                                 {\n                                    view: \"label\",\n                                    width: 160,\n                                    // align: \"right\",\n                                    label: L(\"Username\"),\n                                 },\n                                 {\n                                    view: \"label\",\n                                    name: \"username\",\n                                    value: \"\",\n                                    css: \"formText\",\n                                 },\n                              ],\n                           },\n                           {\n                              css: {\n                                 \"border-bottom\": \"1px solid #dee2e6\",\n                                 \"margin-top\": \"0 !important\",\n                              },\n                              cols: [\n                                 {\n                                    view: \"label\",\n                                    width: 160,\n                                    // align: \"right\",\n                                    label: L(\"Email\"),\n                                 },\n                                 {\n                                    id: ids.dataEmail,\n                                    view: \"label\",\n                                    name: \"email\",\n                                    value: \"\",\n                                    css: \"formText\",\n                                 },\n                                 {\n                                    id: ids.editModeEmail,\n                                    view: \"text\",\n                                    hidden: true,\n                                    value: \"\",\n                                 },\n                                 {\n                                    id: ids.buttonEditModeEmail,\n                                    view: \"button\",\n                                    type: \"icon\",\n                                    icon: \"wxi-pencil\",\n                                    width: 40,\n                                    inputWidth: 40,\n                                    on: {\n                                       onItemClick: () => {\n                                          const $dataEmail = $$(ids.dataEmail);\n                                          const $editModeEmail = $$(\n                                             ids.editModeEmail\n                                          );\n                                          const $buttonEditModeEmail = $$(\n                                             ids.buttonEditModeEmail\n                                          );\n                                          const $editModeButtonsEmail = $$(\n                                             ids.editModeButtonsEmail\n                                          );\n\n                                          $editModeEmail.setValue(\n                                             this.AB.Account.email()\n                                          );\n\n                                          $dataEmail.hide();\n                                          $buttonEditModeEmail.hide();\n\n                                          $editModeEmail.show();\n                                          $editModeButtonsEmail.show();\n                                       },\n                                    },\n                                 },\n                                 {\n                                    id: ids.editModeButtonsEmail,\n                                    hidden: true,\n                                    cols: [\n                                       {\n                                          view: \"button\",\n                                          type: \"icon\",\n                                          icon: \"wxi-close\",\n                                          width: 40,\n                                          inputWidth: 40,\n                                          css: \"webix_danger\",\n                                          on: {\n                                             onItemClick: () => {\n                                                const $dataEmail = $$(\n                                                   ids.dataEmail\n                                                );\n                                                const $editModeEmail = $$(\n                                                   ids.editModeEmail\n                                                );\n                                                const $buttonEditModeEmail = $$(\n                                                   ids.buttonEditModeEmail\n                                                );\n                                                const $editModeButtonsEmail =\n                                                   $$(ids.editModeButtonsEmail);\n\n                                                $editModeEmail.hide();\n                                                $editModeButtonsEmail.hide();\n\n                                                $dataEmail.show();\n                                                $buttonEditModeEmail.show();\n                                             },\n                                          },\n                                       },\n                                       {\n                                          view: \"button\",\n                                          type: \"icon\",\n                                          icon: \"wxi-check\",\n                                          width: 40,\n                                          inputWidth: 40,\n                                          css: \"webix_primary\",\n                                          on: {\n                                             onItemClick: async () => {\n                                                const $dataEmail = $$(\n                                                   ids.dataEmail\n                                                );\n                                                const $editModeEmail = $$(\n                                                   ids.editModeEmail\n                                                );\n                                                const $buttonEditModeEmail = $$(\n                                                   ids.buttonEditModeEmail\n                                                );\n                                                const $editModeButtonsEmail =\n                                                   $$(ids.editModeButtonsEmail);\n\n                                                $editModeEmail.hide();\n                                                $editModeButtonsEmail.hide();\n\n                                                $dataEmail.show();\n                                                $buttonEditModeEmail.show();\n\n                                                try {\n                                                   const email =\n                                                      $editModeEmail.getValue();\n\n                                                   $buttonEditModeEmail.disable();\n\n                                                   // await this.AB.Network.put({\n                                                   //    url: `/app_builder/model/${\n                                                   //       this.AB.objectUser().id\n                                                   //    }/${this.AB.Account.uuid()}`,\n                                                   //    data: {\n                                                   //       email,\n                                                   //    },\n                                                   // });\n                                                   await this.AB.objectUser()\n                                                      .model()\n                                                      .update(\n                                                         this.AB.Account.uuid(),\n                                                         { email }\n                                                      );\n\n                                                   this.AB.Account._config.email =\n                                                      email;\n                                                } catch (error) {\n                                                   this.AB.notify.developer(\n                                                      error,\n                                                      {\n                                                         context:\n                                                            \"error updating user profile email\",\n                                                      }\n                                                   );\n                                                } finally {\n                                                   $dataEmail.setValue(\n                                                      this.AB.Account.email()\n                                                   );\n                                                   $buttonEditModeEmail.enable();\n                                                }\n                                             },\n                                          },\n                                       },\n                                    ],\n                                 },\n                              ],\n                           },\n                           {\n                              css: {\n                                 \"margin-top\": \"0 !important\",\n                              },\n                              cols: [\n                                 {\n                                    view: \"label\",\n                                    width: 160,\n                                    // align: \"right\",\n                                    label: L(\"Language\"),\n                                 },\n                                 {\n                                    id: ids.dataLanguage,\n                                    view: \"label\",\n                                    name: \"language\",\n                                    value: \"\",\n                                    css: \"formText\",\n                                 },\n                                 {\n                                    id: ids.editModeLanguage,\n                                    view: \"combo\",\n                                    hidden: true,\n                                    value: null,\n                                    options: [],\n                                 },\n                                 {\n                                    id: ids.buttonEditModeLanguage,\n                                    view: \"button\",\n                                    type: \"icon\",\n                                    icon: \"wxi-pencil\",\n                                    width: 40,\n                                    inputWidth: 40,\n                                    on: {\n                                       onItemClick: async () => {\n                                          const $dataLanguage = $$(\n                                             ids.dataLanguage\n                                          );\n                                          const $editModeLanguage = $$(\n                                             ids.editModeLanguage\n                                          );\n                                          const $buttonEditModeLanguage = $$(\n                                             ids.buttonEditModeLanguage\n                                          );\n                                          const $editModeButtonsLanguage = $$(\n                                             ids.editModeButtonsLanguage\n                                          );\n\n                                          $buttonEditModeLanguage.disable();\n\n                                          $editModeLanguage.define(\n                                             \"options\",\n                                             await this.getLanguages()\n                                          );\n                                          $editModeLanguage.refresh();\n                                          $editModeLanguage.setValue(\n                                             this.AB.Account.language()\n                                          );\n\n                                          $dataLanguage.hide();\n                                          $buttonEditModeLanguage.hide();\n\n                                          $editModeLanguage.show();\n                                          $editModeButtonsLanguage.show();\n                                       },\n                                    },\n                                 },\n                                 {\n                                    id: ids.editModeButtonsLanguage,\n                                    hidden: true,\n                                    cols: [\n                                       {\n                                          view: \"button\",\n                                          type: \"icon\",\n                                          icon: \"wxi-close\",\n                                          width: 40,\n                                          inputWidth: 40,\n                                          css: \"webix_danger\",\n                                          on: {\n                                             onItemClick: async () => {\n                                                const $dataLanguage = $$(\n                                                   ids.dataLanguage\n                                                );\n                                                const $editModeLanguage = $$(\n                                                   ids.editModeLanguage\n                                                );\n                                                const $buttonEditModeLanguage =\n                                                   $$(\n                                                      ids.buttonEditModeLanguage\n                                                   );\n                                                const $editModeButtonsLanguage =\n                                                   $$(\n                                                      ids.editModeButtonsLanguage\n                                                   );\n\n                                                $editModeLanguage.hide();\n                                                $editModeButtonsLanguage.hide();\n\n                                                $dataLanguage.show();\n                                                $buttonEditModeLanguage.show();\n\n                                                try {\n                                                   $dataLanguage.setValue(\n                                                      await this.languageCodeToWord(\n                                                         this.AB.Account.language()\n                                                      )\n                                                   );\n                                                } catch (error) {\n                                                   $dataLanguage.setValue(null);\n                                                   this.AB.notify.developer(\n                                                      error,\n                                                      {\n                                                         context:\n                                                            \"portal_work_user_profile_window: Error updating language\",\n                                                      }\n                                                   );\n                                                } finally {\n                                                   $buttonEditModeLanguage.enable();\n                                                }\n                                             },\n                                          },\n                                       },\n                                       {\n                                          view: \"button\",\n                                          type: \"icon\",\n                                          icon: \"wxi-check\",\n                                          width: 40,\n                                          inputWidth: 40,\n                                          css: \"webix_primary\",\n                                          on: {\n                                             onItemClick: async () => {\n                                                const $dataLanguage = $$(\n                                                   ids.dataLanguage\n                                                );\n                                                const $editModeLanguage = $$(\n                                                   ids.editModeLanguage\n                                                );\n                                                const $buttonEditModeLanguage =\n                                                   $$(\n                                                      ids.buttonEditModeLanguage\n                                                   );\n                                                const $editModeButtonsLanguage =\n                                                   $$(\n                                                      ids.editModeButtonsLanguage\n                                                   );\n\n                                                $editModeLanguage.hide();\n                                                $editModeButtonsLanguage.hide();\n\n                                                $dataLanguage.show();\n                                                $buttonEditModeLanguage.show();\n\n                                                try {\n                                                   const languageCode =\n                                                      $editModeLanguage.getValue();\n\n                                                   // await this.AB.Network.put({\n                                                   //    url: `/app_builder/model/${\n                                                   //       this.AB.objectUser().id\n                                                   //    }/${this.AB.Account.uuid()}`,\n                                                   //    data: {\n                                                   //       languageCode,\n                                                   //    },\n                                                   // });\n                                                   await this.AB.objectUser()\n                                                      .model()\n                                                      .update(\n                                                         this.AB.Account.uuid(),\n                                                         { languageCode }\n                                                      );\n\n                                                   this.AB.Account._config.languageCode =\n                                                      languageCode;\n                                                } catch (error) {\n                                                   this.AB.notify.developer(\n                                                      error,\n                                                      {\n                                                         context:\n                                                            \"portal_work_user_profile_window: Error updating language Code\",\n                                                      }\n                                                   );\n                                                } finally {\n                                                   try {\n                                                      $dataLanguage.setValue(\n                                                         await this.languageCodeToWord(\n                                                            this.AB.Account.language()\n                                                         )\n                                                      );\n                                                   } catch (error) {\n                                                      $dataLanguage.setValue(\n                                                         null\n                                                      );\n\n                                                      this.AB.notify.developer(\n                                                         error,\n                                                         {\n                                                            context:\n                                                               \"portal_work_user_profile_window: Error updating languageCodeToWord()\",\n                                                         }\n                                                      );\n                                                   }\n\n                                                   $buttonEditModeLanguage.enable();\n                                                }\n                                             },\n                                          },\n                                       },\n                                    ],\n                                 },\n                              ],\n                           },\n                        ],\n                     },\n                  ],\n               },\n               {\n                  rows: [\n                     {\n                        view: \"button\",\n                        type: \"icon\",\n                        icon: \"wxi-angle-down\",\n                        height: 40,\n                        css: \"webix_primary\",\n                        label: L(\"Advanced Options\"),\n                        on: {\n                           onItemClick: (id) => {\n                              const $button = $$(id);\n                              const $advanceOptions = $$(ids.advanceOptions);\n\n                              if ($advanceOptions.isVisible()) {\n                                 $button.define(\"icon\", \"wxi-angle-down\");\n                                 $button.refresh();\n                                 $advanceOptions.hide();\n                              } else {\n                                 $button.define(\"icon\", \"wxi-angle-up\");\n                                 $button.refresh();\n                                 $advanceOptions.show();\n                              }\n                           },\n                        },\n                     },\n                     {\n                        id: ids.advanceOptions,\n                        hidden: true,\n                        rows: [\n                           {\n                              view: \"form\",\n                              width: 460,\n                              borderless: true,\n                              elements: [\n                                 {\n                                    cols: [\n                                       {\n                                          rows: [\n                                             {\n                                                height: 3,\n                                             },\n                                             {\n                                                view: \"label\",\n                                                width: 160,\n                                                // align: \"right\",\n                                                label: L(\"New Password\"),\n                                             },\n                                             {},\n                                          ],\n                                       },\n                                       {\n                                          id: ids.formNewPassword,\n                                          view: \"form\",\n                                          borderless: true,\n                                          width: 260,\n                                          padding: 0,\n                                          elements: [\n                                             {\n                                                id: ids.fieldNewPassword,\n                                                view: \"text\",\n                                                name: \"newPassword\",\n                                                type: \"password\",\n                                                placeholder: L(\n                                                   \"Enter a new Password (at least 8)\"\n                                                ),\n                                                value: \"\",\n                                                validate: (value) => {\n                                                   return value.length >= 8;\n                                                },\n                                             },\n                                             {\n                                                view: \"text\",\n                                                name: \"confirmPassword\",\n                                                type: \"password\",\n                                                placeholder:\n                                                   L(\"Confirm Password\"),\n                                                value: \"\",\n                                                validate: (value) => {\n                                                   const $fieldNewPassword = $$(\n                                                      ids.fieldNewPassword\n                                                   );\n\n                                                   return (\n                                                      value ===\n                                                      $fieldNewPassword.getValue()\n                                                   );\n                                                },\n                                             },\n                                             {\n                                                view: \"button\",\n                                                type: \"form\",\n                                                value: \"Save\",\n                                                align: \"right\",\n                                                height: 32,\n                                                width: 75,\n                                                inputWidth: 75,\n                                                css: \"webix_primary\",\n                                                on: {\n                                                   onItemClick: async (id) => {\n                                                      const $formNewPassword =\n                                                         $$(\n                                                            ids.formNewPassword\n                                                         );\n                                                      const $thisButton =\n                                                         $$(id);\n\n                                                      if (\n                                                         $formNewPassword.validate()\n                                                      ) {\n                                                         try {\n                                                            const $fieldNewPassword =\n                                                               $$(\n                                                                  ids.fieldNewPassword\n                                                               );\n                                                            const password =\n                                                               $fieldNewPassword.getValue();\n\n                                                            $thisButton.disable();\n                                                            $formNewPassword.disable();\n\n                                                            await this.AB.Network.post(\n                                                               {\n                                                                  url: \"/auth/password/reset\",\n                                                                  data: {\n                                                                     password,\n                                                                  },\n                                                               },\n                                                               {\n                                                                  key: \"portal_auth_password_reset\",\n                                                                  context: {},\n                                                               }\n                                                            );\n                                                         } catch (error) {\n                                                            this.AB.notify.developer(\n                                                               error,\n                                                               {\n                                                                  context:\n                                                                     \"portal_work_user_profile_window:Error resetting password\",\n                                                               }\n                                                            );\n                                                         } finally {\n                                                            $formNewPassword.clear();\n                                                            $formNewPassword.enable();\n                                                            $thisButton.enable();\n                                                         }\n                                                         webix.alert(\n                                                            \"The new password is successfully updated!\"\n                                                         );\n                                                      }\n                                                   },\n                                                },\n                                             },\n                                          ],\n                                       },\n                                    ],\n                                 },\n                                 {\n                                    css: {\n                                       \"border-top\": \"1px solid #dee2e6\",\n                                    },\n                                    cols: [\n                                       {\n                                          view: \"label\",\n                                          width: 160,\n                                          // align: \"right\",\n                                          label: L(\"System Notification\"),\n                                       },\n                                       {\n                                          id: ids.systemNotification,\n                                          view: \"checkbox\",\n                                          borderless: true,\n                                          width: 27,\n                                          css: {\n                                             \"text-align\": \"center !important\",\n                                             padding: \"0 10px\",\n                                          },\n                                          value: 0,\n                                          on: {\n                                             onItemClick: async () => {\n                                                const $systemNotification = $$(\n                                                   ids.systemNotification\n                                                );\n\n                                                try {\n                                                   const sendEmailNotifications =\n                                                      $systemNotification.getValue();\n                                                   // await this.AB.Network.put({\n                                                   //    url: `/app_builder/model/${\n                                                   //       this.AB.objectUser().id\n                                                   //    }/${this.AB.Account.uuid()}`,\n                                                   //    data: {\n                                                   //       sendEmailNotifications,\n                                                   //    },\n                                                   // });\n\n                                                   await this.AB.objectUser()\n                                                      .model()\n                                                      .update(\n                                                         this.AB.Account.uuid(),\n                                                         {\n                                                            sendEmailNotifications,\n                                                         }\n                                                      );\n\n                                                   this.AB.Account._config.sendEmailNotifications =\n                                                      sendEmailNotifications;\n                                                } catch (error) {\n                                                   this.AB.notify.developer(\n                                                      error,\n                                                      {\n                                                         context:\n                                                            \"portal_work_user_profile_window:Error updating email notifications\",\n                                                      }\n                                                   );\n                                                } finally {\n                                                   $systemNotification.setValue(\n                                                      this.AB.Account.sendEmailNotifications()\n                                                   );\n                                                }\n                                             },\n                                          },\n                                       },\n                                    ],\n                                 },\n                              ],\n                           },\n                        ],\n                     },\n                  ],\n               },\n            ],\n         },\n         // },\n      };\n   }\n\n   async init(AB) {\n      this.AB = AB;\n\n      webix.ui(this.ui());\n   }\n\n   async languageCodeToWord(code) {\n      if (typeof code !== \"string\")\n         throw new Error('The argrument \"code\" should be a string');\n\n      const languages = await this.getLanguages();\n      for (let i = 0; i < languages.length; i++)\n         if (languages[i].id === code) return languages[i].value;\n\n      return null;\n   }\n\n   async getLanguages() {\n      const data = [];\n\n      try {\n         const Language = this.AB.objectLanguage();\n         const response = await Language.model().findAll();\n         for (let i = 0; i < response.data.length; i++)\n            data.push({\n               id: response.data[i].language_code,\n               value: response.data[i].language_label,\n            });\n      } catch (error) {\n         this.AB.notify.developer(error, {\n            context: \"Error getting Languages\",\n         });\n      }\n\n      return data;\n   }\n\n   async populate() {\n      const ids = this.ids;\n\n      const $formUserInfo = $$(ids.formUserInfo);\n      const $systemNotification = $$(ids.systemNotification);\n\n      const populateLanguage = async () => {\n         const $dataLanguage = $$(ids.dataLanguage);\n         const $buttonEditModeLanguage = $$(ids.buttonEditModeLanguage);\n\n         $buttonEditModeLanguage.disable();\n\n         try {\n            $dataLanguage.setValue(\n               await this.languageCodeToWord(this.AB.Account.language())\n            );\n         } catch (error) {\n            $dataLanguage.setValue(null);\n\n            this.AB.notify.developer(error, {\n               context: \"Error setting Languages\",\n            });\n         }\n\n         $buttonEditModeLanguage.enable();\n      };\n\n      populateLanguage();\n      $formUserInfo.setValues({\n         tenant: this.AB.Tenant.id(),\n         username: this.AB.Account.username(),\n         email: this.AB.Account.email(),\n      });\n      $systemNotification.setValue(this.AB.Account.sendEmailNotifications());\n   }\n\n   hide() {\n      const ids = this.ids;\n\n      const $component = $$(ids.component);\n\n      $component.hide();\n   }\n\n   show() {\n      const ids = this.ids;\n\n      const $component = $$(ids.component);\n\n      $component.show();\n\n      this.populate();\n   }\n}\n\nexport default new PortalWorkUserProfileWindow();\n","import ClassUI from \"./ClassUI.js\";\n\nvar myClass = null;\n// Singleton.\n// This UI gets imported several times so let's not recreate the class each time.\n\nif (!myClass) {\n   myClass = class PortalWorkUserSwitcheroo extends ClassUI {\n      constructor() {\n         super(\"portal_work_user_switcheroo\", {\n            userIcon: \"\",\n            userName: \"\",\n            switchBack: \"\",\n            switchBackReplacer: \"\",\n            list: \"\",\n         });\n      }\n\n      ui() {\n         var L = (...params) => {\n            return this.label(...params);\n         };\n         const ids = this.ids;\n         return {\n            id: ids.component,\n            view: \"window\",\n            position: \"center\",\n            hidden: true,\n            close: true,\n            modal: true,\n            css: \"switcheroo\",\n            head: L(\"Switcheroo\"),\n            body: {\n               padding: 10,\n               rows: [\n                  {\n                     height: 30,\n                     cols: [\n                        {\n                           id: ids.userIcon,\n                           view: \"label\",\n                           align: \"center\",\n                           width: 44,\n                        },\n                        {\n                           id: ids.userName,\n                           view: \"label\",\n                           align: \"center\",\n                        },\n                        {\n                           id: ids.switchBack,\n                           view: \"button\",\n                           value: '<div style=\"text-align: center; font-size: 12px;\"><i class=\"fa-fw fa fa-times\"></i></div>',\n                           align: \"center\",\n                           css: \"webix_transparent\",\n                           width: 44,\n                           on: {\n                              onItemClick: () => {\n                                 this.switchUser();\n                                 this.hide();\n                              },\n                           },\n                        },\n                        {\n                           id: ids.switchBackReplacer,\n                           width: 44,\n                        },\n                     ],\n                  },\n                  {\n                     view: \"label\",\n                     label: L(\"View site as:\"),\n                     align: \"left\",\n                  },\n                  {\n                     id: ids.list,\n                  },\n                  {\n                     cols: [\n                        {\n                           view: \"button\",\n                           value: L(\"Switch\"),\n                           css: \"webix_primary\",\n                           on: {\n                              onItemClick: () => {\n                                 const userID = $$(ids.list).getValue();\n\n                                 if (!userID) {\n                                    webix.message(L(\"Please select a user.\"));\n\n                                    return;\n                                 }\n\n                                 this.switchUser(userID);\n                                 this.hide();\n                              },\n                           },\n                        },\n                     ],\n                  },\n               ],\n            },\n         };\n      }\n\n      init(AB, headless = false) {\n         this.AB = AB;\n         if (!headless) {\n            webix.ui(this.ui());\n            this.populate();\n         }\n\n         return Promise.resolve();\n      }\n\n      hide() {\n         $$(this.ids.component).hide();\n      }\n\n      show() {\n         $$(this.ids.component).show();\n      }\n\n      // const clearPopupUserMenu = () => {\n      //   $$(\"switcheroo_list\").setValue(\"\");\n      //   $$(\"switcheroo\").hide();\n      //   $$(\"userMenu_list\").unselectAll();\n      //   $$(\"userMenu_list\").show();\n      // };\n\n      async switcherooClear() {\n         return this.switchUser(null);\n      }\n\n      async switchUser(userID) {\n         const user = (this.AB.Account.userList() || []).find(\n            (e) => e.uuid === userID\n         );\n\n         // Save to a switched user.\n         if (!user || !userID) {\n            // if no user, then remove our current Switcheroo assignment\n            /* let response = */ await this.AB.Network.delete({\n               url: `/auth/switcheroo`,\n               // data: {},\n            });\n         } else {\n            /* let response = */ await this.AB.Network.post({\n               url: `/auth/switcheroo/${user.uuid}`,\n               // data: {},\n            });\n         }\n\n         window.location.reload(true);\n      }\n\n      populate() {\n         const ids = this.ids;\n\n         const mainUserID = this.AB.Account.uuid();\n         const userList = (this.AB.Account.userList() || [])\n            .filter((e) => e.uuid !== mainUserID)\n            .map((u) => {\n               return { id: u.uuid, value: u.username };\n            });\n\n         let switchedUserID = null;\n         if (this.AB.Account.isSwitcherood()) {\n            switchedUserID = mainUserID;\n         }\n         webix.ui(\n            {\n               id: ids.list,\n               view: \"combo\",\n               options: {\n                  body: {\n                     template: (obj) => {\n                        if (obj.id === switchedUserID)\n                           return `<i class='fa-fw fa fa-user-secret'></i> ${obj.value}`;\n                        return obj.value;\n                     },\n                  },\n                  data: userList,\n               },\n               on: {\n                  onItemClick: (id) => {\n                     $$(id).setValue(\"\");\n                  },\n               },\n            },\n            $$(ids.list)\n         );\n         $$(ids.userName).setValue(this.AB.Account.username());\n\n         if (this.AB.Account.isSwitcherood()) {\n            $$(ids.userIcon).setValue(\n               \"<i class='fa-fw fa fa-user-secret'></i>\"\n            );\n            $$(ids.switchBackReplacer)?.hide();\n            $$(ids.switchBack)?.show();\n            return;\n         }\n\n         $$(ids.userIcon).setValue(\"<i class='fa-fw fa fa-user'></i>\");\n         $$(ids.switchBack).hide();\n         $$(ids.switchBackReplacer).show();\n      }\n   };\n}\nexport default new myClass();\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalWorkUserQRWindow extends ClassUI {\n   constructor() {\n      super();\n      this.id = \"portal_work_user_qr_window\";\n      this.idTaskMultiview = \"taskMultiview\";\n      this.idTaskTitle = \"taskTitle\";\n      this.idTaskPager = \"taskPager\";\n      this.classQrImageDom = \"qr-code-image-dom\";\n   }\n\n   ui() {\n      var L = (...params) => {\n         return this.label(...params);\n      };\n      return {\n         id: this.id,\n         view: \"window\",\n         position: function (state) {\n            state.left = state.maxWidth / 2 - 600 / 2; // fixed values\n            state.top = state.maxHeight / 2 - (state.maxHeight * 0.7) / 2;\n            state.width = 500; // relative values\n            state.height = 400;\n         },\n         modal: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               { width: 17 },\n               {\n                  id: this.idTaskTitle,\n                  view: \"label\",\n                  label: L(\"Connect Mobile App\"),\n               },\n               {\n                  view: \"button\",\n                  type: \"icon\",\n                  css: \"webix_transparent\",\n                  width: 40,\n                  icon: \"fa fa-repeat\",\n                  click: () => {\n                     $$(\"qr-code-image\").refresh();\n                  },\n                  on: {\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this, \"qr_image_reload\");\n                     },\n                  },\n               },\n               {\n                  view: \"button\",\n                  type: \"icon\",\n                  css: \"webix_transparent\",\n                  width: 40,\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     $$(this.id).hide();\n                  },\n                  on: {\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this, \"qr_window_close\");\n                     },\n                  },\n               },\n            ],\n         },\n         body: {\n            css: { \"text-align\": \"center\" },\n            rows: [\n               { height: 10 },\n               {\n                  borderless: true,\n                  template: `<span style=\"font-size:14px;font-weight:500;\">${L(\n                     \"Use your phone's camera app to scan this QR code, and it will open a webpage to the conneXted mobile app. You only need to scan the code for the first time.\"\n                  )}</span>`,\n               },\n               {\n                  id: \"qr-code-image\",\n                  borderless: true,\n                  autoheight: true,\n                  autowidth: true,\n                  template:\n                     `<img src='/relay/user-qr' class='${this.classQrImageDom}' style='margin: 10px auto 20px;display:block;' />`,\n                  on: {\n                     onAfterRender: () => {\n                        const $img = $$(\"qr-code-image\").$view.getElementsByClassName(this.classQrImageDom)[0];\n                        $img.onload = () => {\n                           $$(\"qr-code-image\").adjust();\n                        };\n                     }\n                  }\n               },\n\n               {\n                  borderless: true,\n                  template: `<div style=\"font-size:14px;font-weight:500;font-weight:500;\">${L(\n                     \"This code can only be used once. It will expire after 7 days.\"\n                  )}</div>`,\n               },\n            ],\n         },\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n      webix.ui(this.ui());\n\n      return Promise.resolve();\n   }\n\n   hide() {\n      $$(this.id).hide();\n   }\n\n   show() {\n      $$(this.id).show();\n   }\n}\n\nexport default new PortalWorkUserQRWindow();\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalWorkUserMobileQR extends ClassUI {\n   constructor() {\n      super(\"portal_work_user_qr_window\", {\n         // taskMultiview:\"\",\n         description: \"\",\n         instructions: \"\",\n         title: \"\",\n         qrcode: \"\",\n         taskPager: \"\",\n      });\n   }\n\n   ui() {\n      var L = (...params) => {\n         return this.label(...params);\n      };\n      const ids = this.ids;\n      return {\n         id: ids.component,\n         view: \"window\",\n         position: function (state) {\n            state.left = state.maxWidth / 2 - 600 / 2; // fixed values\n            state.top = state.maxHeight / 2 - (state.maxHeight * 0.7) / 2;\n            state.width = 500; // relative values\n            state.height = 400;\n         },\n         modal: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               { width: 17 },\n               {\n                  id: ids.title,\n                  view: \"label\",\n                  label: L(\"Connect Mobile App\"),\n               },\n               {\n                  view: \"button\",\n                  type: \"icon\",\n                  css: \"webix_transparent\",\n                  width: 40,\n                  icon: \"fa fa-repeat\",\n                  click: () => {\n                     $$(\"qr-code-image\").refresh();\n                  },\n                  on: {\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this, \"qr_image_reload\");\n                     },\n                  },\n               },\n               {\n                  view: \"button\",\n                  type: \"icon\",\n                  css: \"webix_transparent\",\n                  width: 40,\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     $$(ids.component).hide();\n                  },\n                  on: {\n                     onAfterRender() {\n                        ClassUI.CYPRESS_REF(this, \"qr_window_close\");\n                     },\n                  },\n               },\n            ],\n         },\n         body: {\n            css: { \"text-align\": \"center\" },\n            rows: [\n               { height: 10 },\n               {\n                  id: ids.description,\n                  borderless: true,\n                  template: `<span style=\"font-size:14px;font-weight:500;\">The App's Description should go here.</span>`,\n               },\n               {\n                  id: ids.instructions,\n                  borderless: true,\n                  template: `<span style=\"font-size:14px;font-weight:500;\">${L(\n                     \"Use your phone's camera app to scan this QR code, and it will open a webpage to the {0} mobile app. You only need to scan the code for the first time.\"\n                  )}</span>`,\n               },\n               {\n                  id: ids.qrcode,\n                  height: 175,\n                  borderless: true,\n                  // autoheight: true,\n                  autowidth: true,\n                  template:\n                     \"<img src='/relay/user-qr' style='margin: 10px auto 20px;display:block;' />\",\n               },\n\n               {},\n               // {\n               //    borderless: true,\n               //    template: `<div style=\"font-size:14px;font-weight:500;font-weight:500;\">${L(\n               //       \"This code can only be used once. It will expire after 7 days.\"\n               //    )}</div>`,\n               // },\n            ],\n         },\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n      webix.ui(this.ui());\n\n      return Promise.resolve();\n   }\n\n   load(App) {\n      var L = (...params) => {\n         return this.label(...params);\n      };\n\n      // change Title\n      let $title = $$(this.ids.title);\n      $title.define(\"label\", App.label);\n      $title.refresh();\n\n      // Change Description\n      let $desc = $$(this.ids.description);\n      $desc.define(\n         \"template\",\n         `<span style=\"font-size:14px;font-weight:500;\">${App.description}</span>`\n      );\n      $desc.refresh();\n\n      let $instr = $$(this.ids.instructions);\n      $instr.define(\n         \"template\",\n         `<span style=\"font-size:14px;font-weight:500;\">${L(\n            \"Use your phone's camera app to scan this QR code, and it will open a webpage to the {0} mobile app. You only need to scan the code for the first time.\",\n            [App.label]\n         )}</span>`\n      );\n\n      // Change QR Image\n      let $qrcode = $$(this.ids.qrcode);\n      $qrcode.define(\n         \"template\",\n         `<img src='/mobile/qr/${App.id}' style='margin: 10px auto 20px;display:block;' />`\n      );\n      $qrcode.refresh();\n\n      $$(this.ids.component)?.refresh?.();\n   }\n\n   hide() {\n      $$(this.ids.component).hide();\n   }\n\n   show() {\n      $$(this.ids.component).show();\n   }\n}\n\nexport default new PortalWorkUserMobileQR();\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalAccessLevelManager extends ClassUI {\n   constructor() {\n      super();\n      this.accessLevels = [\n         {\n            id: \"0\",\n            value: \"No Access\",\n         },\n         {\n            id: \"1\",\n            value: \"Read Only\",\n         },\n         {\n            id: \"2\",\n            value: \"Full Access\",\n         },\n      ];\n   }\n\n   ui() {\n      const accessLevelManagerBody = {\n         view: \"scrollview\",\n         css: \"lightgray ab_amp\",\n         body: {\n            rows: [\n               {\n                  view: \"accordion\",\n                  id: \"amp_accordion\",\n                  roles: [],\n                  hidden: true,\n                  collapsed: true,\n                  css: \"webix_dark\",\n                  rows: [],\n               },\n               {\n                  id: \"amp_accordion_noSelection\",\n                  rows: [\n                     {},\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        height: 200,\n                        label:\n                           \"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-unlock-alt'></div>\",\n                     },\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        label: \"Add a role to control access.\",\n                     },\n                     {\n                        cols: [\n                           {},\n                           {\n                              view: \"button\",\n                              label: \"Add Role\",\n                              type: \"form\",\n                              css: \"webix_primary\",\n                              autowidth: true,\n                              click: () => {\n                                 webix.ui(newRolePopup).show();\n\n                                 const roles = this.roles.filter((role) => {\n                                    return (\n                                       $$(\"amp_accordion\").config.roles.indexOf(\n                                          role.id\n                                       ) == -1\n                                    );\n                                 });\n\n                                 $$(\"role_popup_options\").define(\n                                    \"options\",\n                                    roles\n                                 );\n                                 $$(\"role_popup_options\").refresh();\n                              },\n                           },\n                           {},\n                        ],\n                     },\n                     {},\n                  ],\n               },\n            ],\n         },\n      };\n\n      const newRolePopup = {\n         view: \"popup\",\n         id: \"role_popup\",\n         position: \"center\",\n         height: 250,\n         width: 350,\n         modal: true,\n         body: {\n            rows: [\n               {\n                  view: \"toolbar\",\n                  id: \"myToolbarABLiveTool\",\n                  css: \"webix_dark\",\n                  cols: [\n                     {\n                        view: \"label\",\n                        label: \"Add Role\",\n                        align: \"center\",\n                     },\n                  ],\n               },\n               {\n                  view: \"form\",\n                  elements: [\n                     /* We are not managing users yet so take this out\n                                    {\n                                      view: \"text\",\n                                      label: \"Create new\",\n                                      labelWidth: 90\n                                    },\n                                    {\n                                      view: \"label\",\n                                      label: \"- or -\",\n                                      align: \"center\"\n                                    },*/\n                     {\n                        view: \"combo\",\n                        label: \"\",\n                        id: \"role_popup_options\",\n                        placeholder: \"Choose role\",\n                        options: [],\n                     },\n                     {\n                        cols: [\n                           {\n                              view: \"button\",\n                              value: \"Cancel\",\n                              click: () => {\n                                 $$(\"role_popup\").hide();\n                              },\n                           },\n                           {\n                              view: \"button\",\n                              value: \"Add\",\n                              id: \"role_popup_options_add\",\n                              css: \"webix_primary\",\n                              click: () => {\n                                 const role = $$(\n                                    \"role_popup_options\"\n                                 ).getValue();\n                                 if ($$(`amp_accordionitem_${role}`)) {\n                                    $$(`amp_accordionitem_${role}`).show();\n                                    $$(\"amp_accordion\").config.roles.push(role);\n                                 } else {\n                                    this.buildAccessAccordion(role);\n                                 }\n                                 $$(\"role_popup\").hide();\n                              },\n                           },\n                        ],\n                     },\n                  ],\n               },\n            ],\n         },\n      };\n\n      return {\n         view: \"window\",\n         css: \"ampWindow\",\n         id: \"access_manager\",\n         position: function (state) {\n            state.left = state.maxWidth - 350; // fixed values\n            state.top = 0;\n            state.width = 350; // relative values\n            state.height = state.maxHeight;\n         },\n         on: {\n            onShow: () => {\n               // collapse all the accordion items but the top one\n               var index = 0;\n               $$(\"amp_accordion\")\n                  .getChildViews()\n                  .forEach((a) => {\n                     if (index == 0) {\n                        $$(a).expand();\n                     } else {\n                        $$(a).collapse();\n                     }\n                     index++;\n                     $$(\"amp_accordion\").show();\n                     $$(\"amp_accordion_noSelection\").hide();\n                  });\n            },\n         },\n         //modal: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               {\n                  width: 15,\n               },\n               {\n                  view: \"label\",\n                  label: \"Access Manager\",\n                  autowidth: true,\n               },\n               {},\n               {\n                  view: \"button\",\n                  label: \"Add Role\",\n                  width: 100,\n                  css: \"webix_primary\",\n                  click: () => {\n                     webix.ui(newRolePopup).show();\n\n                     var roles = this.roles.filter((role) => {\n                        return (\n                           $$(\"amp_accordion\").config.roles.indexOf(role.id) ==\n                           -1\n                        );\n                     });\n\n                     $$(\"role_popup_options\").define(\"options\", roles);\n                     $$(\"role_popup_options\").refresh();\n                  },\n               },\n               {\n                  view: \"button\",\n                  width: 35,\n                  css: \"webix_transparent\",\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     this.hide();\n                  },\n               },\n            ],\n         },\n         body: accessLevelManagerBody,\n      };\n   }\n\n   init(portal) {\n      this.AB = portal.AB;\n      this.portal = portal;\n      this.appId = portal.AppState.lastSelectedApp;\n\n      const languageCode = this.AB.Config.userConfig().languageCode;\n      this.roles = this.AB.Config.metaConfig().roles.map((role) => {\n         const translation = role.translations.filter(\n            (t) => t.code == languageCode\n         );\n         const name = translation.length == 1 ? translation[0].name : role.name;\n         return { id: role.id, value: name };\n      });\n\n      webix.ui(this.ui());\n\n      // buld the tree views for already defined role access levels\n      const application = this.AB.applicationByID(this.appId);\n      if (application.isAccessManaged) {\n         // Build the access level tree for Roles\n         const existingRoles = [];\n         application.pages().forEach((page) => {\n            Object.keys(page.accessLevels).forEach((role) => {\n               if (existingRoles.indexOf(role) == -1) {\n                  existingRoles.push(role);\n               }\n            });\n         });\n         existingRoles.forEach((role) => {\n            this.buildAccessAccordion(role);\n         });\n      }\n   }\n\n   show() {\n      $$(\"access_manager\").show();\n   }\n\n   hide() {\n      $$(\"access_manager\").hide();\n   }\n\n   showPage(viewId, pageId, parent) {\n      parent.application = {};\n      parent.application.id = this.appId;\n      this.portal.showPage(parent);\n      const pageUI = this.portal.pageContainers[parent.id];\n      pageUI.showPage(pageId, viewId);\n   }\n\n   /*\n    * helper to get the current apps views\n    */\n   views(f) {\n      return this.AB.applicationByID(this.appId).views(f);\n   }\n\n   buildAccessAccordion(role) {\n      const L = this.AB.Label();\n      const application = this.AB.applicationByID(this.appId);\n      const isRoleAccessManager =\n         parseInt(application.accessManagers.useRole) == 1 &&\n         application.accessManagers.role.indexOf(role) > -1;\n      const manageUsers = {\n         rows: [\n            {\n               height: 10,\n            },\n            {\n               cols: [\n                  {\n                     width: 10,\n                  },\n                  {\n                     view: \"button\",\n                     type: \"icon\",\n                     icon: \"fa fa-trash\",\n                     css: \"webix_danger_inverse\",\n                     label: \"Remove\",\n                     click: async () => {\n                        const confirmation = await webix.confirm(\n                           \"Remove role from app?\"\n                        );\n                        if (confirmation) {\n                           const tree = $$(`linetree_${role}`);\n                           const mainPages = this.AB.applicationByID(\n                              this.appId\n                           ).pages();\n                           await mainPages.forEach(async (page) => {\n                              const branch = tree.getItem(page.id);\n                              branch.access = \"0\";\n                              await page.updateAccessLevels(\n                                 tree.config.role,\n                                 \"0\"\n                              );\n                              tree.updateItem(page.id, branch);\n                           });\n\n                           $$(`amp_accordionitem_${role}`).hide();\n                           const itemToRemove = $$(\n                              \"amp_accordion\"\n                           ).config.roles.indexOf(role);\n                           if (itemToRemove > -1) {\n                              $$(\"amp_accordion\").config.roles.splice(\n                                 itemToRemove,\n                                 1\n                              );\n                           }\n                        }\n                     },\n                  },\n                  {\n                     width: 10,\n                  },\n               ],\n            },\n            {\n               height: 10,\n            },\n         ],\n      };\n\n      $$(\"amp_accordion\").config.roles.push(role);\n\n      const toggleParent = (element) => {\n         if (!element.parent) return false;\n         var parentElem = element.parent;\n         if (!parentElem.parent) return false;\n         parentElem.parent.emit(\"changeTab\", parentElem.id);\n         toggleParent(parentElem.parent);\n      };\n\n      const getParent = (id, component) => {\n         let item = $$(component).getItem(id);\n         if (item.$parent == 0) return item;\n         else return getParent(item.$parent, component);\n      };\n\n      const tree = {\n         id: `linetree_${role}`,\n         view: \"edittree\",\n         type: \"lineTree\",\n         editable: true,\n         role: role,\n         editor: \"combo\",\n         editValue: \"access\",\n         threeState: true,\n         template: (obj, common) => {\n            const treeOptions = $$(`linetree_${role}`).config.options;\n            const option = treeOptions.find((o) => o.id === obj.access);\n            let color, icon;\n            switch (option.id) {\n               case \"1\":\n                  color = \"#FFAB00\";\n                  icon = \"eye\";\n                  break;\n               case \"2\":\n                  color = \"#00C853\";\n                  icon = \"pencil\";\n                  break;\n               default:\n                  // Case \"0\"\n                  color = \"#ff4938\";\n                  icon = \"lock\";\n            }\n\n            return `<span class=\"accessLevel\">\n                     <span class=\"fa-stack\">\n                        <i style=\"color: ${color};\" class=\"fa fa-circle fa-stack-2x\"></i>\n                        <i class=\"fa fa-${icon} fa-stack-1x fa-inverse\"></i>\n                     </span>\n                     ${common.icon(obj, common)}\n                     <span>${obj.label}</span>\n                     <i class=\"externalLink fa fa-external-link\"></i>\n                  </span>`;\n         },\n         options: this.accessLevels,\n         data: this.getAccessLevelTree(role),\n         onClick: {\n            externalLink: (event, branch, target) => {\n               const item = $$(`linetree_${role}`).getItem(branch);\n               const parent = getParent(branch, `linetree_${role}`);\n               if (item.type == \"tab\") {\n                  this.showPage(branch, item.pageId, parent);\n\n                  const tabView = this.views((v) => v.id == item.id)[0];\n                  if (!tabView) return false;\n\n                  const tab = tabView.parent;\n                  if (!tab) return false;\n\n                  toggleParent(tab);\n                  if (!$$(tabView.id) || !$$(tabView.id).isVisible()) {\n                     const showIt = setInterval(() => {\n                        if ($$(tabView.id) && $$(tabView.id).isVisible()) {\n                           clearInterval(showIt);\n                        }\n                        tab.emit(\"changeTab\", tabView.id);\n                     }, 200);\n                  }\n               }\n               // switch page\n               else {\n                  this.showPage(branch, item.id, parent);\n               }\n\n               return false;\n            },\n         },\n         on: {\n            onAfterEditStop: async (state, editor, ignoreUpdate) => {\n               if (state.old == state.value) return false;\n               const tree = $$(`linetree_${role}`);\n               const view = this.views((v) => {\n                  return v.id == editor.id;\n               })[0];\n               await view.updateAccessLevels(tree.config.role, state.value);\n               console.log(\n                  `Role: ${tree.config.role} set to Access Level: ${state.value} on view: ${view.id}`\n               );\n            },\n            onDataUpdate: async (id, data, old) => {\n               const tree = $$(`linetree_${role}`);\n               if (data.access == \"0\") {\n                  // NOTE: Need to update \"No Access\" option here because It does not trigger `onAfterEditStop` event\n                  const view = this.views((v) => v.id == id)[0];\n                  await view.updateAccessLevels(tree.config.role, data.access);\n\n                  tree.blockEvent();\n                  await tree.data.eachSubItem(id, async (child) => {\n                     const childData = tree.getItem(child.id);\n                     if (childData.access != data.access) {\n                        childData.access = data.access;\n                        const view = this.views((v) => {\n                           return v.id == child.id;\n                        })[0];\n                        await view.updateAccessLevels(\n                           tree.config.role,\n                           data.access\n                        );\n                        console.log(\n                           `Role: ${tree.config.role} set to Access Level: ${data.access} on view: ${view.id}`\n                        );\n                        tree.updateItem(child.id, childData);\n                     }\n                  });\n                  tree.unblockEvent();\n               } else {\n                  const parentBranch = tree.getParentId(id);\n                  const parentData = tree.getItem(parentBranch);\n                  if (parentData) {\n                     if (parentData.access == \"0\") {\n                        parentData.access = \"1\";\n                        const view = this.views((v) => {\n                           return v.id == parentBranch;\n                        })[0];\n                        await view.updateAccessLevels(\n                           tree.config.role,\n                           parentData.access\n                        );\n\n                        console.log(\n                           `Role: ${tree.config.role} set to Access Level: ${parentData.access} on view: ${view.id}`\n                        );\n                        tree.updateItem(parentBranch, parentData);\n                     }\n                  }\n               }\n            },\n         },\n      };\n\n      const newAccordionItem = {\n         view: \"accordionitem\",\n         id: `amp_accordionitem_${role}`,\n         header: () => {\n            return `${\n               this.roles?.find((r) => {\n                  return r.id === role;\n               })?.value ?? role\n            } ${\n               isRoleAccessManager\n                  ? `<span class=\"header\" webix_tooltip=\"${L(\n                       \"This role has been assigned as a Page Access Manager for this App. This means they have full access. Please remove the permissions from the App's Setting page if you would like to manage their access here.\"\n                    )}\">${this.WARNING_ICON}</span>`\n                  : \"\"\n            }`;\n         },\n         collapsed: true,\n         body: {\n            type: \"clean\",\n            rows: [tree, manageUsers],\n         },\n      };\n\n      $$(\"amp_accordion\").addView(newAccordionItem, -1);\n      $$(\"amp_accordion\").show();\n      $$(\"amp_accordion_noSelection\").hide();\n\n      if (isRoleAccessManager)\n         this.AB.Webix.TooltipControl.addTooltip(\n            $$(`amp_accordionitem_${role}`).$view\n         );\n\n      $$(`linetree_${role}`).openAll();\n   }\n\n   getAccessLevelTree(role) {\n      const tree = new webix.TreeCollection();\n\n      const addPage = (page, index, parentId, type) => {\n         // add to tree collection\n         const accessLevel = page.accessLevels[role] ?? \"0\";\n         const branch = {\n            id: page.id,\n            access: accessLevel,\n            label: page.label,\n            pageId: parentId,\n            type: type,\n         };\n         tree.add(branch, index, parentId);\n\n         // stop at detail views\n         if (page.defaults.key == \"detail\") {\n            return;\n         }\n\n         const subPages = page.pages ? page.pages() : [];\n         subPages.forEach((childPage, childIndex) => {\n            addPage(childPage, childIndex, page.id, \"page\");\n         });\n\n         // add tabs\n         page\n            .views((view) => view.defaults.key == \"tab\")\n            .forEach((tab, tabIndex) => {\n               // tab views\n               tab.views().forEach((tabView, tabViewIndex) => {\n                  // tab items will be below sub-page items\n                  const tIndex = subPages.length + tabIndex + tabViewIndex;\n                  addPage(tabView, tIndex, page.id, \"tab\");\n               });\n            });\n      };\n      this.AB.applicationByID(this.appId)\n         .pages()\n         .forEach((p, index) => {\n            addPage(p, index, null, \"page\");\n         });\n\n      return tree;\n   }\n}\n\nexport default new PortalAccessLevelManager();\n","import ClassUI from \"./ClassUI.js\";\n\nclass PortalTranslationTool extends ClassUI {\n   constructor() {\n      super();\n      this.containerDomID = \"domID\";\n   }\n\n   ui() {\n      const translationToolBody = {\n         view: \"scrollview\",\n         css: \"lightgray ab_amp\",\n         body: {\n            rows: [\n               {\n                  view: \"accordion\",\n                  id: `qtt_accordion_${this.containerDomID}`,\n                  roles: [],\n                  hidden: true,\n                  collapsed: true,\n                  css: \"webix_dark\",\n                  rows: [],\n               },\n               {\n                  id: `qtt_accordion_noSelection_${this.containerDomID}`,\n                  rows: [{}],\n               },\n            ],\n         },\n      };\n\n      return {\n         view: \"window\",\n         css: \"qttWindow\",\n         id: `quickTranslationTool_${this.containerDomID}`,\n         position: function (state) {\n            state.left = state.maxWidth - 400; // fixed values\n            state.top = 0;\n            state.width = 400; // relative values\n            state.height = state.maxHeight;\n         },\n         on: {\n            onShow: () => {\n               // collapse all the accordion items but the top one\n               var index = 0;\n               $$(`qtt_accordion_${this.containerDomID}`)\n                  .getChildViews()\n                  .forEach((a) => {\n                     if (index == 0) {\n                        $$(a).expand();\n                     } else {\n                        $$(a).collapse();\n                     }\n                     index++;\n                     $$(`qtt_accordion_${this.containerDomID}`).show();\n                     $$(\n                        `qtt_accordion_noSelection_${this.containerDomID}`\n                     ).hide();\n                  });\n            },\n         },\n         head: {\n            rows: [\n               {\n                  view: \"toolbar\",\n                  css: \"webix_dark\",\n                  cols: [\n                     {\n                        width: 15,\n                     },\n                     {\n                        view: \"label\",\n                        label: \"Translation Tool\",\n                        autowidth: true,\n                     },\n                     {},\n                     {\n                        view: \"button\",\n                        width: 38,\n                        css: \"webix_transparent\",\n                        icon: \"fa fa-cog\",\n                        type: \"iconTop\",\n                        click: function () {\n                           if ($$(\"translationSettings\").config.hidden) {\n                              $$(\"translationSettings\").show();\n                           } else {\n                              $$(\"translationSettings\").hide();\n                           }\n                        },\n                     },\n                     {\n                        view: \"button\",\n                        width: 35,\n                        css: \"webix_transparent\",\n                        type: \"icon\",\n                        icon: \"nomargin fa fa-times\",\n                        click: () => {\n                           $$(\n                              `quickTranslationTool_${this.containerDomID}`\n                           ).hide();\n                        },\n                     },\n                  ],\n               },\n               {\n                  view: \"toolbar\",\n                  id: \"translationSettings\",\n                  hidden: true,\n                  css: \"webix_dark\",\n                  rows: [\n                     {\n                        id: `qtt_accordion_${this.containerDomID}_translateTo`,\n                        view: \"select\",\n                        labelWidth: 120,\n                        label: \"Translate to:\",\n                        labelAlign: \"right\",\n                        options: [],\n                        on: {\n                           onChange: (newVal, oldVal) => {\n                              if (newVal != oldVal) {\n                                 this.buildTranslationAccordion(\n                                    this.application.objectsIncluded(),\n                                    this.application.pages(),\n                                    this.application.hintsIncluded()\n                                 );\n                              }\n                           },\n                        },\n                     },\n                     {\n                        id: `qtt_accordion_${this.containerDomID}_translateHint`,\n                        view: \"select\",\n                        labelWidth: 120,\n                        label: \"Hint language:\",\n                        bottomLabel: \"*Hover over label to display hint\",\n                        labelAlign: \"right\",\n                        options: [],\n                        on: {\n                           onChange: (newVal, oldVal) => {\n                              if (newVal != oldVal) {\n                                 this.buildTranslationAccordion(\n                                    this.application.objectsIncluded(),\n                                    this.application.pages(),\n                                    this.application.hintsIncluded()\n                                 );\n                              }\n                           },\n                        },\n                     },\n                  ],\n               },\n            ],\n         },\n         body: translationToolBody,\n      };\n   }\n\n   init(portal) {\n      this.AB = portal.AB;\n      this.portal = portal;\n      this.appId = portal.AppState.lastSelectedApp;\n      this.application = this.AB.applicationByID(this.appId);\n\n      const languageCode = this.AB.Config.userConfig().languageCode;\n\n      let languageList = [];\n\n      try {\n         this.AB.Network.get({\n            // The object \"SITE_LANGUAGE\"\n            url: \"/app_builder/model/d84cd351-d96c-490f-9afb-2a0b880ca0ec\",\n         }).then((list) => {\n            list.data.forEach((item) => {\n               languageList.push({\n                  id: item.language_code,\n                  value: item.language_label,\n               });\n            });\n            $$(`qtt_accordion_${this.containerDomID}_translateTo`).define({\n               options: languageList,\n               value: languageCode,\n            });\n            $$(`qtt_accordion_${this.containerDomID}_translateTo`).refresh();\n            $$(\n               `qtt_accordion_${this.containerDomID}` + \"_translateHint\"\n            ).define({\n               options: languageList,\n               value: languageList[0].id,\n            });\n            $$(\n               `qtt_accordion_${this.containerDomID}` + \"_translateHint\"\n            ).refresh();\n            this.buildTranslationAccordion(\n               this.application.objectsIncluded(),\n               this.application.pages(),\n               this.application.hintsIncluded()\n            );\n         });\n\n         webix.ready(function () {\n            webix.protoUI(\n               {\n                  name: \"edittree\",\n               },\n               webix.EditAbility,\n               webix.ui.tree\n            );\n         });\n\n         webix.ui(this.ui());\n      } catch (error) {\n         console.error(error);\n      }\n   }\n\n   show() {\n      $$(`quickTranslationTool_${this.containerDomID}`).show();\n   }\n\n   hide() {\n      $$(`quickTranslationTool_${this.containerDomID}`).hide();\n   }\n\n   showPage(pageId) {\n      let page = this.application.views((v) => {\n         return v.id == pageId;\n      })[0];\n\n      this.portal.showPage(page);\n   }\n\n   /*\n    * helper to get the current apps views\n    */\n   views(f) {\n      return this.AB.applicationByID(this.appId).views(f);\n   }\n\n   tutorials(f) {\n      return this.AB.applicationByID(this.appId).hints(f);\n   }\n\n   buildTranslationAccordion(objects, views, tutorials) {\n      $$(`qtt_accordion_${this.containerDomID}`).removeView(\n         `qtt_accordionitem_${this.containerDomID}_objects`\n      );\n      $$(`qtt_accordion_${this.containerDomID}`).removeView(\n         `qtt_accordionitem_${this.containerDomID}_views`\n      );\n      $$(`qtt_accordion_${this.containerDomID}`).removeView(\n         `qtt_accordionitem_${this.containerDomID}_tutorials`\n      );\n\n      var toggleParent = (element) => {\n         if (!element.parent) return false;\n         var parentElem = element.parent;\n         if (!parentElem.parent) return false;\n         parentElem.parent.emit(\"changeTab\", parentElem.id);\n         toggleParent(parentElem.parent);\n      };\n\n      var objectTree = [\n         {\n            id: `qtt_object_progress${this.containerDomID}`,\n            height: 7,\n         },\n         {\n            id: `linetree_${this.containerDomID}_objects`,\n            view: \"edittree\",\n            type: \"lineTree\",\n            editable: true,\n            tooltip: \"#hint#\",\n            // role: role,\n            editor: \"text\",\n            editValue: \"value\",\n            template: (obj, common) => {\n               let language = $$(\n                  `qtt_accordion_${this.containerDomID}_translateTo`\n               ).getValue();\n               var color = \"gray\";\n               if (obj.value.indexOf(`[${language}]`) > -1) {\n                  color = \"#ff5c4c\";\n               }\n               if (!obj.icon) {\n                  obj.icon = \"minus\";\n               }\n               var icon = `<span class=\"fa-stack\" style=\"margin: 0 5px 0 4px;\">\n                                             <i style=\"color: ${color};\" class=\"fa fa-circle fa-stack-2x\"></i>\n                                             <i class=\"fa fa-${obj.icon} fa-stack-1x fa-inverse\"></i>\n                                          </span>`;\n               return (\n                  `<span>` +\n                  icon +\n                  common.icon(obj, common) +\n                  `<span>${obj.value}</span>`\n               );\n            },\n            data: [],\n            on: {\n               onAfterLoad: (id) => {\n                  if (\n                     !$$(`qtt_object_progress${this.containerDomID}`)\n                        .showProgress\n                  ) {\n                     webix.extend(\n                        $$(`qtt_object_progress${this.containerDomID}`),\n                        webix.ProgressBar\n                     );\n                  }\n                  $$(`linetree_${this.containerDomID}_objects`).parse(\n                     this.getTranslationToolObjectsTree(\n                        objects,\n                        this.containerDomID\n                     )\n                  );\n                  $$(`linetree_${this.containerDomID}_objects`).openAll();\n               },\n               onAfterEditStop: (state, editor, ignoreUpdate) => {\n                  if (state.old == state.value) return false;\n                  let language = $$(\n                     `qtt_accordion_${this.containerDomID}_translateTo`\n                  ).getValue();\n                  let branch = $$(\n                     `linetree_${this.containerDomID}_objects`\n                  ).data.getItem(editor.id);\n                  let propName = branch.field;\n                  let objectId = branch.objectId ? branch.objectId : branch.id;\n                  let fieldId = branch.fieldId ? branch.fieldId : \"\";\n                  let obj = this.AB.objectByID(objectId);\n                  if (fieldId) {\n                     let field = obj.fields((item) => {\n                        return item.id == fieldId;\n                     })[0];\n                     if (branch.type == \"option\") {\n                        field.settings.options.forEach((option) => {\n                           if (option.id == branch.id) {\n                              if (obj.languageDefault() == language) {\n                                 hasLang = true;\n                                 option[propName] = state.value;\n                              } else {\n                                 option.translations.forEach((t) => {\n                                    if (t.language_code == language) {\n                                       hasLang = true;\n                                       t[propName] = state.value;\n                                    }\n                                 });\n                              }\n                              if (!hasLang) {\n                                 var trans = {};\n                                 trans.language_code = language;\n                                 trans[propName] = state.value;\n                                 option.translations.push(trans);\n                              }\n                              field.save();\n                           }\n                        });\n                     } else {\n                        var hasLang = false;\n                        if (obj.languageDefault() == language) {\n                           hasLang = true;\n                           field[propName] = state.value;\n                        } else {\n                           field.translations.forEach((t) => {\n                              if (t.language_code == language) {\n                                 hasLang = true;\n                                 t[propName] = state.value;\n                              }\n                           });\n                        }\n                        if (!hasLang) {\n                           var trans = {};\n                           trans.language_code = language;\n                           trans[propName] = state.value;\n                           field.translations.push(trans);\n                        }\n                        field.save();\n                     }\n                  } else {\n                     let hasLang = false;\n                     if (obj.languageDefault() == language) {\n                        hasLang = true;\n                        obj[propName] = state.value;\n                     } else {\n                        obj.translations.forEach((t) => {\n                           if (t.language_code == language) {\n                              hasLang = true;\n                              t[propName] = state.value;\n                           }\n                        });\n                     }\n                     if (!hasLang) {\n                        let trans = {};\n                        trans.language_code = language;\n                        trans[propName] = state.value;\n                        obj.translations.push(trans);\n                     }\n                     obj.save();\n                  }\n\n                  let progressBar = $$(\n                     `qtt_object_progress${this.containerDomID}`\n                  );\n                  let total = progressBar.config.total;\n                  let completed = progressBar.config.completed;\n\n                  if (\n                     state.old.indexOf(`[${language}]`) == -1 &&\n                     state.value.indexOf(`[${language}]`) > -1\n                  ) {\n                     completed--;\n                  } else if (\n                     state.old.indexOf(`[${language}]`) > -1 &&\n                     state.value.indexOf(`[${language}]`) > -1\n                  ) {\n                     // no change to completed count\n                  } else {\n                     completed++;\n                  }\n                  let position = completed / total + 0.00001;\n                  progressBar.define({\n                     total: total,\n                     completed: completed,\n                  });\n                  progressBar.showProgress({\n                     type: \"top\",\n                     position: position,\n                  });\n               },\n            },\n         },\n      ];\n\n      var viewTree = [\n         {\n            id: `qtt_view_progress${this.containerDomID}`,\n            height: 7,\n         },\n         {\n            id: `linetree_${this.containerDomID}_views`,\n            view: \"edittree\",\n            type: \"lineTree\",\n            editable: true,\n            tooltip: \"#hint#\",\n            // role: role,\n            editor: \"text\",\n            editValue: \"value\",\n            template: (obj, common) => {\n               let language = $$(\n                  `qtt_accordion_${this.containerDomID}_translateTo`\n               ).getValue();\n               var color = \"gray\";\n               if (obj.value.indexOf(`[${language}]`) > -1) {\n                  color = \"#ff5c4c\";\n               }\n               if (!obj.icon) {\n                  obj.icon = \"minus\";\n               }\n               var externalLink = \"\";\n               if ([\"button\", \"label\", \"menu\"].indexOf(obj.type) == -1) {\n                  externalLink = `<i style=\"float:right; color: lightgray\" class=\"externalLink fa fa-external-link\"></i>`;\n               }\n               var icon = `<span class=\"fa-stack\" style=\"margin: 0 5px 0 4px;\">\n                                             <i style=\"color: ${color};\" class=\"fa fa-circle fa-stack-2x\"></i>\n                                             <i class=\"fa fa-${obj.icon} fa-stack-1x fa-inverse\"></i>\n                                          </span>`;\n               return (\n                  `<span>` +\n                  icon +\n                  common.icon(obj, common) +\n                  `<span>${obj.value}</span>` +\n                  externalLink\n               );\n            },\n            data: [],\n            onClick: {\n               externalLink: (event, branch, target) => {\n                  var item = $$(\n                     `linetree_${this.containerDomID}_views`\n                  ).getItem(branch);\n\n                  this.showPage(item.pageId || item.viewId);\n\n                  if (item.type == \"tab\") {\n                     var tabView = this.application.views(\n                        (v) => v.id == item.id\n                     )[0];\n                     if (!tabView) return false;\n\n                     var tab = tabView.parent;\n                     if (!tab) return false;\n\n                     toggleParent(tab);\n                     if (!$$(tabView.id) || !$$(tabView.id).isVisible()) {\n                        var showIt = setInterval(function () {\n                           if ($$(tabView.id) && $$(tabView.id).isVisible()) {\n                              clearInterval(showIt);\n                           }\n                           tab.emit(\"changeTab\", tabView.id);\n                        }, 200);\n                     }\n                  } else if (item.type == \"page\") {\n                     var pageView = this.application.views(\n                        (v) => v.id == item.id\n                     )[0];\n                     if (!pageView) return false;\n                     pageView.emit(\"changePage\", pageView.id);\n                     // this.showPage(item.pageId);\n                  }\n\n                  return false;\n               },\n            },\n            on: {\n               onAfterLoad: (id) => {\n                  if (\n                     !$$(`qtt_view_progress${this.containerDomID}`).showProgress\n                  ) {\n                     webix.extend(\n                        $$(`qtt_view_progress${this.containerDomID}`),\n                        webix.ProgressBar\n                     );\n                  }\n                  $$(`linetree_${this.containerDomID}_views`).parse(\n                     this.getTranslationToolViewsTree(\n                        views,\n                        this.containerDomID\n                     )\n                  );\n                  $$(`linetree_${this.containerDomID}_views`).openAll();\n               },\n               onAfterEditStop: (state, editor, ignoreUpdate) => {\n                  if (state.old == state.value) return false;\n                  let language = $$(\n                     `qtt_accordion_${this.containerDomID}_translateTo`\n                  ).getValue();\n                  let branch = $$(\n                     `linetree_${this.containerDomID}_views`\n                  ).data.getItem(editor.id);\n                  let propName = branch.field;\n                  if (branch.type == \"menu\") {\n                     let view = this.application.views((view) => {\n                        return view.id == branch.viewId;\n                     })[0];\n                     view.settings.order.forEach((button) => {\n                        if (button.pageId == branch.buttonId) {\n                           let hasLang = false;\n                           button.translations.forEach((t) => {\n                              if (t.language_code == language) {\n                                 hasLang = true;\n                                 t[propName] = state.value;\n                              }\n                           });\n                           if (!hasLang) {\n                              let trans = {};\n                              trans.language_code = language;\n                              trans[propName] = state.value;\n                              button.translations.push(trans);\n                           }\n                           view.save();\n                        }\n                     });\n                  } else if (branch.type == \"button\") {\n                     let view = this.application.views((view) => {\n                        return view.id == branch.viewId;\n                     })[0];\n                     var hasLang = false;\n\n                     if (view.languageDefault() == language) {\n                        hasLang = true;\n                        view.settings[propName] = state.value;\n                     } else {\n                        view.settings.translations.forEach((t) => {\n                           if (t.language_code == language) {\n                              hasLang = true;\n                              t[propName] = state.value;\n                           }\n                        });\n                     }\n                     if (!hasLang) {\n                        var trans = {};\n                        trans.language_code = language;\n                        trans[propName] = state.value;\n                        view.settings.translations.push(trans);\n                     }\n                     view.save();\n                  } else {\n                     let view = this.application.views((view) => {\n                        return view.id == branch.id;\n                     })[0];\n                     let hasLang = false;\n                     if (view.languageDefault() == language) {\n                        hasLang = true;\n                        view[propName] = state.value;\n                     } else {\n                        view.translations.forEach((t) => {\n                           if (t.language_code == language) {\n                              hasLang = true;\n                              t[propName] = state.value;\n                           }\n                        });\n                     }\n                     if (!hasLang) {\n                        let trans = {};\n                        trans.language_code = language;\n                        trans[propName] = state.value;\n                        view.translations.push(trans);\n                     }\n                     view.save();\n                  }\n                  let progressBar = $$(\n                     `qtt_view_progress${this.containerDomID}`\n                  );\n                  let total = progressBar.config.total;\n                  let completed = progressBar.config.completed;\n                  if (\n                     state.old.indexOf(`[${language}]`) == -1 &&\n                     state.value.indexOf(`[${language}]`) > -1\n                  ) {\n                     completed--;\n                  } else if (\n                     state.old.indexOf(`[${language}]`) > -1 &&\n                     state.value.indexOf(`[${language}]`) > -1\n                  ) {\n                     // no change to completed count\n                  } else {\n                     completed++;\n                  }\n                  let position = completed / total + 0.00001;\n                  progressBar.define({\n                     total: total,\n                     completed: completed,\n                  });\n                  progressBar.showProgress({\n                     type: \"top\",\n                     position: position,\n                  });\n               },\n            },\n         },\n      ];\n\n      var tutorialTree = [\n         {\n            id: `qtt_tutorials_progress${this.containerDomID}`,\n            height: 7,\n         },\n         {\n            id: `linetree_${this.containerDomID}_tutorials`,\n            view: \"edittree\",\n            type: \"lineTree\",\n            editable: true,\n            tooltip: \"#hint#\",\n            // role: role,\n            editor: \"text\",\n            editValue: \"value\",\n            template: (obj, common) => {\n               let language = $$(\n                  `qtt_accordion_${this.containerDomID}_translateTo`\n               ).getValue();\n               var color = \"gray\";\n               if (obj.value.indexOf(`[${language}]`) > -1) {\n                  color = \"#ff5c4c\";\n               }\n               if (!obj.icon) {\n                  obj.icon = \"minus\";\n               }\n               var icon = `<span class=\"fa-stack\" style=\"margin: 0 5px 0 4px;\">\n                                             <i style=\"color: ${color};\" class=\"fa fa-circle fa-stack-2x\"></i>\n                                             <i class=\"fa fa-${obj.icon} fa-stack-1x fa-inverse\"></i>\n                                          </span>`;\n               return (\n                  `<span>` +\n                  icon +\n                  common.icon(obj, common) +\n                  `<span>${obj.value}</span>`\n               );\n            },\n            data: [],\n            on: {\n               onAfterLoad: (id) => {\n                  if (\n                     !$$(`qtt_tutorials_progress${this.containerDomID}`)\n                        .showProgress\n                  ) {\n                     webix.extend(\n                        $$(`qtt_tutorials_progress${this.containerDomID}`),\n                        webix.ProgressBar\n                     );\n                  }\n                  $$(`linetree_${this.containerDomID}_tutorials`).parse(\n                     this.getTranslationToolTutorialsTree(\n                        tutorials,\n                        this.containerDomID\n                     )\n                  );\n                  $$(`linetree_${this.containerDomID}_tutorials`).openAll();\n               },\n               onAfterEditStop: (state, editor, ignoreUpdate) => {\n                  /// need to work here next week james\n                  if (state.old == state.value) return false;\n                  let language = $$(\n                     `qtt_accordion_${this.containerDomID}_translateTo`\n                  ).getValue();\n                  let branch = $$(\n                     `linetree_${this.containerDomID}_tutorials`\n                  ).data.getItem(editor.id);\n                  let propName = branch.field;\n                  if (branch.type == \"tutorial\") {\n                     let hint = this.AB.hints((h) => {\n                        return h.id == branch.viewId;\n                     })[0];\n                     let hasLang = false;\n                     if (hint.languageDefault() == language) {\n                        hasLang = true;\n                        hint[propName] = state.value;\n                     } else {\n                        hint.translations.forEach((t) => {\n                           if (t.language_code == language) {\n                              hasLang = true;\n                              t[propName] = state.value;\n                           }\n                        });\n                     }\n                     if (!hasLang) {\n                        let trans = {};\n                        for (const [key, value] of Object.entries(\n                           hint.translations[0]\n                        )) {\n                           trans[key] = `[${language}] ${value}`;\n                        }\n                        trans.language_code = language;\n                        trans[propName] = state.value;\n                        hint.translations.push(trans);\n                     }\n                     hint.save();\n                  } else if (branch.type == \"step\") {\n                     let hint = this.AB.hints((h) => {\n                        return h.id == branch.hintId;\n                     })[0];\n                     let step = hint._steps[branch.viewId];\n                     let hasLang = false;\n                     if (step.languageDefault() == language) {\n                        hasLang = true;\n                        step[propName] = state.value;\n                     } else {\n                        step.translations.forEach((t) => {\n                           if (t.language_code == language) {\n                              hasLang = true;\n                              t[propName] = state.value;\n                           }\n                        });\n                     }\n                     if (!hasLang) {\n                        let trans = {};\n                        for (const [key, value] of Object.entries(\n                           step.translations[0]\n                        )) {\n                           trans[key] = `[${language}] ${value}`;\n                        }\n                        trans.language_code = language;\n                        trans[propName] = state.value;\n                        step.translations.push(trans);\n                     }\n                     step.save();\n                  }\n                  let progressBar = $$(\n                     `qtt_tutorials_progress${this.containerDomID}`\n                  );\n                  let total = progressBar.config.total;\n                  let completed = progressBar.config.completed;\n                  if (\n                     state.old.indexOf(`[${language}]`) == -1 &&\n                     state.value.indexOf(`[${language}]`) > -1\n                  ) {\n                     completed--;\n                  } else if (\n                     state.old.indexOf(`[${language}]`) > -1 &&\n                     state.value.indexOf(`[${language}]`) > -1\n                  ) {\n                     // no change to completed count\n                  } else {\n                     completed++;\n                  }\n                  let position = completed / total + 0.00001;\n                  progressBar.define({\n                     total: total,\n                     completed: completed,\n                  });\n                  progressBar.showProgress({\n                     type: \"top\",\n                     position: position,\n                  });\n               },\n            },\n         },\n      ];\n\n      var objectsAccordionItem = {\n         view: \"accordionitem\",\n         id: `qtt_accordionitem_${this.containerDomID}_objects`,\n         header: \"Data Objects\",\n         collapsed: true,\n         body: {\n            type: \"clean\",\n            rows: objectTree,\n         },\n      };\n\n      var viewsAccordionItem = {\n         view: \"accordionitem\",\n         id: `qtt_accordionitem_${this.containerDomID}_views`,\n         header: \"Interface Items\",\n         collapsed: true,\n         body: {\n            type: \"clean\",\n            rows: viewTree,\n         },\n      };\n\n      var hintsAccordionItem = {\n         view: \"accordionitem\",\n         id: `qtt_accordionitem_${this.containerDomID}_tutorials`,\n         header: \"Tutorials\",\n         collapsed: true,\n         body: {\n            type: \"clean\",\n            rows: tutorialTree,\n         },\n      };\n\n      $$(`qtt_accordion_${this.containerDomID}`).addView(\n         objectsAccordionItem,\n         -1\n      );\n      $$(`qtt_accordion_${this.containerDomID}`).addView(\n         viewsAccordionItem,\n         -1\n      );\n      $$(`qtt_accordion_${this.containerDomID}`).addView(\n         hintsAccordionItem,\n         -1\n      );\n      $$(`qtt_accordion_${this.containerDomID}`).show();\n      $$(`qtt_accordionitem_${this.containerDomID}_views`).collapse();\n      $$(`qtt_accordionitem_${this.containerDomID}_tutorials`).collapse();\n      $$(`qtt_accordion_noSelection_${this.containerDomID}`).hide();\n\n      $$(`linetree_${this.containerDomID}_objects`).openAll();\n      $$(`linetree_${this.containerDomID}_views`).openAll();\n      $$(`linetree_${this.containerDomID}_tutorials`).openAll();\n   }\n\n   getTranslations(translations, domId, field, completed, total) {\n      var missingHint = false;\n      var missingTranslate = false;\n      var translateLang = $$(`qtt_accordion_${domId}_translateTo`).getValue();\n      var value = translations.filter((item) => {\n         return item.language_code == translateLang;\n      })[0];\n      if (!value) {\n         // we didn't find the language so we are defaulting to first language\n         missingTranslate = true;\n         value = translations[0];\n      }\n      var hintLang = $$(`qtt_accordion_${domId}_translateHint`).getValue();\n      var hint = translations.filter((item) => {\n         return item.language_code == hintLang;\n      })[0];\n      if (!hint) {\n         // we didn't find the language so we are defaulting to first language\n         missingHint = true;\n         hint = translations[0];\n      }\n\n      var hintLabel = \"\";\n      var valueLabel = \"\";\n\n      // some items store the text we need translated under \"text\"\n      if (field) {\n         hintLabel = hint[field];\n         valueLabel = value[field];\n      }\n      if (!hintLabel) {\n         hintLabel = hint.label;\n      }\n      if (!valueLabel) {\n         valueLabel = value.label;\n      }\n\n      var hintPrefix = \"\";\n      if (missingHint) {\n         hintPrefix = `[${hintLang}] `;\n      }\n      var translatePrefix = \"\";\n      if (missingTranslate) {\n         translatePrefix = `[${translateLang}] `;\n      }\n      if (\n         (valueLabel || \"\").indexOf(`[${translateLang}]`) == -1 &&\n         !missingTranslate\n      ) {\n         completed++;\n      }\n      total++;\n      return {\n         hint: hintPrefix + hintLabel,\n         value: translatePrefix + valueLabel,\n         completed: completed,\n         total: total,\n      };\n   }\n\n   getTranslationToolViewsTree(views, domId) {\n      var completed = 0;\n      var total = 0;\n      // this so it looks right/indented in a tree view:\n      var tree = new webix.TreeCollection();\n\n      /**\n       * @method addPage\n       *\n       * @param {ABView} page\n       * @param {integer} index\n       * @param {uuid} parentId\n       */\n      var addPage = (page, parentId, type, field = \"label\", viewId) => {\n         var translations = page.translations;\n         var pageId = page.id;\n         if (type == \"button\") {\n            translations = page.settings.translations;\n            pageId = `${page.id}_${field}`;\n         }\n         var labels = this.getTranslations(\n            translations,\n            domId,\n            field,\n            completed,\n            total\n         );\n         completed = labels.completed;\n         total = labels.total;\n         var icon = page.tabicon ? page.tabicon : page.icon;\n\n         // add to tree collection\n         var branch = {\n            id: pageId,\n            value: labels.value,\n            hint: labels.hint,\n            field: field,\n            viewId: viewId,\n            translations: page.translations,\n            pageId: parentId,\n            buttonId: page.pageId,\n            type: type,\n            icon: icon,\n         };\n         tree.add(branch, null, parentId);\n\n         // stop at detail views\n         // if (page.defaults.key == \"detail\") {\n         //    return;\n         // }\n\n         var subPages = page.pages ? page.pages() : [];\n         subPages.forEach((childPage, childIndex) => {\n            addPage(childPage, page.id, \"page\");\n         });\n\n         // stop if there are no views to parse\n         if (!page.views) return;\n         // add labels\n         page\n            .views((v) => v.defaults.key == \"label\")\n            .forEach((label, labelIndex) => {\n               // label views\n               // label.icon = \"th-list\";\n               addPage(label, page.id, \"label\", \"text\", label.id);\n            });\n         // add tabs\n         page\n            .views((v) => v.defaults.key == \"tab\")\n            .forEach((tab, tabIndex) => {\n               // tab views\n               tab.views().forEach((tabView, tabViewIndex) => {\n                  // tab items will be below sub-page items\n                  // tabView.icon = \"th-list\";\n                  addPage(tabView, page.id, \"tab\", \"label\", tab.id);\n               });\n            });\n         // add menus\n         page\n            .views((v) => v.defaults.key == \"menu\")\n            .forEach((menu, menuIndex) => {\n               // menu buttons\n               if (!menu.settings.order) return;\n               menu.settings.order.forEach((menuItem, menuItemIndex) => {\n                  // tab items will be below sub-page items\n                  // menuItem.icon = \"link\";\n                  addPage(menuItem, page.id, \"menu\", \"aliasname\", menu.id);\n               });\n            });\n         // add form buttons\n         page\n            .views((v) => v.defaults.key == \"form\")\n            .forEach((form, formIndex) => {\n               // form inputs\n               form.views().forEach((formInput, formInputIndex) => {\n                  // we only need buttons\n                  if (formInput.key == \"button\") {\n                     for (const property in formInput.settings\n                        .translations[0]) {\n                        if (property != \"language_code\") {\n                           addPage(\n                              formInput,\n                              page.id,\n                              \"button\",\n                              property,\n                              formInput.id\n                           );\n                        }\n                     }\n                  }\n               });\n            });\n         // add chart labels\n         page\n            .views((v) => v.defaults.key == \"chart\")\n            .forEach((chart, chartIndex) => {\n               // chart views\n               chart.views().forEach((view, viewIndex) => {\n                  // we only need buttons\n                  if (view.key == \"label\") {\n                     addPage(view, page.id, \"label\", \"text\", view.id);\n                  }\n               });\n            });\n      };\n      views.forEach((p, index) => {\n         addPage(p, null, \"page\", \"label\", p.id);\n      });\n\n      // there is a webix bug that will not allow you to se the value of a progress bar to 0\n      let progressBar = $$(`qtt_view_progress${domId}`);\n      let position = completed / total + 0.0001;\n      progressBar.showProgress({\n         type: \"top\",\n         position: position,\n      });\n      progressBar.define({\n         total: total,\n         completed: completed,\n      });\n\n      return tree;\n   }\n\n   getTranslationToolObjectsTree(objects, domId) {\n      var completed = 0;\n      var total = 0;\n      // this so it looks right/indented in a tree view:\n      var tree = new webix.TreeCollection();\n\n      /**\n       * @method addBranch\n       *\n       * @param {ABView} page\n       * @param {uuid} parentId\n       * @param {string} type\n       */\n      var addBranch = (\n         object,\n         parentId,\n         type,\n         field = \"label\",\n         fieldId,\n         objectId\n      ) => {\n         var translations = object.translations;\n         // we were missing translationson the Roles object\n         if (!translations) return;\n         var labels = this.getTranslations(\n            translations,\n            domId,\n            field,\n            completed,\n            total\n         );\n         completed = labels.completed;\n         total = labels.total;\n\n         // add to tree collection\n         var branch = {\n            id: object.id,\n            value: labels.value,\n            hint: labels.hint,\n            translations: object.translations,\n            pageId: parentId,\n            objectId: objectId,\n            type: type,\n            field: field,\n            fieldId: fieldId,\n            icon:\n               type == \"object\" ? \"database\" : object.icon ? object.icon : \"\",\n         };\n         tree.add(branch, null, parentId);\n\n         var fields = object.fields ? object.fields() : [];\n         fields.forEach((field, fieldIndex) => {\n            addBranch(field, object.id, \"field\", \"label\", field.id, object.id);\n         });\n\n         // add options\n         if (\n            object.settings &&\n            object.settings.options &&\n            object.settings.options.length\n         ) {\n            object.settings.options.forEach((option, optionIndex) => {\n               addBranch(\n                  option,\n                  object.id,\n                  \"option\",\n                  \"text\",\n                  fieldId,\n                  parentId\n               );\n            });\n         }\n      };\n      objects.forEach((p, index) => {\n         addBranch(p, null, \"object\");\n      });\n\n      // there is a webix bug that will not allow you to se the value of a progress bar to 0\n      let progressBar = $$(`qtt_object_progress${domId}`);\n      let position = completed / total + 0.0001;\n      progressBar.showProgress({\n         type: \"top\",\n         position: position,\n      });\n      progressBar.define({\n         total: total,\n         completed: completed,\n      });\n\n      return tree;\n   }\n\n   getTranslationToolTutorialsTree(tutorials, domId) {\n      var completed = 0;\n      var total = 0;\n      // this so it looks right/indented in a tree view:\n      var tree = new webix.TreeCollection();\n\n      /**\n       * @method addBranch\n       *\n       * @param {ABView} page\n       * @param {uuid} parentId\n       * @param {string} type\n       */\n      var addBranch = (\n         object,\n         parentId,\n         type,\n         field = [\"label\"],\n         hintId = null\n      ) => {\n         var translations = object.translations;\n         // we were missing translationson the Roles object\n         if (!translations) return;\n         let lastField = \"\";\n         let firstField = \"\";\n         field.forEach((f) => {\n            if (firstField == \"\") firstField = f;\n            lastField = f;\n            var labels = this.getTranslations(\n               translations,\n               domId,\n               f,\n               completed,\n               total\n            );\n            completed = labels.completed;\n            total = labels.total;\n\n            // add to tree collection\n            var branch = {\n               id: object.id + f,\n               viewId: object.id,\n               value: labels.value,\n               hint: labels.hint,\n               translations: object.translations,\n               field: f,\n               type: type,\n               hintId: hintId,\n               icon:\n                  type == \"tutorial\"\n                     ? \"info-circle\"\n                     : object.icon\n                     ? object.icon\n                     : \"minus-circle\",\n            };\n            tree.add(branch, null, parentId);\n            parentId = object.id + firstField;\n         });\n\n         var steps = object.stepIDs || [];\n         steps.forEach((step) => {\n            addBranch(\n               object._steps[step],\n               parentId,\n               \"step\",\n               [\"name\", \"text\"],\n               object.id\n            );\n         });\n      };\n      tutorials.forEach((p, index) => {\n         addBranch(p, null, \"tutorial\", [\"name\", \"description\"]);\n      });\n\n      // there is a webix bug that will not allow you to se the value of a progress bar to 0\n      let progressBar = $$(`qtt_tutorials_progress${domId}`);\n      let position = completed / total + 0.0001;\n      progressBar.showProgress({\n         type: \"top\",\n         position: position,\n      });\n      progressBar.define({\n         total: total,\n         completed: completed,\n      });\n\n      return tree;\n   }\n}\n\nexport default new PortalTranslationTool();\n","import ClassUI from \"./ClassUI.js\";\n\nlet L = (...params) => AB.Multilingual.label(...params);\n\nclass PortalTutorialManager extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui(appId) {\n      // this is the modal window that opens when you click a tutorial to edit\n      const tutorialStepsManager = (id) => {\n         return {\n            view: \"window\",\n            id: \"stepManager\" + id,\n            head: {\n               view: \"toolbar\",\n               css: \"webix_dark\",\n               cols: [\n                  {\n                     width: 15,\n                  },\n                  {\n                     view: \"label\",\n                     label: \"Tutorial Steps Manager\",\n                     autowidth: true,\n                  },\n                  {},\n                  {\n                     view: \"button\",\n                     type: \"icon\",\n                     icon: \"fa fa-plus\",\n                     label: \"Step\",\n                     autowidth: true,\n                     css: \"webix_primary\",\n                     click: async () => {\n                        // create ABStep\n                        let step = await this.createStep(id);\n                        // save it to get an id to store on the ABHint\n                        await step.save();\n\n                        // get the current ABHint\n                        let hint = this.AB.hints((h) => {\n                           return h.id == id;\n                        })[0];\n                        // store the new ABStep id in the current ABHint\n                        if (hint?.stepIDs && Array.isArray(hint.stepIDs)) {\n                           hint.stepIDs.push(step.id);\n                        } else {\n                           hint.stepIDs = [step.id];\n                        }\n                        // store the ABStep in the ABHint (not saved in definitions)\n                        hint._steps[step.id] = step;\n                        // add the new step UI to the interface\n                        $$(\"hint_steps_\" + hint.id).addView(\n                           this.stepUI(step, hint)\n                        );\n                     },\n                  },\n                  {\n                     view: \"button\",\n                     width: 35,\n                     css: \"webix_transparent\",\n                     type: \"icon\",\n                     icon: \"nomargin fa fa-times\",\n                     click: () => {\n                        $$(\"stepManager\" + id).close();\n                        this.show();\n                     },\n                  },\n               ],\n            },\n            width: 800,\n            height: 500,\n            move: true,\n            position: \"center\",\n            resize: true,\n            body: {\n               rows: [\n                  {\n                     view: \"scrollview\",\n                     body: {\n                        rows: [\n                           tutorialSettings(id),\n                           {\n                              id: \"hint_steps_\" + id,\n                              rows: [],\n                           },\n                        ],\n                     },\n                  },\n                  save(id),\n               ],\n            },\n         };\n      };\n\n      // ui that contains the list of current ABHints on this application\n      const tutorialManagerBody = {\n         view: \"scrollview\",\n         css: \"lightgray ab_tutorial\",\n         body: {\n            rows: [\n               {\n                  view: \"list\",\n                  id: \"tutorial_list\",\n                  template: `<div class=\"deleteHint\">\n                                 <i class=\"fa fa-times\"></i>\n                              </div>\n                              <div class=\"active#settings.active# abTutorial\">\n                                 <h1>#name#</h1>\n                                 <p>#description#</p>\n                              </div>`,\n                  data: this._hints,\n                  hidden: this._hints.length == 0, // hide if we do not have any hints yet\n                  type: {\n                     css: \"hintItem\",\n                     height: \"auto\",\n                  },\n                  onClick: {\n                     deleteHint: (ev, id) => {\n                        // Confirm user wants to delete the hint\n                        webix\n                           .confirm({\n                              title: L(\"Delete Tutorial\"),\n                              text: L(\n                                 \"Are you sure you want to delete this tutorial?\"\n                              ),\n                              type: \"confirm-error\",\n                           })\n                           .then((result) => {\n                              // get the hint that we want to delete\n                              let hint = this.AB.hintID(id);\n                              // delete the hint (steps will also be deleted)\n                              hint.destroy(this.application);\n                              // remove the hint from the ui\n                              $$(\"tutorial_list\").remove(id);\n                              // check if we have any hints if not switch views\n                              if ($$(\"tutorial_list\").count() == 0) {\n                                 $$(\"tutorial_list\").hide();\n                                 $$(\"tutorial_list_noSelection\").show();\n                              }\n                              return false; // blocks the default click behavior\n                           })\n                           .fail(() => {\n                              // webix.message(\"Cancel\");\n                           });\n                        return false;\n                     },\n                     hintItem: (ev, id) => {\n                        // open the editor for the hint\n                        webix.ui(tutorialStepsManager(id)).show();\n                        // insert the steps into the manager to edit\n                        this.steps(id);\n                        this.hide();\n                     },\n                  },\n               },\n               {\n                  id: \"tutorial_list_noSelection\",\n                  hidden: this._hints.length > 0,\n                  rows: [\n                     {},\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        height: 200,\n                        label: \"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-info-circle'></div>\",\n                     },\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        label: \"Add a tutorial to this page.\",\n                     },\n                     {\n                        cols: [\n                           {},\n                           {\n                              view: \"button\",\n                              label: \"Create Tutorial\",\n                              type: \"form\",\n                              css: \"webix_primary\",\n                              autowidth: true,\n                              click: () => {\n                                 // open modal that helps user make a new hint\n                                 webix.ui(newTutorialPopup).show();\n\n                                 // populate the optiosn of the page/tab combo\n                                 $$(\"view_popup_options\").define(\n                                    \"options\",\n                                    this.options\n                                 );\n                                 // attempt to set the values of the combo based off the\n                                 // last visited page would be better if we could look at\n                                 // tabs as well\n                                 $$(\"view_popup_options\").define(\n                                    \"value\",\n                                    this.portal.AppState.lastPages[\n                                       this.portal.AppState.lastSelectedApp\n                                    ]\n                                 );\n                                 $$(\"view_popup_options\").refresh();\n                              },\n                           },\n                           {},\n                        ],\n                     },\n                     {},\n                  ],\n               },\n            ],\n         },\n      };\n\n      // small modal that is displayed when user wants to create a new tutorial/hint\n      const newTutorialPopup = {\n         view: \"popup\",\n         id: \"newTutorialPopup\",\n         position: \"center\",\n         height: 250,\n         width: 350,\n         modal: true,\n         body: {\n            rows: [\n               {\n                  view: \"toolbar\",\n                  id: \"myToolbarABLiveTool\",\n                  css: \"webix_dark\",\n                  cols: [\n                     {\n                        view: \"label\",\n                        label: L(\"Create Tutorial\"),\n                        align: \"center\",\n                     },\n                  ],\n               },\n               {\n                  view: \"form\",\n                  elements: [\n                     {\n                        view: \"combo\",\n                        label: \"\",\n                        id: \"view_popup_options\",\n                        placeholder: L(\"Choose Page or Tab\"),\n                        options: [],\n                     },\n                     {\n                        cols: [\n                           {\n                              view: \"button\",\n                              value: L(\"Cancel\"),\n                              click: () => {\n                                 $$(\"newTutorialPopup\").hide();\n                              },\n                           },\n                           {\n                              view: \"button\",\n                              value: \"Create\",\n                              id: \"view_popup_options_add\",\n                              css: \"webix_primary\",\n                              click: () => {\n                                 let view = $$(\"view_popup_options\").getValue();\n                                 let text = $$(\"view_popup_options\")\n                                    .getText()\n                                    .trim();\n                                 // take values from selection to build a new hint\n                                 this.createTutorial(view, text);\n                                 $$(\"newTutorialPopup\").hide();\n                              },\n                           },\n                        ],\n                     },\n                  ],\n               },\n            ],\n         },\n      };\n\n      // save the hint and step values and close the manager\n      const save = (id) => {\n         return {\n            cols: [\n               {},\n               {\n                  view: \"button\",\n                  value: L(\"Cancel\"),\n                  width: 100,\n                  click: () => {\n                     $$(\"stepManager\" + id).close();\n                     this.show();\n                  },\n               },\n               {\n                  view: \"button\",\n                  value: L(\"Save\"),\n                  width: 100,\n                  css: \"webix_primary\",\n                  click: async (element, event) => {\n                     // validate form\n                     let valid = $$(\"stepform\" + id).validate();\n                     // get hint we are going to update\n                     let hint = this.AB.hints((h) => {\n                        return h.id == id;\n                     })[0];\n                     // loop through steps to get values and save\n                     hint.stepIDs.forEach((step) => {\n                        if (hint?._steps?.[step]) {\n                           // validate each step to ensure they are ready to save\n                           if (\n                              !$$(\"step_form\" + step).validate({\n                                 disabled: true,\n                              })\n                           ) {\n                              valid = false;\n                           } else {\n                              // set values so we can save later\n                              let values = $$(\"step_form\" + step).getValues();\n                              hint._steps[step].name = values.name;\n                              hint._steps[step].text = values.text;\n                              hint._steps[step].settings.event = values.event;\n                              hint._steps[step].settings.el = values.el;\n                              // hint._steps[step].save();\n                           }\n                        }\n                     });\n                     if (!valid) return false;\n\n                     var values = $$(\"stepform\" + id).getValues();\n                     hint.name = values.name;\n                     hint.description = values.description;\n                     hint.settings.view = values.view;\n                     hint.settings.active = values.active;\n                     // save the steps data next\n                     // hint.stepIDs.forEach((step) => {\n                     //    if (hint?._steps?.[step]) {\n                     //       hint._steps[step].save();\n                     //    }\n                     // });\n                     for (const step of hint.stepIDs) {\n                        if (hint?._steps?.[step]) {\n                           await hint._steps[step].save();\n                        }\n                     }\n                     await hint.save();\n                     $$(\"stepManager\" + id).close();\n                     this.show();\n                  },\n               },\n               {},\n            ],\n         };\n      };\n\n      // ui that is at the top of the tutorial manager for the global tutorial settings\n      const tutorialSettings = (id) => {\n         let currentTutorial = this.AB.hints((h) => {\n            return h.id == id;\n         })[0];\n         let active = currentTutorial?.settings.hasOwnProperty(\"active\")\n            ? currentTutorial.settings.active\n            : \"1\";\n         return {\n            view: \"form\",\n            id: \"stepform\" + id,\n            borderless: true,\n            cols: [\n               {\n                  id: \"step_window\",\n                  rows: [\n                     {\n                        view: \"text\",\n                        label: L(\"Title\"),\n                        name: \"name\",\n                        validate: webix.rules.isNotEmpty,\n                        invalidMessage: L(\"Title is required\"),\n                        value: currentTutorial.name,\n                     },\n                     {\n                        view: \"textarea\",\n                        label: L(\"Text\"),\n                        labelAlign: \"left\",\n                        height: 100,\n                        name: \"description\",\n                        value: currentTutorial?.description || \"\",\n                     },\n                  ],\n               },\n               {\n                  width: 300,\n                  rows: [\n                     {\n                        cols: [\n                           {\n                              view: \"label\",\n                              label: L(\"Page/Tab\"),\n                              align: \"left\",\n                              width: 100,\n                           },\n                           // {\n                           //    view: \"button\",\n                           //    icon: \"fa fa-crosshairs\",\n                           //    type: \"icon\",\n                           //    label: L(\"select\"),\n                           //    css: \"focusPageTab webix_primary\",\n                           //    currentTutorialID: id,\n                           //    width: 100,\n                           //    click: () => {\n                           //       $$(\"stepManager\" + currentTutorial.id).hide();\n                           //       document.addEventListener(\n                           //          \"click\",\n                           //          this.handlePageTabClick,\n                           //          false\n                           //       );\n                           //       document.hintId = id;\n                           //       webix.ui(this.pageTabWindow(id)).show();\n                           //    },\n                           // },\n                           {\n                              view: \"combo\",\n                              name: \"view\",\n                              value: currentTutorial.settings.view,\n                              options: {\n                                 view: \"suggest\",\n                                 css: \"wider_popup\",\n                                 body: {\n                                    view: \"list\",\n                                    css: \"wider_popup\",\n                                    data: this.options,\n                                    template: \"#value#\",\n                                 },\n                              },\n                           },\n                        ],\n                     },\n\n                     {\n                        view: \"switch\",\n                        label: L(\"Active\"),\n                        labelWidth: 100,\n                        name: \"active\",\n                        value: active,\n                     },\n                  ],\n               },\n            ],\n         };\n      };\n\n      // this is the drawer admin that lists all tutorials\n      return {\n         view: \"window\",\n         css: \"tutorialWindow\",\n         id: \"tutorial_manager\",\n         position: function (state) {\n            state.left = state.maxWidth - 350; // fixed values\n            state.top = 0;\n            state.width = 350; // relative values\n            state.height = state.maxHeight;\n         },\n         on: {\n            onShow: () => {},\n         },\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               {\n                  width: 15,\n               },\n               {\n                  view: \"label\",\n                  label: \"Tutorial Manager\",\n                  autowidth: true,\n               },\n               {},\n               {\n                  view: \"button\",\n                  type: \"icon\",\n                  icon: \"fa fa-plus\",\n                  label: \"Tutorial\",\n                  width: 95,\n                  css: \"webix_primary\",\n                  click: () => {\n                     webix.ui(newTutorialPopup).show();\n\n                     $$(\"view_popup_options\").define(\"options\", this.options);\n                     $$(\"view_popup_options\").define(\n                        \"value\",\n                        this.portal.AppState.lastPages[\n                           this.portal.AppState.lastSelectedApp\n                        ]\n                     );\n                     $$(\"view_popup_options\").refresh();\n                  },\n               },\n               {\n                  view: \"button\",\n                  width: 35,\n                  css: \"webix_transparent\",\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     this.hide();\n                  },\n               },\n            ],\n         },\n         body: tutorialManagerBody,\n      };\n   }\n\n   init(portal) {\n      this.AB = portal.AB;\n      this.portal = portal;\n      this.appId = portal.AppState.lastSelectedApp;\n\n      this.application = this.AB.applicationByID(this.appId);\n      const pages = this.application.pages();\n      this.options = this.getViewOptions(pages);\n      // only return tutorials that are on current application\n      this._hints = this.AB.hints((hint) => {\n         if (this.application.hintIDs.indexOf(hint.id) > -1) {\n            return true;\n         } else {\n            return false;\n         }\n      });\n      webix.ui(this.ui());\n   }\n\n   show() {\n      // this gets the latest hints and updates them to local list.\n      $$(\"tutorial_manager\").show();\n      this._hints = this.AB.hints((hint) => {\n         if (this.application.hintIDs.indexOf(hint.id) > -1) {\n            return true;\n         } else {\n            return false;\n         }\n      });\n      $$(\"tutorial_list\").define(\"data\", this._hints);\n      $$(\"tutorial_list\").refresh();\n   }\n\n   hide() {\n      $$(\"tutorial_manager\").hide();\n   }\n\n   // small modal that gives instructions to user when selecting the page or tab to load this tutorial on\n   pageTabWindow(hintID) {\n      return {\n         view: \"window\",\n         id: \"pageTabWindow\",\n         width: 160,\n         height: 160,\n         move: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               {},\n               {\n                  view: \"button\",\n                  width: 35,\n                  css: \"webix_transparent\",\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     $$(\"stepManager\" + hintID).show();\n                     $$(\"pageTabWindow\").hide();\n\n                     document.removeEventListener(\n                        \"contextmenu\",\n                        this.handleRightClick,\n                        false\n                     );\n                  },\n               },\n            ],\n         },\n         position: function (state) {\n            state.left = state.maxWidth - state.width;\n            state.top = state.maxHeight - state.height;\n         },\n         body: {\n            template:\n               \"<div class='highlightWin'>\" +\n               L(\"Click the page or tab that will start this tutorial\") +\n               \"</div>\",\n         },\n      };\n   }\n\n   // small modal that gives instructions to users when they are selecting the highlight element\n   focusWindow(hintID) {\n      return {\n         view: \"window\",\n         id: \"focusWindow\",\n         width: 160,\n         height: 160,\n         move: true,\n         head: {\n            view: \"toolbar\",\n            css: \"webix_dark\",\n            cols: [\n               {},\n               {\n                  view: \"button\",\n                  width: 35,\n                  css: \"webix_transparent\",\n                  type: \"icon\",\n                  icon: \"nomargin fa fa-times\",\n                  click: () => {\n                     $$(\"stepManager\" + hintID).show();\n                     $$(\"focusWindow\").hide();\n\n                     document.removeEventListener(\n                        \"contextmenu\",\n                        this.handleRightClick,\n                        false\n                     );\n                     document.body.classList.remove(\"findDataCy\");\n                  },\n               },\n            ],\n         },\n         position: function (state) {\n            state.left = state.maxWidth - state.width;\n            state.top = state.maxHeight - state.height;\n         },\n         body: {\n            template:\n               \"<div class='highlightWin'>\" +\n               L(\"Right click the element you want to highlight.\") +\n               \"</div>\",\n         },\n      };\n   }\n\n   updateStepsUI(id) {\n      const views = $$(\"hint_steps_\" + id).getChildViews();\n      let viewsToRemove = [];\n      views.forEach((view) => {\n         viewsToRemove.push(view.config.id);\n      });\n      viewsToRemove.forEach((view) => {\n         $$(\"hint_steps_\" + id).removeView(view);\n      });\n      this.steps(id);\n   }\n\n   addHighlightClass(event) {\n      let item = $$(event.currentTarget);\n      let formVals = $$(\"step_form\" + item.config.stepId).getValues();\n      document.querySelector(formVals?.el).classList.add(\"highlightMe\");\n   }\n   removeHighlightClass(event) {\n      let item = $$(event.currentTarget);\n      let formVals = $$(\"step_form\" + item.config.stepId).getValues();\n      document.querySelector(formVals?.el).classList.remove(\"highlightMe\");\n   }\n\n   // build a list of steps that are included in this hint\n   steps(id) {\n      let hint = this.AB.hints((h) => {\n         return h.id == id;\n      })[0];\n      // if we do not have steps\n      if (!hint?.stepIDs?.length) {\n         let addStepBelow = {\n            id: \"addStepBelow\",\n            padding: 20,\n            rows: [\n               {\n                  css: \"ab-component-form-rules\",\n                  rows: [\n                     {},\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        height: 80,\n                        label: \"<div style='display: block; font-size: 80px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-info-circle'></div>\",\n                     },\n                     {\n                        view: \"label\",\n                        align: \"center\",\n                        label: L(\"Add a step to this tutorial.\"),\n                     },\n                     {\n                        cols: [\n                           {},\n                           {\n                              view: \"button\",\n                              type: \"icon\",\n                              icon: \"fa fa-plus\",\n                              label: L(\"Step\"),\n                              autowidth: true,\n                              css: \"webix_primary\",\n                              click: async () => {\n                                 // create an ABStep\n                                 let step = await this.createStep(id);\n                                 // save it to definitions to get id\n                                 await step.save();\n                                 // get the hint we are editing\n                                 let hint = this.AB.hints((h) => {\n                                    return h.id == id;\n                                 })[0];\n                                 // assign the new ABStep id to the ABHint\n                                 if (\n                                    hint?.stepIDs &&\n                                    Array.isArray(hint.stepIDs)\n                                 ) {\n                                    hint.stepIDs.push(step.id);\n                                 } else {\n                                    hint.stepIDs = [step.id];\n                                 }\n                                 // store the ABStep on the ABHint (not stored in defs)\n                                 hint._steps[step.id] = step;\n                                 // remove ui that shows when ABHint does not have steps\n                                 $$(\"hint_steps_\" + hint.id).removeView(\n                                    \"addStepBelow\"\n                                 );\n                                 // add the ui to edit the new step to the ui\n                                 $$(\"hint_steps_\" + hint.id).addView(\n                                    this.stepUI(step, hint)\n                                 );\n                              },\n                           },\n                           {},\n                        ],\n                     },\n                     {},\n                  ],\n               },\n            ],\n         };\n         // add to the ui now that we have it defined\n         $$(\"hint_steps_\" + id).addView(addStepBelow);\n      } else {\n         // if we do have steps\n         hint.stepIDs.forEach((step) => {\n            $$(\"hint_steps_\" + id).addView(\n               this.stepUI(hint._steps[step], hint)\n            );\n         });\n      }\n      // set up hover listeners for buttons that help user pick and show the highlight elements\n      const focusElements = document.querySelectorAll(\".focusElement\");\n      for (let i = 0; i < focusElements.length; i++) {\n         focusElements[i].addEventListener(\n            \"mouseover\",\n            this.addHighlightClass,\n            false\n         );\n         focusElements[i].addEventListener(\n            \"mouseout\",\n            this.removeHighlightClass,\n            false\n         );\n      }\n   }\n\n   // UI for each step that will be used to rebuild steps when moved/deleted/loaded\n   stepUI(step, hint) {\n      // the position of the step that we display in the top left corner of the ui\n      let position = $$(\"hint_steps_\" + hint.id).getChildViews().length + 1;\n      return {\n         view: \"form\",\n         id: \"step_form\" + step.id,\n         css: \"my\",\n         padding: 15,\n         borderless: true,\n         rows: [\n            {\n               borderless: true,\n               cols: [\n                  {\n                     width: 50,\n                     rows: [\n                        {\n                           view: \"label\",\n                           label: `<h1 class=\"stepPos\">${position}</h1>`,\n                           align: \"center\",\n                        },\n                        {\n                           view: \"icon\",\n                           class: \"moveStepUp\",\n                           icon: \"fa fa-caret-up\",\n                           disabled: position == 1 ? true : false, // do not allow moving up if already at the top position\n                           align: \"center\",\n                           click: (id, element) => {\n                              // move the step up a position\n                              this.moveStep(step, hint, \"up\");\n                           },\n                        },\n                        {\n                           view: \"icon\",\n                           class: \"moveStepDown\",\n                           icon: \"fa fa-caret-down\",\n                           disabled:\n                              hint.stepIDs.length == position ? true : false, // do not let the last item be moved down\n                           align: \"center\",\n                           click: (id, element) => {\n                              // move the step down a position\n                              this.moveStep(step, hint, \"down\");\n                           },\n                        },\n                     ],\n                  },\n                  {\n                     css: \"ab-component-form-rules\",\n                     padding: 15,\n                     cols: [\n                        {\n                           minWidth: 300,\n                           rows: [\n                              {\n                                 view: \"text\",\n                                 label: L(\"Title\"),\n                                 validate: webix.rules.isNotEmpty,\n                                 invalidMessage: L(\"Title is required\"),\n                                 labelWidth: 100,\n                                 name: \"name\",\n                                 value: step?.name || \"\",\n                              },\n                              {\n                                 view: \"textarea\",\n                                 label: L(\"Text\"),\n                                 labelAlign: \"left\",\n                                 labelWidth: 100,\n                                 height: 150,\n                                 name: \"text\",\n                                 value: step?.text || \"\",\n                              },\n                              {\n                                 cols: [\n                                    {\n                                       view: \"label\",\n                                       label: L(\"Highlight\"),\n                                       align: \"left\",\n                                       width: 100,\n                                    },\n                                    {\n                                       view: \"button\",\n                                       icon: \"fa fa-crosshairs\",\n                                       type: \"icon\",\n                                       label: L(\"select\"),\n                                       css: \"focusElement webix_primary\",\n                                       stepId: step.id,\n                                       width: 100,\n                                       click: () => {\n                                          // change the ui to support the selecting of the highlight element\n                                          $$(\"stepManager\" + hint.id).hide();\n                                          // adding this class will allow a css rule to highlight any element with data-cy attribute on hover\n                                          document.body.classList.add(\n                                             \"findDataCy\"\n                                          );\n                                          // when the user sees the element hovered can be a highlight element they right click to save it\n                                          document.addEventListener(\n                                             \"contextmenu\",\n                                             this.handleRightClick,\n                                             false\n                                          );\n                                          // store the step and hint ids to use in the handleRightClick() function\n                                          document.stepId = step.id;\n                                          document.hintId = hint.id;\n                                          // show a small window in bottom right hand corner that helps user know what to do\n                                          webix\n                                             .ui(this.focusWindow(hint.id))\n                                             .show();\n                                       },\n                                    },\n                                    {\n                                       view: \"text\",\n                                       name: \"el\",\n                                       value: step.settings.el,\n                                       disabled: true,\n                                       placeholder: L(\n                                          \"Click the 'select' button to pick an element to highlight.\"\n                                       ),\n                                       bottomLabel: L(\n                                          \"Hover over the 'select' button to highlight the chosen element.\"\n                                       ),\n                                       validate: webix.rules.isNotEmpty,\n                                       invalidMessage: L(\n                                          \"Please choose an item to highlight\"\n                                       ),\n                                    },\n                                 ],\n                              },\n                              {\n                                 cols: [\n                                    {\n                                       view: \"label\",\n                                       label: L(\"Event\"),\n                                       align: \"left\",\n                                       width: 100,\n                                    },\n                                    {\n                                       view: \"combo\",\n                                       value: step.settings.event,\n                                       name: \"event\",\n                                       options: [\n                                          {\n                                             id: \"click\",\n                                             value: L(\"Click\"),\n                                          },\n                                          {\n                                             id: \"enter\",\n                                             value: L(\"Enter\"),\n                                          },\n                                       ],\n                                    },\n                                 ],\n                              },\n                           ],\n                        },\n                     ],\n                  },\n                  {\n                     view: \"template\",\n                     borderless: true,\n                     template: `<div class=\"deleteStep\"><i class=\"fa fa-times\"></i></div>`,\n                     width: 15,\n                     onClick: {\n                        deleteStep: (ev, id) => {\n                           // ask user if they want to delete this step\n                           webix\n                              .confirm({\n                                 title: L(\"Delete Step\"),\n                                 text: L(\n                                    \"Are you sure you want to delete this step?\"\n                                 ),\n                                 type: \"confirm-error\",\n                              })\n                              .then(async (result) => {\n                                 // remove the step from the hint\n                                 hint.stepRemove(step.id);\n                                 await hint.save();\n                                 // rebuild the step ui now that one has been removed\n                                 this.updateStepsUI(hint.id);\n                                 return false; // blocks the default click behavior\n                              })\n                              .fail(() => {\n                                 // webix.message(\"Cancel\");\n                              });\n                           return false;\n                        },\n                     },\n                  },\n               ],\n            },\n         ],\n      };\n   }\n\n   // this function moves a step up or down a position\n   async moveStep(step, hint, direction) {\n      let currPosition = hint.stepIDs.indexOf(step.id);\n      switch (direction) {\n         case \"up\":\n            hint.stepIDs.splice(\n               currPosition - 1,\n               0,\n               hint.stepIDs.splice(currPosition, 1)[0]\n            );\n            break;\n         default:\n            hint.stepIDs.splice(\n               currPosition + 1,\n               0,\n               hint.stepIDs.splice(currPosition, 1)[0]\n            );\n      }\n      await hint.save();\n      this.updateStepsUI(hint.id);\n   }\n\n   // this builds the list of page/tab options that a hint can be added to\n   getViewOptions(views) {\n      // this so it looks right/indented in a tree view:\n      // var tree = new webix.TreeCollection();\n      var options = [];\n\n      /**\n       * @method addOption\n       *\n       * @param {ABView} page\n       * @param {uuid} parentId\n       * @param {number} depth\n       */\n      var addOption = (object, parentId, depth) => {\n         // add to tree collection\n         if ([\"page\", \"tab\", \"viewcontainer\"].indexOf(object.key) != -1) {\n            var indent = \"\";\n            for (let i = 0; i < depth; i++) {\n               indent += \"<i style='display:inline-block; width: 10px;'></i>\";\n            }\n            let icon =\n               object.icon == \"braille\" ? \"external-link-square\" : object.icon;\n            var option = {\n               id: object.id,\n               value: `${indent} <i class=\"fa fa-${icon}\"></i> ${object.label}`,\n            };\n            options.push(option);\n         }\n\n         var pages = object.pages ? object.pages() : [];\n         pages.forEach((page, pageIndex) => {\n            addOption(page, object.id, depth + 1);\n         });\n\n         var views = object.views();\n         views.forEach((view, pageIndex) => {\n            addOption(view, object.id, depth + 1);\n         });\n      };\n      views.forEach((p, index) => {\n         addOption(p, null, 0);\n      });\n\n      return options;\n   }\n\n   // This creates a new hint and stores it on the application and view we want to display it on\n   async createTutorial(viewID, viewLabel) {\n      let hint = this.AB.hintNew({\n         name: viewLabel,\n         settings: { view: viewID },\n      });\n      await hint.save();\n      if (Array.isArray(this?.application?.hintIDs)) {\n         this.application.hintIDs.unshift(hint.id);\n      } else {\n         this.application.hintIDs = [hint.id];\n      }\n      this.application.save();\n      let hintView = this.application.views((view) => {\n         return view.id == viewID;\n      })[0];\n      hintView.settings.hintID = hint.id;\n      hintView.save();\n      $$(\"tutorial_list\").add(hint, 0);\n      if (this.AB.hints().length) {\n         $$(\"tutorial_list\").show();\n         $$(\"tutorial_list_noSelection\").hide();\n      }\n   }\n\n   // create a new step on a hint\n   async createStep(hintID) {\n      let step = this.AB.stepNew(null, hintID);\n      return step;\n   }\n\n   // store the data-cy info on a step after right clicking an element on the page\n   handleRightClick(event) {\n      function getCy(element) {\n         if (element?.dataset?.cy) {\n            return element.dataset.cy;\n         } else if (element?.parentElement) {\n            return getCy(element.parentElement);\n         } else {\n            webix.alert({\n               text: L(\"Sorry, try another element.\"),\n            });\n            return \"\";\n         }\n      }\n\n      if (document?.stepId) {\n         event.preventDefault();\n         event.stopPropagation();\n         let dataCy = getCy(event.target);\n         if (!dataCy) return false;\n         $$(\"step_form\" + document.stepId).setValues(\n            {\n               el: \"[data-cy='\" + dataCy + \"']\",\n            },\n            true\n         );\n      }\n      $$(\"stepManager\" + document.hintId).show();\n      $$(\"focusWindow\").hide();\n\n      document.removeEventListener(\"contextmenu\", this.handleRightClick, false);\n      document.body.classList.remove(\"findDataCy\");\n      delete document.stepId;\n      delete document.hintId;\n\n      return false;\n   }\n\n   // handlePageTabClick(event) {\n   //    event.preventDefault();\n   //    event.stopPropagation();\n   //    debugger;\n   //    // $$(\"stepform\" + document?.hintId).setValues(\n   //    //    {\n   //    //       view: \"[data-cy='\" + dataCy + \"']\",\n   //    //    },\n   //    //    true\n   //    // );\n\n   //    $$(\"stepManager\" + document.hintId).show();\n   //    $$(\"pageTabWindow\").hide();\n\n   //    document.removeEventListener(\"click\", this.handlePageTabClick, false);\n   //    delete document.hintId;\n\n   //    return false;\n   // }\n}\n\nexport default new PortalTutorialManager();\n","import ClassUI from \"./ClassUI.js\";\nimport ClassUIPage from \"./ClassUIPage.js\";\n\nimport PortalWorkInbox from \"./portal_work_inbox.js\";\nimport PortalWorkInboxTaskWindow from \"./portal_work_inbox_taskWindow.js\";\nimport PortalWorkUserProfileWindow from \"./portal_work_user_profile_window.js\";\nimport PortalWorkUserSwitcheroo from \"./portal_work_user_switcheroo.js\";\nimport PortalWorkUserQRWindow from \"./portal_work_user_qr_window.js\";\nimport PortalWorkUserMobileQR from \"./portal_work_user_mobile_qr.js\";\nimport PortalAccessLevelManager from \"./portal_access_level_manager.js\";\nimport TranslationTool from \"./portal_translation_tool.js\";\nimport TutorialManager from \"./portal_tutorial_manager.js\";\n\nclass PortalWork extends ClassUI {\n   constructor() {\n      super();\n   }\n\n   ui() {\n      return {\n         id: \"portal_work\",\n         rows: [\n            {\n               id: \"portal_work_no_network_detected\",\n               height: 30,\n               css: \"portal_work_no_network_detected\",\n               hidden: true,\n               cols: [\n                  {\n                     width: 5,\n                  },\n                  {\n                     id: \"portal_work_no_network_detected_label\",\n                     view: \"label\",\n                     align: \"center\",\n                  },\n                  {\n                     width: 5,\n                  },\n               ],\n            },\n            {\n               id: \"portal_work_server_comunication_disabled_detected\",\n               height: 30,\n               css: \"portal_work_server_comunication_disabled_detected\",\n               hidden: true,\n               cols: [\n                  {\n                     width: 5,\n                  },\n                  {\n                     id: \"portal_work_server_comunication_disabled_detected_label\",\n                     view: \"label\",\n                     align: \"center\",\n                  },\n                  {\n                     id: \"portal_work_server_comunication_disabled_detected_queue\",\n                     view: \"button\",\n                     align: \"center\",\n                     hidden: true,\n                     width: 40,\n                     css: \"webix_transparent\",\n                     on: {\n                        onItemClick: () => {\n                           // test out network going offline:\n                           // this.AB.Network._testingHack = !this.AB.Network\n                           //    ._testingHack;\n                           this.AB.Network._connectionCheck();\n                        },\n                     },\n                  },\n                  {\n                     width: 5,\n                  },\n               ],\n            },\n            {\n               id: \"portal_work_switcheroo_user_switched\",\n               height: 30,\n               css: \"portal_work_switcheroo_user_switched\",\n               hidden: true,\n               cols: [\n                  {\n                     width: 5,\n                  },\n                  {\n                     id: \"portal_work_switcheroo_user_switched_label\",\n                     view: \"label\",\n                     align: \"center\",\n                  },\n                  {\n                     view: \"button\",\n                     value: '<div style=\"text-align: center; font-size: 12px; color:#FFFFFF\"><i class=\"fa-fw fa fa-times\"></i></div>',\n                     align: \"center\",\n                     width: 30,\n                     css: \"webix_transparent\",\n                     on: {\n                        onItemClick: () => {\n                           PortalWorkUserSwitcheroo.switcherooClear();\n                           $$(\"portal_work_switcheroo_user_switched\").hide();\n                        },\n                     },\n                  },\n                  {\n                     width: 5,\n                  },\n               ],\n            },\n            {\n               view: \"toolbar\",\n               id: \"mainToolbar\",\n               // borderless: true,\n               css: \"webix_dark mainToolbar\",\n               padding: 10,\n               cols: [\n                  {\n                     id: \"portal_work_menu_sidebar\",\n                     view: \"button\",\n                     type: \"icon\",\n                     width: 50,\n                     icon: \"fa fa-bars no-margin\",\n                     click: () => {\n                        let navSideBar = $$(\"navSidebar\");\n                        if (navSideBar.isVisible()) {\n                           navSideBar.hide();\n                        } else {\n                           navSideBar.show();\n                           let sidebarMenu = $$(\"abSidebarMenu\");\n                           if (sidebarMenu.getSelectedId() == \"\") {\n                              sidebarMenu.blockEvent();\n                              const firstID = sidebarMenu.getFirstId();\n                              sidebarMenu.select(firstID);\n                              sidebarMenu.unblockEvent();\n                           }\n                        }\n                     },\n                     on: {\n                        onAfterRender() {\n                           ClassUI.CYPRESS_REF(this);\n                        },\n                     },\n                  },\n                  {\n                     view: \"label\",\n                     autowidth: true,\n                     id: \"portal_work_menu_title\",\n                     label: \"AppBuilder\",\n                     align: \"left\",\n                     on: {\n                        onAfterRender() {\n                           ClassUI.CYPRESS_REF(this);\n                        },\n                     },\n                  },\n                  {},\n                  {\n                     id: \"portal_work_menu_pages\",\n                     css: \"appPages\",\n                     cols: [],\n                     on: {\n                        onAfterRender() {\n                           ClassUI.CYPRESS_REF(this);\n                        },\n                     },\n                  },\n                  {},\n                  {\n                     id: \"inbox_icon\",\n                     view: \"button\",\n                     type: \"icon\",\n                     icon: \"fa fa-envelope no-margin\",\n                     width: 40,\n                     // badge: 12,\n                     click: () => {\n                        PortalWorkInbox.show();\n                     },\n                     on: {\n                        onAfterRender() {\n                           ClassUI.CYPRESS_REF(this);\n                        },\n                     },\n                  },\n                  {\n                     id: \"settings_icon\",\n                     view: \"button\",\n                     type: \"icon\",\n                     icon: \"fa fa-cog fa-lg no-margin\",\n                     width: 40,\n                     hidden: true,\n                     popup: \"settingsMenu\",\n                     /* Look at this.refreshSettingsMenu() for menu options and actions */\n                     on: {\n                        onAfterRender() {\n                           ClassUI.CYPRESS_REF(this);\n                        },\n                     },\n                  },\n                  {\n                     id: \"user_icon\",\n                     view: \"button\",\n                     type: \"icon\",\n                     icon: \"fa fa-user-circle no-margin\",\n                     width: 40,\n                     popup: \"userMenu\",\n                     /* Look at Popup created below for menu options and actions */\n                     on: {\n                        onAfterRender() {\n                           ClassUI.CYPRESS_REF(this);\n                        },\n                     },\n                  },\n               ],\n            },\n            {\n               cols: [\n                  {\n                     id: \"navSidebar\",\n                     hidden: true,\n                     autoheight: true,\n                     borderless: true,\n                     rows: [\n                        {\n                           id: \"abNavSidebarScrollView\",\n                           view: \"scrollview\",\n                           scroll: \"y\",\n                           css: \"darkScrollview\",\n                           body: {\n                              rows: [\n                                 {\n                                    view: \"sidebar\",\n                                    id: \"abSidebarMenu\",\n                                    borderless: true,\n                                    css: \"webix_dark mainSidebar\",\n                                    data: [],\n                                    on: {\n                                       onAfterRender() {\n                                          this.data.each((a) => {\n                                             ClassUI.CYPRESS_REF(\n                                                this.getItemNode(a.id),\n                                                a.id\n                                             );\n                                          });\n                                       },\n                                       onAfterSelect: (/* id */) => {\n                                          // this.selectApplication(id);\n                                       },\n                                       onItemClick: (id) => {\n                                          this.selectApplication(id);\n                                       },\n                                    },\n                                 },\n                              ],\n                           },\n                        },\n                        {\n                           view: \"template\",\n                           borderless: true,\n                           css: \"appDevDesigns\",\n                           height: 110,\n                        },\n                     ],\n                  },\n                  {\n                     id: \"abWorkPages\",\n                     template: \"No Applications Have Been Loaded.\",\n                  }, // this is where content goes\n               ],\n            },\n         ],\n      };\n   }\n\n   async init(AB) {\n      this.AB = AB;\n\n      this.storageKey = \"portal_work_state\";\n\n      this.pageContainers = {};\n\n      const L = (...params) => {\n         return this.label(...params);\n      };\n\n      const allInits = [];\n\n      allInits.push(PortalWorkUserProfileWindow.init(this.AB));\n      allInits.push(PortalWorkUserSwitcheroo.init(this.AB));\n\n      // {hash}  { ABViewPage.id : ClassUIPage() }\n      // track each of the page containers (instances of ClassUIPage) that\n      // are responsible for displaying the proper state of each of our\n      // Root Pages.\n\n      // Get all our ABApplications and loaded Plugins in allApplications\n      const allApplications = (\n         this.AB.applications(\n            (a) =>\n               a.isWebApp &&\n               a.isAccessibleForRoles(this.AB.Account.rolesAll() ?? [])\n         ) || []\n      ).concat(this.AB.plugins() || []);\n\n      // Build out our Navigation Side Bar Menu with our available\n      // ABApplications\n      const menu_data = [];\n\n      for (let i = 0; i < allApplications.length; i++) {\n         // TODO: implement Sorting on these before building UI\n         menu_data.push(this.uiSideBarMenuEntry(allApplications[i]));\n      }\n\n      $$(\"abSidebarMenu\").define(\"data\", menu_data);\n      this.sidebarResize();\n\n      PortalWorkUserMobileQR.init(AB);\n\n      const userMenuOptions = [\n         { id: \"user_profile\", label: L(\"User Profile\"), icon: \"user\" },\n         { id: \"user_logout\", label: L(\"Logout\"), icon: \"ban\" },\n      ];\n\n      // add in any Mobile App QR Codes:\n      const allMobile = this.AB.applications((a) => a.isMobile);\n      allMobile.forEach((m) => {\n         userMenuOptions.splice(1, 0, {\n            id: m.id, // \"pwa_app\",\n            label: m.label,\n            icon: m.icon.replace(\"fa-\", \"\"),\n         });\n      });\n\n      if (this.AB.Account.canSwitcheroo()) {\n         userMenuOptions.splice(1, 0, {\n            id: \"user_switcheroo\",\n            label: L(\"Switcheroo\"),\n            icon: \"user-secret\",\n         });\n      }\n\n      if (this.AB.Account.isSwitcherood()) {\n         $$(\"portal_work_switcheroo_user_switched_label\").setValue(\n            `<i class=\"fa-fw fa fa-user-secret\"></i> \n            ${L('You are viewing this site as \"{0}\"', [\n               this.AB.Account.username(),\n            ])}`\n         );\n         $$(\"portal_work_switcheroo_user_switched\").show();\n      }\n\n      $$(\"portal_work_no_network_detected_label\").setValue(\n         `<i class=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i> \n            ${L(\"No network detected. Work will not be saved.\")}`\n      );\n\n      const $portalWorkNoNetworkDetected = $$(\n         \"portal_work_no_network_detected\"\n      );\n\n      if (!navigator.onLine) $portalWorkNoNetworkDetected.show();\n\n      window.addEventListener(\"offline\", () => {\n         $portalWorkNoNetworkDetected.show();\n      });\n\n      window.addEventListener(\"online\", () => {\n         $portalWorkNoNetworkDetected.hide();\n      });\n\n      $$(\"portal_work_server_comunication_disabled_detected_label\").setValue(\n         `<i class=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i> \n            ${L(\n               \"Uh oh...we cannot communicate with our servers, please wait before saving data.\"\n            )}`\n      );\n\n      // document.body.addEventListener(\n      //    \"offline\",\n      //    function () {\n      //       debugger;\n      //       $$(\"portal_work_no_network_detected\").show();\n      //    },\n      //    false\n      // );\n      // document.body.addEventListener(\n      //    \"online\",\n      //    function () {\n      //       debugger;\n      //       $$(\"portal_work_no_network_detected\").hide();\n      //    },\n      //    false\n      // );\n\n      // Only add the QR Code option if the relay service is enabled\n      const { relay } = this.AB.Config.siteConfig();\n\n      if (relay) {\n         // Insert at userMenuOptions[2] so logout is still last\n         userMenuOptions.splice(2, 0, {\n            id: \"user_qr\",\n            label: L(\"Connect Mobile App\"),\n            icon: \"qrcode\",\n         });\n      }\n\n      // This is the User popup menu that opens when you click the user icon in the main nav\n      webix.ui({\n         view: \"popup\",\n         id: \"userMenu\",\n         width: 150,\n         body: {\n            view: \"list\",\n            data: userMenuOptions,\n            template: \"<i class='fa-fw fa fa-#icon#'></i> #label#\",\n            autoheight: true,\n            select: true,\n            on: {\n               onItemClick: (id) => {\n                  switch (id) {\n                     case \"user_profile\":\n                        PortalWorkUserProfileWindow.show();\n                        break;\n                     case \"user_switcheroo\":\n                        PortalWorkUserSwitcheroo.show();\n                        break;\n                     case \"user_logout\":\n                        AB.Account.logout();\n                        break;\n                     case \"user_qr\":\n                        PortalWorkUserQRWindow.init(AB);\n                        PortalWorkUserQRWindow.show();\n                        break;\n                     default:\n                        // was this one of our Mobile Apps?\n                        const mobileApp = this.AB.applicationByID(id);\n                        if (mobileApp) {\n                           PortalWorkUserMobileQR.load(mobileApp);\n                           PortalWorkUserMobileQR.show();\n                        } else {\n                           //eslint-disable-next-line\n                           const item = userMenuOptions.filter(\n                              (o) => o.id == id\n                           )[0];\n                           webix.message(\n                              `<b>Not yet implemented</b><br/>\n                           Menu item:<i>${item.label}</i><br/>\n                           Menu ID:<i>${item.id}</i>`\n                           );\n                        }\n                  }\n                  $$(\"userMenu\").hide();\n               },\n\n               onAfterRender() {\n                  this.data.each((a) => {\n                     ClassUI.CYPRESS_REF(this.getItemNode(a.id), a.id);\n                  });\n               },\n            },\n         },\n      });\n\n      // Now Fill out Toolbar and Root Pages:\n      //\n      // Step 1: prepare the AppState so we can determine which options\n      // should be pre selected.\n      //\n      const AppState = (await this.AB.Storage.get(this.storageKey)) ?? {\n         lastSelectedApp: null,\n         // {string}  the ABApplication.id of the last App selected\n\n         lastPages: {},\n         // {hash}  { ABApplication.id : ABPage.id }\n         // a lookup of all the last selected Pages for each Application\n      };\n\n      this.AppState = AppState;\n\n      // set default selected App if not already set\n      // just choose the 1st App in the list (must have pages that we have\n      // access to)\n      if (!this.AppState.lastSelectedApp && menu_data.length)\n         for (let i = 0; i < menu_data.length; i++)\n            if (\n               (\n                  menu_data[i].abApplication\n                     .pages()\n                     .filter((p) => p.getUserAccess?.() > 0) || []\n               ).length > 0\n            ) {\n               this.AppState.lastSelectedApp = menu_data[i].abApplication.id;\n\n               break;\n            }\n\n      //\n      // Step 2: figure out the Default Page to be displayed.\n      //\n      let DefaultPage = null;\n      // {ABViewPage}\n      // The ABViewPage of the 1st page to display.\n\n      // sidebar and NavBar are already built at this point. So we can\n      // query them.\n      const $sideBar = $$(\"abSidebarMenu\");\n\n      if ($sideBar) {\n         // search the Menu entries to see which one matches our\n         // stored AppState\n         let foundMenuEntry = this.sidebarMenuEntryByID(\n            this.AppState.lastSelectedApp\n         );\n\n         if (!foundMenuEntry) {\n            // if we couldn't find the entry then our .lastSelectedApp\n            // must be referencing an Application we no longer have\n            // access to.\n            // So just pick the 1st app with pages\n            for (let i = 0; i < menu_data.length; i++) {\n               if ((menu_data[i].abApplication.pages() || []).length > 0) {\n                  foundMenuEntry =\n                     this.sidebarMenuEntryByID(menu_data[i].abApplication.id) ||\n                     null;\n\n                  if (foundMenuEntry) break;\n               }\n            }\n         }\n\n         if (foundMenuEntry) {\n            $sideBar.select(foundMenuEntry.id);\n            this.selectApplication(foundMenuEntry.id);\n\n            const defaultPageID =\n               this.AppState.lastPages[foundMenuEntry.abApplication.id];\n\n            DefaultPage = foundMenuEntry.abApplication.pages(\n               (p) => p.id === defaultPageID\n            )[0];\n\n            if (!DefaultPage) {\n               // then just pick the first one:\n               DefaultPage = foundMenuEntry.abApplication.pages()[0];\n            }\n         }\n      }\n\n      //\n      // Step 3: Prime the content area with placeholders for ALL\n      // Root Pages\n      //\n      const allPlaceholders = [];\n\n      for (let i = 0; i < allApplications.length; i++) {\n         const pages = allApplications[i].pages() || [];\n\n         for (let j = 0; j < pages.length; j++) {\n            if (pages[j].getUserAccess?.() === 0) continue;\n\n            allPlaceholders.push({\n               id: this.pageID(pages[j]),\n               template: `Page: ${pages[j].label || pages[j].name}`,\n            });\n         }\n      }\n\n      if (allPlaceholders.length > 0)\n         webix.ui(\n            {\n               view: \"multiview\",\n               keepViews: true,\n               animate: false,\n               cells: allPlaceholders,\n            },\n            $$(\"abWorkPages\")\n         );\n\n      //\n      // Step 4: initialize the DefaultPage\n      // when it is finished we can show that page and emit \"ready\" to\n      // signal we can transition to the Work Portal\n      //\n      if (!this.App) {\n         // page.component() require a common {ABComponent.App}\n         this.App = new this.AB.Class.ABComponent(\n            null,\n            \"portal_work\",\n            this.AB\n         ).App;\n      }\n\n      if (DefaultPage) {\n         const container = new ClassUIPage(\n            this.pageID(DefaultPage),\n            DefaultPage,\n            this.App,\n            this.AB\n         );\n         const containerInit = async () => {\n            await container.init(this.AB, true);\n            this.showPage(DefaultPage);\n         };\n\n         this.pageContainers[DefaultPage.id] = container;\n         allInits.push(containerInit());\n      }\n      // let pUI = DefaultPage.component(this.App);\n\n      // webix.ui(pUI.ui, $$(this.pageID(DefaultPage)));\n      // pUI.init();\n      // pUI.onShow();\n      // this.showPage(DefaultPage);\n\n      //\n      // Step 5: initialize the remaining Pages\n      //\n      for (let i = 0; i < allApplications.length; i++) {\n         const pages = allApplications[i].pages() || [];\n\n         for (let j = 0; j < pages.length; j++) {\n            if (pages[j].getUserAccess?.() === 0) continue;\n\n            if (!DefaultPage || pages[j].id !== DefaultPage.id) {\n               const cont = new ClassUIPage(\n                  this.pageID(pages[j]),\n                  pages[j],\n                  this.App,\n                  this.AB\n               );\n\n               this.pageContainers[pages[j].id] = cont;\n\n               allInits.push(cont.init(this.AB));\n\n               // let comp = page.component(commonComp.App);\n               // webix.ui(comp.ui, $$(this.pageID(page)));\n               // comp.init();\n               // comp.onShow();\n            }\n         }\n      }\n\n      this.refreshSettingsMenu();\n      //\n      // Step 6: Initialize the Inbox Items\n      //\n      PortalWorkInbox.on(\"updated\", () => {\n         const count = PortalWorkInbox.count();\n         $$(\"inbox_icon\").define({ badge: count ? count : false });\n         $$(\"inbox_icon\").refresh();\n      });\n\n      await PortalWorkInbox.init(this.AB);\n\n      //\n      // Step 7: As well as the Inbox Task Window\n      //\n      allInits.push(PortalWorkInboxTaskWindow.init(this.AB));\n\n      // Network and Queued operations Alert\n      const $portalWorkServerComunicationDisabledDetected = $$(\n         \"portal_work_server_comunication_disabled_detected\"\n      );\n      const $portalWorkServerComunicationDisabledDetectedQueue = $$(\n         \"portal_work_server_comunication_disabled_detected_queue\"\n      );\n\n      this.AB.Network.on(\"queued\", () => {\n         const count = this.AB.Network.queueCount();\n         if (count > 0) {\n            $portalWorkServerComunicationDisabledDetectedQueue.show();\n            $portalWorkServerComunicationDisabledDetectedQueue.setValue(\n               `<div style=\"text-align: center; font-size: 12px; color:#FFFFFF\">(${count})</div>`\n            );\n            $portalWorkServerComunicationDisabledDetected.show();\n         } else {\n            $portalWorkServerComunicationDisabledDetectedQueue.hide();\n            $portalWorkServerComunicationDisabledDetected.hide();\n         }\n      });\n      this.AB.Network.on(\"queue.synced\", () => {\n         $portalWorkServerComunicationDisabledDetectedQueue.setValue(\"\");\n         $portalWorkServerComunicationDisabledDetectedQueue.hide();\n         $portalWorkServerComunicationDisabledDetected.hide();\n      });\n\n      this.emit(\"ready\");\n\n      // !!! HACK: Leave this for James to figure out why Menu Title isn't proper\n      // size on initial loading.\n      setTimeout(() => {\n         $$(\"portal_work_menu_title\").resize();\n      }, 200);\n\n      // Now attempt to flush any pending network operations:\n      this.AB.Network._connectionCheck();\n\n      // Be sure our UI elements that don't respond to onAfterRender()\n      // have their cypress references set:\n      [\"portal_work_menu_pages\"].forEach((eid) => {\n         ClassUI.CYPRESS_REF($$(eid));\n      });\n\n      await Promise.all(allInits);\n   }\n\n   /**\n    * pageID()\n    * return a commone webix.id for a given ABViewPage\n    * @param {ABViewPage || string} page\n    *       An instance of ABViewPage, OR a string of the ABViewPage.id\n    * @return {string}\n    */\n   pageID(page) {\n      return `page_${page.id || page}`;\n   }\n\n   selectApplication(id) {\n      const row = $$(\"abSidebarMenu\").getItem(id);\n\n      const pageButtons = [];\n      // {array}\n      // the webix menu buttons for each Page\n\n      let firstPage = true;\n      // {bool} firstPage\n      // should we choose the 1st page as being the active page?\n\n      let activePageID = null;\n      // {string}\n      // The ABViewPage.id of the active Page for the current Application.\n      if (this.AppState.lastSelectedApp != row.abApplication.id) {\n         // remember the current Application has been selected\n         this.AppState.lastSelectedApp = row.abApplication.id;\n         this.saveState();\n         // Need to Settings Menu if different for each app\n         this.refreshSettingsMenu();\n      }\n\n      // if the current Application already has an Active State Page marked\n      // we don't want the first page:\n      activePageID = this.AppState.lastPages[row.abApplication.id];\n      if (activePageID) {\n         firstPage = false;\n      }\n\n      // Build a Menu Button for each of the ABApplication Root Pages\n      (row.abApplication.pages() || []).forEach((p) => {\n         if (p.getUserAccess?.() == 0) return;\n         // Decide if current Page button should look selected.\n         let active = \"\";\n         if (firstPage || p.id == activePageID) {\n            active = \"activePage\";\n            firstPage = false;\n\n            // remember this one\n            this.AppState.lastPages[row.abApplication.id] = p.id;\n         }\n\n         let pbLabel = p.label;\n         if (\"function\" === typeof p.label) {\n            pbLabel = p.label();\n         }\n         pageButtons.push({\n            view: \"button\",\n            css: active,\n            type: \"icon\",\n            label: pbLabel,\n            autowidth: true,\n            icon: `fa fa-${p.icon}`,\n            abPage: p,\n            click: (item) => {\n               // when button is clicked, update the selected look\n               const pageButton = $$(item);\n\n               // Remove any other \"activePage\" entries\n               $$(\"portal_work_menu_pages\")\n                  .queryView(\n                     {\n                        css: \"activePage\",\n                     },\n                     \"all\"\n                  )\n                  .forEach((p) => {\n                     if (p != pageButton) {\n                        p.define(\"css\", \"\");\n                        p.$view.classList.remove(\"activePage\");\n                     }\n                  });\n\n               // make sure this one is marked\n               pageButton.define(\"css\", \"activePage\");\n               pageButton.$view.classList.add(\"activePage\");\n\n               // now trigger the page to display:\n               this.showPage(pageButton.data.abPage);\n            },\n            on: {\n               onAfterRender() {\n                  ClassUI.CYPRESS_REF(this, p.id);\n               },\n            },\n         });\n      });\n      webix.ui(pageButtons, $$(\"portal_work_menu_pages\"));\n\n      $$(\"portal_work_menu_title\").setValue(row.value);\n      $$(\"portal_work_menu_title\").resize();\n\n      // now everything is displayed\n      // default initial display to current activePage:\n      let selectedPage = null;\n      $$(\"portal_work_menu_pages\")\n         .queryView(\n            {\n               css: \"activePage\",\n            },\n            \"all\"\n         )\n         .forEach((p) => {\n            selectedPage = p;\n         });\n      this.showPage(selectedPage?.data?.abPage);\n\n      // hide the sidebar menu\n      const sideBar = $$(\"navSidebar\");\n      if (sideBar.isVisible()) {\n         sideBar.hide();\n      }\n   }\n\n   /**\n    * saveState()\n    * trigger a save of our current AppState.\n    * NOTE: we delay this so we can catch multiple saves in a short period\n    * of time.\n    */\n   saveState() {\n      if (this._saveTimeoutID) {\n         clearTimeout(this._saveTimeoutID);\n      }\n      this._saveTimeoutID = setTimeout(() => {\n         this.AB.Storage.set(this.storageKey, this.AppState);\n      }, 500);\n   }\n\n   show() {\n      $$(\"portal_work\").show();\n   }\n\n   showPage(page) {\n      // this could be a subpage\n      const pageUI = this.pageContainers[page?.id];\n\n      if (pageUI) {\n         pageUI.show();\n         this.AppState.lastPages[page.application.id] = page.id;\n         this.saveState();\n      }\n   }\n\n   /**\n    * @method sidebarMenuEntryByID()\n    * returns the sidebar menu entry that matches the given {menuID}\n    * @param {string|uuid} menuID\n    * @return {obj}\n    */\n   sidebarMenuEntryByID(menuID) {\n      const $sideBar = $$(\"abSidebarMenu\");\n\n      let foundMenuEntry = null;\n\n      if ($sideBar) {\n         // search the Menu entries to see which one matches our\n         // stored AppState\n\n         let id = $sideBar.getFirstId();\n         while (!foundMenuEntry && id) {\n            let entry = $sideBar.getItem(id);\n            if (entry.abApplication.id == menuID) {\n               foundMenuEntry = entry;\n            }\n            id = $sideBar.getNextId(id);\n         }\n      }\n\n      return foundMenuEntry;\n   }\n\n   sidebarResize() {\n      const sidebarMenu = $$(\"abSidebarMenu\");\n      const sideBarHeight = sidebarMenu.count() * 45 + 1;\n\n      sidebarMenu.define(\"height\", sideBarHeight);\n      sidebarMenu.resize();\n      // $$(\"abNavSidebarScrollView\").resize(true);\n   }\n\n   /**\n    * generate the Webix definition for a menu entry given the ABApplication\n    * the menu entry should represent.\n    * @param {ABApplication} app\n    * @return {obj} Webix.ui definition.\n    */\n   uiSideBarMenuEntry(app) {\n      return {\n         id: app.id,\n         icon: `fa ${app.icon}`,\n         value: app.label || app.name,\n         abApplication: app,\n         // This is never called:\n         // on: {\n         //    onAfterRender() {\n         //       debugger;\n         //       ClassUI.CYPRESS_REF(this, app.id);\n         //    },\n         // },\n      };\n   }\n\n   refreshSettingsMenu() {\n      const { uuid, roles } = this.AB.Config.userConfig();\n      const application = this.AB.applicationByID(\n         this.AppState.lastSelectedApp\n      );\n      const settingsMenuOptions = [];\n\n      if (!application) return $$(\"settings_icon\").hide();\n      if (application.isAccessManaged) {\n         let isManager = false;\n         if (\n            application.accessManagers.useAccount == \"1\" &&\n            application.accessManagers.account.indexOf(uuid) > -1\n         ) {\n            isManager = true;\n         }\n         if (!isManager && application.accessManagers.useRole == \"1\") {\n            roles.forEach((role) => {\n               if (application.accessManagers.role.indexOf(role.uuid) > -1) {\n                  isManager = true;\n               }\n            });\n         }\n         if (isManager) {\n            settingsMenuOptions.push({\n               id: \"accessLevel\",\n               label: this.label(\"Access Manager\"),\n               icon: \"lock\",\n            });\n         }\n      }\n      if (application.isTranslationManaged) {\n         let isManager = false;\n         if (\n            application.translationManagers.useAccount == \"1\" &&\n            application.translationManagers.account.indexOf(uuid) > -1\n         ) {\n            isManager = true;\n         }\n         if (!isManager && application.translationManagers.useRole == \"1\") {\n            roles.forEach((role) => {\n               if (\n                  application.translationManagers.role.indexOf(role.uuid) > -1\n               ) {\n                  isManager = true;\n               }\n            });\n         }\n         if (isManager) {\n            settingsMenuOptions.push({\n               id: \"translation\",\n               label: this.label(\"Translation Tool\"),\n               icon: \"language\",\n            });\n         }\n      }\n      if (application.isTutorialManaged) {\n         let isManager = false;\n         if (\n            application.tutorialManagers.useAccount == \"1\" &&\n            application.tutorialManagers.account.indexOf(uuid) > -1\n         ) {\n            isManager = true;\n         }\n         if (!isManager && application.tutorialManagers.useRole == \"1\") {\n            roles.forEach((role) => {\n               if (application.tutorialManagers.role.indexOf(role.uuid) > -1) {\n                  isManager = true;\n               }\n            });\n         }\n         if (isManager) {\n            settingsMenuOptions.push({\n               id: \"tutorial\",\n               label: this.label(\"Tutorial Manager\"),\n               icon: \"info-circle\",\n            });\n         }\n      }\n\n      if (settingsMenuOptions.length < 1) return $$(\"settings_icon\").hide();\n\n      $$(\"settings_icon\").show();\n\n      webix.ui({\n         view: \"popup\",\n         id: \"settingsMenu\",\n         width: 150,\n         body: {\n            view: \"list\",\n            data: settingsMenuOptions,\n            template: \"<i class='fa-fw fa fa-#icon#'></i> #label#\",\n            autoheight: true,\n            select: true,\n            on: {\n               onItemClick: (id /*, event */) => {\n                  switch (id) {\n                     case \"accessLevel\":\n                        PortalAccessLevelManager.init(this);\n                        PortalAccessLevelManager.show();\n                        break;\n                     case \"translation\":\n                        TranslationTool.init(this);\n                        TranslationTool.show();\n                        break;\n                     case \"tutorial\":\n                        TutorialManager.init(this);\n                        TutorialManager.show();\n                        break;\n                     default:\n                        //eslint-disable-next-line\n                        const item = settingsMenuOptions.filter(\n                           (o) => o.id == id\n                        )[0];\n                        webix.message(\n                           `<b>Not yet implemented</b><br/>\n                           Menu item:<i>${item.label}</i><br/>\n                           Menu ID:<i>${item.id}</i>`\n                        );\n                  }\n                  $$(\"settingsMenu\").hide();\n               },\n\n               onAfterRender() {\n                  this.data.each((a) => {\n                     ClassUI.CYPRESS_REF(this.getItemNode(a.id), a.id);\n                  });\n               },\n            },\n         },\n      });\n   }\n}\n\nexport default new PortalWork();\n","import ClassUI from \"./ClassUI.js\";\nimport PortalLoading from \"./portal_loading.js\";\nimport PortalAuth from \"./portal_auth.js\";\nimport PortalWork from \"./portal_work.js\";\n\nclass Portal extends ClassUI {\n   constructor() {\n      super();\n\n      this.ShownPortal = null;\n      // {UI.Portal} ShownPortal\n      // Keep track of which Portal is currently shown.\n\n      this.portalWorkReady = false;\n      // {bool}\n      // has the PortalWork UI emitted it's \"ready\" event?\n      //\n   }\n\n   ui() {\n      return {\n         view: \"popup\",\n         fullscreen: true,\n         modal: true,\n         body: {\n            id: \"portal\",\n            view: \"multiview\",\n            keepViews: true,\n            animate: false,\n            rows: [PortalLoading.ui(), PortalAuth.ui(), PortalWork.ui()],\n         },\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n\n      this.AB.on(\"portal.show\", (key) => {\n         this.showPortal(key);\n      });\n\n      var allInits = [];\n      // {array} allInits\n      // all the .init() {Promise}s that are being generated during our\n      // init().\n\n      allInits.push(PortalAuth.init(AB));\n\n      // if we are authenticated, then we make sure our loading & work portals\n      // are prepared.\n      if (this.AB.Account.isAuthenticated) {\n         // Setup our listeners BEFORE the .init()s\n         this.AB.Account.on(\"logout\", (data) => {\n            if (data?.redirect) {\n               // if we pass a redirect link follow it\n               window.document.location.href = data?.redirect;\n            } else {\n               // on logout show Auth Portal\n               this.showAuthPortal();\n            }\n         });\n\n         this.AB.Network.on(\"reauth\", () => {\n            // on logout show Auth Portal\n            this.showAuthPortal();\n         });\n\n         PortalWork.on(\"ready\", () => {\n            this.portalWorkReady = true;\n            this.showDefaultView();\n         });\n\n         // Now trigger our other .init()s\n         allInits.push(PortalLoading.init(AB));\n         allInits.push(PortalWork.init(AB));\n      }\n\n      return Promise.all(allInits).then(() => {\n         this.showDefaultView();\n      });\n   }\n\n   showAuthPortal(defaultView) {\n      if (this.ShownPortal != PortalAuth) {\n         PortalAuth.show(defaultView);\n         this.ShownPortal = PortalAuth;\n      }\n   }\n\n   showWorkPortal() {\n      if (this.portalWorkReady) {\n         if (this.ShownPortal != PortalWork) {\n            // when loading portal is done move to Work Portal\n            PortalWork.show();\n            this.ShownPortal = PortalWork;\n         }\n      } else {\n         if (!this.ShownPortal) {\n            // if we haven't already shown a portal ... show the loading\n            PortalLoading.show();\n         }\n      }\n   }\n\n   showDefaultView() {\n      // At this point, all inits() are complete\n\n      // if authenticated then show our default view:\n      if (this.AB.Account.isAuthenticated) {\n         // do we have a specified defaultView?\n         let defaultView = this.AB.Config.setting(\"view\");\n         if (defaultView) {\n            // defaultView should be in form:\n            //    \"auth_login_form\",\n            //    \"auth_login_passwordReset\",\n            //    \"work\"\n            var parts = defaultView.split(\"_\");\n            this.showPortal(parts[0], defaultView);\n         } else {\n            // then default to our work view:\n            if (this.portalWorkReady) {\n               this.showWorkPortal();\n            } else {\n               if (!this.ShownPortal) {\n                  // if we haven't already shown a portal ... show the loading\n                  PortalLoading.show();\n               }\n            }\n         }\n      } else {\n         this.showAuthPortal();\n      }\n   }\n\n   showPortal(key, defaultView) {\n      switch (key) {\n         case \"auth\":\n            this.showAuthPortal(defaultView);\n            break;\n\n         case \"work\":\n            this.showWorkPortal();\n            break;\n      }\n   }\n}\n\nexport default new Portal();\n","import ClassUI from \"./ClassUI.js\";\nimport Portal from \"./portal.js\";\n\nclass UI extends ClassUI {\n   constructor() {\n      super();\n\n      this.hiddenElements = [];\n   }\n\n   ui() {\n      return {\n         id: \"labelClickToEnter\",\n         view: \"label\",\n         label: \"Hello\",\n         on: {\n            onItemClick: (/* id, e */) => {\n               this.portalShow();\n            },\n         },\n      };\n   }\n\n   init(AB) {\n      this.AB = AB;\n      var entryLabel = this.AB.Tenant.textClickToEnter;\n      if (entryLabel) {\n         $$(\"labelClickToEnter\").define({\n            label: entryLabel,\n         });\n      }\n\n      // by not sending an id param, this creates it's own div.\n      this.popup = Portal.attach();\n\n      // AB.on(\"error\", (error) => {\n      //    console.error(\"ui.on(error): \", error);\n      // });\n\n      return Portal.init(AB).then(() => {\n         if (this.AB.Config.setting(\"autoenter\")) {\n            this.portalShow();\n         } else {\n            this.portalHide();\n         }\n      });\n   }\n\n   portalHide() {\n      // show our link to enter\n      this.popup.hide();\n   }\n\n   portalShow() {\n      // show our portal\n      this.popup.show();\n   }\n}\n\nexport default new UI();\n","import ClassUI from \"./ClassUI.js\";\n\nimport Switcheroo from \"./portal_work_user_switcheroo.js\";\n\nclass ErrorNoDefsUI extends ClassUI {\n   ui() {\n      const L = (...params) => {\n         return this.label(...params);\n      };\n      return {\n         rows: [\n            {\n               id: \"switched\",\n               height: 23,\n               css: \"portal_work_switcheroo_user_switched\",\n               hidden: true,\n               cols: [\n                  {\n                     width: 5,\n                  },\n                  {\n                     id: \"switched_label\",\n                     view: \"label\",\n                     align: \"center\",\n                  },\n                  {\n                     view: \"button\",\n                     value: '<div style=\"text-align: center; font-size: 12px; color:#FFFFFF\"><i class=\"fa-fw fa fa-times\"></i></div>',\n                     align: \"center\",\n                     width: 30,\n                     css: \"webix_transparent\",\n                     on: {\n                        onItemClick: () => {\n                           Switcheroo.init(this.AB, true);\n                           Switcheroo.switcherooClear();\n                           $$(\"switched\").hide();\n                        },\n                     },\n                  },\n                  {\n                     width: 5,\n                  },\n               ],\n            },\n            {\n               id: \"error_no_defs\",\n               css: \"portalLogin\",\n               cols: [\n                  {},\n                  {\n                     rows: [\n                        {},\n                        {\n                           width: 360,\n                           height: 200,\n                           rows: [\n                              {\n                                 css: \"portalLoginForm\",\n                                 padding: 30,\n                                 rows: [\n                                    {\n                                       id: \"error_no_defs_text\",\n                                       template: `<div style='text-align: center; font-size:14px;'>\n                                       ${L(\n                                          \"You don't have any Roles in the system defined.  Talk to an Administrator.\"\n                                       )}\n                                    </div>`,\n                                       borderless: true,\n                                    },\n                                 ],\n                              },\n                           ],\n                        },\n                        {},\n                     ],\n                  },\n                  {},\n               ],\n            },\n         ],\n      };\n   }\n\n   async init(AB) {\n      this.AB = AB;\n   }\n\n   switcherooUser(user) {\n      const L = (...params) => {\n         return this.label(...params);\n      };\n      $$(\"switched\").show();\n      $$(\"switched_label\").setValue(\n         L('*You are viewing this site as \"{0}\"*', [this.AB.Account.username()])\n      );\n   }\n\n   preloadMessage(text) {\n      $$(\"error_no_defs_text\").setValues({ text });\n   }\n   destroy() {\n      $$(\"error_no_defs\").destructor();\n   }\n}\n\nexport default new ErrorNoDefsUI();\n","/*\n * Bootstrap.js\n * This file drives the setup and preparation of the Web Platform.\n * It's main job is to prepare all the local Resources for operation as\n * well the main ABFactory object that will drive the rest of the applications.\n */\n\nimport events from \"events\";\n\nconst EventEmitter = events.EventEmitter;\n\nimport Config from \"../config/Config.js\";\n\nimport initConfig from \"../init/initConfig.js\";\nimport initConnectListerner from \"../init/initConnectListerner.js\";\nimport initDiv from \"../init/initDiv.js\";\nimport initDefinitions from \"../init/initDefinitions.js\";\n\n// import JSZipUtils from \"jszip-utils/dist/jszip-utils.min.js\";\n\nimport Selectivity from \"../js/selectivity/selectivity.min.js\";\nimport selectivityCSS from \"../js/selectivity/selectivity.min.css\";\n\nimport UI from \"../ui/ui.js\";\nimport ErrorNoDefsUI from \"../ui/error_noDefs.js\";\n\nimport performance from \"../utils/performance.js\";\n\nclass Bootstrap extends EventEmitter {\n   constructor(definitions) {\n      super();\n      this.setMaxListeners(0);\n\n      // Common Reference to Configuration Values\n      this.Config = Config;\n\n      //\n      // UI Related\n      //\n\n      this._div = null;\n      // {el} _div\n      // the HTML element that is the where our initial [click] here button\n      // should be displayed.  Our actual portal is a popup, but the base\n      // <div> can be used for an embedded view.\n\n      this._plugins = [];\n      // {array} ._plugins\n      // an array of the loaded plugins we need to register.\n\n      this._ui = null;\n      // {obj} ._ui\n      // the Webix Object that is our UI display\n\n      this.on(\"error\", (err) => {\n         performance.error(err);\n      });\n   }\n\n   async init(ab) {\n      // We rerun init after a sucessful login, at that point we already have AB.\n      // This means we can use `AB.Network` over the fetch API when loading\n      // config again. This prevents the session from being reset, which was\n      // happening inconsitently.\n      if (ab) this.AB = ab;\n\n      const loadABFactory = import(\n         /* webpackChunkName: \"AB\" */\n         \"../AppBuilder/ABFactory\"\n      );\n      // @const {Promise} loadABFactory Defer loading the ABFactory for a smaller\n      // inital file size, allowing us to show the loading UI sooner.\n      /**\n       * @type {Function} preloadMessage\n       * @description show a loading message\n       * @param {string} message to display on the loading screen\n       */\n      const preloadMessage = (m) =>\n         (document.getElementById(\"preload-text\").innerHTML = m);\n      /**\n       * @type {Function}\n       * @description remove the preload ui elements\n       */\n      const destroyPreloadUI = () =>\n         document.getElementById(\"preloader\").remove();\n\n      preloadMessage(\"Waiting for the API Server\");\n\n      performance.mark(\"bootstrap\", { op: \"function\" });\n      // on the web platform, we need to gather the appropriate configuration\n      // information before we can show the UI\n      // 1) Find or create the DIV element our UI is to attach to\n      //    this DIV element can contain settings pertainent to our setup\n      performance.mark(\"initDiv\", { op: \"ui.render\" });\n      await initDiv.init(this);\n      performance.measure(\"initDiv\");\n      // 2) Request the User's Configuration Information from the server.\n      performance.mark(\"initConfig\", { op: \"function\" });\n      preloadMessage(\"Getting Configuration Settings\");\n      await initConfig.init(this);\n      performance.measure(\"initConfig\");\n      const userInfo = Config.userConfig();\n      let definitionsLoading;\n      if (userInfo) {\n         // load definitions for current user\n         performance.setContext(\"user\", {\n            id: userInfo.id,\n         });\n         preloadMessage(\"Loading App Definitions\");\n         performance.mark(\"initDefinitions\", { op: \"function\" });\n         definitionsLoading = initDefinitions\n            .init(this)\n            .then(() => performance.measure(\"initDefinitions\"));\n      }\n      // 2.5) Load any plugins\n      performance.mark(\"loadPlugins\", { op: \"fucntion\" });\n      // Make sure the BootStrap Object is available globally\n      window.__ABBS = this;\n\n      // Listen 'disconnect' event\n      initConnectListerner.init(this);\n\n      const allPluginsLoaded = [];\n      const tenantInfo = Config.tenantConfig();\n\n      if (tenantInfo) {\n         performance.setContext(\"tenant\", tenantInfo);\n         performance.setContext(\"tags\", { tenant: tenantInfo.id });\n         const plugins = Config.plugins() || [];\n\n         // Short Term Fix: Don't load ABDesigner for non builders (need a way\n         // to assign plugins to users/roles);\n         const designerIndex = plugins.indexOf(\"ABDesigner.js\");\n         if (designerIndex > -1) {\n            const builderRoles = [\n               \"6cc04894-a61b-4fb5-b3e5-b8c3f78bd331\",\n               \"e1be4d22-1d00-4c34-b205-ef84b8334b19\",\n            ];\n            const userBuilderRoles = userInfo?.roles.filter(\n               (role) => builderRoles.indexOf(role.uuid) > -1\n            ).length;\n            // Remove if no builder roles\n            if (userBuilderRoles < 1 || userInfo == null) {\n               plugins.splice(designerIndex, 1);\n            }\n         }\n         plugins.forEach((p) => {\n            preloadMessage(`plugin (${p})`);\n            performance.mark(`plugin:${p}`, { op: \"resource.script\" });\n            const loading = loadScript(tenantInfo.id, p).then(() =>\n               performance.measure(`plugin:${p}`)\n            );\n            allPluginsLoaded.push(loading);\n         });\n      }\n      const pluginsLoading = Promise.all(allPluginsLoaded).then(() =>\n         performance.measure(\"loadPlugins\")\n      );\n      // 3) Now we have enough info, to create an instance of our\n      //    {ABFactory} that drives the rest of the AppBuilder objects\n      performance.mark(\"createABFactory\", { op: \"function\" });\n      preloadMessage(\"Starting AppBuilder\");\n\n      if (definitionsLoading) await definitionsLoading;\n      const { default: ABFactory } = await loadABFactory;\n      let definitions = Config.definitions() || null;\n\n      if (definitions) {\n         // NOTE: when loading up an unauthorized user,\n         // definitions will be null: we can skip the plugins\n         // Q: is it possible to load a plugin when unauthorized?\n         await pluginsLoading;\n         this._plugins.forEach((p) => {\n            definitions = definitions.concat(p.definitions());\n         });\n      }\n      this.AB = new ABFactory(definitions);\n\n      if (!window.AB) window.AB = this.AB;\n      // Make our Factory Global.\n      // Transition: we still have some UI code that depends on accessing\n      // our Factory as a Global var.  So until those are rewritten we will\n      // make our factory Global.\n\n      await this.AB.init();\n      // NOTE: special case: User has no Roles defined.\n      // direct them to our special ErrorNoDefsUI\n      if (userInfo && userInfo.roles.length == 0) {\n         performance.measure(\"createABFactory\");\n         ErrorNoDefsUI.init(this.AB);\n         ErrorNoDefsUI.attach();\n         if (Config.userReal()) {\n            ErrorNoDefsUI.switcherooUser(Config.userConfig());\n         }\n         destroyPreloadUI();\n         this.ui(ErrorNoDefsUI);\n\n         let err = new Error(\"No Definitions\");\n         err.code = \"ENODEFS\";\n         throw err;\n      }\n\n      // 3.5  prepare the plugins\n      this._plugins.forEach((p) => {\n         p.apply(this.AB);\n         const labels = p.labels(this.AB.Multilingual.currentLanguage());\n         this.AB.Multilingual.pluginLoadLabels(p.key, labels);\n      });\n      performance.measure(\"createABFactory\");\n\n      // 4) Now we can create the UI and send it the {ABFactory}\n      performance.mark(\"initUI\", { op: \"ui.render\" });\n      // webix recommends wrapping any webix code in the .ready()\n      // function that executes after page loading.\n      webix.ready(() => {\n         const locales = {\n            en: \"en-US\",\n            \"zh-hans\": \"zh-CN\",\n            th: \"th-TH\",\n         };\n         // locales - map ab languageCode to webix locale\n         const { languageCode } = AB.Config.userConfig() ?? {};\n         // save the webix locale used to set locale in ClassUIPage.renderPage()\n         window.webixLocale =\n            Object.prototype.hasOwnProperty.call(locales, languageCode) &&\n            Object.prototype.hasOwnProperty.call(\n               webix.i18n.locales,\n               locales[languageCode]\n            )\n               ? locales[languageCode]\n               : false;\n\n         // webix pro offers a feature that hides scroll bars by\n         // default for browsers that include them due to the user's\n         // UI. The experience becomes more like a touch interface\n         // with the exception that scroll bars appear when user\n         // hovers over a scrollable area\n         /* if (!Webix.env.touch  && Webix.env.scrollSize ) */\n         webix.CustomScroll.init();\n\n         const div = this.div();\n\n         UI.attach(div.id);\n         destroyPreloadUI();\n         this.ui(UI);\n         this.ui()\n            .init(this.AB)\n            .then(() => {\n               performance.measure(\"initUI\");\n               performance.measure(\"bootstrap\");\n            });\n         // this.ui().init() routine handles the remaining\n         // bootup/display process.\n      });\n   }\n\n   addPlugin(plugin) {\n      this._plugins.push(plugin);\n   }\n\n   alert(options) {\n      webix.alert(options);\n   }\n\n   div(el) {\n      if (el) {\n         this._div = el;\n         return;\n      }\n      return this._div;\n   }\n\n   error(...params) {\n      console.error(...params);\n      let message = params[0];\n      this.emit(message);\n   }\n\n   ui(UI) {\n      if (UI) {\n         this._ui = UI;\n         return;\n      }\n      return this._ui;\n   }\n}\n\nexport default new Bootstrap();\n\nfunction loadScript(tenant, p) {\n   return new Promise((resolve, reject) => {\n      const cb = () => resolve();\n\n      // Adding the script tag to the head as suggested before\n      const head = document.head;\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `/plugin/${tenant || \"??\"}/${p}`;\n\n      // Then bind the event to the callback function.\n      // There are several events for cross browser compatibility.\n      script.onreadystatechange = cb;\n      script.onload = cb;\n      script.onerror = () => {\n         reject(new Error(`Error loading plugin ${p}`));\n      };\n\n      // Fire the loading\n      head.appendChild(script);\n   });\n}\n","/*\n * initDiv.js\n * find or create an initial <div> for our Appbuilder portal\n */\nexport default {\n   init: (BS) => {\n      // BS {Bootstrap}\n      // The initial Bootstrap object found in \"./Bootstrap.js\"\n\n      return new Promise((resolve, reject) => {\n         // find our initial <div appbuilder-portal=\"default\" /> tag\n         var div = document.querySelector(\"div[appbuilder-portal]\");\n         if (!div) {\n            div = document.createElement(\"Div\");\n            div.setAttribute(\"appbuilder-portal-autoenter\", \"true\");\n            div.setAttribute(\"appbuilder-portal-fullscreen\", \"true\");\n            document.getElementsByTagName(\"body\")[0].appendChild(div);\n         }\n         // let loading = document.createElement(\"Div\");\n         // loading.style.justifyContent = \"center\";\n         // loading.style.alignItems = \"center\";\n         // loading.style.display = \"flex\";\n         // loading.style.height = \"100vh\";\n         // loading.style.width = \"100%\";\n         // loading.style.position = \"absolute\";\n         // loading.style.top = \"0\";\n         // loading.style.left = \"0\";\n         // // loading.style.animation = \"spinning 1s ease infinite\";\n         //\n         // loading.innerHTML = `<svg style=\"opacity: 0.6; animation: spinning 1s ease infinite; width: 25px; height: 25px;\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\"M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z\"/></svg>`;\n         // document.getElementsByTagName(\"body\")[0].appendChild(loading);\n         // const css = window.document.styleSheets[0];\n         // css.insertRule(\n         //    `@keyframes spinning {\n         //          0%   { transform: rotate(0deg); }\n         //          100% { transform: rotate(360deg); }\n         //    }`,\n         //    css.cssRules.length\n         // );\n         // make sure there is a div.id set:\n         if (!div.id) {\n            div.id = \"AppBuilder\";\n         }\n         BS.div(div);\n         BS.Config.settingsFromDiv(div); // set the autoEnter config\n         resolve();\n      });\n   },\n};\n","export default {\n   init: async (BS) => {\n      // BS {Bootstrap}\n      // The initial Bootstrap object found in \"./Bootstrap.js\"\n      try {\n         let configData;\n         // Use `AB.Network` if available\n         if (BS.AB) {\n            configData = await BS.AB.Network.get(\n               { url: \"/config\" },\n               { key: \"init_config\" }\n            );\n         } else {\n            const headers = new Headers();\n            const token = BS.Config.setting(\"tenant\");\n            if (token) {\n               headers.append(\"tenant-token\", token);\n            }\n\n            //// DEV TESTING:\n            //// uncomment the api_sails/authTenant.js && index.ejs entries for these values\n            //// to test url prefix route resolutions:\n            // var prefix = AB.setting(\"prefix\");\n            // if (prefix) {\n            //    headers.append(\"Tenant-Test-Prefix\", prefix);\n            // }\n            //// DEV TESTING\n\n            const response = await fetch(\"/config\", { headers });\n            if (response.ok) {\n               const { data } = await response.json();\n               configData = data;\n            } else {\n               BS.error(`Error communicating with Server: ${response.status}`);\n            }\n         }\n         // Hotfix 11/30/22, Since we no longer send settings on the div including in config.\n         BS.Config.settings(configData.settings);\n         delete configData.settings;\n         BS.Config.config(configData);\n      } catch (err) {\n         BS.error(\"initConfig: GET /config:\", err);\n         // HOTFIX: (12/15/2022) If the user visits /home directly /config is\n         // the first request made to sails and if we're not authenticated but\n         // using OKTA or CAS, we get a CORS error when trying to authenticate.\n         // Send the user to / to get authenticated correctly.\n         if (err.message == \"Failed to fetch\")\n            window.location.replace(window.location.origin);\n      }\n   },\n};\n","import { nanoid } from \"nanoid\";\nexport default {\n   init: async (BS) => {\n      // BS {Bootstrap}\n      // The initial Bootstrap object found in \"./Bootstrap.js\"\n      let updated;\n      try {\n         if (BS.AB) {\n            updated = await BS.AB.Network.get(\n               { url: \"/definition/check-update\" },\n               { key: \"def_check_update\" }\n            );\n         } else {\n            const headers = new Headers();\n            const token = BS.Config.setting(\"tenant\");\n            if (token) {\n               headers.append(\"tenant-token\", token);\n            }\n\n            const response = await fetch(\"/definition/check-update\", {\n               headers,\n               credentials: \"include\",\n            });\n            if (!response.ok) {\n               BS.error(`Error communicating with Server: ${response.status}`);\n            }\n            const res = await response.json();\n            updated = res.data;\n         }\n      } catch (err) {\n         BS.error(\"initDefinitions: GET /definition/check-update\", err);\n         return;\n      }\n\n      // if we are Switcherood to another user, we need to ignore our current\n      // cached definition.  Current way to do that is to simply give a random\n      // hash for our 'updated' value.\n      if (BS.Config?.userReal()) {\n         updated = nanoid();\n      }\n      await new Promise((resolve, reject) => {\n         var cb = () => resolve();\n         // Adding the script tag to the head as suggested before\n         const head = document.head;\n         const script = document.createElement(\"script\");\n         script.type = \"text/javascript\";\n         script.src = `/definition/myapps?v=${updated}`;\n\n         // Then bind the event to the callback function.\n         // There are several events for cross browser compatibility.\n         script.onreadystatechange = cb;\n         script.onload = cb;\n         script.onerror = () => {\n            reject(\n               new Error(\n                  `initDefinitions: Error loading definitions (/definition/myapps?v=${updated})`\n               )\n            );\n         };\n         // Fire the loading\n         head.appendChild(script);\n      });\n   },\n};\n","/*\n * initConnectListerner.js\n * listen disconnect event of WebSocket and display message when disconnect\n */\nexport default {\n   init: (BS) => {\n      // BS {Bootstrap}\n      // The initial Bootstrap object found in \"./Bootstrap.js\"\n\n      return new Promise((resolve, reject) => {\n         const L = (...params) => BS.AB.Multilingual.label(...params);\n\n         io.socket.on(\"disconnect\", function() {\n            const body = document.querySelector(\"body\");\n            body.insertAdjacentHTML(\n               \"afterbegin\",\n               `<div id='connectionPrompt' style='height: 0px;'>\n                  ${L(\"*Oops, we cannot communicate with the site.\")}\n               </div>`\n            );\n         });\n\n         resolve();\n      });\n   },\n};\n","// Include all CSS here\nimport \"./styles/loader.css\";\nimport \"./js/webix/webix.css\";\nimport \"./js/webix/components/gantt/gantt.min.css\";\nimport \"./js/webix/components/reports/reports.min.css\";\nimport \"./js/webix/components/query/query.min.css\";\nimport \"./js/webix/components/scheduler/scheduler.min.css\";\nimport \"./js/webix/components/querybuilder/querybuilder.min.css\";\nimport \"./js/webix/components/hint/hint.css\";\nimport \"./styles/ui.css\";\n// NOTE: keep Font Awesome AFTER webix css so webix wont\n// override our icon stylesimport \"./styles/font-awesome.min.css\";\nimport \"./styles/font-awesome.min.css\";\n\nimport performance from \"./utils/performance\";\nperformance.init();\n\nimport Bootstrap from \"./init/Bootstrap.js\";\n// Bootstrap is responsible for initializing the platform.\n\n// Import webix dynamically so we load it before we load other files that need it\nimport(\n   /* webpackChunkName: \"webix\" */\n   /* webpackPreload: true */\n   \"./js/webix/webix.min.js\"\n).then((webix) => {\n   // Make sure webix is global object\n   window.webix = webix;\n   // Now load additional webix resources\n   import(\n      /* webpackChunkName: \"webix.resources\" */\n      /* webpackPreload: true */\n      \"./js/webix/webixResources\"\n   );\n\n   Bootstrap.init().catch((err) => {\n      // This is a known error that has already been handled.\n      if (err.code == \"ENODEFS\") return;\n\n      var errorMSG = err.toString();\n\n      Bootstrap.alert({\n         type: \"alert-error\",\n         title: \"Error initializing Portal:\",\n         text: errorMSG,\n      });\n\n      Bootstrap.error(err);\n   });\n});\n","import { EventEmitter } from \"events\";\n\nclass ClassUI extends EventEmitter {\n   constructor(base, ids) {\n      super();\n\n      this.ids = {};\n      // {hash}\n      // An internal reference of webix.ids that we use to reference webix\n      // components.\n\n      // We can be called in several ways:\n      // 1) super(\"base_id\");\n      //    in this case we create a default this.ids.component = base_id;\n      //\n      // 2) super({ id1:\"id1\", id2:\"id2\", ... })\n      //    in this case we create a this.ids = base;\n      //    we look for a this.ids.base || or this.ids.component and use that\n      //    as our \"base\" reference.\n      //\n      // 3) super(base, ids);\n      //\n      if (base) {\n         if (\"string\" == typeof base) {\n            this.ids = {\n               component: base,\n            };\n         } else {\n            this.ids = base;\n            base = this.ids.base ?? this.ids.component;\n         }\n      }\n\n      // a shortcut way to enter the ids is to simply put the keys:\n      // {\n      //    form:\"\",\n      //    form_button:\"\",\n      //    ...\n      // }\n      // so we need to make sure the actual values are set according to\n      // `{base}_{key}` format.\n      //\n      if (ids) {\n         Object.keys(ids).forEach((k) => {\n            if (ids[k]) {\n               return (this.ids[k] = ids[k]);\n            }\n            this.ids[k] = `${base}_${k}`;\n         });\n      }\n\n      // verify this.ids are properly set:\n      Object.keys(this.ids).forEach((k) => {\n         this.ids[k] = this.ids[k] || `${base}_${k}`;\n      });\n\n      // and make sure there is a .component set:\n      this.ids.component = this.ids.component || base;\n   }\n\n   /**\n    * @method CYPRESS_REF()\n    * Attach a cypress \"data-cy\" attribute to the given element.  This is used\n    * for writing E2E tests and how we directly identify a webix widget we are\n    * referencing for our tests.\n    * @param {webix.object|webix.node|html.element} el\n    *        The element we are attempting to attach the data attribute to\n    *        There are a number of ways we might be sending this element\n    *        on a onAfterRender() callback on a Webix Object\n    *        by gathering the nodes of a Webix object directly\n    * @param {string} id\n    *        [optional] the value of the data-cy attribute\n    */\n   static CYPRESS_REF(el, id) {\n      if (!el) return;\n\n      id = id || el.config?.id;\n\n      // is this a webix object?\n      if (el.getInputNode) {\n         var node = el.getInputNode();\n         if (node) {\n            node.setAttribute(\"data-cy\", id);\n            return;\n         }\n      }\n\n      // this element has a webix $view\n      if (el.$view) {\n         el.$view.setAttribute(\"data-cy\", id);\n         return;\n      }\n\n      // this is probably a straight up DOM element:\n      el.setAttribute?.(\"data-cy\", id);\n   }\n\n   /**\n    * attach()\n    * cause this UI object to attach itself to a given DIV.ID\n    * of an existing HTML object.\n    * @param {string} id\n    *        the <DIV ID=\"id\"> value of the HTML element to display this UI\n    *        inside.\n    * @return {Webix View}\n    *        returns an instance of the Webix UI object generated by our\n    *        .ui() description.\n    */\n   attach(id) {\n      var ui = this.ui();\n      if (ui && id) {\n         ui.container = id;\n      }\n\n      this.el = webix.ui(ui);\n      return this.el;\n   }\n\n   changePage(pageId) {\n      this.emit(\"changePage\", pageId);\n   }\n\n   hide() {\n      if (this.ids?.component) {\n         $$(this.ids.component).hide();\n      }\n   }\n\n   label(key, ...params) {\n      if (this.AB) {\n         return this.AB.Multilingual.label(key, key, ...params);\n      }\n      console.error(\".labels() called before .AB was set!\");\n      return key;\n   }\n\n   /**\n    * ui()\n    * return a Webix user interface definition for this UI component.\n    * This should be just the json description, not an active instance.\n    * @return {obj}\n    */\n   ui() {\n      console.error(\n         \"ClassUI.ui(): it is expected that sub classes of ClassUI will implement their own ui() method.\"\n      );\n   }\n\n   show() {\n      if (this.ids?.component) {\n         $$(this.ids.component)?.show();\n      }\n   }\n\n   get WARNING_ICON() {\n      return `<span class=\"webix_sidebar_dir_icon webix_icon fa fa-warning pulseLight smalltext\"></span>`;\n   }\n\n   get WARNING_ICON_DARK() {\n      return this.WARNING_ICON.replace(\"pulseLight\", \"pulseDark\");\n   }\n}\n\nexport default ClassUI;\n","/**\n * Performance - utility to track performance of the web platform\n * Written initally for sentry, but could be extended to support others\n * tracking tools.\n * Also supports the User timing API for lighthouse / local dev\n */\n\nimport * as Sentry from \"@sentry/browser\";\n/* These come from the DefinePlugin in webpack  */\nlet webpackMode = \"development\";\nlet version, dsn;\ntry {\n   /* global WEBPACK_MODE SENTRY_DSN VERSION */\n   webpackMode = WEBPACK_MODE;\n   dsn = SENTRY_DSN;\n   version = VERSION;\n} catch (err) {\n   console.warn(\n      \"Error reading from webpack, check the DefinePlugin is working correctly\",\n      err\n   );\n}\n\nconst mode = dsn\n   ? \"sentry\"\n   : webpackMode === \"development\"\n   ? \"browser\"\n   : undefined;\n\n// Following are performance tracking sources, will be accessed through the\n// PerfomanceInterface\n\n/*\n * Default - performance tracking disabled\n */\nclass Performance {\n   init() {}\n   error() {}\n   mark() {}\n   measure() {}\n   notify(domain, error, info) {\n      console.groupCollapsed(`Notify ${domain}: ${error?.message ?? \"\"}`);\n      console.error(error);\n      console.log(\"info\", info);\n      console.groupEnd();\n   }\n   setContext() {}\n}\n\n/*\n * Sentry perfomance tracking\n */\nclass SentryPerformance extends Performance {\n   constructor() {\n      super();\n      this.childSpans = {};\n   }\n\n   init() {\n      Sentry.init({\n         dsn,\n         environment: webpackMode,\n         release: version,\n         integrations: [new Sentry.BrowserTracing()],\n         normalizeDepth: 5,\n         sampleRate: 0.05,\n         tracesSampleRate: 0.05,\n      });\n   }\n\n   error(err) {\n      Sentry.captureException(err);\n   }\n\n   mark(key, context = {}) {\n      context.name = key;\n      if (!this.mainSpan) {\n         this.mainSpanKey = key;\n         this.mainSpan = Sentry.startTransaction(context);\n      } else {\n         this.childSpans[key] = this.mainSpan.startChild(context);\n      }\n   }\n\n   measure(key) {\n      if (this.mainSpanKey === key) {\n         this.mainSpan.finish();\n         delete this.mainSpan;\n         delete this.mainSpanKey;\n         this.childSpans = {};\n      } else {\n         this.childSpans[key]?.finish?.();\n         delete this.childSpans[key];\n      }\n   }\n\n   notify(domain, error, info) {\n      const scope = new Sentry.Scope();\n      // Mark builder alerts as lower level in sentry\n      if (domain == \"builder\") scope.setLevel(\"warning\");\n      scope.setTag(\"domain\", domain);\n      scope.setContext(\"info\", info);\n      Sentry.captureException(error, scope);\n      // Also log to console:\n      super.notify(domain, error, info);\n   }\n\n   setContext(key, data) {\n      switch (key) {\n         case \"tags\":\n            Sentry.setTags(data);\n            break;\n         case \"user\":\n            Sentry.setUser(data);\n            break;\n         default:\n            Sentry.setContext(key, data);\n            break;\n      }\n   }\n}\n\n/*\n * Browser Performance tracking - uses the User Timing API\n */\nclass BrowserPerformnace extends Performance {\n   error(err) {\n      console.error(err);\n   }\n\n   mark(key, context) {\n      if (!this.mainSpanKey) {\n         this.mainSpanKey = key;\n      }\n      window.performance.mark(key, { detail: context });\n   }\n\n   measure(key) {\n      try {\n         const mark = window.performance.getEntriesByName(key, \"mark\")[0];\n         const measure = window.performance.measure(key, {\n            start: key,\n            detail: mark?.detail,\n         });\n         if (this.mainSpanKey === key) {\n            console.groupCollapsed(\n               `${measure.name} finished in ${measure.duration} ms`\n            );\n            const entries = window.performance.getEntriesByType(\"measure\");\n            if (entries.length > 1)\n               console.table(entries, [\"name\", \"duration\", \"startTime\"]);\n            else console.log(measure);\n            console.groupEnd();\n            delete this.mainSpanKey;\n            window.performance.clearMarks();\n            window.performance.clearMeasures();\n         }\n      } catch (e) {\n         // console.warn(e);\n      }\n   }\n}\n\n/**\n * hash of performance tracking sources\n */\nconst sources = {\n   sentry: SentryPerformance,\n   browser: BrowserPerformnace,\n};\n\n/**\n * Performance Interface that the rest of the app uses. Routes the calls to the\n * configured performance tracking source\n */\nclass PerformanceInterface {\n   constructor(mode) {\n      this.mode = mode;\n      this.initialized = false;\n      this._source = new (sources[mode] ?? Performance)();\n   }\n\n   /**\n    * initialize performance, should be called early in init\n    */\n   init() {\n      if (this.initialized) return;\n      this._source.init();\n      // console.log(\"Performance.init() complete\", mode);\n      this.initialized = true;\n   }\n\n   /**\n    * Capture an error\n    * @param {Error} error\n    */\n   error(err) {\n      this._source.error(err);\n   }\n\n   /**\n    * Start a performance tracking span. End by calling measure() with the same key.\n    * The first mark will be consider a parent, and subsequent marks become\n    * children until the initial mark is measured.\n    * @param {string} key unique key to track\n    * @param {object} [context] any additional context\n    */\n   mark(key, context) {\n      this._source.mark(key, context);\n   }\n\n   /**\n    * End a performance tracking span\n    * @param {string} key should match an existing mark\n    */\n   measure(key) {\n      this._source.measure(key);\n   }\n\n   /**\n    * Implements AB.notify which will log differently depending on our tracking\n    * option\n    * @param {string} domain which group of people we are sending a notification to.\n    * @param {Error} error An error object generated at the point of issue.\n    * @param {json} info Additional related information concerning the issue.\n    */\n   notify(domain, error, info) {\n      this._source.notify(domain, error, info);\n   }\n\n   /**\n    * Set additional context to tracing/error events\n    * @param {string} key type of context (tag, user, etc)\n    * @pram {object} data\n    */\n   setContext(key, data) {\n      this._source.setContext(key, data);\n   }\n}\n\n// singleton\nlet performanceInterface;\n\n/**\n * Get/create the shared performance instance\n * @returns {PerformanceInterface}\n */\nfunction getPerformance() {\n   if (!performanceInterface)\n      performanceInterface = new PerformanceInterface(mode);\n   return performanceInterface;\n}\n\nexport default getPerformance();\n"],"names":["appListRowHeight","buttonWidthLarge","buttonWidthMedium","buttonWidthSmall","buttonWidthExtraSmall","tabWidthLarge","tabWidthMedium","tabWidthSmall","tabWidthExtraSmall","columnWidthXLarge","columnWidthLarge","columnWidthMedium","columnWidthSmall","columnWidthExtraSmall","xSmallSpacer","smallSpacer","mediumSpacer","largeSpacer","xLargeSpacer","xxLargeSpacer","xxxLargeSpacer","appListSpacerRowHeight","appListSpacerColMinWidth","appListSpacerColMaxWidth","objectWorkspaceColWidth","labelWidthSmall","labelWidthMedium","labelWidthLarge","labelWidthXLarge","labelWidthXXLarge","labelWidthXXXLarge","labelWidthCheckbox","hideMobile","settingsDefault","configDefaults","site","appbuilder","networkType","networkNumRetries","urlCoreServer","window","location","origin","storage","encrypted","constructor","this","_config","_settings","config","json","defaultsDeep","setting","key","value","settingsFromDiv","div","Object","keys","forEach","d","val","getAttribute","split","pop","settings","definitions","error","console","labelConfig","labels","languageConfig","languages","metaConfig","meta","plugins","inboxConfig","inbox","inboxMetaConfig","inboxMeta","siteConfig","tenantConfig","tenant","uiSettings","innerWidth","userConfig","user","userReal","PortalLoading","ClassUI","super","ui","id","view","label","init","AB","Promise","resolve","show","$$","PortalAuthLoginForm","self","L","Label","css","cols","rows","width","padding","template","borderless","height","type","background","elementsConfig","bottomPadding","elements","placeholder","name","attributes","validate","webix","rules","isEmail","invalidMessage","validateEvent","isNotEmpty","margin","paddingX","hotkey","click","form","hide","values","getValues","Network","post","url","data","catch","err","log","on","onAfterRender","hidden","emit","message","$errMsg","setHTML","context","response","code","status","reload","PortalAuthLoginResetPassword","Account","email","border","color","v","length","getValue","password","async","params","Multilingual","PortalAuthLoginResetRequest","autoheight","options","icon","autowidth","href","$tenant","Config","tenants","newOptions","t","opt","uuid","title","push","define","tID","Tenant","find","o","text","alert","ok","PortalAuthLogin","animate","allInits","all","defaultView","PortalAuth","ActivePortal","cells","then","pathname","performance","navigation","redirectCount","replace","ClassUIPage","containerID","page","App","initialized","pageStack","pageComponents","changePageEventIds","isRoot","render","showPage","myUI","application","datacollectionsIncluded","dc","renderPage","parView","getParentView","showBatch","initEvents","pageID","needToReloadPage","updatePageEventId","rootPageId","updateDatacollectionEventId","datacollectionId","webixLocale","setTimeout","i18n","setLocale","component","myContainer","popupTemplate","modal","position","resize","parseInt","popupWidth","popupHeight","head","align","button","queryView","dataCy","getInputNode","setAttribute","body","scroll","oldView","destructor","removeView","e","batch","oldPage","addView","pages","subpage","container","eventID","attachEvent","detachEvent","viewId","showPageID","activeID","activeUI","getChildViews","filter","onShow","Error","PortalWorkInboxAccordion","app","idUnitList","header","collapsed","uniteBy","templateHeader","headerHeight","obj","items","select","list","selectedItem","getItem","task","unitlist","src","formComponents","formData","onButton","processItem","each","a","getItemNode","notify","developer","info","unitID","parent","i","refresh","remove","getSelectedId","count","unitList","put","expand","initFormIOPreview","custom","formiopreview","PortalWorkInboxTaskwindow","idTaskMultiview","idTaskTitle","idTaskPager","state","left","maxWidth","top","maxHeight","unselectAll","size","group","master","onBeforePageChange","new_page","clearTask","views","taskHolder","index","setValue","blockEvent","getActiveId","unblockEvent","showTasks","selectedItemName","PortalWorkInbox","entries","processLookupHash","appLookupHash","appAccordionLists","multi","allAppAccordions","lang","language","createAccordian","addItem","processes","getProcessList","accordion","parse","item","createNew","definition","ids","appId","translate","appAccordion","p","process","uniteLabel","translations","entry","language_code","k","PortalWorkUserProfileWindow","imageUser","uploaderImage","formUserInfo","dataEmail","editModeEmail","buttonEditModeEmail","editModeButtonsEmail","dataLanguage","editModeLanguage","buttonEditModeLanguage","editModeButtonsLanguage","formNewPassword","fieldNewPassword","systemNotification","advanceOptions","acctImageID","imageID","imgTemplate","imgErrorDiv","onItemClick","zIndex","algin","inputName","apiOnly","multiple","accept","upload","objectUser","onFileUpload","$uploaderImage","$imageUser","disable","model","update","image_id","enable","onFileUploadError","inputWidth","$dataEmail","$editModeEmail","$buttonEditModeEmail","$editModeButtonsEmail","$dataLanguage","$editModeLanguage","$buttonEditModeLanguage","$editModeButtonsLanguage","getLanguages","languageCodeToWord","languageCode","$button","$advanceOptions","isVisible","$formNewPassword","$thisButton","clear","$systemNotification","sendEmailNotifications","Language","objectLanguage","findAll","language_label","$formUserInfo","populateLanguage","setValues","username","populate","myClass","userIcon","userName","switchBack","switchBackReplacer","close","switchUser","userID","headless","userList","delete","mainUserID","map","u","switchedUserID","isSwitcherood","PortalWorkUserQRWindow","classQrImageDom","$view","getElementsByClassName","onload","adjust","PortalWorkUserMobileQR","description","instructions","qrcode","taskPager","load","$title","$desc","$qrcode","PortalAccessLevelManager","accessLevels","accessLevelManagerBody","roles","newRolePopup","role","indexOf","buildAccessAccordion","collapse","portal","AppState","lastSelectedApp","translation","applicationByID","isAccessManaged","existingRoles","pageId","pageContainers","f","isRoleAccessManager","accessManagers","useRole","manageUsers","confirm","tree","mainPages","branch","access","updateAccessLevels","updateItem","itemToRemove","splice","toggleParent","element","parentElem","getParent","$parent","editable","editor","editValue","threeState","common","getAccessLevelTree","onClick","externalLink","event","target","tabView","tab","showIt","setInterval","clearInterval","onAfterEditStop","ignoreUpdate","old","onDataUpdate","eachSubItem","child","childData","parentBranch","getParentId","parentData","newAccordionItem","r","WARNING_ICON","Webix","TooltipControl","addTooltip","openAll","TreeCollection","addPage","parentId","accessLevel","add","defaults","subPages","childPage","childIndex","tabIndex","tabViewIndex","tIndex","PortalTranslationTool","containerDomID","translationToolBody","labelWidth","labelAlign","onChange","newVal","oldVal","buildTranslationAccordion","objectsIncluded","hintsIncluded","bottomLabel","languageList","get","ready","protoUI","EditAbility","tutorials","hints","objects","objectTree","tooltip","onAfterLoad","showProgress","extend","ProgressBar","getTranslationToolObjectsTree","propName","field","objectId","fieldId","objectByID","fields","option","languageDefault","hasLang","trans","save","progressBar","total","completed","viewTree","pageView","getTranslationToolViewsTree","order","buttonId","tutorialTree","getTranslationToolTutorialsTree","hint","h","step","hintId","_steps","objectsAccordionItem","viewsAccordionItem","hintsAccordionItem","getTranslations","domId","missingHint","missingTranslate","translateLang","hintLang","hintLabel","valueLabel","hintPrefix","translatePrefix","tabicon","labelIndex","menu","menuIndex","menuItem","menuItemIndex","formIndex","formInput","formInputIndex","property","chart","chartIndex","viewIndex","addBranch","object","fieldIndex","optionIndex","lastField","firstField","stepIDs","PortalTutorialManager","tutorialStepsManager","createStep","Array","isArray","stepUI","move","tutorialSettings","tutorialManagerBody","_hints","deleteHint","ev","result","hintID","destroy","fail","hintItem","steps","newTutorialPopup","lastPages","getText","trim","createTutorial","valid","disabled","el","active","currentTutorial","hasOwnProperty","getViewOptions","hintIDs","pageTabWindow","document","removeEventListener","handleRightClick","focusWindow","classList","updateStepsUI","viewsToRemove","addHighlightClass","currentTarget","formVals","stepId","querySelector","removeHighlightClass","addStepBelow","focusElements","querySelectorAll","addEventListener","class","moveStep","minWidth","deleteStep","stepRemove","direction","currPosition","addOption","depth","indent","pageIndex","viewID","viewLabel","hintNew","unshift","hintView","stepNew","preventDefault","stopPropagation","getCy","dataset","cy","parentElement","PortalWork","_connectionCheck","navSideBar","sidebarMenu","firstID","getFirstId","popup","onAfterSelect","selectApplication","storageKey","allApplications","applications","isWebApp","isAccessibleForRoles","rolesAll","concat","menu_data","uiSideBarMenuEntry","sidebarResize","userMenuOptions","isMobile","m","canSwitcheroo","$portalWorkNoNetworkDetected","navigator","onLine","relay","logout","mobileApp","Storage","abApplication","getUserAccess","DefaultPage","$sideBar","foundMenuEntry","sidebarMenuEntryByID","defaultPageID","allPlaceholders","j","keepViews","Class","ABComponent","containerInit","cont","refreshSettingsMenu","badge","$portalWorkServerComunicationDisabledDetected","$portalWorkServerComunicationDisabledDetectedQueue","queueCount","eid","row","pageButtons","firstPage","activePageID","saveState","pbLabel","abPage","pageButton","selectedPage","sideBar","_saveTimeoutID","clearTimeout","set","pageUI","menuID","getNextId","sideBarHeight","settingsMenuOptions","isManager","useAccount","account","isTranslationManaged","translationManagers","isTutorialManaged","tutorialManagers","Portal","ShownPortal","portalWorkReady","fullscreen","showPortal","isAuthenticated","redirect","showAuthPortal","showDefaultView","showWorkPortal","parts","UI","hiddenElements","portalShow","entryLabel","textClickToEnter","portalHide","ErrorNoDefsUI","switcherooUser","preloadMessage","EventEmitter","setMaxListeners","_div","_plugins","_ui","ab","loadABFactory","getElementById","innerHTML","destroyPreloadUI","BS","op","reject","createElement","getElementsByTagName","appendChild","configData","headers","Headers","token","append","fetch","initConfig","userInfo","definitionsLoading","updated","credentials","res","cb","script","onreadystatechange","onerror","initDefinitions","__ABBS","io","socket","insertAdjacentHTML","initConnectListerner","allPluginsLoaded","tenantInfo","designerIndex","builderRoles","userBuilderRoles","loading","loadScript","pluginsLoading","default","ABFactory","apply","currentLanguage","pluginLoadLabels","locales","en","th","prototype","call","CustomScroll","addPlugin","plugin","errorMSG","toString","base","static","node","attach","changePage","WARNING_ICON_DARK","version","dsn","webpackMode","warn","mode","undefined","Performance","mark","measure","domain","groupCollapsed","groupEnd","setContext","sources","sentry","childSpans","environment","release","integrations","normalizeDepth","sampleRate","tracesSampleRate","mainSpan","startChild","mainSpanKey","finish","scope","setLevel","setTag","browser","detail","getEntriesByName","start","duration","getEntriesByType","table","clearMarks","clearMeasures","performanceInterface","_source"],"sourceRoot":""}