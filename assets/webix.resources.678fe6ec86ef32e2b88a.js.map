{"version":3,"file":"webix.resources.678fe6ec86ef32e2b88a.js","mappings":"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","sources":["webpack://ab_platform_web/./js/webix/components/gantt/ sync","webpack://ab_platform_web/./js/webix/components/pivot/ sync","webpack://ab_platform_web/./js/webix/components/reports/ sync","webpack://ab_platform_web/./js/webix/components/scheduler/ sync","webpack://ab_platform_web/./js/webix/components/node_modules/webix-jet/dist/es6/jet.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/rLayout.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/jetWin.js","webpack://ab_platform_web/./js/webix/components/node_modules/jet-restate/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dragscroll.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dnd.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/bars.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/scale.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/diagram.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/common.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/tree.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/baseline.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/links.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/numeditor.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/resources.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/form.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/info.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/tree.js","webpack://ab_platform_web/./js/webix/components/sources/views/top.js","webpack://ab_platform_web/./js/webix/components/sources/export_views.js","webpack://ab_platform_web/./js/webix/components/sources/models/Local.js","webpack://ab_platform_web/./js/webix/components/sources/models/Backend.js","webpack://ab_platform_web/./js/webix/components/sources/models/Operations.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/webix-gantt-lib/dist/wgantt.es6.js","webpack://ab_platform_web/./js/webix/components/sources/models/Helpers.js","webpack://ab_platform_web/./js/webix/components/sources/models/Grouping.js","webpack://ab_platform_web/./js/webix/components/sources/app.js","webpack://ab_platform_web/./js/webix/components/sources/locales/en.js","webpack://ab_platform_web/./js/webix/components/sources/header.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/image.js","webpack://ab_platform_web/./js/webix/components/sources/common.js","webpack://ab_platform_web/./js/webix/components/sources/list.js","webpack://ab_platform_web/./js/webix/components/sources/dataview.js","webpack://ab_platform_web/./js/webix/components/sources/kanban.js","webpack://ab_platform_web/./js/webix/components/sources/uploader.js","webpack://ab_platform_web/./js/webix/components/sources/locale.js","webpack://ab_platform_web/./js/webix/components/sources/editor.js","webpack://ab_platform_web/./js/webix/components/sources/userlist.js","webpack://ab_platform_web/./js/webix/components/sources/menu.js","webpack://ab_platform_web/./js/webix/components/sources/comments.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/portlet.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/complex.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/values.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/group.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/table.js","webpack://ab_platform_web/./js/webix/components/sources/views/filter.js","webpack://ab_platform_web/./js/webix/components/sources/views/mode.js","webpack://ab_platform_web/./js/webix/components/sources/views/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/main.js","webpack://ab_platform_web/./js/webix/components/sources/views/table.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/rengine/dist/rengine.es6.js","webpack://ab_platform_web/./js/webix/components/sources/models/LocalData.js","webpack://ab_platform_web/./js/webix/components/sources/views/common/export.js","webpack://ab_platform_web/./js/webix/components/sources/views/common/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/jet-restate-bind/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/inputlist.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/icons.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/query/codebase/query.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/common.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/prompt.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/queryselect.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/query.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/data.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/summarypopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/bucket.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/bucketpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/groupselect.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/buckets.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/datepopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/summary.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/groups.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/sorts.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/axis.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/baseview.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/colorpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/rsearch.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/chartseries.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/column.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/heatmap.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/table.js","webpack://ab_platform_web/./js/webix/components/sources/views/empty.js","webpack://ab_platform_web/./js/webix/components/sources/views/heatmap.js","webpack://ab_platform_web/./js/webix/components/sources/views/menu.js","webpack://ab_platform_web/./js/webix/components/sources/views/modules.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/export.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/index.js","webpack://ab_platform_web/./js/webix/components/node_modules/jet-hotkey/index.js","webpack://ab_platform_web/./js/webix/components/sources/models/Charts.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/waitVisible.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/add.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/date.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/nav.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/palette.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/editor.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/navpopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/actionmenu.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dates.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/ical.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/recurring.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/recurringform.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/editrecurring.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/form.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/formpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/copypaste.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/info.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/colors.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/actionpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/templates.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/unitlist.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/agenda/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/hourscale.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/multimore.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/selection.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/resizer.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/webix-gantt-lib/dist/wgantt.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/compact.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/more.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/list.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/bar.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/more.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/scale.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/multidaylist.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/compact.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/year/calendar.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/year/index.js","webpack://ab_platform_web/./js/webix/locales/th-TH.js","webpack://ab_platform_web/./js/webix/webixResources.js"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 49706;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 67468;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 97935;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 86993;\nmodule.exports = webpackEmptyContext;","class NavigationBlocked {\r\n}\n\nclass JetBase {\r\n    constructor(webix, config) {\r\n        this.webixJet = true;\r\n        this.webix = webix;\r\n        this._events = [];\r\n        this._subs = {};\r\n        this._data = {};\r\n        if (config && config.params)\r\n            webix.extend(this._data, config.params);\r\n    }\r\n    getRoot() {\r\n        return this._root;\r\n    }\r\n    destructor() {\r\n        this._detachEvents();\r\n        this._destroySubs();\r\n        this._events = this._container = this.app = this._parent = this._root = null;\r\n    }\r\n    setParam(id, value, url) {\r\n        if (this._data[id] !== value) {\r\n            this._data[id] = value;\r\n            this._segment.update(id, value, 0);\r\n            if (url) {\r\n                return this.show(null);\r\n            }\r\n        }\r\n    }\r\n    getParam(id, parent) {\r\n        const value = this._data[id];\r\n        if (typeof value !== \"undefined\" || !parent) {\r\n            return value;\r\n        }\r\n        const view = this.getParentView();\r\n        if (view) {\r\n            return view.getParam(id, parent);\r\n        }\r\n    }\r\n    getUrl() {\r\n        return this._segment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._segment.toString();\r\n    }\r\n    getParentView() {\r\n        return this._parent;\r\n    }\r\n    $$(id) {\r\n        if (typeof id === \"string\") {\r\n            const root = this.getRoot();\r\n            return root.queryView((obj => (obj.config.id === id || obj.config.localId === id) &&\r\n                (obj.$scope === root.$scope)), \"self\");\r\n        }\r\n        else {\r\n            return id;\r\n        }\r\n    }\r\n    on(obj, name, code) {\r\n        const id = obj.attachEvent(name, code);\r\n        this._events.push({ obj, id });\r\n        return id;\r\n    }\r\n    contains(view) {\r\n        for (const key in this._subs) {\r\n            const kid = this._subs[key].view;\r\n            if (kid === view || kid.contains(view)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    getSubView(name) {\r\n        const sub = this.getSubViewInfo(name);\r\n        if (sub) {\r\n            return sub.subview.view;\r\n        }\r\n    }\r\n    getSubViewInfo(name) {\r\n        const sub = this._subs[name || \"default\"];\r\n        if (sub) {\r\n            return { subview: sub, parent: this };\r\n        }\r\n        if (name === \"_top\") {\r\n            this._subs[name] = { url: \"\", id: null, popup: true };\r\n            return this.getSubViewInfo(name);\r\n        }\r\n        // when called from a child view, searches for nearest parent with subview\r\n        if (this._parent) {\r\n            return this._parent.getSubViewInfo(name);\r\n        }\r\n        return null;\r\n    }\r\n    _detachEvents() {\r\n        const events = this._events;\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            events[i].obj.detachEvent(events[i].id);\r\n        }\r\n    }\r\n    _destroySubs() {\r\n        // destroy sub views\r\n        for (const key in this._subs) {\r\n            const subView = this._subs[key].view;\r\n            // it possible that subview was not loaded with any content yet\r\n            // so check on null\r\n            if (subView) {\r\n                subView.destructor();\r\n            }\r\n        }\r\n        // reset to prevent memory leaks\r\n        this._subs = {};\r\n    }\r\n    _init_url_data() {\r\n        const url = this._segment.current();\r\n        this._data = {};\r\n        this.webix.extend(this._data, url.params, true);\r\n    }\r\n    _getDefaultSub() {\r\n        if (this._subs.default) {\r\n            return this._subs.default;\r\n        }\r\n        for (const key in this._subs) {\r\n            const sub = this._subs[key];\r\n            if (!sub.branch && sub.view && key !== \"_top\") {\r\n                const child = sub.view._getDefaultSub();\r\n                if (child) {\r\n                    return child;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _routed_view() {\r\n        const parent = this.getParentView();\r\n        if (!parent) {\r\n            return true;\r\n        }\r\n        const sub = parent._getDefaultSub();\r\n        if (!sub && sub !== this) {\r\n            return false;\r\n        }\r\n        return parent._routed_view();\r\n    }\r\n}\n\nfunction parse(url) {\r\n    // remove starting /\r\n    if (url[0] === \"/\") {\r\n        url = url.substr(1);\r\n    }\r\n    // split url by \"/\"\r\n    const parts = url.split(\"/\");\r\n    const chunks = [];\r\n    // for each page in url\r\n    for (let i = 0; i < parts.length; i++) {\r\n        const test = parts[i];\r\n        const result = {};\r\n        // detect params\r\n        // support old \t\t\tsome:a=b:c=d\r\n        // and new notation\t\tsome?a=b&c=d\r\n        let pos = test.indexOf(\":\");\r\n        if (pos === -1) {\r\n            pos = test.indexOf(\"?\");\r\n        }\r\n        if (pos !== -1) {\r\n            const params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\r\n            // create hash of named params\r\n            for (const param of params) {\r\n                const dchunk = param.split(\"=\");\r\n                result[dchunk[0]] = decodeURIComponent(dchunk[1]);\r\n            }\r\n        }\r\n        // store parsed values\r\n        chunks[i] = {\r\n            page: (pos > -1 ? test.substr(0, pos) : test),\r\n            params: result,\r\n            isNew: true\r\n        };\r\n    }\r\n    // return array of page objects\r\n    return chunks;\r\n}\r\nfunction url2str(stack) {\r\n    const url = [];\r\n    for (const chunk of stack) {\r\n        url.push(\"/\" + chunk.page);\r\n        const params = obj2str(chunk.params);\r\n        if (params) {\r\n            url.push(\"?\" + params);\r\n        }\r\n    }\r\n    return url.join(\"\");\r\n}\r\nfunction obj2str(obj) {\r\n    const str = [];\r\n    for (const key in obj) {\r\n        if (typeof obj[key] === \"object\")\r\n            continue;\r\n        if (str.length) {\r\n            str.push(\"&\");\r\n        }\r\n        str.push(key + \"=\" + encodeURIComponent(obj[key]));\r\n    }\r\n    return str.join(\"\");\r\n}\n\nclass Route {\r\n    constructor(route, index) {\r\n        this._next = 1;\r\n        if (typeof route === \"string\") {\r\n            this.route = {\r\n                url: parse(route),\r\n                path: route\r\n            };\r\n        }\r\n        else {\r\n            this.route = route;\r\n        }\r\n        this.index = index;\r\n    }\r\n    current() {\r\n        return this.route.url[this.index];\r\n    }\r\n    next() {\r\n        return this.route.url[this.index + this._next];\r\n    }\r\n    suburl() {\r\n        return this.route.url.slice(this.index);\r\n    }\r\n    shift(params) {\r\n        const route = new Route(this.route, this.index + this._next);\r\n        route.setParams(route.route.url, params, route.index);\r\n        return route;\r\n    }\r\n    setParams(url, params, index) {\r\n        if (params) {\r\n            const old = url[index].params;\r\n            for (var key in params)\r\n                old[key] = params[key];\r\n        }\r\n    }\r\n    refresh() {\r\n        const url = this.route.url;\r\n        for (let i = this.index + 1; i < url.length; i++) {\r\n            url[i].isNew = true;\r\n        }\r\n    }\r\n    toString() {\r\n        const str = url2str(this.suburl());\r\n        return str ? str.substr(1) : \"\";\r\n    }\r\n    _join(path, kids) {\r\n        let url = this.route.url;\r\n        if (path === null) { // change of parameters, route elements are not affected\r\n            return url;\r\n        }\r\n        const old = this.route.url;\r\n        let reset = true;\r\n        url = old.slice(0, this.index + (kids ? this._next : 0));\r\n        if (path) {\r\n            url = url.concat(parse(path));\r\n            for (let i = 0; i < url.length; i++) {\r\n                if (old[i]) {\r\n                    url[i].view = old[i].view;\r\n                }\r\n                if (reset && old[i] && url[i].page === old[i].page) {\r\n                    url[i].isNew = false;\r\n                }\r\n                else if (url[i].isNew) {\r\n                    // if some segment was marked as new, all subsegments must be updated as well\r\n                    reset = false;\r\n                }\r\n            }\r\n        }\r\n        return url;\r\n    }\r\n    append(path) {\r\n        const url = this._join(path, true);\r\n        this.route.path = url2str(url);\r\n        this.route.url = url;\r\n        return this.route.path;\r\n    }\r\n    show(path, view, kids) {\r\n        const url = this._join(path.url, kids);\r\n        this.setParams(url, path.params, this.index + (kids ? this._next : 0));\r\n        return new Promise((res, rej) => {\r\n            const redirect = url2str(url);\r\n            const obj = {\r\n                url,\r\n                redirect,\r\n                confirm: Promise.resolve()\r\n            };\r\n            const app = view ? view.app : null;\r\n            // when creating a new route, it possible that it will not have any content\r\n            // guard is not necessary in such case\r\n            if (app) {\r\n                const result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\r\n                if (!result) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n            }\r\n            obj.confirm.catch(err => rej(err)).then(() => {\r\n                if (obj.redirect === null) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                if (obj.redirect !== redirect) {\r\n                    app.show(obj.redirect);\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                this.route.path = redirect;\r\n                this.route.url = url;\r\n                res();\r\n            });\r\n        });\r\n    }\r\n    size(n) {\r\n        this._next = n;\r\n    }\r\n    split() {\r\n        const route = {\r\n            url: this.route.url.slice(this.index + 1),\r\n            path: \"\"\r\n        };\r\n        if (route.url.length) {\r\n            route.path = url2str(route.url);\r\n        }\r\n        return new Route(route, 0);\r\n    }\r\n    update(name, value, index) {\r\n        const chunk = this.route.url[this.index + (index || 0)];\r\n        if (!chunk) {\r\n            this.route.url.push({ page: \"\", params: {} });\r\n            return this.update(name, value, index);\r\n        }\r\n        if (name === \"\") {\r\n            chunk.page = value;\r\n        }\r\n        else {\r\n            chunk.params[name] = value;\r\n        }\r\n        this.route.path = url2str(this.route.url);\r\n    }\r\n}\n\nclass JetView extends JetBase {\r\n    constructor(app, config) {\r\n        super(app.webix);\r\n        this.app = app;\r\n        //this.$config = config;\r\n        this._children = [];\r\n    }\r\n    ui(ui, config) {\r\n        config = config || {};\r\n        const container = config.container || ui.container;\r\n        const jetview = this.app.createView(ui);\r\n        this._children.push(jetview);\r\n        jetview.render(container, this._segment, this);\r\n        if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\r\n            // raw webix UI\r\n            return jetview;\r\n        }\r\n        else {\r\n            return jetview.getRoot();\r\n        }\r\n    }\r\n    show(path, config) {\r\n        config = config || {};\r\n        // convert parameters object to url\r\n        if (typeof path === \"object\") {\r\n            for (const key in path) {\r\n                this.setParam(key, path[key]);\r\n            }\r\n            path = null;\r\n        }\r\n        else {\r\n            // deligate to app in case of root prefix\r\n            if (path.substr(0, 1) === \"/\") {\r\n                return this.app.show(path, config);\r\n            }\r\n            // local path, do nothing\r\n            if (path.indexOf(\"./\") === 0) {\r\n                path = path.substr(2);\r\n            }\r\n            // parent path, call parent view\r\n            if (path.indexOf(\"../\") === 0) {\r\n                const parent = this.getParentView();\r\n                if (parent) {\r\n                    return parent.show(path.substr(3), config);\r\n                }\r\n                else {\r\n                    return this.app.show(\"/\" + path.substr(3));\r\n                }\r\n            }\r\n            const sub = this.getSubViewInfo(config.target);\r\n            if (sub) {\r\n                if (sub.parent !== this) {\r\n                    return sub.parent.show(path, config);\r\n                }\r\n                else if (config.target && config.target !== \"default\") {\r\n                    return this._renderFrameLock(config.target, sub.subview, {\r\n                        url: path,\r\n                        params: config.params,\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                if (path) {\r\n                    return this.app.show(\"/\" + path, config);\r\n                }\r\n            }\r\n        }\r\n        return this._show(this._segment, { url: path, params: config.params }, this);\r\n    }\r\n    _show(segment, path, view) {\r\n        return segment.show(path, view, true).then(() => {\r\n            this._init_url_data();\r\n            return this._urlChange();\r\n        }).then(() => {\r\n            if (segment.route.linkRouter) {\r\n                this.app.getRouter().set(segment.route.path, { silent: true });\r\n                this.app.callEvent(\"app:route\", [segment.route.path]);\r\n            }\r\n        });\r\n    }\r\n    init(_$view, _$) {\r\n        // stub\r\n    }\r\n    ready(_$view, _$url) {\r\n        // stub\r\n    }\r\n    config() {\r\n        this.app.webix.message(\"View:Config is not implemented\");\r\n    }\r\n    urlChange(_$view, _$url) {\r\n        // stub\r\n    }\r\n    destroy() {\r\n        // stub\r\n    }\r\n    destructor() {\r\n        this.destroy();\r\n        this._destroyKids();\r\n        // destroy actual UI\r\n        if (this._root) {\r\n            this._root.destructor();\r\n            super.destructor();\r\n        }\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this.app, this, config);\r\n    }\r\n    refresh() {\r\n        const url = this.getUrl();\r\n        this.destroy();\r\n        this._destroyKids();\r\n        this._destroySubs();\r\n        this._detachEvents();\r\n        if (this._container.tagName) {\r\n            this._root.destructor();\r\n        }\r\n        this._segment.refresh();\r\n        return this._render(this._segment);\r\n    }\r\n    render(root, url, parent) {\r\n        if (typeof url === \"string\") {\r\n            url = new Route(url, 0);\r\n        }\r\n        this._segment = url;\r\n        this._parent = parent;\r\n        this._init_url_data();\r\n        root = root || document.body;\r\n        const _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\r\n        if (this._container !== _container) {\r\n            this._container = _container;\r\n            return this._render(url);\r\n        }\r\n        else {\r\n            return this._urlChange().then(() => this.getRoot());\r\n        }\r\n    }\r\n    _render(url) {\r\n        const config = this.config();\r\n        if (config.then) {\r\n            return config.then(cfg => this._render_final(cfg, url));\r\n        }\r\n        else {\r\n            return this._render_final(config, url);\r\n        }\r\n    }\r\n    _render_final(config, url) {\r\n        // get previous view in the same slot\r\n        let slot = null;\r\n        let container = null;\r\n        let show = false;\r\n        if (!this._container.tagName) {\r\n            slot = this._container;\r\n            if (slot.popup) {\r\n                container = document.body;\r\n                show = true;\r\n            }\r\n            else {\r\n                container = this.webix.$$(slot.id);\r\n            }\r\n        }\r\n        else {\r\n            container = this._container;\r\n        }\r\n        // view already destroyed\r\n        if (!this.app || !container) {\r\n            return Promise.reject(null);\r\n        }\r\n        let response;\r\n        const current = this._segment.current();\r\n        // using wrapper object, so ui can be changed from app:render event\r\n        const result = { ui: {} };\r\n        this.app.copyConfig(config, result.ui, this._subs);\r\n        this.app.callEvent(\"app:render\", [this, url, result]);\r\n        result.ui.$scope = this;\r\n        /* destroy old HTML attached views before creating new one */\r\n        if (!slot && current.isNew && current.view) {\r\n            current.view.destructor();\r\n        }\r\n        try {\r\n            // special handling for adding inside of multiview - preserve old id\r\n            if (slot && !show) {\r\n                const oldui = container;\r\n                const parent = oldui.getParentView();\r\n                if (parent && parent.name === \"multiview\" && !result.ui.id) {\r\n                    result.ui.id = oldui.config.id;\r\n                }\r\n            }\r\n            this._root = this.app.webix.ui(result.ui, container);\r\n            const asWin = this._root;\r\n            // check for url added to ignore this.ui calls\r\n            if (show && asWin.setPosition && !asWin.isVisible()) {\r\n                asWin.show();\r\n            }\r\n            // check, if we are replacing some older view\r\n            if (slot) {\r\n                if (slot.view && slot.view !== this && slot.view !== this.app) {\r\n                    slot.view.destructor();\r\n                }\r\n                slot.id = this._root.config.id;\r\n                if (this.getParentView() || !this.app.app)\r\n                    slot.view = this;\r\n                else {\r\n                    // when we have subapp, set whole app as a view\r\n                    // so on destruction, the whole app will be destroyed\r\n                    slot.view = this.app;\r\n                }\r\n            }\r\n            if (current.isNew) {\r\n                current.view = this;\r\n                current.isNew = false;\r\n            }\r\n            response = Promise.resolve(this._init(this._root, url)).then(() => {\r\n                return this._urlChange().then(() => {\r\n                    this._initUrl = null;\r\n                    return this.ready(this._root, url.suburl());\r\n                });\r\n            });\r\n        }\r\n        catch (e) {\r\n            response = Promise.reject(e);\r\n        }\r\n        return response.catch(err => this._initError(this, err));\r\n    }\r\n    _init(view, url) {\r\n        return this.init(view, url.suburl());\r\n    }\r\n    _urlChange() {\r\n        this.app.callEvent(\"app:urlchange\", [this, this._segment]);\r\n        const waits = [];\r\n        for (const key in this._subs) {\r\n            const frame = this._subs[key];\r\n            const wait = this._renderFrameLock(key, frame, null);\r\n            if (wait) {\r\n                waits.push(wait);\r\n            }\r\n        }\r\n        return Promise.all(waits).then(() => {\r\n            return this.urlChange(this._root, this._segment.suburl());\r\n        });\r\n    }\r\n    _renderFrameLock(key, frame, path) {\r\n        // if subview is not occupied by some rendering yet\r\n        if (!frame.lock) {\r\n            // retreive and store rendering end promise\r\n            const lock = this._renderFrame(key, frame, path);\r\n            if (lock) {\r\n                // clear lock after frame rendering\r\n                // as promise.finally is not supported by  Webix lesser than 6.2\r\n                // using a more verbose notation\r\n                frame.lock = lock.then(() => frame.lock = null, () => frame.lock = null);\r\n            }\r\n        }\r\n        // return rendering end promise\r\n        return frame.lock;\r\n    }\r\n    _renderFrame(key, frame, path) {\r\n        //default route\r\n        if (key === \"default\") {\r\n            if (this._segment.next()) {\r\n                // we have a next segment in url, render it\r\n                let params = path ? path.params : null;\r\n                if (frame.params) {\r\n                    params = this.webix.extend(params || {}, frame.params);\r\n                }\r\n                return this._createSubView(frame, this._segment.shift(params));\r\n            }\r\n            else if (frame.view && frame.popup) {\r\n                // there is no next segment, delete the existing sub-view\r\n                frame.view.destructor();\r\n                frame.view = null;\r\n            }\r\n        }\r\n        //if new path provided, set it to the frame\r\n        if (path !== null) {\r\n            frame.url = path.url;\r\n            if (frame.params) {\r\n                path.params = this.webix.extend(path.params || {}, frame.params);\r\n            }\r\n        }\r\n        // in case of routed sub-view\r\n        if (frame.route) {\r\n            // we have a new path for sub-view\r\n            if (path !== null) {\r\n                return frame.route.show(path, frame.view).then(() => {\r\n                    return this._createSubView(frame, frame.route);\r\n                });\r\n            }\r\n            // do not trigger onChange for isolated sub-views\r\n            if (frame.branch) {\r\n                return;\r\n            }\r\n        }\r\n        let view = frame.view;\r\n        // if view doesn't exists yet, init it\r\n        if (!view && frame.url) {\r\n            if (typeof frame.url === \"string\") {\r\n                // string, so we have isolated subview url\r\n                frame.route = new Route(frame.url, 0);\r\n                if (path)\r\n                    frame.route.setParams(frame.route.route.url, path.params, 0);\r\n                if (frame.params)\r\n                    frame.route.setParams(frame.route.route.url, frame.params, 0);\r\n                return this._createSubView(frame, frame.route);\r\n            }\r\n            else {\r\n                // object, so we have an embeded subview\r\n                if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\r\n                    view = new (this.app._override(frame.url))(this.app, \"\");\r\n                }\r\n                if (!view) {\r\n                    view = frame.url;\r\n                }\r\n            }\r\n        }\r\n        // trigger onChange for already existed view\r\n        if (view) {\r\n            return view.render(frame, (frame.route || this._segment), this);\r\n        }\r\n    }\r\n    _initError(view, err) {\r\n        /*\r\n            if view is destroyed, ignore any view related errors\r\n        */\r\n        if (this.app) {\r\n            this.app.error(\"app:error:initview\", [err, view]);\r\n        }\r\n        return true;\r\n    }\r\n    _createSubView(sub, suburl) {\r\n        return this.app.createFromURL(suburl.current()).then(view => {\r\n            return view.render(sub, suburl, this);\r\n        });\r\n    }\r\n    _destroyKids() {\r\n        // destroy child views\r\n        const uis = this._children;\r\n        for (let i = uis.length - 1; i >= 0; i--) {\r\n            if (uis[i] && uis[i].destructor) {\r\n                uis[i].destructor();\r\n            }\r\n        }\r\n        // reset vars for better GC processing\r\n        this._children = [];\r\n    }\r\n}\n\n// wrapper for raw objects and Jet 1.x structs\r\nclass JetViewRaw extends JetView {\r\n    constructor(app, config) {\r\n        super(app, config);\r\n        this._ui = config.ui;\r\n    }\r\n    config() {\r\n        return this._ui;\r\n    }\r\n}\n\nclass SubRouter {\r\n    constructor(cb, config, app) {\r\n        this.path = \"\";\r\n        this.app = app;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        const a = this.app;\r\n        a.app.getRouter().set(a._segment.append(this.path), { silent: true });\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nlet _once = true;\r\nclass JetAppBase extends JetBase {\r\n    constructor(config) {\r\n        const webix = (config || {}).webix || window.webix;\r\n        config = webix.extend({\r\n            name: \"App\",\r\n            version: \"1.0\",\r\n            start: \"/home\"\r\n        }, config, true);\r\n        super(webix, config);\r\n        this.config = config;\r\n        this.app = this.config.app;\r\n        this.ready = Promise.resolve();\r\n        this._services = {};\r\n        this.webix.extend(this, this.webix.EventSystem);\r\n    }\r\n    getUrl() {\r\n        return this._subSegment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._subSegment.toString();\r\n    }\r\n    getService(name) {\r\n        let obj = this._services[name];\r\n        if (typeof obj === \"function\") {\r\n            obj = this._services[name] = obj(this);\r\n        }\r\n        return obj;\r\n    }\r\n    setService(name, handler) {\r\n        this._services[name] = handler;\r\n    }\r\n    destructor() {\r\n        this.getSubView().destructor();\r\n        super.destructor();\r\n    }\r\n    // copy object and collect extra handlers\r\n    copyConfig(obj, target, config) {\r\n        // raw ui config\r\n        if (obj instanceof JetBase ||\r\n            (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\r\n            obj = { $subview: obj };\r\n        }\r\n        // subview placeholder\r\n        if (typeof obj.$subview != \"undefined\") {\r\n            return this.addSubView(obj, target, config);\r\n        }\r\n        // process sub-properties\r\n        const isArray = obj instanceof Array;\r\n        target = target || (isArray ? [] : {});\r\n        for (const method in obj) {\r\n            let point = obj[method];\r\n            // view class\r\n            if (typeof point === \"function\" && point.prototype instanceof JetBase) {\r\n                point = { $subview: point };\r\n            }\r\n            if (point && typeof point === \"object\" &&\r\n                !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\r\n                if (point instanceof Date) {\r\n                    target[method] = new Date(point);\r\n                }\r\n                else {\r\n                    const copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\r\n                    if (copy !== null) {\r\n                        if (isArray)\r\n                            target.push(copy);\r\n                        else\r\n                            target[method] = copy;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                target[method] = point;\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n    getRouter() {\r\n        return this.$router;\r\n    }\r\n    clickHandler(e, target) {\r\n        if (e) {\r\n            target = target || (e.target || e.srcElement);\r\n            if (target && target.getAttribute) {\r\n                const trigger = target.getAttribute(\"trigger\");\r\n                if (trigger) {\r\n                    this._forView(target, view => view.app.trigger(trigger));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n                const route = target.getAttribute(\"route\");\r\n                if (route) {\r\n                    this._forView(target, view => view.show(route));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n            }\r\n        }\r\n        const parent = target.parentNode;\r\n        if (parent) {\r\n            this.clickHandler(e, parent);\r\n        }\r\n    }\r\n    getRoot() {\r\n        return this.getSubView().getRoot();\r\n    }\r\n    refresh() {\r\n        if (!this._subSegment) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return this.getSubView().refresh().then(view => {\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return view;\r\n        });\r\n    }\r\n    loadView(url) {\r\n        const views = this.config.views;\r\n        let result = null;\r\n        if (url === \"\") {\r\n            return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\r\n        }\r\n        try {\r\n            if (views) {\r\n                if (typeof views === \"function\") {\r\n                    // custom loading strategy\r\n                    result = views(url);\r\n                }\r\n                else {\r\n                    // predefined hash\r\n                    result = views[url];\r\n                }\r\n                if (typeof result === \"string\") {\r\n                    url = result;\r\n                    result = null;\r\n                }\r\n            }\r\n            if (!result) {\r\n                if (url === \"_hidden\") {\r\n                    result = { hidden: true };\r\n                }\r\n                else if (url === \"_blank\") {\r\n                    result = {};\r\n                }\r\n                else {\r\n                    url = url.replace(/\\./g, \"/\");\r\n                    result = this.require(\"jet-views\", url);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            result = this._loadError(url, e);\r\n        }\r\n        // custom handler can return view or its promise\r\n        if (!result.then) {\r\n            result = Promise.resolve(result);\r\n        }\r\n        // set error handler\r\n        result = result\r\n            .then(module => module.__esModule ? module.default : module)\r\n            .catch(err => this._loadError(url, err));\r\n        return result;\r\n    }\r\n    _forView(target, handler) {\r\n        const view = this.webix.$$(target);\r\n        if (view) {\r\n            handler(view.$scope);\r\n        }\r\n    }\r\n    _loadViewDynamic(url) {\r\n        return null;\r\n    }\r\n    createFromURL(chunk) {\r\n        let view;\r\n        if (chunk.isNew || !chunk.view) {\r\n            view = this.loadView(chunk.page)\r\n                .then(ui => this.createView(ui, name, chunk.params));\r\n        }\r\n        else {\r\n            view = Promise.resolve(chunk.view);\r\n        }\r\n        return view;\r\n    }\r\n    _override(ui) {\r\n        const over = this.config.override;\r\n        if (over) {\r\n            let dv;\r\n            while (ui) {\r\n                dv = ui;\r\n                ui = over.get(ui);\r\n            }\r\n            return dv;\r\n        }\r\n        return ui;\r\n    }\r\n    createView(ui, name, params) {\r\n        ui = this._override(ui);\r\n        let obj;\r\n        if (typeof ui === \"function\") {\r\n            if (ui.prototype instanceof JetAppBase) {\r\n                // UI class\r\n                return new ui({ app: this, name, params, router: SubRouter });\r\n            }\r\n            else if (ui.prototype instanceof JetBase) {\r\n                // UI class\r\n                return new ui(this, { name, params });\r\n            }\r\n            else {\r\n                // UI factory functions\r\n                ui = ui(this);\r\n            }\r\n        }\r\n        if (ui instanceof JetBase) {\r\n            obj = ui;\r\n        }\r\n        else {\r\n            // UI object\r\n            obj = new JetViewRaw(this, { name, ui });\r\n        }\r\n        return obj;\r\n    }\r\n    // show view path\r\n    show(url, config) {\r\n        if (url && this.app && url.indexOf(\"//\") == 0)\r\n            return this.app.show(url.substr(1), config);\r\n        return this.render(this._container, url || this.config.start, config);\r\n    }\r\n    // event helpers\r\n    trigger(name, ...rest) {\r\n        this.apply(name, rest);\r\n    }\r\n    apply(name, data) {\r\n        this.callEvent(name, data);\r\n    }\r\n    action(name) {\r\n        return this.webix.bind(function (...rest) {\r\n            this.apply(name, rest);\r\n        }, this);\r\n    }\r\n    on(name, handler) {\r\n        this.attachEvent(name, handler);\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this, null, config);\r\n    }\r\n    error(name, er) {\r\n        this.callEvent(name, er);\r\n        this.callEvent(\"app:error\", er);\r\n        /* tslint:disable */\r\n        if (this.config.debug) {\r\n            for (var i = 0; i < er.length; i++) {\r\n                console.error(er[i]);\r\n                if (er[i] instanceof Error) {\r\n                    let text = er[i].message;\r\n                    if (text.indexOf(\"Module build failed\") === 0) {\r\n                        text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\r\n                        document.body.innerHTML = `<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${text}</pre>`;\r\n                    }\r\n                    else {\r\n                        text += \"<br><br>Check console for more details\";\r\n                        this.webix.message({ type: \"error\", text: text, expire: -1 });\r\n                    }\r\n                }\r\n            }\r\n            debugger;\r\n        }\r\n        /* tslint:enable */\r\n    }\r\n    // renders top view\r\n    render(root, url, config) {\r\n        this._container = (typeof root === \"string\") ?\r\n            this.webix.toNode(root) :\r\n            (root || document.body);\r\n        const firstInit = !this.$router;\r\n        let path = null;\r\n        if (firstInit) {\r\n            if (_once && \"tagName\" in this._container) {\r\n                this.webix.event(document.body, \"click\", e => this.clickHandler(e));\r\n                _once = false;\r\n            }\r\n            if (typeof url === \"string\") {\r\n                url = new Route(url, 0);\r\n            }\r\n            this._subSegment = this._first_start(url);\r\n            this._subSegment.route.linkRouter = true;\r\n        }\r\n        else {\r\n            if (typeof url === \"string\") {\r\n                path = url;\r\n            }\r\n            else {\r\n                if (this.app) {\r\n                    path = url.split().route.path || this.config.start;\r\n                }\r\n                else {\r\n                    path = url.toString();\r\n                }\r\n            }\r\n        }\r\n        const params = config ? config.params : this.config.params || null;\r\n        const top = this.getSubView();\r\n        const segment = this._subSegment;\r\n        const ready = segment\r\n            .show({ url: path, params }, top)\r\n            .then(() => this.createFromURL(segment.current()))\r\n            .then(view => view.render(root, segment))\r\n            .then(base => {\r\n            this.$router.set(segment.route.path, { silent: true });\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return base;\r\n        });\r\n        this.ready = this.ready.then(() => ready);\r\n        return ready;\r\n    }\r\n    getSubView() {\r\n        if (this._subSegment) {\r\n            const view = this._subSegment.current().view;\r\n            if (view)\r\n                return view;\r\n        }\r\n        return new JetView(this, {});\r\n    }\r\n    require(type, url) { return null; }\r\n    _first_start(route) {\r\n        this._segment = route;\r\n        const cb = (a) => setTimeout(() => {\r\n            this.show(a).catch(e => {\r\n                if (!(e instanceof NavigationBlocked))\r\n                    throw e;\r\n            });\r\n        }, 1);\r\n        this.$router = new (this.config.router)(cb, this.config, this);\r\n        // start animation for top-level app\r\n        if (this._container === document.body && this.config.animation !== false) {\r\n            const node = this._container;\r\n            this.webix.html.addCss(node, \"webixappstart\");\r\n            setTimeout(() => {\r\n                this.webix.html.removeCss(node, \"webixappstart\");\r\n                this.webix.html.addCss(node, \"webixapp\");\r\n            }, 10);\r\n        }\r\n        if (!route) {\r\n            // if no url defined, check router first\r\n            let urlString = this.$router.get();\r\n            if (!urlString) {\r\n                urlString = this.config.start;\r\n                this.$router.set(urlString, { silent: true });\r\n            }\r\n            route = new Route(urlString, 0);\r\n        }\r\n        else if (this.app) {\r\n            const now = route.current().view;\r\n            route.current().view = this;\r\n            if (route.next()) {\r\n                route.refresh();\r\n                route = route.split();\r\n            }\r\n            else {\r\n                route = new Route(this.config.start, 0);\r\n            }\r\n            route.current().view = now;\r\n        }\r\n        return route;\r\n    }\r\n    // error during view resolving\r\n    _loadError(url, err) {\r\n        this.error(\"app:error:resolve\", [err, url]);\r\n        return { template: \" \" };\r\n    }\r\n    addSubView(obj, target, config) {\r\n        const url = obj.$subview !== true ? obj.$subview : null;\r\n        const name = obj.name || (url ? this.webix.uid() : \"default\");\r\n        target.id = obj.id || \"s\" + this.webix.uid();\r\n        const view = config[name] = {\r\n            id: target.id,\r\n            url,\r\n            branch: obj.branch,\r\n            popup: obj.popup,\r\n            params: obj.params\r\n        };\r\n        return view.popup ? null : target;\r\n    }\r\n}\n\nclass HashRouter {\r\n    constructor(cb, config) {\r\n        this.config = config || {};\r\n        this._detectPrefix();\r\n        this.cb = cb;\r\n        window.onpopstate = () => this.cb(this.get());\r\n    }\r\n    set(path, config) {\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            for (const key in this.config.routes) {\r\n                if (this.config.routes[key] === compare[0]) {\r\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this.get() !== path) {\r\n            window.history.pushState(null, null, this.prefix + this.sufix + path);\r\n        }\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        let path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\r\n        path = (path !== \"/\" && path !== \"#\") ? path : \"\";\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            const key = this.config.routes[compare[0]];\r\n            if (key) {\r\n                path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n            }\r\n        }\r\n        return path;\r\n    }\r\n    _detectPrefix() {\r\n        // use \"#!\" for backward compatibility\r\n        const sufix = this.config.routerPrefix;\r\n        this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\r\n        this.prefix = document.location.href.split(\"#\", 2)[0];\r\n    }\r\n    _getRaw() {\r\n        return document.location.href;\r\n    }\r\n}\n\nlet isPatched = false;\r\nfunction patch(w) {\r\n    if (isPatched || !w) {\r\n        return;\r\n    }\r\n    isPatched = true;\r\n    // custom promise for IE8\r\n    const win = window;\r\n    if (!win.Promise) {\r\n        win.Promise = w.promise;\r\n    }\r\n    const version = w.version.split(\".\");\r\n    // will be fixed in webix 5.3\r\n    if (version[0] * 10 + version[1] * 1 < 53) {\r\n        w.ui.freeze = function (handler) {\r\n            // disabled because webix jet 5.0 can't handle resize of scrollview correctly\r\n            // w.ui.$freeze = true;\r\n            const res = handler();\r\n            if (res && res.then) {\r\n                res.then(function (some) {\r\n                    w.ui.$freeze = false;\r\n                    w.ui.resize();\r\n                    return some;\r\n                });\r\n            }\r\n            else {\r\n                w.ui.$freeze = false;\r\n                w.ui.resize();\r\n            }\r\n            return res;\r\n        };\r\n    }\r\n    // adding views as classes\r\n    const baseAdd = w.ui.baselayout.prototype.addView;\r\n    const baseRemove = w.ui.baselayout.prototype.removeView;\r\n    const config = {\r\n        addView(view, index) {\r\n            // trigger logic only for widgets inside of jet-view\r\n            // ignore case when addView used with already initialized widget\r\n            if (this.$scope && this.$scope.webixJet && !view.queryView) {\r\n                const jview = this.$scope;\r\n                const subs = {};\r\n                view = jview.app.copyConfig(view, {}, subs);\r\n                baseAdd.apply(this, [view, index]);\r\n                for (const key in subs) {\r\n                    jview._renderFrame(key, subs[key], null).then(() => {\r\n                        jview._subs[key] = subs[key];\r\n                    });\r\n                }\r\n                return view.id;\r\n            }\r\n            else {\r\n                return baseAdd.apply(this, arguments);\r\n            }\r\n        },\r\n        removeView() {\r\n            baseRemove.apply(this, arguments);\r\n            if (this.$scope && this.$scope.webixJet) {\r\n                const subs = this.$scope._subs;\r\n                // check all sub-views, destroy and clean the removed one\r\n                for (const key in subs) {\r\n                    const test = subs[key];\r\n                    if (!w.$$(test.id)) {\r\n                        test.view.destructor();\r\n                        delete subs[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    w.extend(w.ui.layout.prototype, config, true);\r\n    w.extend(w.ui.baselayout.prototype, config, true);\r\n    // wrapper for using Jet Apps as views\r\n    w.protoUI({\r\n        name: \"jetapp\",\r\n        $init(cfg) {\r\n            this.$app = new this.app(cfg);\r\n            const id = w.uid().toString();\r\n            cfg.body = { id };\r\n            this.$ready.push(function () {\r\n                this.callEvent(\"onInit\", [this.$app]);\r\n                this.$app.render({ id });\r\n            });\r\n        }\r\n    }, w.ui.proxy, w.EventSystem);\r\n}\n\nclass JetApp extends JetAppBase {\r\n    constructor(config) {\r\n        config.router = config.router || HashRouter;\r\n        super(config);\r\n        patch(this.webix);\r\n    }\r\n    require(type, url) {\r\n        return require(type + \"/\" + url);\r\n    }\r\n}\n\nclass StoreRouter {\r\n    constructor(cb, config, app) {\r\n        this.storage = config.storage || app.webix.storage.session;\r\n        this.name = (config.storeName || config.id + \":route\");\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.storage.put(this.name, path);\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.storage.get(this.name);\r\n    }\r\n}\n\nclass UrlRouter extends HashRouter {\r\n    _detectPrefix() {\r\n        this.prefix = \"\";\r\n        this.sufix = this.config.routerPrefix || \"\";\r\n    }\r\n    _getRaw() {\r\n        return document.location.pathname + (document.location.search || \"\");\r\n    }\r\n}\n\nclass EmptyRouter {\r\n    constructor(cb, _$config) {\r\n        this.path = \"\";\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nfunction UnloadGuard(app, view, config) {\r\n    view.on(app, `app:guard`, function (_$url, point, promise) {\r\n        if (point === view || point.contains(view)) {\r\n            const res = config();\r\n            if (res === false) {\r\n                promise.confirm = Promise.reject(new NavigationBlocked());\r\n            }\r\n            else {\r\n                promise.confirm = promise.confirm.then(() => res);\r\n            }\r\n        }\r\n    });\r\n}\n\n//     (c) 2012-2018 Airbnb, Inc.\n\n// var has = require('has');\nfunction has(store, key) {\n  return Object.prototype.hasOwnProperty.call(store, key);\n}\n// var forEach = require('for-each');\nfunction forEach(obj, handler, context) {\n  for (var key in obj) {\n    if (has(obj, key)) {\n      handler.call((context || obj), obj[key], key, obj);\n    }\n  }\n}\n// var trim = require('string.prototype.trim');\nfunction trim(str) {\n  return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n}\n// var warning = require('warning');\nfunction warn(message) {\n  message = 'Warning: ' + message;\n  if (typeof console !== 'undefined') {\n    console.error(message);\n  }\n\n  try { throw new Error(message); } catch (x) {}\n}\n\nvar replace = String.prototype.replace;\nvar split = String.prototype.split;\n\n// #### Pluralization methods\n// The string that separates the different phrase possibilities.\nvar delimiter = '||||';\n\nvar russianPluralGroups = function (n) {\n  var end = n % 10;\n  if (n !== 11 && end === 1) {\n    return 0;\n  }\n  if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n    return 1;\n  }\n  return 2;\n};\n\n// Mapping from pluralization group plural logic.\nvar pluralTypes = {\n  arabic: function (n) {\n    // http://www.arabeyes.org/Plural_Forms\n    if (n < 3) { return n; }\n    var lastTwo = n % 100;\n    if (lastTwo >= 3 && lastTwo <= 10) return 3;\n    return lastTwo >= 11 ? 4 : 5;\n  },\n  bosnian_serbian: russianPluralGroups,\n  chinese: function () { return 0; },\n  croatian: russianPluralGroups,\n  french: function (n) { return n > 1 ? 1 : 0; },\n  german: function (n) { return n !== 1 ? 1 : 0; },\n  russian: russianPluralGroups,\n  lithuanian: function (n) {\n    if (n % 10 === 1 && n % 100 !== 11) { return 0; }\n    return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n  },\n  czech: function (n) {\n    if (n === 1) { return 0; }\n    return (n >= 2 && n <= 4) ? 1 : 2;\n  },\n  polish: function (n) {\n    if (n === 1) { return 0; }\n    var end = n % 10;\n    return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n  },\n  icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n  slovenian: function (n) {\n    var lastTwo = n % 100;\n    if (lastTwo === 1) {\n      return 0;\n    }\n    if (lastTwo === 2) {\n      return 1;\n    }\n    if (lastTwo === 3 || lastTwo === 4) {\n      return 2;\n    }\n    return 3;\n  }\n};\n\n\n// Mapping from pluralization group to individual language codes/locales.\n// Will look up based on exact match, if not found and it's a locale will parse the locale\n// for language code, and if that does not exist will default to 'en'\nvar pluralTypeToLanguages = {\n  arabic: ['ar'],\n  bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n  chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n  croatian: ['hr', 'hr-HR'],\n  german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n  french: ['fr', 'tl', 'pt-br'],\n  russian: ['ru', 'ru-RU'],\n  lithuanian: ['lt'],\n  czech: ['cs', 'cs-CZ', 'sk'],\n  polish: ['pl'],\n  icelandic: ['is'],\n  slovenian: ['sl-SL']\n};\n\nfunction langToTypeMap(mapping) {\n  var ret = {};\n  forEach(mapping, function (langs, type) {\n    forEach(langs, function (lang) {\n      ret[lang] = type;\n    });\n  });\n  return ret;\n}\n\nfunction pluralTypeName(locale) {\n  var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n  return langToPluralType[locale]\n    || langToPluralType[split.call(locale, /-/, 1)[0]]\n    || langToPluralType.en;\n}\n\nfunction pluralTypeIndex(locale, count) {\n  return pluralTypes[pluralTypeName(locale)](count);\n}\n\nfunction escape(token) {\n  return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction constructTokenRegex(opts) {\n  var prefix = (opts && opts.prefix) || '%{';\n  var suffix = (opts && opts.suffix) || '}';\n\n  if (prefix === delimiter || suffix === delimiter) {\n    throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n  }\n\n  return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n}\n\nvar dollarRegex = /\\$/g;\nvar dollarBillsYall = '$$';\nvar defaultTokenRegex = /%\\{(.*?)\\}/g;\n\n// ### transformPhrase(phrase, substitutions, locale)\n//\n// Takes a phrase string and transforms it by choosing the correct\n// plural form and interpolating it.\n//\n//     transformPhrase('Hello, %{name}!', {name: 'Spike'});\n//     // \"Hello, Spike!\"\n//\n// The correct plural form is selected if substitutions.smart_count\n// is set. You can pass in a number instead of an Object as `substitutions`\n// as a shortcut for `smart_count`.\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 1}, 'en');\n//     // \"1 new message\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 2}, 'en');\n//     // \"2 new messages\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', 5, 'en');\n//     // \"5 new messages\"\n//\n// You should pass in a third argument, the locale, to specify the correct plural type.\n// It defaults to `'en'` with 2 plural forms.\nfunction transformPhrase(phrase, substitutions, locale, tokenRegex) {\n  if (typeof phrase !== 'string') {\n    throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n  }\n\n  if (substitutions == null) {\n    return phrase;\n  }\n\n  var result = phrase;\n  var interpolationRegex = tokenRegex || defaultTokenRegex;\n\n  // allow number as a pluralization shortcut\n  var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n\n  // Select plural form: based on a phrase text that contains `n`\n  // plural forms separated by `delimiter`, a `locale`, and a `substitutions.smart_count`,\n  // choose the correct plural form. This is only done if `count` is set.\n  if (options.smart_count != null && result) {\n    var texts = split.call(result, delimiter);\n    result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n  }\n\n  // Interpolate: Creates a `RegExp` object for each interpolation placeholder.\n  result = replace.call(result, interpolationRegex, function (expression, argument) {\n    if (!has(options, argument) || options[argument] == null) { return expression; }\n    // Ensure replacement value is escaped to prevent special $-prefixed regex replace tokens.\n    return replace.call(options[argument], dollarRegex, dollarBillsYall);\n  });\n\n  return result;\n}\n\n// ### Polyglot class constructor\nfunction Polyglot(options) {\n  var opts = options || {};\n  this.phrases = {};\n  this.extend(opts.phrases || {});\n  this.currentLocale = opts.locale || 'en';\n  var allowMissing = opts.allowMissing ? transformPhrase : null;\n  this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n  this.warn = opts.warn || warn;\n  this.tokenRegex = constructTokenRegex(opts.interpolation);\n}\n\n// ### polyglot.locale([locale])\n//\n// Get or set locale. Internally, Polyglot only uses locale for pluralization.\nPolyglot.prototype.locale = function (newLocale) {\n  if (newLocale) this.currentLocale = newLocale;\n  return this.currentLocale;\n};\n\n// ### polyglot.extend(phrases)\n//\n// Use `extend` to tell Polyglot how to translate a given key.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The key can be any string.  Feel free to call `extend` multiple times;\n// it will override any phrases with the same key, but leave existing phrases\n// untouched.\n//\n// It is also possible to pass nested phrase objects, which get flattened\n// into an object with the nested keys concatenated using dot notation.\n//\n//     polyglot.extend({\n//       \"nav\": {\n//         \"hello\": \"Hello\",\n//         \"hello_name\": \"Hello, %{name}\",\n//         \"sidebar\": {\n//           \"welcome\": \"Welcome\"\n//         }\n//       }\n//     });\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}',\n//     //   'nav.sidebar.welcome': 'Welcome'\n//     // }\n//\n// `extend` accepts an optional second argument, `prefix`, which can be used\n// to prefix every key in the phrases object with some string, using dot\n// notation.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     }, \"nav\");\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}'\n//     // }\n//\n// This feature is used internally to support nested phrase objects.\nPolyglot.prototype.extend = function (morePhrases, prefix) {\n  forEach(morePhrases, function (phrase, key) {\n    var prefixedKey = prefix ? prefix + '.' + key : key;\n    if (typeof phrase === 'object') {\n      this.extend(phrase, prefixedKey);\n    } else {\n      this.phrases[prefixedKey] = phrase;\n    }\n  }, this);\n};\n\n// ### polyglot.unset(phrases)\n// Use `unset` to selectively remove keys from a polyglot instance.\n//\n//     polyglot.unset(\"some_key\");\n//     polyglot.unset({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The unset method can take either a string (for the key), or an object hash with\n// the keys that you would like to unset.\nPolyglot.prototype.unset = function (morePhrases, prefix) {\n  if (typeof morePhrases === 'string') {\n    delete this.phrases[morePhrases];\n  } else {\n    forEach(morePhrases, function (phrase, key) {\n      var prefixedKey = prefix ? prefix + '.' + key : key;\n      if (typeof phrase === 'object') {\n        this.unset(phrase, prefixedKey);\n      } else {\n        delete this.phrases[prefixedKey];\n      }\n    }, this);\n  }\n};\n\n// ### polyglot.clear()\n//\n// Clears all phrases. Useful for special cases, such as freeing\n// up memory if you have lots of phrases but no longer need to\n// perform any translation. Also used internally by `replace`.\nPolyglot.prototype.clear = function () {\n  this.phrases = {};\n};\n\n// ### polyglot.replace(phrases)\n//\n// Completely replace the existing phrases with a new set of phrases.\n// Normally, just use `extend` to add more phrases, but under certain\n// circumstances, you may want to make sure no old phrases are lying around.\nPolyglot.prototype.replace = function (newPhrases) {\n  this.clear();\n  this.extend(newPhrases);\n};\n\n\n// ### polyglot.t(key, options)\n//\n// The most-used method. Provide a key, and `t` will return the\n// phrase.\n//\n//     polyglot.t(\"hello\");\n//     => \"Hello\"\n//\n// The phrase value is provided first by a call to `polyglot.extend()` or\n// `polyglot.replace()`.\n//\n// Pass in an object as the second argument to perform interpolation.\n//\n//     polyglot.t(\"hello_name\", {name: \"Spike\"});\n//     => \"Hello, Spike\"\n//\n// If you like, you can provide a default value in case the phrase is missing.\n// Use the special option key \"_\" to specify a default.\n//\n//     polyglot.t(\"i_like_to_write_in_language\", {\n//       _: \"I like to write in %{language}.\",\n//       language: \"JavaScript\"\n//     });\n//     => \"I like to write in JavaScript.\"\n//\nPolyglot.prototype.t = function (key, options) {\n  var phrase, result;\n  var opts = options == null ? {} : options;\n  if (typeof this.phrases[key] === 'string') {\n    phrase = this.phrases[key];\n  } else if (typeof opts._ === 'string') {\n    phrase = opts._;\n  } else if (this.onMissingKey) {\n    var onMissingKey = this.onMissingKey;\n    result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n  } else {\n    this.warn('Missing translation for key: \"' + key + '\"');\n    result = key;\n  }\n  if (typeof phrase === 'string') {\n    result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n  }\n  return result;\n};\n\n\n// ### polyglot.has(key)\n//\n// Check if polyglot has a translation for given key\nPolyglot.prototype.has = function (key) {\n  return has(this.phrases, key);\n};\n\n// export transformPhrase\nPolyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n  return transformPhrase(phrase, substitutions, locale);\n};\n\nvar webixPolyglot = Polyglot;\n\nfunction Locale(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\r\n    function setLangData(name, data, silent) {\r\n        if (data.__esModule) {\r\n            data = data.default;\r\n        }\r\n        const pconfig = { phrases: data };\r\n        if (config.polyglot) {\r\n            app.webix.extend(pconfig, config.polyglot);\r\n        }\r\n        const poly = service.polyglot = new webixPolyglot(pconfig);\r\n        poly.locale(name);\r\n        service._ = app.webix.bind(poly.t, poly);\r\n        lang = name;\r\n        if (storage) {\r\n            storage.put(\"lang\", lang);\r\n        }\r\n        if (config.webix) {\r\n            const locName = config.webix[name];\r\n            if (locName) {\r\n                app.webix.i18n.setLocale(locName);\r\n            }\r\n        }\r\n        if (!silent) {\r\n            return app.refresh();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    function getLang() { return lang; }\r\n    function setLang(name, silent) {\r\n        // ignore setLang if loading by path is disabled\r\n        if (config.path === false) {\r\n            return;\r\n        }\r\n        const path = (config.path ? config.path + \"/\" : \"\") + name;\r\n        const data = app.require(\"jet-locales\", path);\r\n        setLangData(name, data, silent);\r\n    }\r\n    const service = {\r\n        getLang, setLang, setLangData, _: null, polyglot: null\r\n    };\r\n    app.setService(\"locale\", service);\r\n    setLang(lang, true);\r\n}\n\nfunction show(view, config, value) {\r\n    if (config.urls) {\r\n        value = config.urls[value] || value;\r\n    }\r\n    else if (config.param) {\r\n        value = { [config.param]: value };\r\n    }\r\n    view.show(value);\r\n}\r\nfunction Menu(app, view, config) {\r\n    const frame = view.getSubViewInfo().parent;\r\n    const ui = view.$$(config.id || config);\r\n    let silent = false;\r\n    ui.attachEvent(\"onchange\", function () {\r\n        if (!silent) {\r\n            show(frame, config, this.getValue());\r\n        }\r\n    });\r\n    ui.attachEvent(\"onafterselect\", function () {\r\n        if (!silent) {\r\n            let id = null;\r\n            if (ui.setValue) {\r\n                id = this.getValue();\r\n            }\r\n            else if (ui.getSelectedId) {\r\n                id = ui.getSelectedId();\r\n            }\r\n            show(frame, config, id);\r\n        }\r\n    });\r\n    view.on(app, `app:route`, function () {\r\n        let name = \"\";\r\n        if (config.param) {\r\n            name = view.getParam(config.param, true);\r\n        }\r\n        else {\r\n            const segment = frame.getUrl()[1];\r\n            if (segment) {\r\n                name = segment.page;\r\n            }\r\n        }\r\n        if (name) {\r\n            silent = true;\r\n            if (ui.setValue && ui.getValue() !== name) {\r\n                ui.setValue(name);\r\n            }\r\n            else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\r\n                ui.select(name);\r\n            }\r\n            silent = false;\r\n        }\r\n    });\r\n}\n\nconst baseicons = {\r\n    good: \"check\",\r\n    error: \"warning\",\r\n    saving: \"refresh fa-spin\"\r\n};\r\nconst basetext = {\r\n    good: \"Ok\",\r\n    error: \"Error\",\r\n    saving: \"Connecting...\"\r\n};\r\nfunction Status(app, view, config) {\r\n    let status = \"good\";\r\n    let count = 0;\r\n    let iserror = false;\r\n    let expireDelay = config.expire;\r\n    if (!expireDelay && expireDelay !== false) {\r\n        expireDelay = 2000;\r\n    }\r\n    const texts = config.texts || basetext;\r\n    const icons = config.icons || baseicons;\r\n    if (typeof config === \"string\") {\r\n        config = { target: config };\r\n    }\r\n    function refresh(content) {\r\n        const area = view.$$(config.target);\r\n        if (area) {\r\n            if (!content) {\r\n                content = \"<div class='status_\" +\r\n                    status +\r\n                    \"'><span class='webix_icon fa-\" +\r\n                    icons[status] + \"'></span> \" + texts[status] + \"</div>\";\r\n            }\r\n            area.setHTML(content);\r\n        }\r\n    }\r\n    function success() {\r\n        count--;\r\n        setStatus(\"good\");\r\n    }\r\n    function fail(err) {\r\n        count--;\r\n        setStatus(\"error\", err);\r\n    }\r\n    function start(promise) {\r\n        count++;\r\n        setStatus(\"saving\");\r\n        if (promise && promise.then) {\r\n            promise.then(success, fail);\r\n        }\r\n    }\r\n    function getStatus() {\r\n        return status;\r\n    }\r\n    function hideStatus() {\r\n        if (count === 0) {\r\n            refresh(\" \");\r\n        }\r\n    }\r\n    function setStatus(mode, err) {\r\n        if (count < 0) {\r\n            count = 0;\r\n        }\r\n        if (mode === \"saving\") {\r\n            status = \"saving\";\r\n            refresh();\r\n        }\r\n        else {\r\n            iserror = (mode === \"error\");\r\n            if (count === 0) {\r\n                status = iserror ? \"error\" : \"good\";\r\n                if (iserror) {\r\n                    app.error(\"app:error:server\", [err.responseText || err]);\r\n                }\r\n                else {\r\n                    if (expireDelay) {\r\n                        setTimeout(hideStatus, expireDelay);\r\n                    }\r\n                }\r\n                refresh();\r\n            }\r\n        }\r\n    }\r\n    function track(data) {\r\n        const dp = app.webix.dp(data);\r\n        if (dp) {\r\n            view.on(dp, \"onAfterDataSend\", start);\r\n            view.on(dp, \"onAfterSaveError\", (_id, _obj, response) => fail(response));\r\n            view.on(dp, \"onAfterSave\", success);\r\n        }\r\n    }\r\n    app.setService(\"status\", {\r\n        getStatus,\r\n        setStatus,\r\n        track\r\n    });\r\n    if (config.remote) {\r\n        view.on(app.webix, \"onRemoteCall\", start);\r\n    }\r\n    if (config.ajax) {\r\n        view.on(app.webix, \"onBeforeAjax\", (_mode, _url, _data, _request, _headers, _files, promise) => {\r\n            start(promise);\r\n        });\r\n    }\r\n    if (config.data) {\r\n        track(config.data);\r\n    }\r\n}\n\nfunction Theme(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let theme = storage ?\r\n        (storage.get(\"theme\") || \"flat-default\")\r\n        :\r\n            (config.theme || \"flat-default\");\r\n    const service = {\r\n        getTheme() { return theme; },\r\n        setTheme(name, silent) {\r\n            const parts = name.split(\"-\");\r\n            const links = document.getElementsByTagName(\"link\");\r\n            for (let i = 0; i < links.length; i++) {\r\n                const lname = links[i].getAttribute(\"title\");\r\n                if (lname) {\r\n                    if (lname === name || lname === parts[0]) {\r\n                        links[i].disabled = false;\r\n                    }\r\n                    else {\r\n                        links[i].disabled = true;\r\n                    }\r\n                }\r\n            }\r\n            app.webix.skin.set(parts[0]);\r\n            // remove old css\r\n            app.webix.html.removeCss(document.body, \"theme-\" + theme);\r\n            // add new css\r\n            app.webix.html.addCss(document.body, \"theme-\" + name);\r\n            theme = name;\r\n            if (storage) {\r\n                storage.put(\"theme\", name);\r\n            }\r\n            if (!silent) {\r\n                app.refresh();\r\n            }\r\n        }\r\n    };\r\n    app.setService(\"theme\", service);\r\n    service.setTheme(theme, true);\r\n}\n\nfunction copyParams(data, url, route) {\r\n    for (let i = 0; i < route.length; i++) {\r\n        data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\r\n    }\r\n}\r\nfunction UrlParam(app, view, config) {\r\n    const route = config.route || config;\r\n    const data = {};\r\n    view.on(app, \"app:urlchange\", function (subview, segment) {\r\n        if (view === subview) {\r\n            copyParams(data, segment.suburl(), route);\r\n            segment.size(route.length + 1);\r\n        }\r\n    });\r\n    const os = view.setParam;\r\n    const og = view.getParam;\r\n    view.setParam = function (name, value, show) {\r\n        const index = route.indexOf(name);\r\n        if (index >= 0) {\r\n            data[name] = value;\r\n            this._segment.update(\"\", value, index + 1);\r\n            if (show) {\r\n                return view.show(null);\r\n            }\r\n        }\r\n        else {\r\n            return os.call(this, name, value, show);\r\n        }\r\n    };\r\n    view.getParam = function (key, mode) {\r\n        const val = data[key];\r\n        if (typeof val !== \"undefined\") {\r\n            return val;\r\n        }\r\n        return og.call(this, key, mode);\r\n    };\r\n    copyParams(data, view.getUrl(), route);\r\n}\n\nfunction User(app, _view, config) {\r\n    config = config || {};\r\n    const login = config.login || \"/login\";\r\n    const logout = config.logout || \"/logout\";\r\n    const afterLogin = config.afterLogin || app.config.start;\r\n    const afterLogout = config.afterLogout || \"/login\";\r\n    const ping = config.ping || 5 * 60 * 1000;\r\n    const model = config.model;\r\n    let user = config.user;\r\n    const service = {\r\n        getUser() {\r\n            return user;\r\n        },\r\n        getStatus(server) {\r\n            if (!server) {\r\n                return user !== null;\r\n            }\r\n            return model.status().catch(() => null).then(data => {\r\n                user = data;\r\n            });\r\n        },\r\n        login(name, pass) {\r\n            return model.login(name, pass).then(data => {\r\n                user = data;\r\n                if (!data) {\r\n                    throw new Error(\"Access denied\");\r\n                }\r\n                app.callEvent(\"app:user:login\", [user]);\r\n                app.show(afterLogin);\r\n            });\r\n        },\r\n        logout() {\r\n            user = null;\r\n            return model.logout().then(res => {\r\n                app.callEvent(\"app:user:logout\", []);\r\n                return res;\r\n            });\r\n        }\r\n    };\r\n    function canNavigate(url, obj) {\r\n        if (url === logout) {\r\n            service.logout();\r\n            obj.redirect = afterLogout;\r\n        }\r\n        else if (url !== login && !service.getStatus()) {\r\n            obj.redirect = login;\r\n        }\r\n    }\r\n    app.setService(\"user\", service);\r\n    app.attachEvent(`app:guard`, function (url, _$root, obj) {\r\n        if (config.public && config.public(url)) {\r\n            return true;\r\n        }\r\n        if (typeof user === \"undefined\") {\r\n            obj.confirm = service.getStatus(true).then(() => canNavigate(url, obj));\r\n        }\r\n        return canNavigate(url, obj);\r\n    });\r\n    if (ping) {\r\n        setInterval(() => service.getStatus(true), ping);\r\n    }\r\n}\n\n/*\r\nMIT License\r\nCopyright (c) 2019 XB Software\r\n*/\r\nlet webix = window.webix;\r\nif (webix) {\r\n    patch(webix);\r\n}\r\nconst plugins = {\r\n    UnloadGuard, Locale, Menu, Theme, User, Status, UrlParam\r\n};\r\nconst errors = { NavigationBlocked };\r\nconst w = window;\r\nif (!w.Promise) {\r\n    w.Promise = w.webix.promise;\r\n}\n\nexport { plugins, errors, JetApp, JetView, HashRouter, StoreRouter, UrlRouter, EmptyRouter, SubRouter };\n//# sourceMappingURL=jet.js.map\n","let once = false;\n\nexport function initRLayout(){\n    if (once) return;\n    once = true;\n\n    webix.protoUI(\n        {\n            name: \"r-layout\",\n            sizeTrigger(app, handler, value) {\n                this._compactValue = value;\n                this._compactHandler = handler;\n                this._app = app;\n\n                const config = app.config;\n                this._forceCompact = typeof config.params.forceCompact !== \"undefined\";\n                this._compactWidth = config.compactWidth;\n\n                if (!this._forceCompact) this._checkTrigger(this.$view.width, value);\n            },\n            _checkTrigger(x, value) {\n                if (this._compactWidth) {\n                    if (\n                        (x <= this._compactWidth && !value) ||\n                        (x > this._compactWidth && value)\n                    ) {\n                        this._compactWidth = null;\n                        this._compactHandler(!value);\n                        return false;\n                    }\n                }\n                return true;\n            },\n            $setSize(x, y) {\n                if (this._forceCompact || this._checkTrigger(x, this._compactValue))\n                    webix.ui.layout.prototype.$setSize.call(this, x, y);\n                if (this._app) this._app.callEvent(\"view:resize\", []); //edit popup resize\n            },\n        },\n        webix.ui.layout\n    );\n}\n","export function initJetWin(app) {\n\tlet appId;\n\n\tconst service = {\n\t\tupdateConfig(config){\n\t\t\tconst appView = app.getRoot();\n\t\t\tconst appNode = appView.$view;\n\n\t\t\tif(!appId){\n\t\t\t\tif(appNode.id)\n\t\t\t\t\tappId = appNode.id;\n\t\t\t\telse \n\t\t\t\t\tappNode.id = appId = \"webix_\" + webix.uid();\n\n\t\t\t\twebix.html.addStyle(`.webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }`);\n\t\t\t\twebix.html.addStyle(`#${appId}{ position: relative; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_window{ z-index:2 !important; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_disabled{ z-index:1 !important; }`);\n\t\t\t}\n\t\t\telse if(appId && !appNode.id) //app refresh\n\t\t\t\tappNode.id = appId;\n\n\t\t\tconfig.container = appId;\n\n\t\t\tif(config.fullscreen){\n\t\t\t\tconfig._fillApp = true;\n\t\t\t\tdelete config.fullscreen;\n\t\t\t}\n\n\t\t\tif(!config.on)\n\t\t\t\tconfig.on = {};\n\n\t\t\tlet firstShow = true;\n\t\t\tconst defaultHandler = config.on.onShow;\n\n\t\t\tconfig.on.onShow = function(){\n\t\t\t\tif(defaultHandler)\n\t\t\t\t\tdefaultHandler.apply(this, arguments);\n\n\t\t\t\tif(firstShow){\n\t\t\t\t\tthis.$setSize = (x, y) => {\n\t\t\t\t\t\tsetSize(this, appView, true);\n\t\t\t\t\t\twebix.ui.window.prototype.$setSize.apply(this, [x, y]);\n\t\t\t\t\t};\n\t\t\t\t\tsetHandlers(this, app);\n\t\t\t\t\tfirstShow = null;\n\t\t\t\t}\n\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\twebix.html.addCss(appNode, \"webix_win_inside\");\n\t\t\t\tappView.disable();\n\n\t\t\t\tsetSize(this, appView);\n\t\t\t}\n\n\t\t\treturn config;\n\t\t}\n\t};\n\n\tapp.setService(\"jet-win\", service);\n}\n\nfunction setSize(win, appView, silent){\n\tconst appWidth = appView.$width;\n\tconst appHeight = appView.$height;\n\n\tif(win.config._fillApp)\n\t\twin.define({\n\t\t\twidth: appWidth,\n\t\t\theight: appHeight,\n\t\t});\n\telse {\n\t\twin.define({\n\t\t\tleft: (appWidth - win.$width) / 2,\n\t\t\ttop: (appHeight - win.$height) / 2,\n\t\t});\n\t}\n\n\tif(!silent)\n\t\twin.resize();\n}\n\nfunction setHandlers(win, app){\n\tconst appView = app.getRoot();\n\n\twin.attachEvent(\"onHide\", ()=> {\n\t\tif(!appView.$destructed){\n\t\t\twebix.html.removeCss(appView.$view, \"webix_win_inside\");\n\t\t\tappView.enable();\n\t\t}\n\t});\n\n\tconst resizeEv = app.attachEvent(\"view:resize\", ()=> {\n\t\tsetSize(win, appView);\n\t});\n\n\twin.attachEvent(\"onDestruct\", ()=> {\n\t\tapp.detachEvent(resizeEv);\n\t});\n}\n","var index = 1;\nfunction uid() {\n\treturn index++;\n}\n\nvar empty = undefined;\n\nexport function ignoreInitial(code) {\n\tlet init = false;\n\treturn function() {\n\t\tif (init) return code.apply(this, arguments);\n\t\telse init = true;\n\t};\n}\n\nvar context = null;\nexport function withContext(value, code) {\n\tcontext = value;\n\tcode();\n\tcontext = null;\n}\n\nexport function filter(rule, handler) {\n\treturn function(v, o, obj, meta) {\n\t\tif (rule(v, meta)) handler.apply(this, arguments);\n\t};\n}\n\nexport function link(source, target, key) {\n\tObject.defineProperty(target, key, {\n\t\tget: () => source[key],\n\t\tset: value => (source[key] = value),\n\t});\n}\n\nexport function debounce(handler, delay) {\n\tdelay = delay || 200;\n\tlet timer = null;\n\tlet data = null;\n\treturn function() {\n\t\tdata = arguments;\n\t\tif (!timer) {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = null;\n\n\t\t\t\thandler.apply(this, data);\n\t\t\t}, delay);\n\t\t}\n\t};\n}\n\nexport function createState(data, config) {\n\tconfig = config || {};\n\tconst handlers = {};\n\tconst out = {};\n\n\tconst observe = function(mask, handler) {\n\t\tconst key = uid();\n\t\thandlers[key] = { mask, handler };\n\t\tif (mask === \"*\") handler(out, empty, mask);\n\t\telse handler(out[mask], empty, mask);\n\n\t\treturn key;\n\t};\n\n\tconst extend = function(data, sconfig){\n\t\tsconfig = sconfig || config;\n\t\t// normal js object\n\t\tfor (const key in data) {\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tconst test = data[key];\n\t\t\t\tif (sconfig.nested && typeof test === \"object\" && test) {\n\t\t\t\t\tout[key] = createState(test, sconfig);\n\t\t\t\t} else {\n\t\t\t\t\treactive(out, test, key, notify);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst observeEnd = function(id) {\n\t\tdelete handlers[id];\n\t};\n\n\tconst queue = [];\n\tlet waitInQueue = false;\n\n\tvar batch = function(code) {\n\t\tif (typeof code !== \"function\") {\n\t\t\tconst values = code;\n\t\t\tcode = () => {\n\t\t\t\tfor (const key in values) out[key] = values[key];\n\t\t\t};\n\t\t}\n\n\t\twaitInQueue = true;\n\t\tcode(out);\n\t\twaitInQueue = false;\n\t\twhile (queue.length) {\n\t\t\tconst obj = queue.shift();\n\t\t\tnotify.apply(this, obj);\n\t\t}\n\t};\n\n\tconst notify = function(key, old, value, meta) {\n\t\tif (waitInQueue) {\n\t\t\tqueue.push([key, old, value, meta]);\n\t\t\treturn;\n\t\t}\n\n\t\tconst list = Object.keys(handlers);\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\tconst obj = handlers[list[i]];\n\t\t\tif (!obj) continue;\n\t\t\tif (obj.mask === \"*\" || obj.mask === key) {\n\t\t\t\tobj.handler(value, old, key, meta);\n\t\t\t}\n\t\t}\n\t};\n\n\tObject.defineProperty(out, \"$changes\", {\n\t\tvalue: {\n\t\t\tattachEvent: observe,\n\t\t\tdetachEvent: observeEnd,\n\t\t},\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$observe\", {\n\t\tvalue: observe,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$batch\", {\n\t\tvalue: batch,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$extend\", {\n\t\tvalue: extend,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\n\tout.$extend(data, config);\n\treturn out;\n}\n\nfunction reactive(obj, val, key, notify) {\n\tObject.defineProperty(obj, key, {\n\t\tget: function() {\n\t\t\treturn val;\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar changed = false;\n\t\t\tif (val === null || value === null) {\n\t\t\t\tchanged = val !== value;\n\t\t\t} else {\n\t\t\t\tchanged = val.valueOf() != value.valueOf();\n\t\t\t}\n\n\t\t\tif (changed) {\n\t\t\t\tvar old = val;\n\t\t\t\tval = value;\n\t\t\t\tnotify(key, old, value, context);\n\t\t\t}\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t});\n}","function updateDragPos(e, pos) {\n\tif (webix.DragControl.active) {\n\t\tconst node = webix.DragControl.getNode();\n\n\t\tpos = webix.copy(pos);\n\t\twebix.DragControl.$dragPos(pos, e);\n\n\t\tnode.style.top = pos.y + webix.DragControl.top + \"px\";\n\t\tnode.style.left = pos.x + webix.DragControl.left + \"px\";\n\t}\n}\n\nconst DragScroll = {\n\tstart(ctx, e) {\n\t\tctx._auto_scroll_delay = webix.delay(\n\t\t\tDragScroll.autoScroll,\n\t\t\tctx,\n\t\t\t[e, webix.html.pos(e)],\n\t\t\t250\n\t\t);\n\t},\n\n\treset(ctx) {\n\t\tif (ctx._auto_scroll_delay)\n\t\t\tctx._auto_scroll_delay = window.clearTimeout(ctx._auto_scroll_delay);\n\t},\n\n\tautoScroll(e, pos) {\n\t\tconst yScroll = this.direction.indexOf(\"y\") !== -1;\n\t\tconst xScroll = this.direction.indexOf(\"x\") !== -1;\n\t\tconst box = webix.html.offset(this.from.$view);\n\n\t\tlet reset = false;\n\t\tif (yScroll && DragScroll.autoYScroll.call(this, pos, box, this.senseY))\n\t\t\treset = true;\n\t\tif (xScroll && DragScroll.autoXScroll.call(this, pos, box, this.senseX))\n\t\t\treset = true;\n\n\t\tif (reset) {\n\t\t\tupdateDragPos(e, pos);\n\t\t\tthis._auto_scroll_delay = webix.delay(\n\t\t\t\tDragScroll.autoScroll,\n\t\t\t\tthis,\n\t\t\t\t[e, pos],\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t},\n\n\tautoYScroll(pos, box, sense) {\n\t\tconst scroll = this.from.getScrollState();\n\n\t\tif (pos.y < box.y + sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x,\n\t\t\t\tscroll.y - sense,\n\t\t\t\t\"y\"\n\t\t\t);\n\t\t} else if (pos.y > box.y + box.height - sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x,\n\t\t\t\tscroll.y + sense,\n\t\t\t\t\"y\"\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t},\n\n\tautoXScroll(pos, box, sense) {\n\t\tconst scroll = this.from.getScrollState();\n\n\t\tif (pos.x < box.x + sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x - sense,\n\t\t\t\tscroll.y,\n\t\t\t\t\"x\"\n\t\t\t);\n\t\t} else if (pos.x > box.x + box.width - sense) {\n\t\t\tconst x = this.snode\n\t\t\t\t? Math.min(scroll.x + sense, this.snode.scrollWidth - box.width)\n\t\t\t\t: scroll.x + sense;\n\t\t\treturn x == scroll.x\n\t\t\t\t? false\n\t\t\t\t: DragScroll.autoScrollTo.call(this, x, scroll.y, \"x\");\n\t\t}\n\t\treturn false;\n\t},\n\n\tautoScrollTo(x, y, mode) {\n\t\tthis.from.scrollTo(x, y);\n\t\tthis.from.callEvent(\"onAfterAutoScroll\", []);\n\n\t\tconst scroll = this.from.getScrollState();\n\t\treturn Math.abs((mode === \"x\" ? x : y) - scroll[mode]) < 1;\n\t},\n};\n\nexport default DragScroll;\n","import DragScroll from \"./dragscroll\";\n\nexport function initDnD(view) {\n\tconst ctrl = webix.copy(DragControl);\n\n\tctrl.view = view;\n\tctrl.master = this;\n\n\tctrl.Local = this.app.getService(\"local\");\n\n\twebix.DragControl.addDrag(view.$view, ctrl);\n\twebix.DragControl.addDrop(view.$view, ctrl, true);\n}\n\nexport function switchCursor(e, view) {\n\tif (webix.DragControl.active) return;\n\n\tconst id = webix.html.locate(e, \"webix_l_id\");\n\tif (id && view.getItem(id).type == \"task\") {\n\t\tconst node = view.getItemNode(id);\n\t\tconst mode = getMoveMode(node, e.clientX);\n\t\tnode.style.cursor = mode == \"move\" ? \"pointer\" : \"ew-resize\";\n\t}\n}\n\nfunction getMoveMode(node, x) {\n\tconst rect = node.getBoundingClientRect();\n\tconst p = (x - rect.left) / rect.width;\n\tconst minWidth = webix.env.touch ? 400 : 200;\n\tconst delta = 0.2 / (rect.width > minWidth ? rect.width / minWidth : 1);\n\n\tif (p < delta) return \"start\";\n\tif (p > 1 - delta) return \"end\";\n\treturn \"move\";\n}\n\nfunction updateDragScrollConfig(ds) {\n\tconst scales = this.Local.getScales();\n\tds.senseX = Math.round(scales.cellWidth * (webix.env.touch ? 1 : 0.5));\n\tds.senseY = Math.round(scales.cellHeight * (webix.env.touch ? 3 : 1));\n\treturn ds;\n}\n\nfunction isProgressDrag(t, node) {\n\twhile (t != node) {\n\t\tif (t.classList.contains(\"webix_gantt_progress_drag\")) return true;\n\t\tt = t.parentNode;\n\t}\n\treturn false;\n}\n\nconst DragControl = {\n\t$longTouchLimit: true,\n\t$dragCreate: function(t, e, pointer) {\n\t\tif (this.master.State.readonly) return false;\n\n\t\tconst ctx = this.getContext();\n\t\tctx.$touch = pointer === \"touch\";\n\n\t\tconst id = this.locateEvent(e);\n\t\tif (id) {\n\t\t\tconst item = this.view.getItem(id);\n\t\t\tif (item.$group) return false;\n\n\t\t\tconst target = e.target;\n\n\t\t\tif (target.classList.contains(\"webix_gantt_link\")) {\n\t\t\t\tctx.mode = \"links\";\n\t\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e, id);\n\t\t\t}\n\n\t\t\tconst node = this.view.getItemNode(id);\n\t\t\tif (!ctx.$touch && isProgressDrag(target, node)) {\n\t\t\t\tctx.mode = \"progress\";\n\t\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e, id);\n\t\t\t}\n\n\t\t\tconst scroll = this.view.getScrollState();\n\t\t\tconst evContext = this.getEventContext(e, ctx);\n\n\t\t\tlet mode = getMoveMode(node, evContext.x);\n\t\t\tif (item.type != \"task\" && (mode == \"start\" || mode == \"end\"))\n\t\t\t\tmode = \"move\";\n\n\t\t\tconst scales = this.Local.getScales();\n\t\t\tlet step = scales.cellWidth;\n\t\t\tif (scales.precise) {\n\t\t\t\tconst nsc = this.master.app\n\t\t\t\t\t.getService(\"helpers\")\n\t\t\t\t\t.getSmallerCount(scales.minUnit);\n\t\t\t\tstep = Math.round(step / (typeof nsc === \"number\" ? nsc : nsc()));\n\t\t\t}\n\n\t\t\twebix.extend(\n\t\t\t\tctx,\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\tmode,\n\t\t\t\t\tnode,\n\t\t\t\t\tstep,\n\t\t\t\t\tdx: 0,\n\t\t\t\t\tfrom: this.view,\n\t\t\t\t\tsnode: t.querySelector(\".webix_scroll_cont\"),\n\t\t\t\t\tx: evContext.x,\n\t\t\t\t\tscroll: scroll,\n\t\t\t\t\tt: parseInt(node.style.top),\n\t\t\t\t\tl: parseInt(node.style.left),\n\t\t\t\t\tw: parseInt(node.style.width),\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\tif (!this.master.app.callEvent(\"bars:beforedrag\", [item, ctx]))\n\t\t\t\treturn false;\n\n\t\t\tif (Modes[ctx.mode].dragScroll)\n\t\t\t\twebix.extend(\n\t\t\t\t\tctx,\n\t\t\t\t\tupdateDragScrollConfig.call(this, Modes[ctx.mode].dragScroll)\n\t\t\t\t);\n\n\t\t\tconst html = node.cloneNode(true);\n\t\t\thtml.className += \" webix_drag_zone webix_gantt_mode_\" + mode;\n\n\t\t\tnode.style.visibility = \"hidden\";\n\t\t\twebix.html.addCss(t, \"webix_gantt_in_action\", true);\n\n\t\t\tt.style.cursor = mode == \"move\" ? \"move\" : \"ew-resize\";\n\t\t\tt.appendChild(html);\n\t\t\treturn html;\n\t\t} else if (\n\t\t\tthis.master.app.config.split &&\n\t\t\tthis.master.State.display !== \"resources\" &&\n\t\t\te.target == t\n\t\t) {\n\t\t\tctx.mode = \"split\";\n\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e);\n\t\t}\n\n\t\treturn false;\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tif (Modes[ctx.mode].dragScroll) DragScroll.reset(ctx);\n\n\t\tif (ctx.mode && Modes[ctx.mode].$dragDestroy)\n\t\t\treturn Modes[ctx.mode].$dragDestroy.call(this, t, node);\n\n\t\tif (ctx.$waitUpdate) {\n\t\t\tctx.$waitUpdate.catch(() => {\n\t\t\t\tthis.master.Action({ action: \"update-task-time\", id: ctx.id });\n\t\t\t});\n\t\t} else\n\t\t\tctx.$waitUpdate = this.master.Action({\n\t\t\t\taction: \"update-task-time\",\n\t\t\t\tid: ctx.id,\n\t\t\t});\n\n\t\tctx.$waitUpdate.finally(() => {\n\t\t\tctx.node.style.visibility = \"\";\n\t\t\twebix.html.remove(node);\n\n\t\t\tif (this.master.app.config.split && ctx.id)\n\t\t\t\tthis.master.Action({\n\t\t\t\t\taction: \"split-resize\",\n\t\t\t\t\tid: ctx.id,\n\t\t\t\t});\n\t\t});\n\n\t\tt.style.cursor = \"\";\n\t\twebix.html.removeCss(t, \"webix_gantt_in_action\");\n\t\treturn false;\n\t},\n\t$dragIn: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (!ctx.mode) return false;\n\n\t\tif (Modes[ctx.mode].dragScroll) {\n\t\t\tDragScroll.reset(ctx);\n\t\t\tDragScroll.start(ctx, e);\n\t\t}\n\n\t\tif (Modes[ctx.mode].$dragIn)\n\t\t\treturn Modes[ctx.mode].$dragIn.call(this, s, t, e);\n\t\treturn true;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\treturn Modes[ctx.mode].$dragPos.call(this, pos);\n\t},\n\t$dragOut: function(s, t, n, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (Modes[ctx.mode].$dragOut)\n\t\t\treturn Modes[ctx.mode].$dragOut.call(this, s, t, n, e);\n\t\treturn null;\n\t},\n\t$drop: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (!ctx.mode) return false;\n\n\t\tif (Modes[ctx.mode].$drop) return Modes[ctx.mode].$drop.call(this, s, t, e);\n\n\t\tconst { id, mode, dx, step } = ctx;\n\t\tconst time = Math.round(dx / step);\n\t\tctx.timeShift = time;\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrop\", [\n\t\t\t\tthis.view.getItem(ctx.id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tctx[\"$waitUpdate\"] = this.master.Action({\n\t\t\taction: \"update-task-time\",\n\t\t\tmode,\n\t\t\ttime,\n\t\t\tid,\n\t\t});\n\t},\n\tlocateEvent: function(ev, context) {\n\t\tif (context) {\n\t\t\tev = document.elementFromPoint(context.x, context.y);\n\t\t}\n\t\treturn webix.html.locate(ev, \"webix_l_id\");\n\t},\n\tgetEventContext: function(e, ctx) {\n\t\tif (ctx.$touch) {\n\t\t\tif (e.changedTouches && !(e.touches && e.touches[0])) {\n\t\t\t\tconst t = e.changedTouches[0];\n\t\t\t\treturn { x: t.pageX, y: t.pageY };\n\t\t\t}\n\t\t\treturn e.time ? e : webix.env.touch.context(e);\n\t\t}\n\t\treturn { x: e.clientX, y: e.clientY };\n\t},\n\tgetContext: function() {\n\t\treturn webix.DragControl.getContext();\n\t},\n\tsetDragOffset: function(node, target, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst pos = webix.html.pos(e);\n\t\tconst offset = webix.html.offset(node);\n\n\t\tctx.width = offset.width;\n\t\tctx.height = offset.height;\n\t\tctx.x_offset = offset.x - pos.x;\n\t\tctx.y_offset = offset.y - pos.y;\n\t},\n};\n\nconst links = {\n\tdragScroll: {\n\t\tdirection: \"xy\",\n\t},\n\t$dragCreate: function(t, e, id) {\n\t\tconst ctx = this.getContext();\n\t\tconst link = e.target;\n\t\tconst node = this.view.getItemNode(id);\n\t\tconst scroll = this.view.getScrollState();\n\t\tconst offset = webix.html.offset(link);\n\t\tconst css = link.classList;\n\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tfrom: this.view,\n\t\t\t\tnode,\n\t\t\t\tlink,\n\t\t\t\tfromStart: css.contains(\"webix_gantt_link_left\"),\n\t\t\t\tstart: {\n\t\t\t\t\tx: offset.x + offset.width / 2 + scroll.x,\n\t\t\t\t\ty: offset.y + offset.height / 2 + scroll.y,\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrag\", [\n\t\t\t\tthis.view.getItem(id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tif (Modes[ctx.mode].dragScroll)\n\t\t\twebix.extend(\n\t\t\t\tctx,\n\t\t\t\tupdateDragScrollConfig.call(this, Modes[ctx.mode].dragScroll)\n\t\t\t);\n\n\t\tlink.style.opacity = 1;\n\t\twebix.html.addCss(node, \"webix_gantt_task_in_action\", true);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tthis.master.Action({ action: \"temp-link\" });\n\n\t\tif (ctx.target) {\n\t\t\tconst node = this.view.getItemNode(ctx.target);\n\t\t\twebix.html.removeCss(node, \"webix_gantt_link_visible\");\n\t\t}\n\n\t\tctx.link.style.opacity = \"\";\n\t\twebix.html.removeCss(ctx.node, \"webix_gantt_task_in_action\");\n\t\twebix.html.remove(node);\n\n\t\treturn false;\n\t},\n\t$dragIn: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst id = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (!id) return false;\n\n\t\tconst node = this.view.getItemNode(id);\n\t\tif (id != ctx.target) {\n\t\t\twebix.html.addCss(node, \"webix_gantt_link_visible\", true);\n\t\t\tctx.target = id;\n\t\t}\n\t\treturn node;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst nscroll = this.view.getScrollState();\n\n\t\tctx.end = {\n\t\t\tx: pos.x + nscroll.x,\n\t\t\ty: pos.y + nscroll.y,\n\t\t};\n\n\t\tthis.master.Action({ action: \"temp-link\", start: ctx.start, end: ctx.end });\n\t},\n\t$dragOut: function(s, t, n, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst id = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (ctx.target && id != ctx.target) {\n\t\t\tconst node = this.view.getItemNode(ctx.target);\n\t\t\twebix.html.removeCss(node, \"webix_gantt_link_visible\");\n\t\t\tctx.target = null;\n\t\t}\n\t\treturn null;\n\t},\n\t$drop: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst source = ctx.id;\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst target = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (!target || source == target) return false;\n\n\t\tconst node = this.view.getItemNode(target);\n\t\tconst rect = node.getBoundingClientRect();\n\t\tconst toStart = evContext.x - rect.left < rect.width / 2;\n\n\t\tconst type = (ctx.linkType = (ctx.fromStart ? 1 : 0) + (toStart ? 0 : 2));\n\t\tctx.targetId = target;\n\t\tif (\n\t\t\tthis.master.app.callEvent(\"bars:beforedrop\", [\n\t\t\t\tthis.view.getItem(source),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\tthis.master.Action({ action: \"add-link\", source, target, type });\n\t},\n};\n\nconst resize = {\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst nscroll = this.view.getScrollState();\n\t\tconst node = webix.DragControl.getNode();\n\t\tconst { mode, l, t, w, x, id, scroll, step } = ctx;\n\t\tconst dx = (ctx.dx = pos.x - x - scroll.x + nscroll.x);\n\n\t\tif (mode === \"start\") {\n\t\t\tpos.x = Math.min(l + dx, l + w - step);\n\t\t\tnode.style.width = `${Math.max(w - dx, step)}px`;\n\t\t} else if (mode === \"end\") {\n\t\t\tpos.x = l;\n\t\t\tnode.style.width = `${Math.max(w + dx, step)}px`;\n\t\t}\n\t\tpos.y = t;\n\n\t\tthis.master.Action({\n\t\t\taction: \"drag-task\",\n\t\t\tid,\n\t\t\tleft: pos.x,\n\t\t\twidth: parseInt(node.style.width),\n\t\t});\n\n\t\tif (this.master.app.config.split)\n\t\t\tthis.master.Action({\n\t\t\t\taction: \"split-resize\",\n\t\t\t\tid,\n\t\t\t});\n\t},\n};\n\nconst move = {\n\tdragScroll: {\n\t\tdirection: \"x\",\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst { node, l, t, x, id, scroll } = ctx;\n\t\tconst nscroll = this.view.getScrollState();\n\t\tconst dx = (ctx.dx = pos.x - x - scroll.x + nscroll.x);\n\n\t\tpos.x = l + dx;\n\t\tpos.y = t;\n\n\t\tthis.master.Action({\n\t\t\taction: \"drag-task\",\n\t\t\tid,\n\t\t\tleft: pos.x,\n\t\t\twidth: parseInt(node.style.width),\n\t\t});\n\n\t\tif (this.master.app.config.split)\n\t\t\tthis.master.Action({\n\t\t\t\taction: \"split-resize\",\n\t\t\t\tid,\n\t\t\t});\n\t},\n};\n\nconst progress = {\n\t$dragCreate: function(t, e, id) {\n\t\tconst ctx = this.getContext();\n\t\tconst node = this.view.getItemNode(id);\n\t\tconst prevProgress = this.view.getItem(id).progress;\n\t\tconst progressNode = node.querySelector(\".webix_gantt_progress\");\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst scroll = this.view.getScrollState();\n\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tnode,\n\t\t\t\tprevProgress,\n\t\t\t\tprogressNode,\n\t\t\t\tfrom: this.view,\n\t\t\t\tx: evContext.x,\n\t\t\t\tw: parseInt(node.style.width),\n\t\t\t\tscroll,\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrag\", [\n\t\t\t\tthis.view.getItem(id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tt.style.cursor = \"ew-resize\";\n\t\twebix.html.addCss(t, \"webix_gantt_in_action\", true);\n\t\twebix.html.addCss(node, \"webix_gantt_mode_progress\", true);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst { x, scroll, w, node } = ctx;\n\t\tconst nscroll = this.view.getScrollState();\n\n\t\tconst dx = pos.x - x - scroll.x + nscroll.x;\n\t\tconst progress = Math.min(\n\t\t\tMath.max(ctx.prevProgress + Math.round((dx * 100) / w), 0),\n\t\t\t100\n\t\t);\n\n\t\tif (ctx.progress != progress) {\n\t\t\tctx.progress = progress;\n\t\t\tModes[ctx.mode].updateTaskTemplate.call(this, ctx, progress);\n\t\t}\n\n\t\tconst colors = { contrast: \"#393939\", dark: \"#20262B\" };\n\t\tnode.style.zIndex = \"3\";\n\t\tnode.style.boxShadow = `${\n\t\t\tcolors[webix.skin.$name || \"#ffffff\"]\n\t\t} -1px 0px 0px`;\n\t},\n\t$drop: function() {\n\t\tconst ctx = this.getContext();\n\t\tconst { id, progress, prevProgress } = ctx;\n\n\t\tif (\n\t\t\t!webix.isUndefined(progress) &&\n\t\t\tprogress != prevProgress &&\n\t\t\tthis.master.app.callEvent(\"bars:beforedrop\", [this.view.getItem(id), ctx])\n\t\t)\n\t\t\tctx[\"$waitUpdate\"] = this.master.Action({\n\t\t\t\taction: \"update-task-progress\",\n\t\t\t\tprogress,\n\t\t\t\tid,\n\t\t\t});\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tif (ctx.$waitUpdate) {\n\t\t\tctx.$waitUpdate.catch(() => {\n\t\t\t\tthis.master.Action({ action: \"update-task-progress\", id: ctx.id });\n\t\t\t});\n\t\t} else\n\t\t\tctx.$waitUpdate = this.master.Action({\n\t\t\t\taction: \"update-task-progress\",\n\t\t\t\tid: ctx.id,\n\t\t\t});\n\n\t\tt.style.cursor = \"\";\n\t\twebix.html.removeCss(t, \"webix_gantt_in_action\");\n\t\twebix.html.removeCss(ctx.node, \"webix_gantt_mode_progress\");\n\n\t\twebix.html.remove(node);\n\t\treturn false;\n\t},\n\tupdateTaskTemplate(ctx, progress) {\n\t\tconst node = ctx.progressNode;\n\t\tnode.style.width = progress + \"%\";\n\t\tnode.innerHTML = this.master.DragProgressTemplate(progress);\n\t},\n};\n\nconst split = {\n\t$dragCreate: function(t, e) {\n\t\tconst selection = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_split_selection\",\n\t\t});\n\n\t\tconst scales = this.Local.getScales();\n\t\tconst scroll = this.view.getScrollState();\n\n\t\tconst tb = e.target.getBoundingClientRect();\n\t\tconst index = Math.floor((e.y - tb.y + scroll.y) / scales.cellHeight);\n\t\tconst offsetX = e.x - tb.x;\n\n\t\tselection.style.top = index * scales.cellHeight + 6 + \"px\";\n\t\tselection.style.left = offsetX + scroll.x + \"px\";\n\t\tselection.style.height = scales.cellHeight - 14 + \"px\";\n\t\tselection.style.width = \"0px\";\n\n\t\tlet step = scales.cellWidth;\n\t\tif (scales.precise) {\n\t\t\tconst nsc = this.master.app\n\t\t\t\t.getService(\"helpers\")\n\t\t\t\t.getSmallerCount(scales.minUnit);\n\t\t\tstep = Math.round(step / (typeof nsc === \"number\" ? nsc : nsc()));\n\t\t}\n\n\t\tconst ctx = this.getContext();\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tfrom: this.view,\n\t\t\t\tnode: selection,\n\t\t\t\tstart: { offsetX, clientX: e.clientX },\n\t\t\t\tindex,\n\t\t\t\tstep,\n\t\t\t\tscroll,\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tt.appendChild(selection);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragPos(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst width = (ctx.dx = pos.x - ctx.start.clientX);\n\t\tif (pos.x < ctx.start.clientX) {\n\t\t\tctx.node.style.left = ctx.start.offsetX + ctx.scroll.x + width + \"px\";\n\t\t\tctx.node.style.width = -width + \"px\";\n\t\t} else {\n\t\t\tctx.node.style.left = ctx.start.offsetX + ctx.scroll.x + \"px\";\n\t\t\tctx.node.style.width = pos.x - ctx.start.clientX + \"px\";\n\t\t}\n\t},\n\t$drop() {\n\t\tconst ctx = this.getContext();\n\t\tconst id = this.view.getIdByIndex(ctx.index);\n\n\t\tlet start = Math.round((ctx.start.offsetX + ctx.scroll.x) / ctx.step);\n\t\tlet end = Math.round(ctx.dx / ctx.step);\n\t\tif (end < 0) {\n\t\t\tstart = start + end;\n\t\t\tend *= -1;\n\t\t}\n\n\t\tthis.master.Action({ action: \"add-task\", id, dates: { start, end } });\n\t},\n\t$dragDestroy(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\twebix.html.remove(node);\n\t\twebix.html.remove(ctx.node);\n\n\t\treturn false;\n\t},\n};\n\nconst Modes = {\n\tlinks,\n\tmove,\n\tprogress,\n\tstart: resize,\n\tend: resize,\n\tsplit,\n};\n","import { JetView } from \"webix-jet\";\nimport { initDnD, switchCursor } from \"../../helpers/dnd\";\n\nexport default class BarsView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"abslayout\",\n\t\t\tcss:\n\t\t\t\tthis.State.readonly || !this.app.config.links\n\t\t\t\t\t? \"webix_gantt_readonly\"\n\t\t\t\t\t: \"\",\n\t\t\tborderless: true,\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_holidays\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_links\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"list\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttype: this.BarsType(_),\n\t\t\t\t\tcss: `webix_gantt${webix.env.touch ? \"_touch\" : \"\"}_bars`,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ItemClickHandler(id),\n\t\t\t\t\t},\n\t\t\t\t\ttooltip: obj => this.GetTooltip(obj, _),\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tconst [holidays, links, bars] = view.getChildViews();\n\t\tthis.Holidays = holidays;\n\t\tthis.Links = links;\n\t\tthis.Bars = bars;\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\tconst local = (this.Local = this.app.getService(\"local\"));\n\t\tconst scales = local.getScales();\n\t\tconst linkCollection = local.links();\n\t\tconst ldata = (this.LinksData = linkCollection.data);\n\t\tthis.Calendars = this.app.config.resourceCalendars;\n\n\t\tthis.HandleScroll();\n\t\tthis.HandleDrag(scales);\n\t\tthis.HandleSelection(scales);\n\t\tthis.InitMarkers();\n\t\tthis.HandleHolidays(scales);\n\n\t\tthis.on(this.State.$changes, \"display\", (v, old) => {\n\t\t\t// if the selected task type was changed, the form not closed and the display mode changed, we need to close the form and remove selection layer\n\t\t\tthis.SyncData(true);\n\t\t\tif (old) {\n\t\t\t\tthis.Local.refreshLinks();\n\t\t\t\tthis.RefreshLinks();\n\t\t\t\tif (this.Calendars) this.RenderResourceHolidays();\n\t\t\t}\n\t\t});\n\n\t\t// leave here for app.refresh() calls (inc. from Locale plugin)\n\t\tthis.DrawGrid(view, scales);\n\t\tif (this.Calendars) this.RenderResourceHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tthis.DrawGrid(view, scales);\n\t\t\tthis.Bars.refresh();\n\t\t\tthis.RefreshLinks();\n\t\t});\n\n\t\tthis.on(this.VisibleTasks.data, \"onStoreUpdated\", (id, data, action) => {\n\t\t\tthis.RefreshLinks();\n\t\t\tif (action !== \"update\") this.ApplySelection();\n\t\t\tif (!action && this.Calendars) this.RenderResourceHolidays();\n\t\t});\n\t\tthis.on(ldata, \"onStoreUpdated\", () => {\n\t\t\tthis.RefreshLinks();\n\t\t});\n\t\tthis.on(this.State.$changes, \"criticalPath\", (v, o) => {\n\t\t\tif (!webix.isUndefined(o)) {\n\t\t\t\tthis.Local.showCriticalPath(!v);\n\t\t\t\tthis.RefreshLinks();\n\t\t\t}\n\t\t});\n\t\tthis.on(this.State.$changes, \"compact\", () => {\n\t\t\tthis.RefreshLinks();\n\t\t});\n\t\tif (this.Calendars)\n\t\t\tthis.on(\n\t\t\t\tthis.Local.assignments().data,\n\t\t\t\t\"onStoreUpdated\",\n\t\t\t\t(id, data, action) => {\n\t\t\t\t\tthis.RenderResourceHolidays();\n\t\t\t\t\tif (this.app.config.excludeHolidays && action) {\n\t\t\t\t\t\tconst task = this.Local.tasks().getItem(data.task);\n\t\t\t\t\t\tif (task) this.Ops.updateAssignedTaskDates(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\tthis.on(this.State.$changes, \"baseline\", (v, o) => {\n\t\t\tif (!webix.isUndefined(o))\n\t\t\t\tthis.Local.updateScaleMinMax(this.VisibleTasks);\n\t\t});\n\t}\n\n\t/**\n\t * Sets action ot bar item click\n\t * @param {(string|number)} id  - ID of the clicked item\n\t */\n\tItemClickHandler(id) {\n\t\tif (!this.Bars.getItem(id).$group)\n\t\t\tthis.State.$batch({\n\t\t\t\tparent: null,\n\t\t\t\tselected: id,\n\t\t\t});\n\t}\n\n\t/**\n\t * Paints a grid\n\t * @param {view} Object - Webix view of bars chart\n\t * @param {scales} Object - scales object as returned by this.Local.getScales()\n\t */\n\tDrawGrid(view, scales) {\n\t\tconst colors = { contrast: \"#808080\", dark: \"#384047\" };\n\t\tview.$view.style.backgroundImage = `url(${this.app\n\t\t\t.getService(\"helpers\")\n\t\t\t.drawGridInner(\n\t\t\t\tscales.cellWidth,\n\t\t\t\tscales.cellHeight,\n\t\t\t\tcolors[webix.skin.$name] || \"#ccc\"\n\t\t\t)})`;\n\t\tview.$view.style.marginTop = \"0px\";\n\n\t\t// sync grid to scroll position\n\t\tconst state = this.app.getState();\n\t\tview.$view.style.backgroundPosition = `-${state.left}px -${state.top}px`;\n\n\t\tthis.Resize(scales.width);\n\t}\n\n\t/**\n\t * Loads data to the chart\n\t * @param {Boolean} unselect - passed on 'display' change; if the selected task is not found on chart and this param is true, State.selected will be nulled in ApplySelection\n\t */\n\tSyncData(unselect) {\n\t\tthis.Bars.clearAll();\n\t\tthis.VisibleTasks = this.Local.getVisibleTasksCollection();\n\t\tif (this.Calendars) {\n\t\t\tthis.Local.taskCalendarMap().then(() => {\n\t\t\t\tthis.Bars.sync(this.VisibleTasks);\n\t\t\t});\n\t\t} else this.Bars.sync(this.VisibleTasks);\n\t\tthis.ApplySelection(unselect);\n\t}\n\n\t/**\n\t * Returns a string with HTML of a task node content\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string}\n\t */\n\tBarsTemplate(obj, _) {\n\t\tconst text = obj.text || (obj.$group ? _(\"Unassigned\") : _(\"(no title)\"));\n\t\treturn obj.type == \"milestone\" ? `<span>${text}</span>` : text;\n\t}\n\n\t/**\n\t * Returns all templates for bars\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {Object} all templates for bars\n\t */\n\tBarsType(_) {\n\t\treturn {\n\t\t\ttemplate: obj => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\tobj.type === \"split\" &&\n\t\t\t\t\tobj.$data &&\n\t\t\t\t\tobj.$data.length\n\t\t\t\t) {\n\t\t\t\t\tconst { height, width, left, top } = this.GetSplitBox(obj);\n\t\t\t\t\tlet html = `<div class=\"webix_gantt_split_container\" webix_s_id=\"${obj.id}\" style=\"top:${top}px;left:${left}px;height:${height}px;width:${width}px;\"></div>`;\n\n\t\t\t\t\t// split kids are not in the order\n\t\t\t\t\tconst order = this.VisibleTasks.data.order;\n\t\t\t\t\tconst isLast = order.length > 1 && obj.id == order[order.length - 1];\n\t\t\t\t\tobj.$data.forEach(kid => {\n\t\t\t\t\t\thtml +=\n\t\t\t\t\t\t\tthis.TemplateStart(kid, isLast, true) +\n\t\t\t\t\t\t\tthis.BarsTemplate(kid, _) +\n\t\t\t\t\t\t\tthis.TemplateEnd(kid);\n\t\t\t\t\t});\n\t\t\t\t\treturn html;\n\t\t\t\t} else return this.BarsTemplate(obj, _);\n\t\t\t},\n\t\t\ttemplateStart: task => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\ttask.type === \"split\" &&\n\t\t\t\t\ttask.$data &&\n\t\t\t\t\ttask.$data.length\n\t\t\t\t)\n\t\t\t\t\treturn \"\";\n\t\t\t\tconst order = this.VisibleTasks.data.order;\n\t\t\t\tconst isLast = order.length > 1 && task.id == order[order.length - 1];\n\t\t\t\treturn this.TemplateStart(task, isLast);\n\t\t\t},\n\t\t\ttemplateEnd: task => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\ttask.type === \"split\" &&\n\t\t\t\t\ttask.$data &&\n\t\t\t\t\ttask.$data.length\n\t\t\t\t)\n\t\t\t\t\treturn \"\";\n\t\t\t\treturn this.TemplateEnd();\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Gets the size and position parameters for a decorative div-element behind a split task\n\t * @param {Object} obj - data of a split task\n\t * @returns {Object} an object with top, left, height, and width of an element\n\t */\n\tGetSplitBox(obj) {\n\t\tconst last = obj.$data[0];\n\t\tconst first = obj.$data[obj.$data.length - 1];\n\t\tconst left =\n\t\t\tfirst.$x + (first.type == \"milestone\" ? Math.floor(first.$w / 2) : 0);\n\t\tconst rwidth = last.type == \"milestone\" ? Math.floor(last.$w / 2) : last.$w;\n\n\t\treturn {\n\t\t\ttop: last.$y,\n\t\t\tleft,\n\t\t\theight: last.$h,\n\t\t\twidth: last.$x - left + rwidth,\n\t\t};\n\t}\n\n\t/**\n\t * Returns the html for the first part of a task\n\t * @param {Object} task - a task data object\n\t * @param {Boolean} last - a flag that indicates that this task is in the last line of gantt\n\t * @param {Boolean} split - a flag that indicates that this task is a child of a parent with \"split\" type\n\t * @returns {string} HTML that defines how a task is displayed\n\t */\n\tTemplateStart(task, last, split) {\n\t\tlet w = task.$w,\n\t\t\th = task.$h,\n\t\t\tdiff = 0,\n\t\t\tprogress = \"\";\n\t\tconst css = this.BarCSS(task, last);\n\t\tconst contentCss = this.ContentCss(task);\n\t\tif (task.type == \"milestone\") {\n\t\t\tw = h = Math.ceil(Math.sqrt(Math.pow(task.$w, 2) / 2));\n\t\t\tdiff = Math.ceil((task.$w - w) / 2);\n\t\t} else {\n\t\t\tconst drag =\n\t\t\t\ttask.type == \"task\" ? this.DragProgressTemplate(task.progress) : \"\";\n\t\t\tprogress = `<div class=\"webix_gantt_progress\" style=\"width:${task.progress}%;\">${drag}</div>`;\n\t\t}\n\n\t\tlet baseline = \"\";\n\t\tif (\n\t\t\tthis.State.baseline &&\n\t\t\ttask.type !== \"milestone\" &&\n\t\t\ttask.planned_start &&\n\t\t\t!split\n\t\t)\n\t\t\tbaseline = this.TemplateBaseline(task);\n\n\t\treturn (\n\t\t\tbaseline +\n\t\t\t`<div webix_l_id=\"${task.id}\" class=\"${css}\" \n\t\t\tstyle=\"left:${task.$x + diff}px;top:${task.$y +\n\t\t\t\tdiff -\n\t\t\t\t(baseline ? 1 : 0)}px;width:${w}px;height:${h}px;\" \n\t\t\tdata-id=\"${task.id}\">\n\t\t\t\t<div class=\"webix_gantt_link webix_gantt_link_left\"></div>\n\t\t\t\t${progress}\n\t\t\t\t<div class=\"webix_gantt_content ${contentCss}\">`\n\t\t);\n\t}\n\n\tTemplateBaseline(t) {\n\t\treturn `<div  \n\t\t\tclass=\"webix_gantt_baseline_${t.type}\" \n\t\t\tstyle=\"left:${t.$x0}px;top:${t.$y + t.$h - 2}px;width:${t.$w0}px; \" \n\t\t\tdata-baseid=\"${t.id}\"></div>`;\n\t}\n\n\t/**\n\t * Get task classname\n\t * @param {Object} task - a task data object\n\t * @param {Boolean} last - a flag that indicates that this task is in the last line of gantt\n\t * @returns {string} a classname\n\t */\n\tBarCSS(task, last) {\n\t\tlet css = `webix_gantt_task_base webix_gantt_${\n\t\t\ttask.type === \"split\" ? \"task\" : task.type\n\t\t}`;\n\t\tif (task.$critical) css += \" webix_gantt_critical\";\n\t\tif (task.$group) css += \" webix_gantt_group\";\n\t\tif (last) css += \" webix_gantt_last\";\n\t\tif (task.css && task.type != \"milestone\") css += \" \" + task.css;\n\t\treturn css;\n\t}\n\tContentCss(task) {\n\t\treturn task.css && task.type == \"milestone\" ? \" \" + task.css : \"\";\n\t}\n\t/**\n\t * Returns the html for the last part of a task\n\t * @returns {string} HTML that defines how a task is displayed\n\t */\n\tTemplateEnd() {\n\t\treturn `</div><div class=\"webix_gantt_link webix_gantt_link_right\"></div></div>`;\n\t}\n\n\t/**\n\t * Returns a string with HTML of the progress drag marker\n\t * @param {number} progress - the progress of a task (number from 0 to 100)\n\t * @returns {string}\n\t */\n\tDragProgressTemplate(progress) {\n\t\treturn `<div class=\"webix_gantt_progress_drag\" style=\"left:${progress}%\">\n\t\t\t<span class=\"webix_gantt_progress_percent\">${progress}</span>\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Extends the class with methods for DnD and handles cursor change for bars\n\t */\n\tHandleDrag() {\n\t\tinitDnD.call(this, this.Bars);\n\n\t\tthis._mousemove_handler = webix.event(this.Bars.$view, \"pointermove\", e => {\n\t\t\tif (e.pointerType == \"mouse\") switchCursor(e, this.Bars);\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis._mousemove_handler = webix.eventRemove(this._mousemove_handler);\n\t\tthis._scroll_handler = webix.eventRemove(this._scroll_handler);\n\n\t\tconst markers = this.app.config.markers;\n\t\tif (markers)\n\t\t\tfor (let i = 0; i < markers.length; i++) {\n\t\t\t\tconst m = markers[i];\n\t\t\t\tif (m.$interval) m.$interval = clearInterval(m.$interval);\n\t\t\t}\n\t}\n\n\t/**\n\t * Finds and returns the SVG element with all links or the temp link that is rendered while the user is linking two tasks\n\t * @param {Boolean} temp - if true, the method looks for the temp link\n\t * @returns {SVGElement}\n\t */\n\tGetLinks(temp) {\n\t\treturn this.Links.$view.querySelector(\n\t\t\t`.webix_gantt_${temp ? \"temp_line\" : \"lines\"}`\n\t\t);\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\n\t\t\tthis.holidaysContainer.style.height = 0 + \"px\";\n\t\t\tthis.containerForMarkers.style.height = 0 + \"px\";\n\n\t\t\tif (this.app.config.links) {\n\t\t\t\tconst lines = this.GetLinks();\n\t\t\t\tconst temp = this.GetLinks(true);\n\t\t\t\tconst attrs = {\n\t\t\t\t\tviewBox: `${left} ${top} ${bars.scrollWidth} ${bars.scrollHeight}`,\n\t\t\t\t\twidth: bars.scrollWidth,\n\t\t\t\t\theight: bars.scrollHeight,\n\t\t\t\t};\n\n\t\t\t\tfor (let key in attrs) {\n\t\t\t\t\tlines.setAttribute(key, attrs[key]);\n\t\t\t\t\ttemp.setAttribute(key, attrs[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.SetHolidaysScroll(bars.scrollHeight, left, top);\n\n\t\t\tthis.containerForMarkers.style.height = bars.scrollHeight + \"px\";\n\n\t\t\tthis.getRoot().$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.State.$batch({ top, left });\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"top\", y => {\n\t\t\tthis.Bars.scrollTo(this.State.left, y);\n\t\t});\n\n\t\tif (this.app.config.resources) {\n\t\t\tthis.on(this.State.$changes, \"left\", v => {\n\t\t\t\tif (this.State.resourcesDiagram) this.Bars.scrollTo(v, this.State.top);\n\t\t\t});\n\n\t\t\tthis.on(this.app, \"rdiagram:resize\", () => {\n\t\t\t\tthis.holidaysContainer.style.height =\n\t\t\t\t\tthis.Bars.$view.scrollHeight + \"px\";\n\t\t\t\tthis.containerForMarkers.style.height =\n\t\t\t\t\tthis.Bars.$view.scrollHeight + \"px\";\n\t\t\t});\n\t\t}\n\t}\n\n\tSetHolidaysScroll(height, x, y) {\n\t\tthis.holidaysContainer.style.height = height + \"px\";\n\t\tthis.holidaysContainer.style.left = -x + \"px\";\n\t\tthis.holidaysContainer.style.top = -y + \"px\";\n\t\tif (this.Calendars) {\n\t\t\tthis.resHolidaysContainer.style.height = height + \"px\";\n\t\t\tthis.resHolidaysContainer.style.left = -x + \"px\";\n\t\t\tthis.resHolidaysContainer.style.top = -y + \"px\";\n\t\t}\n\t}\n\n\t/**\n\t * Handles selection\n\t * @param {Object} scales - the current scales\n\t */\n\tHandleSelection(scales) {\n\t\tthis.selLine = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_bar_selection\",\n\t\t\tstyle: `height:${scales.cellHeight}px;width:${scales.width}px`,\n\t\t});\n\t\tthis.Bars.$view.insertBefore(this.selLine, this.Bars.$view.firstChild);\n\n\t\tthis.on(this.State.$changes, \"selected\", () => this.ApplySelection());\n\t}\n\n\t/**\n\t * Highlights the selected task\n\t * @param {Boolean} unselect - passed by SyncData call on 'display' change; if the selected task is not found in current collection and this param is true, State.selected will be nulled\n\t */\n\tApplySelection(unselect) {\n\t\tconst id = this.State.selected;\n\t\tlet top = -100;\n\t\tif (id && this.Bars.data.order.length) {\n\t\t\tlet ind = (top = this.Bars.getIndexById(id));\n\t\t\tconst task = this.Bars.getItem(id);\n\t\t\tif (ind < 0) {\n\t\t\t\t// split subtasks will not be found in datastore order\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display == \"tasks\" &&\n\t\t\t\t\ttask &&\n\t\t\t\t\ttask.parent != 0 &&\n\t\t\t\t\tthis.Bars.getItem(task.parent).type === \"split\"\n\t\t\t\t) {\n\t\t\t\t\tind = this.Bars.getIndexById(task.parent);\n\t\t\t\t} else if (unselect && !this.Bars.exists(id)) {\n\t\t\t\t\tthis.State.selected = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttop = ind * this.Local.getScales().cellHeight;\n\n\t\t\tthis.ScrollToTask(task);\n\t\t}\n\t\tthis.selLine.style.top = top + \"px\";\n\t}\n\n\t/**\n\t * Scrolls the chart to make the task visible\n\t * @param {Object} task - the data object of a task\n\t */\n\tScrollToTask(task) {\n\t\tif (task) {\n\t\t\tconst bars = this.Bars;\n\t\t\tif (\n\t\t\t\ttask.$x > bars.$width - this.Local.getScales().cellWidth ||\n\t\t\t\ttask.$x < bars.$view.scrollLeft\n\t\t\t) {\n\t\t\t\t// to make it visible, -30px for better looks - not sticking to the tree\n\t\t\t\tthis.State.left = task.$x - 30;\n\t\t\t}\n\t\t}\n\t\tthis.Bars.scrollTo(this.State.left, this.State.top);\n\t}\n\n\t/**\n\t * Creates and renders markers (today and custom ones if they are provided)\n\t */\n\tInitMarkers() {\n\t\tthis.containerForMarkers = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_markers\",\n\t\t\tstyle: `height:${this.Bars.$view.scrollHeight}px`,\n\t\t});\n\t\tthis.Bars.$view.insertBefore(\n\t\t\tthis.containerForMarkers,\n\t\t\tthis.Bars.$view.firstChild\n\t\t);\n\n\t\tthis.RenderMarkers(this.app.config.markers);\n\t\tthis.on(this.app, \"onScalesUpdate\", () =>\n\t\t\tthis.RenderMarkers(this.app.config.markers)\n\t\t);\n\t}\n\n\t/**\n\t * Renders markers (today and custom ones if they are provided)\n\t * @param {Array} markers - all markers\n\t */\n\tRenderMarkers(markers) {\n\t\tif (!markers) return;\n\n\t\tconst html = [];\n\t\tfor (let i = 0; i < markers.length; i++) {\n\t\t\tconst m = markers[i];\n\t\t\tif (m.now) {\n\t\t\t\tm.start_date = new Date();\n\t\t\t\tif (!m.$interval)\n\t\t\t\t\tm.$interval = setInterval(\n\t\t\t\t\t\titem => {\n\t\t\t\t\t\t\tconst node = this.containerForMarkers.querySelector(\n\t\t\t\t\t\t\t\t`[gantt_now=\"${item.$interval}\"]`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tnode.style.left = this.GetMarkerPosition(new Date()) + \"px\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\t5 * 60 * 1000,\n\t\t\t\t\t\tm\n\t\t\t\t\t);\n\t\t\t}\n\t\t\thtml.push(this.MarkerTemplate(markers[i]));\n\t\t}\n\t\tthis.containerForMarkers.innerHTML = html.join(\"\");\n\t}\n\n\t/**\n\t * Returns a string with HTML content of a marker\n\t * @param {Object} obj - marker settings\n\t * @returns {string}\n\t */\n\tMarkerTemplate(obj) {\n\t\tconst text = obj.text\n\t\t\t? `<span class=\"webix_gantt_marker_text\">${obj.text}</span>`\n\t\t\t: \"\";\n\n\t\treturn `<div\n\t\t\tgantt_now=\"${obj.$interval}\"\n\t\t\tclass=\"webix_gantt_marker ${obj.css || \"\"}\"\n\t\t\tstyle=\"left:${this.GetMarkerPosition(obj.start_date)}px\">${text}</div>`;\n\t}\n\n\t/**\n\t * Calculates new X position of a marker based on its date\n\t * @param {Date} date - the date from marker settings\n\t * @returns {number}\n\t */\n\tGetMarkerPosition(date) {\n\t\tconst { start, end, cellWidth, diff, minUnit } = this.Local.getScales();\n\t\tconst astart = this.Helpers.getUnitStart(minUnit, start);\n\n\t\treturn date < start || date > end\n\t\t\t? -100\n\t\t\t: Math.round(\n\t\t\t\t\tdiff(date, astart, webix.Date.startOnMonday, true) * cellWidth\n\t\t\t  );\n\t}\n\n\t/**\n\t * Returns a string with SVG with all links or a temp link\n\t * @param {string} lines - all lines as SVG polylines\n\t * @param {string} css - the name of CSS class for SVG (by default 'webix_gantt_lines' or 'webix_gantt_temp_line')\n\t * @returns {string}\n\t */\n\tLinksTemplate(lines, css) {\n\t\tconst bars = this.Bars.$view;\n\n\t\treturn `<svg\n\t\t\tclass=\"${css}\"\n\t\t\tviewBox=\"${this.State.left} ${this.State.top} ${bars.scrollWidth} ${bars.scrollHeight}\"\n\t\t\twidth=\"${bars.scrollWidth}\"\n\t\t\theight=\"${bars.scrollHeight}\"\n\t\t>${lines}</svg>`;\n\t}\n\n\t/**\n\t * Re-renders links\n\t */\n\tRefreshLinks() {\n\t\tconst lines = [];\n\t\t// check to skip multiple re-rendering initially\n\t\tif (this.LinksData.count() && this.VisibleTasks.count()) {\n\t\t\tconst links = this.LinksData;\n\t\t\tlinks.order.each(id => {\n\t\t\t\tconst link = links.getItem(id);\n\t\t\t\tif (link.$p) {\n\t\t\t\t\tlet critical =\n\t\t\t\t\t\tthis.State.criticalPath && this.Local.isLinkCritical(link);\n\t\t\t\t\tlines.push(\n\t\t\t\t\t\t`<polyline data-id=\"${id}\" ${\n\t\t\t\t\t\t\tcritical ? \"class='webix_gantt_line_critical'\" : \"\"\n\t\t\t\t\t\t} points=\"${link.$p}\" />`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst html =\n\t\t\tthis.LinksTemplate(lines.join(\"\"), \"webix_gantt_lines\") +\n\t\t\tthis.LinksTemplate('<polyline points=\"\" />', \"webix_gantt_temp_line\");\n\t\tthis.Links.setHTML(html);\n\t}\n\n\t/**\n\t * Refreshes links of a task\n\t * @param {string, number} tid - the ID of a task\n\t */\n\tRefreshTaskLinks(tid) {\n\t\tthis.LinksData.find(a => a.source == tid || a.target == tid).forEach(\n\t\t\tobj => {\n\t\t\t\tconst l = this.Links.$view.querySelector(`[data-id=\"${obj.id}\"]`);\n\t\t\t\tif (l) {\n\t\t\t\t\tconst s = this.VisibleTasks.getItem(obj.source);\n\t\t\t\t\tconst e = this.VisibleTasks.getItem(obj.target);\n\t\t\t\t\tthis.Helpers.updateLink(obj, s, e);\n\t\t\t\t\tl.setAttribute(\"points\", obj.$p);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Changes the width of the root component (list with bars)\n\t * @param {number} width\n\t */\n\tResize(width) {\n\t\tconst area = this.Bars.$view.querySelector(\".webix_scroll_cont\");\n\t\tarea.style.width = width + \"px\";\n\t\tarea.style.minHeight = \"1px\";\n\n\t\tif (this.selLine) this.selLine.style.width = width + \"px\";\n\t}\n\n\t/**\n\t * Handles actions with tasks\n\t * @param {Object} obj - settings of an action\n\t * @returns {Promise} - the result of asynchronous operations or an empty promise\n\t */\n\tAction(obj) {\n\t\tconst ops = this.app.getService(\"operations\");\n\t\t/**\n\t\t * Some actions invoke server-side request\n\t\t * therefore we need show progress bar for them\n\t\t */\n\t\tlet inProgress = null;\n\n\t\tif (obj.action === \"update-task-time\") {\n\t\t\tif (obj.time) {\n\t\t\t\tinProgress = ops.updateTaskTime(obj.id, obj.mode, obj.time);\n\t\t\t} else {\n\t\t\t\tthis.Local.refreshTasks(obj.id);\n\t\t\t\tif (this.State.display === \"resources\") {\n\t\t\t\t\tthis.VisibleTasks.refresh(obj.id);\n\t\t\t\t}\n\t\t\t\tthis.RefreshTaskLinks(obj.id);\n\t\t\t}\n\t\t} else if (obj.action === \"update-task-progress\") {\n\t\t\tif (!webix.isUndefined(obj.progress)) {\n\t\t\t\tinProgress = ops.updateTask(obj.id, { progress: obj.progress });\n\t\t\t} else {\n\t\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\t\tthis.Bars.render(obj.id, task, \"paint\");\n\t\t\t}\n\t\t} else if (obj.action === \"drag-task\") {\n\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\ttask.$x = parseInt(obj.left);\n\t\t\ttask.$w = parseInt(obj.width);\n\n\t\t\tthis.RefreshTaskLinks(obj.id);\n\t\t} else if (obj.action === \"add-link\") {\n\t\t\tconst { source, target, type } = obj;\n\t\t\tinProgress = ops.addLink({ source, target, type });\n\t\t} else if (obj.action === \"temp-link\") {\n\t\t\tconst { start, end } = obj;\n\t\t\tconst link = this.GetLinks(true).firstChild;\n\n\t\t\tif (!start) {\n\t\t\t\tlink.setAttribute(\"points\", \"\");\n\t\t\t} else {\n\t\t\t\tconst { left, top, p } = this.app\n\t\t\t\t\t.getService(\"helpers\")\n\t\t\t\t\t.newLink(this.Links.$view.getBoundingClientRect(), start, end);\n\t\t\t\tconst shift = [left, top];\n\t\t\t\tconst points = p\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.map((a, i) => a * 1 + shift[i % 2])\n\t\t\t\t\t.join(\",\");\n\n\t\t\t\tlink.setAttribute(\"points\", points);\n\t\t\t}\n\t\t} else if (obj.action === \"add-task\") {\n\t\t\tconst scales = this.Local.getScales();\n\t\t\tconst unit = scales.precise\n\t\t\t\t? this.Helpers.getSmallerUnit(scales.minUnit)\n\t\t\t\t: scales.minUnit;\n\t\t\tconst start = this.Helpers.addUnit(unit, scales.start, obj.dates.start);\n\t\t\tconst end = this.Helpers.addUnit(unit, start, obj.dates.end);\n\t\t\tthis.app.callEvent(\"task:add\", [obj.id, { start, end }]);\n\t\t} else if (\n\t\t\tobj.action === \"split-resize\" &&\n\t\t\tthis.State.display !== \"resources\"\n\t\t) {\n\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\tif (task.parent != 0) {\n\t\t\t\tconst parent = this.VisibleTasks.getItem(task.parent);\n\t\t\t\tif (parent.type === \"split\") {\n\t\t\t\t\tconst splitCont = this.Bars.$view.querySelector(\n\t\t\t\t\t\t`[webix_s_id=\"${task.parent}\"]`\n\t\t\t\t\t);\n\t\t\t\t\tparent.$data.sort((a, b) => b.$x - a.$x);\n\t\t\t\t\tconst { width, left } = this.GetSplitBox(parent);\n\t\t\t\t\tsplitCont.style.width = `${width}px`;\n\t\t\t\t\tsplitCont.style.left = `${left}px`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn inProgress || webix.promise.resolve();\n\t}\n\n\t/**\n\t * Adds the layer for holiday highlighting and renders it\n\t * @param {Object} scales - current scales\n\t */\n\tHandleHolidays(scales) {\n\t\tlet html =\n\t\t\t\"<div class='webix_gantt_bar_holidays' style='height:\" +\n\t\t\tthis.Bars.$view.scrollHeight +\n\t\t\t\"px'></div>\";\n\t\tif (this.Calendars)\n\t\t\thtml +=\n\t\t\t\t\"<div class='webix_gantt_bar_resource_holidays' style='height:\" +\n\t\t\t\tthis.Bars.$view.scrollHeight +\n\t\t\t\t\"px'></div>\";\n\t\tthis.Holidays.setHTML(html);\n\t\tthis.holidaysContainer = this.Holidays.$view.querySelector(\n\t\t\t\".webix_gantt_bar_holidays\"\n\t\t);\n\t\tthis.resHolidaysContainer = this.Holidays.$view.querySelector(\n\t\t\t\".webix_gantt_bar_resource_holidays\"\n\t\t);\n\t\tthis.RenderHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => this.RenderHolidays(scales));\n\t\tthis.on(this.app.getRoot(), \"onViewShow\", () => {\n\t\t\tthis.refresh();\n\t\t});\n\t}\n\n\tEachScaleDate(scales, func) {\n\t\tif (scales.minUnit === \"day\" || scales.minUnit === \"hour\") {\n\t\t\tlet date = webix.Date.copy(scales.start);\n\n\t\t\tlet end = webix.Date.dayStart(scales.end);\n\t\t\tif (!(scales.end - end)) {\n\t\t\t\tend = webix.Date.add(end, -1, \"day\", true);\n\t\t\t}\n\n\t\t\tlet hourOffset = scales.start.getHours();\n\n\t\t\twhile (date <= end) {\n\t\t\t\tfunc.call(this, date, hourOffset);\n\t\t\t\tdate = webix.Date.add(webix.Date.dayStart(date), 1, \"day\", true);\n\t\t\t\thourOffset = webix.Date.equal(date, end)\n\t\t\t\t\t? 24 - Math.ceil(webix.Date.timePart(scales.end) / 60 / 60)\n\t\t\t\t\t: 0;\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Renders holiday highlighting\n\t * @param {Object} scales - current scales\n\t */\n\tRenderHolidays(scales) {\n\t\tif (this.holidaysContainer) {\n\t\t\tlet html = \"\";\n\t\t\tthis.EachScaleDate(scales, (date, hourOffset) => {\n\t\t\t\tif (scales.isHoliday(date)) {\n\t\t\t\t\thtml += this.HolidayTemplate(scales, date, hourOffset);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.holidaysContainer.innerHTML = html;\n\n\t\t\tif (this.Calendars) this.RenderResourceHolidays(scales);\n\t\t}\n\t}\n\tMarkResourceHolidays(scales, id, calendar) {\n\t\tlet index = this.Bars.getIndexById(id);\n\t\tif (index < 0) return \"\";\n\t\tlet html = \"\",\n\t\t\tn = 0,\n\t\t\tdateStart = null;\n\n\t\tthis.EachScaleDate(scales, (date, hourOffset) => {\n\t\t\tconst isHoliday = scales.isHoliday(date);\n\t\t\tif (this.Helpers.isResourceHoliday(date, calendar)) {\n\t\t\t\tif (!isHoliday) {\n\t\t\t\t\tif (!n) dateStart = date;\n\t\t\t\t\tn++;\n\t\t\t\t} else if (n) {\n\t\t\t\t\thtml += this.ResourceHolidayTemplate(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdateStart,\n\t\t\t\t\t\thourOffset,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tn\n\t\t\t\t\t);\n\t\t\t\t\tn = 0;\n\t\t\t\t}\n\t\t\t} else if (isHoliday) {\n\t\t\t\tif (n) {\n\t\t\t\t\thtml += this.ResourceHolidayTemplate(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdateStart,\n\t\t\t\t\t\thourOffset,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tn\n\t\t\t\t\t);\n\t\t\t\t\tn = 0;\n\t\t\t\t}\n\t\t\t\thtml += this.ResourceWorkDayTemplate(scales, date, hourOffset, index);\n\t\t\t}\n\t\t});\n\t\treturn html;\n\t}\n\tRenderResourceHolidays(scales) {\n\t\tif (this.resHolidaysContainer) {\n\t\t\tscales = scales || this.Local.getScales();\n\t\t\tthis.Local.taskCalendarMap().then(data => {\n\t\t\t\tlet html = \"\";\n\t\t\t\tif (data)\n\t\t\t\t\tfor (let taskId in data)\n\t\t\t\t\t\thtml += this.MarkResourceHolidays(scales, taskId, data[taskId]);\n\t\t\t\tthis.resHolidaysContainer.innerHTML = html;\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Returns a size and position of a date column / cell\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task / row index ( optional )\n\t * @returns {object}\n\t */\n\tGetDateBox(scales, date, hourOffset, i) {\n\t\tconst astart = this.Helpers.getUnitStart(scales.minUnit, scales.start);\n\t\tconst x = Math.round(scales.diff(date, astart) * scales.cellWidth);\n\t\tconst w =\n\t\t\t(scales.minUnit === \"hour\" ? 24 - hourOffset : 1) * scales.cellWidth;\n\t\tlet box = { x, w };\n\t\tif (i || i === 0) {\n\t\t\tbox.y = scales.cellHeight * i;\n\t\t\tbox.h = scales.cellHeight;\n\t\t}\n\t\treturn box;\n\t}\n\t/**\n\t * Returns a string with HTML of 1 holiday highlight element\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @returns {string}\n\t */\n\tHolidayTemplate(scales, date, hourOffset) {\n\t\tconst { x, w } = this.GetDateBox(scales, date, hourOffset);\n\t\tconst style = `left:${x}px;width:${w}px;`;\n\t\treturn \"<div class='webix_gantt_holiday' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML of holiday unit\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the start date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task index\n\t * @param {number} n - a number of holiday dates to include\n\t * @returns {string}\n\t */\n\tResourceHolidayTemplate(scales, date, hourOffset, i, n) {\n\t\tconst { x, y, w, h } = this.GetDateBox(scales, date, hourOffset, i);\n\t\tconst style = `left:${x}px;width:${w * n}px;top:${y}px;height:${h}px;`;\n\t\treturn \"<div class='webix_gantt_holiday' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML of work day unit\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task index\n\t * @returns {string}\n\t */\n\tResourceWorkDayTemplate(scales, date, hourOffset, i) {\n\t\tconst { x, y, w, h } = this.GetDateBox(scales, date, hourOffset, i);\n\t\tconst style = `left:${x + 0.2}px;width:${w - 1.2}px;top:${y}px;height:${h -\n\t\t\t1}px;`;\n\t\treturn \"<div class='webix_gantt_work_day' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML content of a tooltip for tasks\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string}\n\t */\n\tGetTooltip(obj, _) {\n\t\tconst parser = webix.i18n.longDateFormatStr;\n\t\tlet tip = `${obj.text || _(\"(no title)\")}<br>\n\t\t\t<br>${_(\"Start date\")}: ${parser(obj.start_date)}`;\n\n\t\tif (obj.type != \"milestone\") {\n\t\t\ttip += `<br>${_(\"End date\")}: ${parser(obj.end_date)}\n\t\t\t<br>${_(\"Lasts\")} ${obj.duration} ${obj.duration > 1 ? _(\"days\") : _(\"day\")}`;\n\t\t}\n\t\treturn tip;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ScalesView extends JetView {\n\tconfig() {\n\t\treturn { view: \"template\", height: 20, css: \"webix_gantt_scale\" };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tconst scales = this.Local.getScales();\n\t\tthis.RenderScales(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => this.RenderScales(scales));\n\t}\n\n\tready() {\n\t\tconst view = this.getRoot();\n\t\tthis.on(this.State.$changes, \"left\", x => view.scrollTo(x, null));\n\t}\n\n\t/**\n\t * Renders gantt scales\n\t * @param {Object} s - the object that stores the data of current scales\n\t */\n\tRenderScales(s) {\n\t\tconst view = this.getRoot();\n\t\tconst html = s.rows\n\t\t\t.map(line => {\n\t\t\t\tconst canMarkHolidays =\n\t\t\t\t\t(line.type === \"hour\" || line.type === \"day\") && line.step === 1;\n\t\t\t\treturn (\n\t\t\t\t\t`<div class=\"webix_gantt_scale_row\" style='height:${line.height}px;width:${s.width}px'>` +\n\t\t\t\t\tline.cells\n\t\t\t\t\t\t.map(cell => this.CellTemplate(cell, canMarkHolidays))\n\t\t\t\t\t\t.join(\"\") +\n\t\t\t\t\t\"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tview.config.height = s.height;\n\t\tview.setHTML(html);\n\t\tview.resize();\n\t}\n\n\t/**\n\t * Returns the template string for a scale unit\n\t * @param {Object} cell - a scale unit\n\t * @param {boolean} canMarkHolidays - signals whether to add styling for holidays\n\t * @returns {string} - the template string of the scale cell\n\t */\n\tCellTemplate(cell, canMarkHolidays) {\n\t\treturn `<div class=\"webix_gantt_scale_cell ${cell.css +\n\t\t\t(canMarkHolidays && this.app.config.isHoliday(cell.date)\n\t\t\t\t? \"webix_gantt_holiday_scale\"\n\t\t\t\t: \"\")}\" style=\"width:${cell.width}px;\">${this.FormatDate(\n\t\t\tcell.date,\n\t\t\tcell.format\n\t\t)}</div>`;\n\t}\n\n\tFormatDate(date, format) {\n\t\tif (typeof format === \"string\") format = webix.Date.dateToStr(format);\n\t\treturn format(date);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nimport ScaleView from \"./scale\";\nimport BarsView from \"./bars\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\treturn { rows: [ScaleView, BarsView] };\n\t}\n\tinit() {\n\t\tthis.on(this.app, \"bars:toggle\", v => {\n\t\t\tif (v) this.getRoot().show();\n\t\t\telse this.getRoot().hide();\n\t\t});\n\t}\n}\n","import BarsView from \"../chart/bars\";\n\nexport default class DiagramView extends BarsView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\treturn {\n\t\t\tview: \"abslayout\",\n\t\t\tcss: \" webix_gantt_readonly\",\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_holidays\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"tree\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttype: this.WorkloadMarkersType(),\n\t\t\t\t\tcss: `webix_gantt${\n\t\t\t\t\t\twebix.env.touch ? \"_touch\" : \"\"\n\t\t\t\t\t}_bars webix_gantt_resdiagram_chart`,\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t\trelative: true,\n\t\t\t\t\tfilterMode: {\n\t\t\t\t\t\tshowSubItems: false,\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tconst [holidays, bars] = view.getChildViews();\n\t\tthis.Holidays = holidays;\n\t\tthis.Bars = bars;\n\t\tthis.LocalState = this.getParam(\"localState\");\n\t\tthis.Unit = \"hours\";\n\n\t\tconst local = (this.Local = this.app.getService(\"local\"));\n\t\tconst scales = (this.Scales = local.getScales());\n\t\tthis.RDCollection = this.app.getService(\"grouping\").getRDCollection();\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\tthis.on(this.Bars.data, \"onSyncApply\", () => {\n\t\t\tthis.Scales = this.Local.getScales();\n\t\t\tthis.RestoreTreeState();\n\t\t\tif (this.Calendars) this.RenderResourceHolidays();\n\t\t});\n\n\t\tthis.Bars.sync(this.RDCollection, function() {\n\t\t\tthis.filter(t => t.$group);\n\t\t});\n\n\t\tthis.Calendars = this.app.config.resourceCalendars;\n\n\t\t// leave here for app.refresh() calls (inc. from Locale plugin)\n\t\tthis.DrawGrid(view, scales);\n\n\t\t// the order of DrawGrid-HandleScroll and HandleHolidays is important for the case when\n\t\t// main gantt chart is scrolled x and the diagram is empty or has something only in the\n\t\t// beginning of x-axis\n\t\tthis.HandleScroll();\n\t\tthis.HandleHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tthis.DrawGrid(view, scales);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:branch:toggle\", (id, v) => {\n\t\t\tthis.ToggleBranch(id, v);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:resize\", () => {\n\t\t\tthis.holidaysContainer.style.height = this.Bars.$view.scrollHeight + \"px\";\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:sort\", (by, dir, as) => {\n\t\t\tif (by) this.Bars.sort(by, dir, as);\n\t\t\telse this.Bars.sort(as, dir);\n\t\t});\n\n\t\tif (this.Calendars)\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", () => {\n\t\t\t\tthis.RenderResourceHolidays();\n\t\t\t});\n\t}\n\n\t/**\n\t * Opens or closes a branch of the diagram\n\t * @param {number} id - the id of a branch\n\t * @param {Boolean} v - if true, the branch will be opened; false - closed\n\t */\n\tToggleBranch(id, v) {\n\t\tif (v) this.Bars.open(id);\n\t\telse this.Bars.close(id);\n\n\t\tconst root = this.Bars.data.getBranch(\"0\");\n\t\tconst opened = this.Bars.getState().open.filter(i => {\n\t\t\treturn root.find(o => o.id == i);\n\t\t});\n\n\t\tthis._treeOpened = opened.map(id => this.Bars.getIndexById(id));\n\n\t\tthis.holidaysContainer.style.height = this.Bars.$view.clientHeight + \"px\";\n\t\tif (this.Calendars) {\n\t\t\tthis.resHolidaysContainer.style.height =\n\t\t\t\tthis.Bars.$view.clientHeight + \"px\";\n\t\t\tthis.RenderResourceHolidays();\n\t\t}\n\t}\n\n\t/**\n\t * Restores opened/closed branches after diagram update and regroup\n\t */\n\tRestoreTreeState() {\n\t\tif (this._treeOpened && this._treeOpened.length) {\n\t\t\tconst t = this._treeOpened;\n\t\t\tconst root = this.Bars.data.getBranch(\"0\");\n\t\t\troot.forEach(b => {\n\t\t\t\tconst ind = root.indexOf(b);\n\t\t\t\tb.open = !t.indexOf(ind);\n\t\t\t\tthis.Bars.data.callEvent(\"onStoreUpdated\", [b.id, 0, \"branch\"]);\n\t\t\t});\n\t\t} else this.Bars.openAll();\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\t\t\tthis.getRoot().$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.State.left = left;\n\t\t\tthis.LocalState.top = top;\n\t\t\tthis.SetHolidaysScroll(bars.scrollHeight, left, top);\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"top\", y => {\n\t\t\tthis.Bars.scrollTo(this.State.left, y);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"left\", v => {\n\t\t\tthis.Bars.scrollTo(v, this.LocalState.top);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:unit:change\", u => {\n\t\t\tthis.Unit = u;\n\t\t\tthis.Bars.render();\n\t\t});\n\t}\n\n\t/**\n\t * Returns all templates for bars\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {Object} - all templates for bars\n\t */\n\tWorkloadMarkersType() {\n\t\treturn {\n\t\t\ttemplate: task => this.MarkerTemplate(task),\n\t\t\ttemplateStart: (task, common) => this.MarkerStartTemplate(task, common),\n\t\t\ttemplateEnd: () => \"</div>\",\n\t\t};\n\t}\n\n\t/**\n\t * Defines the html of the data item of the diagram tree\n\t * @param {Object} task - data object\n\t * @returns {string} with HTML\n\t */\n\tMarkerStartTemplate(task, common) {\n\t\treturn `<div webix_tm_id=\"${task.id}\" style=\"height:${this.Scales\n\t\t\t.cellHeight - 8}px; padding: 4px;\" class=\"${common.classname(\n\t\t\ttask,\n\t\t\tcommon\n\t\t)} webix_gantt_diagram_line\" ${common.aria(task)}>`;\n\t}\n\n\t/**\n\t * Defines the looks and contents of a diagram workload marker\n\t * @param {Object} task - data object\n\t * @returns {string} with HTML\n\t */\n\tMarkerTemplate(task) {\n\t\tif (task.$level === 2) {\n\t\t\tconst markers = this.GetMarkerData(task);\n\n\t\t\tconst html = [];\n\t\t\tfor (const x in markers) {\n\t\t\t\thtml.push(this.MarkerToHTML(markers[x]));\n\t\t\t}\n\n\t\t\treturn html.join(\"\");\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tCheckResourceHoliday(date, id) {\n\t\tif (this.Calendars) {\n\t\t\tconst resId = this.Bars.getItem(id).resource_id;\n\t\t\tif (resId) {\n\t\t\t\tconst calendarId = this.Local.resources().getItem(resId).calendar_id;\n\t\t\t\tif (calendarId) {\n\t\t\t\t\tconst calendar = this.Local.calendars().getItem(calendarId);\n\t\t\t\t\treturn this.Helpers.isResourceHoliday(date, calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.app.config.isHoliday(date);\n\t}\n\t/**\n\t * Calculates work load per unit and prepares the result for display on the diagram\n\t * @param {Object} task - the data object of the data collection\n\t * @returns {Object} an object with x coordinates as keys and marker data objects and values (hours, count of tasks)\n\t */\n\tGetMarkerData(task) {\n\t\tconst markers = {};\n\t\tfor (let a = 0; a < task.duration.length; ++a) {\n\t\t\tlet d = task.duration[a];\n\t\t\tconst hourParts = task.units[a];\n\t\t\tconst delta = task.$x[a] - Math.min(...task.$x);\n\n\t\t\tconst markerWidth = this.Scales.cellHeight > 40 ? 28 : 20;\n\t\t\tconst step = this.Scales.cellWidth - markerWidth;\n\t\t\tconst halfStep = Math.round(step / 2);\n\t\t\tlet x = delta ? -2 : halfStep;\n\t\t\tlet date = webix.Date.copy(task.start_date[a]);\n\t\t\tfor (let i = 0; i < d; ++i, x += step) {\n\t\t\t\tif (\n\t\t\t\t\tthis.app.config.excludeHolidays &&\n\t\t\t\t\tthis.CheckResourceHoliday(date, task.id)\n\t\t\t\t) {\n\t\t\t\t\t++d;\n\t\t\t\t} else {\n\t\t\t\t\tlet hours = 0;\n\t\t\t\t\tif (this.Scales.minUnit !== \"hour\")\n\t\t\t\t\t\thours =\n\t\t\t\t\t\t\t(i === d - 1 ? hourParts[1] : i ? hourParts[2] : hourParts[0]) ||\n\t\t\t\t\t\t\thourParts[2];\n\t\t\t\t\telse {\n\t\t\t\t\t\thours = hourParts[2];\n\t\t\t\t\t}\n\n\t\t\t\t\tconst cell = task.$x[a] + i * this.Scales.cellWidth - 2;\n\t\t\t\t\tif (!markers[cell]) {\n\t\t\t\t\t\tmarkers[cell] = { hours, x: cell + halfStep, count: 1 };\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarkers[cell].hours += hours;\n\t\t\t\t\t\tmarkers[cell].count += 1;\n\t\t\t\t\t}\n\t\t\t\t\tmarkers[cell].overloaded = this.CheckOverload(markers[cell], task);\n\t\t\t\t}\n\t\t\t\twebix.Date.add(date, 1, this.Scales.minUnit);\n\t\t\t}\n\t\t}\n\n\t\treturn markers;\n\t}\n\n\t/**\n\t * Checks if a resource is overloaded during this unit of time\n\t * @param {Object} marker - the data of a diagram marker for one unit\n\t * @returns {boolean} true if during this unit resource is overloaded with work\n\t */\n\tCheckOverload(marker) {\n\t\tif (this.Scales.minUnit === \"hour\") {\n\t\t\t// temp until full support for hourly duration is done\n\t\t\treturn Math.round(marker.hours * 24) > this.Helpers.unitLoadNorm.day;\n\t\t}\n\t\treturn marker.hours > this.Helpers.unitLoadNorm[this.Scales.minUnit];\n\t}\n\n\t/**\n\t * Returns the html of a marker\n\t * @param {Object} marker - an object with data for a marker (hours, count of tasks)\n\t */\n\tMarkerToHTML(marker) {\n\t\tconst over = marker.overloaded ? \"webix_gantt_overload\" : \"\";\n\t\tconst number =\n\t\t\tthis.Unit === \"hours\"\n\t\t\t\t? marker.hours >= 1\n\t\t\t\t\t? marker.hours\n\t\t\t\t\t: \" \"\n\t\t\t\t: marker.count;\n\t\treturn `<div class=\"webix_gantt_diagram_marker ${over}\" style=\"left:${marker.x}px;\">${number}</div>`;\n\t}\n\n\tRenderResourceHolidays(scales) {\n\t\tscales = scales || this.Local.getScales();\n\t\tlet html = \"\";\n\t\tthis.Bars.data.each(data => {\n\t\t\tif (data.resource_id) {\n\t\t\t\tconst calendarId = this.Local.resources().getItem(data.resource_id)\n\t\t\t\t\t.calendar_id;\n\t\t\t\tif (calendarId)\n\t\t\t\t\thtml += this.MarkResourceHolidays(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdata.id,\n\t\t\t\t\t\tthis.Local.calendars().getItem(calendarId)\n\t\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\tthis.resHolidaysContainer.innerHTML = html;\n\t}\n}\n","/**\n * Prepares a sorting function with locale-based comparison\n * @param {string} by - column ID\n * @returns {function} sorting function\n */\nexport function sort(by) {\n\treturn (a, b) =>\n\t\ta[by].localeCompare(b[by], undefined, {\n\t\t\tignorePunctuation: true,\n\t\t\tnumeric: true,\n\t\t});\n}\n\n/**\n * Check if two arrays contain same elements\n * @param {array} a - an array\n * @param {array} b - an array\n * @returns {boolean} true if two arrays contain same elements\n */\nexport function arrayEquals(a, b) {\n\treturn a && a.length == b.length && a.every(item => b.includes(item));\n}\n","import { JetView } from \"webix-jet\";\nimport { sort } from \"../../helpers/common\";\n\nexport default class TreeView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst scales = this.app.getService(\"local\").getScales();\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst compact = (this.Compact = this.getParam(\"compact\", true));\n\n\t\tconst columns = [\n\t\t\t{\n\t\t\t\tid: \"name\",\n\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\theader: compact ? \"<span class='webix_icon gti-menu'>\" : _(\"Name\"),\n\t\t\t\ttemplate: (obj, common) => this.TreeTemplate(obj, common),\n\t\t\t\tfillspace: true,\n\t\t\t\tsort: compact ? \"\" : sort(\"name\"),\n\t\t\t\tminWidth: compact ? 44 : 150,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"load\",\n\t\t\t\theader: _(\"Hours\"),\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"hours\",\n\t\t\t\tsort: \"int\",\n\t\t\t\tminWidth: 50,\n\t\t\t\tresize: false,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"count\",\n\t\t\t\theader: _(\"Tasks\"),\n\t\t\t\tbatch: \"tasks\",\n\t\t\t\tsort: \"int\",\n\t\t\t\tminWidth: 50,\n\t\t\t\thidden: true,\n\t\t\t\tresize: false,\n\t\t\t},\n\t\t];\n\n\t\tconst skin = webix.skin.$name;\n\t\tconst headerCss =\n\t\t\tskin == \"material\" || skin == \"mini\" ? \"webix_header_border\" : \"\";\n\t\tconst tree = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_resdiagram_tree \" + headerCss,\n\t\t\tprerender: true,\n\t\t\tborderless: skin === \"contrast\",\n\t\t\twidth: compact ? 44 : this.State.treeWidth,\n\t\t\trowHeight: scales.cellHeight,\n\t\t\theaderRowHeight: scales.height,\n\t\t\tscroll: \"xy\",\n\t\t\tscrollAlignY: false,\n\t\t\tsort: true,\n\t\t\tresizeColumn: {\n\t\t\t\theaderOnly: true,\n\t\t\t\tsize: 10,\n\t\t\t},\n\t\t\tcolumns,\n\t\t\ttooltip: () => \"\",\n\t\t\ton: {\n\t\t\t\tonViewResize: () => {\n\t\t\t\t\tthis.State.treeWidth = this.Tree.$width;\n\t\t\t\t},\n\t\t\t\tonAfterOpen: id => this.ToggleBranch(id, 1),\n\t\t\t\tonAfterClose: id => this.ToggleBranch(id, 0),\n\t\t\t\tonAfterSort: (by, dir, as) => this.SortTasks(by, dir, as),\n\t\t\t\tonColumnResize: (id, v, o, user) => this.NormalizeColumns(id, user),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"gti-menu\": () => this.ToggleColumns(),\n\t\t\t},\n\t\t\tfilterMode: {\n\t\t\t\tshowSubItems: false,\n\t\t\t\tlevel: 0,\n\t\t\t},\n\t\t};\n\n\t\tconst ls = (this.LocalState = this.getParam(\"localState\"));\n\t\ttree.on[\"onScrollY\"] = tree.on[\"onSyncScroll\"] = tree.on[\n\t\t\t\"onAfterScroll\"\n\t\t] = function() {\n\t\t\tls.top = this.getScrollState().y;\n\t\t};\n\t\treturn tree;\n\t}\n\n\tinit(view) {\n\t\tthis.Tree = view;\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.RDCollection = this.app.getService(\"grouping\").getRDCollection();\n\t\tthis._unit = \"hours\";\n\t\tthis._collapsed = true;\n\n\t\tthis.on(this.LocalState.$changes, \"top\", y => {\n\t\t\tthis.Tree.scrollTo(null, y);\n\t\t});\n\n\t\tthis.on(this.Tree.data, \"onSyncApply\", () => this.RestoreTreeState());\n\n\t\tview.sync(this.RDCollection, function() {\n\t\t\tthis.filter(t => t.$group);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"treeWidth\", v => {\n\t\t\tif (!this.Compact && view.$width !== v) {\n\t\t\t\tview.define({ width: v });\n\t\t\t\tview.resize();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:unit:change\", u => this.ShowInUnits(u));\n\n\t\t// resetting headerRowHeight\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tconst col = this.Tree.columnId(0);\n\t\t\tthis.Tree.getColumnConfig(col).header[0].height = scales.height;\n\t\t\tthis.Tree.refreshColumns();\n\t\t});\n\t}\n\n\t/**\n\t * Opens/closes same branches as were opened/closed before updates\n\t */\n\tRestoreTreeState() {\n\t\tif (this._treeOpened && this._treeOpened.length) {\n\t\t\tconst t = this._treeOpened;\n\t\t\tconst root = this.Tree.data.getBranch(\"0\");\n\t\t\troot.forEach(b => {\n\t\t\t\tconst ind = root.indexOf(b);\n\t\t\t\tb.open = !t.indexOf(ind);\n\t\t\t\tthis.Tree.data.callEvent(\"onStoreUpdated\", [b.id, 0, \"branch\"]);\n\t\t\t});\n\t\t} else this.Tree.openAll();\n\t}\n\n\t/**\n\t * Defines the look of a tree item\n\t * @param {Object} obj - data object of a tree item\n\t * @param {Object} common - type object of tree\n\t */\n\tTreeTemplate(obj, common) {\n\t\tconst compact = this.Compact && this._collapsed;\n\t\tif (obj.$level == 1)\n\t\t\treturn compact\n\t\t\t\t? common.icon(obj)\n\t\t\t\t: common.treetable(obj, common) + obj.category;\n\n\t\tif (compact) return this.Helpers.resourceAvatar(obj);\n\t\treturn common.space(obj) + this.Helpers.resourceAvatar(obj) + obj.name;\n\t}\n\n\t/**\n\t * Shows total workload in tasks or hours\n\t * @param {string} u - \"tasks\" or \"hours\"\n\t */\n\tShowInUnits(u) {\n\t\tthis._unit = u;\n\t\tconst tree = this.Tree;\n\t\tconst cols = tree.config.columns;\n\t\tconst lastFillspace = cols[cols.length - 1].fillspace;\n\t\tif (!this.Compact || !this._collapsed) tree.showColumnBatch(u);\n\t\t// columns normalizing\n\t\tthis.SetColumns(0, lastFillspace);\n\t}\n\n\t/**\n\t * Adjusts columns after resizing\n\t * @param {string} id - ID of the column being resized\n\t * @param {boolean} user - defines whether resizing was triggered by user or API\n\t */\n\tNormalizeColumns(id, user) {\n\t\tif (!user) return;\n\t\tthis.SetColumns(this.Tree.getColumnIndex(id), true);\n\t}\n\n\tSetColumns(index, fillspace) {\n\t\tconst columns = this.Tree.config.columns;\n\t\tconst last = columns.length - 1;\n\t\tif (index === 0) {\n\t\t\tcolumns[last].fillspace = fillspace;\n\t\t\tcolumns[last].width = 0;\n\t\t\tcolumns[last].resize = false;\n\t\t} else if (index === last) {\n\t\t\tcolumns[0].fillspace = true;\n\t\t\tcolumns[0].width = 0;\n\t\t}\n\t\tthis.Tree.refreshColumns();\n\t}\n\n\t/** Shows and hides columns in a compact mode */\n\tToggleColumns() {\n\t\t// [todo] toggle tree in compact code\n\t\tconst tree = this.Tree;\n\t\tconst lv = tree.isColumnVisible(\"load\");\n\t\tconst cv = tree.isColumnVisible(\"count\");\n\t\tconst vis = (this._collapsed = lv || cv);\n\n\t\tif (vis) {\n\t\t\tif (lv) tree.hideColumn(\"load\");\n\t\t\tif (cv) tree.hideColumn(\"count\");\n\t\t} else {\n\t\t\tif (this._unit === \"hours\") tree.showColumn(\"load\");\n\t\t\telse tree.showColumn(\"count\");\n\t\t}\n\n\t\ttree.config.width = vis ? 44 : 0;\n\t\tconst nameCol = tree.config.columns[0];\n\t\tnameCol.minWidth = vis ? 44 : 150;\n\t\ttree.resize();\n\t\ttree.refreshColumns();\n\n\t\tthis.app.callEvent(\"rdiagram:tree:toggle\", [vis]);\n\t}\n\n\t/**\n\t * Hides/Shows the lines of the diagram for the closed/opened tree branch\n\t * @param {number} id - the ID of a branch\n\t * @param {Number} v - the state of a branch (1 - opened, 0 - closed)\n\t */\n\tToggleBranch(id, v) {\n\t\tconst root = this.Tree.data.getBranch(\"0\");\n\t\tconst opened = this.Tree.getState().open.filter(i => {\n\t\t\treturn root.find(o => o.id == i);\n\t\t});\n\t\tthis._treeOpened = opened.map(id => this.Tree.getIndexById(id));\n\n\t\tthis.app.callEvent(\"rdiagram:branch:toggle\", [id, v]);\n\t}\n\n\tSortTasks(by, dir, as) {\n\t\tthis.app.callEvent(\"rdiagram:sort\", [by, dir, as]);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TreeView from \"./tree\";\nimport ScalesView from \"../chart/scale\";\nimport DiagramView from \"./diagram\";\n\nimport { createState } from \"jet-restate\";\n\nexport default class RDiagramView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst contrast = webix.skin.$name === \"contrast\";\n\t\tconst unit = this.app.getService(\"local\").getScales().minUnit;\n\t\treturn {\n\t\t\ttype: contrast ? \"clean\" : \"line\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tborderless: contrast,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\twidth: 330,\n\t\t\t\t\t\t\tvalue: \"hours\",\n\t\t\t\t\t\t\tlocalId: \"radio\",\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{ id: \"hours\", value: `${_(\"Hours per\")} ${_(unit)}` },\n\t\t\t\t\t\t\t\t{ id: \"tasks\", value: `${_(\"Tasks per\")} ${_(unit)}` },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: v => {\n\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:unit:change\", [v]);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\tTreeView,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: compact ? \"spacer\" : \"resizer\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\t\t\t\twidth: compact ? 1 : 4,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"diagram\",\n\t\t\t\t\t\t\trows: [ScalesView, DiagramView],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst localState = createState({\n\t\t\ttop: 0,\n\t\t});\n\t\tthis.setParam(\"localState\", localState);\n\n\t\tthis.on(this.app, \"rdiagram:tree:toggle\", v => {\n\t\t\tif (v) this.$$(\"diagram\").show();\n\t\t\telse this.$$(\"diagram\").hide();\n\t\t});\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst radio = this.$$(\"radio\");\n\t\tthis.on(this.app, \"onScalesUpdate\", (scales, old) => {\n\t\t\tif (scales.minUnit !== old.minUnit) {\n\t\t\t\tradio.config.options.map(o => {\n\t\t\t\t\tconst words = o.value.split(\" \");\n\t\t\t\t\twords[words.length - 1] = _(scales.minUnit);\n\t\t\t\t\to.value = words.join(\" \");\n\t\t\t\t});\n\t\t\t\tradio.refresh();\n\t\t\t}\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaselineView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst calendar = {\n\t\t\tcss: \"webix_gantt_datepicker\",\n\t\t\ttype: \"calendar\",\n\t\t\tbody: {\n\t\t\t\theight: 270,\n\t\t\t\twidth: 250,\n\t\t\t\ticons: true,\n\t\t\t\tevents: date => this.app.config.isHoliday(date) && \"webix_cal_event\",\n\t\t\t},\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\tpadding: {\n\t\t\t\tleft: 3,\n\t\t\t\tright: 3,\n\t\t\t},\n\t\t\tvisibleBatch: \"added\",\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tbatch: \"added\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: \"planned_start\",\n\t\t\t\t\t\t\tlabel: _(\"Start date\"),\n\t\t\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: \"planned_end\",\n\t\t\t\t\t\t\tlabel: _(\"End date\"),\n\t\t\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"counter\",\n\t\t\t\t\t\t\tname: \"planned_duration\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_form_counter\",\n\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\tmax: 1000,\n\t\t\t\t\t\t\tlabel: _(\"Duration\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbatch: \"none\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tlabel: _(\"Add dates\"),\n\t\t\t\t\t\t\tclick: () => this.AddBtnClickHandler(),\n\t\t\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbatch: \"added\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-trash\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tlabel: _(\"Remove dates\"),\n\t\t\t\t\t\t\tclick: () => this.RemoveBtnClickHandler(),\n\t\t\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (n, o, config) => {\n\t\t\t\t\tif (this.Compact) this.UpdateTaskTime();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config == \"user\") this.UpdateTask();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Form = this.$$(\"form\");\n\n\t\t// changing links via bars and dnd\n\t\tthis.Tasks = this.app.getService(\"local\").tasks();\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected) this.FillData(id);\n\t\t});\n\t}\n\n\tFillData(id) {\n\t\tconst task = this.Tasks.getItem(id);\n\t\tif (task.planned_start) this.$$(\"form\").showBatch(\"added\");\n\t\telse this.$$(\"form\").showBatch(\"none\");\n\t\tthis.Form.setValues(this.Tasks.getItem(id));\n\t}\n\n\t/**\n\t * Prepares task  object for processing with respect to date-related changes\n\t * @param {Object} vals - object with form values\n\t * @returns {boolean} flag that indicates whether dates were updated or not\n\t */\n\tPrepareDates(vals) {\n\t\tconst f = (this._eventSource = this.Form.$eventSource.config.name);\n\n\t\tlet updateDates = true;\n\t\tif (\n\t\t\tf == \"planned_duration\" ||\n\t\t\t(f == \"planned_start\" && vals.type == \"project\")\n\t\t)\n\t\t\tvals.planned_end = null;\n\t\telse if (f == \"planned_end\" || f == \"planned_start\")\n\t\t\tvals.planned_duration = null;\n\t\telse updateDates = false;\n\n\t\treturn updateDates;\n\t}\n\t/**\n\t * Update task time and duration on data change in compact form\n\t */\n\tUpdateTaskTime() {\n\t\tconst vals = this.Form.getValues();\n\t\tconst updateDates = this.PrepareDates(vals);\n\t\tif (updateDates) {\n\t\t\tlet mode = this._eventSource ? this._eventSource.split(\"_\")[1] : null;\n\t\t\tif (mode == \"duration\") mode = null;\n\n\t\t\tthis.Ops.updatePlannedTaskDuration(vals, mode);\n\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\t}\n\t/**\n\t * Saves changes\n\t * @returns {Promise} the result of a data operation (adding new event or updating)\n\t */\n\tUpdateTask() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tif (!this.Compact) this.PrepareDates(vals);\n\n\t\tlet mode = this._eventSource ? this._eventSource.split(\"_\")[1] : null;\n\t\tif (mode == \"duration\") mode = null;\n\t\tthis.Ops.updateTask(id, vals, mode, false, true);\n\t}\n\tAddBtnClickHandler() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tconst obj = {\n\t\t\tplanned_start: vals.start_date,\n\t\t\tplanned_end: vals.end_date,\n\t\t\tplanned_duration: vals.duration,\n\t\t};\n\t\tthis.Ops.updateTask(id, obj, null, false, true);\n\t}\n\tRemoveBtnClickHandler() {\n\t\tconst id = this.State.selected;\n\t\twebix\n\t\t\t.confirm(this._(\"Planned dates will be removed, are you sure?\"))\n\t\t\t.then(() => {\n\t\t\t\tthis.Ops.updateTask(\n\t\t\t\t\tid,\n\t\t\t\t\t{ planned_start: null, planned_end: null, planned_duration: null },\n\t\t\t\t\tnull,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_tree webix_gantt_form_tree\",\n\t\t\theader: false,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"links\",\n\t\t\tautoheight: true,\n\t\t\teditable: true,\n\t\t\tscroll: false,\n\t\t\thover: \"webix_gantt_link_table_hover\",\n\t\t\tscheme: {\n\t\t\t\t$group: {\n\t\t\t\t\tby: \"ttype\",\n\t\t\t\t},\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"task\",\n\t\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\t\theader: _(\"Task\"),\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\tif (obj.$group)\n\t\t\t\t\t\t\treturn `<span class=\"webix_strong\">${_(\n\t\t\t\t\t\t\t\tobj.ttype == \"source\" ? _(\"Successors\") : _(\"Predecessors\")\n\t\t\t\t\t\t\t)}</span>`;\n\t\t\t\t\t\telse return obj.text || _(\"(no title)\");\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"type\",\n\t\t\t\t\tcss: \"webix_gantt_type\",\n\t\t\t\t\theader: _(\"Link\"),\n\t\t\t\t\twidth: 140,\n\t\t\t\t\ttemplate: function(obj, c, v, conf) {\n\t\t\t\t\t\tif (obj.$group) return \"\";\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconst type = conf.collection.getItem(v).value;\n\t\t\t\t\t\t\treturn `${type}<span class=\"webix_icon wxi-menu-down\"></span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\teditor: \"richselect\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"0\", value: _(\"End to start\") },\n\t\t\t\t\t\t{ id: \"1\", value: _(\"Start to start\") },\n\t\t\t\t\t\t{ id: \"2\", value: _(\"End to end\") },\n\t\t\t\t\t\t{ id: \"3\", value: _(\"Start to end\") },\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 30,\n\t\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\treturn obj.$group\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: \"<span class='webix_icon wxi-trash'></span>\";\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonBeforeEditStart: function(id) {\n\t\t\t\t\treturn !this.getItem(id).$group;\n\t\t\t\t},\n\t\t\t\tonBeforeEditStop: (v, editor) => {\n\t\t\t\t\tif (v.value != v.old) {\n\t\t\t\t\t\tthis.UpdateLink(editor.row, { type: v.value * 1 });\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterLoad: function() {\n\t\t\t\t\tthis.openAll();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"wxi-trash\": (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\t\ttitle: _(\"Delete link\"),\n\t\t\t\t\t\t\ttext: _(\"The link will be deleted permanently, are you sure?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.DeleteLink(id));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tpadding: { top: webix.skin.$active.layoutMargin.form, bottom: 5 },\n\t\t\trows: [table],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Links = this.$$(\"links\");\n\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\n\t\t// changing links via bars and dnd\n\t\tconst links = this.app.getService(\"local\").links();\n\t\tthis.on(links.data, \"onStoreUpdated\", (_id, obj) => {\n\t\t\tif (obj) {\n\t\t\t\tconst tid = this.State.selected;\n\t\t\t\tif (obj.target === tid || obj.source === tid) {\n\t\t\t\t\tthis.FillData(tid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tFillData(id) {\n\t\tconst local = this.app.getService(\"local\");\n\t\tconst related = local\n\t\t\t.getLinks(id, \"target\")\n\t\t\t.concat(local.getLinks(id, \"source\"));\n\n\t\tthis.Links.clearAll();\n\t\tif (related.length) {\n\t\t\tthis.Links.parse(related);\n\t\t\tthis.getRoot().show();\n\t\t} else {\n\t\t\tthis.getRoot().hide();\n\t\t}\n\t}\n\n\tUpdateLink(id, obj) {\n\t\tthis.Ops.updateLink(id, obj).then(() => {\n\t\t\tthis.Links.blockEvent();\n\t\t\tthis.Links.editCancel();\n\t\t\tthis.Links.unblockEvent();\n\n\t\t\t// must not give 0 ID to dropdown list of column editor\n\t\t\tobj.type += \"\";\n\t\t\tthis.Links.updateItem(id, obj);\n\t\t});\n\t}\n\n\tDeleteLink(id) {\n\t\tthis.Ops.removeLink(id).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n}\n","webix.editors.gantt_numeditor = webix.extend(\n\t{\n\t\trender: function() {\n\t\t\tconst node = webix.editors.text.render.call(this);\n\t\t\tconst inp = node.querySelector(\"input\");\n\t\t\tinp.type = \"number\";\n\t\t\tinp.min = 0;\n\t\t\treturn node;\n\t\t},\n\t},\n\twebix.editors.text\n);\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/numeditor\";\n\nexport default class ResourcesView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tconst conf = this.app.config;\n\t\tconst single = (this.IsSingle =\n\t\t\tconf.resources == \"single\" || conf.resourceCalendars);\n\n\t\tconst button = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tautowidth: true,\n\t\t\t\t\tlocalId: \"addBtn\",\n\t\t\t\t\tlabel: _(\"Add assignment\"),\n\t\t\t\t\tclick: () => this.AddBtnClickHandler(),\n\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_resource_table webix_gantt_tree webix_gantt_form_tree\",\n\t\t\theader: false,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"resources\",\n\t\t\tautoheight: true,\n\t\t\teditable: true,\n\t\t\teditaction: \"custom\",\n\t\t\tscroll: false,\n\t\t\thover: \"webix_gantt_table_hover\",\n\t\t\trowHeight: Math.max(webix.skin.$active.rowHeight, 32),\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"resource\",\n\t\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: obj => this.ResourceTemplate(obj),\n\t\t\t\t\teditor: \"richselect\",\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\tcss: \"webix_gantt_select_editor_popup\",\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tpoint: 0,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\t\theight: Math.max(webix.skin.$active.listItemHeight, 32),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate: r =>\n\t\t\t\t\t\t\t\tsingle ? this.OptionTemplate(r) : this.EditorOptionTemplate(r),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\t{\n\t\t\t\t\tid: \"value\",\n\t\t\t\t\twidth: 85,\n\t\t\t\t\tcss: \"webix_gantt_value\",\n\t\t\t\t\ttemplate: obj => this.ValueTemplate(obj),\n\t\t\t\t\teditFormat: function(v) {\n\t\t\t\t\t\treturn parseFloat(v);\n\t\t\t\t\t},\n\t\t\t\t\teditParse: function(v) {\n\t\t\t\t\t\tv = parseFloat(v);\n\t\t\t\t\t\treturn isNaN(v) ? 0 : v;\n\t\t\t\t\t},\n\t\t\t\t\teditor: \"gantt_numeditor\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"remove\",\n\t\t\t\t\twidth: 30,\n\t\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t\t\ttemplate: obj => this.DeleteIconTemplate(obj),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => {\n\t\t\t\t\tif (!this.Table.getItem(id).$group && id.column != \"remove\") {\n\t\t\t\t\t\tthis.Table.editRow(id);\n\t\t\t\t\t\tif (id.column == \"value\")\n\t\t\t\t\t\t\tthis.Table.getEditor(id.row, \"resource\")\n\t\t\t\t\t\t\t\t.getPopup()\n\t\t\t\t\t\t\t\t.hide();\n\t\t\t\t\t\tthis.Table.getEditor(id.row, id.column).focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonBeforeEditStart: id => {\n\t\t\t\t\tconst item = this.Table.getItem(id.row);\n\t\t\t\t\tif (item.$group) return false;\n\t\t\t\t\tif (id.column == \"resource\") {\n\t\t\t\t\t\tthis.Table.addCellCss(\n\t\t\t\t\t\t\tid.row,\n\t\t\t\t\t\t\tid.column,\n\t\t\t\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst r = id && !single ? item.resource : null;\n\t\t\t\t\t\tthis.FilterOptions(r);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tonAfterEditStart: id => {\n\t\t\t\t\tif (id.column == \"value\") {\n\t\t\t\t\t\tconst item = this.Table.getItem(id.row);\n\t\t\t\t\t\tconst node = this.Table.getEditor(id.row, \"value\").getInputNode();\n\t\t\t\t\t\tconst range = this.GetRange(item);\n\t\t\t\t\t\tif (range) this.ApplyEditorLimits(node, range);\n\t\t\t\t\t\tconst step = this.GetValueStep(item);\n\t\t\t\t\t\tif (step) this.ApplyEditorStep(node, step);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonBeforeEditStop: (state, editor) => {\n\t\t\t\t\tthis.Table.removeCellCss(\n\t\t\t\t\t\teditor.row,\n\t\t\t\t\t\t\"resource\",\n\t\t\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t\t\t);\n\t\t\t\t\tif (state.value != state.old) {\n\t\t\t\t\t\tlet obj = {};\n\t\t\t\t\t\tobj[editor.column] = state.value;\n\t\t\t\t\t\tif (editor.column == \"value\") {\n\t\t\t\t\t\t\tconst item = this.Table.getItem(editor.row);\n\t\t\t\t\t\t\tconst range = this.GetRange(item);\n\t\t\t\t\t\t\tif (range) this.ApplyValueRange(obj, range);\n\t\t\t\t\t\t\telse if (obj.value < 0) obj.value = 0;\n\t\t\t\t\t\t\teditor.getInputNode().value = obj.value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.UpdateAssignment(editor.row, obj);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tonAfterLoad: function() {\n\t\t\t\t\tthis.openAll();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_gantt_remove_icon: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\t\ttitle: _(\"Delete assignment\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete this assignment?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveAssignment(id.row));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tif (!single)\n\t\t\ttable.scheme = {\n\t\t\t\t$group: {\n\t\t\t\t\tby: \"category\",\n\t\t\t\t},\n\t\t\t};\n\n\t\treturn {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: webix.skin.$active.layoutMargin.form, bottom: 5 },\n\t\t\trows: [table, button],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Table = this.$$(\"resources\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Resources = this.Local.resources();\n\t\tif (!this.app.config.resources) return false;\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\t}\n\n\t/**\n\t * Display assignments table\n\t * @param {string} id - a task id\n\t */\n\tFillData(id) {\n\t\tconst item = this.Local.tasks().getItem(id);\n\t\tif (item.type != \"task\") return false;\n\n\t\tconst loader = this.Local.getAssignments(id);\n\t\tloader.then(assignees => {\n\t\t\tif (!this.getRoot()) return false;\n\t\t\tthis.Table.clearAll();\n\t\t\tthis.Table.getColumnConfig(\"resource\").collection = this.Resources;\n\n\t\t\tif (assignees.length) {\n\t\t\t\tthis.Table.show();\n\t\t\t\tthis.Table.parse(this.GetData(assignees));\n\t\t\t\tif (this.IsSingle) this.$$(\"addBtn\").disable();\n\t\t\t} else {\n\t\t\t\tif (this.IsSingle) this.$$(\"addBtn\").enable();\n\t\t\t\tthis.Table.hide();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Get treetable data\n\t * @param {array} assignments - an array of assignments data\n\t * @returns {array} data array\n\t */\n\n\tGetData(assignments) {\n\t\tassignments.sort(this.app.getService(\"operations\").sortResources);\n\t\treturn assignments;\n\t}\n\n\t/**\n\t * Filters an option collection\n\t * @param {string} id - the selected resource id\n\t */\n\tFilterOptions(id) {\n\t\tlet tableIds = [];\n\t\tconst category = id ? this.Resources.getItem(id)[\"category_id\"] : null;\n\t\tthis.Table.data.each(item => {\n\t\t\ttableIds.push(item.resource);\n\t\t});\n\n\t\tthis.Resources.filter(item => {\n\t\t\treturn (\n\t\t\t\t(!category || item[\"category_id\"] == category) &&\n\t\t\t\t(tableIds.indexOf(item.id) < 0 || (id && item.id == id))\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Updates an assignment\n\t * @param {string} id - an assignment id\n\t * @param {object} obj - a hash of new assignment properties\n\t */\n\tUpdateAssignment(id, obj) {\n\t\t// remove \"focus\" style for a richselect cell editor when\n\t\t// the editor is closed without event calls\n\t\tconst node = this.Table.$view.querySelector(\".webix_gantt_select_editor\");\n\t\tif (node) {\n\t\t\tconst rInd = node.getAttribute(\"aria-rowindex\") * 1;\n\t\t\tthis.Table.removeCellCss(\n\t\t\t\tthis.Table.data.getIdByIndex(rInd - 1),\n\t\t\t\t\"resource\",\n\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t);\n\t\t}\n\n\t\tthis.Ops.updateAssignment(id, obj).then(() => {\n\t\t\tthis.CloseEditor(id, obj);\n\t\t});\n\t}\n\n\t/**\n\t * Get range for unit values\n\t * @param {object} item - an assignment item object\n\t * @returns {array} an array with two numeric values [min,max]\n\t */\n\tGetRange(item) {\n\t\tconst resourceItem = this.Resources.getItem(item.resource);\n\t\treturn this.Helpers.getResourceValueRange(resourceItem);\n\t}\n\n\t/**\n\t * Apply limits to \"value\" property of a data object\n\t * @param {object} obj - an object with a value property to change\n\t * @param {array} range - a value range [min,max]\n\t */\n\tApplyValueRange(obj, range) {\n\t\tif (obj.value < range[0]) obj.value = range[0];\n\t\telse if (obj.value > range[1]) obj.value = range[1];\n\t}\n\t/**\n\t * Apply limits to editor value\n\t * @param {HTMLInputElement} node - an editor input\n\t * @param {array} range - a value range [min,max]\n\t */\n\tApplyEditorLimits(node, range) {\n\t\tnode.min = range[0];\n\t\tnode.max = range[1];\n\t}\n\t/**\n\t * Get set for unit values\n\t * @param {object} item - an assignment item object\n\t * @returns {number} a step value\n\t */\n\tGetValueStep(item) {\n\t\tconst resourceItem = this.Resources.getItem(item.resource);\n\t\treturn this.Helpers.getResourceValueStep(resourceItem);\n\t}\n\n\t/**\n\t * Apply changing step to editor value\n\t * @param {HTMLInputElement} node - an editor input\n\t * @param {number} step - changing step\n\t */\n\tApplyEditorStep(node, step) {\n\t\tnode.step = step;\n\t}\n\n\t/**\n\t * Closes editor and updated table row\n\t * @param {string} id - an assignment id\n\t * @param {object} obj - assignment properties\n\t */\n\tCloseEditor(id, obj) {\n\t\tthis.Table.blockEvent();\n\t\tthis.Table.editCancel();\n\t\tthis.Table.unblockEvent();\n\n\t\tthis.Table.updateItem(id, obj);\n\t}\n\n\t/**\n\t * Removes assignment\n\t * @param {string} id - assignment id\n\t */\n\tRemoveAssignment(id) {\n\t\tthis.Ops.removeAssignment(id).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n\n\t/**\n\t *  \"Add\" button click handler\n\t */\n\tAddBtnClickHandler() {\n\t\tthis.FilterOptions();\n\t\twebix.delay(() => {\n\t\t\tthis.ShowPopup();\n\t\t});\n\t}\n\n\t/**\n\t * Adds an assignment and a new row to \"assignees\" table\n\t * @param {object} obj - assignment properties\n\t */\n\tAddAssignment(obj) {\n\t\tif (this.IsSingle) this.$$(\"addBtn\").disable();\n\t\tthis.Ops.addAssignment({\n\t\t\tresource: obj.id,\n\t\t\tvalue: this.Helpers.getDefaultResourceValue(obj),\n\t\t\ttask: this.State.selected,\n\t\t}).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n\t/**\n\t * A template for a resource column\n\t * @param {object} obj - a data item\n\t * @returns {string} an html string of a column cell\n\t */\n\tResourceTemplate(obj) {\n\t\tif (obj.$group) return `<span class=\"webix_strong\">${obj.category}</span>`;\n\t\telse if (obj.resource) {\n\t\t\tconst item = this.Resources.getItem(obj.resource);\n\t\t\treturn this.EditorTemplate(item);\n\t\t}\n\t\treturn \"\";\n\t}\n\t/**\n\t * The template for value column\n\t * @param {object} obj - an assignment data object\n\t * @returns {string} html string\n\t */\n\tValueTemplate(obj) {\n\t\tif (obj.$group) return \"\";\n\t\tconst v = obj.value;\n\t\treturn (\n\t\t\t(isNaN(v) ? this.Helpers.getDefaultResourceValue(obj) : v) +\n\t\t\tthis.GetUnitName(obj)\n\t\t);\n\t}\n\n\t/**\n\t * Get a unit name for a resource\n\t * @param {object} obj - resource object\n\t * @returns {string} a unit name\n\t */\n\tGetUnitName(obj) {\n\t\treturn this._(this.Helpers.getResourceUnit(obj));\n\t}\n\n\t/**\n\t * The template for \"delete\" column\n\t * @param {object} obj - assignment data object\n\t * @returns {string} html string\n\t */\n\tDeleteIconTemplate(obj) {\n\t\tif (obj.$group) return \"\";\n\t\treturn \"<span class='webix_icon wxi-trash webix_gantt_remove_icon'></span>\";\n\t}\n\n\t/**\n\t * Get popup configuration\n\t * @returns {object} popup config\n\t */\n\tGetPopupConfig() {\n\t\treturn {\n\t\t\tview: \"suggest\",\n\t\t\tlocalId: \"popup\",\n\t\t\twidth: 320,\n\t\t\tpadding: 0,\n\t\t\tpoint: 0,\n\t\t\tfitMaster: false,\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_gantt_select_editor_popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tminHeight: 28,\n\t\t\t\ttype: {\n\t\t\t\t\theight: Math.max(webix.skin.$active.listItemHeight, 32),\n\t\t\t\t},\n\t\t\t\tdata: this.Resources,\n\t\t\t\ttemplate: obj => this.OptionTemplate(obj),\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.AddAssignment(this.Resources.getItem(id));\n\t\t\t\t\t\tthis.Popup.hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Show resources popup\n\t */\n\tShowPopup() {\n\t\tif (!this.Popup || !this.Popup.$view) {\n\t\t\tthis.Popup = this.ui(this.GetPopupConfig());\n\t\t\tthis.SetPopupPlaceholder();\n\t\t}\n\n\t\tthis.Popup.show(this.$$(\"addBtn\").$view, { x: 1 });\n\t}\n\n\t/**\n\t * Set a placeholder for the \"Add\" popup placeholder\n\t * @param {string} placeholder - a popup placeholder (optional)\n\t */\n\tSetPopupPlaceholder(placeholder) {\n\t\tconst list = this.Popup.getBody();\n\t\tlist.$view.firstChild.setAttribute(\n\t\t\t\"placeholder\",\n\t\t\tplaceholder || this._(\"No resources to add\")\n\t\t);\n\t}\n\n\t/**\n\t * A template for \"Add assignment\" popup options\n\t * @param {object} obj - a data item\n\t * @returns {string} an html string of an editor option\n\t */\n\tOptionTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\tconst avatarStr = `<div class=\"webix_gantt_avatar_box_inline\">${avatar +\n\t\t\tname}</div>`;\n\t\tconst dpt = `<span class='webix_gantt_resource_section'>${obj.category}</span>`;\n\t\treturn (\n\t\t\t\"<div class='webix_gantt_avatar_option_box'>\" + avatarStr + dpt + \"</div>\"\n\t\t);\n\t}\n\n\t/**\n\t * Cell template\n\t * @param {object} obj - resource object\n\t * @returns {string} html string for resource editable cell\n\t */\n\tEditorTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\tconst icon = \"<span class='webix_icon wxi-menu-down'></span>\";\n\t\treturn `<div class=\"webix_gantt_avatar_box\">${avatar} ${name}${icon}</div>`;\n\t}\n\n\t/**\n\t * Popup option template for resource editor\n\t * @param {object} obj - resource object\n\t * @returns {string} html string for an option\n\t */\n\tEditorOptionTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\treturn `<div class=\"webix_gantt_avatar_box\">${avatar} ${name}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TableView from \"./links\";\nimport ResourcesView from \"./resources\";\nimport BaselineView from \"./baseline\";\n\nexport default class FormView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.isResources = this.app.config.resources;\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_subbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst calendar = {\n\t\t\tcss: \"webix_gantt_datepicker\",\n\t\t\ttype: \"calendar\",\n\t\t\t//localId: \"calendar\",\n\t\t\tbody: {\n\t\t\t\theight: 270,\n\t\t\t\twidth: 250,\n\t\t\t\ticons: true,\n\t\t\t\tevents: date => this.app.config.isHoliday(date) && \"webix_cal_event\",\n\t\t\t},\n\t\t};\n\n\t\tconst types = [\n\t\t\t{ id: \"task\", value: _(\"Task\") },\n\t\t\t{ id: \"milestone\", value: _(\"Milestone\") },\n\t\t];\n\t\tif (!this.app.config.projects) {\n\t\t\ttypes.splice(1, 0, { id: \"project\", value: _(\"Project\") });\n\t\t}\n\n\t\tlet accItems = [];\n\t\tif (this.app.config.links)\n\t\t\taccItems.push({\n\t\t\t\theader: _(\"Related tasks\"),\n\t\t\t\tbody: TableView,\n\t\t\t\tcollapsed: true,\n\t\t\t});\n\t\tif (this.isResources)\n\t\t\taccItems.push({\n\t\t\t\tlocalId: \"resourcesItem\",\n\t\t\t\theader:\n\t\t\t\t\tthis.isResources == \"single\" || this.app.config.resourceCalendars\n\t\t\t\t\t\t? _(\"Assignment\")\n\t\t\t\t\t\t: _(\"Assignments\"),\n\t\t\t\tbody: { $subview: ResourcesView, name: \"resources\" },\n\t\t\t\tcollapsed: true,\n\t\t\t\thidden: true,\n\t\t\t});\n\t\tif (this.State.baseline)\n\t\t\taccItems.push({\n\t\t\t\tlocalId: \"baselineItem\",\n\t\t\t\theader: _(\"Planned dates\"),\n\t\t\t\tbody: { $subview: BaselineView, name: \"baseline\" },\n\t\t\t\tcollapsed: true,\n\t\t\t\thidden: true,\n\t\t\t});\n\n\t\tconst accordion = {\n\t\t\tmulti: true,\n\t\t\tview: \"accordion\",\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tmargin: 10,\n\t\t\tcss: \"webix_gantt_accordion\",\n\t\t\trows: accItems,\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tborderless: true,\n\t\t\tautoheight: false,\n\t\t\tscroll: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", name: \"text\", label: _(\"Title\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"types\",\n\t\t\t\t\tname: \"type\",\n\t\t\t\t\tlabel: _(\"Type\"),\n\t\t\t\t\toptions: types,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\tname: \"start_date\",\n\t\t\t\t\tlabel: _(\"Start date\"),\n\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\tname: \"end_date\",\n\t\t\t\t\tlabel: _(\"End date\"),\n\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"counter\",\n\t\t\t\t\tname: \"duration\",\n\t\t\t\t\tcss: \"webix_gantt_form_counter\",\n\t\t\t\t\tmin: 1,\n\t\t\t\t\tmax: 1000,\n\t\t\t\t\tlabel: _(\"Duration\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"slider\",\n\t\t\t\t\tname: \"progress\",\n\t\t\t\t\ttitle: webix.template(\"#value#%\"),\n\t\t\t\t\tlabel: _(\"Progress\"),\n\t\t\t\t},\n\t\t\t\taccordion,\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tname: \"details\",\n\t\t\t\t\tlabel: _(\"Notes\"),\n\t\t\t\t\theight: 150,\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (n, o, config) => {\n\t\t\t\t\tif (this.Compact) this.UpdateTaskTime();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config == \"user\")\n\t\t\t\t\t\t\tthis.UpdateTask().then(() => {\n\t\t\t\t\t\t\t\t// redraw all bars because a branch may be closed or opened in tree\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tthis._eventSource === \"type\" &&\n\t\t\t\t\t\t\t\t\tconfig === \"user\" &&\n\t\t\t\t\t\t\t\t\t(n === \"split\" || o === \"split\")\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", []);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\tpadding: { bottom: 14 },\n\t\t\t\trows: [bar, form],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Tasks = this.Local.tasks();\n\t\tthis.Form = this.$$(\"form\");\n\n\t\t// fills form with data of selected and newly created task\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) {\n\t\t\t\tthis.FillData(id);\n\t\t\t}\n\t\t});\n\n\t\t// updates for start and end dates of task while dnd happens and form is open\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected)\n\t\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\n\t\t// \"resources\" view shows only \"task\" items (disable \"type\" select for it)\n\t\tthis.on(this.State.$changes, \"display\", v => {\n\t\t\tconst typeSelect = this.$$(\"form\").elements[\"type\"];\n\t\t\tif (v == \"tasks\") typeSelect.enable();\n\t\t\telse if (v == \"resources\") typeSelect.disable();\n\t\t});\n\t\tif (this.app.config.resourceCalendars)\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", () =>\n\t\t\t\tthis.SetResourceHolidays()\n\t\t\t);\n\t\tthis.on(this.State.$changes, \"baseline\", (v, old) => {\n\t\t\tif (!webix.isUndefined(old))\n\t\t\t\tthis.SetBaselineVisibility(this.Tasks.getItem(this.State.selected));\n\t\t});\n\t}\n\n\t/**\n\t * Applies task selection\n\t * @param {(string|number)} id - the ID of a task\n\t */\n\tFillData(id) {\n\t\tconst item = this.Tasks.getItem(id);\n\n\t\tconst typeList = this.$$(\"types\").getList();\n\t\tif (this.app.config.split && item.$count) {\n\t\t\tif (!typeList.exists(\"split\"))\n\t\t\t\ttypeList.add({\n\t\t\t\t\tid: \"split\",\n\t\t\t\t\tvalue: this.app.getService(\"locale\")._(\"Split task\"),\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (typeList.exists(\"split\")) typeList.remove(\"split\");\n\t\t}\n\n\t\tif (this.app.config.projects) {\n\t\t\tthis.LimitTypeOptions(item);\n\t\t}\n\t\tif (this.app.config.resourceCalendars) this.SetResourceHolidays();\n\n\t\tif (this.isResources) this.SetResourcesVisibility(item);\n\t\tif (this.State.baseline) this.SetBaselineVisibility(item);\n\t\tthis.Form.setValues(item);\n\t\tthis.Form.focus();\n\t}\n\n\t/**\n\t * Hide/show the \"Assignments\" accordion item depending on a task type\n\t * @param {object} item - a task data object\n\t */\n\tSetResourcesVisibility(item) {\n\t\tconst layout = this.$$(\"resourcesItem\");\n\t\tif (item.type == \"task\") {\n\t\t\tif (!layout.isVisible()) {\n\t\t\t\tconst sub = this.getSubView(\"resources\");\n\t\t\t\tif (sub) sub.FillData(item.id);\n\t\t\t\tlayout.show();\n\t\t\t}\n\t\t} else if (layout.isVisible()) layout.hide();\n\t}\n\t/**\n\t * Hide/show the \"Assignments\" accordion item depending on a task type\n\t * @param {object} item - a task data object\n\t */\n\tSetBaselineVisibility(item) {\n\t\tconst layout = this.$$(\"baselineItem\");\n\t\tif (\n\t\t\tthis.State.baseline &&\n\t\t\t(item.type == \"task\" || item.type == \"project\")\n\t\t) {\n\t\t\tif (!layout.isVisible()) {\n\t\t\t\tconst sub = this.getSubView(\"baseline\");\n\t\t\t\tif (sub) sub.FillData(item.id);\n\t\t\t\tlayout.show();\n\t\t\t}\n\t\t} else if (layout.isVisible()) layout.hide();\n\t}\n\n\t/**\n\t * Prohibits the user from selecting the type incompatible with other data and relations of a task\n\t * @param {Object} item - the data object of a task\n\t */\n\tLimitTypeOptions(item) {\n\t\tconst typeSelect = this.Form.elements.type;\n\t\tif (item.type === \"project\") typeSelect.hide();\n\t\telse typeSelect.show();\n\t}\n\n\t/**\n\t * Prepares task  object for processing with respect to date-related changes\n\t * @param {Object} vals - object with form values\n\t * @returns {boolean} flag that indicates whether dates were updated or not\n\t */\n\tPrepareDates(vals) {\n\t\tconst f = (this._eventSource = this.Form.$eventSource.config.name);\n\n\t\tlet updateDates = true;\n\t\tif (f == \"duration\" || (f == \"start_date\" && vals.type == \"project\"))\n\t\t\tvals.end_date = null;\n\t\telse if (f == \"end_date\" || f == \"start_date\") vals.duration = null;\n\t\telse updateDates = false;\n\n\t\treturn updateDates;\n\t}\n\t/**\n\t * Update task time and duration on data change in compact form\n\t */\n\tUpdateTaskTime() {\n\t\tconst vals = this.Form.getValues();\n\t\tconst updateDates = this.PrepareDates(vals);\n\n\t\t// expand branches with subtasks that are not split anymore\n\t\tif (this._eventSource === \"type\" && vals.type !== \"split\")\n\t\t\tvals.open = vals.opened = 1;\n\n\t\tconst textUpdated = this.RemoveTagsFromText(vals);\n\t\tif (textUpdated) {\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\n\t\tif (updateDates) {\n\t\t\tconst mode = this._eventSource ? this._eventSource.split(\"_\")[0] : null;\n\t\t\tthis.Ops.updateTaskDuration(vals, mode);\n\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\t}\n\n\t/**\n\t * Removes HTML tags from text fields\n\t * @param {Object} vals - the changed values from the form\n\t * @returns {boolean} - true if there is a text field in the changed values, false otherwise\n\t */\n\tRemoveTagsFromText(vals) {\n\t\tif (this._eventSource === \"text\" || this._eventSource === \"details\") {\n\t\t\tvals[this._eventSource] = (vals[this._eventSource] || \"\").replace(\n\t\t\t\t/(<[^>]+>|^\\s+|\\s+$)/gi,\n\t\t\t\t\"\"\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Saves changes\n\t * @returns {Promise} the result of a data operation (adding new event or updating)\n\t */\n\tUpdateTask() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tif (!this.Compact) {\n\t\t\tthis.PrepareDates(vals);\n\t\t\tthis.RemoveTagsFromText(vals);\n\t\t}\n\n\t\tconst mode = this._eventSource ? this._eventSource.split(\"_\")[0] : null;\n\n\t\t// expand branches with subtasks that are not split anymore\n\t\tif (this._eventSource === \"type\" && vals.type !== \"split\")\n\t\t\tvals.open = vals.opened = 1;\n\n\t\tthis._inProgress = this.Ops.updateTask(id, vals, mode);\n\n\t\tthis._inProgress.finally(() => (this._inProgress = null));\n\t\treturn this._inProgress;\n\t}\n\n\t/**\n\t * Switches end date, duration and progress controls and enables or disables them depending on the type of the task\n\t * @param {string} v - the option chosen in the type selector: \"project\", \"task\", \"milestone\"\n\t */\n\tToggleControls(v) {\n\t\tthis.Form.elements.end_date.show();\n\t\tthis.Form.elements.duration.show();\n\t\tthis.Form.elements.progress.show();\n\t\tthis.Form.elements.end_date.enable();\n\t\tthis.Form.elements.duration.enable();\n\t\tthis.Form.elements.progress.enable();\n\n\t\tif (v == \"project\" || v == \"milestone\") {\n\t\t\tconst action = v == \"project\" ? \"disable\" : \"hide\";\n\t\t\tthis.Form.elements.end_date[action]();\n\t\t\tthis.Form.elements.duration[action]();\n\t\t\tthis.Form.elements.progress[action]();\n\t\t}\n\t}\n\n\t/**\n\t * Handles clicks on the 'cross' icon and closes the form\n\t * if there are unsaved changes, initiates saving after confirmation from the user\n\t */\n\tClose() {\n\t\tif (this.Compact && this.Form.isDirty()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\twebix\n\t\t\t\t.confirm({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: _(\"Save changes?\"),\n\t\t\t\t})\n\t\t\t\t.then(() => this.Done(true), () => this.Back(true));\n\t\t} else {\n\t\t\tthis.Back(true);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form and either closes the whole right panel or shows \"info\"\n\t * @param {Boolean} exit - if true, the right panel will be closed; otherwise, right panel stays, form closes, \"info\" shows up\n\t */\n\tBack(exit) {\n\t\tif (exit)\n\t\t\tthis.State.$batch({\n\t\t\t\tedit: null,\n\t\t\t\tselected: null,\n\t\t\t});\n\t\telse this.State.edit = null;\n\t}\n\n\t/**\n\t * Finishes task editing and closes the form\n\t * @param {Boolean} exit - if true, the right panel will be closed; otherwise, right panel stays, form closes, info shows up\n\t */\n\tDone(exit) {\n\t\tif (this.Compact && this.Form.isDirty()) {\n\t\t\tif (this._inProgress)\n\t\t\t\tthis._inProgress.then(() => {\n\t\t\t\t\tthis.Back(exit);\n\t\t\t\t});\n\t\t\telse this.UpdateTask().then(() => this.Back(exit));\n\t\t} else this.Back(exit);\n\t}\n\n\tSetResourceHolidays() {\n\t\tlet arr = [];\n\t\tconst els = this.Form.elements;\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tarr.push(els[\"start_date\"], els[\"end_date\"]);\n\t\tconst calendar = this.Local.getTaskCalendar(this.State.selected);\n\t\tarr.forEach(el => {\n\t\t\tconst c = el.getPopup().getBody();\n\t\t\tc.config.events = date =>\n\t\t\t\t(calendar\n\t\t\t\t\t? h.isResourceHoliday(date, calendar)\n\t\t\t\t\t: this.app.config.isHoliday(date)) && \"webix_cal_event\";\n\t\t\tc.refresh();\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TaskView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst editButton = {\n\t\t\tview: \"button\",\n\t\t\twidth: 130,\n\t\t\tlabel: _(\"Edit\"),\n\t\t\tcss: \"webix_primary\",\n\t\t\tclick: () => this.EditTask(),\n\t\t};\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_subbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t!state.readonly ? editButton : {},\n\t\t\t],\n\t\t};\n\n\t\tconst info = {\n\t\t\tlocalId: \"text\",\n\t\t\tview: \"template\",\n\t\t\tcss: \"webix_gantt_task_info\",\n\t\t\ttemplate: obj => this.InfoTemplate(obj),\n\t\t\tborderless: true,\n\t\t};\n\n\t\tconst deleteButton = {\n\t\t\tview: \"button\",\n\t\t\tlabel: _(\"Delete task\"),\n\t\t\tcss: \"webix_danger webix_gantt_danger\",\n\t\t\talign: \"center\",\n\t\t\tinputWidth: 330,\n\t\t\tclick: () => {\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\ttitle: _(\"Delete task\"),\n\t\t\t\t\t\ttext: _(\"The task will be deleted permanently, are you sure?\"),\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.DeleteTask());\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\tbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [info, !state.readonly ? deleteButton : {}],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Tasks = this.Local.tasks();\n\t\tthis.Text = this.$$(\"text\");\n\t\tthis.isResources = this.app.config.resources;\n\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillTemplate(id);\n\t\t});\n\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected) {\n\t\t\t\tthis.FillTemplate(this.State.selected);\n\t\t\t}\n\t\t});\n\n\t\t// changing links via bars and dnd\n\t\tconst links = this.Local.links();\n\t\tthis.on(links.data, \"onStoreUpdated\", (_id, obj) => {\n\t\t\tif (obj) {\n\t\t\t\tconst tid = this.State.selected;\n\t\t\t\tif (obj.target === tid || obj.source === tid) {\n\t\t\t\t\tthis.FillTemplate(tid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.isResources) {\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", (id, obj) => {\n\t\t\t\tif (obj && obj.task == this.State.selected) this.FillTemplate(obj.task);\n\t\t\t});\n\t\t}\n\t\tthis.on(this.State.$changes, \"baseline\", (v, old) => {\n\t\t\tif (!webix.isUndefined(old)) this.FillTemplate(this.State.selected);\n\t\t});\n\t}\n\n\tFillTemplate(id) {\n\t\tconst item = webix.copy(this.Tasks.getItem(id));\n\t\titem.sources = this.Local.getLinks(id, \"source\");\n\t\titem.targets = this.Local.getLinks(id, \"target\");\n\t\tif (this.isResources && item.type == \"task\") {\n\t\t\tthis.Local.getAssignments(id).then(d => {\n\t\t\t\tif (!this.getRoot()) return false;\n\t\t\t\titem.resources = d.sort(\n\t\t\t\t\tthis.app.getService(\"operations\").sortResources\n\t\t\t\t);\n\t\t\t\tthis.Text.setValues(item);\n\t\t\t});\n\t\t} else this.Text.setValues(item);\n\t}\n\n\tEditTask() {\n\t\tthis.State.edit = true;\n\t}\n\n\tDeleteTask() {\n\t\tthis.app.getService(\"operations\").removeTask(this.State.selected);\n\t\tthis.Close();\n\t}\n\n\tClose() {\n\t\tthis.State.$batch({\n\t\t\tedit: null,\n\t\t\tselected: null,\n\t\t});\n\t}\n\n\tInfoTemplate(obj) {\n\t\tif (!obj.start_date) return \"\";\n\t\tconst _ = this._;\n\t\tlet html = `<span class=\"webix_gantt_task_title\">${obj.text ||\n\t\t\t_(\"(no title)\")}</span><br><br>`;\n\t\thtml += this.BaseTemplate(obj);\n\t\thtml += this.LinkTemplate(obj);\n\n\t\tif (this.State.baseline && obj.planned_start) {\n\t\t\thtml += this.BaselineTemplateChunk(obj, _(\"Planned dates\"));\n\t\t}\n\n\t\tif (obj.details) {\n\t\t\thtml += `<br><br><div class=\"webix_gantt_task_title\">${_(\"Notes\")}</div>\n\t\t\t\t<br><div class=\"webix_gantt_task_text\">${obj.details.replace(\n\t\t\t\t\t/(?:\\r\\n|\\r|\\n)/g,\n\t\t\t\t\t\"<br>\"\n\t\t\t\t)}</div>`;\n\t\t}\n\n\t\treturn html;\n\t}\n\n\tBaseTemplate(obj) {\n\t\tconst _ = this._;\n\t\tlet html = `<span class=\"webix_strong\">${_(\n\t\t\t\"Start date\"\n\t\t)}</span>: ${this.DateFormat(obj.start_date)}<br>`;\n\n\t\tif (obj.type !== \"milestone\")\n\t\t\thtml += `<span class=\"webix_strong\">${_(\n\t\t\t\t\"End date\"\n\t\t\t)}</span>: ${this.DateFormat(obj.end_date)}<br>\n\t\t\t<span class=\"webix_strong\">${_(\"Duration\")}</span>: ${obj.duration}<br>\n\t\t\t<span class=\"webix_strong\">${_(\"Progress\")}</span>: ${obj.progress}%\n\t\t<br>`;\n\t\treturn html;\n\t}\n\n\tLinkTemplate(obj) {\n\t\tlet html = \"\";\n\t\tconst _ = this._;\n\t\tif (obj.targets.length)\n\t\t\thtml += this.InfoTemplateChunk(obj.targets, _(\"Predecessors\"));\n\t\tif (obj.sources.length)\n\t\t\thtml += this.InfoTemplateChunk(obj.sources, _(\"Successors\"));\n\t\tif (obj.resources) {\n\t\t\tconst single =\n\t\t\t\tthis.isResources == \"single\" || this.app.config.resourceCalendars;\n\t\t\thtml += this.ResourcesTemplateChunk(\n\t\t\t\tobj.resources,\n\t\t\t\tsingle ? _(\"Assignment\") : _(\"Assignments\")\n\t\t\t);\n\t\t}\n\t\treturn html;\n\t}\n\n\tResourcesTemplateChunk(arr, label) {\n\t\tif (!arr || !arr.length) return \"\";\n\t\tlet maxWidth = 130;\n\t\tarr.forEach(r => {\n\t\t\tconst s0 = webix.html.getTextSize(r.name, \"webix_gantt_info_list_text\");\n\t\t\tconst s1 = webix.html.getTextSize(\n\t\t\t\tr.category,\n\t\t\t\t\"webix_gantt_info_list_text webix_gantt_resource_section\"\n\t\t\t);\n\t\t\tmaxWidth = Math.max(maxWidth, s0.width, s1.width);\n\t\t});\n\t\tmaxWidth = Math.min(200, maxWidth);\n\t\tlet list = arr\n\t\t\t.map(r => {\n\t\t\t\tconst h = this.app.getService(\"helpers\");\n\t\t\t\tconst avatar =\n\t\t\t\t\t\"<div>\" +\n\t\t\t\t\th.resourceAvatar(r, \"webix_gantt_person_avatar_big\") +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst dpt =\n\t\t\t\t\t\"<div class=' webix_gantt_info_list_text webix_gantt_resource_section' style='min-width:\" +\n\t\t\t\t\tmaxWidth +\n\t\t\t\t\t\"px'>\" +\n\t\t\t\t\tr.category +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst value =\n\t\t\t\t\t\"<div class='webix_gantt_resource_section'>\" +\n\t\t\t\t\tr.value +\n\t\t\t\t\tthis._(h.getResourceUnit(r)) +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst top =\n\t\t\t\t\t\"<div class='webix_gantt_info_list_text_row'><div class='webix_gantt_info_list_text' style='min-width:\" +\n\t\t\t\t\tmaxWidth +\n\t\t\t\t\t\"px'>\" +\n\t\t\t\t\tr.name +\n\t\t\t\t\t\"</div>\" +\n\t\t\t\t\tvalue +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst text = \"<div  >\" + top + dpt + \"</div>\";\n\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_gantt_info_resource'>\" + avatar + text + \"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\t\treturn `<br><span class=\"webix_strong\">${label}</span>:<br><ul class=\"webix_gantt_info_list_resources\">${list}</ul>`;\n\t}\n\n\tInfoTemplateChunk(arr, label) {\n\t\tlet res = arr\n\t\t\t.map(s => `<li>${s.text || this._(\"(no title)\")}</li>`)\n\t\t\t.join(\"\");\n\t\treturn `<br><span class=\"webix_strong\">${label}</span>:<br><ul>${res}</ul>`;\n\t}\n\n\tDateFormat(date) {\n\t\treturn webix.i18n.longDateFormatStr(date);\n\t}\n\tBaselineTemplateChunk(obj, label) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tlet html =\n\t\t\t`${_(\"Start date\")}: ${this.DateFormat(obj.planned_start)}<br>` +\n\t\t\t`${_(\"End date\")}: ${this.DateFormat(obj.planned_end)}<br>` +\n\t\t\t`${_(\"Duration\")}: ${obj.planned_duration}<br>`;\n\t\treturn `<br><span class=\"webix_strong\">${label}</span><br><div class=\"webix_gantt_info_list_planned\">${html}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TaskPopup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tborderless: true,\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sort } from \"../helpers/common\";\n\nexport default class TreeView extends JetView {\n\tconfig() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tconst scales = this.Local.getScales();\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst compact = (this.Compact = this.getParam(\"compact\", true));\n\t\tthis.isResources = this.app.config.resources;\n\t\tthis.maxAvatarNumber = 3;\n\n\t\tconst action = {\n\t\t\tid: \"action\",\n\t\t\tcss: \"webix_gantt_action\",\n\t\t\theader: {\n\t\t\t\ttext: `<span webix_tooltip=\"${_(\n\t\t\t\t\t\"Add task\"\n\t\t\t\t)}\" class=\"webix_icon wxi-plus-circle\"></span>`,\n\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t},\n\t\t\ttemplate: () => {\n\t\t\t\treturn `<span webix_tooltip=\"${_(\n\t\t\t\t\t\"Add task\"\n\t\t\t\t)}\" class=\"webix_icon wxi-plus\"></span>`;\n\t\t\t},\n\t\t\twidth: 44,\n\t\t\tminWidth: 44,\n\t\t};\n\n\t\tlet columns = [\n\t\t\t{\n\t\t\t\tid: \"text\",\n\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\theader: _(\"Title\"),\n\t\t\t\ttemplate: (obj, common) =>\n\t\t\t\t\tcommon.treetable(obj, common) + this.TitleTemplate(obj),\n\t\t\t\tfillspace: true,\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"full\",\n\t\t\t\tsort: sort(\"text\"),\n\t\t\t\tminWidth: 150,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"start_date\",\n\t\t\t\theader: _(\"Start date\"),\n\t\t\t\tformat: webix.i18n.dateFormatStr,\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"full\",\n\t\t\t\tsort: \"date\",\n\t\t\t\tminWidth: 100,\n\t\t\t},\n\t\t];\n\n\t\tif (this.isResources) {\n\t\t\tcolumns.push({\n\t\t\t\tid: \"resources\",\n\t\t\t\tcss: \"webix_gantt_tree_column_resources\",\n\t\t\t\theader: _(\"Assigned\"),\n\t\t\t\ttemplate: obj => this.ResourcesTemplate(obj),\n\t\t\t\tminWidth: 100,\n\t\t\t});\n\t\t}\n\n\t\tif (compact) {\n\t\t\taction.header.text = \"<span class='webix_icon gti-menu'>\";\n\t\t\tif (state.readonly) action.template = \"\";\n\t\t\tcolumns.unshift(action);\n\t\t} else if (!state.readonly) columns.push(action);\n\n\t\tcolumns[columns.length - 1].resize = false;\n\n\t\tconst skin = webix.skin.$name;\n\t\tconst headerCss =\n\t\t\tskin == \"material\" || skin == \"mini\" ? \"webix_header_border\" : \"\";\n\t\tconst tree = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_tree \" + headerCss,\n\t\t\tprerender: true,\n\t\t\twidth: compact ? 44 : state.treeWidth,\n\t\t\trowHeight: scales.cellHeight,\n\t\t\theaderRowHeight: scales.height,\n\t\t\tscroll: \"xy\",\n\t\t\tscrollAlignY: false,\n\t\t\tselect: \"row\",\n\t\t\tsort: \"multi\",\n\t\t\tresizeColumn: {\n\t\t\t\theaderOnly: true,\n\t\t\t\tsize: 10,\n\t\t\t},\n\t\t\tdrag: state.readonly ? false : \"order\",\n\t\t\tcolumns,\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\t\"wxi-plus\": (ev, id) => this.AddTask(id.row),\n\t\t\t\t\"wxi-plus-circle\": () => this.AddTask(\"0\"),\n\t\t\t\t\"gti-menu\": () => this.ToggleColumns(),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeOpen: id => this.HandleToggle(id),\n\t\t\t\tonAfterOpen: id => {\n\t\t\t\t\tthis.ToggleBranch(id, 1);\n\t\t\t\t\tthis.ApplySelection();\n\t\t\t\t},\n\t\t\t\tonAfterClose: id => this.ToggleBranch(id, 0),\n\t\t\t\tonBeforeSelect: id => this.BeforeSelectHandler(id),\n\t\t\t\tonItemClick: id => this.ItemClickHandler(id),\n\t\t\t\tonAfterSort: (by, dir, as) => this.SortTasks(by, dir, as),\n\t\t\t\tonColumnResize: (id, v, o, user) => this.NormalizeColumns(id, user),\n\t\t\t\tonBeforeDrag: (ctx, e) => this.BeforeDragHandler(ctx, e),\n\t\t\t\tonBeforeDrop: ctx => this.BeforeDropHandler(ctx),\n\t\t\t\tonViewResize: () => {\n\t\t\t\t\tthis.State.treeWidth = this.Tree.$width;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\ttree.on[\"onScrollY\"] = tree.on[\"onSyncScroll\"] = tree.on[\n\t\t\t\"onAfterScroll\"\n\t\t] = function() {\n\t\t\tstate.top = this.getScrollState().y;\n\t\t};\n\t\treturn tree;\n\t}\n\n\tinit(view) {\n\t\tthis.Tree = view;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Tasks = this.Local.tasks();\n\n\t\tthis.on(this.State.$changes, \"display\", v => {\n\t\t\tthis.Mode = v;\n\t\t\tthis.State.top = 0;\n\t\t\tthis.SyncData();\n\t\t});\n\t\tif (this.isResources) {\n\t\t\tthis.on(this.Assignments.data, \"onStoreUpdated\", () => {\n\t\t\t\tthis.Tree.refresh();\n\t\t\t});\n\t\t\tthis.on(this.Tree.data, \"onStoreUpdated\", id => {\n\t\t\t\tif (this.Mode == \"resources\" && !id) {\n\t\t\t\t\tthis.ApplySelection();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.on(this.State.$changes, \"top\", y => this.Tree.scrollTo(null, y));\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.ApplySelection();\n\t\t\telse this.Tree.unselect();\n\t\t});\n\n\t\t// resetting headerRowHeight\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tconst col = this.Tree.columnId(0);\n\t\t\tthis.Tree.getColumnConfig(col).header[0].height = scales.height;\n\t\t\tthis.Tree.refreshColumns();\n\t\t});\n\n\t\t// compact button and dnd module\n\t\tthis.on(this.app, \"task:add\", (pid, dates) =>\n\t\t\tthis.AddTask(pid || \"0\", dates)\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"treeWidth\", v => {\n\t\t\tif (!this.Compact && view.$width !== v) {\n\t\t\t\tview.define({ width: v });\n\t\t\t\tview.resize();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Prevents split task branches from being opened\n\t * @param {(string|number)} id - the ID of a task branch\n\t * @returns {Boolean} return false to prevent branches from opening\n\t */\n\tHandleToggle(id) {\n\t\tconst obj = this.Tree.getItem(id);\n\t\tif (obj.type === \"split\" && obj.$data.length) return false;\n\t}\n\n\t/**\n\t * Selects a task\n\t * @param {(string|number)} id - the ID of a task\n\t */\n\tItemClickHandler(id) {\n\t\tif (!this.Tree.getItem(id).$group) {\n\t\t\tthis.State.$batch({\n\t\t\t\tparent: null,\n\t\t\t\tselected: id.row,\n\t\t\t});\n\t\t} else this.app.callEvent(\"edit:stop\");\n\t}\n\t/**\n\t * Checks whether selection is allowed\n\t * @param {string, number} id - task ID\n\t * @returns {boolean} returning false prevents selection\n\t */\n\tBeforeSelectHandler(id) {\n\t\treturn !this.Tree.getItem(id).$group;\n\t}\n\t/**\n\t * Checks whether drag-n-drop is allowed and defines the looks of the drag marker\n\t * @param {Object} ctx - the context object of DnD\n\t * @param {MouseEvent} e - native browser event\n\t * @returns {Boolean} returning false prevents Webix drag-n-drop logic\n\t */\n\tBeforeDragHandler(ctx, e) {\n\t\tif (this.Mode == \"tasks\") {\n\t\t\tconst obj = this.Tree.getItem(ctx.start);\n\t\t\tif (obj.type === \"split\" && obj.$data.length) {\n\t\t\t\tconst html = this.Tree.$dragHTML(this.Tree.getItem(ctx.start), e, ctx);\n\t\t\t\tctx.html = html.replace(\n\t\t\t\t\t\"webix_dd_drag\",\n\t\t\t\t\t\"webix_dd_drag webix_gantt_tree_no_icon\"\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t/**\n\t * Saves task position\n\t * @param {Object} ctx - drag-n-drop context\n\t * @returns {boolean} returning false prevents Webix drop logic\n\t */\n\tBeforeDropHandler(ctx) {\n\t\tthis.Ops.moveTask(ctx.start, ctx.parent, ctx.index);\n\t\treturn false;\n\t}\n\t/** Fills tree width data */\n\tSyncData() {\n\t\tthis.Tree.clearAll();\n\t\tthis.VisibleTasks = this.Local.getVisibleTasksCollection();\n\t\tthis.resDisplayed = this.State.display === \"resources\";\n\n\t\t// for Resource view: always handle existing waitData of VisibleTasks\n\t\tif (this.resDisplayed && !this.clearEvID) {\n\t\t\tthis.clearEvID = this.on(this.VisibleTasks.data, \"onClearAll\", () => {\n\t\t\t\tif (this.resDisplayed) {\n\t\t\t\t\tthis.RefreshData();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.RefreshData();\n\t}\n\n\t/**\n\t * Returns waitData of all involved Collections\n\t * @returns {Array} of Promises\n\t */\n\tGetLoaders() {\n\t\tconst loaders = [this.VisibleTasks.waitData];\n\t\tif (this.isResources) {\n\t\t\tthis.Resources = this.Local.resources();\n\t\t\tthis.Assignments = this.Local.assignments();\n\t\t\tloaders.push(this.Resources.waitData, this.Assignments.waitData);\n\t\t}\n\t\treturn loaders;\n\t}\n\n\t/**\n\t * Waits for data before syncing with main collection and restoring state\n\t * @param {Array} loaders -\n\t */\n\tRefreshData() {\n\t\tconst loaders = this.GetLoaders();\n\t\twebix.promise.all(loaders).then(() => {\n\t\t\tthis.Tree.sync(this.VisibleTasks);\n\t\t\tthis.ApplySelection();\n\t\t\tthis.ApplySorting();\n\t\t});\n\t}\n\n\t/** Applies selection from state */\n\tApplySelection() {\n\t\tconst id = this.State.selected;\n\n\t\tif (id && this.Tree.exists(id) && this.Tree.getSelectedId() != id) {\n\t\t\tlet selected;\n\t\t\tconst task = this.Tree.getItem(id);\n\n\t\t\t// split subtasks are in the tree but they are never visible\n\t\t\tif (this.State.display === \"tasks\") {\n\t\t\t\tconst parent = task.parent;\n\t\t\t\tconst pdata = parent != 0 ? this.Tree.getItem(parent) : null;\n\t\t\t\tif (pdata && pdata.type === \"split\") {\n\t\t\t\t\tselected = parent;\n\t\t\t\t} else if (this.Local._isTaskVisible(task)) {\n\t\t\t\t\tselected = id;\n\t\t\t\t}\n\t\t\t} else if (this.Local._isTaskVisible(task)) {\n\t\t\t\tselected = id;\n\t\t\t}\n\n\t\t\tif (selected) {\n\t\t\t\tthis.Tree.select(selected);\n\t\t\t\tthis.Tree.showItem(selected);\n\t\t\t}\n\t\t}\n\t}\n\t/** Applies sorting from state */\n\tApplySorting() {\n\t\tif (this.State.sort) {\n\t\t\t// UI-only: no need to re-apply sorting on collection\n\t\t\tthis.Tree.data.blockEvent();\n\t\t\tthis.Tree.setState({ sort: this.State.sort });\n\t\t\tthis.Tree.data.unblockEvent();\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new task\n\t * @param {string, number} pid - ID of parent task, can be \"0\" for root\n\t * @param {Object} dates - start and end of the new task in units (numbers)\n\t * @returns {boolean} returning false prevents selection of the parent task, if called from tree\n\t */\n\tAddTask(pid, dates) {\n\t\tthis.State.selected = null;\n\n\t\tconst row = this.Tree.getItem(pid);\n\t\tconst index = row ? 0 : -1;\n\t\tlet inProgress;\n\t\tconst newTask = this.GetNewTask(row, dates);\n\n\t\tif (this.Mode == \"resources\" && row) {\n\t\t\tinProgress = this.AddTaskWithAssignment(newTask, pid);\n\t\t} else {\n\t\t\t// row and dates come from drag-n-drop module\n\t\t\tif (row && dates) {\n\t\t\t\tlet assigned;\n\t\t\t\tif (this.app.config.resources) {\n\t\t\t\t\tassigned = this.Assignments.find(a => a.task == row.id);\n\t\t\t\t}\n\t\t\t\tif (assigned && assigned.length)\n\t\t\t\t\tinProgress = this.SplitTaskWithAssignment(\n\t\t\t\t\t\tnewTask,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tpid,\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tassigned\n\t\t\t\t\t);\n\t\t\t\telse inProgress = this.Ops.splitTaskWithDnd(newTask, index, pid, row);\n\t\t\t} else inProgress = this.Ops.addTask(newTask, index, row ? pid : 0);\n\t\t}\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\n\t\tinProgress.then(res => {\n\t\t\tif (row && this.Mode == \"tasks\" && row.type !== \"split\") {\n\t\t\t\tthis.Tree.open(pid);\n\t\t\t}\n\t\t\tthis.State.$batch({\n\t\t\t\tedit: true,\n\t\t\t\tselected: res.id,\n\t\t\t});\n\n\t\t\tthis.Tree.showItem(res.id);\n\t\t});\n\n\t\treturn false;\n\t}\n\t/**\n\t * Returns and object with new task data\n\t * @param {Object} row - the data object of parent task\n\t * @param {Object} dates - (optional) start and length of the new task in units (numbers)\n\t * @returns {Object} an object with default task fields\n\t */\n\tGetNewTask(row, dates) {\n\t\tconst { start, end } = this.GetDates(row, dates);\n\n\t\treturn {\n\t\t\tstart_date: new Date(start),\n\t\t\tend_date: end || webix.Date.add(start, 1, \"day\", true),\n\t\t\tprogress: 0,\n\t\t\ttext: \"\",\n\t\t};\n\t}\n\n\t/**\n\t * Gets start and end dates for a new task\n\t * @param {Object} row - (optional) the data object of a parent task\n\t * @param {Object} dates - (optional) start and length of the new task in units (numbers)\n\t * @returns {Object} with start and end dates\n\t */\n\tGetDates(row, dates) {\n\t\tif (dates) {\n\t\t\treturn dates;\n\t\t}\n\n\t\tlet start, end;\n\t\tif (row && row.type === \"split\") {\n\t\t\tconst date =\n\t\t\t\trow.$data && row.$data.length ? row.$data[0].end_date : row.end_date;\n\t\t\tstart = this.Helpers.addUnit(\"day\", date, 1);\n\t\t} else {\n\t\t\tif (row) {\n\t\t\t\tstart = row.start_date;\n\t\t\t} else {\n\t\t\t\tconst scales = this.Local.getScales();\n\t\t\t\tstart = webix.Date.add(scales.start, 1, scales.minUnit); //keep scale start\n\t\t\t}\n\t\t}\n\t\treturn { start, end };\n\t}\n\n\t/**\n\t * Adds a new task with assignment, if any is applicable\n\t * @param {Object} newTask - the data object of a new task\n\t * @param {(string|number)} pid - the ID of the parent task\n\t * @returns {Promise} server response with ID of the new task\n\t */\n\tAddTaskWithAssignment(newTask, pid) {\n\t\tthis.Tasks.data.blockEvent();\n\t\tthis.Assignments.data.blockEvent();\n\t\t// add task\n\t\tlet targetId = \"0\";\n\t\tif (pid) targetId = this.Tree.getItem(pid).$group ? \"0\" : pid;\n\t\tlet index = 0;\n\t\tif (this.Tasks.data.branch[targetId])\n\t\t\tindex = this.Tasks.data.branch[targetId].length;\n\n\t\treturn this.Ops.addTask(newTask, index, targetId)\n\t\t\t.then(obj => {\n\t\t\t\tnewTask.id = obj.id;\n\t\t\t\t// add assignments\n\t\t\t\tlet waitArr = [];\n\t\t\t\tlet resources = null;\n\t\t\t\twhile (pid != \"0\" && !resources) {\n\t\t\t\t\tresources = this.Tree.getItem(pid).resources;\n\t\t\t\t\tif (!resources) pid = this.Tree.getParentId(pid);\n\t\t\t\t}\n\t\t\t\tif (resources && resources.length) {\n\t\t\t\t\tresources.forEach(rId => {\n\t\t\t\t\t\tconst resource = this.Local.resources().getItem(rId);\n\t\t\t\t\t\twaitArr.push(\n\t\t\t\t\t\t\tthis.Ops.addAssignment({\n\t\t\t\t\t\t\t\tresource: rId,\n\t\t\t\t\t\t\t\tvalue: this.Helpers.getDefaultResourceValue(resource),\n\t\t\t\t\t\t\t\ttask: newTask.id,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (!waitArr.length) return webix.promise.resolve(obj);\n\t\t\t\treturn webix.promise.all(waitArr).then(() => obj);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.Tasks.data.unblockEvent();\n\t\t\t\tthis.Assignments.data.unblockEvent();\n\t\t\t\t//now we can refresh\n\t\t\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", [\n\t\t\t\t\tnewTask.id,\n\t\t\t\t\tnewTask,\n\t\t\t\t\t\"add\",\n\t\t\t\t]);\n\t\t\t});\n\t}\n\n\t/**\n\t * Splits a task and reassigns resources from original task to new kid if the original task was not split\n\t * @param {Object} newTask - data for a new split kid\n\t * @param {number} index - the index of the new kid\n\t * @param {(number|string)} pid - the ID of the original task\n\t * @param {Object} row - data of the original task\n\t * @param {Object} assignment - data of the assignment of the original task\n\t * @returns {Promise<Object>} server response with ID of the new task, it's 'sibling' ID\n\t */\n\tSplitTaskWithAssignment(newTask, index, pid, row, assignments) {\n\t\treturn this.Ops.splitTaskWithDnd(newTask, index, pid, row).then(res => {\n\t\t\tif (res.sibling) {\n\t\t\t\tconst aops = [];\n\t\t\t\tfor (let i = 0; i < assignments.length; ++i)\n\t\t\t\t\taops.push(\n\t\t\t\t\t\tthis.Ops.updateAssignment(assignments[i].id, {\n\t\t\t\t\t\t\ttask: res.sibling,\n\t\t\t\t\t\t}).then(() => res)\n\t\t\t\t\t);\n\t\t\t\treturn webix.promise.all(aops).then(() => res);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/** Invokes tasks painting in the chart */\n\tRefreshTasks() {\n\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", []);\n\t}\n\t/**\n\t * Sorts tasks according to current sorting config\n\t * @param {string, array} by - data field, can store an array of sorting configs in case of multiple sorting\n\t * @param {string, number} dir - sorting direction, \"asc\" or \"desc\"\n\t * @param {string, number} as - data type, \"string\" by default\n\t */\n\tSortTasks(by, dir, as) {\n\t\tconst dataSorter = webix.isArray(by) ? by : { by, dir, as };\n\t\tconst sortState = this.Tree.getState().sort;\n\n\t\t// sort the collection to affect task bars\n\t\tthis.VisibleTasks.sort(dataSorter);\n\t\t// save sorting state to restore it after app.refresh (switching from/to compact mode)\n\t\tthis.State.sort = sortState;\n\t}\n\t/** Shows and hides columns in a compact mode */\n\tToggleColumns() {\n\t\tconst vis = this.Tree.isColumnVisible(\"text\");\n\t\tthis.Tree.showColumnBatch(\"full\", !vis);\n\t\tthis.Tree.config.width = vis ? 44 : 0;\n\t\tthis.Tree.resize();\n\n\t\tthis.app.callEvent(\"bars:toggle\", [vis]);\n\t}\n\t/**\n\t * Adjusts columns after resizing\n\t * @param {string} id - ID of the column being resized\n\t * @param {boolean} user - defines whether resizing was triggered by user or API\n\t */\n\tNormalizeColumns(id, user) {\n\t\tif (!user) return;\n\t\tconst tree = this.Tree;\n\t\tconst columns = tree.config.columns;\n\t\tconst i = tree.getColumnIndex(id);\n\n\t\tlet last = columns.length - 1;\n\t\tif (columns[last].id === \"action\") last -= 1;\n\n\t\tif (i === 0) {\n\t\t\tcolumns[last].fillspace = true;\n\t\t\tcolumns[last].width = 0;\n\t\t} else if (i === last) {\n\t\t\tcolumns[0].fillspace = true;\n\t\t\tcolumns[0].width = 0;\n\t\t}\n\t\ttree.refreshColumns();\n\t}\n\t/**\n\t * Saves a task tree branch state (open or closed)\n\t * @param {number, string} id - the ID of the task (branch node)\n\t * @param {number} open - 1 if open, 0 if closed\n\t */\n\tToggleBranch(id, open) {\n\t\tif (this.State.display != \"resources\") {\n\t\t\tthis.RefreshTasks();\n\t\t\tif (!this.State.readonly) this.Ops.updateTask(id, { opened: open });\n\t\t} else {\n\t\t\tconst tree = this.VisibleTasks;\n\t\t\tconst item = tree.getItem(id);\n\t\t\titem.open = !!open;\n\t\t\t// need to update treestore order\n\t\t\ttree.data.callEvent(\"onStoreUpdated\", [id, 0, \"branch\"]);\n\t\t}\n\t}\n\n\t/**\n\t * Returns a string with the text label for item title\n\t * @param {Object} obj - the data object of a task\n\t * @returns {string} a string with the text label\n\t */\n\tTitleTemplate(obj) {\n\t\treturn (\n\t\t\tobj.text || (obj.$group ? this._(\"Unassigned\") : this._(\"(no title)\"))\n\t\t);\n\t}\n\n\t/**\n\t * Resources cell template\n\t * @param {object} obj - task data item\n\t * @returns {string} html string\n\t */\n\tResourcesTemplate(obj) {\n\t\tif (this.Assignments.count() && this.Resources.count()) {\n\t\t\tlet assigned = [];\n\t\t\tthis.Assignments.data.each(a => {\n\t\t\t\tif (a.task == obj.id) assigned.push(this.Resources.getItem(a.resource));\n\t\t\t});\n\t\t\tassigned.sort(this.Ops.sortResources);\n\t\t\treturn this.GetAssignmentsHTML(assigned);\n\t\t}\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Gets html content for assignments cell\n\t * @param {Array} assignedArr - an array of assignments\n\t * @returns {string} html string\n\t */\n\tGetAssignmentsHTML(assignedArr) {\n\t\tlet str = \"\";\n\t\tif (assignedArr.length > this.maxAvatarNumber) {\n\t\t\tconst num = assignedArr.length - this.maxAvatarNumber + 1;\n\t\t\tassignedArr = assignedArr.splice(0, this.maxAvatarNumber);\n\t\t\t// show remaining assignments as \"+[NUM]\" over the last avatar\n\t\t\tconst last = assignedArr.pop();\n\t\t\tconst lastStr = this.Helpers.resourceAvatar(last);\n\t\t\tconst numStr =\n\t\t\t\t\"<div class='webix_gantt_cell_remain_num'>+\" + num + \"</div>\";\n\t\t\tstr = assignedArr\n\t\t\t\t.map(r => `${this.Helpers.resourceAvatar(r, null, true)}`)\n\t\t\t\t.join(\"\");\n\t\t\tstr +=\n\t\t\t\t\"<div class='webix_gantt_cell_assigned_last'>\" +\n\t\t\t\tlastStr +\n\t\t\t\tnumStr +\n\t\t\t\t\"</div>\";\n\t\t} else {\n\t\t\tstr = assignedArr\n\t\t\t\t.map(r => `${this.Helpers.resourceAvatar(r, null, true)}`)\n\t\t\t\t.join(\"\");\n\t\t\t// show a name for single assignment\n\t\t\tif (assignedArr.length == 1) {\n\t\t\t\tlet arr = assignedArr[0].name.split(\" \");\n\t\t\t\tstr +=\n\t\t\t\t\t\"<span class='webix_gantt_cell_assigned_text'>\" + arr[0] + \"</span>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='webix_gantt_avatar_box'>\" + str + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TreeView from \"./tree\";\nimport ChartView from \"./chart\";\nimport { initRLayout } from \"@xbs/jet-helpers\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tinitRLayout();\n\t\tthis.fCompact = this.getParam(\"forceCompact\");\n\t\tif (!webix.isUndefined(this.fCompact))\n\t\t\tthis.setParam(\"compact\", this.fCompact);\n\t\tthis.Compact = this.getParam(\"compact\");\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst edit = this.Compact\n\t\t\t? { $subview: true, name: \"edit\", popup: true }\n\t\t\t: {\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tcss: \"webix_shadow_medium\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\twidth: 400,\n\t\t\t\t\thidden: true,\n\t\t\t\t\tlocalId: \"edit\",\n\t\t\t\t\tbody: { $subview: true, name: \"edit\" },\n\t\t\t  };\n\n\t\tlet cols = [\n\t\t\tTreeView,\n\t\t\t{\n\t\t\t\tview: this.Compact ? \"spacer\" : \"resizer\",\n\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\twidth: this.Compact ? 1 : 4,\n\t\t\t},\n\t\t\tChartView,\n\t\t];\n\n\t\tif (this.app.config.resources) {\n\t\t\tcols = [\n\t\t\t\t{\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\tcols,\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonViewResize: () => {\n\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:resize\", []);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"resizer\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\t\t\t\tlocalId: \"rdResizer\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\t\t\tlocalId: \"rdiagram\",\n\t\t\t\t\t\t\theight: this.Compact ? 0 : 400,\n\t\t\t\t\t\t\tbody: { $subview: true, name: \"rdiagram\" },\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tedit,\n\t\t\t];\n\t\t} else {\n\t\t\tcols.push(edit);\n\t\t}\n\n\t\tconst main = {\n\t\t\tview: \"abslayout\",\n\t\t\tcss: \"webix_gantt\",\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"r-layout\",\n\t\t\t\t\tlocalId: \"main\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\tcols: cols,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcss: \"webix_gantt_absbutton\",\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\thidden: !this.Compact || this.State.readonly,\n\t\t\t\t\twidth: 50,\n\t\t\t\t\theight: 50,\n\t\t\t\t\tright: 20,\n\t\t\t\t\tbottom: 20,\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.app.callEvent(\"task:add\", []);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn main;\n\t}\n\n\tinit(view) {\n\t\tthis.$$(\"main\").sizeTrigger(\n\t\t\tthis.app,\n\t\t\tmode => this.SetCompactMode(mode),\n\t\t\t!!this.Compact\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"selected\", (id, oid) => {\n\t\t\tif (id) this.ShowTask(this.State.edit ? \"form\" : \"info\");\n\t\t\telse if (oid) this.HideTask();\n\t\t});\n\t\tthis.on(this.State.$changes, \"edit\", v => {\n\t\t\tif (this.State.selected) this.ShowTask(v ? \"form\" : \"info\");\n\t\t});\n\n\t\twebix.extend(view, webix.ProgressBar);\n\t\tthis.on(this.app, \"backend:operation\", res => {\n\t\t\tview.showProgress({ type: \"top\", delay: 2000 });\n\t\t\tres.finally(() => {\n\t\t\t\tview.hideProgress();\n\t\t\t});\n\t\t});\n\n\t\tif (this.app.config.resources) {\n\t\t\tthis.on(this.State.$changes, \"resourcesDiagram\", v => {\n\t\t\t\tif (v) {\n\t\t\t\t\tthis.$$(\"rdiagram\").show();\n\t\t\t\t\tthis.$$(\"rdResizer\").show();\n\t\t\t\t\tthis.show(\"rdiagram\", { target: \"rdiagram\" });\n\t\t\t\t} else {\n\t\t\t\t\tthis.$$(\"rdiagram\").hide();\n\t\t\t\t\tthis.$$(\"rdResizer\").hide();\n\t\t\t\t\tthis.show(\"_blank\", { target: \"rdiagram\" }).then(() => {\n\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:resize\", []);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tShowTask(path) {\n\t\tpath = `task.${path}`;\n\t\tif (this.Compact) {\n\t\t\tthis.show(`task.popup/${path}`, {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$$(\"edit\").show();\n\t\t\tthis.show(path, {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t}\n\t}\n\n\tHideTask() {\n\t\t// we need to destroy the view inside first\n\t\tthis.show(\"_blank\", { target: \"edit\" });\n\t\tif (!this.Compact) this.$$(\"edit\").hide();\n\t}\n\n\tSetCompactMode(mode) {\n\t\t//let it render, then recreate\n\t\twebix.delay(() => {\n\t\t\tthis.State.$batch({ top: 0, left: 0 });\n\t\t\tthis.setParam(\"compact\", mode);\n\t\t\tthis.refresh();\n\t\t});\n\t}\n}\n","import m0 from \"./views/chart/bars\";\nimport m1 from \"./views/chart/index.js\";\nimport m2 from \"./views/chart/scale\";\nimport m3 from \"./views/rdiagram/diagram\";\nimport m4 from \"./views/rdiagram/index.js\";\nimport m5 from \"./views/rdiagram/tree\";\nimport m6 from \"./views/task/baseline\";\nimport m7 from \"./views/task/form\";\nimport m8 from \"./views/task/info\";\nimport m9 from \"./views/task/links\";\nimport m10 from \"./views/task/popup\";\nimport m11 from \"./views/task/resources\";\nimport m12 from \"./views/top\";\nimport m13 from \"./views/tree\";\nimport { JetView } from \"webix-jet\";\n\nconst views = { JetView };\nviews[\"chart/bars\"] = m0;\nviews[\"chart\"] = m1;\nviews[\"chart/scale\"] = m2;\nviews[\"rdiagram/diagram\"] = m3;\nviews[\"rdiagram\"] = m4;\nviews[\"rdiagram/tree\"] = m5;\nviews[\"task/baseline\"] = m6;\nviews[\"task/form\"] = m7;\nviews[\"task/info\"] = m8;\nviews[\"task/links\"] = m9;\nviews[\"task/popup\"] = m10;\nviews[\"task/resources\"] = m11;\nviews[\"top\"] = m12;\nviews[\"tree\"] = m13;\n\nexport default views;\n","export default class Local {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t * @param {object} config - object with app settings\n\t */\n\tconstructor(app, config) {\n\t\tthis.app = app;\n\t\tthis.state = app.getState();\n\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\t// initial config of scales\n\t\tthis.resetScales(config);\n\n\t\tthis.dateToLocalStr = webix.Date.dateToStr(webix.i18n.parseFormat);\n\t}\n\n\t/**\n\t * Creates and paints scales\n\t * @param {Date} scaleStart - start date\n\t * @param {Date} scaleEnd - end date\n\t * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\n\t * @param {number} width - width of smallest cell unit\n\t * @param {number} height - height of scale cell\n\t * @param {Array} scales - a set of scales (objects)\n\t */\n\tsetScales(scaleStart, scaleEnd, precise, width, height, scales) {\n\t\tconst oldScale = this._scales;\n\t\tif (width) {\n\t\t\tthis._scaleBase = { width, height, scales };\n\t\t\tscaleEnd = webix.Date.add(scaleEnd, 1, \"day\"); //inclusive\n\t\t} else {\n\t\t\twidth = this._scaleBase.width;\n\t\t\theight = this._scaleBase.height;\n\t\t\tscales = this._scaleBase.scales;\n\t\t}\n\n\t\tthis._scales = this.app\n\t\t\t.getService(\"helpers\")\n\t\t\t.setScales(scaleStart, scaleEnd, precise, width, height, scales);\n\t\tthis._taskHeight = this._scales.cellHeight - 12;\n\n\t\tconst tasks = this.getVisibleTasksCollection();\n\t\tif (tasks && tasks.data.order.length) {\n\t\t\tif (this.state.display === \"resources\") {\n\t\t\t\tthis.app.getService(\"grouping\").refreshResourceTasks();\n\t\t\t} else {\n\t\t\t\tthis.refreshTasks();\n\t\t\t}\n\t\t\tthis.refreshLinks();\n\t\t}\n\n\t\tthis.app.callEvent(\"onScalesUpdate\", [this._scales, oldScale]);\n\t}\n\t/**\n\t * returns scales\n\t * @returns {object} current scales object\n\t */\n\tgetScales() {\n\t\treturn this._scales;\n\t}\n\t/**\n\t * sets initial state of Gantt scales\n\t * @param {Object} config - scales configuration, by default from app config\n\t */\n\tresetScales(config) {\n\t\tconfig = config || this.app.config;\n\n\t\tconst active = webix.skin.$active;\n\t\tconst scaleStart = config.scaleStart || webix.Date.dayStart(new Date());\n\t\tconst scaleEnd =\n\t\t\tconfig.scaleEnd || webix.Date.add(scaleStart, 1, \"month\", true);\n\n\t\tthis.setScales(\n\t\t\tscaleStart,\n\t\t\tscaleEnd,\n\t\t\tconfig.preciseTimeUnit,\n\t\t\tconfig.scaleCellWidth || 80,\n\t\t\tactive.barHeight - active.borderWidth * 2,\n\t\t\tconfig.scales || [{ unit: \"day\", step: 1, format: \"%d\" }]\n\t\t);\n\t}\n\t/**\n\t * Get tasks height\n\t * @returns {number} tasks height\n\t */\n\tgetTaskHeight() {\n\t\treturn this._taskHeight;\n\t}\n\t/**\n\t * Adjusts scale to edited task\n\t * @param {object} task - task object\n\t */\n\tadjustScale(obj) {\n\t\tlet start = obj.start_date;\n\t\tlet end = obj.end_date;\n\t\tif (this.state.baseline && obj.planned_start && obj.planned_end) {\n\t\t\tif (start > obj.planned_start) start = obj.planned_start;\n\t\t\tif (end < obj.planned_end) end = obj.planned_end;\n\t\t}\n\t\tconst s = this.getScales();\n\n\t\t// add 1 unit space around\n\t\tstart = this.Helpers.addUnit(s.minUnit, start, -1);\n\t\tend = this.Helpers.addUnit(s.minUnit, end, 1);\n\n\t\tif ((s && s.start > start) || s.end < end) {\n\t\t\tthis.setScales(\n\t\t\t\ts.start > start ? start : s.start,\n\t\t\t\ts.end < end ? end : s.end,\n\t\t\t\ts.precise\n\t\t\t);\n\t\t}\n\t}\n\t/**\n\t * Fills and returns tasks collection\n\t * @returns {object} tasks Tree Collection\n\t */\n\ttasks(force) {\n\t\tif (this._tasks && !force) return this._tasks;\n\n\t\tif (!this._tasks) {\n\t\t\tthis._tasks = this.createTasks();\n\t\t} else {\n\t\t\tthis._tasks.clearAll();\n\t\t}\n\n\t\tconst waitArr = [this.app.getService(\"backend\").tasks()];\n\t\tif (this.app.config.resourceCalendars)\n\t\t\twaitArr.push(this.taskCalendarMap(false, force));\n\n\t\tthis._tasks.parse(\n\t\t\twebix.promise.all(waitArr).then(data => {\n\t\t\t\treturn this.app.getService(\"grouping\").getTreeData(data[0], 0);\n\t\t\t})\n\t\t);\n\t\treturn this._tasks;\n\t}\n\t/**\n\t * Creates tasks collection\n\t * @returns {object} empty tasks Tree Collection\n\t */\n\tcreateTasks() {\n\t\tconst ops = this.app.getService(\"operations\");\n\t\tconst tasks = new webix.TreeCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreLoad\": () => {\n\t\t\t\t\tif (!this.app.config.scaleStart) this.updateScaleMinMax(tasks);\n\t\t\t\t\ttasks.data.each(d => {\n\t\t\t\t\t\tif (this.app.config.projects && d.$count) d.type = \"project\";\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t\"data->onStoreUpdated\": (id, obj, mode) => {\n\t\t\t\t\tid = mode == \"update\" ? id : null;\n\t\t\t\t\tthis.refreshTasks(id);\n\t\t\t\t\tthis.refreshLinks();\n\n\t\t\t\t\tif (!mode && this.state.criticalPath) {\n\t\t\t\t\t\tif (this.app.config.links)\n\t\t\t\t\t\t\tthis._links.waitData.then(() => this.showCriticalPath());\n\t\t\t\t\t\telse this.showCriticalPath();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tobj.start_date = webix.i18n.parseFormatDate(obj.start_date);\n\t\t\t\t\tobj.end_date = webix.i18n.parseFormatDate(obj.end_date);\n\t\t\t\t\tobj.type = obj.type || \"task\";\n\t\t\t\t\tif (!this.app.config.split && obj.type === \"split\") obj.type = \"task\";\n\n\t\t\t\t\tops.updateTaskDuration(obj);\n\n\t\t\t\t\tif (obj.planned_start) {\n\t\t\t\t\t\tobj.planned_start = webix.i18n.parseFormatDate(obj.planned_start);\n\t\t\t\t\t\tobj.planned_end = webix.i18n.parseFormatDate(obj.planned_end);\n\t\t\t\t\t\tops.updatePlannedTaskDuration(obj);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (obj.type === \"split\") {\n\t\t\t\t\t\tobj.open = obj.opened = 0;\n\t\t\t\t\t\tobj.$css = \"webix_gantt_split_task\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete obj.$css;\n\t\t\t\t\t\tobj.open = (obj.open || obj.opened) * 1 || 0;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t$sort: {\n\t\t\t\t\tby: \"position\",\n\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\tas: \"int\",\n\t\t\t\t},\n\t\t\t\t$serialize: data => this.taskOut(data),\n\t\t\t\t$export: data => this.taskOut(data),\n\t\t\t},\n\t\t});\n\n\t\treturn tasks;\n\t}\n\t/**\n\t * Re-paints all tasks in chart or, if theID is provided, a specific task\n\t * @param {string|number} updID - (optional) the ID of the task\n\t * @param {number} i - the index of the task\n\t */\n\trefreshTasks(updID, i) {\n\t\t// console.log(\"[x] render tasks\");\n\t\tif (!updID) {\n\t\t\tthis._tasks.data.order.forEach((id, i) => {\n\t\t\t\tthis.refreshTasks(id, i);\n\t\t\t});\n\t\t} else {\n\t\t\tconst t = this._tasks.getItem(updID);\n\t\t\ti = !webix.isUndefined(i) ? i : this._tasks.getIndexById(updID);\n\t\t\t// type:\"split\" results in split kids missing in datastore.order\n\t\t\tif (i < 0) i = this._tasks.getIndexById(t.parent);\n\n\t\t\tif (t.type === \"split\") {\n\t\t\t\tt.$data = this._tasks\n\t\t\t\t\t.find(k => k.parent == t.id)\n\t\t\t\t\t.sort(\n\t\t\t\t\t\t(a, b) => b.start_date - a.start_date || b.end_date - a.end_date\n\t\t\t\t\t);\n\t\t\t}\n\t\t\tthis.Helpers.updateTask(t, i);\n\n\t\t\tif (this.state.baseline && t.planned_start) this.refreshBaseline(t, i);\n\t\t}\n\t}\n\n\t/**\n\t * Arranges task baseline\n\t * @param task {object} task object\n\t * @param i {number} task index\n\n\t */\n\trefreshBaseline(task, i) {\n\t\tconst t = { ...task };\n\t\tt.start_date = task.planned_start;\n\t\tt.duration = task.planned_duration;\n\t\tt.end_date = task.planned_end;\n\t\tthis.Helpers.updateTask(t, i, this._scales, this._taskHeight);\n\t\ttask.$x0 = t.$x;\n\t\ttask.$w0 = t.$w;\n\t}\n\n\t/**\n\t * Fills and returns links collection\n\t * @returns {object} links Data Collection\n\t */\n\tlinks(force) {\n\t\tif (this._links && !force) return this._links;\n\n\t\tif (!this._links) {\n\t\t\tthis._links = this.createLinks();\n\t\t} else {\n\t\t\tthis._links.clearAll();\n\t\t}\n\n\t\tif (this.app.config.links)\n\t\t\tthis._links.parse(this.app.getService(\"backend\").links());\n\t\treturn this._links;\n\t}\n\t/**\n\t * Creates and returns links collection\n\t * @returns {object} empty links Data Collection\n\t */\n\tcreateLinks() {\n\t\treturn new webix.DataCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreUpdated\": (id, v, mode) => {\n\t\t\t\t\t// do not refresh for initial data parsing\n\t\t\t\t\tif (mode) this.refreshLinks(id);\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$init: obj => {\n\t\t\t\t\tobj.type = obj.type * 1;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\t/**\n\t * Re-paints all links in chart\n\t * @param {(string|number)} id - (optional) the ID of a link\n\t */\n\trefreshLinks(id) {\n\t\tconst tasks = this.getVisibleTasksCollection();\n\t\tif (this._links && tasks) {\n\t\t\tthis._links.data.each(l => {\n\t\t\t\tconst s = tasks.getItem(l.source);\n\t\t\t\tconst e = tasks.getItem(l.target);\n\t\t\t\tif (!s || !e || !this._isTaskVisible(s) || !this._isTaskVisible(e))\n\t\t\t\t\tl.$p = \"\";\n\t\t\t\telse this.Helpers.updateLink(l, s, e);\n\t\t\t});\n\n\t\t\t// refresh the critical path if a link was added, updated or removed\n\t\t\tif (this.state.criticalPath && id) {\n\t\t\t\tthis.showCriticalPath();\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Returns all links of a particular type for the specified task\n\t * @param {string, number} id - task id\n\t * @param {type} type - link type, \"source\" or \"target\"\n\t * @returns {array} links array\n\t */\n\tgetLinks(id, type) {\n\t\tconst found = this._links.find(a => a[type] == id);\n\t\tconst res = [];\n\n\t\tfor (let i = 0; i < found.length; i++) {\n\t\t\tconst a = found[i];\n\t\t\tconst t = this._tasks.getItem(a[type == \"source\" ? \"target\" : \"source\"]);\n\t\t\tif (t)\n\t\t\t\tres.push({\n\t\t\t\t\tid: a.id,\n\t\t\t\t\ttype: a.type.toString(),\n\t\t\t\t\ttext: t.text,\n\t\t\t\t\tttype: type,\n\t\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\t/**\n\t * Prepares task data object for serializing and export\n\t * @param {Object} data - incoming task data object\n\t * @returns {Object} - processed task data object\n\t */\n\ttaskOut(data) {\n\t\tdata = webix.copy(data);\n\n\t\tconst format = this.dateToLocalStr;\n\t\tif (data.start_date) data.start_date = format(data.start_date);\n\t\tif (data.end_date) data.end_date = format(data.end_date);\n\n\t\t// clean $-fields\n\t\tfor (let k in data) {\n\t\t\tif (k.indexOf(\"$\") === 0) delete data[k];\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t/**\n\t * Checks whether the specified task is visible (all parents open)\n\t * @param {object} x - task object\n\t * @param {boolean} tcollection - if true, the method will return the main collection regardless of the current display mode\n\t * @returns {boolean} task visibility\n\t */\n\t_isTaskVisible(x, tcollection) {\n\t\t// display: \"resources\" case to hide projects\n\t\tconst tasks = this.getVisibleTasksCollection(tcollection);\n\n\t\tconst taskParent = x.$parent;\n\t\tconst taskSplit = x.type === \"split\" && !x.open;\n\n\t\tif (taskSplit && !taskParent) return false;\n\t\twhile (x.$parent) {\n\t\t\tx = tasks.getItem(x.$parent);\n\t\t\tif (\n\t\t\t\t!((taskParent == x.id && x.type == \"split\") || x.open) ||\n\t\t\t\t(x.open && taskSplit)\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource categories collection\n\t * @returns {object} categories Data Collection\n\t */\n\tcategories(force) {\n\t\tif (this._categories && !force) return this._categories;\n\t\tif (!this._categories) {\n\t\t\tthis._categories = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._categories.clearAll();\n\t\t}\n\n\t\tthis._categories.parse(this.app.getService(\"backend\").categories());\n\t\treturn this._categories;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource collection\n\t * @returns {object} resources Data Collection\n\t */\n\tresources(force) {\n\t\tif (this._resources && !force) return this._resources;\n\n\t\tif (!this._resources) {\n\t\t\tthis._resources = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._resources.clearAll();\n\t\t}\n\n\t\tlet waitArr = [\n\t\t\tthis.app.getService(\"backend\").resources(),\n\t\t\tthis.categories(force).waitData,\n\t\t];\n\t\tif (this.app.config.resourceCalendars)\n\t\t\twaitArr.push(this.calendars(force).waitData);\n\n\t\tthis._resources.parse(\n\t\t\twebix.promise.all(waitArr).then(arr => {\n\t\t\t\tlet rData = arr[0];\n\t\t\t\trData.forEach(resource => {\n\t\t\t\t\tif (resource[\"category_id\"]) {\n\t\t\t\t\t\tconst ctg = this.categories().getItem(resource[\"category_id\"]);\n\t\t\t\t\t\tresource.category = ctg.name;\n\t\t\t\t\t\tif (!resource.unit && ctg.unit) resource.unit = ctg.unit;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\trData.sort(this.app.getService(\"operations\").sortResources);\n\t\t\t\treturn rData;\n\t\t\t})\n\t\t);\n\t\treturn this._resources;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource-task relation collection\n\t * @returns {object} assignments Data Collection\n\t */\n\tassignments(force) {\n\t\tif (this._assignments && !force) return this._assignments;\n\n\t\tif (!this._assignments) {\n\t\t\tthis._assignments = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._assignments.clearAll();\n\t\t}\n\n\t\tthis._assignments.parse(this.app.getService(\"backend\").assignments());\n\t\treturn this._assignments;\n\t}\n\n\t/**\n\t * Returns all resource assignments for the specified task\n\t * @param {string, number} id - a task id\n\t * @returns {array} an array of assignments extended with resource properties\n\t */\n\tgetAssignments(id) {\n\t\treturn webix.promise\n\t\t\t.all([this.resources().waitData, this.assignments().waitData])\n\t\t\t.then(() => {\n\t\t\t\tconst resources = this.resources();\n\t\t\t\tconst assigned = this.assignments().data.find(a => a.task == id);\n\t\t\t\treturn assigned.map(a => {\n\t\t\t\t\tlet aCopy = Object.assign({}, a);\n\t\t\t\t\tlet resource = Object.assign({}, resources.getItem(a.resource));\n\t\t\t\t\tdelete resource.id;\n\t\t\t\t\treturn Object.assign(aCopy, resource);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\t/**\n\t * Fills and returns calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcalendars(force) {\n\t\tif (this._calendars && !force) return this._calendars;\n\n\t\tif (!this._calendars) {\n\t\t\tthis._calendars = this.createCalendars();\n\t\t} else {\n\t\t\tthis._calendars.clearAll();\n\t\t}\n\n\t\tthis._calendars.parse(this.app.getService(\"backend\").calendars());\n\t\treturn this._calendars;\n\t}\n\t/**\n\t * Creates calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcreateCalendars() {\n\t\treturn new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tif (typeof obj.weekDays == \"string\")\n\t\t\t\t\t\tobj.weekDays = obj.weekDays.split(\",\").map(a => 1 * a);\n\t\t\t\t\tif (obj.holidays) {\n\t\t\t\t\t\tif (typeof obj.holidays == \"string\")\n\t\t\t\t\t\t\tobj.holidays = obj.holidays.split(\",\");\n\t\t\t\t\t\tobj.holidays = obj.holidays.map(d =>\n\t\t\t\t\t\t\twebix.Date.datePart(new Date(d))\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Marks all tasks as critical or not\n\t * @param {Boolean} clean - pass true if you want to remove existing critical path markers\n\t */\n\tshowCriticalPath(clean) {\n\t\tif (clean) {\n\t\t\tthis._tasks.data.order.forEach(id => {\n\t\t\t\tconst task = this._tasks.getItem(id);\n\t\t\t\tdelete task.$critical;\n\t\t\t});\n\t\t} else {\n\t\t\tconst all = this._tasks.data.getRange().sort((a, b) => {\n\t\t\t\treturn (\n\t\t\t\t\tb.end_date - a.end_date ||\n\t\t\t\t\t(a.parent == b.id ? 1 : b.parent == a.id ? -1 : 0) ||\n\t\t\t\t\tb.start_date - a.start_date\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tlet latestDate = webix.Date.copy(all[0].end_date);\n\t\t\tall.forEach(task => {\n\t\t\t\ttask.$critical = this.isTaskCritical(task, latestDate);\n\t\t\t});\n\t\t}\n\t\tthis._tasks.data.callEvent(\"onStoreUpdated\", [null, null, \"paint\"]);\n\t}\n\t/**\n\t * Decides if a task is a part of the critical path\n\t * @param {Object} task - task data\n\t * @param {Date} latestDate - the date by which all tasks end\n\t * @returns {Boolean}\n\t */\n\tisTaskCritical(task, latestDate) {\n\t\tif (latestDate && webix.Date.equal(latestDate, task.end_date)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tconst links = this._links.find(l => l.source == task.id && l.type == 0);\n\t\t\tfor (let i = 0; i < links.length; ++i) {\n\t\t\t\t// a task is critical if its end is linked to the start of a critical task\n\t\t\t\t// and there is no slack time between them\n\t\t\t\tconst dependent = this._tasks.getItem(links[i].target);\n\t\t\t\tif (\n\t\t\t\t\tdependent.$critical &&\n\t\t\t\t\tthis.isNoSlack(dependent.start_date, task.end_date, task.id)\n\t\t\t\t)\n\t\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (task.parent != 0) {\n\t\t\t\tconst parent = this._tasks.getItem(task.parent);\n\t\t\t\treturn parent.$critical && task.end_date >= parent.end_date;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Checks if there is slack between 2 linked tasks\n\t * @param {Date} nextStart - the start date of the next linked task\n\t * @param {Date} currentEnd - the end date of the currently checked task\n\t * @param {String} taskId - the id of the currently checked task (optional, resourceCalendar related)\n\t * @returns {Boolean} the result of the check; true if there is no slack\n\t */\n\tisNoSlack(nextStart, currentEnd, taskId) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tif (currentEnd >= nextStart) return true;\n\n\t\t\tfor (let date = webix.Date.copy(currentEnd); date < nextStart; ) {\n\t\t\t\tif (!this.isHoliday(date, taskId)) return false;\n\t\t\t\twebix.Date.add(date, 1, \"day\");\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn currentEnd >= nextStart;\n\t}\n\n\t/**\n\t * Decides if a link is a part of the critical path\n\t * @param {Object} link - the data object of a link\n\t * @returns {Boolean} the result of the check; true if the link connects critical tasks\n\t */\n\tisLinkCritical(link) {\n\t\tlet critical = false;\n\t\tif (link.type == 0) {\n\t\t\tconst tasks = this.tasks();\n\t\t\tconst s = tasks.getItem(link.source);\n\t\t\tconst t = tasks.getItem(link.target);\n\t\t\tcritical = s && t && s.$critical && t.$critical;\n\t\t}\n\t\treturn critical;\n\t}\n\n\t/**\n\t * Gets visible tasks collection\n\t * @param {boolean} tasks - if true, the method will return the main collection regardless of the current display mode\n\t * @returns {object} webix.TreeCollection\n\t */\n\tgetVisibleTasksCollection(tasks) {\n\t\tif (!tasks && this.state.display == \"resources\") {\n\t\t\tconst g = this.app.getService(\"grouping\");\n\t\t\treturn g ? g.getResourceTree() : null;\n\t\t}\n\t\treturn this._tasks;\n\t}\n\n\ttaskCalendarMap(now, force) {\n\t\tif (now) return this._calendarMap || null;\n\n\t\tif (!this._calendarMap) {\n\t\t\tthis.assignments().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t\tthis.resources().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t\tthis.calendars().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t}\n\n\t\tconst waitArr = [\n\t\t\tthis.assignments(force).waitData,\n\t\t\tthis.resources(force).waitData,\n\t\t];\n\n\t\t// forced from resources\n\t\tif (!force) {\n\t\t\twaitArr.push(this.calendars().waitData);\n\t\t}\n\n\t\treturn webix.promise.all(waitArr).then(() => {\n\t\t\tif (!this._calendarMap) this.refreshCalendarMap();\n\t\t\treturn this._calendarMap;\n\t\t});\n\t}\n\trefreshCalendarMap() {\n\t\tconst resources = this.resources();\n\t\tconst calendars = this.calendars();\n\t\tlet data = {};\n\t\tthis.assignments().data.each(obj => {\n\t\t\tconst resource = resources.getItem(obj.resource);\n\t\t\tif (resource) {\n\t\t\t\tconst id = resource.calendar_id;\n\t\t\t\tconst cal = id ? calendars.getItem(id) : null;\n\t\t\t\tif (cal && !data[obj.task]) data[obj.task] = cal;\n\t\t\t}\n\t\t});\n\t\treturn (this._calendarMap = data);\n\t}\n\n\tgetTaskCalendar(taskId) {\n\t\tconst map = this.taskCalendarMap(true);\n\t\treturn map ? map[taskId] : null;\n\t}\n\tisHoliday(date, taskId) {\n\t\tif (taskId && this._calendarMap) {\n\t\t\tconst calendar = this._calendarMap[taskId];\n\t\t\tif (calendar) return this.Helpers.isResourceHoliday(date, calendar);\n\t\t}\n\t\treturn this.app.config.isHoliday(date);\n\t}\n\n\t/**\n\t * Clears all existing data collections; resets aggregated data, state, and scales\n\t */\n\tclearAll() {\n\t\tconst grouping = this.app.getService(\"grouping\");\n\t\tconst collections = [\n\t\t\t\"tasks\",\n\t\t\t\"links\",\n\t\t\t\"resources\",\n\t\t\t\"categories\",\n\t\t\t\"assignments\",\n\t\t\t\"calendars\",\n\t\t];\n\n\t\tthis.state.$batch({\n\t\t\tedit: null,\n\t\t\tselected: null,\n\t\t\tsort: null,\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t});\n\n\t\tif (this.app.config.resourcesDiagram) {\n\t\t\tconst rdCollection = grouping.getRDCollection();\n\t\t\trdCollection.clearAll();\n\t\t}\n\n\t\tif (this.app.config.resources) {\n\t\t\tconst rCollection = grouping.getResourceTree();\n\t\t\trCollection.clearAll();\n\t\t}\n\n\t\tcollections.forEach(name => {\n\t\t\tconst key = \"_\" + name;\n\t\t\tif (this[key]) this[key].clearAll();\n\t\t});\n\n\t\tthis.resetScales();\n\t}\n\n\t/**\n\t * Completely reloads data in the component; repaints application with new data\n\t */\n\treload() {\n\t\tthis.clearAll();\n\n\t\tconst grouping = this.app.getService(\"grouping\");\n\t\tconst collections = [\"tasks\", \"links\"];\n\t\tconst waitArr = [];\n\n\t\tif (this.app.config.resources && !this.app.config.resourceCalendars) {\n\t\t\tcollections.push(\"resources\", \"assignments\");\n\t\t}\n\n\t\tcollections.forEach(name => {\n\t\t\tconst collection = this[name](true);\n\t\t\twaitArr.push(collection.waitData);\n\t\t});\n\n\t\tif (this.app.config.resourcesDiagram) {\n\t\t\tgrouping.getRDCollection(true);\n\t\t}\n\n\t\twebix.promise.all(waitArr).then(() => {\n\t\t\tthis.app.refresh();\n\t\t});\n\t}\n\tupdateScaleMinMax(tasks) {\n\t\tlet min = Infinity;\n\t\tlet max = -Infinity;\n\t\ttasks.data.each(d => {\n\t\t\tif (d.start_date < min) min = d.start_date;\n\t\t\tif (d.end_date > max) max = d.end_date;\n\t\t\tif (this.state.baseline && d.planned_start && d.planned_end) {\n\t\t\t\tif (d.planned_start < min) min = d.planned_start;\n\t\t\t\tif (d.planned_end > max) max = d.planned_end;\n\t\t\t}\n\t\t});\n\t\tif (typeof min === \"object\") {\n\t\t\tconst s = this.getScales();\n\t\t\tthis.setScales(\n\t\t\t\tthis.Helpers.addUnit(s.minUnit, min, -1),\n\t\t\t\tthis.Helpers.addUnit(s.minUnit, max, 1),\n\t\t\t\ts.precise\n\t\t\t);\n\t\t}\n\t}\n}\n","export default class Backend {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t * @param {string} url - server url\n\t */\n\tconstructor(app, url) {\n\t\tthis.app = app;\n\t\tthis._url = url;\n\t}\n\t/**\n\t * Returns absolute url based on relative one\n\t * @param {string} path - relative url\n\t * @returns {string} absolute url\n\t */\n\turl(path) {\n\t\treturn this._url + path;\n\t}\n\t/**\n\t * Loads tasks\n\t * @returns {promise} promise that resolves with tasks array\n\t */\n\ttasks() {\n\t\treturn webix.ajax(this.url(\"tasks\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads links\n\t * @returns {promise} promise that resolves with links array\n\t */\n\tlinks() {\n\t\treturn webix.ajax(this.url(\"links\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads resources\n\t * @returns {promise} promise that resolves with resources array\n\t */\n\tresources() {\n\t\treturn webix.ajax(this.url(\"resources\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads resource categories\n\t * @returns {promise} promise that resolves with categories data\n\t */\n\tcategories() {\n\t\treturn webix.ajax(this.url(\"categories\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads task-resource data\n\t * @returns {promise} promise that resolves with array of task-resource assignments\n\t */\n\tassignments() {\n\t\treturn webix.ajax(this.url(\"assignments\")).then(res => res.json());\n\t}\n\t/**\n\t * Returns calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcalendars() {\n\t\treturn webix.ajax(this.url(\"calendars\")).then(res => res.json());\n\t}\n\t/**\n\t * Adds task\n\t * @param {object} obj - object with task fields\n\t * @param {string} mode - the relative position of the new task in a branch: \"first\", \"last\", \"after\"\n\t * @param {(string|number)} parent - parent task id, can be \"0\" for root\n\t * @returns {promise} promise that resolves with server response\n\t */\n\taddTask(obj, mode, parent) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"tasks\"), { ...obj, mode, parent })\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes task\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveTask(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"tasks/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates task\n\t * @param {(string|number)} id - task id\n\t * @param {Object} obj - object with task fields\n\t * @param {Boolean} split - flag that indicates that this is a splitting of a task\n\t * @returns {Promise} promise that resolves with with server response\n\t */\n\tupdateTask(id, obj, split) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tasks/\" + id + (split ? \"/split\" : \"\")), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\n\t/**\n\t * Changes order of tasks\n\t * @param {(string|number)} id - task id\n\t * @param {Object} obj - task position\n\t * @returns {Promise} promise that resolves with with server response\n\t */\n\treorderTask(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tasks/\" + id + \"/position\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Adds link\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with server response\n\t */\n\taddLink(obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"links\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates link\n\t * @param {string, number} id - link id\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with with server response\n\t */\n\tupdateLink(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"links/\" + id), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes link\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveLink(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"links/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Adds a new resource assignment to a task\n\t * @param {object} obj - an object with \"task\", \"resource\" and \"value\" fields\n\t * @returns {promise} a promise that is resolved with an object of a resource task\n\t */\n\taddAssignment(obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"assignments\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates resource assignment\n\t * @param {string, number} id -  an id of a task resource record\n\t * @param {object} obj - an object with record fields\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tupdateAssignment(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"assignments/\" + id), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes resource assignment\n\t * @param {string, number} id - an id of an assignment record\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tremoveAssignment(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"assignments/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n}\n","export default class Operations {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis._local = this.app.getService(\"local\");\n\t\tthis._helpers = this.app.getService(\"helpers\");\n\t\tthis._back = this.app.getService(\"backend\");\n\t\tthis._state = this.app.getState();\n\t}\n\t/**\n\t * Adds task\n\t * @param {object} obj - object with task fields\n\t * @param {number} index - index within a parent branch, 0 or -1\n\t * @param {string, number} parent - parent task id, can be \"0\" for root\n\t * @param {string} mode - (optional) name of the change, \"move\", \"start\", \"end\" or \"duration\"\n\t * @returns {promise} promise that resolves with task object\n\t */\n\taddTask(obj, index, parent, mode) {\n\t\tthis.updateTaskDuration(obj, mode);\n\t\tif (obj.planned_start) this.updatePlannedTaskDuration(obj, mode);\n\n\t\tconst addMode = index == 0 ? \"first\" : \"last\";\n\t\treturn this._back\n\t\t\t.addTask(this.cleanData(obj), addMode, parent)\n\t\t\t.then(added => {\n\t\t\t\tthis._local.adjustScale(obj);\n\n\t\t\t\tconst tasks = this._local.tasks();\n\t\t\t\ttasks.add({ ...obj, id: added.id, parent }, index, parent);\n\n\t\t\t\treturn this.completeAdd(parent, added);\n\t\t\t});\n\t}\n\n\t/**\n\t * Splits a task via dnd (adds a subtask that will be rendered in the same line)\n\t * @param {Object} obj - data of a new subtask\n\t * @param {number} index - the index of a new subtask\n\t * @param {(string|number)} parent - the ID of the parent task\n\t * @param {Object} row - data of the parent task\n\t * @returns {Promise<Object>} a promise that resolves with server response (object like {id:\"some\", sibling:\"some\"} with task ids)\n\t */\n\tsplitTaskWithDnd(obj, index, parent, row) {\n\t\tthis.updateTaskDuration(obj);\n\t\treturn this._back\n\t\t\t.updateTask(parent, { ...obj, position: index, parent }, true)\n\t\t\t.then(res => {\n\t\t\t\tthis._local.adjustScale(obj);\n\n\t\t\t\tconst tasks = this._local.tasks();\n\t\t\t\ttasks.updateItem(parent, {\n\t\t\t\t\ttype: \"split\",\n\t\t\t\t\tduration: row.duration || 1,\n\t\t\t\t\tprogress: row.progress || 0,\n\t\t\t\t});\n\t\t\t\tif (\n\t\t\t\t\t(res.sibling && res.sibling != 0) ||\n\t\t\t\t\t!tasks.find(t => t.parent == parent, true)\n\t\t\t\t) {\n\t\t\t\t\ttasks.add(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...row,\n\t\t\t\t\t\t\ttype: \"task\",\n\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\tid: res.sibling,\n\t\t\t\t\t\t\tduration: row.duration || 1,\n\t\t\t\t\t\t\tprogress: row.progress || 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tparent\n\t\t\t\t\t);\n\t\t\t\t\t++index;\n\t\t\t\t}\n\n\t\t\t\ttasks.add(\n\t\t\t\t\t{ ...obj, id: res.id, parent, position: index },\n\t\t\t\t\tindex,\n\t\t\t\t\tparent\n\t\t\t\t);\n\n\t\t\t\treturn this.completeAdd(parent, res, res.sibling);\n\t\t\t});\n\t}\n\n\t/**\n\t * Runs some common logic for add and split operations (see comments inside the method)\n\t * @param {(string|number)} parent - the ID of a parent task\n\t * @param {Object} added - server response (object like {id:\"some\", sibling:\"some\"} with task ids, sib;ing is optional)\n\t * @param {id} sibling - (optional) the ID of a first sibling added to split task that was ordinary before splitting\n\t * @returns {Promise<Object>} a promise that resolves with server response (object like {id:\"some\", sibling:\"some\"} with task ids)\n\t */\n\tcompleteAdd(parent, added, sibling) {\n\t\tif (parent) {\n\t\t\treturn this.syncProject(parent).then(() => {\n\t\t\t\t// critical path update\n\t\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\n\t\t\t\tif (sibling) added.sibling = sibling;\n\t\t\t\treturn added;\n\t\t\t});\n\t\t} else return webix.promise.resolve(added);\n\t}\n\n\t/**\n\t * Updates task\n\t * @param {string, number} id - task id\n\t * @param {object} obj - object with task fields\n\t * @param {string} mode - (optional) name of the change, \"move\", \"start\", \"end\" or \"duration\"\n\t * @param {boolean} inner - (optional) flag to mark inner logic call\n\t * @returns {promise} promise that resolves with task fields\n\t */\n\tupdateTask(id, obj, mode, inner) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst item = webix.copy(tasks.getItem(id));\n\t\tconst next = { ...item, ...obj };\n\n\t\tlet updateDates = !(\n\t\t\twebix.Date.equal(item.start_date, next.start_date) &&\n\t\t\twebix.Date.equal(item.end_date, next.end_date)\n\t\t);\n\t\tif (updateDates) {\n\t\t\tthis.updateTaskDuration(next, mode);\n\t\t}\n\t\tconst updatePlanned =\n\t\t\tnext.planned_start &&\n\t\t\t!(\n\t\t\t\twebix.Date.equal(item.planned_start, next.planned_start) &&\n\t\t\t\twebix.Date.equal(item.planned_end, next.planned_end)\n\t\t\t);\n\t\tif (updatePlanned) this.updatePlannedTaskDuration(next, mode);\n\n\t\tif (!inner && next.type == \"project\" && item.type != \"project\")\n\t\t\treturn this.syncProject(id, next);\n\n\t\treturn this._back.updateTask(id, this.cleanData(next)).then(() => {\n\t\t\t// scale must be updated before the task\n\t\t\tconst { start, end } = this._local.getScales();\n\t\t\tif (\n\t\t\t\tstart > next.start_date ||\n\t\t\t\tend < next.end_date ||\n\t\t\t\t(updatePlanned &&\n\t\t\t\t\t(start > next.planned_start || end < next.planned_end))\n\t\t\t)\n\t\t\t\tthis._local.adjustScale(next);\n\n\t\t\ttasks.updateItem(id, next);\n\n\t\t\tif (next.type != \"task\" && item.type == \"task\")\n\t\t\t\tthis.removeAssignments(next);\n\n\t\t\t//update dependent project or tasks\n\t\t\tif (\n\t\t\t\t!inner &&\n\t\t\t\t(updateDates ||\n\t\t\t\t\titem.progress != next.progress ||\n\t\t\t\t\titem.parent != next.parent)\n\t\t\t) {\n\t\t\t\tlet res;\n\t\t\t\tif (item.$count && item.type == \"project\")\n\t\t\t\t\tres = this.syncTasks(id, item.start_date, next.start_date).then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\treturn this.syncProject(item.parent);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\telse {\n\t\t\t\t\tif (item.parent != next.parent) {\n\t\t\t\t\t\tres = webix.promise.all([\n\t\t\t\t\t\t\tthis.syncProject(next.parent),\n\t\t\t\t\t\t\tthis.syncProject(item.parent),\n\t\t\t\t\t\t]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres = this.syncProject(next.parent);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// critical path update\n\t\t\t\tres.then(() => {\n\t\t\t\t\tif (this._state.criticalPath) {\n\t\t\t\t\t\ttasks.updateItem(id, { $critical: false });\n\t\t\t\t\t\tthis._local.showCriticalPath();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn next;\n\t\t});\n\t}\n\n\t/**\n\t * Normalizes task end_date and duration correspondence\n\t * @param {Object} task - a task\n\t * @param {string} mode - type of date data operation: \"move\", \"start\", \"end\", \"duration\", undefined\n\t */\n\tupdateTaskDuration(task, mode) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet dir;\n\t\t\tif (mode) {\n\t\t\t\tmode = mode == \"move\" ? \"start\" : mode;\n\t\t\t\tconst old = this._local.tasks().getItem(task.id);\n\t\t\t\tconst field =\n\t\t\t\t\tmode + (mode === \"start\" || mode === \"end\" ? \"_date\" : \"\");\n\t\t\t\tdir = old[field] > task[field] ? -1 : 1;\n\t\t\t\tif (mode != \"start\") mode = \"end\";\n\t\t\t}\n\t\t\tlet scales = webix.copy(this._local.getScales());\n\t\t\tscales.isHoliday = date => {\n\t\t\t\treturn this._local.isHoliday(date, task.id);\n\t\t\t};\n\t\t\tthis._helpers.updateTaskDuration(task, scales, mode, dir);\n\t\t} else this._helpers.updateTaskDuration(task);\n\t}\n\n\tupdatePlannedTaskDuration(task, mode) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet dir;\n\t\t\tif (mode) {\n\t\t\t\tconst old = this._local.tasks().getItem(task.id);\n\t\t\t\tconst field = \"planned_\" + mode;\n\t\t\t\tdir = old[field] > task[field] ? -1 : 1;\n\t\t\t}\n\t\t\tlet scales = webix.copy(this._local.getScales());\n\t\t\tscales.isHoliday = date => {\n\t\t\t\treturn this._local.isHoliday(date, task.id);\n\t\t\t};\n\t\t\tthis._updatePlannedTaskDuration(task, scales, mode, dir);\n\t\t} else this._updatePlannedTaskDuration(task);\n\t}\n\t_updatePlannedTaskDuration(task, scales, mode, dir) {\n\t\tconst t = { ...task };\n\t\tt.start_date = task.planned_start;\n\t\tt.duration = task.planned_duration;\n\t\tt.end_date = task.planned_end;\n\t\tthis._helpers.updateTaskDuration(t, scales, mode, dir);\n\t\ttask.planned_start = t.start_date;\n\t\ttask.planned_end = t.end_date;\n\t\ttask.planned_duration = t.duration;\n\t}\n\n\t/**\n\t * Updates related tasks when project start changes\n\t * @param {string, number} id - project id\n\t * @param {Date} old - old start date\n\t * @param {Date} change - current start date\n\t */\n\tsyncTasks(id, old, change) {\n\t\tlet diff = change - old;\n\n\t\tif (this.app.config.excludeHolidays)\n\t\t\tdiff = this.getWorkDateDiff(diff, old, id);\n\n\t\tif (diff) {\n\t\t\tconst p = [];\n\t\t\tthis._local.tasks().data.eachSubItem(id, kid => {\n\t\t\t\tlet newDate = kid.start_date.valueOf() + diff;\n\t\t\t\tif (this.app.config.excludeHolidays) {\n\t\t\t\t\tconst delta =\n\t\t\t\t\t\tdiff - this.getWorkDateDiff(diff, kid.start_date, kid.id);\n\t\t\t\t\tif (delta) newDate = newDate + delta;\n\t\t\t\t}\n\n\t\t\t\tconst changedKid = {\n\t\t\t\t\t...kid,\n\t\t\t\t\tstart_date: new Date(newDate),\n\t\t\t\t\tend_date: null,\n\t\t\t\t};\n\n\t\t\t\tp.push(this.updateTask(kid.id, changedKid, \"move\", true));\n\t\t\t});\n\t\t\treturn webix.promise.all(p);\n\t\t}\n\n\t\treturn webix.promise.resolve();\n\t}\n\t/**\n\t * Extracts working days from date difference\n\t * @param {number} diff - difference in days, milliseconds\n\t * @param {Date} old - the original date\n\t * @param {string} taskId - a task id (optional, resourceCalendars related)\n\t * @returns {number} difference in working days in milliseconds\n\t */\n\tgetWorkDateDiff(diff, old, taskId) {\n\t\tconst dir = Math.sign(diff);\n\t\tconst dayLen = 86400000;\n\t\tconst ad = dir * Math.floor(diff / dayLen);\n\t\tfor (let i = 0, date = old; i < ad; ++i) {\n\t\t\twebix.Date.add(date, dir, \"day\");\n\t\t\tif (this._local.isHoliday(date, taskId)) diff = diff - dir * dayLen;\n\t\t}\n\t\treturn diff;\n\t}\n\n\t/**\n\t * Updates related project when task start or end date changes\n\t * @param {string, number} id - task id\n\t * @param {object} item - task object, if it is converted to project\n\t * @returns {Promise}\n\t */\n\tsyncProject(id, item) {\n\t\tconst tasks = this._local.tasks();\n\n\t\tif (!item) {\n\t\t\titem = tasks.getItem(id);\n\t\t\tif (this.app.config.projects && item && item.type != \"split\") {\n\t\t\t\titem.type = item.$count ? \"project\" : \"task\";\n\t\t\t\tthis.removeAssignments(item);\n\t\t\t} else {\n\t\t\t\twhile (item && item.type != \"project\") {\n\t\t\t\t\tid = tasks.getParentId(id);\n\t\t\t\t\titem = tasks.getItem(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (item && item.$count) {\n\t\t\titem = this.setProjectData(item);\n\t\t}\n\t\tif (item) {\n\t\t\treturn this.updateTask(id, item, \"start\", true).then(() => {\n\t\t\t\tthis.syncProject(item.parent);\n\t\t\t\treturn item;\n\t\t\t});\n\t\t} else return webix.promise.resolve();\n\t}\n\t/**\n\t * Updates project with task-dependent data taken from tasks collection or an array of child items\n\t * @param {object} item - a project object\n\t * @param {Object} tasks collection (optional, local.tasks() by default)\n\t * @param {array} branch - an array of child items of a project (optional)\n\t */\n\tsetProjectData(item, tasks, branch) {\n\t\tif (!branch) item = webix.copy(item);\n\t\tlet min = Infinity,\n\t\t\tmax = 0,\n\t\t\tprogress = 0,\n\t\t\tduration = 0;\n\n\t\tconst handler = kid => {\n\t\t\tmin = kid.start_date < min ? kid.start_date : min;\n\t\t\tmax = kid.end_date > max ? kid.end_date : max;\n\t\t\tif (kid.duration && !(kid.type == \"project\" && kid.$count)) {\n\t\t\t\tprogress += kid.duration * kid.progress;\n\t\t\t\tduration += kid.duration * 1;\n\t\t\t}\n\t\t};\n\n\t\tif (branch) branch.forEach(handler);\n\t\telse {\n\t\t\tconst collection = tasks || this._local.tasks();\n\t\t\tcollection.data.eachSubItem(item.id, handler);\n\t\t}\n\n\t\tif (!webix.Date.equal(item.start_date, min)) {\n\t\t\titem.start_date = min;\n\t\t\titem.duration = null;\n\t\t}\n\t\tif (!webix.Date.equal(item.end_date, max)) {\n\t\t\titem.end_date = max;\n\t\t\titem.duration = null;\n\t\t}\n\t\titem.progress = progress ? Math.round(progress / duration) : progress;\n\t\treturn item;\n\t}\n\t/**\n\t * Updates task time after drag-n-drop\n\t * @param {string, number} id - task id\n\t * @param {string} mode - type of change: \"start\", \"end\" or \"move\"\n\t * @param {number} time - number of units by which task was shifted, can be negative\n\t * @returns {promise} promise that resolves with change object\n\t */\n\tupdateTaskTime(id, mode, time) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst task = tasks.getItem(id);\n\n\t\tconst obj = {};\n\t\tconst s = this._local.getScales();\n\n\t\tconst unit = s.precise\n\t\t\t? this._helpers.getSmallerUnit(s.minUnit)\n\t\t\t: s.minUnit;\n\t\tif (mode === \"start\" || mode === \"move\") {\n\t\t\tconst offsetDate = s.precise\n\t\t\t\t? task.start_date\n\t\t\t\t: this._helpers.getUnitStart(unit, task.start_date);\n\t\t\tobj.start_date = this._helpers.addUnit(unit, offsetDate, time);\n\t\t\tif (mode === \"start\" && obj.start_date > task.end_date)\n\t\t\t\tobj.start_date = this._helpers.addUnit(unit, task.end_date, -1);\n\t\t} else if (mode === \"end\") {\n\t\t\tconst us = this._helpers.getUnitStart(unit, task.end_date);\n\t\t\tconst offsetDate =\n\t\t\t\ts.precise || webix.Date.equal(us, task.end_date)\n\t\t\t\t\t? task.end_date\n\t\t\t\t\t: this._helpers.addUnit(unit, us, 1);\n\t\t\tobj.end_date = this._helpers.addUnit(unit, offsetDate, time);\n\n\t\t\tif (obj.end_date < task.start_date)\n\t\t\t\tobj.end_date = this._helpers.addUnit(unit, task.start_date, 1);\n\t\t}\n\n\t\tif (mode === \"move\") obj.end_date = null;\n\t\telse obj.duration = 0;\n\n\t\treturn this.updateTask(id, obj, mode);\n\t}\n\t/**\n\t * Removes task\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveTask(id) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst links = this._local.links();\n\n\t\t// [FIXME] - multiple redraw calls\n\t\tconst toRemove = links.find(a => a.source == id || a.target == id);\n\t\ttoRemove.forEach(a => links.remove(a.id));\n\n\t\treturn this._back.removeTask(id).then(res => {\n\t\t\tconst parent = tasks.getItem(id).parent;\n\t\t\ttasks.remove(id);\n\n\t\t\tif (\n\t\t\t\tthis.app.config.split &&\n\t\t\t\tparent != 0 &&\n\t\t\t\ttasks.getItem(parent).type === \"split\" &&\n\t\t\t\t!tasks.find(k => k.parent == parent, true)\n\t\t\t) {\n\t\t\t\treturn this.updateTask(parent, { type: \"task\" }).then(() => {\n\t\t\t\t\treturn this.completeRemoval(res, parent);\n\t\t\t\t});\n\t\t\t} else return this.completeRemoval(res, parent);\n\t\t});\n\t}\n\t/**\n\t * Synchronizes project and updates critical path after a task is removed\n\t * @param {Object} res - server response\n\t * @param {(string|number)} parent - the ID of a parent task\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tcompleteRemoval(res, parent) {\n\t\treturn this.syncProject(parent).then(() => {\n\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Adds a link\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with link object\n\t */\n\taddLink(obj) {\n\t\tif (!this.linkExists(obj)) {\n\t\t\treturn this._back.addLink(obj).then(added => {\n\t\t\t\tobj.id = added.id;\n\t\t\t\tthis._local.links().add(obj);\n\t\t\t\treturn obj;\n\t\t\t});\n\t\t}\n\t\treturn webix.promise.reject();\n\t}\n\n\t/**\n\t * Checks if two tasks are already connected by a link of the same type\n\t * @param {Object} obj - the data object of a link\n\t * @returns {Object, null} - the data object of the link that was found; null if nothing was found\n\t */\n\tlinkExists(obj) {\n\t\treturn this._local.links().find(l => {\n\t\t\treturn (\n\t\t\t\tl.target == obj.target && l.source == obj.source && l.type == obj.type\n\t\t\t);\n\t\t}, true);\n\t}\n\n\t/**\n\t * Updates a link\n\t * @param {string, number} id - link id\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tupdateLink(id, obj) {\n\t\treturn this._back.updateLink(id, obj).then(res => {\n\t\t\tconst links = this._local.links();\n\t\t\tconst duplicate = this.linkExists({ ...links.getItem(id), ...obj });\n\t\t\tlinks.updateItem(id, obj);\n\t\t\tif (duplicate) {\n\t\t\t\treturn this.removeLink(duplicate.id).then(() => res);\n\t\t\t} else return res;\n\t\t});\n\t}\n\t/**\n\t * Removes link\n\t * @param {string, number} id - link id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveLink(id) {\n\t\treturn this._back.removeLink(id).then(res => {\n\t\t\tthis._local.links().remove(id);\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Moves the task to a new position within the task tree\n\t * @param {string, number} id - the ID of the task\n\t * @param {string, number} parent - the ID of the parent/branch (0 for root)\n\t * @param {number} index - the position within the target branch or root (starting from 0)\n\t * @returns {Promise} - the promise of data operation\n\t */\n\tmoveTask(id, parent, index) {\n\t\tparent = parent || 0;\n\n\t\tconst tasks = this._local.tasks();\n\t\tconst branch = tasks.data.branch[parent];\n\t\tconst oldParent = tasks.getItem(id).parent;\n\t\tconst oldIndex = tasks.data.getBranchIndex(id);\n\t\tif (\n\t\t\tparent == oldParent &&\n\t\t\t(index === oldIndex || (index === -1 && id === branch[branch.length - 1]))\n\t\t)\n\t\t\treturn webix.promise.reject();\n\n\t\ttasks.move(id, index, null, { parent });\n\n\t\treturn this._back\n\t\t\t.reorderTask(id, {\n\t\t\t\tparent,\n\t\t\t\tmode: index === 0 ? \"first\" : index === -1 ? \"last\" : \"after\",\n\t\t\t\ttarget: tasks.data.branch[parent][index - 1],\n\t\t\t})\n\t\t\t.then(res => {\n\t\t\t\tif (parent !== oldParent) {\n\t\t\t\t\ttasks.updateItem(id, { parent });\n\n\t\t\t\t\treturn webix.promise\n\t\t\t\t\t\t.all([this.syncProject(parent), this.syncProject(oldParent)])\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\t\t\t\t\t\t\treturn res;\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn res;\n\t\t\t});\n\t}\n\t/**\n\t * Updates a resource assignment\n\t * @param {string, number} id -  an id of a resource assignment\n\t * @param {object} obj - an object with updated fields\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tupdateAssignment(id, obj) {\n\t\treturn this._back.updateAssignment(id, obj).then(res => {\n\t\t\tthis._local.assignments().updateItem(id, obj);\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Assigns a resource assignment to a task\n\t * @param {object} obj - an object with \"task\", \"resource\" and \"value\" fields\n\t * @returns {promise} a promise that is resolved with an object of a resource assignment\n\t */\n\taddAssignment(obj) {\n\t\treturn this._back.addAssignment(obj).then(added => {\n\t\t\tobj.id = added.id;\n\t\t\tthis._local.assignments().add(obj);\n\t\t\treturn obj;\n\t\t});\n\t}\n\t/**\n\t * Removes a resource assignment\n\t * @param {string, number} id - an id of a resource assignment\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveAssignment(id) {\n\t\treturn this._back.removeAssignment(id).then(res => {\n\t\t\tthis._local.assignments().remove(id);\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/**\n\t * Sorts resources\n\t * @param {object} a - a resource to compare\n\t * @param {object} b - a resource to compare\n\t * @returns {number}\n\t */\n\tsortResources(a, b) {\n\t\tif (a.category == b.category) return a.name > b.name ? 1 : -1;\n\t\treturn a.category > b.category ? 1 : -1;\n\t}\n\n\t/**\n\t * Removes all assignments (if any) from a task\n\t * @param {object} task - task object\n\t * @returns {Promise}\n\t */\n\tremoveAssignments(task) {\n\t\tif (this.app.config.resources) {\n\t\t\tconst collection = this._local.assignments();\n\t\t\tlet waitArr = [];\n\t\t\treturn collection.waitData.then(() => {\n\t\t\t\tcollection.data.each(item => {\n\t\t\t\t\tif (item.task == task.id)\n\t\t\t\t\t\twaitArr.push(this.removeAssignment(item.id));\n\t\t\t\t});\n\t\t\t\tif (waitArr.length) return webix.promise.all(waitArr);\n\t\t\t\treturn webix.promise.resolve(false);\n\t\t\t});\n\t\t}\n\t\treturn webix.promise.resolve(false);\n\t}\n\n\t/**\n\t * Cleans task data from all $-fields, they are functional and locally used and should not be sent to backend\n\t * */\n\tcleanData(obj) {\n\t\tconst res = {};\n\t\tfor (let key in obj) {\n\t\t\tif (key.indexOf(\"$\") !== 0) res[key] = obj[key];\n\t\t}\n\t\treturn res;\n\t}\n\n\tupdateAssignedTaskDates(task) {\n\t\tconst obj = webix.copy(task);\n\t\tthis.updateTaskDuration(obj);\n\t\tconst updateDates = !(\n\t\t\twebix.Date.equal(task.start_date, obj.start_date) &&\n\t\t\twebix.Date.equal(task.end_date, obj.end_date)\n\t\t);\n\t\tif (updateDates) this.updateTask(task.id, obj, null, true);\n\t}\n}\n","function toInteger(dirtyNumber) {\n  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {\n    return NaN;\n  }\n\n  var number = Number(dirtyNumber);\n\n  if (isNaN(number)) {\n    return number;\n  }\n\n  return number < 0 ? Math.ceil(number) : Math.floor(number);\n}\n\nfunction requiredArgs(required, args) {\n  if (args.length < required) {\n    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');\n  }\n}\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @param {Date|Number} argument - the value to convert\n * @returns {Date} the parsed date in the local time zone\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\n\nfunction toDate(argument) {\n  requiredArgs(1, arguments);\n  var argStr = Object.prototype.toString.call(argument); // Clone the date\n\n  if (argument instanceof Date || typeof argument === 'object' && argStr === '[object Date]') {\n    // Prevent the date to lose the milliseconds when passed to new Date() in IE10\n    return new Date(argument.getTime());\n  } else if (typeof argument === 'number' || argStr === '[object Number]') {\n    return new Date(argument);\n  } else {\n    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn(\"Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule\"); // eslint-disable-next-line no-console\n\n      console.warn(new Error().stack);\n    }\n\n    return new Date(NaN);\n  }\n}\n\n/**\n * @name addDays\n * @category Day Helpers\n * @summary Add the specified number of days to the given date.\n *\n * @description\n * Add the specified number of days to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of days to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} - the new date with the days added\n * @throws {TypeError} - 2 arguments required\n *\n * @example\n * // Add 10 days to 1 September 2014:\n * const result = addDays(new Date(2014, 8, 1), 10)\n * //=> Thu Sep 11 2014 00:00:00\n */\n\nfunction addDays(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var amount = toInteger(dirtyAmount);\n\n  if (isNaN(amount)) {\n    return new Date(NaN);\n  }\n\n  if (!amount) {\n    // If 0 days, no-op to avoid changing times in the hour before end of DST\n    return date;\n  }\n\n  date.setDate(date.getDate() + amount);\n  return date;\n}\n\n/**\n * @name addMonths\n * @category Month Helpers\n * @summary Add the specified number of months to the given date.\n *\n * @description\n * Add the specified number of months to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of months to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the months added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 5 months to 1 September 2014:\n * const result = addMonths(new Date(2014, 8, 1), 5)\n * //=> Sun Feb 01 2015 00:00:00\n */\n\nfunction addMonths(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var amount = toInteger(dirtyAmount);\n\n  if (isNaN(amount)) {\n    return new Date(NaN);\n  }\n\n  if (!amount) {\n    // If 0 months, no-op to avoid changing times in the hour before end of DST\n    return date;\n  }\n\n  var dayOfMonth = date.getDate(); // The JS Date object supports date math by accepting out-of-bounds values for\n  // month, day, etc. For example, new Date(2020, 0, 0) returns 31 Dec 2019 and\n  // new Date(2020, 13, 1) returns 1 Feb 2021.  This is *almost* the behavior we\n  // want except that dates will wrap around the end of a month, meaning that\n  // new Date(2020, 13, 31) will return 3 Mar 2021 not 28 Feb 2021 as desired. So\n  // we'll default to the end of the desired month by adding 1 to the desired\n  // month and using a date of 0 to back up one day to the end of the desired\n  // month.\n\n  var endOfDesiredMonth = new Date(date.getTime());\n  endOfDesiredMonth.setMonth(date.getMonth() + amount + 1, 0);\n  var daysInMonth = endOfDesiredMonth.getDate();\n\n  if (dayOfMonth >= daysInMonth) {\n    // If we're already at the end of the month, then this is the correct date\n    // and we're done.\n    return endOfDesiredMonth;\n  } else {\n    // Otherwise, we now know that setting the original day-of-month value won't\n    // cause an overflow, so set the desired day-of-month. Note that we can't\n    // just set the date of `endOfDesiredMonth` because that object may have had\n    // its time changed in the unusual case where where a DST transition was on\n    // the last day of the month and its local time was in the hour skipped or\n    // repeated next to a DST transition.  So we use `date` instead which is\n    // guaranteed to still have the original time.\n    date.setFullYear(endOfDesiredMonth.getFullYear(), endOfDesiredMonth.getMonth(), dayOfMonth);\n    return date;\n  }\n}\n\n/**\n * @name addMilliseconds\n * @category Millisecond Helpers\n * @summary Add the specified number of milliseconds to the given date.\n *\n * @description\n * Add the specified number of milliseconds to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the milliseconds added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 750 milliseconds to 10 July 2014 12:45:30.000:\n * const result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:30.750\n */\n\nfunction addMilliseconds(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var timestamp = toDate(dirtyDate).getTime();\n  var amount = toInteger(dirtyAmount);\n  return new Date(timestamp + amount);\n}\n\nvar MILLISECONDS_IN_HOUR = 3600000;\n/**\n * @name addHours\n * @category Hour Helpers\n * @summary Add the specified number of hours to the given date.\n *\n * @description\n * Add the specified number of hours to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of hours to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the hours added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 2 hours to 10 July 2014 23:00:00:\n * const result = addHours(new Date(2014, 6, 10, 23, 0), 2)\n * //=> Fri Jul 11 2014 01:00:00\n */\n\nfunction addHours(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_HOUR);\n}\n\n/**\n * @name startOfWeek\n * @category Week Helpers\n * @summary Return the start of a week for the given date.\n *\n * @description\n * Return the start of a week for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Date} the start of a week\n * @throws {TypeError} 1 argument required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // The start of a week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Sun Aug 31 2014 00:00:00\n *\n * @example\n * // If the week starts on Monday, the start of the week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0), { weekStartsOn: 1 })\n * //=> Mon Sep 01 2014 00:00:00\n */\n\nfunction startOfWeek(dirtyDate, dirtyOptions) {\n  requiredArgs(1, arguments);\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = date.getDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setDate(date.getDate() - diff);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nfunction getTimezoneOffsetInMilliseconds(date) {\n  var utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));\n  utcDate.setUTCFullYear(date.getFullYear());\n  return date.getTime() - utcDate.getTime();\n}\n\n/**\n * @name startOfDay\n * @category Day Helpers\n * @summary Return the start of a day for the given date.\n *\n * @description\n * Return the start of a day for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the start of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The start of a day for 2 September 2014 11:55:00:\n * const result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 00:00:00\n */\n\nfunction startOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nvar MILLISECONDS_IN_DAY = 86400000;\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar days\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\n\nfunction differenceInCalendarDays(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var startOfDayLeft = startOfDay(dirtyDateLeft);\n  var startOfDayRight = startOfDay(dirtyDateRight);\n  var timestampLeft = startOfDayLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfDayLeft);\n  var timestampRight = startOfDayRight.getTime() - getTimezoneOffsetInMilliseconds(startOfDayRight); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a day is not constant\n  // (e.g. it's different in the day of the daylight saving time clock shift)\n\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_DAY);\n}\n\nvar MILLISECONDS_IN_MINUTE = 60000;\n/**\n * @name addMinutes\n * @category Minute Helpers\n * @summary Add the specified number of minutes to the given date.\n *\n * @description\n * Add the specified number of minutes to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of minutes to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the minutes added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 30 minutes to 10 July 2014 12:00:00:\n * const result = addMinutes(new Date(2014, 6, 10, 12, 0), 30)\n * //=> Thu Jul 10 2014 12:30:00\n */\n\nfunction addMinutes(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_MINUTE);\n}\n\n/**\n * @name addQuarters\n * @category Quarter Helpers\n * @summary Add the specified number of year quarters to the given date.\n *\n * @description\n * Add the specified number of year quarters to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of quarters to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the quarters added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 1 quarter to 1 September 2014:\n * const result = addQuarters(new Date(2014, 8, 1), 1)\n * //=> Mon Dec 01 2014 00:00:00\n */\n\nfunction addQuarters(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  var months = amount * 3;\n  return addMonths(dirtyDate, months);\n}\n\n/**\n * @name addWeeks\n * @category Week Helpers\n * @summary Add the specified number of weeks to the given date.\n *\n * @description\n * Add the specified number of week to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of weeks to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the weeks added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 4 weeks to 1 September 2014:\n * const result = addWeeks(new Date(2014, 8, 1), 4)\n * //=> Mon Sep 29 2014 00:00:00\n */\n\nfunction addWeeks(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  var days = amount * 7;\n  return addDays(dirtyDate, days);\n}\n\n/**\n * @name addYears\n * @category Year Helpers\n * @summary Add the specified number of years to the given date.\n *\n * @description\n * Add the specified number of years to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of years to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the years added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 5 years to 1 September 2014:\n * const result = addYears(new Date(2014, 8, 1), 5)\n * //=> Sun Sep 01 2019 00:00:00\n */\n\nfunction addYears(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMonths(dirtyDate, amount * 12);\n}\n\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the first date to compare\n * @param {Date|Number} dateRight - the second date to compare\n * @returns {Number} the result of the comparison\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * const result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * const result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\n\nfunction compareAsc(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var diff = dateLeft.getTime() - dateRight.getTime();\n\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1; // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}\n\n/**\n * Days in 1 week.\n *\n * @name daysInWeek\n * @constant\n * @type {number}\n * @default\n */\n/**\n * Milliseconds in 1 minute\n *\n * @name millisecondsInMinute\n * @constant\n * @type {number}\n * @default\n */\n\nvar millisecondsInMinute = 60000;\n/**\n * Milliseconds in 1 hour\n *\n * @name millisecondsInHour\n * @constant\n * @type {number}\n * @default\n */\n\nvar millisecondsInHour = 3600000;\n\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * var result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\n\nfunction differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}\n\nvar MILLISECONDS_IN_WEEK = 604800000;\n/**\n * @name differenceInCalendarWeeks\n * @category Week Helpers\n * @summary Get the number of calendar weeks between the given dates.\n *\n * @description\n * Get the number of calendar weeks between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Number} the number of calendar weeks\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // How many calendar weeks are between 5 July 2014 and 20 July 2014?\n * const result = differenceInCalendarWeeks(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 6, 5)\n * )\n * //=> 3\n *\n * @example\n * // If the week starts on Monday,\n * // how many calendar weeks are between 5 July 2014 and 20 July 2014?\n * const result = differenceInCalendarWeeks(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 6, 5),\n *   { weekStartsOn: 1 }\n * )\n * //=> 2\n */\n\nfunction differenceInCalendarWeeks(dirtyDateLeft, dirtyDateRight, dirtyOptions) {\n  requiredArgs(2, arguments);\n  var startOfWeekLeft = startOfWeek(dirtyDateLeft, dirtyOptions);\n  var startOfWeekRight = startOfWeek(dirtyDateRight, dirtyOptions);\n  var timestampLeft = startOfWeekLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfWeekLeft);\n  var timestampRight = startOfWeekRight.getTime() - getTimezoneOffsetInMilliseconds(startOfWeekRight); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_WEEK);\n}\n\n/**\n * @name differenceInCalendarYears\n * @category Year Helpers\n * @summary Get the number of calendar years between the given dates.\n *\n * @description\n * Get the number of calendar years between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInCalendarYears(\n *   new Date(2015, 1, 11),\n *   new Date(2013, 11, 31)\n * )\n * //=> 2\n */\n\nfunction differenceInCalendarYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  return dateLeft.getFullYear() - dateRight.getFullYear();\n}\n\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of milliseconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\n\nfunction differenceInMilliseconds(dateLeft, dateRight) {\n  requiredArgs(2, arguments);\n  return toDate(dateLeft).getTime() - toDate(dateRight).getTime();\n}\n\nvar roundingMap = {\n  ceil: Math.ceil,\n  round: Math.round,\n  floor: Math.floor,\n  trunc: function (value) {\n    return value < 0 ? Math.ceil(value) : Math.floor(value);\n  } // Math.trunc is not supported by IE\n\n};\nvar defaultRoundingMethod = 'trunc';\nfunction getRoundingMethod(method) {\n  return method ? roundingMap[method] : roundingMap[defaultRoundingMethod];\n}\n\n/**\n * @name differenceInHours\n * @category Hour Helpers\n * @summary Get the number of hours between the given dates.\n *\n * @description\n * Get the number of hours between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of hours\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many hours are between 2 July 2014 06:50:00 and 2 July 2014 19:00:00?\n * const result = differenceInHours(\n *   new Date(2014, 6, 2, 19, 0),\n *   new Date(2014, 6, 2, 6, 50)\n * )\n * //=> 12\n */\n\nfunction differenceInHours(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInHour;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name differenceInMinutes\n * @category Minute Helpers\n * @summary Get the number of minutes between the given dates.\n *\n * @description\n * Get the signed number of full (rounded towards 0) minutes between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of minutes\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many minutes are between 2 July 2014 12:07:59 and 2 July 2014 12:20:00?\n * const result = differenceInMinutes(\n *   new Date(2014, 6, 2, 12, 20, 0),\n *   new Date(2014, 6, 2, 12, 7, 59)\n * )\n * //=> 12\n *\n * @example\n * // How many minutes are between 10:01:59 and 10:00:00\n * const result = differenceInMinutes(\n *   new Date(2000, 0, 1, 10, 0, 0),\n *   new Date(2000, 0, 1, 10, 1, 59)\n * )\n * //=> -1\n */\n\nfunction differenceInMinutes(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInMinute;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\n\nfunction endOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\n\nfunction endOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var month = date.getMonth();\n  date.setFullYear(date.getFullYear(), month + 1, 0);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}\n\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to check\n * @returns {Boolean} the date is the last day of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * var result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\n\nfunction isLastDayOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  return endOfDay(date).getTime() === endOfMonth(date).getTime();\n}\n\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @description\n * Get the number of full months between the given dates using trunc as a default rounding method.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\n\nfunction differenceInMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarMonths(dateLeft, dateRight));\n  var result; // Check for the difference of less than month\n\n  if (difference < 1) {\n    result = 0;\n  } else {\n    if (dateLeft.getMonth() === 1 && dateLeft.getDate() > 27) {\n      // This will check if the date is end of Feb and assign a higher end of month date\n      // to compare it with Jan\n      dateLeft.setDate(30);\n    }\n\n    dateLeft.setMonth(dateLeft.getMonth() - sign * difference); // Math.abs(diff in full months - diff in calendar months) === 1 if last calendar month is not full\n    // If so, result must be decreased by 1 in absolute value\n\n    var isLastMonthNotFull = compareAsc(dateLeft, dateRight) === -sign; // Check for cases of one full calendar month\n\n    if (isLastDayOfMonth(toDate(dirtyDateLeft)) && difference === 1 && compareAsc(dirtyDateLeft, dateRight) === 1) {\n      isLastMonthNotFull = false;\n    }\n\n    result = sign * (difference - Number(isLastMonthNotFull));\n  } // Prevent negative zero\n\n\n  return result === 0 ? 0 : result;\n}\n\n/**\n * @name differenceInQuarters\n * @category Quarter Helpers\n * @summary Get the number of quarters between the given dates.\n *\n * @description\n * Get the number of quarters between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of full quarters\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full quarters are between 31 December 2013 and 2 July 2014?\n * const result = differenceInQuarters(new Date(2014, 6, 2), new Date(2013, 11, 31))\n * //=> 2\n */\n\nfunction differenceInQuarters(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMonths(dateLeft, dateRight) / 3;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name differenceInYears\n * @category Year Helpers\n * @summary Get the number of full years between the given dates.\n *\n * @description\n * Get the number of full years between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInYears(new Date(2015, 1, 11), new Date(2013, 11, 31))\n * //=> 1\n */\n\nfunction differenceInYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarYears(dateLeft, dateRight)); // Set both dates to a valid leap year for accurate comparison when dealing\n  // with leap days\n\n  dateLeft.setFullYear(1584);\n  dateRight.setFullYear(1584); // Math.abs(diff in full years - diff in calendar years) === 1 if last calendar year is not full\n  // If so, result must be decreased by 1 in absolute value\n\n  var isLastYearNotFull = compareAsc(dateLeft, dateRight) === -sign;\n  var result = sign * (difference - Number(isLastYearNotFull)); // Prevent negative zero\n\n  return result === 0 ? 0 : result;\n}\n\nfunction getDatePart(date, copy) {\n    if (copy)\n        date = new Date(date.valueOf());\n    // workaround for non-existent hours\n    const d = new Date(date.valueOf());\n    d.setHours(0);\n    if (d.getDate() != date.getDate()) {\n        date.setHours(1);\n    }\n    else {\n        date.setHours(0);\n    }\n    date.setMinutes(0);\n    date.setSeconds(0);\n    date.setMilliseconds(0);\n    return date;\n}\nfunction getTimePart(date, copy) {\n    if (copy)\n        date = new Date(date.valueOf());\n    return (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n}\nfunction differenceInWeeks(a, b, startOnMonday) {\n    const weekStartsOn = startOnMonday ? 1 : 0;\n    return differenceInCalendarWeeks(a, b, { weekStartsOn });\n}\nfunction getDay(date, startOnMonday) {\n    let shift = date.getDay();\n    if (startOnMonday) {\n        if (shift === 0)\n            shift = 6;\n        else\n            shift--;\n    }\n    return shift;\n}\n\nconst diff = {\n    year: differenceInYears,\n    quarter: differenceInQuarters,\n    month: differenceInMonths,\n    week: differenceInWeeks,\n    day: differenceInCalendarDays,\n    hour: differenceInHours,\n    minute: differenceInMinutes,\n};\nfunction countDaysInMonth(date) {\n    if (!date)\n        return 30;\n    const m = date.getMonth();\n    if (m === 1) {\n        const y = date.getFullYear();\n        if (y % 4)\n            return 28;\n        if (y % 100)\n            return 29;\n        if (y % 400)\n            return 28;\n        return 29;\n    }\n    if ((m % 2 && m < 7) || (!(m % 2) && m > 7)) {\n        return 30;\n    }\n    return 31;\n}\nconst smallerCount = {\n    year: [\"quarter\", 4],\n    quarter: [\"month\", 3],\n    month: [\"day\", countDaysInMonth],\n    week: [\"day\", 7],\n    day: [\"hour\", 24],\n    hour: [\"minute\", 60],\n    minute: [\"minute\", 1],\n};\nconst add = {\n    year: addYears,\n    quarter: addQuarters,\n    month: addMonths,\n    week: addWeeks,\n    day: addDays,\n    hour: addHours,\n    minute: addMinutes,\n};\n/**\n * Calculates the difference between two dates in units\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\n * @param {Date} next - a later date\n * @param {Date} prev - an earlier date\n * @param {boolean} startOnMonday - true if week starts on Monday, false otherwise\n * @param {boolean} precise - current precision setting of the scales (if true, diff will be counted for smallerCount)\n * @param {boolean} wt - shows that diff will be counted for the width of a task\n * @returns {number} - an int (if precise is false) or a float number\n */\nfunction innerDiff(unit, next, prev, startOnMonday, precise, wt) {\n    let minUnit = unit;\n    if (precise) {\n        const u = smallerCount[unit][0];\n        if (typeof u !== \"number\" && typeof u !== \"function\")\n            minUnit = u;\n    }\n    let start = prev;\n    let end = next;\n    if (wt) {\n        start = getUnitStart(minUnit, start, startOnMonday);\n        end = getUnitStart(minUnit, end, startOnMonday);\n        if (end < next)\n            end = addUnit(minUnit)(end, 1);\n    }\n    if (precise) {\n        const filled = diff[minUnit](end, start);\n        const count = smallerCount[unit][1];\n        let all = 0;\n        if (typeof count === \"function\")\n            all = count(prev);\n        else if (typeof count === \"number\")\n            all = count;\n        return filled / all;\n    }\n    else {\n        return diff[minUnit](end, start, startOnMonday);\n    }\n}\n/**\n * Returns a function for calculating the difference between two dates in units\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\n * @returns {function} - details below\n */\nfunction getDiff(unit) {\n    /**\n     * the returned function calculates the difference between two dates based on passed parameters\n     * @param {Date} next - first date\n     * @param {Date} prev - second date\n     * @param {boolean} startOnMonday - true if week starts on Monday, false otherwise\n     * @param {boolean} precise false by default, true when used to count x-position\n     * and width of tasks with 'step-1' precision\n     * @param {boolean} wt - marker that diff is used to count width of a task;\n     * if diff returns 0, you have to add 1; otherwise tasks that are within 1 unit will have 0 width\n     * and will be displayed incorrectly\n     * @returns {number} - the difference between two dates in 'units'; if 'precise' is true, the number is float, otherwise int\n     */\n    return (next, prev, startOnMonday, precise, wt) => {\n        if (unit === \"month\" && precise) {\n            return getMonthDayDiff(next, prev, wt);\n        }\n        else {\n            return innerDiff(unit, next, prev, startOnMonday, precise, wt);\n        }\n    };\n}\n/**\n * Calculates the difference in months between two days for a scale with precision setting\n * This is a specific case of diff counting, because a month can have 28-31 days\n * @param {Date} end - a later date\n * @param {Date} start - an earlier date\n * @param {Boolean} wt - shows that diff will be counted for the width of a task\n * @returns {number} - a float number\n */\nfunction getMonthDayDiff(end, start, wt) {\n    if (sameMonth(start, end)) {\n        return innerDiff(\"month\", end, start, null, true, wt);\n    }\n    // if starts not on 1st day\n    let daysOfFirstMonth = 0;\n    if (start.getDate() > 1) {\n        const me = new Date(start.getFullYear(), start.getMonth() + 1, 1);\n        daysOfFirstMonth = innerDiff(\"month\", me, start, null, true);\n        start = me;\n    }\n    // if lasts 1+ whole months\n    let months = 0;\n    if (!sameMonth(start, end)) {\n        months = innerDiff(\"month\", getUnitStart(\"month\", end), start); // int part\n        start = addUnit(\"month\")(start, months);\n    }\n    // all above plus days of last month if any\n    return daysOfFirstMonth + months + innerDiff(\"month\", end, start, null, true);\n}\nfunction sameMonth(a, b) {\n    return (getUnitStart(\"month\", a).valueOf() === getUnitStart(\"month\", b).valueOf());\n}\nfunction addUnit(unit) {\n    return add[unit];\n}\nfunction getUnitStart(unit, start, startOnMonday) {\n    let t;\n    switch (unit) {\n        case \"year\":\n            return new Date(start.getFullYear(), 0, 1);\n        case \"quarter\":\n            return new Date(start.getFullYear(), Math.floor(start.getMonth() / 3) * 3, 1);\n        case \"month\":\n            return new Date(start.getFullYear(), start.getMonth(), 1);\n        case \"week\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setDate(start.getDate() - getDay(start, startOnMonday));\n            return t;\n        case \"day\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setHours(0, 0, 0, 0);\n            return t;\n        case \"hour\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setHours(start.getHours(), 0, 0, 0);\n            return t;\n        default:\n            return new Date(start);\n    }\n}\n\nfunction getMinUnit(scales) {\n    const start = new Date();\n    return scales\n        .map(item => ({ item, len: addUnit(item.unit)(start, 1) }))\n        .sort((a, b) => (a.len < b.len ? -1 : 1))[0].item.unit;\n}\n/**\n * Resets scales to new parameters and returns the object that stores related constants and functions\n * @param {Date} start - start date\n * @param {Date} end - end date\n * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\n * @param {number} width - width of smallest cell unit\n * @param {number} height - height of scale cell\n * @param {Array} scales - a set of scales (objects)\n * @param {function} isHoliday - the function that checks if a day is a holiday\n * @param {boolean} startOnMonday - flag that defines whether the week starts on Monday\n * @returns {Object} scales\n */\nfunction resetScales(start, end, precise, width, height, scales, isHoliday, startOnMonday) {\n    // console.log(\"[x] reset scales\");\n    const minUnit = getMinUnit(scales);\n    const diff = getDiff(minUnit);\n    const tempEnd = getUnitStart(minUnit, end, startOnMonday);\n    start = getUnitStart(minUnit, start, startOnMonday);\n    end = tempEnd < end ? addUnit(minUnit)(tempEnd, 1) : tempEnd;\n    const fullWidth = diff(end, start, startOnMonday) * width;\n    const fullHeight = height * scales.length;\n    const rows = scales.map(line => {\n        const cells = [];\n        const add = addUnit(line.unit);\n        const step = line.step || 1;\n        const countInWeeks = minUnit === \"week\" && line.unit !== \"week\";\n        let date = getUnitStart(line.unit, start, startOnMonday);\n        while (date < end) {\n            let next = add(date, step);\n            if (date < start)\n                date = start;\n            if (next > end)\n                next = end;\n            /**\n             * Special handling for counting width of greater units in weeks\n             * this code decides whether a week belongs to the current greater unit based on weekdays of this unit boundaries\n             * if start day is Thursday+, then this greater unit should not count this week as its own\n             * if end day is Thursday+, then this greater unit should count this week as its own\n             */\n            let cdate = date;\n            let cnext = next;\n            if (countInWeeks) {\n                if (getDay(date, startOnMonday) > 3) {\n                    cdate = addUnit(\"week\")(date, 1);\n                }\n                if (getDay(next, startOnMonday) > 3) {\n                    cnext = addUnit(\"week\")(next, 1);\n                }\n            }\n            const cellWidth = (diff(cnext, cdate, startOnMonday) || 1) * width;\n            let css = \"\";\n            if (line.css)\n                css += typeof line.css === \"function\" ? line.css(date) : line.css;\n            cells.push({\n                width: cellWidth,\n                css,\n                date,\n                format: line.format,\n            });\n            date = next;\n        }\n        return { cells, add, height, type: line.unit, step: line.step || 1 };\n    });\n    precise = !!(minUnit === \"day\" ? precise : precise != false);\n    return {\n        rows,\n        width: fullWidth,\n        height: fullHeight,\n        cellWidth: width,\n        cellHeight: height,\n        diff,\n        start,\n        end,\n        minUnit,\n        precise,\n        isHoliday,\n        startOnMonday,\n    };\n}\nfunction grid(width, height, color) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.setAttribute(\"width\", width + \"\");\n    canvas.setAttribute(\"height\", height + \"\");\n    const ctx = canvas.getContext(\"2d\");\n    ctx.strokeStyle = color;\n    ctx.moveTo(0, height);\n    ctx.lineTo(width, height);\n    ctx.lineTo(width, 0);\n    ctx.stroke();\n    return canvas.toDataURL();\n}\n\n/**\n * Prepares dimensional coordinates for a task\n * @param {Object} task - task data object\n * @param {number} i - the index of the task\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {number} taskHeight - the height of a task bar\n * @param {number} y - the top position of a task after which the current task will be placed (timeline mode)\n * @returns {Object} task data object\n */\nfunction updateTask(task, i, scales, taskHeight, y) {\n    if (task.type === \"split\" && task.$data && task.$data.length) {\n        task.$data.forEach(k => setSizes(k, i, scales, taskHeight));\n    }\n    else {\n        setSizes(task, i, scales, taskHeight, y);\n    }\n    return task;\n}\nfunction setSizes(task, i, scales, taskHeight, y) {\n    const { start, end, cellWidth, cellHeight, diff, minUnit, precise } = scales;\n    const startDate = task.start_date < start ? start : task.start_date;\n    const endDate = task.end_date > end ? end : task.end_date;\n    const astart = getUnitStart(minUnit, start, scales.startOnMonday);\n    const ms = task.type == \"milestone\";\n    task.$h = taskHeight;\n    task.$x =\n        Math.round(diff(startDate, astart, scales.startOnMonday, precise) * cellWidth) - (ms ? task.$h / 2 : 0);\n    task.$w = ms\n        ? task.$h\n        : Math.round(diff(endDate, startDate, scales.startOnMonday, precise, true) *\n            cellWidth);\n    task.$y =\n        typeof y === \"undefined\"\n            ? cellHeight * i + (cellHeight - taskHeight) / 2\n            : y;\n}\n/**\n * Updates start, end and duration fields of tasks during initial loading and updating\n * @param {Object} task - task data object\n * @param {Object} scales - (optional) the data for current scales; the return value of resetScales()\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\n */\nfunction updateTaskDuration(task, scales, mode, dir) {\n    if (task.start_date &&\n        task.end_date &&\n        task.start_date.valueOf() >= task.end_date.valueOf()) {\n        task.end_date = null;\n        task.duration = 1;\n        if (mode)\n            mode = \"move\";\n    }\n    if (scales) {\n        excludeHolidays(task, scales, mode, dir);\n    }\n    else {\n        if (task.type == \"milestone\") {\n            getMilestone(task);\n        }\n        else {\n            if (!task.duration) {\n                task.duration = getDuration(task);\n            }\n            if (!task.end_date) {\n                task.end_date = getEnd(task);\n            }\n        }\n    }\n}\n/**\n * Excludes holidays from start, end and duration of tasks (can't start or end on a holiday)\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\n */\nfunction excludeHolidays(task, scales, mode, dir) {\n    if (task.type == \"milestone\") {\n        task.start_date = mode\n            ? toWorkday(task.start_date, false, scales, dir)\n            : toClosestWorkday(task.start_date, scales); //on load\n        return getMilestone(task);\n    }\n    if (!mode) {\n        //on load\n        task.start_date = toClosestWorkday(task.start_date, scales);\n        task.end_date = getEndWorkday(task, scales);\n        task.duration = getDuration(task, scales);\n    }\n    else {\n        if (mode == \"start\" || mode == \"move\") {\n            task.start_date = toWorkday(task.start_date, false, scales, dir);\n            if (!task.duration)\n                task.duration = getDuration(task, scales);\n            if (!task.end_date)\n                task.end_date = getEndWorkday(task, scales);\n        }\n        else {\n            //end, duration\n            if (!task.end_date)\n                task.end_date = getEndWorkday(task, scales);\n            if (!task.duration) {\n                task.end_date = toWorkday(task.end_date, true, scales, dir);\n                task.duration = getDuration(task, scales);\n            }\n        }\n    }\n}\nfunction getMilestone(task) {\n    task.duration = 0;\n    task.end_date = task.start_date;\n}\n/**\n * Returns the end date of a task\n * @param {Object} task - task data object\n */\nfunction getEnd(task) {\n    if (task.duration < 1)\n        return addUnit(\"hour\")(task.start_date, Math.floor(24 * task.duration));\n    else\n        return addUnit(\"day\")(task.start_date, task.duration);\n}\n/**\n * Returns end date excluding holidays from duration\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {Date} end date\n */\nfunction getEndWorkday(task, scales) {\n    if (task.duration < 1)\n        return getEnd(task);\n    let date = getDatePart(task.start_date);\n    for (let w = 0, d = 0; w < task.duration;) {\n        if (!scales.isHoliday(date)) {\n            ++w;\n            d = 0;\n        }\n        else {\n            if (++d === 30)\n                holidayGuard();\n        }\n        date = addUnit(\"day\")(date, 1);\n    }\n    return date;\n}\n/**\n * Calculates the duration of a task\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {number} task duration\n */\nfunction getDuration(task, scales) {\n    const d = getDiff(\"day\")(task.end_date, task.start_date, true);\n    // allow float duration for tasks smaller than day\n    if (d < 1)\n        return parseFloat(d.toFixed(2));\n    if (!scales)\n        return Math.floor(d);\n    let date = task.start_date;\n    let duration = 0;\n    while (date < task.end_date) {\n        if (!scales.isHoliday(date))\n            ++duration;\n        date = addUnit(\"day\")(date, 1);\n    }\n    return duration;\n}\n/**\n * Moves a date from a holiday to the closest working day (priority to the future)\n * @param {Date} date - original date\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {Date} the date of a closest work day\n */\nfunction toClosestWorkday(date, scales) {\n    let left = date;\n    let right = date;\n    let notRight;\n    let d = 0;\n    while (d < 30 &&\n        (notRight = scales.isHoliday(right)) &&\n        scales.isHoliday(left)) {\n        left = addUnit(\"day\")(left, -1);\n        right = addUnit(\"day\")(right, 1);\n        d++;\n    }\n    if (d === 30)\n        holidayGuard();\n    return !notRight ? right : left;\n}\nfunction holidayGuard() {\n    alert(\"No work days found within 30 days, check your isHoliday function!\");\n    throw \"Wrong isHoliday function\";\n}\n/**\n * Moves a date from a holiday to a working day in the given direction\n * @param {Date} date - the current date\n * @param {Boolean} end - indicates if this is the end of a task\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {number} dir - the direction in which nearest workday will be located; -1 is the past, 1 is the future\n * @returns {Date} the date of a working day\n */\nfunction toWorkday(date, end, scales, dir) {\n    let d = 0;\n    while (d < 30 && scales.isHoliday(getCheckDate(date, end))) {\n        date = addUnit(\"day\")(date, dir);\n        d++;\n    }\n    if (d === 30)\n        holidayGuard();\n    return date;\n}\n/**\n * Returns the date for a holiday check\n * @param {Date} date - the date\n * @param {Boolean} end - if true, means it's the end date (end dates are exclusive)\n * @returns {Date} the date that will be used for a check\n */\nfunction getCheckDate(date, end) {\n    return end && !getTimePart(date) ? addUnit(\"day\")(date, -1) : date;\n}\n\nconst delta = 20;\nfunction updateLink(link, startTask, endTask, height) {\n    const dy = Math.round(height / 2);\n    if (!startTask || !endTask) {\n        link.$p = \"\";\n        return link;\n    }\n    let s_start = false;\n    let e_start = false;\n    switch (link.type) {\n        case 0:\n            e_start = true;\n            break;\n        case 1:\n            s_start = true;\n            e_start = true;\n            break;\n        case 3:\n            s_start = true;\n            break;\n    }\n    const sx = s_start ? startTask.$x : startTask.$x + startTask.$w;\n    const sy = startTask.$y;\n    const ex = e_start ? endTask.$x : endTask.$x + endTask.$w;\n    const ey = endTask.$y;\n    if (differentX(startTask, endTask, sx, ex, height) || sy !== ey) {\n        const lineCoords = getLineCoords(sx, sy + dy, ex, ey + dy, s_start, e_start, 38 / 2);\n        const arrowCoords = getArrowCoords(ex, ey + dy, e_start);\n        link.$p = `${lineCoords},${arrowCoords}`;\n    }\n    else {\n        link.$p = \"\";\n    }\n    return link;\n}\nfunction differentX(startTask, endTask, sx, ex, height) {\n    if (startTask.type === \"milestone\" || endTask.type === \"milestone\")\n        return Math.abs(sx - ex) > height / 2;\n    return sx !== ex;\n}\nfunction getLineCoords(sx, sy, ex, ey, s_start, e_start, gapp) {\n    const shift = delta * (s_start ? -1 : 1);\n    const backshift = delta * (e_start ? -1 : 1);\n    const sx1 = sx + shift;\n    const ex1 = ex + backshift;\n    const line = [sx, sy, sx1, sy, 0, 0, 0, 0, ex1, ey, ex, ey];\n    const dx = ex1 - sx1;\n    let dy = ey - sy;\n    const same = e_start === s_start;\n    if (!same && ((ex1 <= sx + delta - 2 && e_start) || (ex1 > sx && !e_start))) {\n        dy -= gapp;\n    }\n    if ((same && e_start && sx1 > ex1) || (same && !e_start && sx1 < ex1)) {\n        line[4] = line[2] + dx;\n        line[5] = line[3];\n        line[6] = line[4];\n        line[7] = line[5] + dy;\n    }\n    else {\n        line[4] = line[2];\n        line[5] = line[3] + dy;\n        line[6] = line[4] + dx;\n        line[7] = line[5];\n    }\n    return line.join(\",\");\n}\nfunction getArrowCoords(x, y, start) {\n    if (start) {\n        return `${x - 5},${y - 3},${x - 5},${y + 3},${x},${y}`;\n    }\n    else {\n        return `${x + 5},${y + 3},${x + 5},${y - 3},${x},${y}`;\n    }\n}\nfunction newLink(box, start, end) {\n    if (start && end) {\n        const width = end.x - start.x;\n        const height = end.y - start.y;\n        const left = (width > 0 ? start.x : end.x) - box.left;\n        const top = (height > 0 ? start.y : end.y) - box.top;\n        const p = `${width > 0 ? 0 : -width},${height > 0 ? 0 : -height},${width > 0 ? width : 0},${height > 0 ? height : 0}`;\n        return { width: Math.abs(width), height: Math.abs(height), left, top, p };\n    }\n    else {\n        return null;\n    }\n}\n\nexport { addUnit, getDiff, getUnitStart, grid, newLink, resetScales, smallerCount, updateLink, updateTask, updateTaskDuration };\n//# sourceMappingURL=wgantt.es6.js.map\n","import {\n\taddUnit,\n\tgetDiff,\n\tgetUnitStart,\n\tgrid,\n\tnewLink,\n\tresetScales,\n\tsmallerCount,\n\tupdateLink,\n\tupdateTask,\n\tupdateTaskDuration,\n} from \"@xbs/webix-gantt-lib\";\n\nexport default class Helpers {\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.defaultResourceUnit = \"hour\";\n\t\tthis.defaultResourceValues = {\n\t\t\thour: 8,\n\t\t};\n\t\tthis.resourceValueRanges = {\n\t\t\thour: [0.5, 24],\n\t\t};\n\t\tthis.resourceValueSteps = {\n\t\t\thour: 0.5,\n\t\t};\n\t\tthis.unitLoadNorm = {\n\t\t\tday: 8,\n\t\t\tweek: 40,\n\t\t\tmonth: 170,\n\t\t\tquarter: 510,\n\t\t\tyear: 2040,\n\t\t};\n\t}\n\n\t/**\n\t * Get name initials\n\t * @param {string} name - resource name\n\t * @returns {string} name initials\n\t */\n\tinitials(name) {\n\t\tlet initials = name.match(/\\b\\w/g) || [];\n\t\tif (initials.length == 1)\n\t\t\treturn name.charAt(0).toUpperCase() + name.charAt(1);\n\t\treturn ((initials.shift() || \"\") + (initials.pop() || \"\")).toUpperCase();\n\t}\n\n\t/**\n\t * Get an additional css class for resource avatar\n\t * @param {string} name - a resource name\n\t * @returns {string} a css class\n\t */\n\tavatarCss(name) {\n\t\treturn (\n\t\t\t\" webix_gantt_person_avatar_\" +\n\t\t\t((name.charCodeAt(1) + (name.length % 10)) % 10)\n\t\t);\n\t}\n\n\t/**\n\t * A template for an assignment avatar\n\t * @param {object} resource - a resource object\n\t * @param {string} cssClass - an addition css class for the avatar\n\t * @param {boolean} withTooltip - specifies whether  an avatar should get tooltip\n\t * @returns {string} html string for assignment avatar\n\t */\n\tresourceAvatar(resource, cssClass, withTooltip) {\n\t\tlet css = \"webix_gantt_person_avatar\";\n\t\tif (typeof cssClass == \"string\") css += \" \" + cssClass;\n\t\tif (resource.avatar)\n\t\t\treturn `<img class=\"${css}\" src=\"${resource.avatar}\" webix_tooltip=\"${\n\t\t\t\twithTooltip ? resource.name : \"\"\n\t\t\t}\"/>`;\n\t\tconst txt = resource.name;\n\t\treturn `<div class='${css} ${\n\t\t\ttxt ? this.avatarCss(txt) : \"\"\n\t\t}' webix_tooltip=\"${withTooltip ? resource.name : \"\"}\">${\n\t\t\ttxt ? this.initials(txt) : \"\"\n\t\t}</div>`;\n\t}\n\n\t/**\n\t * Get the default value for the resource unit\n\t * @param {object} obj - a resource object\n\t * @returns {any} the default resource\n\t */\n\tgetDefaultResourceValue(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.defaultResourceValues[unit];\n\t}\n\n\t/**\n\t * Get a resource unit\n\t * @param {object} obj - a resource object\n\t * @returns {string} a resource unit\n\t */\n\tgetResourceUnit(obj) {\n\t\treturn obj.unit || this.defaultResourceUnit;\n\t}\n\t/**\n\t * Get a resource value range\n\t * @param {object} obj - a resource object\n\t * @returns {array} a resource value range\n\t */\n\tgetResourceValueRange(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.resourceValueRanges[unit] || [1, 100];\n\t}\n\t/**\n\t * Get a resource value step\n\t * @param {object} obj - a resource object\n\t * @returns {array} a resource value step\n\t */\n\tgetResourceValueStep(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.resourceValueSteps[unit] || null;\n\t}\n\t/**\n\t * Check if a date is a holiday for an assigned resource\n\t * @param {date} date - Date object\n\t * @param {object} cal - a calendar object of a resource\n\t * @returns {boolean} true if date is a holiday\n\t */\n\tisResourceHoliday(date, cal) {\n\t\tlet result = false;\n\t\tif (cal.holidays)\n\t\t\tresult = cal.holidays.find(d => d.getTime() == date.getTime());\n\t\tif (cal.weekDays)\n\t\t\tresult = result || cal.weekDays.indexOf(date.getDay()) == -1;\n\t\treturn result;\n\t}\n\n\t/* wrappers for gantt-lib functions */\n\n\taddUnit(unit, date, inc) {\n\t\treturn addUnit(unit)(date, inc);\n\t}\n\n\tgetDifference(unit, next, prev) {\n\t\treturn getDiff(unit)(next, prev, webix.Date.startOnMonday);\n\t}\n\n\tgetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date, webix.Date.startOnMonday);\n\t}\n\n\tupdateTask(task, index) {\n\t\tconst local = this.app.getService(\"local\");\n\t\treturn updateTask(task, index, local.getScales(), local.getTaskHeight());\n\t}\n\n\tsetScales(start, end, precise, width, height, scales) {\n\t\treturn resetScales(\n\t\t\tstart,\n\t\t\tend,\n\t\t\tprecise,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tscales,\n\t\t\tthis.app.config.isHoliday,\n\t\t\twebix.Date.startOnMonday\n\t\t);\n\t}\n\n\tupdateLink(link, start, end) {\n\t\tconst local = this.app.getService(\"local\");\n\t\treturn updateLink(link, start, end, local.getTaskHeight());\n\t}\n\n\tupdateTaskDuration(task, scales, mode, dir) {\n\t\treturn updateTaskDuration(task, scales, mode, dir);\n\t}\n\n\tgetSmallerUnit(unit) {\n\t\treturn smallerCount[unit][0];\n\t}\n\n\tgetSmallerCount(unit) {\n\t\treturn smallerCount[unit][1];\n\t}\n\n\tnewLink(box, start, end) {\n\t\treturn newLink(box, start, end);\n\t}\n\n\tdrawGridInner(width, height, color) {\n\t\treturn grid(width, height, color);\n\t}\n}\n","import { arrayEquals } from \"helpers/common\";\n\nexport default class Grouping {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.local = app.getService(\"local\");\n\t\tthis.helpers = app.getService(\"helpers\");\n\t\tthis.closedResources = null;\n\t}\n\n\t/* Grouping for Tasks View*/\n\n\t/***\n\t * Get tasks tree data (grouped by parent)\n\t * @param {array} data - a data array\n\t * @param {string} id - a branch id\n\t * @returns {array} a data array for webix.TreeCollection\n\t */\n\tgetTreeData(data, id) {\n\t\tconst tree = data.filter(a => a.parent == id);\n\t\ttree.forEach(a => {\n\t\t\tconst temp = this.getTreeData(data, a.id);\n\t\t\tif (temp) a.data = temp;\n\t\t});\n\n\t\treturn tree;\n\t}\n\n\t/* Grouping for Resource Diagram */\n\n\t/**\n\t * Webix TreeCollection\n\t * @typedef {Object} TreeCollection\n\t */\n\n\t/**\n\t * Collects data for resource diagram (hierarchical structure)\n\t * @returns {TreeCollection}\n\t */\n\tgetRDCollection(force) {\n\t\tif (this._rdCollection && !force) return this._rdCollection;\n\n\t\tconst tasks = this.local.tasks();\n\t\tconst assignments = this.local.assignments();\n\t\tconst resources = this.local.resources();\n\t\tif (!this._rdCollection) {\n\t\t\tthis._rdCollection = new webix.TreeCollection({});\n\t\t\twebix.extend(this._rdCollection, webix.Group);\n\n\t\t\tthis.syncRDWithData();\n\t\t} else {\n\t\t\tthis._rdCollection.clearAll();\n\t\t}\n\n\t\twebix.promise\n\t\t\t.all([tasks.waitData, assignments.waitData, resources.waitData])\n\t\t\t.then(() => {\n\t\t\t\tconst data = [];\n\t\t\t\tconst scales = this.local.getScales();\n\t\t\t\tassignments.data.each(obj => {\n\t\t\t\t\tconst res = this.getDiagramItemData(obj, scales);\n\t\t\t\t\tif (res) data.push(res);\n\t\t\t\t});\n\t\t\t\tthis._rdCollection.parse(data);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t});\n\n\t\treturn this._rdCollection;\n\t}\n\n\t/**\n\t * Synchs RD collection with main collections and scale changes\n\t */\n\tsyncRDWithData() {\n\t\tthis.app.on(\"onScalesUpdate\", (v, o) => {\n\t\t\tif (this._rdCollection && this._rdCollection.data.order.length) {\n\t\t\t\tthis.refreshTaskDiagram();\n\n\t\t\t\tif (v.minUnit !== o.minUnit) {\n\t\t\t\t\tthis.updateUnitDurations();\n\t\t\t\t\tthis.groupResourceDiagram();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst tasks = this.local.tasks();\n\t\ttasks.data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (\n\t\t\t\tmode &&\n\t\t\t\tobj &&\n\t\t\t\t(mode == \"update\" ||\n\t\t\t\t\tmode == \"delete\" ||\n\t\t\t\t\tthis.local.assignments().find(a => a.task === obj.id, true))\n\t\t\t) {\n\t\t\t\tthis.updateTaskDiagram(obj, mode);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t}\n\t\t});\n\t\tconst assignments = this.local.assignments();\n\t\tassignments.data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (id) {\n\t\t\t\tthis.refreshResourceDiagram(id, obj, mode);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateUnitDurations() {\n\t\tconst tasks = this.local.tasks();\n\t\tconst assignments = this.local.assignments();\n\t\tconst scales = this.local.getScales();\n\t\tthis._rdCollection.data.each(obj => {\n\t\t\tif (obj.task) {\n\t\t\t\tconst task = tasks.getItem(obj.task);\n\t\t\t\tconst assignment = assignments.getItem(obj.id);\n\t\t\t\tif (task && assignment) {\n\t\t\t\t\tobj.duration = this.calculateUnitDuration(task, scales);\n\t\t\t\t\tobj.value = this.calculateLoad(\n\t\t\t\t\t\t{ ...task, ...assignment },\n\t\t\t\t\t\tscales.minUnit\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param {Object} task\n\t */\n\tcalculateUnitDuration(task, scales) {\n\t\treturn scales.minUnit === \"day\"\n\t\t\t? task.duration\n\t\t\t: scales.diff(\n\t\t\t\t\ttask.end_date,\n\t\t\t\t\ttask.start_date,\n\t\t\t\t\twebix.Date.startOnMonday,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue\n\t\t\t  );\n\t}\n\n\t/**\n\t * Collects data on assignment from all related tables (tasks and resources) for resources diagram\n\t * @param {Object} obj - assignment data object\n\t * @returns {Object} all data about assignment\n\t */\n\tgetDiagramItemData(obj, scales) {\n\t\tconst task = this.local.tasks().getItem(obj.task);\n\n\t\tif (task) {\n\t\t\tif (!this.local._isTaskVisible(task, true)) {\n\t\t\t\tthis.helpers.updateTask(task, 0);\n\t\t\t}\n\n\t\t\tconst resource = this.local.resources().getItem(obj.resource);\n\t\t\tconst res = { ...task, ...resource, ...obj };\n\t\t\tres.duration = this.calculateUnitDuration(task, scales);\n\t\t\tres.value = this.calculateLoad(res, scales.minUnit);\n\n\t\t\t// diagram renders 1 workload markers per min unit\n\t\t\tres.$x = this.truncateX(res.$x, scales);\n\n\t\t\treturn res;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Calculates workload per current min scale unit\n\t * @param {Object} data - data object for resource diagram (at least must have values from tasks and resources)\n\t * @param {string} unit - the min scale unit of the current scale (\"day\", \"week\", etc)\n\t * @returns {Array} load per 1st and last units if they are not fully occupied, and a fully occupied unit load. e.g. [1,0,8]\n\t */\n\tcalculateLoad(data, unit) {\n\t\tconst num = this.getUnitLoad(data);\n\n\t\tif (unit === \"hour\") return [0, 0, num / 24];\n\n\t\tif (unit === \"day\") return [0, 0, num];\n\n\t\tconst load = [];\n\n\t\tlet start = webix.Date.copy(data.start_date);\n\t\tconst startUnitStart = this.helpers.getUnitStart(unit, start);\n\t\tlet end = webix.Date.copy(data.end_date);\n\t\tconst endUnitStart = this.helpers.getUnitStart(unit, end);\n\t\tlet startUnitEnd;\n\n\t\tif (webix.Date.datePart(start, true) > startUnitStart) {\n\t\t\tstartUnitEnd = this.helpers.addUnit(unit, startUnitStart, 1);\n\t\t\tif (end > startUnitEnd) {\n\t\t\t\t// find duration in days for the first not-fully occupied unit\n\t\t\t\tconst days = this.findUnitDuration(start, startUnitEnd, data);\n\t\t\t\tload.push(days);\n\t\t\t\tstart = startUnitEnd;\n\t\t\t} else load.push(0);\n\t\t} else load.push(0);\n\n\t\tif (\n\t\t\t!webix.Date.equal(startUnitStart, endUnitStart) &&\n\t\t\twebix.Date.datePart(end, true) >= endUnitStart\n\t\t) {\n\t\t\t// find duration in days for the last not fully-occupied unit\n\t\t\tconst days = this.findUnitDuration(endUnitStart, end, data);\n\t\t\tload.push(days);\n\t\t\tend = endUnitStart;\n\t\t} else load.push(0);\n\n\t\t// find duration in days for a fully-occupied unit\n\t\tconst plusUnit = this.helpers.addUnit(unit, start, 1);\n\t\tconst days = this.findUnitDuration(\n\t\t\tstart,\n\t\t\tnew Date(Math.min(plusUnit, end)),\n\t\t\tdata\n\t\t);\n\t\tload.push(days);\n\n\t\treturn load.map(l => l * num);\n\t}\n\n\t/**\n\t * Finds unit duration in days ( to calculate work load per init )\n\t * @param start {Date} start date\n\t * @param end {Date} end date\n\t * @param data {object} data object\n\t * @returns {number} days number\n\t */\n\tfindUnitDuration(start, end, data) {\n\t\tlet days = this.helpers.getDifference(\"day\", end, start);\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet i,\n\t\t\t\td = webix.Date.copy(start),\n\t\t\t\tn = days;\n\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\tif (this.checkHoliday(d, data)) days--;\n\t\t\t\twebix.Date.add(d, 1, \"day\");\n\t\t\t}\n\t\t}\n\t\treturn days;\n\t}\n\n\t/**\n\t * Check if date is a holiday\n\t * @param d {Date} date to check\n\t * @param data {object} data object (resource calendar check)\n\t * @returns {boolean} true if date is a holiday\n\t */\n\tcheckHoliday(d, data) {\n\t\tif (this.app.config.resourceCalendars) {\n\t\t\tconst calendarId = this.local.resources().getItem(data.resource)\n\t\t\t\t.calendar_id;\n\t\t\tif (calendarId) {\n\t\t\t\tconst calendar = this.local.calendars().getItem(calendarId);\n\t\t\t\treturn this.helpers.isResourceHoliday(d, calendar);\n\t\t\t}\n\t\t}\n\t\treturn this.app.config.isHoliday(d);\n\t}\n\n\t/**\n\t * Returns resource load per unit\n\t * @param {Object} data - data object from Resource Diagram collection\n\t * @returns {number} load per unit (by default hours, but can be anything)\n\t */\n\tgetUnitLoad(data) {\n\t\treturn data.value;\n\t}\n\n\t/**\n\t * Cuts X coordinate down to unit start if precision setting was set for the scale,\n\t * because diagram renders 1 workload marker per min unit in the middle\n\t * @param {number} x - the X coordinate of a task bar on a date scale\n\t * @param {Object} scales - the data object of current scales\n\t * @returns {number} altered X\n\t */\n\ttruncateX(x, scales) {\n\t\tif (scales.precise !== false) {\n\t\t\treturn Math.floor(x / scales.cellWidth) * scales.cellWidth;\n\t\t}\n\t\treturn x;\n\t}\n\n\t/**\n\t * Refreshes data in diagram collection if a resource was (un)assigned or load per day changed\n\t * @param {(string|number)} id - the ID of an assignment record\n\t * @param {Object} obj - data object of an assignment\n\t * @param {string} mode - operation mode (\"add\", \"update\", \"delete\")\n\t */\n\trefreshResourceDiagram(id, obj, mode) {\n\t\tconst data = this._rdCollection;\n\t\tconst scales = this.local.getScales();\n\t\tswitch (mode) {\n\t\t\tcase \"update\":\n\t\t\t\tif (data.exists(id)) {\n\t\t\t\t\tconst task = this.local.tasks().getItem(obj.task);\n\t\t\t\t\tconst resource = { ...this.local.resources().getItem(obj.resource) };\n\t\t\t\t\tdelete resource.id;\n\t\t\t\t\tconst value = this.calculateLoad({ ...task, ...obj }, scales.minUnit);\n\t\t\t\t\tdata.updateItem(id, { ...obj, ...resource, value });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"add\":\n\t\t\t\tdata.add(this.getDiagramItemData(obj, scales));\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tif (data.exists(id)) data.remove(id);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Removed all related data records in diagram collection if an assigned task was removed\n\t * @param {Object} task - the ID of a task\n\t * @param {string} mode - operation type (add, delete, update)\n\t */\n\tupdateTaskDiagram(task, mode) {\n\t\tconst data = this._rdCollection;\n\t\tconst scales = this.local.getScales();\n\n\t\tif (mode === \"delete\") {\n\t\t\tthis.pruneDiagram();\n\t\t} else if (mode === \"add\") {\n\t\t\tconst rec = this.local.assignments().find(a => a.task === task.id, true);\n\t\t\tdata.add(this.getDiagramItemData(rec, scales));\n\t\t} else if (mode === \"update\") {\n\t\t\tconst assignments = data.find(a => a.task === task.id);\n\t\t\tassignments.forEach(a => {\n\t\t\t\tconst oa = this.local.assignments().getItem(a.id);\n\t\t\t\tdata.updateItem(a.id, {\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tid: a.id,\n\t\t\t\t\tduration: this.calculateUnitDuration(task, scales),\n\t\t\t\t\t$x: this.truncateX(task.$x, scales),\n\t\t\t\t\tvalue: this.calculateLoad({ ...task, ...oa }, scales.minUnit),\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Cleans removed tasks from resource diagram\n\t * (it's not enough to remove 1 removed task because the removed task can have kids,\n\t * and they go together with their parent and there is no event about each of them)\n\t */\n\tpruneDiagram() {\n\t\tconst tasks = this.local.tasks();\n\t\tconst toRemove = [];\n\t\tthis._rdCollection.data.eachLeaf(0, d => {\n\t\t\tif (!tasks.exists(d.task)) toRemove.push(d.id);\n\t\t});\n\t\tif (toRemove.length) this._rdCollection.remove(toRemove);\n\t}\n\n\t/**\n\t * Updates $x coordinates for tasks after scale changes\n\t */\n\trefreshTaskDiagram() {\n\t\tconst scales = this.local.getScales();\n\t\tthis._rdCollection.data.each(a => {\n\t\t\tconst task = this.local.tasks().getItem(a.task);\n\t\t\tif (task) a.$x = this.truncateX(task.$x, scales);\n\t\t});\n\t}\n\n\t/**\n\t * Groups data for resource diagram\n\t */\n\tgroupResourceDiagram() {\n\t\tconst collection = this._rdCollection;\n\t\tcollection.group({\n\t\t\tby: obj => obj.name + \"-\" + obj.category,\n\t\t\tmap: {\n\t\t\t\tresource_id: [\"resource\"],\n\t\t\t\tvalue: [\"name\"],\n\t\t\t\tname: [\"name\"],\n\t\t\t\tcategory: [\"category\"],\n\t\t\t\tavatar: [\"avatar\"],\n\t\t\t\tload: [\"value\", calculateLoad],\n\t\t\t\tduration: [\"duration\", collect], // num of workload markers\n\t\t\t\tunits: [\"value\", collect], // number on a workload marker\n\t\t\t\t$x: [\"$x\", collect], // start of a task\n\t\t\t\tcount: [\"value\", \"count\"],\n\t\t\t\tstart_date: [\"start_date\", collect],\n\t\t\t},\n\t\t});\n\t\tcollection.group(\n\t\t\t{\n\t\t\t\tby: \"category\",\n\t\t\t\tmap: {\n\t\t\t\t\tvalue: [\"category\"],\n\t\t\t\t\tname: [\"category\"],\n\t\t\t\t\tduration: [\"duration\", \"sum\"],\n\t\t\t\t\tload: [\"load\", \"sum\"],\n\t\t\t\t\tcount: [\"count\", \"sum\"],\n\t\t\t\t},\n\t\t\t},\n\t\t\t0\n\t\t);\n\t}\n\n\t/* Grouping for Resource View*/\n\n\t/**\n\t * Resource-task collection (shown when \"display\" state property equals \"resources\")\n\t * @returns {object} TreeCollection|webix.TreeCollection\n\t */\n\tgetResourceTree() {\n\t\tif (this._resourcesTree) return this._resourcesTree;\n\n\t\tthis._resourcesTree = new webix.TreeCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreUpdated\": (id, obj, mode) => {\n\t\t\t\t\tid = mode == \"update\" || mode == \"paint\" ? id : null;\n\t\t\t\t\tthis.refreshResourceTasks(id);\n\t\t\t\t\tthis.local.refreshLinks();\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$sort: {\n\t\t\t\t\tby: \"start_date\",\n\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\tas: \"int\",\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis._resourcesTree.parse(\n\t\t\tthis.resourceTaskLoader().finally(() => {\n\t\t\t\tthis.syncResourceTree();\n\t\t\t})\n\t\t);\n\n\t\treturn this._resourcesTree;\n\t}\n\n\t/**\n\t * Load task data and extend each task item with the \"resources\" property -\n\t * an array of task resources or null\n\t * @returns {Promise} promise that is resolved with a data array\n\t */\n\ttasksWithResources() {\n\t\treturn webix.promise\n\t\t\t.all([this.local.tasks().waitData, this.local.assignments().waitData])\n\t\t\t.then(() => {\n\t\t\t\tlet data = [];\n\t\t\t\tthis.local.tasks().data.each(\n\t\t\t\t\tt => {\n\t\t\t\t\t\tif (t.type == \"task\" || !t.type) {\n\t\t\t\t\t\t\tlet task = Object.assign({}, t);\n\t\t\t\t\t\t\tconst result = this.local\n\t\t\t\t\t\t\t\t.assignments()\n\t\t\t\t\t\t\t\t.data.find(a => a.task == task.id);\n\t\t\t\t\t\t\ttask.resources = result.length\n\t\t\t\t\t\t\t\t? result.map(item => item.resource)\n\t\t\t\t\t\t\t\t: null;\n\t\t\t\t\t\t\tdata.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"\",\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t});\n\t}\n\n\t/**\n\t * tasks and resources loader\n\t * @returns {Promise<[]>} promise that is resolved with a data array\n\t * @private\n\t */\n\tresourceTaskLoader() {\n\t\tconst Ops = this.app.getService(\"operations\");\n\t\treturn webix.promise\n\t\t\t.all([this.tasksWithResources(), this.local.resources().waitData])\n\t\t\t.then(d => {\n\t\t\t\tlet data = this.getResourceTaskData(d[0]);\n\t\t\t\tdata.forEach(r => {\n\t\t\t\t\tOps.setProjectData(r, null, r.data);\n\t\t\t\t});\n\t\t\t\treturn data;\n\t\t\t});\n\t}\n\n\t/**\n\t * Updates Resource TreeCollection, called on tasks() TreeCollection update\n\t */\n\trefreshResourceTree() {\n\t\tif (this._resourcesTree.count()) {\n\t\t\t// get closed branches\n\t\t\tthis.closedResources = [];\n\t\t\tthis._resourcesTree.data.eachChild(\"0\", item => {\n\t\t\t\tif (!item.open) this.closedResources.push(item.resources);\n\t\t\t});\n\t\t} else this.closedResources = null;\n\t\tthis.resourceTaskLoader().then(data => {\n\t\t\t// reload data\n\t\t\tthis._resourcesTree.clearAll();\n\t\t\tthis._resourcesTree.parse(data);\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tsyncResourceTree() {\n\t\tconst tree = this._resourcesTree;\n\t\tthis.local.tasks().data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\") {\n\t\t\t\tconst inTree = tree.exists(id) && tree.getItem(id).type == \"task\";\n\t\t\t\tconst becomesTask = obj.type == \"task\";\n\n\t\t\t\tif (inTree && becomesTask) {\n\t\t\t\t\ttree.updateItem(id, {\n\t\t\t\t\t\ttext: obj.text,\n\t\t\t\t\t\tdetails: obj.details,\n\t\t\t\t\t\tstart_date: obj.start_date,\n\t\t\t\t\t\tend_date: obj.end_date,\n\t\t\t\t\t\tduration: obj.duration,\n\t\t\t\t\t\tprogress: obj.progress,\n\t\t\t\t\t});\n\t\t\t\t\tconst pId = tree.getParentId(id);\n\t\t\t\t\tlet item = tree.getItem(pId);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\titem = this.app.getService(\"operations\").setProjectData(item, tree);\n\t\t\t\t\t\ttree.updateItem(pId, item);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t} else if (inTree ^ becomesTask) {\n\t\t\t\t\tthis.refreshResourceTree();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.refreshResourceTree();\n\t\t\t}\n\t\t});\n\t\tthis.local.assignments().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tthis.refreshResourceTree();\n\t\t});\n\t}\n\n\t/**\n\t * Get data for resource Tree collection ( tasks grouped by resources )\n\t * @param {array} tasks - an tasks array where each item contains\n\t * \"resources\" property (an array of ids or null)\n\t * @returns {array} data array\n\t */\n\tgetResourceTaskData(tasks) {\n\t\tlet data = [];\n\t\tlet unassignedBranch = null;\n\t\tconst Ops = this.app.getService(\"operations\");\n\n\t\ttasks.forEach(t => {\n\t\t\tconst { resources } = t;\n\t\t\tlet item;\n\t\t\tif (!resources) item = unassignedBranch ? unassignedBranch : null;\n\t\t\telse item = data.find(item => arrayEquals(item.resources, resources));\n\t\t\tif (!item) {\n\t\t\t\titem = {\n\t\t\t\t\tid: resources ? webix.uid() : \"unassigned\",\n\t\t\t\t\ttype: \"project\",\n\t\t\t\t\ttext: \"\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\t// $group needed for faster checks\n\t\t\t\t\t$group: true,\n\t\t\t\t\t// restore open/closed state\n\t\t\t\t\topen: this.checkResourceOpen(resources),\n\t\t\t\t};\n\t\t\t\titem.resources = resources;\n\t\t\t\tif (resources)\n\t\t\t\t\titem.text = resources\n\t\t\t\t\t\t.map(id => this.local.resources().getItem(id))\n\t\t\t\t\t\t.sort(Ops.sortResources)\n\t\t\t\t\t\t.map(item => item.name)\n\t\t\t\t\t\t.join(\", \");\n\n\t\t\t\tif (resources) data.push(item);\n\t\t\t\telse {\n\t\t\t\t\titem.id = \"unassigned\";\n\t\t\t\t\tunassignedBranch = item;\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.data.push(webix.copy(t));\n\t\t});\n\t\tif (unassignedBranch) data.push(unassignedBranch);\n\t\treturn data;\n\t}\n\n\t/**\n\t * Set task(s) properties that are needed to define size and position\n\t * @param {string} updID - task id (optional)\n\t * @param {number} i - task index (optional)\n\t */\n\trefreshResourceTasks(updID, i) {\n\t\tconst tree = this._resourcesTree;\n\t\tif (!updID) {\n\t\t\ttree.data.order.forEach((id, i) => {\n\t\t\t\tthis.refreshResourceTasks(id, i);\n\t\t\t});\n\t\t} else {\n\t\t\tconst t = tree.getItem(updID);\n\t\t\ti = !webix.isUndefined(i) ? i : tree.getIndexById(updID);\n\t\t\tthis.helpers.updateTask(t, i);\n\t\t}\n\t}\n\t/**\n\t * Checks whether this resource group needs to be open\n\t * @param {array} resources - array of resources in the group or null for Unassigned\n\t * @returns {boolean} result of the check\n\t */\n\tcheckResourceOpen(resources) {\n\t\tif (!this.closedResources) return true;\n\t\tif (!resources) return this.closedResources.indexOf(null) == -1;\n\t\treturn this.closedResources.find(arr => arrayEquals(arr, resources))\n\t\t\t? false\n\t\t\t: true;\n\t}\n}\n\n/**\n * An aggregation function for data grouping that collects column values (any) into an array\n * @param {string} property - the name of the data field (column)\n * @param {Array} data - the data objects of the items from the data set\n * @returns {Array} the resulting array\n */\nfunction collect(property, data) {\n\tconst ws = [];\n\n\tfor (let i = 0; i < data.length; i++) {\n\t\tws.push(property(data[i]));\n\t}\n\n\treturn ws;\n}\n\n/**\n * @param {string} property - the name of the data field (column)\n * @param {Array} data - the data objects of the items from the data set\n * @returns {number}\n */\nfunction calculateLoad(property, data) {\n\tlet sum = 0;\n\n\tfor (let i = 0; i < data.length; i++) {\n\t\tconst units = property(data[i]);\n\t\tlet duration = parseInt(data[i].duration);\n\t\tconst last = units.length - 1;\n\t\tfor (let j = 0; j < units.length; ++j) {\n\t\t\tconst num = units[j];\n\t\t\tif (num) {\n\t\t\t\tsum += (j === last ? duration : 1) * num;\n\t\t\t\tduration--;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn sum;\n}\n","import { JetApp, plugins, EmptyRouter } from \"webix-jet\";\nimport { initJetWin } from \"@xbs/jet-helpers\";\nimport { createState, link } from \"jet-restate\";\n\nimport views from \"./export_views\";\nimport en from \"locales/en\";\n\n// services\nimport Local from \"./models/Local\";\nimport Backend from \"./models/Backend\";\nimport Operations from \"./models/Operations\";\nimport Helpers from \"./models/Helpers\";\nimport Grouping from \"models/Grouping\";\n\nexport class App extends JetApp {\n\tconstructor(config) {\n\t\t// widget state\n\t\tconst state = createState({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\tselected: null,\n\t\t\tedit: null,\n\t\t\treadonly: config.readonly || false,\n\t\t\tsort: null,\n\t\t\tdisplay:\n\t\t\t\tconfig.resources && config.display == \"resources\"\n\t\t\t\t\t? \"resources\"\n\t\t\t\t\t: \"tasks\",\n\t\t\tcriticalPath: config.criticalPath || false,\n\t\t\tresourcesDiagram: !!(config.resources && config.resourcesDiagram),\n\t\t\ttreeWidth: config.treeWidth || (config.resources ? 400 : 500),\n\t\t\tbaseline: config.baseline || false,\n\t\t});\n\n\t\tconst isHoliday =\n\t\t\tconfig.isHoliday ||\n\t\t\tfunction(date) {\n\t\t\t\tconst d = date.getDay();\n\t\t\t\treturn d === 0 || d === 6;\n\t\t\t};\n\n\t\tconst defaults = {\n\t\t\trouter: EmptyRouter,\n\t\t\tversion: VERSION,\n\t\t\tdebug: DEBUG,\n\t\t\tstart: \"/top\",\n\t\t\tcompactWidth: 650,\n\t\t\tmarkers: [{ css: \"webix_gantt_today_marker\", now: true }],\n\t\t\tparams: { state, forceCompact: config.compact },\n\t\t\tlinks: true,\n\t\t\tisHoliday,\n\t\t};\n\n\t\tsuper({ ...defaults, ...config });\n\n\t\tconst dynamic = obj =>\n\t\t\tthis.config.override ? this.config.override.get(obj) || obj : obj;\n\n\t\t//order matters\n\t\tthis.setService(\"helpers\", new (dynamic(Helpers))(this, config));\n\t\tthis.setService(\"local\", new (dynamic(Local))(this, config));\n\t\tthis.setService(\"backend\", new (dynamic(Backend))(this, config.url));\n\t\tthis.setService(\"operations\", new (dynamic(Operations))(this));\n\t\tthis.setService(\"grouping\", new (dynamic(Grouping))(this));\n\t\tinitJetWin(this);\n\n\t\tthis.use(\n\t\t\tplugins.Locale,\n\t\t\tthis.config.locale || {\n\t\t\t\tlang: \"en\",\n\t\t\t\twebix: {\n\t\t\t\t\ten: \"en-US\",\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\trequire(type, name) {\n\t\tif (type === \"jet-views\") return views[name];\n\t\telse if (type === \"jet-locales\") return locales[name];\n\n\t\treturn null;\n\t}\n\n\t// for external users\n\tgetState() {\n\t\treturn this.config.params.state;\n\t}\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"gantt\",\n\t\tapp: App,\n\t\tgetState() {\n\t\t\treturn this.$app.getState();\n\t\t},\n\t\tgetService(name) {\n\t\t\treturn this.$app.getService(name);\n\t\t},\n\t\t$init() {\n\t\t\tconst state = this.$app.getState();\n\t\t\tfor (let key in state) {\n\t\t\t\tlink(state, this.config, key);\n\t\t\t}\n\n\t\t\tthis.$app.attachEvent(\"bars:beforedrag\", (item, ctx) =>\n\t\t\t\tthis.callEvent(\"onBeforeDrag\", [item, ctx])\n\t\t\t);\n\t\t\tthis.$app.attachEvent(\"bars:beforedrop\", (item, ctx) =>\n\t\t\t\tthis.callEvent(\"onBeforeDrop\", [item, ctx])\n\t\t\t);\n\t\t},\n\t\t$exportView: function(options) {\n\t\t\tif (\n\t\t\t\toptions.export_mode === \"png\" ||\n\t\t\t\t(options.export_mode === \"pdf\" && options.display === \"image\")\n\t\t\t)\n\t\t\t\treturn this.$app.getRoot();\n\t\t\treturn this.$app.getService(\"local\").tasks();\n\t\t},\n\t\tclearAll() {\n\t\t\tthis.$app.getService(\"local\").clearAll();\n\t\t},\n\t\treload() {\n\t\t\tthis.$app.getService(\"local\").reload();\n\t\t},\n\t},\n\twebix.ui.jetapp\n);\n\n// re-export for customization\nconst services = { Local, Backend, Operations, Helpers, Grouping };\nconst locales = { en };\nexport { views, locales, services };\n","export default {\n\tEdit: \"Edit\",\n\tDone: \"Done\",\n\t\"Delete task\": \"Delete task\",\n\t\"Delete link\": \"Delete link\",\n\t\"The task will be deleted permanently, are you sure?\":\n\t\t\"The task will be deleted permanently, are you sure?\",\n\t\"The link will be deleted permanently, are you sure?\":\n\t\t\"The link will be deleted permanently, are you sure?\",\n\tPredecessors: \"Predecessors\",\n\tSuccessors: \"Successors\",\n\n\tTitle: \"Title\",\n\t\"Start date\": \"Start date\",\n\t\"End date\": \"End date\",\n\tDuration: \"Duration\",\n\tProgress: \"Progress\",\n\tNotes: \"Notes\",\n\tType: \"Type\",\n\tProject: \"Project\",\n\tMilestone: \"Milestone\",\n\t\"Add task\": \"Add task\",\n\t\"Add project\": \"Add project\",\n\t\"(no title)\": \"(no title)\",\n\t\"Save changes?\": \"Save changes?\",\n\n\t\"Related tasks\": \"Related tasks\",\n\tTask: \"Task\",\n\tLink: \"Link\",\n\t\"End to start\": \"End to start\",\n\t\"Start to start\": \"Start to start\",\n\t\"End to end\": \"End to end\",\n\t\"Start to end\": \"Start to end\",\n\n\tLasts: \"Lasts\",\n\tday: \"day\",\n\tdays: \"days\",\n\n\t\"Add assignment\": \"Add assignment\",\n\tAssignment: \"Assignment\",\n\tAssignments: \"Assignments\",\n\tAssigned: \"Assigned\",\n\t\"Delete assignment\": \"Delete assignment\",\n\t\"Are you sure to delete this assignment?\":\n\t\t\"Are you sure to delete this assignment?\",\n\t\"No resources to add\": \"No resources to add\",\n\tUnassigned: \"Unassigned\",\n\n\thour: \"h\",\n\t\"Hours per\": \"Hours per\",\n\t\"Tasks per\": \"Tasks per\",\n\tName: \"Name\",\n\tHours: \"Hours\",\n\tTasks: \"Tasks\",\n\tmonth: \"month\",\n\tweek: \"week\",\n\tquarter: \"quarter\",\n\tyear: \"year\",\n\n\t\"Split task\": \"Split task\",\n\t\"Planned dates\": \"Planned dates\",\n\t\"Planned dates will be removed, are you sure?\":\n\t\t\"Planned dates will be removed, are you sure?\",\n\t\"Add dates\": \"Add dates\",\n\t\"Remove dates\": \"Remove dates\",\n};\n","webix.protoUI({\n\tname:\"kanbanheader\",\n\t$kanban:true,\n\t$skin:function(){\n\t\tthis.defaults.height = webix.skin.$active.barHeight;\n\t\tthis._template_types.sub.height = webix.skin.$active.barHeight - 12;\n\t},\n\t$init:function(config){\n\t\tlet subtype = this._template_types[config.type];\n\t\tif (subtype)\n\t\t\twebix.extend(config, subtype);\n\t},\n\tdefaults:{\n\t\tcss:\"webix_kanban_header\",\n\t\tborderless:true,\n\t\ttemplate:function(){\n\t\t\tlet icon = this.icon||(this.link?\"webix_kanban_icon kbi-plus-circle\":\"\");\n\t\t\treturn (icon ? \"<span class='webix_icon \"+(this.link?\"webix_kanban_add_icon \":\"\")+icon+\"'></span>\" : \"\") +\n\t\t\t\t\"<span class='webix_strong' style='line-height:\"+this.height+\"px'>\"+(this.label||\"\")+\"</span>\";\n\t\t},\n\t},\n\t_template_types:{\n\t\t\"sub\":{\n\t\t\tcss:\"webix_kanban_sub_header\"\n\t\t}\n\t},\n\ton_click:{\n\t\t\"webix_kanban_add_icon\":function(){\n\t\t\tlet obj = { text:\"\" };\n\t\t\tlet kanban = this.getKanban();\n\t\t\tlet list = kanban.queryView({id:this.config.link});\n\n\t\t\tif (list && this.callEvent(\"onBeforeCardAdd\",[obj, list])){\n\t\t\t\tkanban.setListStatus(obj, list);\n\t\t\t\tkanban.add(obj);\n\t\t\t}\n\t\t}\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n}, webix.MouseEvents, webix.ui.template);","const images = { jpg:true, jpeg:true, png:true, gif:true };\n\nconst icons = { ppt:\"-powerpoint\", pptx:\"-powerpoint\", pptm:\"-powerpoint\", pps:\"-powerpoint\", ppsx:\"-powerpoint\", ppsm:\"-powerpoint\",\n\tdoc:\"-word\", docx:\"-word\", docm:\"-word\", xls:\"-excel\", xlsx:\"-excel\", xlsm:\"-excel\", xlsb:\"-excel\", pdf:\"-pdf\",\n\twav:\"-audio\", aif:\"-audio\", mp3:\"-audio\", mid:\"-audio\", mpg:\"-video\", mov:\"-video\", wmv:\"-video\", avi:\"-video\", mp4:\"-video\",\n\tzip:\"-archive\", jar:\"-archive\", rar:\"-archive\", gz:\"-archive\", jpg:\"-image\", jpeg:\"-image\", png:\"-image\", gif:\"-image\"\n};\n\nexport function isImage(key){\n\treturn images[key.toString().toLowerCase()];\n}\n\nexport function getIconName(key){\n\treturn icons[key.toString().toLowerCase()] || \"\";\n}","import {isImage} from \"./helpers/image\";\n\nexport var type = {\n\theight:\"auto\",\n\ticons:[\n\t\t{ id:\"attachments\", icon:\"webix_kanban_icon kbi-file\", show:function(obj) { return obj.attachments? obj.attachments.length: false; }, template:\"#attachments.length#\"},\n\t\t{ id:\"comments\", icon:\"webix_kanban_icon kbi-comment\" , show:function(obj,kanban) { return !!kanban.config.comments; },\n\t\t\ttemplate:function(obj) { return obj.comments?(obj.comments.length||\"\"):\"\"; }\n\t\t},\n\t\t{ id:\"editor\", icon:\"webix_kanban_icon kbi-pencil\", show:function(obj,kanban) { return (kanban.config.editor && !kanban.config.cardActions);} },\n\t\t{ id:\"menu\", icon:\"webix_kanban_icon kbi-cogs\", show:function(obj,kanban) { return !!kanban.config.cardActions;} }\n\t],\n\ttemplateTags: function(obj,common,kanban){\n\t\tlet res = [];\n\t\tif(obj.tags){\n\t\t\tlet tags = kanban._tags;\n\t\t\tfor (let i = 0; i < obj.tags.length; i++){\n\t\t\t\tlet tag = obj.tags[i];\n\t\t\t\tif (tags.exists(tag))\n\t\t\t\t\ttag = tags.getItem(tag).value;\n\t\t\t\tres.push(\"<span class='webix_kanban_tag'>\"+tag+\"</span>\");\n\t\t\t}\n\t\t}\n\t\treturn \"<div  class='webix_kanban_tags'>\" +(res.length?res.join(\"\"):\"&nbsp;\")+\"</div>\";\n\t},\n\ttemplateIcons: function(obj,common,kanban){\n\t\tvar icons = [];\n\t\tvar icon = null;\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < common.icons.length; i++){\n\t\t\ticon = common.icons[i];\n\t\t\tif(!icon.show || icon.show(obj,kanban)){\n\t\t\t\thtml = \"<span webix_icon_id='\"+(icon.id||icon.icon||icon)+\"' class='webix_kanban_footer_icon' title='\"+(icon.tooltip||\"\")+\"'>\";\n\t\t\t\thtml += \"<span class='\"+(icon.icon||icon)+\" webix_icon'></span>\";\n\n\t\t\t\tif(icon.template){\n\t\t\t\t\thtml += \"<span class='webix_kanban_icon_text'>\"+webix.template(icon.template)(obj)+\"</span>\";\n\t\t\t\t}\n\t\t\t\thtml += \"</span>\";\n\t\t\t\ticons.push(html);\n\t\t\t}\n\t\t}\n\t\treturn \"<div  class='webix_kanban_footer_icons'>\" + icons.join(\" \") + \"</div>\";\n\t},\n\ttemplateAvatar: function(obj,common,kanban){\n\t\tlet users = kanban._users;\n\t\tlet user = (obj.user_id && users.exists(obj.user_id)) ? users.getItem(obj.user_id) : {};\n\t\tif (user.image)\n\t\t\treturn \"<img class='webix_kanban_avatar' src='\"+user.image+\"' title='\"+(user.value||\"\")+\"'>\";\n\t\treturn \"<span class='webix_icon webix_kanban_icon kbi-account' title='\"+(user.value||\"\")+\"'></span>\";\n\t},\n\ttemplateBody: function(obj){\n\t\treturn obj.text;\n\t},\n\ttemplateAttachments: function(obj){\n\t\tif(obj.attachments){\n\t\t\tfor (let i in obj.attachments){\n\t\t\t\tlet v = obj.attachments[i];\n\t\t\t\tlet type = v.link.split(\".\").pop();\n\t\t\t\tif (isImage(type))\n\t\t\t\t\treturn \"<img class='webix_kanban_attachment' src='\"+v.link+\"'/>\";\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t},\n\ttemplateFooter: function(obj,common,kanban){\n\t\tvar tags = common.templateTags(obj,common,kanban);\n\t\treturn (tags?tags:\"&nbsp;\") + common.templateIcons(obj,common,kanban);\n\t},\n\ttemplateStart:webix.template(\"<div webix_l_id='#id#' class='{common.classname()} webix_kanban_list_item' style='width:{common.width}px; height:{common.height}px;'>\"),\n\ttemplate:function(obj, common){\n\t\tlet kanban = webix.$$(common.master);\n\n\t\tvar color = kanban._colors.exists(obj.color) ? kanban._colors.getItem(obj.color).color : obj.color;\n\t\tvar avatar = \"<div class='webix_kanban_user_avatar' webix_icon_id='$avatar'>\"+common.templateAvatar(obj,common,kanban)+\"</div>\";\n\t\tvar body = \"<div class='webix_kanban_body'>\"+common.templateBody(obj,common,kanban)+avatar+\"</div>\";\n\t\tvar attachments = kanban.config.attachments ? common.templateAttachments(obj,common,kanban) : \"\";\n\t\tvar footer = \"<div class='webix_kanban_footer'>\"+common.templateFooter(obj,common,kanban)+ \"</div>\";\n\t\treturn \"<div class='webix_kanban_list_content'\"+(color ? \" style='border-left-color:\"+color+\"'\" : \"\")+\">\"+attachments+body+footer+\"</div>\";\n\t}\n};\n\nwebix.KanbanView = {\n\t$kanban:true,\n\ton_context:{},\n\t$skin:function(){\n\t\t// prevent default list's item skin height\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n\t_kanban_event(s, t, i){\n\t\tthis.attachEvent(s,function(...rest){\n\t\t\trest[i] = this;\n\t\t\treturn  this.getKanban().callEvent(t, rest);\n\t\t});\n\t},\n\t_fixOrder(){\n\t\tthis.data.each((a,i) => a.$index = i+1);\n\t},\n\tmove(sid,tindex,tobj, details){\n\t\ttobj = tobj || this;\n\t\tdetails = details || {};\n\t\t// normally only one item is dragged\n\t\t// still, it possible to enable multi-selection through API\n\t\tif (webix.isArray(sid)){\n\t\t\treturn webix.DataMove.move.call(this, sid,tindex,tobj, details);\n\t\t}\n\n\t\tconst statusChange = (tobj !== this);\n\t\tconst kanban = this.getKanban();\n\t\tconst item = kanban.getItem(sid);\n\t\tconst dp = webix.dp.$$(kanban.config.id);\n\n\t\tif (statusChange){\n\t\t\tif (!kanban.callEvent(\"onBeforeStatusChange\", [sid,tobj.config.status,tobj])) return;\n\n\t\t\tkanban.setListStatus(item, tobj);\n\n\t\t\tif (dp){\n\t\t\t\tdp.ignore(() => kanban.updateItem(sid));\n\t\t\t} else kanban.updateItem(sid);\n\t\t}\n\n\t\twebix.DataMove.move.call(tobj, sid, tindex);\n\n\t\tthis._fixOrder();\n\t\tif (this !== tobj) tobj._fixOrder();\n\n\t\t// trigger data saving\n\t\tif (dp){\n\t\t\tconst update = webix.copy(item);\n\t\t\tupdate.webix_move_index = tindex;\n\t\t\tupdate.webix_move_id = tobj.data.order[tindex+1];\n\t\t\t// we need to identify the target list on server side\n\t\t\t// when we have a complex status ( object or function )\n\t\t\t// use separate property\n\t\t\tupdate.webix_move_parent = tobj.config.serverStatus || tobj.config.status;\n\t\t\tdp.save(sid, \"update\", update);\n\t\t}\n\n\t\tif (statusChange)\n\t\t\tkanban.callEvent(\"onAfterStatusChange\", [sid,tobj.config.status,tobj]);\n\n\t\treturn sid;\n\t},\n\t_setHandlers(){\n\t\tthis.attachEvent(\"onAfterSelect\", function(){\n\t\t\tthis.eachOtherList(function(list){\n\t\t\t\tlist.unselect();\n\t\t\t});\n\t\t});\n\n\t\tthis._kanban_event(\"onBeforeSelect\", \"onListBeforeSelect\", 2);\n\t\tthis._kanban_event(\"onAfterSelect\", \"onListAfterSelect\", 1);\n\t\tthis._kanban_event(\"onBeforeContextMenu\", \"onListBeforeContextMenu\", 3);\n\t\tthis._kanban_event(\"onAfterContextMenu\", \"onListAfterContextMenu\", 3);\n\t\tthis._kanban_event(\"onItemClick\", \"onListItemClick\", 3);\n\t\tthis._kanban_event(\"onItemDblClick\", \"onListItemDblClick\", 3);\n\t\tthis._kanban_event(\"onBeforeDrag\", \"onListBeforeDrag\", 2);\n\t\tthis._kanban_event(\"onBeforeDrop\", \"onListBeforeDrop\", 2);\n\t\tthis._kanban_event(\"onAfterDrop\",\"onListAfterDrop\", 2);\n\t\tthis._kanban_event(\"onBeforeDragIn\", \"onListBeforeDragIn\", 2);\n\t\tthis._kanban_event(\"onDragOut\", \"onListDragOut\", 2);\n\n\t\tthis.on_click.webix_kanban_user_avatar = this._handle_icons;\n\t\tthis.on_click.webix_kanban_footer_icon = this._handle_icons;\n\t},\n\t_handle_icons(e,id,node){\n\t\tvar icon = node.getAttribute(\"webix_icon_id\");\n\t\tvar all = this.type.icons;\n\n\t\t//per-icon click handlers\n\t\tif (all){\n\t\t\tfor (var i=0; i<all.length; i++){\n\t\t\t\tif (typeof all[i] === \"object\" && (all[i].id || all[i].icon) === icon){\n\t\t\t\t\tif (all[i].click){\n\t\t\t\t\t\tall[i].click.call(this,id,e,node,this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (icon === \"$avatar\")\n\t\t\tthis.getKanban().callEvent(\"onAvatarClick\", [id, e, node, this]);\n\t\telse\n\t\t\tthis.getKanban().callEvent(\"onListIconClick\", [icon, id, e, node, this]);\n\t},\n\t$dragCreate: function(a,e){\n\t\tconst text = webix.DragControl.$drag(a,e);\n\t\tif (!text) return false;\n\n\t\t// hide context menus\n\t\twebix.callEvent(\"onClick\", []);\n\n\t\tconst drag_container = document.createElement(\"DIV\");\n\t\tdrag_container.innerHTML = text;\n\t\tdrag_container.className = \"webix_drag_zone webix_kanban_drag_zone\";\n\t\tdocument.body.appendChild(drag_container);\n\t\treturn drag_container;\n\t},\n\t$dropHTML: function(){\n\t\treturn \"<div class='webix_kanban_drop_inner'></div>\";\n\t},\n\teachOtherList:function(code){\n\t\tvar self = this.config.id;\n\t\tvar master = this.getKanban();\n\n\t\tmaster.eachList(function(view){\n\t\t\tif (view.config.id != self)\n\t\t\t\tcode.call(webix.$$(self), view);\n\t\t});\n\t},\n\tdefaults:{\n\t\tdrag:\"move\",\n\t\tselect:true\n\t}\n};","import {type} from \"./common\";\n\nwebix.protoUI({\n\tname:\"kanbanlist\",\n\t$init(){\n\t\tthis.$view.className += \" webix_kanban_list\";\n\t\tthis.$ready.push(webix.bind(this._setHandlers,this));\n\t},\n\tdefaults:{\n\t\tscroll:\"auto\",\n\t},\n\ttype: type\n}, webix.ui.list, webix.KanbanView);","import {type} from \"./common\";\n\nvar dtype = webix.copy(type);\ndtype.width = 200;\n\nwebix.protoUI({\n\tname:\"kanbandataview\",\n\t$init(){\n\t\tthis.$view.className += \" webix_kanban_list\";\n\t\tthis.$ready.push(webix.bind(this._setHandlers,this));\n\t},\n\tdefaults:{\n\t\tprerender:true,\n\t},\n\ttype:dtype\n}, webix.ui.dataview, webix.KanbanView);","import \"./header\";\nimport \"./list\";\nimport \"./dataview\";\nimport \"./editor\";\nimport \"./userlist\";\nimport \"./menu\";\nimport \"./comments\";\n\nimport \"./locale\";\n\nfunction defaultSetter(a, sub){\n\tvar status = sub.config.status;\n\n\tif (typeof status === \"object\"){\n\t\tfor (var key in status)\n\t\t\ta[key] = status[key];\n\t} else if (typeof status === \"function\"){\n\t\tstatus.call(sub, a, true);\n\t} else {\n\t\ta.status = status;\n\t}\n}\nfunction defaultFilter(sub){\n\tvar status = sub.config.status;\n\n\tif (typeof status === \"object\")\n\t\treturn function(a){\n\t\t\tfor (var key in status){\n\t\t\t\tif (a[key] != status[key])\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\tif (typeof status === \"function\")\n\t\treturn function(a){ return status.call(sub, a); };\n\n\treturn function(a){ return a.status === status; };\n}\n\nwebix.protoUI({\n\tname:\"kanban\",\n\tdefaults:{\n\t\tdelimiter:\",\"\n\t},\n\t$skin:function(){\n\t\tthis.defaults.type = \"space\";\n\t},\n\t$init(config){\n\t\tthis.$view.className += \" webix_kanban\";\n\n\t\tthis.data.provideApi(this, true);\n\t\tthis.data.scheme({\n\t\t\t$change:(obj) =>{\n\t\t\t\tif (typeof obj.tags === \"string\")\n\t\t\t\t\tobj.tags = this._strToArr(obj.tags);\n\t\t\t}\n\t\t});\n\t\tthis._destroy_with_me = [];\n\n\t\tthis._statuses = new webix.DataCollection();\n\t\tthis._destroy_with_me.push(this._statuses);\n\n\t\tthis._tags = this._data_unification(config.tags);\n\t\tthis._users = this._data_unification(config.users);\n\t\tthis._colors = this._data_unification(config.colors);\n\t\tthis.$ready.push(function(){\n\t\t\tthis.reconstruct();\n\t\t\tthis._initEditor();\n\t\t\tthis._initUserList();\n\t\t\tthis._initMenu();\n\t\t\tthis._initComments();\n\t\t\tthis.data.attachEvent(\"onStoreUpdated\",\n\t\t\t\t(id, data, mode) => this._applyOrder(id, data, mode));\n\t\t\tthis.data.attachEvent(\"onIdChange\",\n\t\t\t\t(oldid, newid) => {\n\t\t\t\t\tthis.getOwnerList(oldid).data.changeId(oldid, newid);\n\t\t\t\t});\n\t\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\t\tfor (let i = 0; i < this._destroy_with_me.length; i++)\n\t\t\t\t\tthis._destroy_with_me[i].destructor();\n\t\t\t});\n\t\t});\n\n\t\t//override default api of datastore\n\t\tthis.serialize = this._serialize;\n\t},\n\t_strToArr(value){\n\t\tif (value){\n\t\t\treturn value.split(this.config.delimiter);\n\t\t}\n\t\treturn [];\n\t},\n\tgetTags(){\n\t\treturn this._tags;\n\t},\n\tgetUsers(){\n\t\treturn this._users;\n\t},\n\tgetColors(){\n\t\treturn this._colors;\n\t},\n\tgetStatuses(){\n\t\treturn this._statuses.serialize();\n\t},\n\tcardActions_setter(value){\n\t\tif (value === true) value = [\"edit\", \"copy\", \"remove\"];\n\t\tif (webix.isArray(value)){\n\t\t\treturn value.map((v) => {\n\t\t\t\treturn { id:v, value:webix.i18n.kanban.menu[v]||v };\n\t\t\t});\n\t\t}\n\t},\n\tshowEditor(obj){\n\t\tlet editor = this.getEditor();\n\t\tif (this.callEvent(\"onBeforeEditorShow\", [editor, obj]) && editor){\n\t\t\teditor.setValues(obj);\n\t\t\teditor.show();\n\t\t\tthis.callEvent(\"onAfterEditorShow\", [editor, obj]);\n\t\t}\n\t},\n\tcopy(id){\n\t\tif (this.callEvent(\"onBeforeCopy\", [id])){\n\t\t\tlet item = webix.copy(this.getItem(id));\n\t\t\tdelete item.id;\n\t\t\titem.text = webix.i18n.kanban.copy + \" \" + (item.text || \"\");\n\t\t\tlet sid = this.add(item);\n\t\t\tlet list = this.getOwnerList(sid);\n\t\t\tlist.move(sid, list.getIndexById(id)+1, list);\n\n\t\t\tthis.callEvent(\"onAfterCopy\", [id]);\n\t\t}\n\t},\n\t_removeCard(id){\n\t\tvar promise = webix.promise.defer();\n\n\t\tif (webix.i18n.kanban.confirm){\n\t\t\twebix.confirm({\n\t\t\t\ttext:webix.i18n.kanban.confirm,\n\t\t\t\tcallback:(result) => {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tthis.remove(id);\n\t\t\t\t\t\tpromise.resolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.remove(id);\n\t\t\tpromise.resolve();\n\t\t}\n\n\t\treturn promise;\n\t},\n\t_data_unification(value){\n\t\tif (value && value.getItem)\n\t\t\treturn value;\n\t\telse {\n\t\t\tlet data = new webix.DataCollection();\n\t\t\tthis._destroy_with_me.push(data);\n\t\t\tif(value && typeof value === \"string\")\n\t\t\t\tdata.load(value);\n\t\t\telse\n\t\t\t\tdata.parse(value||[]);\n\t\t\treturn data;\n\t\t}\n\t},\n\tgetEditor(){\n\t\treturn webix.$$(this._editor);\n\t},\n\tgetUserList(){\n\t\treturn webix.$$(this._userList);\n\t},\n\tgetMenu(){\n\t\treturn webix.$$(this._menu);\n\t},\n\tgetComments(){\n\t\treturn webix.$$(this._comments);\n\t},\n\t_initEditor(){\n\t\tif (this.config.editor){\n\t\t\tlet editor = webix.ui( {view:\"kanbaneditor\", master:this.config.id} );\n\n\t\t\tthis._editor = editor.config.id;\n\t\t\tthis._destroy_with_me.push(editor);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id) => {\n\t\t\t\tif (icon === \"editor\") this.showEditor(webix.copy( this.getItem(id) ));\n\t\t\t});\n\t\t\tthis.attachEvent(\"onListItemDblClick\", (id) => this.showEditor(webix.copy( this.getItem(id) )));\n\t\t}\n\t},\n\t_initUserList(){\n\t\tif (this.config.userList){\n\t\t\tlet userlist = typeof this.config.userList === \"object\"?this.config.userList:{};\n\t\t\twebix.extend(userlist, {view:\"kanbanuserlist\", masterId:this.config.id, data:this._users}, true);\n\t\t\tuserlist = webix.ui(userlist);\n\n\t\t\tthis._userList = userlist.config.id;\n\t\t\tthis._destroy_with_me.push(userlist);\n\t\t\t\n\t\t\tthis.attachEvent(\"onAvatarClick\", (id, e, node) => {\n\t\t\t\tlet userList = this.getUserList();\n\t\t\t\tuserList.setContext({id:id, user_id:this.getItem(id).user_id});\n\t\t\t\tuserList.show(node);\n\t\t\t});\n\t\t}\n\t},\n\t_initMenu(){\n\t\tif (this.config.cardActions){\n\t\t\tlet menu = webix.ui( {view:\"kanbanmenu\", data:this.config.cardActions, masterId:this.config.id} );\n\n\t\t\tthis._menu = menu.config.id;\n\t\t\tthis._destroy_with_me.push(menu);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id, e, node) => {\n\t\t\t\tif (icon === \"menu\"){\n\t\t\t\t\tlet menu = this.getMenu();\n\t\t\t\t\tmenu.setContext( {id:id} );\n\t\t\t\t\tmenu.show(node);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t_initComments(){\n\t\tif (this.config.comments){\n\t\t\tlet body = typeof this.config.comments === \"object\"?this.config.comments:{};\n\t\t\tbody = webix.extend({width:400, height:400}, body, true);\n\t\t\twebix.extend(body, { view:\"comments\", users:this._users }, true);\n\t\t\tlet comments = webix.ui( {view:\"kanbanchat\", body:body, masterId:this.config.id} );\n\n\t\t\tthis._comments = comments.config.id;\n\t\t\tthis._destroy_with_me.push(comments);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id, e, node) => {\n\t\t\t\tif (icon === \"comments\" && this.callEvent(\"onBeforeCommentsShow\", [id, e, node])){\n\t\t\t\t\tlet chat = this.getComments();\n\t\t\t\t\tlet pos = webix.html.offset(node);\n\t\t\t\t\tpos.y += pos.height;\n\t\t\t\t\t\n\t\t\t\t\tchat.hide();\n\t\t\t\t\tlet comments = chat.getBody();\n\t\t\t\t\tlet data = this.getItem(id).comments || [];\n\n\t\t\t\t\tcomments.parse( webix.copy(data) );\n\t\t\t\t\tchat.setContext( {id:id} );\n\t\t\t\t\tchat.show(pos);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t_serialize(){\n\t\tvar d = [];\n\t\tthis.eachList(function(l){ d = d.concat(l.serialize()); });\n\t\treturn d;\n\t},\n\t_applyOrder(id, data, mode){\n\t\tif (!id) return this._syncData();\n\n\t\tswitch(mode){\n\t\t\tcase \"add\":\n\t\t\t\tif (this._assignList(data) >= 0){\n\t\t\t\t\tthis.getOwnerList(id).add(data);\n\t\t\t\t\tdata.$index = this._sublists[data.$list].count();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\": {\n\t\t\t\tconst subList = this._sublists[data.$list];\n\t\t\t\tif (subList && subList.exists(id))\n\t\t\t\t\tsubList.remove(id);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"paint\":\n\t\t\tcase \"update\": {\n\t\t\t\tif (this.getIndexById(id) === -1) break;\n\n\t\t\t\tconst prevList = data.$list;\n\t\t\t\tconst list = this._assignList(data);\n\n\t\t\t\tif (prevList === list){\n\t\t\t\t\tif (list >= 0)\n\t\t\t\t\t\tthis.getOwnerList(id).updateItem(id, data);\n\t\t\t\t} else {\n\t\t\t\t\tif (this._sublists[prevList])\n\t\t\t\t\t\tthis._sublists[prevList].remove(id);\n\t\t\t\t\tif (list >= 0)\n\t\t\t\t\t\tthis.getOwnerList(id).add(data);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tsetListStatus(obj, list){\n\t\tfor (var i=0; i<this._sublists.length; i++){\n\t\t\tif (this._sublists[i] === list){\n\t\t\t\tdefaultSetter(obj, list);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\treconstruct(){\n\t\tthis._prepareLists();\n\t\tthis._syncData();\n\t},\n\t_prepareLists(){\n\t\tthis._sublists = [];\n\t\tthis._subfilters = [];\n\t\tlet statuses = [];\n\t\tlet views = this.queryView(a => a.$kanban, \"all\");\n\n\t\tfor (let i = 0; i < views.length; i++) {\n\t\t\tlet sub = views[i];\n\t\t\tif ( sub.config.view !== \"kanbanheader\")\n\t\t\t\tthis._sublists.push(sub);\n\t\t\telse sub.config.master = this.config.id;\n\t\t}\n\n\t\tfor (let i = 0; i < this._sublists.length; i++) {\n\t\t\tlet sub = this._sublists[i];\n\t\t\tthis._subfilters[i] = defaultFilter(sub);\n\n\t\t\tif (this.config.icons){\n\t\t\t\tsub.type.icons = sub.type.icons || this.config.icons;\n\t\t\t}\n\n\t\t\tlet value = sub.config.name || (typeof sub.config.status === \"string\" && sub.config.status ?\n\t\t\t\tsub.config.status[0].toUpperCase() + sub.config.status.slice(1) : sub.config.id);\n\t\t\tstatuses.push( {id:i.toString(), value:value} );\n\n\t\t\tsub.config.master = this.config.id;\n\t\t\tsub.type.master = this.config.id;\n\t\t}\n\n\t\tthis._statuses.clearAll();\n\t\tthis._statuses.parse(statuses);\n\t},\n\t_syncData(){\n\t\tconst sets = [];\n\t\tfor (let i=0; i<this._sublists.length; i++) sets[i] = [];\n\n\t\tthis.data.each(function(item){\n\t\t\tlet j = this._assignList(item);\n\t\t\tif (j >= 0)\n\t\t\t\tsets[j].push(item);\n\t\t}, this);\n\n\t\tfor (let i=0; i<this._sublists.length; i++){\n\t\t\tconst data = sets[i];\n\n\t\t\tif (data.length > 1 && data[0].$index)\n\t\t\t\tdata.sort( (a,b) => a.$index > b.$index ? 1 : -1 );\n\n\t\t\tthis._sublists[i].clearAll();\n\t\t\tthis._sublists[i].data.importData(data);\n\t\t\tthis._sublists[i]._fixOrder();\n\t\t}\n\t},\n\t_assignList(data){\n\t\tfor (var i = 0; i < this._sublists.length; i++) {\n\t\t\tif (this._subfilters[i](data)){\n\t\t\t\treturn data.$list = i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\tgetSelectedId(){\n\t\tvar selected = null;\n\t\tthis.eachList(function(list){ selected = list.getSelectedId() || selected; });\n\t\treturn selected;\n\t},\n\tselect(id){\n\t\tthis.getOwnerList(id).select(id);\n\t},\n\tgetOwnerList(id){\n\t\tvar item = this.getItem(id);\n\t\treturn item ? this._sublists[item.$list] : null;\n\t},\n\teachList(code){\n\t\tfor (var i=0; i<this._sublists.length; i++){\n\t\t\tcode.call(this, this._sublists[i], this._sublists[i].config.status);\n\t\t}\n\t}\n}, webix.DataLoader, webix.EventSystem, webix.ui.headerlayout );","import {isImage, getIconName} from \"./helpers/image\";\n\nwebix.protoUI({\n\tname:\"kanbanuploader\",\n\t$init(){\n\t\tthis.files.data.scheme({\n\t\t\t$init:(obj) =>{\n\t\t\t\tif (typeof obj.link === \"string\" && obj.link){\n\t\t\t\t\tobj.name = obj.name || obj.link.split(\"/\").pop();\n\t\t\t\t\tobj.type = obj.type || obj.name.split(\".\").pop();\n\t\t\t\t\tobj.status = obj.status || \"server\";\n\t\t\t\t}\n\t\t\t\tobj.sizetext = obj.sizetext || this._format_size(obj.size);\n\t\t\t}\n\t\t});\n\n\t\tthis.files.data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tlet view = webix.$$(this.config.link);\n\t\t\tlet html = \"<span class='webix_strong'>\" + (webix.i18n.kanban.dnd||\"\") + \"</span>\";\n\t\t\tif (!this.files.data.count())\n\t\t\t\tview.showOverlay(html);\n\t\t\telse view.hideOverlay();\n\t\t});\n\t},\n\tdefaults:{\n\t\ticon:\"webix_kanban_icon kbi-upload\",\n\t},\n\tgetValue(){\n\t\tlet data = [];\n\t\tthis.files.data.each(function(obj){\n\t\t\tif (obj.status === \"server\")\n\t\t\t\tdata.push( {id:obj.id, link:obj.link, size:obj.size} );\n\t\t});\n\t\treturn data;\n\t},\n\t_format_size(size){\n\t\tlet index = 0;\n\t\twhile (size > 1024){\n\t\t\tindex++;\n\t\t\tsize = size/1024;\n\t\t}\n\t\treturn Math.round(size*100)/100 + \" \" + webix.i18n.fileSize[index];\n\t}\n}, webix.ui.uploader);\n\nwebix.type(webix.ui.dataview, {\n\tname:\"uploader\",\n\theight:91,\n\twidth:161,\n\ttemplate:(obj, common) => {\n\t\treturn `<a${(obj.status === \"server\") ? ` href=\"${obj.link}\" download=\"${obj.name}\"` : \"\"}></a>\n\t\t\t\t${common.body(obj)}\n\t\t\t\t${common.title(obj,common)}\n\t\t\t\t${common.removeIcon(obj)}`;\n\t},\n\tbody:function(obj){\n\t\tif (obj.status === \"server\" && isImage(obj.type))\n\t\t\treturn `<div class=\"webix_kanban_uploader_body\"><img src=\"${obj.link}\"></div>`;\n\n\t\treturn `<div class='webix_kanban_uploader_body'>\n\t\t\t\t\t<span class='webix_icon webix_kanban_icon kbi-file${getIconName(obj.type)}'></span>\n\t\t\t\t</div>`;\n\t},\n\ttitle:function(obj,common){\n\t\treturn `<div class=\"webix_kanban_uploader_title\" title=\"${obj.name}\">\n\t\t\t\t\t${common.progress(obj)}\n\t\t\t\t\t<div class=\"webix_kanban_uploader_label\">${obj.name}</div>\n\t\t\t\t</div>`;\n\t},\n\tprogress:function(obj){\n\t\tswitch(obj.status){\n\t\t\tcase \"client\": return \"<span class='webix_kanban_uploader_progress'>\"+obj.sizetext+\"</span>\";\n\t\t\tcase \"transfer\": return \"<span class='webix_kanban_uploader_progress'>\"+obj.percent+\"%</span>\";\n\t\t\tcase \"server\": return \"<span class='webix_kanban_uploader_progress_server'>\"+obj.sizetext+\"</span>\";\n\t\t\tdefault: return \"<span class='webix_kanban_uploader_progress_error'>ERROR</span>\";\n\t\t}\n\t},\n\tremoveIcon:function(){\n\t\treturn \"<div class='webix_kanban_remove_upload'><span class='webix_icon wxi-close'></span></div>\";\n\t},\n\ton_click:{\n\t\t\"webix_kanban_remove_upload\":function(ev, id){\n\t\t\twebix.$$(this.config.uploader).files.remove(id);\n\t\t\treturn webix.html.preventEvent(ev);\n\t\t}\n\t}\n});","import en from \"./locales/en\";\nwebix.i18n.kanban = en;","import \"./uploader\";\n\nimport \"./locale\";\n\nwebix.protoUI({\n\tname:\"kanbaneditor\",\n\tdefaults:{\n\t\twidth:534,\n\t\tposition:\"center\",\n\t\tcss:\"webix_kanban_editor\",\n\t\tmodal:true,\n\t\tmove:true\n\t},\n\t$init(config){\n\t\tlet kanban = webix.$$(config.master);\n\n\t\tconfig.head = {\n\t\t\tview:\"toolbar\", paddingX:17, paddingY:8,\n\t\t\telements:[\n\t\t\t\t{ view:\"label\", label:webix.i18n.kanban.editor.add, localId:\"$kanban_header\"},\n\t\t\t\t{ view:\"icon\", icon:\"wxi-close\", click:() => this._close()}\n\t\t\t]\n\t\t};\n\n\t\tlet c = kanban.config.editor;\n\t\tlet form = { view:\"form\", borderless:true, padding:0, elementsConfig:{ labelPosition:\"top\" } };\n\t\tlet elements = [\n\t\t\t{ view:\"textarea\", label:webix.i18n.kanban.editor.text, name:\"text\", height:90},\n\t\t\t{ view:\"multicombo\", label:webix.i18n.kanban.editor.tags, name:\"tags\", options:kanban._tags, $hide:true},\n\t\t\t{ margin:8,\n\t\t\t\tcols:[\n\t\t\t\t\t{ view:\"combo\", label:webix.i18n.kanban.editor.assign, name:\"user_id\", $hide:true, options:{\n\t\t\t\t\t\tbody:{ data:kanban._users, yCount:5 }\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"richselect\", label:webix.i18n.kanban.editor.color,  name:\"color\", $hide:true, options:{\n\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\tyCount:5, data:kanban._colors, css:\"webix_kanban_colorpicker\",\n\t\t\t\t\t\t\ttemplate:\"<span class='webix_kanban_color_item' style='background-color: #color#'></span>#value#\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"richselect\", label:webix.i18n.kanban.editor.status, name:\"$list\", options:{\n\t\t\t\t\t\tbody:{ data:kanban._statuses, yCount:5 }\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\t\tif (webix.isArray(c))\n\t\t\tform.elements = c;\n\t\telse if (typeof c === \"object\"){\n\t\t\tform = webix.extend(form, c, true);\n\t\t\tform.view = \"form\";\n\t\t\tform.elements = form.elements || form.rows || (form.cols ? [{cols:form.cols}] : elements);\n\t\t\tdelete form.rows; delete form.cols;\n\t\t} else form.elements = elements;\n\n\t\tif (kanban.config.attachments)\n\t\t\tform.elements.push({ margin:0, rows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{ view:\"label\", label:webix.i18n.kanban.editor.attachments },\n\t\t\t\t\t\t{ view:\"kanbanuploader\", label:webix.i18n.kanban.editor.upload, upload:kanban.config.attachments,\n\t\t\t\t\t\t\tname:\"attachments\", autowidth:true, css:\"webix_transparent webix_kanban_uploader\", type:\"icon\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{ view:\"dataview\", localId:\"$kanban_dataview_uploader\", yCount:1, borderless:true,\n\t\t\t\t\ttype:\"uploader\", css:\"webix_kanban_dataview_uploader\",\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonItemDblClick:(id, e, node) => {\n\t\t\t\t\t\t\tlet link = node.getElementsByTagName(\"a\")[0];\n\t\t\t\t\t\t\tlink.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]});\n\n\t\tconfig.body = { paddingX:17, paddingY:0, margin:16,\n\t\t\trows:[\n\t\t\t\tform,\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{ view:\"button\", label:webix.i18n.kanban.remove, type:\"danger\", autowidth:true,\n\t\t\t\t\t\t\thidden:true, localId:\"$kanban_remove\",\n\t\t\t\t\t\t\tclick:() => {\n\t\t\t\t\t\t\t\tlet values = this.getValues({hidden:false});\n\t\t\t\t\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\t\t\t\t\tif (!kanban.callEvent(\"onBeforeEditorAction\", [\"remove\", this, values])) return;\n\n\t\t\t\t\t\t\t\tkanban._removeCard(values.id).then(() => this._close());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:webix.i18n.kanban.save, type:\"form\", autowidth:true,\n\t\t\t\t\t\t\tclick:() => {\n\t\t\t\t\t\t\t\tlet values = this.getValues({hidden:false});\n\t\t\t\t\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\t\t\t\t\tif (!kanban.callEvent(\"onBeforeEditorAction\", [\"save\", this, values])) return;\n\n\t\t\t\t\t\t\t\tthis._fixStatus(values, kanban);\n\t\t\t\t\t\t\t\tif ( kanban.exists(values.id) ){\n\t\t\t\t\t\t\t\t\tvalues.$list = kanban.getItem(values.id).$list;\n\t\t\t\t\t\t\t\t\tkanban.updateItem(values.id, values);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse kanban.add(values);\n\t\t\t\t\t\t\t\tthis._close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{ height:1 }\n\t\t\t]\n\n\t\t};\n\n\t\tthis.$ready.push(this._afterInit);\n\t},\n\t_afterInit:function(){\n\t\tthis._form = this.queryView({view:\"form\"});\n\t\tthis._removeBtn = this.queryView({localId:\"$kanban_remove\"});\n\t\tthis._header = this.queryView({localId:\"$kanban_header\"});\n\n\t\tlet uploader = this.queryView({view:\"kanbanuploader\"});\n\t\tif (uploader){\n\t\t\tlet dataview = this.queryView({localId:\"$kanban_dataview_uploader\"});\n\t\t\tuploader.define( \"link\", dataview.config.id );\n\t\t\tuploader.addDropZone(dataview.$view);\n\t\t\twebix.extend(dataview, webix.OverlayBox);\n\t\t}\n\n\t\tlet views = this.queryView({$hide:true}, \"all\");\n\t\tif (views.length)\n\t\t\tthis.attachEvent(\"onShow\", () => {\n\t\t\t\tfor (let i=0; i<views.length; i++)\n\t\t\t\t\tif (views[i].getList().count())\n\t\t\t\t\t\tviews[i].show();\n\t\t\t\t\telse views[i].hide();\n\t\t\t});\n\t},\n\t_fixStatus(values, kanban){\n\t\tvalues.$list = Number(values.$list) || 0;\n\t\tif (kanban._sublists[values.$list])\n\t\t\tkanban.setListStatus(values, kanban._sublists[values.$list]);\n\t},\n\tgetForm(){\n\t\treturn this._form;\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n\tsetValues(values){\n\t\tif (typeof values !== \"object\" || !values)\n\t\t\tvalues = {};\n\t\tlet kanban = this.getKanban();\n\t\tlet listIndex = kanban._assignList(values);\n\t\tvalues.$list = values.$list || (listIndex !== -1 ? listIndex : 0);\n\n\t\tthis._prepareEditor(kanban, values.id);\n\t\tthis._form.setValues(values);\n\t},\n\tgetValues(details){\n\t\treturn this._form.getValues(details);\n\t},\n\t_prepareEditor(kanban, id){\n\t\tif (id && kanban.exists(id)){\n\t\t\tthis._removeBtn.show();\n\t\t\tthis._header.define(\"label\", webix.i18n.kanban.editor.edit);\n\t\t} else {\n\t\t\tthis._removeBtn.hide();\n\t\t\tthis._header.define(\"label\", webix.i18n.kanban.editor.add);\n\t\t}\n\t\tthis._header.refresh();\n\t},\n\t_close(){\n\t\tthis.hide();\n\t\tthis._form.clear();\n\t\tthis._prepareEditor();\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname:\"kanbanuserlist\",\n\tdefaults:{\n\t\twidth:300,\n\t\tlayout:\"y\",\n\t\tscroll:true,\n\t\tyCount:4,\n\t\tautoheight:false,\n\t\tselect:true,\n\t\ttemplate:function(obj){\n\t\t\tif (obj.image)\n\t\t\t\treturn \"<img class='webix_kanban_list_avatar' src='\"+obj.image+\"'>\"+obj.value;\n\n\t\t\treturn \"<span class='webix_icon webix_kanban_icon kbi-account webix_kanban_list_avatar'></span>\"+obj.value;\n\t\t}\n\t},\n\t$init(){\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onShow\", () => {\n\t\t\t\tlet user_id = this.getContext().user_id;\n\n\t\t\t\tif ( user_id && this.exists(user_id) ){\n\t\t\t\t\tthis.select(user_id);\n\t\t\t\t\tthis.showItem(user_id);\n\t\t\t\t} else this.unselectAll();\n\t\t\t});\n\n\t\t\tthis.attachEvent(\"onMenuItemClick\", (id) => {\n\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\tlet selectedTask = this.getContext().id;\n\n\t\t\t\tkanban.updateItem(selectedTask, {user_id:id});\n\t\t\t});\n\n\t\t\tthis.type.master = this.config.masterId;\n\t\t});\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.contextmenu);\n","webix.protoUI({\n\tname:\"kanbanmenu\",\n\t$init(){\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onItemClick\", function(id){\n\t\t\t\tlet cid = this.getContext().id;\n\t\t\t\tlet kanban = this.getKanban();\n\n\t\t\t\tif ( kanban.callEvent(\"onBeforeCardAction\", [id, cid]) ){\n\t\t\t\t\tswitch(id){\n\t\t\t\t\t\tcase \"edit\":\n\t\t\t\t\t\t\tkanban.showEditor(webix.copy( kanban.getItem(cid) ));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"copy\":\n\t\t\t\t\t\t\tkanban.copy(cid);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"remove\":\n\t\t\t\t\t\t\tkanban._removeCard(cid);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.contextmenu);","webix.protoUI({\n\tname:\"kanbanchat\",\n\t$init(config){\n\t\tconfig.padding = 0;\n\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onHide\", this._hide_chat);\n\n\t\t\tlet list = this.queryView({view:\"list\"});\n\t\t\tlist.data.attachEvent(\"onStoreUpdated\", (id, obj, mode)=>{\n\t\t\t\tif (mode && mode !== \"paint\")\n\t\t\t\t\tthis._save();\n\t\t\t});\n\t\t});\n\t},\n\t_save(){\n\t\tlet context = this.getContext();\n\t\tlet comments = this.getBody();\n\t\tlet kanban = this.getKanban();\n\n\t\tif (context && kanban.exists(context.id))\n\t\t\tkanban.updateItem(context.id, {comments:comments.serialize()});\n\t},\n\t_hide_chat(){\n\t\tlet comments = this.getBody();\n\t\tcomments.queryView({view:\"form\"}).clear();\n\t\tcomments.queryView({view:\"list\"}).clearAll();\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.context);\n","webix.protoUI(\n\t{\n\t\tname: \"pivot-portlet\",\n\t\t$reorderOnly: true,\n\t\t$drag: function(object) {\n\t\t\twebix.html.addCss(this.$view, \"portlet_in_drag\");\n\t\t\tconst ctx = webix.DragControl.getContext();\n\t\t\tctx.source = ctx.from = object;\n\n\t\t\t// hide suggests\n\t\t\twebix.callEvent(\"onClick\", []);\n\n\t\t\tconst local = this.$scope.app.getService(\"local\");\n\t\t\tconst values = this.getChildViews()[0].getValues();\n\n\t\t\tlet text = \"\";\n\n\t\t\tif (values.operation == \"complex\") text = local.fixMath(values.math);\n\t\t\telse {\n\t\t\t\ttext = values.name ? local.getField(values.name).value : \"\";\n\n\t\t\t\tif (values.name2)\n\t\t\t\t\ttext += (text ? \", \" : \"\") + local.getField(values.name2).value;\n\t\t\t\telse if (!text) {\n\t\t\t\t\tconst _ = this.$scope.app.getService(\"locale\")._;\n\t\t\t\t\ttext = _(\"Field not defined\");\n\t\t\t\t} else if (values.operation) text += ` (${values.operation})`;\n\t\t\t}\n\n\t\t\tconst askin = webix.skin.$active;\n\t\t\tconst style = `width:${this.$width - askin.inputHeight}px;height:${\n\t\t\t\tthis.$height\n\t\t\t}px;`;\n\t\t\treturn `<div class=\"webix_pivot_portlet_drag\" style=\"${style}\">\n\t\t\t\t<span class=\"webix_icon ${this.config.icon}\"></span>${text}\n\t\t\t</div>`;\n\t\t},\n\t},\n\twebix.ui.portlet\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"helpers/portlet\";\n\nexport default class Property extends JetView {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name);\n\n\t\tif (!config) config = {};\n\n\t\tthis.plusLabel = config.plusLabel;\n\t\tthis.field = config.field;\n\t}\n\tconfig() {\n\t\tconst askin = webix.skin.$active;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpaddingY: 8,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"forms\",\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttemplate: `<div class=\"webix_pivot_handle_add_value\">\n\t\t\t\t\t\t<span class=\"webix_icon wxi-plus-circle\"></span><span>${this.plusLabel}</span>\n\t\t\t\t\t</div>`,\n\t\t\t\t\tcss: \"webix_pivot_add_value\",\n\t\t\t\t\theight: askin.inputHeight - 2 * askin.inputPadding,\n\t\t\t\t\tlocalId: \"addValue\",\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_pivot_handle_add_value: () => {\n\t\t\t\t\t\t\tconst forms = this.$$(\"forms\").getChildViews();\n\n\t\t\t\t\t\t\tthis.Add(null, forms.length);\n\t\t\t\t\t\t\tconst input = forms[forms.length - 1].queryView({ name: \"name\" });\n\n\t\t\t\t\t\t\tif (input) {\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\twebix.html.triggerEvent(\n\t\t\t\t\t\t\t\t\tinput.getInputNode(),\n\t\t\t\t\t\t\t\t\t\"MouseEvent\",\n\t\t\t\t\t\t\t\t\t\"click\"\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.field != \"values\" &&\n\t\t\t\t\t\t\t\tforms.length == this.app.getState().fields.length\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tthis.$$(\"addValue\").hide();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\tinit() {\n\t\tthis.on(webix, \"onAfterPortletMove\", source => {\n\t\t\tif (source == this.$$(\"forms\"))\n\t\t\t\tthis.app.callEvent(\"property:change\", [this.field, this.GetValue()]);\n\t\t});\n\t\tthis.on(webix, \"onPortletDrag\", function(active, target) {\n\t\t\tif (active.$reorderOnly)\n\t\t\t\treturn active.getParentView() === target.getParentView();\n\t\t});\n\t}\n\tListTemplate(obj) {\n\t\tconst input = this._activeInput;\n\n\t\t//wavg - complex operation, no need to correct inputs\n\t\tconst wavg =\n\t\t\tthis.field == \"values\" &&\n\t\t\tinput &&\n\t\t\t!input.$destructed && // CorrectInputs calls SetValue, which recreates inputs\n\t\t\tinput.getFormView().elements.operation.getValue() == \"wavg\";\n\n\t\tconst corrections = this.getParentView().GetCorrections()[this.field];\n\t\tconst value = obj.value;\n\n\t\tif (!wavg && corrections) {\n\t\t\tconst includes = this.CheckCorrections(corrections, obj.id);\n\n\t\t\tlet css = \"webix_pivot_list_marker\";\n\t\t\tif (includes) css += \" webix_pivot_list_marker_fill\";\n\n\t\t\treturn `<div class=\"${css}\"> ${value}</div>`;\n\t\t} else return value;\n\t}\n\tCheckCorrections(corrections, id) {\n\t\tif (this._activeInput && id == this._activeInput.getValue()) return true;\n\n\t\tconst structure = this.app.getStructure();\n\n\t\tfor (let i = 0; i < corrections.length; i++) {\n\t\t\tconst name = corrections[i];\n\t\t\tconst val = structure[name];\n\n\t\t\tif (val) {\n\t\t\t\tif (typeof val == \"string\") {\n\t\t\t\t\tif (val == id) return true;\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j = 0; j < val.length; j++) {\n\t\t\t\t\t\tlet value = val[j];\n\t\t\t\t\t\tif (value.name) value = value.name;\n\n\t\t\t\t\t\tif (value == id) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tGetValue() {\n\t\tconst forms = this.$$(\"forms\").getChildViews();\n\t\tlet arr = [];\n\n\t\tforms.forEach(form => {\n\t\t\tconst val = form.getChildViews()[0].getValues().name;\n\n\t\t\tif (val) arr.push(val);\n\t\t});\n\n\t\treturn arr;\n\t}\n\tSetValue(val) {\n\t\tconst layout = this.$$(\"forms\");\n\t\tconst forms = layout.getChildViews();\n\n\t\tfor (let i = forms.length - 1; i >= 0; i--) layout.removeView(forms[i]);\n\t\tfor (let i = 0; i < val.length; i++) {\n\t\t\tif (!val[i].external) this.Add(val[i], i);\n\t\t}\n\t}\n\tAdd(val, i) {\n\t\tthis.$$(\"forms\").addView({\n\t\t\tview: \"pivot-portlet\",\n\t\t\tmode: \"replace\",\n\t\t\tborderless: true,\n\t\t\tbody: {\n\t\t\t\tview: \"form\",\n\t\t\t\tpaddingY: 0,\n\t\t\t\tpaddingX: 2,\n\t\t\t\telements: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\tcols: this.ItemConfig(val, i),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonChange: (val, old, config) => {\n\t\t\t\t\t\tif (config == \"user\")\n\t\t\t\t\t\t\tthis.app.callEvent(\"property:change\", [\n\t\t\t\t\t\t\t\tthis.field,\n\t\t\t\t\t\t\t\tthis.GetValue(),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\tItemConfig(val) {\n\t\treturn [\n\t\t\t{ width: webix.skin.$active.inputHeight }, //for portlet icon\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"name\",\n\t\t\t\tvalue: this.PrepareValue(val),\n\t\t\t\thidden: val && val.operation == \"complex\",\n\t\t\t\toptions: {\n\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\tdata: this.app.getState().fields,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tconst input = webix.$$(this.config.master);\n\t\t\t\t\t\t\tconst master = input.$scope;\n\n\t\t\t\t\t\t\tconst data = master.GetValue();\n\t\t\t\t\t\t\tmaster._activeInput = input;\n\n\t\t\t\t\t\t\tthis.getList().filter(val =>\n\t\t\t\t\t\t\t\tmaster.FilterSuggest(data, input.getValue(), val)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-close\",\n\t\t\t\tcss: \"webix_pivot_close_icon\",\n\t\t\t\tpivotPropertyRemove: true,\n\t\t\t\tclick: function() {\n\t\t\t\t\tconst master = this.$scope;\n\t\t\t\t\tmaster.$$(\"addValue\").show();\n\t\t\t\t\tmaster\n\t\t\t\t\t\t.$$(\"forms\")\n\t\t\t\t\t\t.removeView(this.queryView(\"pivot-portlet\", \"parent\"));\n\t\t\t\t\tmaster.app.callEvent(\"property:change\", [\n\t\t\t\t\t\tmaster.field,\n\t\t\t\t\t\tmaster.GetValue(),\n\t\t\t\t\t]);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n\tPrepareValue(val) {\n\t\tif (val) {\n\t\t\tif (typeof val == \"object\") val = val.name;\n\t\t\tif (webix.isArray(val)) val = val[0];\n\t\t} else val = \"\";\n\n\t\treturn val;\n\t}\n\tFilterSuggest(data, activeVal, val) {\n\t\tval = val.id;\n\n\t\tif (val == activeVal) return true;\n\n\t\treturn !data.find(item => {\n\t\t\tif (item.name) item = item.name;\n\n\t\t\treturn val == item;\n\t\t});\n\t}\n}\n","function isSymbolAllowed(char) {\n\tconst code = char.charCodeAt(0);\n\treturn code <= 122 ? (code >= 48 && code <= 57) || code >= 65 : code > 191;\n}\n\nfunction getLastSymbolIndex(str, right) {\n\tif (right) {\n\t\tfor (let i = 0; i < str.length; i++) if (!isSymbolAllowed(str[i])) return i;\n\t\treturn str.length;\n\t} else\n\t\tfor (let i = str.length - 1; i >= 0; i--)\n\t\t\tif (!isSymbolAllowed(str[i])) return i + 1;\n\n\treturn 0;\n}\n\nfunction startsWith(text, start) {\n\treturn text.toLowerCase().indexOf(start.toLowerCase()) === 0;\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"suggest-math\",\n\t\t$enterKey() {\n\t\t\tconst list = this.getList();\n\t\t\tif (this.isVisible() && !list.getSelectedId() && list.count()) {\n\t\t\t\tlist.select(list.data.order[1]);\n\t\t\t\tthis._addFirst = 1;\n\t\t\t}\n\n\t\t\twebix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\n\t\t\twebix.delay(() => {\n\t\t\t\tdelete this._addFirst; //wait for input node change event\n\t\t\t});\n\t\t},\n\t\tdefaults: {\n\t\t\tfilter(item, value) {\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\t\tconst str = value.substring(0, cursor);\n\t\t\t\tconst search = str.substring(getLastSymbolIndex(str));\n\t\t\t\tconst nextSymbol = value.charAt(cursor);\n\n\t\t\t\tif (search && (cursor === value.length || !isSymbolAllowed(nextSymbol)))\n\t\t\t\t\tvalue = search;\n\n\t\t\t\t//groups\n\t\t\t\tif (item.disabled) {\n\t\t\t\t\tconst app = editor.$scope.app;\n\n\t\t\t\t\tif (item.id == \"$fields\") {\n\t\t\t\t\t\tconst fields = app.getState().fields;\n\t\t\t\t\t\treturn !!fields.find(obj => startsWith(obj.value, value));\n\t\t\t\t\t} else if (item.id == \"$methods\") {\n\t\t\t\t\t\tconst _ = app.getService(\"locale\")._;\n\t\t\t\t\t\tconst operations = app.getService(\"local\").operations;\n\t\t\t\t\t\treturn !!operations.find(method => startsWith(_(method.id), value));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn startsWith(item.value, value);\n\t\t\t},\n\t\t},\n\t},\n\twebix.ui.suggest\n);\n\nwebix.protoUI(\n\t{\n\t\tname: \"math-editor\",\n\t\t$init() {\n\t\t\tthis.$view.className += \" webix_el_text\";\n\t\t},\n\t\t$onBlur() {\n\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\tconst suggestClick = suggest.$view.contains(document.activeElement);\n\n\t\t\twebix.delay(() => {\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\t\t\t\tif (focus && focus.config.pivotPropertyRemove) return;\n\n\t\t\t\tif (!suggestClick)\n\t\t\t\t\tthis.callEvent(\"onChange\", [this.getValue(), null, \"user\"]);\n\t\t\t});\n\t\t},\n\t\tsetValue() {\n\t\t\tconst suggest = webix.$$(this.config.suggest);\n\n\t\t\t//handle clicks on suggest items and add first suggest value via enter\n\t\t\tif (suggest.isVisible() || suggest._addFirst) return;\n\n\t\t\twebix.ui.text.prototype.setValue.apply(this, arguments);\n\t\t},\n\t\t$setValueHere(value) {\n\t\t\tthis.setValueHere(value);\n\t\t},\n\t\tsetValueHere(value) {\n\t\t\tconst formula = this.getValue();\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\n\t\t\tconst lastSymbol = getLastSymbolIndex(str2, true);\n\t\t\tstr1 += str2.substring(0, lastSymbol);\n\t\t\tstr2 = str2.substring(lastSymbol);\n\n\t\t\tif (str1[str1.length - 1] == \"(\")\n\t\t\t\tstr1 = str1.substring(0, str1.length - 1);\n\n\t\t\tstr1 = str1.substring(0, getLastSymbolIndex(str1)) + value;\n\n\t\t\tconst operations = this.$scope.app.getService(\"local\").operations;\n\t\t\tconst isMethod = operations.find(obj => obj.value == value);\n\n\t\t\tif (isMethod)\n\t\t\t\t//suggest called via up/down key\n\t\t\t\tstr1 += str2[0] == \"(\" ? \"\" : \"(\";\n\n\t\t\tthis.$setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t},\n\t},\n\twebix.ui.text\n);\n","import \"helpers/complex\";\nimport Property from \"views/config/properties\";\n\nexport default class ValuesProperty extends Property {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name, config);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tthis._ = this.app.getService(\"locale\")._;\n\n\t\tthis.typeName = \"operation\";\n\t\tthis.plusLabel = this._(\"Add value\");\n\t\tthis.field = \"values\";\n\n\t\tthis.operations = this.Local.operations;\n\n\t\tthis.operations.map(operation => {\n\t\t\toperation.value = this._(operation.id);\n\t\t\treturn operation;\n\t\t});\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.State = this.app.getState();\n\n\t\tthis.on(this.State.$changes, \"mode\", () => {\n\t\t\tthis.ToggleColors();\n\t\t});\n\t}\n\tGetValue() {\n\t\tconst forms = this.$$(\"forms\").getChildViews();\n\t\tconst arr = [];\n\n\t\tforms.forEach(form => {\n\t\t\tconst values = form.getChildViews()[0].getValues({ hidden: false });\n\t\t\tif (!webix.isUndefined(values.name2)) {\n\t\t\t\t//wavg\n\t\t\t\tif (values.name && values.name2) {\n\t\t\t\t\tvalues.name = [values.name, values.name2];\n\t\t\t\t\tdelete values.name2;\n\t\t\t\t} else values.name = \"\";\n\t\t\t}\n\n\t\t\tif (values.name == \"\" || values.math == \"\") return;\n\t\t\tif (values.math) values.math = this.OutComplexMath(values.math);\n\t\t\tarr.push(values);\n\t\t});\n\n\t\treturn arr;\n\t}\n\tItemConfig(val, i) {\n\t\tconst config = super.ItemConfig(val);\n\n\t\tlet operation;\n\t\tif (val) operation = val.operation;\n\t\telse {\n\t\t\tconst def = this.app.config.defaultOperation;\n\t\t\tconst defIndex = Math.max(this.operations.findIndex(a => a.id == def), 0);\n\t\t\toperation = this.operations[defIndex].id;\n\t\t}\n\n\t\tconfig.splice(2, 0, {\n\t\t\tview: \"richselect\",\n\t\t\tname: \"operation\",\n\t\t\twidth: 110,\n\t\t\tvalue: operation,\n\t\t\toptions: {\n\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\tdata: this.operations.filter(\n\t\t\t\t\tobj => obj.fields <= 2 || obj.id == \"complex\"\n\t\t\t\t),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonChange: function(v) {\n\t\t\t\t\tthis.$scope.SetOperation(v, this);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tconfig.splice(2, 0, {\n\t\t\tview: \"richselect\",\n\t\t\thidden: this.Local.getOperation(operation).fields != 2,\n\t\t\tvalue: val && webix.isArray(val.name) ? val.name[1] : \"\",\n\t\t\tname: \"name2\",\n\t\t\toptions: {\n\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\tdata: this.app.getState().fields,\n\t\t\t},\n\t\t});\n\n\t\t//custom math\n\t\tconfig.splice(1, 0, {\n\t\t\tview: \"math-editor\",\n\t\t\tname: \"math\",\n\t\t\thidden: !val || val.operation != \"complex\",\n\t\t\tvalue: val && val.math ? this.Local.fixMath(val.math) : \"\",\n\t\t\tsuggest: {\n\t\t\t\tview: \"suggest-math\",\n\t\t\t\tdata: this.SuggestData(),\n\t\t\t},\n\t\t});\n\n\t\tconst mini = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\tconst palette = this.Local.getPalette();\n\t\tconst color = (val && val.color) || this.Local.getValueColor(i);\n\n\t\tconfig.splice(1, 0, {\n\t\t\tview: \"colorpicker\",\n\t\t\thidden: this.State.mode != \"chart\",\n\t\t\tname: \"color\",\n\t\t\tcss: \"webix_pivot_value_color\",\n\t\t\tvalue: color,\n\t\t\twidth: mini ? 30 : 38,\n\t\t\tsuggest: {\n\t\t\t\ttype: \"colorboard\",\n\t\t\t\tbody: {\n\t\t\t\t\twidth: 150,\n\t\t\t\t\theight: 150,\n\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\tpalette,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn config;\n\t}\n\tToggleColors() {\n\t\tconst mode = this.State.mode;\n\n\t\tconst layout = this.$$(\"forms\");\n\t\tconst forms = layout.getChildViews();\n\n\t\tfor (let i = 0; i < forms.length; i++) {\n\t\t\tconst input = forms[i].getChildViews()[0].elements.color;\n\t\t\tif (mode == \"chart\") input.show();\n\t\t\telse input.hide();\n\t\t}\n\t}\n\tFilterSuggest() {\n\t\treturn true;\n\t}\n\tSetOperation(val, view) {\n\t\tconst form = view.getFormView();\n\t\tconst elements = form.elements;\n\n\t\tif (val == \"complex\") {\n\t\t\telements.name.hide();\n\t\t\telements.name2.hide();\n\t\t\telements.math.show();\n\n\t\t\telements.name.setValue();\n\t\t\telements.name2.setValue();\n\t\t} else if (this.Local.getOperation(val).fields == 2) {\n\t\t\telements.name.show();\n\t\t\telements.name2.show();\n\t\t\telements.math.hide();\n\t\t} else {\n\t\t\telements.name.show();\n\t\t\telements.name2.hide();\n\t\t\telements.math.hide();\n\t\t}\n\t}\n\tSuggestData() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tvalue: this._(\"Fields\"),\n\t\t\t\tid: \"$fields\",\n\t\t\t\tdisabled: true,\n\t\t\t\t$css: \"webix_pivot_values_section\",\n\t\t\t},\n\t\t\t...this.app.getState().fields,\n\t\t\t{\n\t\t\t\tvalue: this._(\"Methods\"),\n\t\t\t\tid: \"$methods\",\n\t\t\t\tdisabled: true,\n\t\t\t\t$css: \"webix_pivot_values_section\",\n\t\t\t},\n\t\t\t...this.operations.filter(obj => obj.id != \"complex\"),\n\t\t];\n\t}\n\tOutComplexMath(math) {\n\t\tconst fields = this.app.getState().fields;\n\t\tconst fieldsRegex = new RegExp(\n\t\t\t\"(\\\\(|\\\\s|,|^)(\" +\n\t\t\t\tfields\n\t\t\t\t\t.map(field => field.value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\"))\n\t\t\t\t\t.join(\"|\") +\n\t\t\t\t\")(\\\\)|\\\\s|,|$)\",\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst fieldsMatch = Array.from(math.matchAll(fieldsRegex));\n\t\tfor (let i = fieldsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = fieldsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\tfields.find(obj => obj.value == match[2]).id +\n\t\t\t\tmath.substring(\n\t\t\t\t\tmatch.index + match[0].length - match[3].length,\n\t\t\t\t\tmath.length\n\t\t\t\t);\n\t\t}\n\n\t\tconst methods = this.operations;\n\t\tconst methodsRegex = new RegExp(\n\t\t\t\"(\\\\(|,|\\\\+|-|\\\\/|\\\\*|\\\\s|^)(\" +\n\t\t\t\tmethods\n\t\t\t\t\t.map(method =>\n\t\t\t\t\t\tmethod.value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\")\n\t\t\t\t\t)\n\t\t\t\t\t.join(\"|\") +\n\t\t\t\t\")\\\\(\",\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst methodsMatch = Array.from(math.matchAll(methodsRegex));\n\t\tfor (let i = methodsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = methodsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\tthis.operations.find(operation => operation.value == match[2]).id +\n\t\t\t\tmath.substring(match.index + match[0].length - 1, math.length);\n\t\t}\n\n\t\treturn math;\n\t}\n}\n","import Property from \"views/config/properties\";\n\nexport default class GroupProperty extends Property {\n\tconstructor(app, name) {\n\t\tsuper(app, name);\n\n\t\tthis.field = \"groupBy\";\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tpadding: 10,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"group\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\t\tdata: this.app.getState().fields,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonBeforeShow: () => {\n\t\t\t\t\t\t\t\tthis._activeInput = this.$$(\"group\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\t\t\tif (source == \"user\")\n\t\t\t\t\t\t\t\tthis.app.callEvent(\"property:change\", [this.field, value]);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t}\n\tGetValue() {\n\t\treturn this.$$(\"group\").getValue();\n\t}\n\tSetValue(val) {\n\t\tthis.$$(\"group\").setValue(val);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ChartSettings extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tcomplexData: true,\n\t\t\tpadding: 10,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tname: \"type\",\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tvalue: \"bar\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t{ id: \"bar\", value: _(\"Bar\") },\n\t\t\t\t\t\t\t{ id: \"line\", value: _(\"Line\") },\n\t\t\t\t\t\t\t{ id: \"radar\", value: _(\"Radar\") },\n\t\t\t\t\t\t\t{ id: \"area\", value: _(\"Area\") },\n\t\t\t\t\t\t\t{ id: \"spline\", value: _(\"Spline\") },\n\t\t\t\t\t\t\t{ id: \"splineArea\", value: _(\"Spline Area\") },\n\t\t\t\t\t\t\t{ id: \"pie\", value: _(\"Pie\") },\n\t\t\t\t\t\t\t{ id: \"donut\", value: _(\"Donut\") },\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"xAxis.title\",\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tlabel: _(\"X axis title\"),\n\t\t\t\t\tbatch: \"axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"yAxis.title\",\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tlabel: _(\"Y axis title\"),\n\t\t\t\t\tbatch: \"axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"scaleColor\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\teditable: true,\n\t\t\t\t\tlabel: _(\"Scale color\"),\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\t\t\tpalette: this.app.getService(\"local\").getPalette(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"3D\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"pie\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"3D\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"pieInnerText\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"pie\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Show values inside\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"stacked\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"stacked\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Stacked\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"horizontal\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"bar\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Horizontal\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"scale\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tcheckValue: \"logarithmic\",\n\t\t\t\t\tuncheckValue: \"linear\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Logarithmic scale\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"yAxis.lineShape\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"radar\",\n\t\t\t\t\tcheckValue: \"arc\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Circled lines\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"lines\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Lines\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\tif (source == \"user\") {\n\t\t\t\t\t\tconst out = this.OutValues(this.getRoot().getValues());\n\n\t\t\t\t\t\tthis.innerChange = true;\n\t\t\t\t\t\tthis.State.chart = Object.assign({}, out);\n\t\t\t\t\t\tthis.HandleVisibility();\n\t\t\t\t\t\tdelete this.innerChange;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"chart\", chart => {\n\t\t\tif (!this.innerChange) {\n\t\t\t\tthis.getRoot().setValues(this.InValues(chart));\n\t\t\t\tthis.HandleVisibility();\n\t\t\t}\n\t\t});\n\t}\n\tHandleVisibility() {\n\t\tconst form = this.getRoot();\n\t\tconst type = form.getValues().type;\n\t\tconst pieBased = type == \"pie\" || type == \"donut\";\n\n\t\tif (pieBased) form.showBatch(\"pie\");\n\t\telse {\n\t\t\tform.showBatch(\"scale\");\n\t\t\tif (type == \"radar\") form.showBatch(\"radar\", true);\n\t\t\telse {\n\t\t\t\tform.showBatch(\"axis\", true);\n\t\t\t\tconst bar = type == \"bar\";\n\t\t\t\tif (bar || type == \"area\") {\n\t\t\t\t\tif (bar) form.showBatch(\"bar\", true);\n\t\t\t\t\tform.showBatch(\"stacked\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tInValues(values) {\n\t\tvalues = webix.copy(values);\n\t\tconst type = values.type.toLowerCase();\n\t\tconst stackedArea = type == \"stackedarea\";\n\n\t\tif (type.indexOf(\"bar\") != -1 || stackedArea) {\n\t\t\tif (type.indexOf(\"stacked\") != -1) values.stacked = 1;\n\t\t\tif (type.indexOf(\"h\") != -1) values.horizontal = 1;\n\t\t\tvalues.type = stackedArea ? \"area\" : \"bar\";\n\t\t}\n\n\t\treturn values;\n\t}\n\tOutValues(values) {\n\t\tconst bar = values.type == \"bar\";\n\t\tif (bar || values.type == \"area\") {\n\t\t\tif (bar && values.horizontal) {\n\t\t\t\tvalues.type += \"H\";\n\t\t\t\tdelete values.horizontal;\n\t\t\t}\n\t\t\tif (values.stacked) {\n\t\t\t\tvalues.type =\n\t\t\t\t\t\"stacked\" + values.type[0].toUpperCase() + values.type.slice(1);\n\t\t\t\tdelete values.stacked;\n\t\t\t}\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableSettings extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tpadding: 10,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tname: \"cleanRows\",\n\t\t\t\t\tlocalId: \"cleanRows\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Clean rows\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Highlight\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"minX\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Min X\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"maxX\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Max X\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"minY\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Min Y\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"maxY\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Max Y\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Footer\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tname: \"footer\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: 1, value: _(\"Off\") },\n\t\t\t\t\t\t{ id: 2, value: _(\"On\") },\n\t\t\t\t\t\t{ id: 3, value: _(\"Sum Only\") },\n\t\t\t\t\t],\n\t\t\t\t\tvalue: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Total Column\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tname: \"totalColumn\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: 1, value: _(\"Off\") },\n\t\t\t\t\t\t{ id: 2, value: _(\"On\") },\n\t\t\t\t\t\t{ id: 3, value: _(\"Sum Only\") },\n\t\t\t\t\t],\n\t\t\t\t\tvalue: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\tif (source == \"user\") {\n\t\t\t\t\t\tconst out = this.OutValues(this.getRoot().getValues());\n\n\t\t\t\t\t\tthis.innerChange = true;\n\t\t\t\t\t\tthis.State.datatable = Object.assign({}, out);\n\t\t\t\t\t\tdelete this.innerChange;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"datatable\", datatable => {\n\t\t\tif (!this.innerChange) this.getRoot().setValues(this.InValues(datatable));\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", mode => {\n\t\t\tif (mode == \"table\") this.$$(\"cleanRows\").show();\n\t\t\telse this.$$(\"cleanRows\").hide();\n\t\t});\n\t}\n\tInValues(values) {\n\t\tvalues = webix.copy(values);\n\n\t\tif (values.footer) values.footer = values.footer == \"sumOnly\" ? 3 : 2;\n\t\telse values.footer = 1;\n\n\t\tif (values.totalColumn)\n\t\t\tvalues.totalColumn = values.totalColumn == \"sumOnly\" ? 3 : 2;\n\t\telse values.totalColumn = 1;\n\n\t\treturn values;\n\t}\n\tOutValues(values) {\n\t\tswitch (values.footer) {\n\t\t\tcase \"1\":\n\t\t\t\tdelete values.footer;\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tvalues.footer = true;\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\t\tvalues.footer = \"sumOnly\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch (values.totalColumn) {\n\t\t\tcase \"1\":\n\t\t\t\tdelete values.totalColumn;\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tvalues.totalColumn = true;\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\t\tvalues.totalColumn = \"sumOnly\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class FilterView extends JetView {\n\tconfig() {\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss: \"webix_pivot_filter_popup\",\n\t\t\ttemplate: item => item.label,\n\t\t\tbody: {\n\t\t\t\tview: \"filter\",\n\t\t\t\tfield: \"value\",\n\t\t\t\ton: {\n\t\t\t\t\tonChange: config => {\n\t\t\t\t\t\tif (config == \"user\") {\n\t\t\t\t\t\t\tconst state = this.app.getState();\n\t\t\t\t\t\t\tconst structure = webix.copy(state.structure);\n\n\t\t\t\t\t\t\tlet value;\n\t\t\t\t\t\t\tstructure.filters = structure.filters.filter(filter => {\n\t\t\t\t\t\t\t\tconst exists = filter.name == this.field;\n\t\t\t\t\t\t\t\tconst inner = exists && !filter.external;\n\n\t\t\t\t\t\t\t\tif (inner) value = filter.value = this.filter.getValue();\n\n\t\t\t\t\t\t\t\treturn !exists || inner;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tstate.structure = structure;\n\n\t\t\t\t\t\t\tthis.app.callEvent(\"filter:change\", [this.field, value]);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tShow(pos, filterObj) {\n\t\tconst popup = this.getRoot();\n\t\tconst filter = (this.filter = popup.getBody());\n\t\tthis.field = filterObj.name;\n\t\tconst list = filter.getChildViews()[2];\n\n\t\tconst field = this.Local.getField(this.field);\n\n\t\tthis.Local.collectFieldValues(this.field).then(values => {\n\t\t\tlist.clearAll();\n\t\t\tlist.parse(webix.copy(values));\n\n\t\t\tfilter.define({ mode: field.type });\n\t\t\tfilter.config.value = \"\";\n\t\t\tfilter.setValue(webix.copy(filterObj.value || {}));\n\n\t\t\tpopup.show(pos);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ModeView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\");\n\n\t\tconst askin = webix.skin.$active;\n\t\tconst mini = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\tconst config = {\n\t\t\theight: askin.toolbarHeight,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"segmented\",\n\t\t\t\t\tlocalId: \"modes\",\n\t\t\t\t\talign: \"middle\",\n\t\t\t\t\tinputHeight: askin.inputHeight - askin.inputPadding * (mini ? 0 : 2),\n\t\t\t\t\toptionWidth: 80,\n\t\t\t\t\twidth: 244,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"table\", value: _(\"Table\") },\n\t\t\t\t\t\t{ id: \"tree\", value: _(\"Tree\") },\n\t\t\t\t\t\t{ id: \"chart\", value: _(\"Chart\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: (v, o, c) => {\n\t\t\t\t\t\t\tif (c == \"user\") this.SetMode(v);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ width: askin.dataPadding },\n\t\t\t],\n\t\t};\n\n\t\tif (this.Compact) {\n\t\t\tconfig.css = \"webix_pivot_footer\";\n\t\t\tconfig.cols[1].width = 0;\n\t\t\tconfig.cols.unshift({});\n\t\t}\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\");\n\n\t\tthis.on(this.State.$changes, \"mode\", mode => {\n\t\t\tthis.$$(\"modes\").setValue(mode);\n\t\t});\n\t}\n\n\t/**\n\t * Sets Pivot mode\n\t * @param {string} desired mode (\"table\", \"tree\", \"data\")\n\t */\n\tSetMode(value) {\n\t\tthis.State.mode = value;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ModeView from \"views/mode\";\nimport filterPopup from \"views/filter\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\");\n\t\tthis.State = this.getParam(\"state\");\n\n\t\tlet config;\n\t\tif (this.Compact) {\n\t\t\tconfig = {\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"pt-settings\",\n\t\t\t\tinputHeight: webix.skin.$active.buttonHeight,\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: () => this.ToggleConfig(),\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tconst label = _(\"Configure Pivot\");\n\t\t\tconst css = \"webix_template webix_pivot_measure_size\";\n\n\t\t\t// 20px icon width and 8px additional padding\n\t\t\tconst width = 20 + 8 + webix.html.getTextSize(label, css).width;\n\t\t\tconfig = {\n\t\t\t\tview: \"template\",\n\t\t\t\tborderless: true,\n\t\t\t\twidth,\n\t\t\t\ttemplate: () => {\n\t\t\t\t\treturn `\n\t\t\t\t\t\t<span>${label}</span>\n\t\t\t\t\t\t<span class=\"pt-settings webix_pivot_toolbar_icon\"></span>`;\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\twebix_pivot_settings: () => this.ToggleConfig(),\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t\tconfig.localId = \"config\";\n\t\tconfig.css = \"webix_pivot_settings\";\n\t\tconfig.tooltip = _(\"Click to configure\");\n\n\t\tconst scrollSize = webix.env.$customScroll ? 0 : this._GetScrollWidth();\n\t\tconst height = webix.skin.$active.toolbarHeight + scrollSize;\n\n\t\tlet css = \"webix_pivot_toolbar\";\n\t\tif (scrollSize) {\n\t\t\twebix.html.addStyle(\n\t\t\t\t`.webix_pivot_bar_with_scroll .webix_pivot_settings>.webix_template{ line-height: ${height}px; }`\n\t\t\t);\n\t\t\tcss += \" webix_pivot_bar_with_scroll\";\n\t\t}\n\n\t\tconst result = {\n\t\t\tcss,\n\t\t\tmargin: this.Compact ? 12 : 0,\n\t\t\tpadding: {\n\t\t\t\tleft: this.Compact ? webix.skin.$active.inputPadding : 0,\n\t\t\t},\n\t\t\theight,\n\t\t\tcols: [config, this.GetFilters()],\n\t\t};\n\n\t\tif (!this.Compact) result.cols.push(ModeView);\n\n\t\treturn result;\n\t}\n\n\tinit() {\n\t\tthis.filterPopup = this.ui(filterPopup);\n\n\t\tthis.on(this.State.$changes, \"fields\", fields => {\n\t\t\tif (fields.length) {\n\t\t\t\t// render filters after fields set\n\t\t\t\tconst filtersView = this.$$(\"filters\").getParentView();\n\t\t\t\twebix.ui(this.GetFilters(), filtersView);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old && this.FiltersChanged(structure, old)) {\n\t\t\t\tconst filtersView = this.$$(\"filters\").getParentView();\n\t\t\t\twebix.ui(this.GetFilters(), filtersView);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", val => {\n\t\t\tthis.ToggleReadonly(val);\n\t\t});\n\t}\n\t/**\n\t * Compares filters when structure changes\n\t * @param {Object} structure - current structure\n\t * @param {Object} oldStructure - previous structure\n\t * @returns {boolean} result of comparison\n\t */\n\tFiltersChanged(structure, oldStructure) {\n\t\tif (structure.filters.length == oldStructure.filters.length) {\n\t\t\tfor (let i = 0; i < structure.filters.length; i++) {\n\t\t\t\tconst filter = structure.filters[i];\n\t\t\t\tconst old = oldStructure.filters[i];\n\t\t\t\tif (filter.name != old.name || filter.external != old.external)\n\t\t\t\t\treturn true;\n\t\t\t\tif (JSON.stringify(filter.value) != JSON.stringify(old.value))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t} else return true;\n\n\t\treturn false;\n\t}\n\t/**\n\t * Toggles the configuration window\n\t */\n\tToggleConfig() {\n\t\tthis.State.config = !this.State.config;\n\t}\n\t/**\n\t * Controls visibility of a button with Pivot settings\n\t * @param {boolean} val - indicates whether Pivot is in a readonly mode\n\t */\n\tToggleReadonly(val) {\n\t\tif (val) this.$$(\"config\").hide();\n\t\telse this.$$(\"config\").show();\n\t}\n\t/**\n\t * Gets configuration for toolbar filters\n\t * @returns {Object} layout with all filters\n\t */\n\tGetFilters() {\n\t\tconst structure = this.State.structure;\n\t\tconst filters = [];\n\n\t\tif (this.State.fields.length)\n\t\t\t// toolbar renders before fields set\n\t\t\tstructure.filters.forEach(filter => {\n\t\t\t\tif (!filter.external) filters.push(this.FilterConfig(filter));\n\t\t\t});\n\n\t\tconst askin = webix.skin.$active;\n\t\tconst padding = (askin.toolbarHeight - askin.buttonHeight) / 2;\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tborderless: true,\n\t\t\tscroll: \"x\",\n\t\t\tbody: {\n\t\t\t\tmargin: 8,\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: this.Compact ? 0 : 8,\n\t\t\t\t\ttop: padding + askin.inputPadding,\n\t\t\t\t\tbottom: padding + askin.inputPadding,\n\t\t\t\t},\n\t\t\t\tlocalId: \"filters\",\n\t\t\t\tcols: filters,\n\t\t\t},\n\t\t};\n\t}\n\t/**\n\t * Gets configuration a single toolbar filter\n\t * @param {Object} filter - filter object from structure\n\t * @returns {Object} filter UI\n\t */\n\tFilterConfig(filter) {\n\t\tconst label = this.app.getService(\"local\").getField(filter.name).value;\n\t\tconst css = \"webix_template webix_pivot_measure_size\";\n\n\t\t// 20px icon width and 8px additional padding\n\t\tconst width =\n\t\t\t(this.Compact ? 0 : 20 + 8) + webix.html.getTextSize(label, css).width;\n\t\treturn {\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\twidth,\n\t\t\tcss: \"webix_pivot_filter\",\n\t\t\ttemplate: () => {\n\t\t\t\tconst value = filter.value;\n\t\t\t\tconst activeCss =\n\t\t\t\t\tvalue && (value.includes || value.condition.filter)\n\t\t\t\t\t\t? \"webix_pivot_active_filter\"\n\t\t\t\t\t\t: \"\";\n\t\t\t\tconst icon = !this.Compact\n\t\t\t\t\t? \"<span class='pt-filter webix_pivot_toolbar_icon'></span>\"\n\t\t\t\t\t: \"\";\n\t\t\t\treturn `<div class=\"webix_pivot_filter_inner ${activeCss}\">\n\t\t\t\t\t<span>${label}</span>\n\t\t\t\t\t${icon}\n\t\t\t\t</div>`;\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_pivot_filter: function() {\n\t\t\t\t\tthis.$scope.filterPopup.Show(this.$view, filter);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t_GetScrollWidth() {\n\t\tconst outer = webix.html.create(\"DIV\", {\n\t\t\tstyle: \"visibility:hidden;overflow:scroll;\",\n\t\t});\n\t\tconst inner = webix.html.create(\"DIV\");\n\n\t\tdocument.body.appendChild(outer);\n\t\touter.appendChild(inner);\n\n\t\tconst scrollbarWidth = outer.offsetWidth - inner.offsetWidth;\n\n\t\touter.parentNode.removeChild(outer);\n\t\treturn scrollbarWidth;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst chart = {\n\t\t\tview: \"chart\",\n\t\t\t$mainView: true,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"data\",\n\t\t\txAxis: {},\n\t\t\tyAxis: {},\n\t\t};\n\n\t\twebix.extend(chart, webix.copy(state.chart), true);\n\n\t\tconst type = chart.type;\n\t\tif (type == \"barH\" || type == \"stackedBarH\") {\n\t\t\tif (!chart.yAxis.template)\n\t\t\t\tchart.yAxis.template = obj => obj[obj.length - 1];\n\t\t} else if (!chart.xAxis.template)\n\t\t\tchart.xAxis.template = obj => obj[obj.length - 1];\n\n\t\tconst commonAxisSettings = {\n\t\t\tlines: chart.lines,\n\t\t};\n\n\t\t//save default chart line color\n\t\tif (chart.scaleColor)\n\t\t\tcommonAxisSettings.color = commonAxisSettings.lineColor =\n\t\t\t\tchart.scaleColor;\n\n\t\twebix.extend(chart.xAxis, commonAxisSettings, true);\n\t\twebix.extend(chart.yAxis, commonAxisSettings, true);\n\n\t\tif (this.IsPieBased()) {\n\t\t\twebix.extend(\n\t\t\t\tchart,\n\t\t\t\t{\n\t\t\t\t\tmultilevel: true,\n\t\t\t\t\ttooltip: this.ValueFormat,\n\t\t\t\t\tcolor: \"#color#\",\n\t\t\t\t\ttype: type + (chart[\"3D\"] ? \"3D\" : \"\"),\n\t\t\t\t\tpieInnerText: chart[\"pieInnerText\"] ? this.ValueFormat : \"\",\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\treturn chart;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.LoadData();\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old) this.LoadData();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"chart\", (val, o) => {\n\t\t\tif (o) this.refresh();\n\t\t});\n\t}\n\t/**\n\t * Loads data to a chart\n\t * @returns {Promise} promise that resolves when data is parsed\n\t */\n\tLoadData() {\n\t\treturn this.Local.getData().then(data => {\n\t\t\tthis.UpdateChart(data);\n\t\t});\n\t}\n\t/**\n\t * Updates chart data\n\t * @param {Array} data - array of data\n\t */\n\tUpdateChart(data) {\n\t\tthis.$$(\"data\").clearAll();\n\n\t\tif (!this.IsPieBased()) {\n\t\t\tthis.$$(\"data\").removeAllSeries();\n\t\t\tthis.SetSeries(data.values);\n\t\t}\n\n\t\tthis.SetLegend(data.values);\n\t\tthis.$$(\"data\").parse(data.data);\n\t}\n\t/**\n\t * Checks if chart is pie based\n\t * @param {string} type (optional) - chart type\n\t * @returns {boolean} is pie based\n\t */\n\tIsPieBased(type) {\n\t\tif (!type) type = this.State.chart.type;\n\t\treturn type == \"pie\" || type == \"donut\";\n\t}\n\t/**\n\t * Sets chart series\n\t * @param {Array} values - array of values for series\n\t */\n\tSetSeries(values) {\n\t\tfor (let i = 0; i < values.length; i++)\n\t\t\tthis.$$(\"data\").addSeries(this.GetSeriesConfig(values[i], i));\n\t}\n\t/**\n\t * Prepares chart series\n\t * @param {object} settings - values for series\n\t * @param {number} i - index\n\t * @param {string} type - chart type (customizations)\n\t */\n\tGetSeriesConfig(settings, i, type) {\n\t\ttype = type || this.State.chart.type;\n\t\treturn {\n\t\t\ttype,\n\t\t\tvalue: obj => obj[i],\n\t\t\talpha: type == \"area\" || type == \"splineArea\" ? 0.7 : 1,\n\t\t\tcolor: settings.color,\n\t\t\ttooltip: obj => this.ValueFormat({ value: obj[i] }),\n\t\t\titem: {\n\t\t\t\tcolor: settings.color,\n\t\t\t\tborderColor: settings.color,\n\t\t\t},\n\t\t\tline: {\n\t\t\t\tcolor: settings.color,\n\t\t\t},\n\t\t};\n\t}\n\t/**\n\t * Prepares and sets chart legend\n\t * @param {Array} values - array of values for legend\n\t */\n\tSetLegend(values) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tvalues = values.map(v => {\n\t\t\tconst operation = v.operation;\n\t\t\tlet text = v.text;\n\t\t\tif (operation == \"complex\") text = this.Local.fixMath(text);\n\t\t\telse if (operation) {\n\t\t\t\ttext = text\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.map(t => this.Local.getField(t).value)\n\t\t\t\t\t.join(\", \");\n\t\t\t\ttext = `${text} (${_(operation)})`;\n\t\t\t}\n\t\t\treturn { color: v.color, text };\n\t\t});\n\n\t\tconst legend = webix.extend(\n\t\t\t{\n\t\t\t\tvalues,\n\t\t\t\tvalign: \"middle\",\n\t\t\t\talign: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t},\n\t\t\tthis.State.chart.legend || {},\n\t\t\ttrue\n\t\t);\n\t\tthis.$$(\"data\").define({ legend });\n\t}\n\t/**\n\t * Formats tooltip values / inner text\n\t * @param {object} item - data item\n\t * @returns {number} formatted value\n\t */\n\tValueFormat(item) {\n\t\treturn item.text || parseFloat(item.value || 0).toFixed(3);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Property from \"views/config/properties\";\nimport ValuesProperty from \"views/config/properties/values\";\nimport GroupProperty from \"views/config/properties/group\";\nimport ChartSettings from \"views/config/properties/chart\";\nimport TableSettings from \"views/config/properties/table\";\n\nexport default class ConfigView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tthis.State = this.app.getState();\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst toolbar = {\n\t\t\ttype: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: 16,\n\t\t\t\tright: 14, //button\n\t\t\t\ttop: 8,\n\t\t\t\tbottom: 4,\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Done\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tautowidth: true,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: () => this.ToggleForm(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst structure = {\n\t\t\tborderless: true,\n\t\t\tview: \"scrollview\",\n\t\t\tscroll: \"y\",\n\t\t\tbody: {\n\t\t\t\tview: \"accordion\",\n\t\t\t\tcss: \"webix_pivot_configuration\",\n\t\t\t\tlocalId: \"settings\",\n\t\t\t\tmulti: true,\n\t\t\t\ttype: \"space\",\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: 16,\n\t\t\t\t\tright: 16,\n\t\t\t\t\ttop: 4,\n\t\t\t\t\tbottom: 16,\n\t\t\t\t},\n\t\t\t\tmargin: 20,\n\t\t\t\trows: [\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Rows\"),\n\t\t\t\t\t\t\"pt-rows\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"rows\",\n\t\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\t\tfield: \"rows\",\n\t\t\t\t\t\t\t\tplusLabel: _(\"Add row\"),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Columns\"),\n\t\t\t\t\t\t\"pt-columns\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"columns\",\n\t\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\t\tfield: \"columns\",\n\t\t\t\t\t\t\t\tplusLabel: _(\"Add column\"),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(_(\"Values\"), \"pt-values\", {\n\t\t\t\t\t\tname: \"values\",\n\t\t\t\t\t\t$subview: ValuesProperty,\n\t\t\t\t\t}),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Group By\"),\n\t\t\t\t\t\t\"pt-group\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"groupBy\",\n\t\t\t\t\t\t\t$subview: GroupProperty,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"chart\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(_(\"Filters\"), \"pt-filter\", {\n\t\t\t\t\t\tname: \"filters\",\n\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\tfield: \"filters\",\n\t\t\t\t\t\t\tplusLabel: _(\"Add filter\"),\n\t\t\t\t\t\t}),\n\t\t\t\t\t}),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Chart\"),\n\t\t\t\t\t\t\"pt-chart\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$subview: ChartSettings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"chart\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Table\"),\n\t\t\t\t\t\t\"wxi-columns\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$subview: TableSettings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\t{},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t\trows: [toolbar, structure],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.State.$changes, \"readonly\", (_v, o) => {\n\t\t\tif (!webix.isUndefined(o)) this.ToggleForm();\n\t\t});\n\t}\n\n\tready() {\n\t\tthis.on(this.app, \"property:change\", (field, value) => {\n\t\t\tthis.HandleFieldChange(field, value);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"structure\", () => {\n\t\t\tif (!this.innerChange) this.SetValues();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", (mode, oldMode) => {\n\t\t\tconst isChart = mode == \"chart\";\n\n\t\t\tthis.$$(\"settings\").showBatch(isChart ? \"chart\" : \"table\");\n\n\t\t\t//columns can be updated in structure via groupBy\n\t\t\tif (oldMode && (isChart || oldMode == \"chart\")) this.SetValues();\n\t\t});\n\t}\n\t/** Toggles configuration form */\n\tToggleForm() {\n\t\tthis.State.config = !this.State.config;\n\t}\n\t/** Sets values into a  configuration form */\n\tSetValues() {\n\t\tconst structure = this.State.structure;\n\t\tconst inputs = [\"rows\", \"columns\", \"values\", \"filters\", \"groupBy\"];\n\n\t\tinputs.forEach(input => {\n\t\t\tconst value = structure[input] || this.State[input];\n\t\t\tconst view = this.getSubView(input);\n\t\t\tview.SetValue(value);\n\t\t});\n\t}\n\t/**\n\t * Applies changes in form fields to data structure\n\t * @param {string} field - field name\n\t * @param {string|Array} value - field value\n\t */\n\tHandleFieldChange(field, value) {\n\t\tconst structure = webix.copy(this.State.structure);\n\n\t\tif (field == \"filters\") value = this.CorrectFilters(structure, value);\n\t\telse this.CorrectInputs(structure, field, value);\n\n\t\tstructure[field] = value;\n\t\tthis.innerChange = true;\n\t\tthis.app.setStructure(structure);\n\t\tdelete this.innerChange;\n\t}\n\t/**\n\t * Prepares configuration for an accordion item with form fields\n\t * @param {string} name - accordion item header name\n\t * @param {string} icon - accordion item icon\n\t * @param {Object} config - object with form fields for this accordion item\n\t * @param {string} batch - batch name, used to control visibility\n\t * @returns {Object} configuration of the accordion item body\n\t */\n\tGroupConfig(name, icon, config, batch) {\n\t\treturn {\n\t\t\tbatch,\n\t\t\theader: `\n\t\t\t\t<span class=\"webix_icon webix_pivot_config_icon ${icon}\"></span>\n\t\t\t\t<span class=\"webix_pivot_config_label\">${name}</span>\n\t\t\t`,\n\t\t\tbody: config,\n\t\t\tborderless: true,\n\t\t};\n\t}\n\t/** Returns an object with fields that need to be corrected when some field changes */\n\tGetCorrections() {\n\t\treturn {\n\t\t\trows: [\"columns\", \"values\", \"groupBy\"],\n\t\t\tcolumns: [\"rows\", \"values\"],\n\t\t\tvalues: [\"rows\", \"columns\", \"groupBy\"],\n\t\t\tgroupBy: [\"rows\", \"values\"],\n\t\t};\n\t}\n\t/**\n\t * Prepares filters before applying them to data structure\n\t * @param {Object} structure - a copy of the current data structure\n\t * @param {Array} value - \"filters\" field value\n\t */\n\tCorrectFilters(structure, value) {\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst active = structure.filters.find(filter => {\n\t\t\t\tif (filter.name == value[i]) return true;\n\t\t\t});\n\t\t\tvalue[i] = { name: value[i] };\n\t\t\tif (active && !active.external) value[i].value = active.value;\n\t\t}\n\n\t\tconst external = structure.filters.filter(filter => filter.external);\n\t\tvalue = value.concat(external);\n\n\t\treturn value;\n\t}\n\t/**\n\t * Prepares form fields before applying them to data structure\n\t * @param {Object} structure - a copy of the current data structure\n\t * @param {string} field -  field name\n\t * @param {string|Array} value -  field value\n\t */\n\tCorrectInputs(structure, field, value) {\n\t\tconst inputs = this.GetCorrections()[field];\n\n\t\tif (inputs) {\n\t\t\tif (typeof value == \"string\") value = [value];\n\n\t\t\tvalue = value.map(v => (v.name ? v.name : v));\n\n\t\t\tinputs.forEach(input => {\n\t\t\t\tconst view = this.getSubView(input);\n\t\t\t\tlet values = view.GetValue();\n\n\t\t\t\tif (typeof values == \"string\") {\n\t\t\t\t\tif (value.find(v => v == values)) values = \"\";\n\t\t\t\t} else\n\t\t\t\t\tvalues = values.filter(v => {\n\t\t\t\t\t\tif (v.name) v = v.name;\n\n\t\t\t\t\t\treturn value.indexOf(v) == -1;\n\t\t\t\t\t});\n\n\t\t\t\tstructure[input] = values;\n\t\t\t\tview.SetValue(values);\n\t\t\t});\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class Popup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tborderless: true,\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ModeView from \"views/mode\";\nimport ToolbarView from \"views/toolbar\";\n\nimport { initRLayout } from \"@xbs/jet-helpers\";\n\nexport default class MainView extends JetView {\n\tconfig() {\n\t\tinitRLayout();\n\n\t\tconst fCompact = this.getParam(\"forceCompact\");\n\t\tif (!webix.isUndefined(fCompact)) this.setParam(\"compact\", fCompact);\n\t\tthis.Compact = this.getParam(\"compact\");\n\n\t\tconst rows = [\n\t\t\tToolbarView,\n\t\t\t{\n\t\t\t\tview: \"r-layout\",\n\t\t\t\tlocalId: \"main\",\n\t\t\t\tcols: [{ $subview: true }],\n\t\t\t},\n\t\t];\n\n\t\tif (this.Compact) {\n\t\t\trows.push(ModeView, {\n\t\t\t\t$subview: true,\n\t\t\t\tname: \"edit\",\n\t\t\t\tpopup: true,\n\t\t\t});\n\t\t} else {\n\t\t\trows[1].cols.push({\n\t\t\t\tview: \"proxy\",\n\t\t\t\tmaxWidth: 450,\n\t\t\t\tlocalId: \"edit\",\n\t\t\t\tcss: \"webix_pivot_config_container webix_shadow_medium\",\n\t\t\t\tborderless: true,\n\t\t\t\thidden: true,\n\t\t\t\tbody: { $subview: true, name: \"edit\" },\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t\trows,\n\t\t\tview: webix.isUndefined(fCompact) ? \"r-layout\" : \"layout\",\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst state = this.getParam(\"state\");\n\n\t\tthis.$$(\"main\").sizeTrigger(\n\t\t\tthis.app,\n\t\t\tmode => this.SetCompactMode(mode),\n\t\t\t!!this.Compact\n\t\t);\n\n\t\tthis.on(state.$changes, \"mode\", mode => {\n\t\t\tthis.show(\"./\" + (mode == \"chart\" ? \"chart\" : \"table\"));\n\t\t});\n\n\t\tthis.on(state.$changes, \"config\", val => {\n\t\t\tif (val) this.ShowConfig();\n\t\t\telse this.HideConfig();\n\t\t});\n\t}\n\n\t/** Shows configuration window*/\n\tShowConfig() {\n\t\tif (this.Compact) {\n\t\t\tthis.show(\"config.popup/config\", {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$$(\"edit\").show();\n\t\t\tthis.show(\"config\", {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t}\n\t}\n\n\t/** Hides configuration window*/\n\tHideConfig() {\n\t\t// we need to destroy the view inside first\n\t\tthis.show(\"_blank\", { target: \"edit\" });\n\n\t\tif (!this.Compact) this.$$(\"edit\").hide();\n\t}\n\n\tSetCompactMode(mode) {\n\t\t//let it render, then recreate\n\t\twebix.delay(() => {\n\t\t\tthis.setParam(\"compact\", mode);\n\t\t\tif (!mode) webix.fullscreen.exit();\n\t\t\tthis.refresh();\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst rows = state.structure.rows.length;\n\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\t$mainView: true,\n\t\t\tlocalId: \"data\",\n\t\t\tcss: \"webix_data_border webix_header_border\",\n\t\t\tselect: true,\n\t\t\tleftSplit: state.mode == \"table\" ? rows : rows ? 1 : 0,\n\t\t\tresizeColumn: true,\n\t\t\tborderless: true,\n\t\t\tcolumns: [],\n\t\t\tfooter: state.datatable.footer,\n\t\t};\n\n\t\twebix.extend(table, state.datatable, true);\n\n\t\treturn table;\n\t}\n\n\tinit() {\n\t\tthis.LoadData();\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old) this.LoadData();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"datatable\", (val, o) => {\n\t\t\tif (o) this.refresh();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", (val, o) => {\n\t\t\tif (o && o != \"chart\" && val != \"chart\") this.refresh();\n\t\t});\n\t}\n\t/**\n\t * Loads data to a table\n\t * @returns {Promise} promise that resolves when data is parsed\n\t */\n\tLoadData() {\n\t\treturn this.Local.getData().then(data => {\n\t\t\tthis.UpdateTable(data);\n\t\t});\n\t}\n\t/**\n\t * Updates table data\n\t * @param {Array} data - array of data\n\t */\n\tUpdateTable(data) {\n\t\tconst state = this.State;\n\t\tconst structure = state.structure;\n\n\t\tconst freeze = this.CheckFreeze();\n\n\t\tlet rightSplit = 0;\n\t\tconst totalCols = state.datatable.totalColumn;\n\t\tlet totalOps;\n\t\tif (totalCols) {\n\t\t\tconst vals = structure.values;\n\t\t\ttotalOps =\n\t\t\t\ttotalCols == \"sumOnly\" ? vals.filter(v => v.operation == \"sum\") : vals;\n\t\t\tif (freeze) rightSplit = totalOps.length;\n\t\t}\n\n\t\tlet leftSplit = 0;\n\t\tif (freeze) {\n\t\t\tconst rows = structure.rows.length;\n\t\t\tleftSplit = state.mode == \"table\" ? rows : rows ? 1 : 0;\n\t\t}\n\n\t\tif (!data.$ready) {\n\t\t\tconst total = data.totalColumn;\n\t\t\tlet lastId;\n\n\t\t\tif (total) {\n\t\t\t\tlastId = data.header[data.header.length - 1].id;\n\n\t\t\t\tfor (let i = 0; i < totalOps.length; i++) {\n\t\t\t\t\tlet name = totalOps[i].name;\n\t\t\t\t\tif (webix.isArray(name)) name = name.join();\n\n\t\t\t\t\tdata.header.push({\n\t\t\t\t\t\theader: [\n\t\t\t\t\t\t\t{ name: \"total\", colspan: rightSplit },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: name || totalOps[i].operation,\n\t\t\t\t\t\t\t\toperation: totalOps[i].operation,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tid: lastId + i + 1,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst totalIndex = { i: 0 };\n\t\t\tdata = this.Local._store = {\n\t\t\t\tdata: data.data.map(item =>\n\t\t\t\t\tthis._prepareData(item, total, totalIndex, lastId)\n\t\t\t\t),\n\t\t\t\tcolumns: this.SetColumns(data.header, data.footer, data.marks),\n\t\t\t\t$ready: 1,\n\t\t\t};\n\t\t}\n\n\t\tconst table = this.$$(\"data\");\n\t\ttable.clearAll();\n\t\ttable.define({ leftSplit, rightSplit }, true);\n\t\ttable.refreshColumns(data.columns);\n\t\ttable.parse(data.data);\n\t}\n\t/**\n\t * Prepares table item (updates id, adds total cols, etc.)\n\t * @param {Array} obj - data item\n\t * @param {Array} total - array with total values for columns\n\t * @param {Object} index - current total index\n\t * @param {number} lastId - last column id\n\t * @returns {Proxy} prepared item\n\t */\n\t_prepareData(obj, total, index, lastId) {\n\t\tconst table = this.State.mode == \"table\";\n\t\tlet totalIndex;\n\n\t\tif (table || (total && !obj.data)) totalIndex = index.i++;\n\n\t\tconst item = new Proxy(obj, {\n\t\t\tget: (item, prop) => {\n\t\t\t\tif (prop == \"data\") return item.vals;\n\t\t\t\tif (table && prop == \"id\") return totalIndex + 1;\n\n\t\t\t\tconst id = prop * 1;\n\t\t\t\tif (!isNaN(id)) {\n\t\t\t\t\tconst vals = typeof item.values == \"object\" ? item.values : item;\n\n\t\t\t\t\tif (total && id > lastId && (totalIndex || totalIndex === 0)) {\n\t\t\t\t\t\treturn total[totalIndex][id - lastId - 1];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn vals[id - 1];\n\t\t\t\t}\n\n\t\t\t\treturn item[prop];\n\t\t\t},\n\t\t});\n\n\t\tif (obj.data) {\n\t\t\titem.open = true;\n\t\t\titem.vals = obj.data.map(r => {\n\t\t\t\treturn this._prepareData(r, total, index, lastId);\n\t\t\t});\n\t\t}\n\n\t\treturn item;\n\t}\n\t/**\n\t * Checks if columns should be frozen\n\t */\n\tCheckFreeze() {\n\t\tconst freezeColumns = this.app.config.freezeColumns;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\treturn webix.isUndefined(freezeColumns) ? !compact : freezeColumns;\n\t}\n\t/**\n\t * Prepares table columns\n\t * @param {Array} columns - array with columns\n\t * @param {Array} footer - array with total values for columns\n\t * @param {Array} marks - array with min/max marks for columns\n\t * @returns {Array} column configurations\n\t */\n\tSetColumns(columns, footer, marks) {\n\t\tcolumns = webix.copy(columns);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst rows = this.State.structure.rows.length;\n\t\tconst left = this.State.mode == \"table\" ? rows : rows ? 1 : 0;\n\n\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\tif (i < left) {\n\t\t\t\tthis.SetFirstColumn(columns[i], !i && this.State.datatable.footer, _);\n\t\t\t} else {\n\t\t\t\tcolumns[i].sort = \"int\";\n\n\t\t\t\tif (!columns[i].format) columns[i].format = this.CellFormat;\n\n\t\t\t\tif (marks.length)\n\t\t\t\t\tcolumns[i].cssFormat = (v, row, rid, cid) => {\n\t\t\t\t\t\tconst col = marks[rid - 1];\n\t\t\t\t\t\tconst css = col ? col[cid - 1] : null;\n\t\t\t\t\t\treturn css ? css.join(\" \") : \"\";\n\t\t\t\t\t};\n\n\t\t\t\tconst header = columns[i].header;\n\t\t\t\tfor (let j = 0; j < header.length; j++) {\n\t\t\t\t\tlet h = header[j];\n\t\t\t\t\tif (h) {\n\t\t\t\t\t\tif (!j && h.name == \"total\") {\n\t\t\t\t\t\t\th.text = _(\"Total\");\n\t\t\t\t\t\t} else if (j == header.length - 1) {\n\t\t\t\t\t\t\th.text = this.HeaderTemplate(h, _);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (footer.length) {\n\t\t\t\t\tcolumns[i].footer = this.CellFormat(footer[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn columns;\n\t}\n\t/**\n\t * Prepares first column\n\t * @param {Object} column - column configuration\n\t * @param {boolean} footer - column with footer name\n\t * @param {function} _ - function for translating text labels\n\t */\n\tSetFirstColumn(column, footer, _) {\n\t\tif (this.State.mode == \"tree\") {\n\t\t\tcolumn.header = {\n\t\t\t\ttext: this.State.structure.rows\n\t\t\t\t\t.map(field => this.Local.getField(field).value)\n\t\t\t\t\t.join(\"<span class='webix_icon wxi-angle-right'></span>\"),\n\t\t\t\tcss: \"webix_pivot_tree_header\",\n\t\t\t};\n\t\t\tcolumn.width = 300;\n\t\t\tcolumn.template = (obj, common) => {\n\t\t\t\treturn common.treetable(obj, common) + obj[1];\n\t\t\t};\n\t\t} else {\n\t\t\tcolumn.header = this.Local.getField(column.header[0].text).value;\n\t\t\tcolumn.width = 200;\n\t\t}\n\t\tif (footer) column.footer = _(\"Total\");\n\t}\n\t/**\n\t * Sets a template for column header\n\t * @param {Object} line - object with header line properties\n\t * @param {function} _ - function for translating text labels\n\t * @returns {string} string with header text\n\t */\n\tHeaderTemplate(line, _) {\n\t\tif (!line.operation || line.operation == \"complex\")\n\t\t\treturn this.Local.fixMath(line.text);\n\t\telse {\n\t\t\tlet text = line.text.split(\",\");\n\t\t\ttext = text.map(t => this.Local.getField(t).value).join(\", \");\n\t\t\treturn `${text} <span class=\"webix_pivot_operation\">${_(\n\t\t\t\tline.operation\n\t\t\t)}</span>`;\n\t\t}\n\t}\n\t/**\n\t * Formats a cell value\n\t * @param {(number|string)} value - raw value\n\t * @returns {(number|string)} formatted value\n\t */\n\tCellFormat(value) {\n\t\tif (!value) value = value === 0 ? \"0\" : \"\";\n\n\t\treturn value ? parseFloat(value).toFixed(3) : value;\n\t}\n}\n","const asc = (a, b) => (a.key > b.key ? 1 : -1);\nconst desc = (a, b) => (a.key < b.key ? 1 : -1);\nclass DataDimension {\n    constructor(table, getValue, label, meta, sort) {\n        if (sort === \"desc\") {\n            this._sort = desc;\n        }\n        else if (sort === \"asc\") {\n            this._sort = asc;\n        }\n        else if (sort) {\n            this._sort = (a, b) => sort(a.key, b.key);\n        }\n        this._label = label;\n        this._meta = meta || null;\n        this._table = table;\n        this._getter = getValue;\n        this._prepared = 0;\n    }\n    getIndexes() {\n        return this._indexes;\n    }\n    getValue(i) {\n        return this._values[i].key;\n    }\n    getSize() {\n        return this._values.length;\n    }\n    getLabel() {\n        return this._label;\n    }\n    getOptions() {\n        this._prepareOptions();\n        return this._values.map(a => a.key);\n    }\n    getMeta() {\n        return this._meta;\n    }\n    reset() {\n        this._prepared = 0;\n    }\n    prepare() {\n        // eslint-disable-next-line\n        if (this._prepared & 1)\n            return;\n        // eslint-disable-next-line\n        this._prepared = this._prepared | 1;\n        this._prepareOptions();\n        const { _table, _getter, _keys } = this;\n        const fSize = _table.count();\n        this._values.forEach((a, i) => (a.index = i));\n        const indexes = (this._indexes = new Array(fSize));\n        for (let i = 0; i < fSize; i++) {\n            const key = _getter(i);\n            indexes[i] = _keys.get(key).index;\n        }\n    }\n    _prepareOptions() {\n        // eslint-disable-next-line\n        if (this._prepared & 2)\n            return;\n        // eslint-disable-next-line\n        this._prepared = this._prepared | 2;\n        const { _table, _getter } = this;\n        const fSize = _table.count();\n        const keys = (this._keys = new Map());\n        const values = (this._values = []);\n        for (let i = 0; i < fSize; i++) {\n            const key = _getter(i);\n            const index = keys.get(key);\n            if (typeof index === \"undefined\") {\n                keys.set(key, (values[values.length] = { key, index: 0 }));\n            }\n        }\n        if (this._sort)\n            values.sort(this._sort);\n    }\n}\n\nclass DataExport {\n    constructor(pivot) {\n        this._pivot = pivot;\n    }\n    toArray({ cleanRows, filters, ops }) {\n        const out = [];\n        const limit = this._pivot.getLimit();\n        const maxRow = limit.rows || 0;\n        this._pivot.filter(filters);\n        this._pivot.operations(ops);\n        this._pivot.resetCursor();\n        let count = 0;\n        const header = new Set();\n        const rAggr = new Map();\n        const rowData = [];\n        // eslint-disable-next-line\n        while (true) {\n            const cAggr = {};\n            const row = this._pivot.next(header, out.length, rAggr, cAggr);\n            if (!row)\n                break;\n            out.push(row);\n            rowData.push(cAggr);\n            count++;\n            if (maxRow === count)\n                break;\n        }\n        const [scaleWidth, width] = this._pivot.getWidth();\n        if (cleanRows)\n            this._cleanRows(out, scaleWidth);\n        const result = {\n            data: out,\n            columns: Array.from(header).sort((a, b) => (a > b ? 1 : -1)),\n            width: width + scaleWidth,\n            scaleWidth,\n            rowData,\n        };\n        result.columnData = this._pivot.aggregateColumns(result, rAggr);\n        result.marks = this._pivot.mark(result, rAggr);\n        return result;\n    }\n    toNested({ filters, ops }) {\n        this._pivot.filter(filters);\n        this._pivot.operations(ops);\n        this._pivot.resetCursor();\n        const rAggr = new Map();\n        const result = this._pivot.nested(rAggr);\n        result.columnData = this._pivot.aggregateColumns(result, rAggr);\n        result.marks = this._pivot.mark(result, rAggr);\n        return result;\n    }\n    toXHeader(data, config) {\n        return this._pivot.getXHeader(data, config);\n    }\n    _cleanRows(data, rowsLength) {\n        const count = data.length;\n        const prev = new Array(rowsLength);\n        for (let j = 0; j < count; j++) {\n            const row = data[j];\n            for (let i = 0; i < rowsLength; i++) {\n                if (prev[i] !== row[i]) {\n                    for (let j = i; j < rowsLength; j++)\n                        prev[j] = row[j];\n                    break;\n                }\n                row[i] = \"\";\n            }\n        }\n    }\n}\n\nfunction t(t,e){let n=\"\";const o=t.length;let r=0,i=!1,s=!1,u=0;for(;r<o;){const o=t[r];if(r++,'\"'===o)i?n+=t.substr(u,r-u):u=r-1,i=!i;else {if(i)continue;const c=\",\"===o||\"/\"===o||\"*\"===o||\"+\"===o||\"-\"===o||\"(\"===o||\")\"===o,f=\" \"===o||\"\\t\"===o||\" \\n\"===o||\"\\r\"===o;if(s){if(!c&&!f)continue;{const i=t.substr(u,r-u-1);n+=\"(\"===o?e.method(i):e.property(i),s=!1;}}if(f)continue;if(c)n+=o;else {\"0\"===o||\"1\"===o||\"2\"===o||\"3\"===o||\"4\"===o||\"5\"===o||\"6\"===o||\"7\"===o||\"8\"===o||\"9\"===o?n+=o:(s=!0,u=r-1);}}}return s&&(n+=e.property(t.substr(u,r-u))),n}function e(e,n){return new Function(n.propertyName,n.methodName,n.contextName,\"return \"+t(e,n))}\n\nfunction optimize(table, order, code, allMath) {\n    const math = getMath(table, code);\n    const ctx = {\n        table,\n        order,\n        from: 0,\n        to: 0,\n        array: (i, c) => {\n            const size = c.to - c.from;\n            const temp = new Array(size);\n            const getter = cache[i];\n            for (let j = 0; j < size; j++) {\n                temp[j] = getter(c.order[j + c.from]);\n            }\n            return temp;\n        },\n    };\n    return function (from, to) {\n        ctx.from = from;\n        ctx.to = to;\n        return math(0, allMath, ctx);\n    };\n}\nfunction optimizeRangeGroup(table, order, code, allMath) {\n    const math = getMath(table, code);\n    const ctx = {\n        table,\n        order,\n        range: [],\n        array: (i, c) => {\n            const size = ctx.range.length;\n            const temp = [];\n            const getter = cache[i];\n            for (let j = 0; j < size; j += 2) {\n                const from = ctx.range[j];\n                const to = ctx.range[j + 1];\n                for (let i = from; i < to; i++) {\n                    temp.push(getter(c.order[i]));\n                }\n            }\n            return temp;\n        },\n    };\n    return function (range) {\n        ctx.range = range;\n        return math(0, allMath, ctx);\n    };\n}\nfunction optimizeGroup(code, allMath) {\n    const math = getGroupMath(code);\n    return function (v) {\n        return math(v, allMath, null);\n    };\n}\nlet id = 0;\nconst cache = [];\nfunction getMath(table, rule) {\n    return e(rule, {\n        propertyName: \"d\",\n        methodName: \"m\",\n        contextName: \"c\",\n        property: (a) => {\n            const i = id;\n            cache[i] = table.getColumn(a).getter;\n            id += 1;\n            return `c.array(\"${i}\", c)`;\n        },\n        method: (a) => {\n            return `m.${a.toLowerCase()}`;\n        },\n    });\n}\nfunction getGroupMath(rule) {\n    return e(rule, {\n        propertyName: \"d\",\n        methodName: \"m\",\n        contextName: \"c\",\n        property: () => {\n            return `d`;\n        },\n        method: (a) => {\n            return `m.${a.toLowerCase()}`;\n        },\n    });\n}\n\nconst and = (a, b) => c => a(c) && b(c);\nfunction buildFinder(data, key, value, context) {\n    const getValue = context.getter(data, key);\n    if (typeof value !== \"object\") {\n        const check = context.compare[\"eq\"](value);\n        return i => check(getValue(i));\n    }\n    else {\n        const ops = Object.keys(value);\n        let result = null;\n        for (let i = 0; i < ops.length; i++) {\n            const check = context.compare[ops[i].toLowerCase()](value[ops[i]]);\n            const step = i => check(getValue(i));\n            result = result ? and(result, step) : step;\n        }\n        return result;\n    }\n}\nfunction build(table, rule, context) {\n    const keys = Object.keys(rule);\n    let result = null;\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        const step = buildFinder(table, key, rule[key], context);\n        result = result ? and(result, step) : step;\n    }\n    return result;\n}\nfunction filter(order, table, rule, context) {\n    const filter = build(table, rule, context);\n    return order.filter(n => filter(n));\n}\n\nclass DataPivot {\n    constructor(table, rows, cols, filters, config) {\n        this._rows = rows;\n        this._cols = cols;\n        this._dims = rows.concat(cols);\n        this._table = table;\n        this._context = config;\n        this._cursor = -1;\n        this._order = this._base_order = this._sort();\n        this._data = this._dims.map(a => a.getIndexes());\n        this.filter(filters, true);\n    }\n    resetCursor() {\n        this._cursor = 0;\n        this._group = this._dims.map(() => null);\n        if (this._order.length) {\n            if (this._rows.length)\n                this._nextRow();\n            if (this._cols.length)\n                this._nextColumn();\n        }\n    }\n    next(header, index, rAggr, cAggr) {\n        const { _cursor, _cols, _order, _group, _ops, _rows } = this;\n        if (this._cursor >= _order.length)\n            return null;\n        const dimsSize = _rows.length;\n        const out = new Array(dimsSize + _ops.length * _cols.length);\n        // dimensions\n        for (let i = 0; i < dimsSize; i++)\n            out[i] = _rows[i].getValue(_group[i]);\n        // get end of next line ( all dataset for columns mode )\n        const to = this._rows.length\n            ? this._nextRow(_cols.length > 0)\n            : _order.length;\n        this._fillRow(out, index, _cursor, to, dimsSize, header, rAggr, cAggr);\n        this._cursor = to;\n        return out;\n    }\n    nested(rAggr) {\n        const { _cols, _order, _rows } = this;\n        const header = new Set();\n        const dimSize = _rows.length;\n        const dimOutSize = dimSize > 0 ? 1 : 0;\n        const levels = [{ data: [], values: [] }];\n        const data = [];\n        let prev = [];\n        let now = [];\n        let from = this._cursor;\n        let count = 0;\n        const { _groupOps } = this;\n        const _groupLength = [{}].concat(_rows.map(() => ({})));\n        const rowData = [];\n        const limit = this._context.limit.rows;\n        const width = Math.min(this._context.limit.columns, (_cols.length ? this._sizes[0] * _cols[0].getSize() : 0) + dimOutSize);\n        const closeLevels = function (j) {\n            // ignore not created, during first iteration\n            if (!levels[j])\n                return;\n            // each sub-level\n            for (; j < dimSize; j++) {\n                // get all known columns\n                for (const [kAgr, vAgr] of rAggr) {\n                    // get start of related rows\n                    const prev = _groupLength[j][kAgr] || 0;\n                    // if have new rows\n                    if (prev === 0 || vAgr.length > prev) {\n                        // check and calcualte op\n                        for (let z = 0; z < _groupOps.length; z++) {\n                            const math = _groupOps[z];\n                            if (math) {\n                                levels[j].values[dimOutSize + kAgr + z] = math(vAgr.slice(prev + 1));\n                                _groupLength[j][kAgr] = vAgr.length - 1;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        while (this._cursor < _order.length) {\n            const out = new Array(width);\n            prev = now;\n            now = [].concat(this._group);\n            // get end of next line ( all dataset for columns mode )\n            const to = this._rows.length\n                ? this._nextRow(_cols.length > 0)\n                : _order.length;\n            // calculate finished branches\n            if (_groupOps !== null) {\n                for (let level = 0; level < dimSize; level++) {\n                    // find level at which route differs\n                    if (now[level] != prev[level]) {\n                        closeLevels(level + 1);\n                        break;\n                    }\n                }\n            }\n            const cAggr = {};\n            this._fillRow(out, data.length, from, to, dimOutSize, header, rAggr, cAggr);\n            rowData.push(cAggr);\n            // if we have row-dimensions\n            if (dimSize > 0) {\n                for (let level = 0; level < dimSize; level++) {\n                    // find level at which route differs\n                    if (now[level] != prev[level]) {\n                        // starting from that level and below\n                        for (let j = level; j < dimSize; j++) {\n                            const index = j + 1;\n                            const last = index === dimSize;\n                            // create new nodes\n                            const obj = (levels[index] = {\n                                id: last ? data.length + 1 : 0,\n                                data: last ? null : [],\n                                values: last ? out : [_rows[j].getValue(now[j])],\n                            });\n                            // store node in the parents branch\n                            levels[j].data.push(obj);\n                        }\n                        break;\n                    }\n                }\n                // store scale value in the first cell of the new row\n                out[0] = _rows[dimSize - 1].getValue(now[dimSize - 1]);\n                // store value line of the pivot ( leaf of the tree )\n                levels[dimSize].values = out;\n            }\n            else {\n                // if we have not row-dimensions, store plain data only\n                levels[0].data.push({ data: null, values: out });\n            }\n            data.push(out);\n            count++;\n            if (count >= limit)\n                break;\n            this._cursor = from = to;\n        }\n        if (_groupOps !== null) {\n            closeLevels(1);\n        }\n        const columns = Array.from(header).sort((a, b) => (a > b ? 1 : -1));\n        const result = {\n            tree: levels[0].data,\n            data,\n            width,\n            scaleWidth: dimOutSize,\n            columns,\n            rowData,\n        };\n        this._fillGroupRow(levels[0], result, rAggr, _rows.length - 1);\n        return result;\n    }\n    getLimit() {\n        return this._context.limit;\n    }\n    getWidth() {\n        return [\n            this._rows.length,\n            this._cols.length && this._ops.length\n                ? this._cols[0].getSize() * this._sizes[0]\n                : 0,\n            this._ops.length,\n        ];\n    }\n    getXHeader(result, hConfig) {\n        const { _cols, _rows, _ops, _opInfo } = this;\n        const { nonEmpty, meta } = hConfig || {};\n        const isNested = result.tree;\n        // compressed line\n        const line = [];\n        // rows prefix\n        const rpref = result.tree ? Math.min(_rows.length, 1) : _rows.length;\n        // count of operations, repeat step of bottom scale\n        const ostep = _ops.length;\n        // how many scale units in one parent\n        const unitsInParent = _cols.map(a => a.getSize());\n        // calculate full width of data\n        const length = unitsInParent.reduce((prev, value) => prev * value, ostep);\n        const columns = result.columns;\n        const fullLength = rpref +\n            Math.min(nonEmpty ? columns.length * ostep : length, this._context.limit.columns);\n        // how many data points per unit\n        let temp = length;\n        const unitSizes = unitsInParent.map(a => (temp = temp / a));\n        // result header\n        const out = [];\n        this._cols.forEach(() => out.push(new Array(fullLength)));\n        // build compressed order\n        if (nonEmpty) {\n            //check all cells, include columns of cells with data\n            for (let i = 0; i < rpref; i++)\n                line.push(i);\n            for (let j = 0; j < columns.length; j++) {\n                const base = rpref + columns[j];\n                for (let i = 0; i < ostep; i++)\n                    line.push(base + i);\n            }\n            // now check each scale line\n            for (let j = 0; j < _cols.length; j++) {\n                const step = unitSizes[j];\n                let start = -1;\n                let end = 0;\n                let colspan = 0;\n                let text;\n                // against each non-empty column\n                for (let i = rpref; i < line.length; i += ostep) {\n                    const test = line[i];\n                    // if we inside of span\n                    if (test < end) {\n                        colspan += ostep;\n                    }\n                    else {\n                        // we have reached the new span\n                        // setting old one if any\n                        if (colspan !== 0) {\n                            out[j][start] = { colspan, text };\n                        }\n                        // store position of new span\n                        const ind = Math.floor((test - rpref) / step);\n                        start = i;\n                        end = (ind + 1) * step + rpref;\n                        colspan = ostep;\n                        // store related text\n                        text = _cols[j].getValue(ind % unitsInParent[j]);\n                    }\n                }\n                // setting last span\n                if (colspan !== 0)\n                    out[j][start] = { colspan, text };\n            }\n        }\n        else {\n            // for each scale\n            for (let i = 0; i < _cols.length; i++) {\n                const size = unitsInParent[i];\n                const step = unitSizes[i];\n                let ind = 0;\n                // set value at n-th cell\n                for (let j = rpref; j < fullLength; j += step) {\n                    if (step === 1) {\n                        out[i][j] = _cols[i].getValue(ind++);\n                    }\n                    else {\n                        out[i][j] = { text: _cols[i].getValue(ind++), colspan: step };\n                    }\n                    // repeat dimension values\n                    if (ind >= size)\n                        ind = 0;\n                }\n            }\n        }\n        // add bottom line, with operations\n        if (this._ops) {\n            const opNames = new Array(fullLength);\n            const step = _ops.length;\n            for (let j = rpref; j < fullLength; j += step)\n                for (let z = 0; z < step; z++)\n                    opNames[j + z] = _opInfo[z].label;\n            out.push(opNames);\n        }\n        // prepend row labels\n        for (let i = 0; i < rpref; i++) {\n            const rowspan = _cols.length + (this._ops ? 1 : 0);\n            if (isNested) {\n                out[0][0] = { text: \"\", rowspan };\n                break;\n            }\n            const text = _rows[i].getLabel();\n            out[0][i] = rowspan > 1 ? { text, rowspan } : text;\n        }\n        const res = { data: out };\n        // add compression line to output\n        if (nonEmpty)\n            res.nonEmpty = line;\n        if (meta) {\n            const metaLine = new Array(fullLength);\n            for (let i = 0; i < rpref; i++)\n                metaLine[i] = _rows[i].getMeta();\n            const step = _ops.length;\n            for (let j = rpref; j < fullLength; j += step)\n                for (let z = 0; z < step; z++)\n                    metaLine[j + z] = _opInfo[z].meta;\n            res.meta = metaLine;\n        }\n        return res;\n    }\n    filter(rules, master) {\n        if (!rules || Object.keys(rules).length === 0) {\n            if (!master && this._masterRules)\n                rules = Object.assign(Object.assign({}, this._masterRules), rules);\n            else {\n                this._order = this._base_order;\n                return;\n            }\n        }\n        if (master)\n            this._masterRules = rules;\n        this._order = filter(this._base_order, this._table, rules, this._context);\n    }\n    operations(ops) {\n        const { _table, _order, _context } = this;\n        ops = ops || [];\n        this._ops = ops.map(p => optimize(_table, _order, typeof p === \"string\" ? p : p.math, _context.math));\n        this._groupResultOps = ops.map(p => p.branchMode === \"result\"\n            ? optimizeGroup(typeof p === \"string\" ? p : p.branchMath || p.math, _context.math)\n            : null);\n        if (!this._groupResultOps.find(a => a !== null))\n            this._groupResultOps = null;\n        this._groupOps = ops.map(p => p.branchMode === \"raw\"\n            ? optimizeRangeGroup(_table, _order, typeof p === \"string\" ? p : p.branchMath || p.math, _context.math)\n            : null);\n        if (!this._groupOps.find(a => a !== null))\n            this._groupOps = null;\n        this._opInfo = ops.map(p => {\n            if (typeof p === \"string\") {\n                return { label: p, math: p };\n            }\n            else {\n                return Object.assign(Object.assign({}, p), { label: p.label || p.math });\n            }\n        });\n        this._rowResultOps = compactOps(ops, \"row\", \"result\", (x, name) => ({\n            name,\n            op: optimizeGroup(x, _context.math),\n        }));\n        this._rowOps = compactOps(ops, \"row\", \"raw\", (x, name) => ({\n            name,\n            op: optimize(_table, _order, x, _context.math),\n        }));\n        this._colResultOps = compactOps(ops, \"column\", \"result\", (x, name) => ({\n            name,\n            op: optimizeGroup(x, _context.math),\n        }));\n        this._colOps = compactOps(ops, \"column\", \"raw\", (x, name) => ({\n            name,\n            op: optimizeRangeGroup(_table, _order, x, _context.math),\n        }));\n        this._marks = ops.map(a => a.marks || null);\n        if (!this._marks.find(a => a !== null))\n            this._marks = null;\n        this._setSizes();\n    }\n    aggregateColumns(result, rAggr) {\n        const { _colOps, _colResultOps } = this;\n        const { columns, data, scaleWidth } = result;\n        if (!_colOps && !_colResultOps)\n            return [];\n        const step = this._ops.length;\n        const out = [];\n        for (let i = 0; i < columns.length; i++) {\n            const ind = columns[i];\n            const dmr = rAggr.get(ind);\n            if (!dmr)\n                continue;\n            const keys = Array.from(dmr[0].keys());\n            for (let j = 0; j < step; j++) {\n                const column = {};\n                if (_colResultOps) {\n                    const op = _colResultOps[j];\n                    if (op) {\n                        const values = keys.map(a => data[a][ind + j + scaleWidth]);\n                        op.forEach(x => (column[x.name] = x.op(values)));\n                    }\n                }\n                if (_colOps) {\n                    const op = _colOps[j];\n                    if (op) {\n                        op.forEach(x => (column[x.name] = x.op(dmr.slice(1))));\n                    }\n                }\n                out[scaleWidth + ind + j] = column;\n            }\n        }\n        return out;\n    }\n    _optimizeGroup(ops) {\n        const config = {};\n        let exit = true;\n        for (const key in ops) {\n            const test = ops[key];\n            config[key] = optimizeGroup(test, this._context.math);\n            exit = false;\n        }\n        return exit ? null : config;\n    }\n    mark(result, rAggr) {\n        const out = [];\n        const { _marks, _ops } = this;\n        if (!_marks)\n            return out;\n        const opsLength = _ops.length;\n        const { scaleWidth, data, columnData, rowData } = result;\n        for (const [k, v] of rAggr) {\n            const r = v[0];\n            for (let i = 0; i < opsLength; i++) {\n                const marks = this._marks[i];\n                if (marks === null)\n                    continue;\n                for (const z of r) {\n                    const cid = k + i + scaleWidth;\n                    const rid = z;\n                    const cell = [];\n                    for (let j = 0; j < marks.length; j++) {\n                        if (marks[j].check(data[rid][cid], columnData[cid] || {}, rowData[rid] || {}))\n                            cell.push(marks[j].name);\n                    }\n                    if (cell.length) {\n                        let rarr = out[rid];\n                        if (typeof rarr === \"undefined\")\n                            rarr = out[rid] = [];\n                        rarr[cid] = cell;\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    __getHeaderStub() {\n        return {};\n    }\n    _fillGroupRow(obj, result, rAggr, level) {\n        const { _groupResultOps } = this;\n        const { columns, scaleWidth } = result;\n        if (_groupResultOps) {\n            for (let i = 0; i < columns.length; i++) {\n                const ind = columns[i];\n                for (let j = 0; j < _groupResultOps.length; j++) {\n                    const op = _groupResultOps[j];\n                    if (!op)\n                        continue;\n                    if (level > 0)\n                        this._fillGroupRowInner(obj, op, ind + j + scaleWidth, level);\n                }\n            }\n        }\n    }\n    _fillGroupRowInner(obj, op, ind, level) {\n        const arr = [];\n        if (level > 0) {\n            obj.data.forEach(a => {\n                const res = this._fillGroupRowInner(a, op, ind, level - 1);\n                if (res !== null) {\n                    arr.push(res);\n                }\n            });\n        }\n        else {\n            for (let i = 0; i < obj.data.length; i++) {\n                const test = obj.data[i].values[ind];\n                if (typeof test !== \"undefined\")\n                    arr.push(test);\n            }\n        }\n        if (arr.length)\n            return (obj.values[ind] = op(arr));\n        return null;\n    }\n    _fillRow(out, index, from, to, dimsSize, header, rAggr, cAggr) {\n        const { _cols, _group, _ops, _sizes, _rows, _rowResultOps, _rowOps } = this;\n        const rl = _rows.length;\n        const collectRaggr = this._colResultOps !== null ||\n            this._colOps !== null ||\n            this._marks !== null;\n        let ctemp = [];\n        if (_rowResultOps !== null)\n            ctemp = _rowResultOps.map(() => []);\n        // calculations\n        if (_ops.length) {\n            if (_cols.length) {\n                let cfrom = from;\n                while (cfrom < to) {\n                    let cind = 0;\n                    for (let i = 0; i < _cols.length; i++)\n                        cind += _sizes[i] * _group[rl + i];\n                    const cto = this._nextColumn();\n                    for (let i = 0; i < _ops.length; i++) {\n                        const temp = (out[cind + dimsSize + i] = _ops[i](cfrom, cto));\n                        if (_rowResultOps !== null)\n                            ctemp[i].push(temp);\n                    }\n                    if (collectRaggr) {\n                        let arr = rAggr.get(cind);\n                        if (!arr)\n                            rAggr.set(cind, (arr = [new Set(), cfrom, cto]));\n                        else\n                            arr.push(cfrom, cto);\n                        arr[0].add(index);\n                    }\n                    header.add(cind);\n                    this._cursor = cfrom = cto;\n                }\n            }\n            else {\n                for (let i = 0; i < _ops.length; i++) {\n                    out[i + dimsSize] = _ops[i](from, to);\n                }\n                if (collectRaggr) {\n                    let arr = rAggr.get(0);\n                    if (!arr)\n                        rAggr.set(0, (arr = [new Set(), from, to]));\n                    else\n                        arr.push(from, to);\n                    arr[0].add(index);\n                }\n                header.add(0);\n            }\n        }\n        if (_rowResultOps !== null) {\n            _rowResultOps.forEach((opset, i) => {\n                const dataset = ctemp[i];\n                if (opset && dataset.length)\n                    opset.forEach(op => {\n                        cAggr[op.name] = op.op(ctemp[i]);\n                    });\n            });\n        }\n        if (_rowOps !== null) {\n            _rowOps.forEach(opset => {\n                opset === null || opset === void 0 ? void 0 : opset.forEach(op => {\n                    cAggr[op.name] = op.op(from, to);\n                });\n            });\n        }\n    }\n    _sort() {\n        const { _table, _dims } = this;\n        const size = Math.min(_table.count(), this._context.limit.raws);\n        const order = new Array(size);\n        for (let i = 0; i < size; i++) {\n            order[i] = i;\n        }\n        const dimsSize = _dims.length;\n        const dimsData = _dims.map(a => a.getIndexes());\n        order.sort((a, b) => {\n            for (let j = 0; j < dimsSize; j++) {\n                const left = dimsData[j][a];\n                const right = dimsData[j][b];\n                if (left > right)\n                    return 1;\n                if (left < right)\n                    return -1;\n            }\n            return 0;\n        });\n        return order;\n    }\n    _nextRow(silent) {\n        const { _data, _order, _group, _rows } = this;\n        const dimsSize = _rows.length;\n        let ok = true;\n        let to = this._cursor;\n        // eslint-disable-next-line\n        while (true) {\n            const ind = _order[to];\n            for (let i = 0; i < dimsSize; i++) {\n                if (_data[i][ind] != _group[i]) {\n                    if (!silent)\n                        _group[i] = _data[i][ind];\n                    ok = false;\n                }\n            }\n            if (!ok)\n                break;\n            to++;\n        }\n        return to;\n    }\n    _nextColumn() {\n        const { _data, _order, _group, _rows, _cols } = this;\n        const dimsSize = _cols.length + _rows.length;\n        let ok = true;\n        let to = this._cursor;\n        // eslint-disable-next-line\n        while (true) {\n            const ind = _order[to];\n            for (let i = 0; i < dimsSize; i++) {\n                if (_data[i][ind] != _group[i]) {\n                    _group[i] = _data[i][ind];\n                    ok = false;\n                }\n            }\n            if (!ok)\n                break;\n            to++;\n        }\n        return to;\n    }\n    _setSizes() {\n        const sizes = this._cols.map(a => a.getSize());\n        let sum = this._ops.length || 1;\n        for (let i = sizes.length - 1; i >= 0; i--) {\n            const now = sum;\n            sum *= sizes[i];\n            sizes[i] = now;\n        }\n        this._sizes = sizes;\n    }\n}\nfunction compactOps(ops, kind, mode, optimizer) {\n    const result = ops.map(p => {\n        const row = p[kind];\n        if (!row)\n            return null;\n        const out = row\n            .map(op => {\n            const source = op.source || \"raw\";\n            if (source === mode)\n                if (typeof op === \"string\")\n                    return optimizer(op, getName(op));\n                else\n                    return optimizer(op.math, op.as || getName(op.math));\n            return null;\n        })\n            .filter(a => a !== null);\n        if (!out.length)\n            return null;\n        return out;\n    });\n    if (!result.find(a => !!a))\n        return null;\n    return result;\n}\nfunction getName(x) {\n    const end = x.indexOf(\"(\");\n    if (end === -1)\n        return x.trim();\n    return x.substring(0, end).trim();\n}\n\nclass RawTable {\n    constructor(config) {\n        this._columns = config.fields;\n        this.parse(config.data);\n    }\n    parse(data) {\n        this._raw = data;\n        this._parse_inner();\n    }\n    prepare() {\n        if (this._prepared)\n            return;\n        this._prepared = true;\n        const data = this._raw;\n        const fields = this._columns;\n        const cols = fields.filter(a => a.type === 3);\n        if (!data || !cols.length)\n            return;\n        const dataLength = data.length;\n        const columnsLength = cols.length;\n        for (let i = 0; i < dataLength; i++) {\n            for (let j = 0; j < columnsLength; j++) {\n                const col = cols[j];\n                const text = col.getter(i);\n                if (typeof text === \"string\")\n                    col.setter(i, new Date(text));\n            }\n        }\n    }\n    _parse_inner() {\n        this._columns.forEach(a => {\n            const key = a.id;\n            a.getter = i => this._raw[i][key];\n            a.setter = (i, v) => (this._raw[i][key] = v);\n        });\n    }\n    getColumn(id) {\n        return this._columns.find(a => a.id === id);\n    }\n    count() {\n        return this._raw.length;\n    }\n}\n\nclass ColumnTable extends RawTable {\n    parse(data) {\n        this._parse_init(data.length);\n        const dataLength = data.length;\n        const columnsLength = this._columns.length;\n        for (let i = 0; i < dataLength; i++) {\n            const obj = data[i];\n            for (let j = 0; j < columnsLength; j++) {\n                const col = this._columns[j];\n                col.data[i] = obj[col.id];\n            }\n        }\n    }\n    _parse_init(n) {\n        this._columns.forEach(a => {\n            const data = (a.data = new Array(n));\n            a.getter = i => data[i];\n            a.setter = (i, v) => (data[i] = v);\n        });\n    }\n    count() {\n        return this._columns[0].data.length;\n    }\n}\n\nconst methods = {\n    round: (v) => Math.round(v),\n    sum: (arr) => arr.reduce((acc, a) => acc + a, 0),\n    min: (arr) => arr.reduce((acc, a) => (a < acc ? a : acc), arr.length ? arr[0] : 0),\n    max: (arr) => arr.reduce((acc, a) => (a > acc ? a : acc), arr.length ? arr[0] : 0),\n    avg: (arr) => arr.length ? arr.reduce((acc, a) => acc + a, 0) / arr.length : 0,\n    wavg: (arr, w) => {\n        if (!arr.length)\n            return 0;\n        let count = 0;\n        let summ = 0;\n        for (let i = arr.length - 1; i >= 0; i--) {\n            count += w[i];\n            summ += arr[i] * w[i];\n        }\n        return summ / count;\n    },\n    count: (arr) => arr.length,\n    any: (arr) => (arr.length ? arr[0] : null),\n};\nconst filters = {\n    eq: (v) => (x) => x == v,\n    neq: (v) => (x) => x != v,\n    gt: (v) => (x) => x > v,\n    gte: (v) => (x) => x >= v,\n    lt: (v) => (x) => x < v,\n    lte: (v) => (x) => x <= v,\n    in: (v) => (x) => v[x],\n    hasPrefix: (v) => (x) => x.indexOf(v) === 0,\n    contains: (v) => (x) => x.indexOf(v) !== -1,\n};\nconst predicates = {\n    year: (v) => v.getFullYear(),\n    month: (v) => v.getMonth(),\n    day: (v) => v.getDate(),\n    hour: (v) => v.getHours(),\n    minute: (v) => v.getMinutes(),\n};\n\nclass Analytic {\n    constructor(cfg) {\n        this._tables = {};\n        this._dimensions = {};\n        this._preds = Object.assign({}, predicates);\n        this._maths = Object.assign({}, methods);\n        this._comps = Object.assign({}, filters);\n        if (cfg && cfg.tables)\n            cfg.tables.forEach(s => this.addTable(s));\n        if (cfg && cfg.dimensions)\n            cfg.dimensions.forEach(s => this.addDimension(s));\n    }\n    addPredicate(name, code) {\n        this._preds[name.toLowerCase()] = code;\n    }\n    addMath(name, code) {\n        this._maths[name.toLowerCase()] = code;\n    }\n    addComparator(name, code) {\n        this._comps[name.toLowerCase()] = code;\n    }\n    getDimension(id) {\n        return this._dimensions[id];\n    }\n    addDimension(s) {\n        if (this._dimensions[s.id])\n            return;\n        const table = this._tables[s.table];\n        const getter = this._predicateGetter(table, s.rule.by);\n        this._dimensions[s.id] = new DataDimension(table, getter, s.label || s.id, s.meta || s, s.sort);\n    }\n    resetDimensions(s, preserve) {\n        const prev = this._dimensions;\n        this._dimensions = {};\n        if (s)\n            s.forEach(a => {\n                const used = prev[a.id];\n                if (preserve && used)\n                    this._dimensions[a.id] = used;\n                else\n                    this.addDimension(a);\n            });\n    }\n    addTable(s) {\n        const driver = (s.driver || \"raw\") === \"raw\" ? RawTable : ColumnTable;\n        const t = (this._tables[s.id] = new driver(s));\n        if (s.prepare)\n            t.prepare();\n    }\n    getTable(id) {\n        return this._tables[id];\n    }\n    compact(table, config) {\n        const { rows, cols, filters, limit } = config;\n        const base = this._tables[table];\n        const rDims = rows ? rows.map(a => this._dimensions[a]) : [];\n        const cDims = cols ? cols.map(a => this._dimensions[a]) : [];\n        [...rDims, ...cDims].forEach(a => a.prepare());\n        const pivot = new DataPivot(base, rDims, cDims, filters, {\n            getter: this._predicateGetter.bind(this),\n            math: this._maths,\n            compare: this._comps,\n            limit: Object.assign({ rows: 10000, columns: 5000, raws: Infinity }, (limit || {})),\n        });\n        return new DataExport(pivot);\n    }\n    _predicateGetter(table, key) {\n        const find = key.indexOf(\"(\");\n        if (find !== -1) {\n            const fn = this._preds[key.substr(0, find).toLowerCase()];\n            key = key.substr(find + 1, key.length - find - 2);\n            const getter = table.getColumn(key).getter;\n            return i => fn(getter(i));\n        }\n        else {\n            return table.getColumn(key).getter;\n        }\n    }\n}\n\nexport { Analytic };\n//# sourceMappingURL=rengine.es6.js.map\n","import * as rengine from \"@xbs/rengine\";\n\nexport default class LocalData {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis._app = app;\n\t\tthis._store = {}; //aggregated data\n\n\t\tthis._filtersHash = {};\n\t\tthis._state = app.getState();\n\n\t\tif (app.config.externalProcessing) this._setOperations();\n\t\telse {\n\t\t\tthis._data = [];\n\t\t\tthis._initRengine();\n\t\t}\n\t}\n\t/** Set list of avaible operations; adds custom operations from config */\n\t_setOperations() {\n\t\tthis.operations = [\n\t\t\t{ id: \"sum\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"min\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"max\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"avg\", fields: 1, branchMode: \"raw\" },\n\t\t\t{ id: \"wavg\", fields: 2, branchMode: \"raw\" },\n\t\t\t{ id: \"count\", fields: 1, branchMode: \"raw\" },\n\t\t\t{ id: \"any\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"complex\" },\n\t\t];\n\n\t\tconst config = this._app.config;\n\t\tconst extraOperations = this._app.config.operations;\n\t\tif (extraOperations) {\n\t\t\tif (config.externalProcessing)\n\t\t\t\tthis.operations = this.operations.concat(extraOperations);\n\t\t\telse\n\t\t\t\tfor (let name in extraOperations) {\n\t\t\t\t\tlet operation = extraOperations[name];\n\t\t\t\t\tlet fields, branchMode, hidden;\n\n\t\t\t\t\tif (typeof operation == \"object\") {\n\t\t\t\t\t\tfields = operation.fields || operation.handler.length;\n\t\t\t\t\t\tbranchMode = operation.branchMode;\n\t\t\t\t\t\thidden = operation.hidden;\n\t\t\t\t\t\toperation = operation.handler;\n\t\t\t\t\t} else fields = operation.length;\n\n\t\t\t\t\tthis._reng.addMath(name, operation);\n\n\t\t\t\t\tif (!hidden)\n\t\t\t\t\t\tthis.operations.push({\n\t\t\t\t\t\t\tid: name,\n\t\t\t\t\t\t\tfields,\n\t\t\t\t\t\t\tbranchMode,\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t}\n\t}\n\t/** Set list of avaible total operations */\n\t_setTotalOperations() {\n\t\tthis.totalOperations = {};\n\t\tconst totalOps = this._app.config.totalOperations;\n\n\t\tif (totalOps)\n\t\t\tfor (let name in totalOps) {\n\t\t\t\tconst op = totalOps[name];\n\t\t\t\tconst all = typeof totalOps[name] == \"string\";\n\t\t\t\t[\"footer\", \"group\", \"column\"].forEach(type => {\n\t\t\t\t\tif (all || op[type]) {\n\t\t\t\t\t\tif (!this.totalOperations[type]) this.totalOperations[type] = {};\n\t\t\t\t\t\tthis.totalOperations[type][name] = all ? op : op[type];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t}\n\t/** Sets default filter rules */\n\t_setFilters() {\n\t\tfor (let type in webix.filters) {\n\t\t\tthis._reng.addComparator(type, v => test => {\n\t\t\t\tif (type == \"date\") test = test.valueOf();\n\n\t\t\t\tif (!v) return true;\n\t\t\t\telse if (v.includes) return v.includes.indexOf(test) != -1;\n\t\t\t\telse if (!v.condition.filter) return true;\n\t\t\t\telse\n\t\t\t\t\treturn webix.filters[type][v.condition.type](\n\t\t\t\t\t\ttest,\n\t\t\t\t\t\tv.condition.filter\n\t\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\t/** Adds predicates from config */\n\t_setPredicates() {\n\t\tconst predicates = this._app.config.predicates;\n\t\tif (predicates)\n\t\t\tfor (let name in predicates)\n\t\t\t\tthis._reng.addPredicate(name, predicates[name]);\n\t}\n\t/**\n\t * Returns fields that contain data\n\t * @param {object} firstRow - first row in data\n\t * @returns {array} data fields\n\t */\n\tgetFields(firstRow) {\n\t\tlet fields = this._app.config.fields;\n\n\t\tif (!fields) {\n\t\t\tfields = [];\n\n\t\t\tfor (let i in firstRow) {\n\t\t\t\tlet type;\n\n\t\t\t\tconst dataType = typeof firstRow[i];\n\t\t\t\tswitch (dataType) {\n\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\ttype = \"text\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"number\":\n\t\t\t\t\t\ttype = dataType;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttype = \"date\";\n\t\t\t\t}\n\n\t\t\t\tfields.push({ id: i, value: i, type });\n\t\t\t}\n\t\t}\n\n\t\treturn fields;\n\t}\n\t/**\n\t * Loads data and populates store\n\t * @param {boolean} force - if true, data will be reloaded\n\t * @returns {Promise} promise that resolves with store array\n\t */\n\tgetData(force) {\n\t\tif (!force && this.useOldData())\n\t\t\treturn this._dataLoad || webix.promise.resolve(this._store);\n\n\t\tconst externalProcessing = this._app.config.externalProcessing;\n\t\tif (externalProcessing || !Object.keys(this._store).length || force) {\n\t\t\treturn (this._dataLoad = this._app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.data()\n\t\t\t\t.then(data => {\n\t\t\t\t\tif (externalProcessing)\n\t\t\t\t\t\tthis._store = this._rengineToWebix(data.result, data.header);\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._table = this.getTable(data);\n\t\t\t\t\t\tthis._reng.addTable(this._table);\n\t\t\t\t\t\tthis._store = this.getPivotData();\n\t\t\t\t\t}\n\t\t\t\t\tthis._filtersHash = {};\n\t\t\t\t\treturn this._store;\n\t\t\t\t})\n\t\t\t\t.catch(error => this.loadError(error))\n\t\t\t\t.finally(() => delete this._dataLoad));\n\t\t} else {\n\t\t\tthis._store = this.getPivotData();\n\t\t\treturn webix.promise.resolve(this._store);\n\t\t}\n\t}\n\t/** Checks if pivot should use last aggregated data **/\n\tuseOldData() {\n\t\tconst state = this._state;\n\t\tlet newConfig = `${state.mode}|${JSON.stringify(state.structure)}`;\n\t\tif (state.mode == \"chart\") {\n\t\t\tconst type = state.chart.type;\n\t\t\tnewConfig += `|${type == \"pie\" || type == \"donut\"}`;\n\t\t} else newConfig += `|${JSON.stringify(state.datatable)}`;\n\n\t\tconst refresh = this._old == newConfig;\n\t\tthis._old = newConfig;\n\t\treturn refresh;\n\t}\n\t/** Inits math module */\n\t_initRengine() {\n\t\tthis._reng = new rengine.Analytic();\n\n\t\tthis._setFilters();\n\t\tthis._setOperations();\n\t\tthis._setTotalOperations();\n\t\tthis._setPredicates();\n\t}\n\t/**\n\t * onverts data to pivot readable form\n\t * @returns {Object} object with aggregated data and its parameters\n\t */\n\tgetPivotData() {\n\t\tif (!this._table)\n\t\t\treturn {\n\t\t\t\tdata: [],\n\t\t\t\theader: [],\n\t\t\t\ttotal: [],\n\t\t\t\tmarks: [],\n\t\t\t};\n\n\t\tconst structure = this._state.structure;\n\t\tconst mode = this._state.mode;\n\t\tconst table = this._state.datatable;\n\n\t\tthis.setDimensions();\n\n\t\tconst filters = {};\n\t\tfor (let i = 0; i < structure.filters.length; i++) {\n\t\t\tconst filter = structure.filters[i];\n\n\t\t\tconst fields = this._state.fields;\n\t\t\tconst field = fields.find(field => field.id == filter.name);\n\n\t\t\tfilters[filter.name] = { [field.type]: filter.value };\n\t\t}\n\n\t\t//groups data\n\t\tconst res = this._reng.compact(this._table.id, {\n\t\t\trows: this.getRows(),\n\t\t\tcols: this.getColumns(),\n\t\t\tlimit: this.getLimits(),\n\t\t});\n\n\t\tconst ops = this.getOps();\n\n\t\ttry {\n\t\t\tlet result;\n\n\t\t\t//plain data\n\t\t\tif (mode == \"table\")\n\t\t\t\tresult = res.toArray({\n\t\t\t\t\tfilters,\n\t\t\t\t\tops,\n\t\t\t\t\t//remove repetitions in 'parent' col in 'table' mode\n\t\t\t\t\tcleanRows: table.cleanRows,\n\t\t\t\t});\n\t\t\t//groupped data\n\t\t\telse\n\t\t\t\tresult = res.toNested({\n\t\t\t\t\tfilters,\n\t\t\t\t\tops,\n\t\t\t\t});\n\n\t\t\tlet headerConfig;\n\t\t\tif (mode != \"chart\") headerConfig = { meta: true, nonEmpty: true };\n\n\t\t\treturn this._rengineToWebix(result, res.toXHeader(result, headerConfig));\n\t\t} catch (e) {\n\t\t\treturn this.loadError();\n\t\t}\n\t}\n\t/**\n\t * Updates math with custom total methods\n\t * @param {string} type - total operation type (group/footer/total)\n\t * @param {string} math - operation math\n\t * @param {Array} methodsMatch - math methods pos\n\t * @returns {string} updated math\n\t */\n\t_updateTotalMath(type, math, methodsMatch) {\n\t\tfor (let i = methodsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = methodsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\t(this.totalOperations[type][match[2]] || match[2]) +\n\t\t\t\tmath.substring(match.index + match[0].length - 1, math.length);\n\t\t}\n\t\treturn math;\n\t}\n\t/**\n\t * Applies math operations to data and groups\n\t * @returns {Object} ops\n\t */\n\tgetOps() {\n\t\tconst state = this._state;\n\t\tconst table = state.datatable;\n\t\tconst mode = state.mode;\n\t\tconst vals = state.structure.values;\n\t\tconst ops = [];\n\n\t\tfor (let i = 0; i < vals.length; i++) {\n\t\t\tconst format = vals[i].format;\n\t\t\tconst operation = vals[i].operation;\n\t\t\tconst color = vals[i].color;\n\n\t\t\tconst isComplex = operation == \"complex\";\n\t\t\tlet name = isComplex ? vals[i].math : vals[i].name;\n\t\t\tname = webix.isArray(name) ? name.join(\",\") : name;\n\n\t\t\tconst math = isComplex ? name : `${operation}(${name})`;\n\n\t\t\tlet branchMode;\n\t\t\tif (!isComplex) branchMode = this.getOperation(operation).branchMode;\n\n\t\t\tconst op = {\n\t\t\t\tmath,\n\t\t\t\tbranchMode: branchMode || \"raw\",\n\t\t\t\tlabel: name,\n\t\t\t\tmeta: { operation, format, color },\n\t\t\t\tcolumn: [],\n\t\t\t\trow: [],\n\t\t\t\tmarks: [],\n\t\t\t};\n\n\t\t\tconst total = this.totalOperations;\n\t\t\tlet methodsMatch;\n\t\t\tif (Object.keys(total).length) {\n\t\t\t\tconst methodsRegex = new RegExp(\n\t\t\t\t\t\"(\\\\(|,|\\\\+|-|\\\\/|\\\\*|\\\\s|^)(\" +\n\t\t\t\t\t\tthis.operations.map(method => method.id).join(\"|\") +\n\t\t\t\t\t\t\")\\\\(\",\n\t\t\t\t\t\"g\"\n\t\t\t\t);\n\t\t\t\tmethodsMatch = Array.from(math.matchAll(methodsRegex));\n\t\t\t}\n\n\t\t\tif (total.group)\n\t\t\t\top.branchMath = this._updateTotalMath(\"group\", math, methodsMatch);\n\n\t\t\tif (mode != \"chart\") {\n\t\t\t\tif (\n\t\t\t\t\ttable.footer &&\n\t\t\t\t\t((table.footer == \"sumOnly\" && operation == \"sum\") ||\n\t\t\t\t\t\ttable.footer != \"sumOnly\")\n\t\t\t\t)\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tmath: total.footer\n\t\t\t\t\t\t\t? this._updateTotalMath(\"footer\", math, methodsMatch)\n\t\t\t\t\t\t\t: math,\n\t\t\t\t\t\tas: \"value\",\n\t\t\t\t\t});\n\n\t\t\t\tif (\n\t\t\t\t\ttable.totalColumn &&\n\t\t\t\t\t((table.totalColumn == \"sumOnly\" && operation == \"sum\") ||\n\t\t\t\t\t\ttable.totalColumn != \"sumOnly\")\n\t\t\t\t)\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tmath: total.column\n\t\t\t\t\t\t\t? this._updateTotalMath(\"column\", math, methodsMatch)\n\t\t\t\t\t\t\t: math,\n\t\t\t\t\t\tas: \"\" + i,\n\t\t\t\t\t});\n\n\t\t\t\tif (table.minY) {\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tas: \"minY\",\n\t\t\t\t\t\tmath: \"min(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_min_y\",\n\t\t\t\t\t\tcheck: (v, column) => v == column.minY,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.maxY) {\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tas: \"maxY\",\n\t\t\t\t\t\tmath: \"max(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_max_y\",\n\t\t\t\t\t\tcheck: (v, column) => v == column.maxY,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.minX) {\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tas: \"minX\" + math,\n\t\t\t\t\t\tmath: \"min(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_min_x\",\n\t\t\t\t\t\tcheck: (v, column, row) => v == row[\"minX\" + math],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.maxX) {\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tas: \"maxX\" + math,\n\t\t\t\t\t\tmath: \"max(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_max_x\",\n\t\t\t\t\t\tcheck: (v, column, row) => v == row[\"maxX\" + math],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tops.push(op);\n\t\t}\n\t\treturn ops;\n\t}\n\t/** Convert rengine output data to pivot readable form **/\n\t_rengineToWebix(result, header) {\n\t\tconst state = this._state;\n\n\t\tif (state.mode == \"chart\") return this.getChartData(result, header);\n\n\t\tconst footer = header.nonEmpty.map(i =>\n\t\t\tresult.columnData[i] ? result.columnData[i].value : \"\"\n\t\t);\n\n\t\theader = this.getHeader(header);\n\n\t\tlet column;\n\t\tif (state.datatable.totalColumn) {\n\t\t\tcolumn = result.rowData.map(obj => {\n\t\t\t\tconst res = [];\n\t\t\t\tfor (let key in obj) {\n\t\t\t\t\tif (key.indexOf(\"minX\") == -1 && key.indexOf(\"maxX\") == -1)\n\t\t\t\t\t\tres[key] = obj[key];\n\t\t\t\t}\n\t\t\t\treturn res.filter(v => v || v === 0);\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tdata: result.tree || result.data,\n\t\t\theader,\n\t\t\tmarks: result.marks,\n\t\t\tfooter,\n\t\t\ttotalColumn: column,\n\t\t};\n\t}\n\t/**\n\t * Handle load error\n\t * @param {XMLHttpRequest} server error (customizations)\n\t * @returns {Object} empty data\n\t */\n\tloadError() {\n\t\twebix.message({\n\t\t\ttext: this._app.getService(\"locale\")._(\"Incorrect formula in values\"),\n\t\t\ttype: \"error\",\n\t\t});\n\n\t\treturn {\n\t\t\tdata: [],\n\t\t\tvalues: [],\n\t\t\theader: [],\n\t\t\tmarks: [],\n\t\t\tfooter: [],\n\t\t\ttotalColumn: [],\n\t\t};\n\t}\n\t/**\n\t * Prepares data for tree nodes\n\t * @param {Object} obj - item data as returted by Pivot engine\n\t * @returns {Object} item data ready for parsing in Webix Tree\n\t */\n\t_toTree(obj) {\n\t\tlet item = obj.values;\n\n\t\t// server returns object\n\t\tif (!webix.isArray(item)) {\n\t\t\tlet arr = [];\n\t\t\tfor (let name in item) arr[name] = item[name];\n\t\t\titem = arr;\n\t\t}\n\n\t\titem.unshift(\"\"); //header ids start from 1\n\t\tif (obj.data) {\n\t\t\titem.open = true;\n\t\t\titem.data = obj.data.map(r => {\n\t\t\t\treturn this._toTree(r);\n\t\t\t});\n\t\t} else item.id = obj.id; //row ids\n\t\treturn item;\n\t}\n\t/**\n\t * Prepares a storage for raw data before aggregation\n\t * @param {Array} data - initial data set\n\t * @returns {Object} object with storage data and parameters\n\t */\n\tgetTable(data) {\n\t\tconst fields = this.getFields(data[0]);\n\t\tthis._state.fields = fields;\n\t\tthis._data = data = this.prepareData(data, fields);\n\n\t\treturn {\n\t\t\tid: \"webixpivot\",\n\t\t\tprepare: true,\n\t\t\tdriver: \"raw\", //or \"columns\"\n\t\t\tfields: webix.copy(fields),\n\t\t\tdata,\n\t\t};\n\t}\n\t/**\n\t * Prepares data: parse dates, values template\n\t * @param {Array} data - initial data set\n\t * @returns {Array} data ready to parse\n\t */\n\tprepareData(data, fields) {\n\t\tfields = fields.filter(field => field.prepare || field.type == \"date\");\n\n\t\tif (fields.length) {\n\t\t\tdata = data.map(item => {\n\t\t\t\tfields.forEach(field => {\n\t\t\t\t\titem[field.id] = field.prepare\n\t\t\t\t\t\t? field.prepare(item[field.id])\n\t\t\t\t\t\t: new Date(item[field.id]);\n\t\t\t\t});\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\n\t\treturn data;\n\t}\n\t/**\n\t * Gets field values\n\t * @param {string} field name\n\t * @returns {Promise} promise that resolves with field values\n\t */\n\tcollectFieldValues(field) {\n\t\tif (this._filtersHash[field])\n\t\t\treturn webix.promise.resolve(this._filtersHash[field]);\n\n\t\tconst app = this._app;\n\t\tif (app.config.externalProcessing)\n\t\t\treturn (this._filtersHash[field] = app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.collectFieldValues(field));\n\n\t\tconst fieldObj = this.getField(field);\n\n\t\tconst hash = {};\n\t\tconst values = [];\n\t\tfor (let i = 0; i < this._data.length; i++) {\n\t\t\tlet value = this._data[i][field];\n\t\t\tif (value || value === 0) {\n\t\t\t\tlet label = value;\n\n\t\t\t\tif (fieldObj.type == \"date\") value = value.valueOf();\n\n\t\t\t\tif (!hash[value]) {\n\t\t\t\t\thash[value] = true;\n\n\t\t\t\t\tif (fieldObj.predicate)\n\t\t\t\t\t\tlabel = app.config.predicates[fieldObj.predicate](label);\n\n\t\t\t\t\tvalues.push({ value, id: value, label });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._filtersHash[field] = values;\n\t\treturn webix.promise.resolve(values);\n\t}\n\t/**\n\t * Apply custom fields names and methods locale to complex math\n\t * @param {String} complex math\n\t * @returns {String} complex math with correct fields and math methods names\n\t */\n\tfixMath(math) {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\n\t\tconst fields = this._state.fields;\n\t\tconst fieldsRegex = new RegExp(\n\t\t\tfields.map(field => \"\\\\b\" + field.id + \"\\\\b(?!\\\\()\").join(\"|\"),\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst methods = this.operations;\n\t\tconst methodsRegex = new RegExp(\n\t\t\tmethods.map(method => \"\\\\b\" + method.id + \"\\\\b\\\\(\").join(\"|\"),\n\t\t\t\"g\"\n\t\t);\n\n\t\treturn math\n\t\t\t.replaceAll(fieldsRegex, id => fields.find(obj => obj.id == id).value)\n\t\t\t.replaceAll(\n\t\t\t\tmethodsRegex,\n\t\t\t\tmethod => _(method.substring(0, method.length - 1)) + \"(\"\n\t\t\t);\n\t}\n\t/**\n\t * Finds field\n\t * @param {String} field id\n\t * @returns {Object} field\n\t */\n\tgetField(id) {\n\t\treturn this._state.fields.find(obj => obj.id == id);\n\t}\n\t/**\n\t * Finds operation\n\t * @param {String} operation id\n\t * @returns {Object} operation\n\t */\n\tgetOperation(id) {\n\t\treturn this.operations.find(obj => obj.id == id);\n\t}\n\t/**\n\t * Returns columns for aggregation\n\t * @returns {Array} array of field names for columns\n\t */\n\tgetColumns() {\n\t\tconst struct = this._state.structure;\n\t\tif (this._state.mode == \"chart\" && struct.groupBy) return [struct.groupBy];\n\t\telse return struct.columns;\n\t}\n\t/**\n\t * Returns for aggregation\n\t * @returns {Array} array of field names for rows\n\t */\n\tgetRows() {\n\t\treturn this._state.mode == \"chart\" ? [] : this._state.structure.rows;\n\t}\n\t/** Sets limits for raw and output data\n\t * @returns {Object} object with limits. By default math engine uses\n\t * { rows: 10000, columns: 5000, raws: Infinity }\n\t */\n\tgetLimits() {\n\t\treturn {};\n\t}\n\t/**\n\t * Prepares table header\n\t * @param {Object} hdata - object with header config\n\t * @returns {Array} array with header lines\n\t */\n\tgetHeader(hdata) {\n\t\tconst header = hdata.data;\n\t\tconst rows = [];\n\n\t\thdata.nonEmpty.forEach((v, i) => {\n\t\t\trows.push({\n\t\t\t\tid: v + 1,\n\t\t\t\theader: header.map(h => {\n\t\t\t\t\th =\n\t\t\t\t\t\th[i] && !webix.isUndefined(h[i].text) ? h[i] : { text: h[i] || \"\" };\n\t\t\t\t\tconst op = hdata.meta[i] && hdata.meta[i].operation;\n\t\t\t\t\tif (op) h.operation = op;\n\t\t\t\t\treturn h;\n\t\t\t\t}),\n\t\t\t\tformat: hdata.meta[i] && hdata.meta[i].format,\n\t\t\t});\n\t\t});\n\n\t\treturn rows;\n\t}\n\t/**\n\t * Sets dimensions based on rows/columns from structure\n\t */\n\tsetDimensions() {\n\t\tthis._reng.resetDimensions();\n\t\tconst columns = this.getColumns();\n\t\tconst fields = columns.concat(this.getRows() || []);\n\n\t\tfor (let i = 0; i < fields.length; i++) {\n\t\t\tconst field = this.getField(fields[i]);\n\t\t\tthis._reng.addDimension({\n\t\t\t\tid: fields[i],\n\t\t\t\ttable: this._table.id,\n\t\t\t\tlabel: fields[i],\n\t\t\t\trule: {\n\t\t\t\t\tby: field.predicate ? `${field.predicate}(${fields[i]})` : fields[i],\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Prepares chart data\n\t * @param {Object} res - object with groupped data\n\t * @param {Object} result - object with aggregated data and its parameters\n\t * @returns {Array} array with chart data\n\t */\n\tgetChartData(result, header) {\n\t\tconst state = this._state;\n\t\tconst ops = state.structure.values;\n\n\t\tlet data = [];\n\t\tlet values = [];\n\n\t\tif (result.data.length) {\n\t\t\tconst chartType = state.chart.type;\n\t\t\tconst groupBy = state.structure.groupBy;\n\n\t\t\tconst first = webix.copy(result.data[0]);\n\t\t\tconst axis = groupBy ? header.data[0] : first.map(() => \"\");\n\n\t\t\tlet count = 0;\n\t\t\twhile (first.length) {\n\t\t\t\tlet item = first.splice(0, ops.length);\n\t\t\t\tif (item.length) {\n\t\t\t\t\tlet text = axis[count].text;\n\t\t\t\t\tif (text === 0) text = \"0\";\n\n\t\t\t\t\tif (chartType == \"pie\" || chartType == \"donut\") {\n\t\t\t\t\t\tfor (let i = 0; i < item.length; i++)\n\t\t\t\t\t\t\titem[i] = { value: item[i], color: ops[i].color };\n\n\t\t\t\t\t\tif (groupBy)\n\t\t\t\t\t\t\tdata.push({\n\t\t\t\t\t\t\t\ttext: text || axis[count],\n\t\t\t\t\t\t\t\tcolor: this.getValueColor(count / ops.length, true),\n\t\t\t\t\t\t\t\tdata: item,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\telse data = item;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.push(text || axis[count]);\n\t\t\t\t\t\tdata.push(item);\n\t\t\t\t\t}\n\t\t\t\t\tcount += ops.length;\n\t\t\t\t} else break;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < ops.length; i++) {\n\t\t\tconst op = ops[i];\n\n\t\t\tlet name = op.operation == \"complex\" ? op.math : op.name;\n\t\t\tname = Array.isArray(name) ? name.join(\",\") : name;\n\n\t\t\tvalues.push({\n\t\t\t\ttext: name || op.operation,\n\t\t\t\toperation: op.operation,\n\t\t\t\tcolor: op.color,\n\t\t\t});\n\t\t}\n\n\t\treturn { data, values };\n\t}\n\t/**\n\t * Gets built-in colors for chart values\n\t * @param {boolean} pieGroup - is palette for pie group (customizations)\n\t * @returns {Array} color palette\n\t */\n\tgetPalette() {\n\t\treturn [\n\t\t\t[\"#e33fc7\", \"#a244ea\", \"#476cee\", \"#36abee\", \"#58dccd\", \"#a7ee70\"],\n\t\t\t[\"#d3ee36\", \"#eed236\", \"#ee9336\", \"#ee4339\", \"#595959\", \"#b85981\"],\n\t\t\t[\"#c670b8\", \"#9984ce\", \"#b9b9e2\", \"#b0cdfa\", \"#a0e4eb\", \"#7faf1b\"],\n\t\t\t[\"#b4d9a4\", \"#f2f79a\", \"#ffaa7d\", \"#d6806f\", \"#939393\", \"#d9b0d1\"],\n\t\t\t[\"#780e3b\", \"#684da9\", \"#242464\", \"#205793\", \"#5199a4\", \"#065c27\"],\n\t\t\t[\"#54b15a\", \"#ecf125\", \"#c65000\", \"#990001\", \"#363636\", \"#800f3e\"],\n\t\t];\n\t}\n\t/**\n\t * Gets a color from the palette\n\t * @param {number} i - row number of the required value\n\t * @param {boolean} pieGroup - is palette for pie group (customizations)\n\t * @returns {string} HEX color\n\t */\n\tgetValueColor(i, pieGroup) {\n\t\tconst palette = this.getPalette(pieGroup);\n\t\tlet rowIndex = i / palette[0].length;\n\t\trowIndex = rowIndex == palette.length ? 0 : parseInt(rowIndex, 10);\n\t\tconst columnIndex = i % palette[0].length;\n\t\treturn palette[rowIndex][columnIndex];\n\t}\n\n\tclearAll() {\n\t\t// fields\n\t\tthis._app.config.fields = null;\n\t\tthis._state.fields = [];\n\t\t// structure\n\t\tthis._app.setStructure({});\n\t\t// reset aggregated data/table config\n\t\tdelete this._table;\n\t\tthis._store = this.getPivotData();\n\t\tthis._data = [];\n\t\tthis._filtersHash = {};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseExportView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tsubMenuPos: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\tborderless: true,\n\t\t\t\ttype: {\n\t\t\t\t\tsubsign: true,\n\t\t\t\t},\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\twidth: 160,\n\t\t\t\tsubmenuConfig: {\n\t\t\t\t\tpoint: false,\n\t\t\t\t\twidth: 190,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t},\n\t\t\t\tautowidth: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: this.GetData(),\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: (id, e) => this.PopupAction(id, e),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To PNG\"), id: \"png\" },\n\t\t\t{ value: _(\"To PDF\"), id: \"pdf\" },\n\t\t];\n\t}\n\t/**\n\t * Calls \"exportModule\" event for app\n\t * @param {number} id - the ID of clicked menu option\n\t */\n\tPopupAction(id) {\n\t\tthis.app.callEvent(\"exportModule\", [id]);\n\t\tthis.getRoot().hide();\n\t}\n\t/**\n\t * Returns html template menu option\n\t * @param {Object} obj - data of menu option\n\t * @returns {String} - a string with html for an option\n\t */\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\t/**\n\t * Shows menu\n\t * @param {Object} node - html node where menu should be shown\n\t */\n\tShow(node) {\n\t\tif (this.getRoot().isVisible()) return;\n\t\tthis.webix.delay(() => this.getRoot().show(node));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ExportMenu from \"./export\";\n\nexport default class BaseToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: id => this.ShowExportPopup(id),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { createState, withContext } from \"jet-restate\";\n\nexport function bind(obj, key, ctrl, view) {\n\tbindOut(obj, key, ctrl);\n\treturn bindIn(obj, key, ctrl, view);\n}\n\nfunction bindIn(obj, key, ctrl, view) {\n\tconst handler = (v, o, k, meta) => {\n\t\tif (k === \"*\") {\n\t\t\tvar els = ctrl.elements;\n\t\t\tfor (var subkey in els) {\n\t\t\t\tif (typeof v[subkey] !== \"undefined\") els[subkey].setValue(v[subkey]);\n\t\t\t}\n\t\t} else if (key === \"*\") {\n\t\t\tvar el = ctrl.elements[k];\n\t\t\tif (el && el != meta) el.setValue(v);\n\t\t} else if (meta != ctrl) ctrl.setValue(v);\n\t};\n\n\treturn view\n\t\t? view.on(obj.$changes, key, handler)\n\t\t: obj.$changes.attachEvent(key, handler);\n}\n\nfunction bindOut(obj, key, ctrl) {\n\tif (key === \"*\") {\n\t\tvar els = ctrl.elements;\n\t\tfor (var subkey in els) {\n\t\t\tif (typeof obj[subkey] !== \"undefined\") bindOut(obj, subkey, els[subkey]);\n\t\t}\n\t\treturn;\n\t}\n\n\tconst trigger = function(newValue) {\n\t\tconst oldValue = obj[key];\n\t\tif (newValue !== oldValue) {\n\t\t\tobj[key] = newValue;\n\t\t}\n\t};\n\n\tif (!ctrl.getList)\n\t\tctrl.attachEvent(\"onTimedKeyPress\", function() {\n\t\t\tconst newValue = this.getValue();\n\t\t\tif (this.config.value !== newValue) {\n\t\t\t\tthis.config.value = newValue;\n\t\t\t\tthis.callEvent(\"onChange\", [newValue]);\n\t\t\t}\n\t\t});\n\n\tctrl.attachEvent(\"onChange\", function() {\n\t\twithContext(this, () => {\n\t\t\ttrigger(this.getValue());\n\t\t});\n\t});\n}\n\nexport function track(obj) {\n\tif (!obj.$changes) obj = createState(obj);\n\n\tvar observe = function(key, ctrl) {\n\t\treturn bind(obj, key, ctrl, ctrl);\n\t};\n\n\tvar observeEnd = function(id) {\n\t\tobj.$changes.detachEvent(id);\n\t};\n\n\treturn {\n\t\tattachEvent: observe,\n\t\tdetachEvent: observeEnd,\n\t};\n}\n","webix.protoUI(\n\t{\n\t\tname: \"input-list\",\n\t\tgetValue() {\n\t\t\treturn this._value || [];\n\t\t},\n\t\tsetValue(data) {\n\t\t\tthis._value = data;\n\n\t\t\tthis.clearAll();\n\t\t\tthis.parse([].concat(data));\n\t\t},\n\t},\n\twebix.ui.list\n);\n","export const menu = \"<span class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const edit =\n\t\"<span class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const remove =\n\t\"<span class='webix_icon webix_rpt_action_remove rpi-trash-can-outline'></span>\";\n\nexport const menuRight =\n\t\"<span style='float:right' class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const editRight =\n\t\"<span style='float:right' class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const removeRight =\n\t\"<span style='float:right' class='webix_icon webix_rpt_action_remove rpi-delete'></span>\";\n\nexport const visible =\n\t\"<span class='webix_icon action-visible mdi mdi-eye'></span>\";\nexport const hidden =\n\t\"<span class='webix_icon action-hidden mdi mdi-eye-off-outline'></span>\";\n\nexport const checked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-marked-outline'></span>\";\nexport const notChecked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-blank-outline'></span>\";\n\nexport const sortAsc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-ascending'></span>\";\nexport const sortDesc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-descending'></span>\";\n\nexport const types = {\n\ttable: \"<span class='rpi-table'></span>\",\n\tchart: \"<span class='rpi-poll'></span>\",\n\theatmap: \"<span class='rpi-chart-tree'></span>\",\n};\n\nexport const empty = {\n\tmain:\n\t\t\"<svg  xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320'><path class='webix_rpt_cls1' d='M369.51,182.77c-23.18-52.39,32-103.23,13.74-148.28s-77.61-39.42-162.07-20S78.47-6.35,34.66,14.46c-29.39,14-27.27,58.82-5,107,38.95,84.29-51.86,117.32-24.38,166s118.91-.95,183.37,4.22c37.62.59,62.88,6.26,109.52,21.27C387.63,341.7,412.41,279.75,369.51,182.77Z'/><rect class='webix_rpt_cls2' x='111.53' y='226.04' width='212.47' height='0.91'/><rect class='webix_rpt_cls3' x='97' y='89.51' width='212' height='151.96'/><rect class='webix_rpt_cls4' x='67' y='159.96' width='136.33' height='81.98' rx='2'/><polygon class='webix_rpt_cls5' points='199.32 235.55 72.61 235.55 72.61 165.28 71.01 165.28 71.01 235.55 71.01 237.68 71.01 237.68 72.61 237.68 72.61 237.68 199.32 237.68 199.32 235.55'/><rect class='webix_rpt_cls6' x='84.64' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='97.47' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='110.3' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='123.14' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='135.97' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='148.8' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='161.63' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='174.46' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='187.29' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='111.53' y='94.41' width='212.47' height='132.54'/><rect class='webix_rpt_cls8' x='111.53' y='109.85' width='212.47' height='0.91'/><path class='webix_rpt_cls9' d='M111.53,94.41H324v15.44H111.53Z'/><path class='webix_rpt_cls7' d='M111.53,79H324V94.41H111.53Z'/><path class='webix_rpt_cls2' d='M324,125.28v-.91H287.68V109.84h-.91v14.53H250.45V109.84h-.91v14.53H213.22V109.84h-.9v14.53H176V109.85h-.91v14.52H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56V197H111.53v.91h63.56v13.62H111.53v.9h63.56V227H176V212.42h36.32V227h.9V212.42h36.32V227h.91V212.42h36.32V227h.91V212.42H324v-.9H287.68V197.9H324V197H287.68V183.38H324v-.91H287.68V168.85H324v-.91H287.68V154.33H324v-.91H287.68V139.8H324v-.91H287.68V125.28Zm-74.46,0v13.61H213.22V125.28Zm-36.32,57.19V168.85h36.32v13.62Zm36.32.91V197H213.22V183.38Zm-36.32-15.44V154.33h36.32v13.61Zm0-14.52V139.8h36.32v13.62ZM176,125.28h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32V197H176Zm0,28.14V197.9h36.32v13.62Zm37.22,0V197.9h36.32v13.62Zm73.55,0H250.45V197.9h36.32Zm0-14.53H250.45V183.38h36.32Zm0-14.52H250.45V168.85h36.32Zm0-14.53H250.45V154.33h36.32Zm0-14.52H250.45V139.8h36.32Zm0-14.53H250.45V125.28h36.32Z'/><rect class='webix_rpt_cls2' x='175.09' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='212.32' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='249.54' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='286.77' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls9' x='118.79' y='84.43' width='21.79' height='5.45'/><rect class='webix_rpt_cls9' x='250.45' y='84.43' width='66.28' height='5.45'/></svg>\",\n\talt:\n\t\t\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320' fill='none'><g clip-path='url(#clip0_4706_8889)'><path d='M369.502 182.763C346.322 130.373 401.502 79.5332 383.242 34.4832C364.982 -10.5668 305.632 -4.93676 221.172 14.4832C136.712 33.9032 78.4622 -6.35676 34.6522 14.4532C5.26223 28.4532 7.38222 73.2732 29.6522 121.453C68.6022 205.743 -22.2078 238.773 5.27222 287.453C32.7522 336.133 124.182 286.503 188.642 291.673C226.262 292.263 251.522 297.933 298.162 312.943C387.622 341.693 412.402 279.743 369.502 182.763Z' class='webix_rpt_cls1'/><path d='M112.545 76.0479C112.545 74.9421 113.475 74.0457 114.622 74.0457H215.368L256.913 114.09V251.238C256.913 252.344 255.983 253.241 254.836 253.241H114.622C113.475 253.241 112.545 252.344 112.545 251.238V76.0479Z' class='webix_rpt_cls6'/><path d='M128.322 60.5902C128.322 59.4844 129.252 58.588 130.399 58.588H231.145L272.69 98.6313V235.781C272.69 236.887 271.76 237.783 270.612 237.783H130.399C129.252 237.783 128.322 236.887 128.322 235.781V60.5902Z' class='webix_rpt_cls4'/><path fill-rule='evenodd' clip-rule='evenodd' d='M130.399 59.588C129.769 59.588 129.322 60.0708 129.322 60.5902V235.781C129.322 236.3 129.769 236.783 130.399 236.783H270.612C271.243 236.783 271.69 236.299 271.69 235.781V99.0563L230.742 59.588H130.399ZM231.145 58.588H130.399C129.252 58.588 128.322 59.4844 128.322 60.5902V235.781C128.322 236.887 129.252 237.783 130.399 237.783H270.612C271.76 237.783 272.69 236.887 272.69 235.781V98.6313L231.145 58.588Z' class='webix_rpt_cls3'/><path d='M231.146 96.6297V58.588L272.69 98.6313H233.222C232.075 98.6313 231.146 97.7353 231.146 96.6297Z' class='webix_rpt_cls3'/><path d='M184.729 74.0457H143.184C142.323 74.0457 141.626 74.718 141.626 75.5473V75.5473C141.626 76.3766 142.323 77.0489 143.184 77.0489H184.729C185.589 77.0489 186.287 76.3766 186.287 75.5473C186.287 74.718 185.589 74.0457 184.729 74.0457Z' class='webix_rpt_cls2'/><path d='M184.729 87.0457H143.184C142.323 87.0457 141.626 87.718 141.626 88.5473V88.5473C141.626 89.3766 142.323 90.0489 143.184 90.0489H184.729C185.589 90.0489 186.287 89.3766 186.287 88.5473C186.287 87.718 185.589 87.0457 184.729 87.0457Z' class='webix_rpt_cls2'/><path d='M222.443 101H143.557C142.697 101 142 101.672 142 102.5C142 103.328 142.697 104 143.557 104H222.443C223.303 104 224 103.328 224 102.5C224 101.672 223.303 101 222.443 101Z' class='webix_rpt_cls2'/><path d='M222.443 115H143.557C142.697 115 142 115.672 142 116.5V116.5C142 117.328 142.697 118 143.557 118H222.443C223.303 118 224 117.328 224 116.5C224 115.672 223.303 115 222.443 115Z' class='webix_rpt_cls2'/><path fill-rule='evenodd' clip-rule='evenodd' d='M218 223C240.644 223 259 204.644 259 182C259 159.356 240.644 141 218 141C195.356 141 177 159.356 177 182C177 204.644 195.356 223 218 223ZM218 227C242.853 227 263 206.853 263 182C263 157.147 242.853 137 218 137C193.147 137 173 157.147 173 182C173 206.853 193.147 227 218 227Z' class='webix_rpt_cls4'/><path d='M219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134ZM219.686 148.057C202.114 148.057 188.057 162.114 188.057 179.686C188.057 197.257 202.114 211.314 219.686 211.314C237.257 211.314 251.314 197.257 251.314 179.686C251.314 162.114 237.257 148.057 219.686 148.057Z' class='webix_rpt_cls5'/><path fill-rule='evenodd' clip-rule='evenodd' d='M253.047 209.471L253.645 208.769C260.316 200.928 264.371 190.754 264.371 179.686C264.371 167.834 259.663 156.468 251.283 148.088C242.903 139.708 231.537 135 219.686 135C207.834 135 196.468 139.708 188.088 148.088C179.708 156.468 175 167.834 175 179.686C175 191.537 179.708 202.903 188.088 211.283C196.468 219.663 207.834 224.371 219.686 224.371C230.754 224.371 240.928 220.316 248.769 213.645L249.471 213.047L252.314 215.89V221.443L286.457 255.586L295.586 246.457L261.443 212.314H255.89L253.047 209.471ZM261.857 211.314L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857ZM187.057 179.686C187.057 161.562 201.562 147.057 219.686 147.057C237.809 147.057 252.314 161.562 252.314 179.686C252.314 197.809 237.809 212.314 219.686 212.314C201.562 212.314 187.057 197.809 187.057 179.686ZM188.057 179.686C188.057 162.114 202.114 148.057 219.686 148.057C237.257 148.057 251.314 162.114 251.314 179.686C251.314 197.257 237.257 211.314 219.686 211.314C202.114 211.314 188.057 197.257 188.057 179.686Z' class='webix_rpt_cls3'/><path d='M236.083 167.231L232.852 164L220.042 176.81L207.231 164L204 167.231L216.81 180.042L204 192.852L207.231 196.083L220.042 183.273L232.852 196.083L236.083 192.852L223.273 180.042L236.083 167.231Z' class='webix_rpt_cls3'/></g><defs><clipPath id='clip0_4706_8889'><rect width='390' height='320' class='webix_rpt_cls4'/></clipPath></defs></svg>\",\n};\n","/*\n@license\nWebix Query v.10.0.9\nThis software is covered by Webix Commercial License.\nUsage without proper license is prohibited.\n(c) XB Software Ltd.\n*/\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = global || self, factory(global.query = {}));\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\n\n    var NavigationBlocked = (function () {\n        function NavigationBlocked() {\n        }\n        return NavigationBlocked;\n    }());\n    var JetBase = (function () {\n        function JetBase(webix, config) {\n            this.webixJet = true;\n            this.webix = webix;\n            this._events = [];\n            this._subs = {};\n            this._data = {};\n            if (config && config.params)\n                webix.extend(this._data, config.params);\n        }\n        JetBase.prototype.getRoot = function () {\n            return this._root;\n        };\n        JetBase.prototype.destructor = function () {\n            this._detachEvents();\n            this._destroySubs();\n            this._events = this._container = this.app = this._parent = this._root = null;\n        };\n        JetBase.prototype.setParam = function (id, value, url) {\n            if (this._data[id] !== value) {\n                this._data[id] = value;\n                this._segment.update(id, value, 0);\n                if (url) {\n                    return this.show(null);\n                }\n            }\n        };\n        JetBase.prototype.getParam = function (id, parent) {\n            var value = this._data[id];\n            if (typeof value !== \"undefined\" || !parent) {\n                return value;\n            }\n            var view = this.getParentView();\n            if (view) {\n                return view.getParam(id, parent);\n            }\n        };\n        JetBase.prototype.getUrl = function () {\n            return this._segment.suburl();\n        };\n        JetBase.prototype.getUrlString = function () {\n            return this._segment.toString();\n        };\n        JetBase.prototype.getParentView = function () {\n            return this._parent;\n        };\n        JetBase.prototype.$$ = function (id) {\n            if (typeof id === \"string\") {\n                var root_1 = this.getRoot();\n                return root_1.queryView((function (obj) { return (obj.config.id === id || obj.config.localId === id) &&\n                    (obj.$scope === root_1.$scope); }), \"self\");\n            }\n            else {\n                return id;\n            }\n        };\n        JetBase.prototype.on = function (obj, name, code) {\n            var id = obj.attachEvent(name, code);\n            this._events.push({ obj: obj, id: id });\n            return id;\n        };\n        JetBase.prototype.contains = function (view) {\n            for (var key in this._subs) {\n                var kid = this._subs[key].view;\n                if (kid === view || kid.contains(view)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        JetBase.prototype.getSubView = function (name) {\n            var sub = this.getSubViewInfo(name);\n            if (sub) {\n                return sub.subview.view;\n            }\n        };\n        JetBase.prototype.getSubViewInfo = function (name) {\n            var sub = this._subs[name || \"default\"];\n            if (sub) {\n                return { subview: sub, parent: this };\n            }\n            if (name === \"_top\") {\n                this._subs[name] = { url: \"\", id: null, popup: true };\n                return this.getSubViewInfo(name);\n            }\n            if (this._parent) {\n                return this._parent.getSubViewInfo(name);\n            }\n            return null;\n        };\n        JetBase.prototype._detachEvents = function () {\n            var events = this._events;\n            for (var i = events.length - 1; i >= 0; i--) {\n                events[i].obj.detachEvent(events[i].id);\n            }\n        };\n        JetBase.prototype._destroySubs = function () {\n            for (var key in this._subs) {\n                var subView = this._subs[key].view;\n                if (subView) {\n                    subView.destructor();\n                }\n            }\n            this._subs = {};\n        };\n        JetBase.prototype._init_url_data = function () {\n            var url = this._segment.current();\n            this._data = {};\n            this.webix.extend(this._data, url.params, true);\n        };\n        JetBase.prototype._getDefaultSub = function () {\n            if (this._subs.default) {\n                return this._subs.default;\n            }\n            for (var key in this._subs) {\n                var sub = this._subs[key];\n                if (!sub.branch && sub.view && key !== \"_top\") {\n                    var child = sub.view._getDefaultSub();\n                    if (child) {\n                        return child;\n                    }\n                }\n            }\n        };\n        JetBase.prototype._routed_view = function () {\n            var parent = this.getParentView();\n            if (!parent) {\n                return true;\n            }\n            var sub = parent._getDefaultSub();\n            if (!sub && sub !== this) {\n                return false;\n            }\n            return parent._routed_view();\n        };\n        return JetBase;\n    }());\n    function parse(url) {\n        if (url[0] === \"/\") {\n            url = url.substr(1);\n        }\n        var parts = url.split(\"/\");\n        var chunks = [];\n        for (var i = 0; i < parts.length; i++) {\n            var test = parts[i];\n            var result = {};\n            var pos = test.indexOf(\":\");\n            if (pos === -1) {\n                pos = test.indexOf(\"?\");\n            }\n            if (pos !== -1) {\n                var params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\n                for (var _i = 0, params_1 = params; _i < params_1.length; _i++) {\n                    var param = params_1[_i];\n                    var dchunk = param.split(\"=\");\n                    result[dchunk[0]] = decodeURIComponent(dchunk[1]);\n                }\n            }\n            chunks[i] = {\n                page: (pos > -1 ? test.substr(0, pos) : test),\n                params: result,\n                isNew: true\n            };\n        }\n        return chunks;\n    }\n    function url2str(stack) {\n        var url = [];\n        for (var _i = 0, stack_1 = stack; _i < stack_1.length; _i++) {\n            var chunk = stack_1[_i];\n            url.push(\"/\" + chunk.page);\n            var params = obj2str(chunk.params);\n            if (params) {\n                url.push(\"?\" + params);\n            }\n        }\n        return url.join(\"\");\n    }\n    function obj2str(obj) {\n        var str = [];\n        for (var key in obj) {\n            if (typeof obj[key] === \"object\")\n                continue;\n            if (str.length) {\n                str.push(\"&\");\n            }\n            str.push(key + \"=\" + encodeURIComponent(obj[key]));\n        }\n        return str.join(\"\");\n    }\n    var Route = (function () {\n        function Route(route, index) {\n            this._next = 1;\n            if (typeof route === \"string\") {\n                this.route = {\n                    url: parse(route),\n                    path: route\n                };\n            }\n            else {\n                this.route = route;\n            }\n            this.index = index;\n        }\n        Route.prototype.current = function () {\n            return this.route.url[this.index];\n        };\n        Route.prototype.next = function () {\n            return this.route.url[this.index + this._next];\n        };\n        Route.prototype.suburl = function () {\n            return this.route.url.slice(this.index);\n        };\n        Route.prototype.shift = function (params) {\n            var route = new Route(this.route, this.index + this._next);\n            route.setParams(route.route.url, params, route.index);\n            return route;\n        };\n        Route.prototype.setParams = function (url, params, index) {\n            if (params) {\n                var old = url[index].params;\n                for (var key in params)\n                    old[key] = params[key];\n            }\n        };\n        Route.prototype.refresh = function () {\n            var url = this.route.url;\n            for (var i = this.index + 1; i < url.length; i++) {\n                url[i].isNew = true;\n            }\n        };\n        Route.prototype.toString = function () {\n            var str = url2str(this.suburl());\n            return str ? str.substr(1) : \"\";\n        };\n        Route.prototype._join = function (path, kids) {\n            var url = this.route.url;\n            if (path === null) {\n                return url;\n            }\n            var old = this.route.url;\n            var reset = true;\n            url = old.slice(0, this.index + (kids ? this._next : 0));\n            if (path) {\n                url = url.concat(parse(path));\n                for (var i = 0; i < url.length; i++) {\n                    if (old[i]) {\n                        url[i].view = old[i].view;\n                    }\n                    if (reset && old[i] && url[i].page === old[i].page) {\n                        url[i].isNew = false;\n                    }\n                    else if (url[i].isNew) {\n                        reset = false;\n                    }\n                }\n            }\n            return url;\n        };\n        Route.prototype.append = function (path) {\n            var url = this._join(path, true);\n            this.route.path = url2str(url);\n            this.route.url = url;\n            return this.route.path;\n        };\n        Route.prototype.show = function (path, view, kids) {\n            var _this = this;\n            var url = this._join(path.url, kids);\n            this.setParams(url, path.params, this.index + (kids ? this._next : 0));\n            return new Promise(function (res, rej) {\n                var redirect = url2str(url);\n                var obj = {\n                    url: url,\n                    redirect: redirect,\n                    confirm: Promise.resolve()\n                };\n                var app = view ? view.app : null;\n                if (app) {\n                    var result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n                    if (!result) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                }\n                obj.confirm.catch(function (err) { return rej(err); }).then(function () {\n                    if (obj.redirect === null) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    if (obj.redirect !== redirect) {\n                        app.show(obj.redirect);\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    _this.route.path = redirect;\n                    _this.route.url = url;\n                    res();\n                });\n            });\n        };\n        Route.prototype.size = function (n) {\n            this._next = n;\n        };\n        Route.prototype.split = function () {\n            var route = {\n                url: this.route.url.slice(this.index + 1),\n                path: \"\"\n            };\n            if (route.url.length) {\n                route.path = url2str(route.url);\n            }\n            return new Route(route, 0);\n        };\n        Route.prototype.update = function (name, value, index) {\n            var chunk = this.route.url[this.index + (index || 0)];\n            if (!chunk) {\n                this.route.url.push({ page: \"\", params: {} });\n                return this.update(name, value, index);\n            }\n            if (name === \"\") {\n                chunk.page = value;\n            }\n            else {\n                chunk.params[name] = value;\n            }\n            this.route.path = url2str(this.route.url);\n        };\n        return Route;\n    }());\n    var JetView = (function (_super) {\n        __extends(JetView, _super);\n        function JetView(app, config) {\n            var _this = _super.call(this, app.webix) || this;\n            _this.app = app;\n            _this._children = [];\n            return _this;\n        }\n        JetView.prototype.ui = function (ui, config) {\n            config = config || {};\n            var container = config.container || ui.container;\n            var jetview = this.app.createView(ui);\n            this._children.push(jetview);\n            jetview.render(container, this._segment, this);\n            if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\n                return jetview;\n            }\n            else {\n                return jetview.getRoot();\n            }\n        };\n        JetView.prototype.show = function (path, config) {\n            config = config || {};\n            if (typeof path === \"object\") {\n                for (var key in path) {\n                    this.setParam(key, path[key]);\n                }\n                path = null;\n            }\n            else {\n                if (path.substr(0, 1) === \"/\") {\n                    return this.app.show(path, config);\n                }\n                if (path.indexOf(\"./\") === 0) {\n                    path = path.substr(2);\n                }\n                if (path.indexOf(\"../\") === 0) {\n                    var parent_1 = this.getParentView();\n                    if (parent_1) {\n                        return parent_1.show(path.substr(3), config);\n                    }\n                    else {\n                        return this.app.show(\"/\" + path.substr(3));\n                    }\n                }\n                var sub = this.getSubViewInfo(config.target);\n                if (sub) {\n                    if (sub.parent !== this) {\n                        return sub.parent.show(path, config);\n                    }\n                    else if (config.target && config.target !== \"default\") {\n                        return this._renderFrameLock(config.target, sub.subview, {\n                            url: path,\n                            params: config.params,\n                        });\n                    }\n                }\n                else {\n                    if (path) {\n                        return this.app.show(\"/\" + path, config);\n                    }\n                }\n            }\n            return this._show(this._segment, { url: path, params: config.params }, this);\n        };\n        JetView.prototype._show = function (segment, path, view) {\n            var _this = this;\n            return segment.show(path, view, true).then(function () {\n                _this._init_url_data();\n                return _this._urlChange();\n            }).then(function () {\n                if (segment.route.linkRouter) {\n                    _this.app.getRouter().set(segment.route.path, { silent: true });\n                    _this.app.callEvent(\"app:route\", [segment.route.path]);\n                }\n            });\n        };\n        JetView.prototype.init = function (_$view, _$) {\n        };\n        JetView.prototype.ready = function (_$view, _$url) {\n        };\n        JetView.prototype.config = function () {\n            this.app.webix.message(\"View:Config is not implemented\");\n        };\n        JetView.prototype.urlChange = function (_$view, _$url) {\n        };\n        JetView.prototype.destroy = function () {\n        };\n        JetView.prototype.destructor = function () {\n            this.destroy();\n            this._destroyKids();\n            if (this._root) {\n                this._root.destructor();\n                _super.prototype.destructor.call(this);\n            }\n        };\n        JetView.prototype.use = function (plugin, config) {\n            plugin(this.app, this, config);\n        };\n        JetView.prototype.refresh = function () {\n            var url = this.getUrl();\n            this.destroy();\n            this._destroyKids();\n            this._destroySubs();\n            this._detachEvents();\n            if (this._container.tagName) {\n                this._root.destructor();\n            }\n            this._segment.refresh();\n            return this._render(this._segment);\n        };\n        JetView.prototype.render = function (root, url, parent) {\n            var _this = this;\n            if (typeof url === \"string\") {\n                url = new Route(url, 0);\n            }\n            this._segment = url;\n            this._parent = parent;\n            this._init_url_data();\n            root = root || document.body;\n            var _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n            if (this._container !== _container) {\n                this._container = _container;\n                return this._render(url);\n            }\n            else {\n                return this._urlChange().then(function () { return _this.getRoot(); });\n            }\n        };\n        JetView.prototype._render = function (url) {\n            var _this = this;\n            var config = this.config();\n            if (config.then) {\n                return config.then(function (cfg) { return _this._render_final(cfg, url); });\n            }\n            else {\n                return this._render_final(config, url);\n            }\n        };\n        JetView.prototype._render_final = function (config, url) {\n            var _this = this;\n            var slot = null;\n            var container = null;\n            var show = false;\n            if (!this._container.tagName) {\n                slot = this._container;\n                if (slot.popup) {\n                    container = document.body;\n                    show = true;\n                }\n                else {\n                    container = this.webix.$$(slot.id);\n                }\n            }\n            else {\n                container = this._container;\n            }\n            if (!this.app || !container) {\n                return Promise.reject(null);\n            }\n            var response;\n            var current = this._segment.current();\n            var result = { ui: {} };\n            this.app.copyConfig(config, result.ui, this._subs);\n            this.app.callEvent(\"app:render\", [this, url, result]);\n            result.ui.$scope = this;\n            if (!slot && current.isNew && current.view) {\n                current.view.destructor();\n            }\n            try {\n                if (slot && !show) {\n                    var oldui = container;\n                    var parent_2 = oldui.getParentView();\n                    if (parent_2 && parent_2.name === \"multiview\" && !result.ui.id) {\n                        result.ui.id = oldui.config.id;\n                    }\n                }\n                this._root = this.app.webix.ui(result.ui, container);\n                var asWin = this._root;\n                if (show && asWin.setPosition && !asWin.isVisible()) {\n                    asWin.show();\n                }\n                if (slot) {\n                    if (slot.view && slot.view !== this && slot.view !== this.app) {\n                        slot.view.destructor();\n                    }\n                    slot.id = this._root.config.id;\n                    if (this.getParentView() || !this.app.app)\n                        slot.view = this;\n                    else {\n                        slot.view = this.app;\n                    }\n                }\n                if (current.isNew) {\n                    current.view = this;\n                    current.isNew = false;\n                }\n                response = Promise.resolve(this._init(this._root, url)).then(function () {\n                    return _this._urlChange().then(function () {\n                        _this._initUrl = null;\n                        return _this.ready(_this._root, url.suburl());\n                    });\n                });\n            }\n            catch (e) {\n                response = Promise.reject(e);\n            }\n            return response.catch(function (err) { return _this._initError(_this, err); });\n        };\n        JetView.prototype._init = function (view, url) {\n            return this.init(view, url.suburl());\n        };\n        JetView.prototype._urlChange = function () {\n            var _this = this;\n            this.app.callEvent(\"app:urlchange\", [this, this._segment]);\n            var waits = [];\n            for (var key in this._subs) {\n                var frame = this._subs[key];\n                var wait = this._renderFrameLock(key, frame, null);\n                if (wait) {\n                    waits.push(wait);\n                }\n            }\n            return Promise.all(waits).then(function () {\n                return _this.urlChange(_this._root, _this._segment.suburl());\n            });\n        };\n        JetView.prototype._renderFrameLock = function (key, frame, path) {\n            if (!frame.lock) {\n                var lock = this._renderFrame(key, frame, path);\n                if (lock) {\n                    frame.lock = lock.then(function () { return frame.lock = null; }, function () { return frame.lock = null; });\n                }\n            }\n            return frame.lock;\n        };\n        JetView.prototype._renderFrame = function (key, frame, path) {\n            var _this = this;\n            if (key === \"default\") {\n                if (this._segment.next()) {\n                    var params = path ? path.params : null;\n                    if (frame.params) {\n                        params = this.webix.extend(params || {}, frame.params);\n                    }\n                    return this._createSubView(frame, this._segment.shift(params));\n                }\n                else if (frame.view && frame.popup) {\n                    frame.view.destructor();\n                    frame.view = null;\n                }\n            }\n            if (path !== null) {\n                frame.url = path.url;\n                if (frame.params) {\n                    path.params = this.webix.extend(path.params || {}, frame.params);\n                }\n            }\n            if (frame.route) {\n                if (path !== null) {\n                    return frame.route.show(path, frame.view).then(function () {\n                        return _this._createSubView(frame, frame.route);\n                    });\n                }\n                if (frame.branch) {\n                    return;\n                }\n            }\n            var view = frame.view;\n            if (!view && frame.url) {\n                if (typeof frame.url === \"string\") {\n                    frame.route = new Route(frame.url, 0);\n                    if (path)\n                        frame.route.setParams(frame.route.route.url, path.params, 0);\n                    if (frame.params)\n                        frame.route.setParams(frame.route.route.url, frame.params, 0);\n                    return this._createSubView(frame, frame.route);\n                }\n                else {\n                    if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\n                        view = new (this.app._override(frame.url))(this.app, \"\");\n                    }\n                    if (!view) {\n                        view = frame.url;\n                    }\n                }\n            }\n            if (view) {\n                return view.render(frame, (frame.route || this._segment), this);\n            }\n        };\n        JetView.prototype._initError = function (view, err) {\n            if (this.app) {\n                this.app.error(\"app:error:initview\", [err, view]);\n            }\n            return true;\n        };\n        JetView.prototype._createSubView = function (sub, suburl) {\n            var _this = this;\n            return this.app.createFromURL(suburl.current()).then(function (view) {\n                return view.render(sub, suburl, _this);\n            });\n        };\n        JetView.prototype._destroyKids = function () {\n            var uis = this._children;\n            for (var i = uis.length - 1; i >= 0; i--) {\n                if (uis[i] && uis[i].destructor) {\n                    uis[i].destructor();\n                }\n            }\n            this._children = [];\n        };\n        return JetView;\n    }(JetBase));\n    var JetViewRaw = (function (_super) {\n        __extends(JetViewRaw, _super);\n        function JetViewRaw(app, config) {\n            var _this = _super.call(this, app, config) || this;\n            _this._ui = config.ui;\n            return _this;\n        }\n        JetViewRaw.prototype.config = function () {\n            return this._ui;\n        };\n        return JetViewRaw;\n    }(JetView));\n    var SubRouter = (function () {\n        function SubRouter(cb, config, app) {\n            this.path = \"\";\n            this.app = app;\n        }\n        SubRouter.prototype.set = function (path, config) {\n            this.path = path;\n            var a = this.app;\n            a.app.getRouter().set(a._segment.append(this.path), { silent: true });\n        };\n        SubRouter.prototype.get = function () {\n            return this.path;\n        };\n        return SubRouter;\n    }());\n    var _once = true;\n    var JetAppBase = (function (_super) {\n        __extends(JetAppBase, _super);\n        function JetAppBase(config) {\n            var _this = this;\n            var webix = (config || {}).webix || window.webix;\n            config = webix.extend({\n                name: \"App\",\n                version: \"1.0\",\n                start: \"/home\"\n            }, config, true);\n            _this = _super.call(this, webix, config) || this;\n            _this.config = config;\n            _this.app = _this.config.app;\n            _this.ready = Promise.resolve();\n            _this._services = {};\n            _this.webix.extend(_this, _this.webix.EventSystem);\n            return _this;\n        }\n        JetAppBase.prototype.getUrl = function () {\n            return this._subSegment.suburl();\n        };\n        JetAppBase.prototype.getUrlString = function () {\n            return this._subSegment.toString();\n        };\n        JetAppBase.prototype.getService = function (name) {\n            var obj = this._services[name];\n            if (typeof obj === \"function\") {\n                obj = this._services[name] = obj(this);\n            }\n            return obj;\n        };\n        JetAppBase.prototype.setService = function (name, handler) {\n            this._services[name] = handler;\n        };\n        JetAppBase.prototype.destructor = function () {\n            this.getSubView().destructor();\n            _super.prototype.destructor.call(this);\n        };\n        JetAppBase.prototype.copyConfig = function (obj, target, config) {\n            if (obj instanceof JetBase ||\n                (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\n                obj = { $subview: obj };\n            }\n            if (typeof obj.$subview != \"undefined\") {\n                return this.addSubView(obj, target, config);\n            }\n            var isArray = obj instanceof Array;\n            target = target || (isArray ? [] : {});\n            for (var method in obj) {\n                var point = obj[method];\n                if (typeof point === \"function\" && point.prototype instanceof JetBase) {\n                    point = { $subview: point };\n                }\n                if (point && typeof point === \"object\" &&\n                    !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n                    if (point instanceof Date) {\n                        target[method] = new Date(point);\n                    }\n                    else {\n                        var copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\n                        if (copy !== null) {\n                            if (isArray)\n                                target.push(copy);\n                            else\n                                target[method] = copy;\n                        }\n                    }\n                }\n                else {\n                    target[method] = point;\n                }\n            }\n            return target;\n        };\n        JetAppBase.prototype.getRouter = function () {\n            return this.$router;\n        };\n        JetAppBase.prototype.clickHandler = function (e, target) {\n            if (e) {\n                target = target || (e.target || e.srcElement);\n                if (target && target.getAttribute) {\n                    var trigger_1 = target.getAttribute(\"trigger\");\n                    if (trigger_1) {\n                        this._forView(target, function (view) { return view.app.trigger(trigger_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                    var route_1 = target.getAttribute(\"route\");\n                    if (route_1) {\n                        this._forView(target, function (view) { return view.show(route_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                }\n            }\n            var parent = target.parentNode;\n            if (parent) {\n                this.clickHandler(e, parent);\n            }\n        };\n        JetAppBase.prototype.getRoot = function () {\n            return this.getSubView().getRoot();\n        };\n        JetAppBase.prototype.refresh = function () {\n            var _this = this;\n            if (!this._subSegment) {\n                return Promise.resolve(null);\n            }\n            return this.getSubView().refresh().then(function (view) {\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return view;\n            });\n        };\n        JetAppBase.prototype.loadView = function (url) {\n            var _this = this;\n            var views = this.config.views;\n            var result = null;\n            if (url === \"\") {\n                return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\n            }\n            try {\n                if (views) {\n                    if (typeof views === \"function\") {\n                        result = views(url);\n                    }\n                    else {\n                        result = views[url];\n                    }\n                    if (typeof result === \"string\") {\n                        url = result;\n                        result = null;\n                    }\n                }\n                if (!result) {\n                    if (url === \"_hidden\") {\n                        result = { hidden: true };\n                    }\n                    else if (url === \"_blank\") {\n                        result = {};\n                    }\n                    else {\n                        url = url.replace(/\\./g, \"/\");\n                        result = this.require(\"jet-views\", url);\n                    }\n                }\n            }\n            catch (e) {\n                result = this._loadError(url, e);\n            }\n            if (!result.then) {\n                result = Promise.resolve(result);\n            }\n            result = result\n                .then(function (module) { return module.__esModule ? module.default : module; })\n                .catch(function (err) { return _this._loadError(url, err); });\n            return result;\n        };\n        JetAppBase.prototype._forView = function (target, handler) {\n            var view = this.webix.$$(target);\n            if (view) {\n                handler(view.$scope);\n            }\n        };\n        JetAppBase.prototype._loadViewDynamic = function (url) {\n            return null;\n        };\n        JetAppBase.prototype.createFromURL = function (chunk) {\n            var _this = this;\n            var view;\n            if (chunk.isNew || !chunk.view) {\n                view = this.loadView(chunk.page)\n                    .then(function (ui) { return _this.createView(ui, name, chunk.params); });\n            }\n            else {\n                view = Promise.resolve(chunk.view);\n            }\n            return view;\n        };\n        JetAppBase.prototype._override = function (ui) {\n            var over = this.config.override;\n            if (over) {\n                var dv = void 0;\n                while (ui) {\n                    dv = ui;\n                    ui = over.get(ui);\n                }\n                return dv;\n            }\n            return ui;\n        };\n        JetAppBase.prototype.createView = function (ui, name, params) {\n            ui = this._override(ui);\n            var obj;\n            if (typeof ui === \"function\") {\n                if (ui.prototype instanceof JetAppBase) {\n                    return new ui({ app: this, name: name, params: params, router: SubRouter });\n                }\n                else if (ui.prototype instanceof JetBase) {\n                    return new ui(this, { name: name, params: params });\n                }\n                else {\n                    ui = ui(this);\n                }\n            }\n            if (ui instanceof JetBase) {\n                obj = ui;\n            }\n            else {\n                obj = new JetViewRaw(this, { name: name, ui: ui });\n            }\n            return obj;\n        };\n        JetAppBase.prototype.show = function (url, config) {\n            if (url && this.app && url.indexOf(\"//\") == 0)\n                return this.app.show(url.substr(1), config);\n            return this.render(this._container, url || this.config.start, config);\n        };\n        JetAppBase.prototype.trigger = function (name) {\n            var rest = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                rest[_i - 1] = arguments[_i];\n            }\n            this.apply(name, rest);\n        };\n        JetAppBase.prototype.apply = function (name, data) {\n            this.callEvent(name, data);\n        };\n        JetAppBase.prototype.action = function (name) {\n            return this.webix.bind(function () {\n                var rest = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    rest[_i] = arguments[_i];\n                }\n                this.apply(name, rest);\n            }, this);\n        };\n        JetAppBase.prototype.on = function (name, handler) {\n            this.attachEvent(name, handler);\n        };\n        JetAppBase.prototype.use = function (plugin, config) {\n            plugin(this, null, config);\n        };\n        JetAppBase.prototype.error = function (name, er) {\n            this.callEvent(name, er);\n            this.callEvent(\"app:error\", er);\n            if (this.config.debug) {\n                for (var i = 0; i < er.length; i++) {\n                    console.error(er[i]);\n                    if (er[i] instanceof Error) {\n                        var text = er[i].message;\n                        if (text.indexOf(\"Module build failed\") === 0) {\n                            text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\n                            document.body.innerHTML = \"<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>\" + text + \"</pre>\";\n                        }\n                        else {\n                            text += \"<br><br>Check console for more details\";\n                            this.webix.message({ type: \"error\", text: text, expire: -1 });\n                        }\n                    }\n                }\n                debugger;\n            }\n        };\n        JetAppBase.prototype.render = function (root, url, config) {\n            var _this = this;\n            this._container = (typeof root === \"string\") ?\n                this.webix.toNode(root) :\n                (root || document.body);\n            var firstInit = !this.$router;\n            var path = null;\n            if (firstInit) {\n                if (_once && \"tagName\" in this._container) {\n                    this.webix.event(document.body, \"click\", function (e) { return _this.clickHandler(e); });\n                    _once = false;\n                }\n                if (typeof url === \"string\") {\n                    url = new Route(url, 0);\n                }\n                this._subSegment = this._first_start(url);\n                this._subSegment.route.linkRouter = true;\n            }\n            else {\n                if (typeof url === \"string\") {\n                    path = url;\n                }\n                else {\n                    if (this.app) {\n                        path = url.split().route.path || this.config.start;\n                    }\n                    else {\n                        path = url.toString();\n                    }\n                }\n            }\n            var params = config ? config.params : this.config.params || null;\n            var top = this.getSubView();\n            var segment = this._subSegment;\n            var ready = segment\n                .show({ url: path, params: params }, top)\n                .then(function () { return _this.createFromURL(segment.current()); })\n                .then(function (view) { return view.render(root, segment); })\n                .then(function (base) {\n                _this.$router.set(segment.route.path, { silent: true });\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return base;\n            });\n            this.ready = this.ready.then(function () { return ready; });\n            return ready;\n        };\n        JetAppBase.prototype.getSubView = function () {\n            if (this._subSegment) {\n                var view = this._subSegment.current().view;\n                if (view)\n                    return view;\n            }\n            return new JetView(this, {});\n        };\n        JetAppBase.prototype.require = function (type, url) { return null; };\n        JetAppBase.prototype._first_start = function (route) {\n            var _this = this;\n            this._segment = route;\n            var cb = function (a) { return setTimeout(function () {\n                _this.show(a).catch(function (e) {\n                    if (!(e instanceof NavigationBlocked))\n                        throw e;\n                });\n            }, 1); };\n            this.$router = new (this.config.router)(cb, this.config, this);\n            if (this._container === document.body && this.config.animation !== false) {\n                var node_1 = this._container;\n                this.webix.html.addCss(node_1, \"webixappstart\");\n                setTimeout(function () {\n                    _this.webix.html.removeCss(node_1, \"webixappstart\");\n                    _this.webix.html.addCss(node_1, \"webixapp\");\n                }, 10);\n            }\n            if (!route) {\n                var urlString = this.$router.get();\n                if (!urlString) {\n                    urlString = this.config.start;\n                    this.$router.set(urlString, { silent: true });\n                }\n                route = new Route(urlString, 0);\n            }\n            else if (this.app) {\n                var now = route.current().view;\n                route.current().view = this;\n                if (route.next()) {\n                    route.refresh();\n                    route = route.split();\n                }\n                else {\n                    route = new Route(this.config.start, 0);\n                }\n                route.current().view = now;\n            }\n            return route;\n        };\n        JetAppBase.prototype._loadError = function (url, err) {\n            this.error(\"app:error:resolve\", [err, url]);\n            return { template: \" \" };\n        };\n        JetAppBase.prototype.addSubView = function (obj, target, config) {\n            var url = obj.$subview !== true ? obj.$subview : null;\n            var name = obj.name || (url ? this.webix.uid() : \"default\");\n            target.id = obj.id || \"s\" + this.webix.uid();\n            var view = config[name] = {\n                id: target.id,\n                url: url,\n                branch: obj.branch,\n                popup: obj.popup,\n                params: obj.params\n            };\n            return view.popup ? null : target;\n        };\n        return JetAppBase;\n    }(JetBase));\n    var HashRouter = (function () {\n        function HashRouter(cb, config) {\n            var _this = this;\n            this.config = config || {};\n            this._detectPrefix();\n            this.cb = cb;\n            window.onpopstate = function () { return _this.cb(_this.get()); };\n        }\n        HashRouter.prototype.set = function (path, config) {\n            var _this = this;\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                for (var key in this.config.routes) {\n                    if (this.config.routes[key] === compare[0]) {\n                        path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                        break;\n                    }\n                }\n            }\n            if (this.get() !== path) {\n                window.history.pushState(null, null, this.prefix + this.sufix + path);\n            }\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        HashRouter.prototype.get = function () {\n            var path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n            path = (path !== \"/\" && path !== \"#\") ? path : \"\";\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                var key = this.config.routes[compare[0]];\n                if (key) {\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                }\n            }\n            return path;\n        };\n        HashRouter.prototype._detectPrefix = function () {\n            var sufix = this.config.routerPrefix;\n            this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n            this.prefix = document.location.href.split(\"#\", 2)[0];\n        };\n        HashRouter.prototype._getRaw = function () {\n            return document.location.href;\n        };\n        return HashRouter;\n    }());\n    var isPatched = false;\n    function patch(w) {\n        if (isPatched || !w) {\n            return;\n        }\n        isPatched = true;\n        var win = window;\n        if (!win.Promise) {\n            win.Promise = w.promise;\n        }\n        var version = w.version.split(\".\");\n        if (version[0] * 10 + version[1] * 1 < 53) {\n            w.ui.freeze = function (handler) {\n                var res = handler();\n                if (res && res.then) {\n                    res.then(function (some) {\n                        w.ui.$freeze = false;\n                        w.ui.resize();\n                        return some;\n                    });\n                }\n                else {\n                    w.ui.$freeze = false;\n                    w.ui.resize();\n                }\n                return res;\n            };\n        }\n        var baseAdd = w.ui.baselayout.prototype.addView;\n        var baseRemove = w.ui.baselayout.prototype.removeView;\n        var config = {\n            addView: function (view, index) {\n                if (this.$scope && this.$scope.webixJet && !view.queryView) {\n                    var jview_1 = this.$scope;\n                    var subs_1 = {};\n                    view = jview_1.app.copyConfig(view, {}, subs_1);\n                    baseAdd.apply(this, [view, index]);\n                    var _loop_1 = function (key) {\n                        jview_1._renderFrame(key, subs_1[key], null).then(function () {\n                            jview_1._subs[key] = subs_1[key];\n                        });\n                    };\n                    for (var key in subs_1) {\n                        _loop_1(key);\n                    }\n                    return view.id;\n                }\n                else {\n                    return baseAdd.apply(this, arguments);\n                }\n            },\n            removeView: function () {\n                baseRemove.apply(this, arguments);\n                if (this.$scope && this.$scope.webixJet) {\n                    var subs = this.$scope._subs;\n                    for (var key in subs) {\n                        var test = subs[key];\n                        if (!w.$$(test.id)) {\n                            test.view.destructor();\n                            delete subs[key];\n                        }\n                    }\n                }\n            }\n        };\n        w.extend(w.ui.layout.prototype, config, true);\n        w.extend(w.ui.baselayout.prototype, config, true);\n        w.protoUI({\n            name: \"jetapp\",\n            $init: function (cfg) {\n                this.$app = new this.app(cfg);\n                var id = w.uid().toString();\n                cfg.body = { id: id };\n                this.$ready.push(function () {\n                    this.callEvent(\"onInit\", [this.$app]);\n                    this.$app.render({ id: id });\n                });\n            }\n        }, w.ui.proxy, w.EventSystem);\n    }\n    var JetApp = (function (_super) {\n        __extends(JetApp, _super);\n        function JetApp(config) {\n            var _this = this;\n            config.router = config.router || HashRouter;\n            _this = _super.call(this, config) || this;\n            patch(_this.webix);\n            return _this;\n        }\n        JetApp.prototype.require = function (type, url) {\n            return require(type + \"/\" + url);\n        };\n        return JetApp;\n    }(JetAppBase));\n    var UrlRouter = (function (_super) {\n        __extends(UrlRouter, _super);\n        function UrlRouter() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        UrlRouter.prototype._detectPrefix = function () {\n            this.prefix = \"\";\n            this.sufix = this.config.routerPrefix || \"\";\n        };\n        UrlRouter.prototype._getRaw = function () {\n            return document.location.pathname + (document.location.search || \"\");\n        };\n        return UrlRouter;\n    }(HashRouter));\n    var EmptyRouter = (function () {\n        function EmptyRouter(cb, _$config) {\n            this.path = \"\";\n            this.cb = cb;\n        }\n        EmptyRouter.prototype.set = function (path, config) {\n            var _this = this;\n            this.path = path;\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        EmptyRouter.prototype.get = function () {\n            return this.path;\n        };\n        return EmptyRouter;\n    }());\n    function UnloadGuard(app, view, config) {\n        view.on(app, \"app:guard\", function (_$url, point, promise) {\n            if (point === view || point.contains(view)) {\n                var res_1 = config();\n                if (res_1 === false) {\n                    promise.confirm = Promise.reject(new NavigationBlocked());\n                }\n                else {\n                    promise.confirm = promise.confirm.then(function () { return res_1; });\n                }\n            }\n        });\n    }\n    function has(store, key) {\n        return Object.prototype.hasOwnProperty.call(store, key);\n    }\n    function forEach(obj, handler, context) {\n        for (var key in obj) {\n            if (has(obj, key)) {\n                handler.call((context || obj), obj[key], key, obj);\n            }\n        }\n    }\n    function trim(str) {\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n    function warn(message) {\n        message = 'Warning: ' + message;\n        if (typeof console !== 'undefined') {\n            console.error(message);\n        }\n        try {\n            throw new Error(message);\n        }\n        catch (x) { }\n    }\n    var replace = String.prototype.replace;\n    var split = String.prototype.split;\n    var delimiter = '||||';\n    var russianPluralGroups = function (n) {\n        var end = n % 10;\n        if (n !== 11 && end === 1) {\n            return 0;\n        }\n        if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n            return 1;\n        }\n        return 2;\n    };\n    var pluralTypes = {\n        arabic: function (n) {\n            if (n < 3) {\n                return n;\n            }\n            var lastTwo = n % 100;\n            if (lastTwo >= 3 && lastTwo <= 10)\n                return 3;\n            return lastTwo >= 11 ? 4 : 5;\n        },\n        bosnian_serbian: russianPluralGroups,\n        chinese: function () { return 0; },\n        croatian: russianPluralGroups,\n        french: function (n) { return n > 1 ? 1 : 0; },\n        german: function (n) { return n !== 1 ? 1 : 0; },\n        russian: russianPluralGroups,\n        lithuanian: function (n) {\n            if (n % 10 === 1 && n % 100 !== 11) {\n                return 0;\n            }\n            return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n        },\n        czech: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            return (n >= 2 && n <= 4) ? 1 : 2;\n        },\n        polish: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            var end = n % 10;\n            return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n        },\n        icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n        slovenian: function (n) {\n            var lastTwo = n % 100;\n            if (lastTwo === 1) {\n                return 0;\n            }\n            if (lastTwo === 2) {\n                return 1;\n            }\n            if (lastTwo === 3 || lastTwo === 4) {\n                return 2;\n            }\n            return 3;\n        }\n    };\n    var pluralTypeToLanguages = {\n        arabic: ['ar'],\n        bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n        chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n        croatian: ['hr', 'hr-HR'],\n        german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n        french: ['fr', 'tl', 'pt-br'],\n        russian: ['ru', 'ru-RU'],\n        lithuanian: ['lt'],\n        czech: ['cs', 'cs-CZ', 'sk'],\n        polish: ['pl'],\n        icelandic: ['is'],\n        slovenian: ['sl-SL']\n    };\n    function langToTypeMap(mapping) {\n        var ret = {};\n        forEach(mapping, function (langs, type) {\n            forEach(langs, function (lang) {\n                ret[lang] = type;\n            });\n        });\n        return ret;\n    }\n    function pluralTypeName(locale) {\n        var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n        return langToPluralType[locale]\n            || langToPluralType[split.call(locale, /-/, 1)[0]]\n            || langToPluralType.en;\n    }\n    function pluralTypeIndex(locale, count) {\n        return pluralTypes[pluralTypeName(locale)](count);\n    }\n    function escape(token) {\n        return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    }\n    function constructTokenRegex(opts) {\n        var prefix = (opts && opts.prefix) || '%{';\n        var suffix = (opts && opts.suffix) || '}';\n        if (prefix === delimiter || suffix === delimiter) {\n            throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n        }\n        return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n    }\n    var dollarRegex = /\\$/g;\n    var dollarBillsYall = '$$';\n    var defaultTokenRegex = /%\\{(.*?)\\}/g;\n    function transformPhrase(phrase, substitutions, locale, tokenRegex) {\n        if (typeof phrase !== 'string') {\n            throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n        }\n        if (substitutions == null) {\n            return phrase;\n        }\n        var result = phrase;\n        var interpolationRegex = tokenRegex || defaultTokenRegex;\n        var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n        if (options.smart_count != null && result) {\n            var texts = split.call(result, delimiter);\n            result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n        }\n        result = replace.call(result, interpolationRegex, function (expression, argument) {\n            if (!has(options, argument) || options[argument] == null) {\n                return expression;\n            }\n            return replace.call(options[argument], dollarRegex, dollarBillsYall);\n        });\n        return result;\n    }\n    function Polyglot(options) {\n        var opts = options || {};\n        this.phrases = {};\n        this.extend(opts.phrases || {});\n        this.currentLocale = opts.locale || 'en';\n        var allowMissing = opts.allowMissing ? transformPhrase : null;\n        this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n        this.warn = opts.warn || warn;\n        this.tokenRegex = constructTokenRegex(opts.interpolation);\n    }\n    Polyglot.prototype.locale = function (newLocale) {\n        if (newLocale)\n            this.currentLocale = newLocale;\n        return this.currentLocale;\n    };\n    Polyglot.prototype.extend = function (morePhrases, prefix) {\n        forEach(morePhrases, function (phrase, key) {\n            var prefixedKey = prefix ? prefix + '.' + key : key;\n            if (typeof phrase === 'object') {\n                this.extend(phrase, prefixedKey);\n            }\n            else {\n                this.phrases[prefixedKey] = phrase;\n            }\n        }, this);\n    };\n    Polyglot.prototype.unset = function (morePhrases, prefix) {\n        if (typeof morePhrases === 'string') {\n            delete this.phrases[morePhrases];\n        }\n        else {\n            forEach(morePhrases, function (phrase, key) {\n                var prefixedKey = prefix ? prefix + '.' + key : key;\n                if (typeof phrase === 'object') {\n                    this.unset(phrase, prefixedKey);\n                }\n                else {\n                    delete this.phrases[prefixedKey];\n                }\n            }, this);\n        }\n    };\n    Polyglot.prototype.clear = function () {\n        this.phrases = {};\n    };\n    Polyglot.prototype.replace = function (newPhrases) {\n        this.clear();\n        this.extend(newPhrases);\n    };\n    Polyglot.prototype.t = function (key, options) {\n        var phrase, result;\n        var opts = options == null ? {} : options;\n        if (typeof this.phrases[key] === 'string') {\n            phrase = this.phrases[key];\n        }\n        else if (typeof opts._ === 'string') {\n            phrase = opts._;\n        }\n        else if (this.onMissingKey) {\n            var onMissingKey = this.onMissingKey;\n            result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n        }\n        else {\n            this.warn('Missing translation for key: \"' + key + '\"');\n            result = key;\n        }\n        if (typeof phrase === 'string') {\n            result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n        }\n        return result;\n    };\n    Polyglot.prototype.has = function (key) {\n        return has(this.phrases, key);\n    };\n    Polyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n        return transformPhrase(phrase, substitutions, locale);\n    };\n    var webixPolyglot = Polyglot;\n    function Locale(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n        function setLangData(name, data, silent) {\n            if (data.__esModule) {\n                data = data.default;\n            }\n            var pconfig = { phrases: data };\n            if (config.polyglot) {\n                app.webix.extend(pconfig, config.polyglot);\n            }\n            var poly = service.polyglot = new webixPolyglot(pconfig);\n            poly.locale(name);\n            service._ = app.webix.bind(poly.t, poly);\n            lang = name;\n            if (storage) {\n                storage.put(\"lang\", lang);\n            }\n            if (config.webix) {\n                var locName = config.webix[name];\n                if (locName) {\n                    app.webix.i18n.setLocale(locName);\n                }\n            }\n            if (!silent) {\n                return app.refresh();\n            }\n            return Promise.resolve();\n        }\n        function getLang() { return lang; }\n        function setLang(name, silent) {\n            if (config.path === false) {\n                return;\n            }\n            var path = (config.path ? config.path + \"/\" : \"\") + name;\n            var data = app.require(\"jet-locales\", path);\n            setLangData(name, data, silent);\n        }\n        var service = {\n            getLang: getLang, setLang: setLang, setLangData: setLangData, _: null, polyglot: null\n        };\n        app.setService(\"locale\", service);\n        setLang(lang, true);\n    }\n    function show(view, config, value) {\n        var _a;\n        if (config.urls) {\n            value = config.urls[value] || value;\n        }\n        else if (config.param) {\n            value = (_a = {}, _a[config.param] = value, _a);\n        }\n        view.show(value);\n    }\n    function Menu(app, view, config) {\n        var frame = view.getSubViewInfo().parent;\n        var ui = view.$$(config.id || config);\n        var silent = false;\n        ui.attachEvent(\"onchange\", function () {\n            if (!silent) {\n                show(frame, config, this.getValue());\n            }\n        });\n        ui.attachEvent(\"onafterselect\", function () {\n            if (!silent) {\n                var id = null;\n                if (ui.setValue) {\n                    id = this.getValue();\n                }\n                else if (ui.getSelectedId) {\n                    id = ui.getSelectedId();\n                }\n                show(frame, config, id);\n            }\n        });\n        view.on(app, \"app:route\", function () {\n            var name = \"\";\n            if (config.param) {\n                name = view.getParam(config.param, true);\n            }\n            else {\n                var segment = frame.getUrl()[1];\n                if (segment) {\n                    name = segment.page;\n                }\n            }\n            if (name) {\n                silent = true;\n                if (ui.setValue && ui.getValue() !== name) {\n                    ui.setValue(name);\n                }\n                else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\n                    ui.select(name);\n                }\n                silent = false;\n            }\n        });\n    }\n    var baseicons = {\n        good: \"check\",\n        error: \"warning\",\n        saving: \"refresh fa-spin\"\n    };\n    var basetext = {\n        good: \"Ok\",\n        error: \"Error\",\n        saving: \"Connecting...\"\n    };\n    function Status(app, view, config) {\n        var status = \"good\";\n        var count = 0;\n        var iserror = false;\n        var expireDelay = config.expire;\n        if (!expireDelay && expireDelay !== false) {\n            expireDelay = 2000;\n        }\n        var texts = config.texts || basetext;\n        var icons = config.icons || baseicons;\n        if (typeof config === \"string\") {\n            config = { target: config };\n        }\n        function refresh(content) {\n            var area = view.$$(config.target);\n            if (area) {\n                if (!content) {\n                    content = \"<div class='status_\" +\n                        status +\n                        \"'><span class='webix_icon fa-\" +\n                        icons[status] + \"'></span> \" + texts[status] + \"</div>\";\n                }\n                area.setHTML(content);\n            }\n        }\n        function success() {\n            count--;\n            setStatus(\"good\");\n        }\n        function fail(err) {\n            count--;\n            setStatus(\"error\", err);\n        }\n        function start(promise) {\n            count++;\n            setStatus(\"saving\");\n            if (promise && promise.then) {\n                promise.then(success, fail);\n            }\n        }\n        function getStatus() {\n            return status;\n        }\n        function hideStatus() {\n            if (count === 0) {\n                refresh(\" \");\n            }\n        }\n        function setStatus(mode, err) {\n            if (count < 0) {\n                count = 0;\n            }\n            if (mode === \"saving\") {\n                status = \"saving\";\n                refresh();\n            }\n            else {\n                iserror = (mode === \"error\");\n                if (count === 0) {\n                    status = iserror ? \"error\" : \"good\";\n                    if (iserror) {\n                        app.error(\"app:error:server\", [err.responseText || err]);\n                    }\n                    else {\n                        if (expireDelay) {\n                            setTimeout(hideStatus, expireDelay);\n                        }\n                    }\n                    refresh();\n                }\n            }\n        }\n        function track(data) {\n            var dp = app.webix.dp(data);\n            if (dp) {\n                view.on(dp, \"onAfterDataSend\", start);\n                view.on(dp, \"onAfterSaveError\", function (_id, _obj, response) { return fail(response); });\n                view.on(dp, \"onAfterSave\", success);\n            }\n        }\n        app.setService(\"status\", {\n            getStatus: getStatus,\n            setStatus: setStatus,\n            track: track\n        });\n        if (config.remote) {\n            view.on(app.webix, \"onRemoteCall\", start);\n        }\n        if (config.ajax) {\n            view.on(app.webix, \"onBeforeAjax\", function (_mode, _url, _data, _request, _headers, _files, promise) {\n                start(promise);\n            });\n        }\n        if (config.data) {\n            track(config.data);\n        }\n    }\n    function Theme(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var theme = storage ?\n            (storage.get(\"theme\") || \"flat-default\")\n            :\n                (config.theme || \"flat-default\");\n        var service = {\n            getTheme: function () { return theme; },\n            setTheme: function (name, silent) {\n                var parts = name.split(\"-\");\n                var links = document.getElementsByTagName(\"link\");\n                for (var i = 0; i < links.length; i++) {\n                    var lname = links[i].getAttribute(\"title\");\n                    if (lname) {\n                        if (lname === name || lname === parts[0]) {\n                            links[i].disabled = false;\n                        }\n                        else {\n                            links[i].disabled = true;\n                        }\n                    }\n                }\n                app.webix.skin.set(parts[0]);\n                app.webix.html.removeCss(document.body, \"theme-\" + theme);\n                app.webix.html.addCss(document.body, \"theme-\" + name);\n                theme = name;\n                if (storage) {\n                    storage.put(\"theme\", name);\n                }\n                if (!silent) {\n                    app.refresh();\n                }\n            }\n        };\n        app.setService(\"theme\", service);\n        service.setTheme(theme, true);\n    }\n    function copyParams(data, url, route) {\n        for (var i = 0; i < route.length; i++) {\n            data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\n        }\n    }\n    function UrlParam(app, view, config) {\n        var route = config.route || config;\n        var data = {};\n        view.on(app, \"app:urlchange\", function (subview, segment) {\n            if (view === subview) {\n                copyParams(data, segment.suburl(), route);\n                segment.size(route.length + 1);\n            }\n        });\n        var os = view.setParam;\n        var og = view.getParam;\n        view.setParam = function (name, value, show) {\n            var index = route.indexOf(name);\n            if (index >= 0) {\n                data[name] = value;\n                this._segment.update(\"\", value, index + 1);\n                if (show) {\n                    return view.show(null);\n                }\n            }\n            else {\n                return os.call(this, name, value, show);\n            }\n        };\n        view.getParam = function (key, mode) {\n            var val = data[key];\n            if (typeof val !== \"undefined\") {\n                return val;\n            }\n            return og.call(this, key, mode);\n        };\n        copyParams(data, view.getUrl(), route);\n    }\n    function User(app, _view, config) {\n        config = config || {};\n        var login = config.login || \"/login\";\n        var logout = config.logout || \"/logout\";\n        var afterLogin = config.afterLogin || app.config.start;\n        var afterLogout = config.afterLogout || \"/login\";\n        var ping = config.ping || 5 * 60 * 1000;\n        var model = config.model;\n        var user = config.user;\n        var service = {\n            getUser: function () {\n                return user;\n            },\n            getStatus: function (server) {\n                if (!server) {\n                    return user !== null;\n                }\n                return model.status().catch(function () { return null; }).then(function (data) {\n                    user = data;\n                });\n            },\n            login: function (name, pass) {\n                return model.login(name, pass).then(function (data) {\n                    user = data;\n                    if (!data) {\n                        throw new Error(\"Access denied\");\n                    }\n                    app.callEvent(\"app:user:login\", [user]);\n                    app.show(afterLogin);\n                });\n            },\n            logout: function () {\n                user = null;\n                return model.logout().then(function (res) {\n                    app.callEvent(\"app:user:logout\", []);\n                    return res;\n                });\n            }\n        };\n        function canNavigate(url, obj) {\n            if (url === logout) {\n                service.logout();\n                obj.redirect = afterLogout;\n            }\n            else if (url !== login && !service.getStatus()) {\n                obj.redirect = login;\n            }\n        }\n        app.setService(\"user\", service);\n        app.attachEvent(\"app:guard\", function (url, _$root, obj) {\n            if (config.public && config.public(url)) {\n                return true;\n            }\n            if (typeof user === \"undefined\") {\n                obj.confirm = service.getStatus(true).then(function () { return canNavigate(url, obj); });\n            }\n            return canNavigate(url, obj);\n        });\n        if (ping) {\n            setInterval(function () { return service.getStatus(true); }, ping);\n        }\n    }\n    var webix$1 = window.webix;\n    if (webix$1) {\n        patch(webix$1);\n    }\n    var plugins = {\n        UnloadGuard: UnloadGuard, Locale: Locale, Menu: Menu, Theme: Theme, User: User, Status: Status, UrlParam: UrlParam\n    };\n    var w = window;\n    if (!w.Promise) {\n        w.Promise = w.webix.promise;\n    }\n\n    var index = 1;\n    function uid() {\n        return index++;\n    }\n    var empty = undefined;\n    function ignoreInitial(code) {\n        var init = false;\n        return function () {\n            if (init)\n                return code.apply(this, arguments);\n            else\n                init = true;\n        };\n    }\n    var context = null;\n    function link(source, target, key) {\n        Object.defineProperty(target, key, {\n            get: function () { return source[key]; },\n            set: function (value) { return (source[key] = value); },\n        });\n    }\n    function createState(data, config) {\n        config = config || {};\n        var handlers = {};\n        var out = {};\n        var observe = function (mask, handler) {\n            var key = uid();\n            handlers[key] = { mask: mask, handler: handler };\n            if (mask === \"*\")\n                handler(out, empty, mask);\n            else\n                handler(out[mask], empty, mask);\n            return key;\n        };\n        var observeEnd = function (id) {\n            delete handlers[id];\n        };\n        var queue = [];\n        var waitInQueue = false;\n        var batch = function (code) {\n            if (typeof code !== \"function\") {\n                var values_1 = code;\n                code = function () {\n                    for (var key in values_1)\n                        out[key] = values_1[key];\n                };\n            }\n            waitInQueue = true;\n            code(out);\n            waitInQueue = false;\n            while (queue.length) {\n                var obj = queue.shift();\n                notify.apply(this, obj);\n            }\n        };\n        var notify = function (key, old, value, meta) {\n            if (waitInQueue) {\n                queue.push([key, old, value, meta]);\n                return;\n            }\n            var list = Object.keys(handlers);\n            for (var i = 0; i < list.length; i++) {\n                var obj = handlers[list[i]];\n                if (!obj)\n                    continue;\n                if (obj.mask === \"*\" || obj.mask === key) {\n                    obj.handler(value, old, key, meta);\n                }\n            }\n        };\n        for (var key2 in data) {\n            if (data.hasOwnProperty(key2)) {\n                var test = data[key2];\n                if (config.nested && typeof test === \"object\" && test) {\n                    out[key2] = createState(test, config);\n                }\n                else {\n                    reactive(out, test, key2, notify);\n                }\n            }\n        }\n        Object.defineProperty(out, \"$changes\", {\n            value: {\n                attachEvent: observe,\n                detachEvent: observeEnd,\n            },\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$observe\", {\n            value: observe,\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$batch\", {\n            value: batch,\n            enumerable: false,\n            configurable: false,\n        });\n        return out;\n    }\n    function reactive(obj, val, key, notify) {\n        Object.defineProperty(obj, key, {\n            get: function () {\n                return val;\n            },\n            set: function (value) {\n                var changed = false;\n                if (val === null || value === null) {\n                    changed = val !== value;\n                }\n                else {\n                    changed = val.valueOf() != value.valueOf();\n                }\n                if (changed) {\n                    var old = val;\n                    val = value;\n                    notify(key, old, value, context);\n                }\n            },\n            enumerable: true,\n            configurable: false,\n        });\n    }\n\n    var ActionsPopupView = (function (_super) {\n        __extends(ActionsPopupView, _super);\n        function ActionsPopupView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        ActionsPopupView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            return {\n                view: \"popup\",\n                point: false,\n                body: {\n                    view: \"list\",\n                    yCount: 4,\n                    width: 120,\n                    borderless: true,\n                    data: [\n                        { id: \"edit\", value: _(\"Edit\") },\n                        { id: \"add-filter\", value: _(\"Add Filter\") },\n                        { id: \"add-group\", value: _(\"Add Group\") },\n                        { id: \"delete\", value: _(\"Delete\") },\n                    ],\n                    click: function (id) {\n                        _this.app.callEvent(\"action\", [id, _this.Item]);\n                        _this.Hide();\n                    },\n                },\n            };\n        };\n        ActionsPopupView.prototype.Hide = function () {\n            this.getRoot().hide();\n        };\n        ActionsPopupView.prototype.Show = function (node, item) {\n            this.Item = item;\n            var pos = webix.html.offset(node);\n            this.getRoot().show({\n                x: pos.x + pos.width + webix.skin.$active.dataPadding,\n                y: pos.y - 10,\n            });\n        };\n        return ActionsPopupView;\n    }(JetView));\n\n    var menuRight = \"<span style='float:right' class='webix_icon action-menu wxi-dots'></span>\";\n    var menuClose = \"<span style='float:right' class='webix_icon action-close wxi-close'></span>\";\n\n    var BaseView = (function (_super) {\n        __extends(BaseView, _super);\n        function BaseView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        BaseView.prototype.GetButton = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var button = {\n                view: \"button\",\n                value: _(\"Add filter\"),\n                localId: \"button\",\n                css: \"webix_primary\",\n                click: function () { return _this.Add(null, null); },\n            };\n            return button;\n        };\n        BaseView.prototype.GetList = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var simple = this.getParam(\"simple\");\n            var icon = simple ? menuClose : menuRight;\n            var AND = _(\"and\");\n            var OR = _(\"or\");\n            var GLUE = function (obj) { return (obj.glue == \"and\" ? AND : OR); };\n            var list = {\n                view: \"tree\",\n                borderless: true,\n                localId: \"list\",\n                glue: \"and\",\n                css: \"wbq-query_list\",\n                scheme: {\n                    $serialize: function (obj) {\n                        if (obj.group) {\n                            return { group: obj.group, glue: obj.glue };\n                        }\n                        var out = {\n                            glue: obj.glue,\n                            field: obj.field,\n                            condition: obj.condition,\n                        };\n                        if (obj.includes && obj.includes.length)\n                            out.includes = obj.includes;\n                        return out;\n                    },\n                    $init: function (obj) {\n                        if (obj.group) {\n                            obj.$css = \"group\";\n                            obj.open = true;\n                        }\n                    },\n                },\n                type: {\n                    template: function (obj) {\n                        if (obj.group) {\n                            var editCss = _this.DisableSwitch\n                                ? \"wbq-filter_join_disabled\"\n                                : \"\";\n                            return \"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \" \" + editCss + \"'>\" + GLUE(obj) + \"</div>\";\n                        }\n                        return (_this.Template(obj, _this.app.config.fields, icon, _) +\n                            (\"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \"'>\" + GLUE(obj) + \"</div>\"));\n                    },\n                },\n                onClick: {\n                    \"action-menu\": function (e, id) {\n                        this.$scope.Actions.Show(e.target, id);\n                    },\n                    \"action-close\": function (e, id) {\n                        _this.Delete(id);\n                    },\n                    \"wbq-filter_join\": function (e, id) {\n                        _this.SwitchGlue(id);\n                    },\n                },\n                on: {\n                    onItemDblClick: function (id) {\n                        _this.EditStart(id);\n                    },\n                },\n            };\n            return list;\n        };\n        BaseView.prototype.init = function () {\n            var _this = this;\n            this.Actions = this.ui(ActionsPopupView);\n            this.on(this.app, \"applyFilter\", function (v) { return _this.EditStop(v); });\n            this.on(this.app, \"action\", function (type, id) {\n                if (type === \"delete\") {\n                    _this.Delete(id);\n                }\n                else if (type === \"add-filter\") {\n                    _this.Add(null, id);\n                }\n                else if (type === \"add-group\") {\n                    _this.AddGroup(null, id);\n                }\n                else if (type === \"edit\") {\n                    webix.delay(function () { return _this.EditStart(id); });\n                }\n            });\n            this.State = this.getParam(\"state\");\n            this.on(this.State.$changes, \"value\", function (v) {\n                _this.LastValue = JSON.stringify(v);\n                _this.EditStop();\n                _this.$$(\"list\").clearAll();\n                if (v) {\n                    _this.$$(\"list\").parse(_this.ConvertTo(v));\n                }\n            });\n        };\n        BaseView.prototype.ConvertTo = function (v, glue) {\n            var _this = this;\n            if (v.rules) {\n                var data = v.rules.map(function (a) { return _this.ConvertTo(a, v.glue); });\n                if (!glue)\n                    return data;\n                return { group: true, glue: glue, data: data };\n            }\n            var out = __assign(__assign({}, v), { glue: glue });\n            return out;\n        };\n        BaseView.prototype.ConvertFrom = function (id, source) {\n            var _this = this;\n            var glue = \"and\";\n            var branch = source.getBranch(id);\n            var rules = branch.map(function (_a) {\n                var id = _a.id, field = _a.field, type = _a.type, condition = _a.condition, includes = _a.includes;\n                if (field)\n                    return { field: field, type: type, condition: condition, includes: includes };\n                return _this.ConvertFrom(id, source);\n            });\n            if (!rules.length)\n                return null;\n            glue = branch[0].glue;\n            return { glue: glue, rules: rules };\n        };\n        BaseView.prototype.Add = function (obj, after) {\n            this.EditStop();\n            obj = obj || { field: \"\" };\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            if (!after && list.count())\n                after = list.getFirstId();\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            obj.glue = glue;\n            var id = list.add(obj, index, parent);\n            this.EditStart(id);\n            this.CreateMode = true;\n        };\n        BaseView.prototype.SwitchGlue = function (id) {\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var branch = list.data.getBranch(list.getParentId(id));\n            for (var i = 0; i < branch.length; i++) {\n                list.updateItem(branch[i].id, {\n                    glue: branch[i].glue == \"and\" ? \"or\" : \"and\",\n                });\n            }\n            this.Save();\n        };\n        BaseView.prototype.AddGroup = function (obj, after) {\n            this.EditStop();\n            obj = obj || {};\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            var node = { id: webix.uid(), group: true };\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            node.glue = glue;\n            obj.glue = node.glue == \"and\" ? \"or\" : \"and\";\n            this.DisableSwitch = true;\n            list.add(node, index, parent);\n            var id = list.add(obj, null, node.id);\n            this.EditStart(id);\n            this.DisableSwitch = false;\n            this.CreateMode = true;\n        };\n        BaseView.prototype.Delete = function (id) {\n            this.EditStop();\n            this.DeleteSilent(id);\n            this.Save();\n        };\n        BaseView.prototype.DeleteSilent = function (id) {\n            var list = this.$$(\"list\");\n            if (!list.exists(id))\n                return null;\n            var parent = list.getParentId(id);\n            list.remove(id);\n            var branch = list.data.branch[parent];\n            if (parent && !branch) {\n                this.DeleteSilent(parent);\n            }\n            else if (branch.length == 1 && list.getItem(branch[0]).group) {\n                var sub = branch[0];\n                if (parent) {\n                    var grand = list.getParentId(parent);\n                    var pIndex = list.getBranchIndex(parent, grand);\n                    list.move(sub, pIndex, list, { parent: grand });\n                    this.DeleteSilent(parent);\n                }\n                else {\n                    var pIndex = list.getBranchIndex(sub, 0);\n                    var kids = [].concat(list.data.branch[sub]);\n                    list.move(kids, pIndex, list, { parent: 0 });\n                    this.DeleteSilent(sub);\n                }\n            }\n        };\n        BaseView.prototype.EditStop = function (v) {\n            if (!this.Active)\n                return;\n            var list = this.$$(\"list\");\n            if (!v) {\n                if (this.CreateMode)\n                    this.DeleteSilent(this.ActiveId);\n                else\n                    list.refresh(this.ActiveId);\n            }\n            else {\n                v = v || this.Active.GetValue();\n                v.includes = v.includes || [];\n                list.updateItem(this.ActiveId, __assign({}, v));\n            }\n            var t = this.Active;\n            this.Active = null;\n            this.ActiveId = null;\n            t.destructor();\n            this.Save();\n        };\n        BaseView.prototype.Save = function () {\n            var v = this.ConvertFrom(0, this.$$(\"list\").data);\n            var asString = JSON.stringify(v);\n            if (this.LastValue !== asString) {\n                this.State.value = v;\n            }\n        };\n        BaseView.prototype.Template = function (obj, fields, icon, _) {\n            var op = \"&nbsp;\";\n            var field = fields.find(function (a) { return a.id === obj.field; }) || { value: \"\" };\n            if (obj.includes && obj.includes.length) {\n                op = _(\"in\") + \" \";\n                for (var i = 0; i < obj.includes.length; i++) {\n                    op +=\n                        (i > 0 ? \", \" : \"\") +\n                            (\"<span class='wbq-field-value'>\" + obj.includes[i] + \"</span>\");\n                }\n            }\n            else {\n                if (obj.condition && obj.condition.type) {\n                    op = _(obj.condition.type) + \" <span class='wbq-field-value'>\" + this.Format(obj.condition.filter, field.format, field.type) + \"</span>\";\n                }\n            }\n            return \"<span class='wbq-field-box'><span class='wbq-field-name'>\" + field.value + \"</span> \" + op + \" </span>\" + icon;\n        };\n        BaseView.prototype.Format = function (value, format, type) {\n            if (!value)\n                return \"\";\n            if (value.start)\n                value =\n                    this.Format(value.start, format, type) +\n                        (value.end ? \" - \" + this.Format(value.end, format, type) : \"\");\n            else {\n                var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                if (parser)\n                    value = parser(value);\n            }\n            return value;\n        };\n        return BaseView;\n    }(JetView));\n\n    var FilterView = (function (_super) {\n        __extends(FilterView, _super);\n        function FilterView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var fieldselect = {\n                view: \"richselect\",\n                options: [],\n                localId: \"field\",\n                on: {\n                    onChange: function () { return _this.AdjustToField(); },\n                },\n            };\n            var filter = { localId: \"filter\" };\n            var bottombar = {\n                type: \"clean\",\n                cols: [\n                    {\n                        view: \"button\",\n                        value: _(\"Cancel\"),\n                        width: 100,\n                        click: function () { return _this.Hide(); },\n                    },\n                    {},\n                    {\n                        view: \"button\",\n                        value: _(\"Apply\"),\n                        width: 100,\n                        css: \"webix_primary\",\n                        click: function () { return _this.ApplyFilter(); },\n                    },\n                ],\n            };\n            return {\n                padding: 10,\n                margin: 6,\n                css: \"webix_shadow_small\",\n                rows: [fieldselect, filter, bottombar],\n            };\n        };\n        FilterView.prototype.GetField = function () {\n            var fselect = this.$$(\"field\");\n            return fselect.getList().getItem(fselect.getValue());\n        };\n        FilterView.prototype.AdjustToField = function () {\n            var field = this.GetField();\n            this.CreateFilter(field.id, field.type, field.format, field.conditions, this.$$(\"filter\"));\n        };\n        FilterView.prototype.CreateFilter = function (field, type, format, conditions, place) {\n            var ui = {\n                view: \"filter\",\n                localId: \"filter\",\n                conditions: conditions,\n                field: field,\n                mode: type,\n                template: function (o) {\n                    var str = o[field];\n                    var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                    if (parser)\n                        str = parser(str);\n                    return str;\n                },\n                margin: 6,\n            };\n            var filter = webix.ui(ui, place);\n            var data = this.app.getService(\"backend\").data(field);\n            filter.parse(data);\n            return filter;\n        };\n        FilterView.prototype.ApplyFilter = function () {\n            this.app.callEvent(\"applyFilter\", [this.GetValue()]);\n        };\n        FilterView.prototype.GetValue = function () {\n            var field = this.GetField();\n            var rule = __assign(__assign({}, this.$$(\"filter\").getValue()), { field: field.id, type: field.type });\n            if (rule.condition.filter == \"\" &&\n                (!rule.includes || !rule.includes.length))\n                rule = null;\n            return rule;\n        };\n        FilterView.prototype.Hide = function () {\n            this.app.callEvent(\"applyFilter\", [null]);\n        };\n        FilterView.prototype.Show = function (value, fields) {\n            var fselect = this.$$(\"field\");\n            fselect.getList().parse(fields);\n            if (value.field) {\n                fselect.setValue(value.field);\n            }\n            else {\n                fselect.setValue(fields[0].id);\n            }\n            this.$$(\"filter\").setValue(webix.copy(value));\n        };\n        return FilterView;\n    }(JetView));\n\n    var FilterPopup = (function (_super) {\n        __extends(FilterPopup, _super);\n        function FilterPopup() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterPopup.prototype.config = function () {\n            return {\n                view: \"popup\",\n                point: false,\n                body: { $subview: FilterView, name: \"body\" },\n            };\n        };\n        FilterPopup.prototype.Show = function (value, fields, at) {\n            var _this = this;\n            setTimeout(function () {\n                _this.getRoot().show(at);\n                _this.getSubView(\"body\").Show(value, fields);\n            }, 100);\n        };\n        return FilterPopup;\n    }(JetView));\n\n    var TopBarView = (function (_super) {\n        __extends(TopBarView, _super);\n        function TopBarView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopBarView.prototype.config = function () {\n            var button = this.GetButton();\n            button.width = 100;\n            var list = this.GetList();\n            list.scroll = this.app.config.scroll !== false ? \"x\" : \"\";\n            list.borderless = true;\n            list.css = \"wbq-query_bar\";\n            var small = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n            var padding = 8, height = 58;\n            if (small) {\n                padding = 4;\n                height = 50;\n            }\n            if (list.scroll)\n                height += webix.env.scrollSize;\n            return {\n                view: \"toolbar\",\n                paddingX: padding * 2,\n                paddingY: padding,\n                height: height,\n                borderless: true,\n                cols: [list, button],\n            };\n        };\n        TopBarView.prototype.EditStart = function (id) {\n            var _this = this;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            this.ActiveId = id;\n            this.Active = this.ui(FilterPopup);\n            this.Active.getRoot().attachEvent(\"onHide\", function () {\n                if (_this.Active)\n                    _this.EditStop();\n            });\n            var at = webix.html.offset(list.getItemNode(id));\n            this.Active.Show(list.getItem(id), this.app.config.fields, at);\n            this.CreateMode = false;\n        };\n        return TopBarView;\n    }(BaseView));\n\n    var TopListView = (function (_super) {\n        __extends(TopListView, _super);\n        function TopListView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopListView.prototype.config = function () {\n            return {\n                paddingX: 16,\n                paddingY: 8,\n                margin: 0,\n                rows: [this.GetButton(), this.GetList()],\n            };\n        };\n        TopListView.prototype.EditStart = function (id) {\n            var _this = this;\n            if (this.ActiveId && this.ActiveId == id)\n                return;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var container = list.getItemNode(id);\n            container.classList.add(\"active-editor\");\n            container.innerHTML = \"\";\n            this.ActiveId = id;\n            this.Active = this.ui(FilterView, { container: container });\n            this.$$(\"list\").attachEvent(\"onAfterRender\", function () { return _this.EditStop(); });\n            this.Active.Show(list.getItem(id), this.app.config.fields);\n            this.CreateMode = false;\n        };\n        return TopListView;\n    }(BaseView));\n\n    var views = { JetView: JetView };\n    views[\"actions\"] = ActionsPopupView;\n    views[\"bar\"] = TopBarView;\n    views[\"base\"] = BaseView;\n    views[\"filter\"] = FilterView;\n    views[\"list\"] = TopListView;\n    views[\"popup\"] = FilterPopup;\n\n    var en = {\n        \"Add filter\": \"Add filter\",\n        in: \"=\",\n        equal: \"=\",\n        notEqual: \"<>\",\n        less: \"<\",\n        greater: \">\",\n        greaterOrEqual: \">=\",\n        lessOrEqual: \"<=\",\n        contains: \"contains\",\n        notContains: \"not contains\",\n        beginsWith: \"begins\",\n        notBeginsWith: \"not begings\",\n        endsWith: \"ends\",\n        notEndsWith: \"not ends\",\n        between: \"between\",\n        notBetween: \"not between\",\n        and: \"and\",\n        or: \"or\",\n        Edit: \"Edit\",\n        \"Add Filter\": \"Add Filter\",\n        \"Add Group\": \"Add Group\",\n        Delete: \"Delete\",\n        Apply: \"Apply\",\n        Cancel: \"Cancel\",\n    };\n\n    var Backend = (function () {\n        function Backend(app) {\n            this._app = app;\n        }\n        Backend.prototype.data = function (field) {\n            var data = this._app.config.data;\n            if (typeof data == \"function\")\n                return Promise.resolve(data(field)).then(function (a) {\n                    return a.map(function (b) {\n                        var _a;\n                        return (_a = {}, _a[field] = b, _a);\n                    });\n                });\n            return Promise.resolve(data);\n        };\n        Backend.prototype.save = function (v) {\n            console.log(v);\n        };\n        return Backend;\n    }());\n\n    function query(query, fields) {\n        var ops = webix.filters;\n        var types = {};\n        fields.forEach(function (a) {\n            if (a.conditions)\n                a.conditions.forEach(function (op) {\n                    if (typeof op === \"object\") {\n                        ops[op.id] = op.handler;\n                    }\n                });\n            if (a.type)\n                types[a.id] = a.type;\n        });\n        return queryToFilter(query, ops, types);\n    }\n    function queryToFilter(query, ops, types) {\n        if (!query || !query.rules.length)\n            return function () { return true; };\n        var filters = query.rules.map(function (a) { return singleFilter(a, ops, types); });\n        return (query.glue === \"or\" ? glueOr : glueAnd)(filters);\n    }\n    function glueAnd(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (!f[i](v))\n                    return false;\n            }\n            return true;\n        };\n    }\n    function glueOr(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (f[i](v))\n                    return true;\n            }\n            return false;\n        };\n    }\n    function singleFilter(rule, ops, types) {\n        if (rule.rules) {\n            return queryToFilter(rule, ops, types);\n        }\n        return function (v) {\n            var test = v[rule.field];\n            if (rule.includes && rule.includes.length) {\n                return rule.includes.findIndex(function (a) { return a === test; }) !== -1;\n            }\n            if (!webix.isUndefined(test)) {\n                var con = rule.condition.type;\n                var filter = ops[con] || ops[types[rule.field]][con];\n                return filter(test, rule.condition.filter);\n            }\n            return false;\n        };\n    }\n\n    var App = (function (_super) {\n        __extends(App, _super);\n        function App(config) {\n            var _this = this;\n            var state = createState({\n                value: config.value || null,\n            });\n            var defaults = {\n                router: EmptyRouter,\n                version: \"10.0.9\",\n                debug: true,\n            };\n            _this = _super.call(this, __assign(__assign({}, defaults), config)) || this;\n            _this.config.start = config.type === \"bar\" ? \"/bar\" : \"/list\";\n            _this.config.params = { state: state, simple: config.simple === true };\n            _this.setService(\"backend\", new (_this.dynamic(Backend))(_this));\n            _this.use(plugins.Locale, _this.config.locale || {\n                lang: \"en\",\n                webix: {\n                    en: \"en-US\",\n                },\n            });\n            return _this;\n        }\n        App.prototype.dynamic = function (obj) {\n            return this.config.override ? this.config.override.get(obj) || obj : obj;\n        };\n        App.prototype.require = function (type, name) {\n            if (type === \"jet-views\")\n                return views[name];\n            else if (type === \"jet-locales\")\n                return locales[name];\n            return null;\n        };\n        App.prototype.getState = function () {\n            return this.config.params.state;\n        };\n        App.prototype.GetFilter = function () {\n            return query(this.config.params.state.value, this.config.fields);\n        };\n        return App;\n    }(JetApp));\n    webix.protoUI({\n        name: \"query\",\n        app: App,\n        getState: function () {\n            return this.$app.getState();\n        },\n        getService: function (name) {\n            return this.$app.getService(name);\n        },\n        $init: function () {\n            var _this = this;\n            var state = this.getState();\n            for (var key in state) {\n                link(state, this.config, key);\n            }\n            state.$changes.attachEvent(\"value\", ignoreInitial(function (v, o) { return _this.callEvent(\"onChange\", v, o); }));\n        },\n        getFilterFunction: function () {\n            return this.$app.GetFilter();\n        },\n    }, webix.ui.jetapp);\n    var services = { Backend: Backend };\n    var locales = { en: en };\n\n    exports.App = App;\n    exports.locales = locales;\n    exports.services = services;\n    exports.views = views;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\nimport \"../../helpers/inputlist\";\nimport { removeRight } from \"../../helpers/icons\";\n\nexport default class CommonView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tlet form = {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 130,\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Report name\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\tlocalId: \"name\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Description\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tname: \"desc\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Data source\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"combo\",\n\t\t\t\t\t\t\tname: \"data\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"input-list\",\n\t\t\t\t\tname: \"joins\",\n\t\t\t\t\ttemplate: this.JoinListTemplate.bind(this),\n\t\t\t\t\tdata: [],\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_rpt_action_remove: (ev, id) => this.RemoveJoin(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tlabel: _(\"Join data\"),\n\t\t\t\t\tclick: () => this.ShowJoins(),\n\t\t\t\t},\n\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Delete report\"),\n\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\tinputWidth: 170,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tcss: \"webix_rpt_delete\",\n\t\t\t\t\tclick: () => this.app.callEvent(\"onMenuAction\", [null, \"delete\"]),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tconst els = this.getRoot().elements;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.AppState = this.app.getParam(\"state\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Models = this.Local.getModels(true);\n\n\t\tconst keys = Object.keys(this.Models);\n\t\tconst combo = els.data;\n\t\tcombo.getList().parse(\n\t\t\tkeys.map(a => {\n\t\t\t\tconst m = this.Models[a];\n\t\t\t\treturn { id: m.id, value: m.name };\n\t\t\t})\n\t\t);\n\n\t\tbind(this.State, \"*\", this.getRoot(), this);\n\t\tthis.on(this.State.$changes, \"id\", v => this.ShowDeleteButton(v));\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowDeleteButton(v));\n\n\t\tthis.SourcesList = this.ui({\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tautoheight: true,\n\t\t\t\ttype: {\n\t\t\t\t\ttemplate: this.JoinTemplate.bind(this),\n\t\t\t\t},\n\t\t\t\tclick: id => {\n\t\t\t\t\tconst item = this.SourcesList.getBody().getItem(id);\n\t\t\t\t\tthis.AddJoin(item);\n\t\t\t\t\tthis.SourcesList.hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tAddJoin(item) {\n\t\tconst batch = this.Local.addJoin(item.tid, this.State);\n\t\tbatch.joins = [...this.State.joins, item];\n\t\tthis.State.$batch(batch);\n\t}\n\n\tRemoveJoin(id) {\n\t\tconst next = this.Local.cleanLinkedModels(id, this.State);\n\n\t\tif (!next.block) this.State.$batch(next);\n\t\telse {\n\t\t\tif (next.block.filter)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related query filter first\"),\n\t\t\t\t});\n\t\t\tif (next.block.group)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related group rule first\"),\n\t\t\t\t});\n\t\t}\n\t}\n\n\tJoinTemplate(obj) {\n\t\tconst s = this.Models[obj.sid];\n\t\tconst t = this.Models[obj.tid];\n\t\tconst f = obj.sf || obj.tf;\n\t\tconst n = (obj.sf ? s : t).data.find(a => a.id === f).name;\n\t\treturn `${t.name} <span class='webix_rpt_sources_path'>${s.name}${\n\t\t\tobj.sf ? ` (${n})` : \"\"\n\t\t} -> ${t.name}${obj.tf ? ` (${n})` : \"\"}</span>`;\n\t}\n\n\tJoinListTemplate(obj) {\n\t\treturn removeRight + this.JoinTemplate(obj);\n\t}\n\n\tShowJoins() {\n\t\tconst data = this.Local.getLinkedModels(\n\t\t\t[this.State.data].concat(this.State.joins.map(a => a.tid)),\n\t\t\ttrue\n\t\t);\n\t\tif (!data.length) return;\n\n\t\tconst list = this.SourcesList.getBody();\n\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.SourcesList.show(this.$$(\"add\").$view);\n\t}\n\n\tShowDeleteButton() {\n\t\tif (this.State.id && this.AppState.toolbar) this.$$(\"delete\").show();\n\t\telse this.$$(\"delete\").hide();\n\t}\n}\n","export function prompt(config, app) {\n\tconst result = new webix.promise.defer();\n\n\twebix\n\t\t.ui(\n\t\t\tapp.getService(\"jet-win\").updateConfig({\n\t\t\t\tview: \"window\",\n\t\t\t\thead: {\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tpadding: { left: 12, right: 4 },\n\t\t\t\t\tborderless: true,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{ view: \"label\", label: config.text },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tresult.reject(\"prompt cancelled\");\n\t\t\t\t\t\t\t\tthis.getTopParentView().close();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"form\",\n\t\t\t\t\tpadding: { top: 5, left: 20, right: 20, bottom: 20 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 10,\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\t\t\tvalue: config.value,\n\t\t\t\t\t\t\t\t\twidth: 230,\n\t\t\t\t\t\t\t\t\tcss: \"fm-prompt-input\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tvalue: config.button,\n\t\t\t\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t\tconst popup = this.getTopParentView();\n\t\t\t\t\t\t\t\t\t\tconst newname = popup.getBody().getValues().name;\n\t\t\t\t\t\t\t\t\t\tresult.resolve(newname);\n\t\t\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tconst input = this.getBody().elements.name.getInputNode();\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tif (config.selectMask) config.selectMask(input);\n\t\t\t\t\t\telse input.select();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t)\n\t\t.show();\n\n\treturn result;\n}\n","webix.protoUI(\n\t{\n\t\tname: \"query-select\",\n\t\t$cssName: \"richselect\",\n\n\t\t$init() {\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_qselect_icon: function() {\n\t\t\t\t\tthis.callEvent(\"onClearClick\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\twebix.ui.richselect\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"@xbs/query/codebase/query\";\n\nexport default class QueryView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"query\",\n\t\t\tlocalId: \"query\",\n\t\t\tcss: \"webix_rpt_query\",\n\t\t\tlocale: { lang: this.app.getService(\"locale\").getLang() },\n\t\t\tdata: field => {\n\t\t\t\tconst column = this.State.fields.find(a => a.id === field);\n\t\t\t\tif (column.type === \"boolean\") return [0, 1];\n\t\t\t\treturn local.getFieldData(field, column.type);\n\t\t\t},\n\t\t\tfields: this.State.fields\n\t\t\t\t.filter(a => a.type !== \"reference\" && a.type !== \"picklist\")\n\t\t\t\t.map(a => {\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tid: a.id,\n\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\ta.name +\n\t\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\t\t(a.model\n\t\t\t\t\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + a.model + \"</span>\"\n\t\t\t\t\t\t\t\t: \"\"),\n\t\t\t\t\t\ttype: a.type,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (obj.type === \"boolean\") {\n\t\t\t\t\t\tobj.conditions = [\"equal\"];\n\t\t\t\t\t\tobj.type = \"number\";\n\t\t\t\t\t}\n\n\t\t\t\t\treturn obj;\n\t\t\t\t}),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst query = this.getRoot();\n\n\t\tthis.on(this.State.$changes, \"query\", value => {\n\t\t\tquery.$app.callEvent(\"applyFilter\", [null]);\n\t\t\tquery.config.value = value ? fixDates(JSON.parse(value)) : null;\n\t\t});\n\t\tquery.getState().$observe(\"value\", v => {\n\t\t\tthis.State.query = v ? JSON.stringify(v) : \"\";\n\t\t});\n\t}\n}\n\nfunction fixDates(value) {\n\tif (value.rules) value.rules.forEach(fixDates);\n\telse {\n\t\tif (value.type === \"date\") {\n\t\t\tvar c = value.condition;\n\t\t\tif (c.filter && typeof value.condition.filter === \"string\")\n\t\t\t\tc.filter = new Date(c.filter);\n\t\t\tif (c.filter.start && typeof c.filter.start === \"string\")\n\t\t\t\tc.filter.start = new Date(c.filter.start);\n\t\t\tif (c.filter.end && typeof c.filter.end === \"string\")\n\t\t\t\tc.filter.end = new Date(c.filter.end);\n\t\t}\n\t}\n\n\treturn value;\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport { bind } from \"jet-restate-bind\";\nimport { prompt } from \"../../helpers/prompt\";\nimport \"../../helpers/queryselect\";\n\nimport Query from \"./query\";\n\nexport default class QueryBuilderView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst querySelect = {\n\t\t\tlocalId: \"qblock\",\n\t\t\ttype: \"clean\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\ttype: \"form\",\n\t\t\t\t\tmargin: 5,\n\t\t\t\t\tpadding: { bottom: 5 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"queryBar\",\n\t\t\t\t\t\t\tvisibleBatch: \"def\",\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{ view: \"label\", label: _(\"Filtering query\"), width: 120 },\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Delete\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.DeleteQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"copy\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Create copy\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.CopyQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"rename\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-pencil\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Rename\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.RenameQuery(),\n\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\t\t\t\tlocalId: \"save\",\n\t\t\t\t\t\t\t\t\tlabel: _(\"Save\"),\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Save query\"),\n\t\t\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\t\t\tclick: () => this.SaveQuery(null),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"query-select\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\tname: \"id\",\n\t\t\t\t\t\t\tcss: \"webix_rpt_qselect\",\n\t\t\t\t\t\t\tlocalId: \"qselect\",\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\tcss: \"webix_rpt_qselect_suggest\",\n\t\t\t\t\t\t\t\ttemplate: item => this.QSelectTemplate(item),\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\tminHeight: 25,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonShow: function() {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t!this.getBody().$view.firstChild.getAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\tthis.getBody().$view.firstChild.setAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\",\n\t\t\t\t\t\t\t\t\t\t\t\t_(\"No saved queries\")\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonClearClick: () => this.NewQuery(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\ttemplate: _(\"Save filter to use it in other reports\"),\n\t\t\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tQuery,\n\t\t\t],\n\t\t};\n\n\t\treturn querySelect;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst qData = (this.Queries = this.Local.getQueries());\n\n\t\tthis.LocalState = createState({ id: \"\", saved: true });\n\n\t\tqData.waitData.then(() => {\n\t\t\tconst now = this.State.query;\n\t\t\tconst ctrl = this.$$(\"qselect\");\n\t\t\tconst list = ctrl.getList();\n\n\t\t\tconst tables = { [this.State.data]: 1 };\n\t\t\tthis.State.joins.forEach(a => (tables[a.tid] = 1));\n\n\t\t\tqData.filter(a => {\n\t\t\t\tlet res = true;\n\t\t\t\ta.models.forEach(m => {\n\t\t\t\t\tif (!tables[m]) res = false;\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t});\n\t\t\tlist.sync(qData);\n\n\t\t\tqData.data.each(v => {\n\t\t\t\tif (v.text == now) ctrl.setValue(v.id);\n\t\t\t});\n\n\t\t\tthis.on(state.$changes, \"query\", v => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tconst changed = (!id && v) || (id && qData.getItem(id).text != v);\n\t\t\t\tthis.LocalState.saved = !changed;\n\t\t\t});\n\t\t});\n\n\t\tbind(this.LocalState, \"id\", this.$$(\"qselect\"), this);\n\n\t\tconst saveBtn = this.$$(\"save\");\n\t\tthis.on(this.LocalState.$changes, \"saved\", v => {\n\t\t\tif (v) saveBtn.disable();\n\t\t\telse saveBtn.enable();\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"id\", v => {\n\t\t\tif (v) {\n\t\t\t\tconst item = qData.getItem(v);\n\t\t\t\tthis.State.query = item.text;\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"query\");\n\t\t\t} else {\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"def\");\n\t\t\t}\n\t\t});\n\t}\n\n\tNewQuery() {\n\t\tthis.LocalState.id = null;\n\t\tthis.LocalState.saved = true;\n\t\tthis.State.query = null;\n\t}\n\n\tSaveQuery(name) {\n\t\tconst id = this.LocalState.id;\n\t\tconst text = this.State.query;\n\n\t\tif (id) {\n\t\t\tif (name === null) name = this.Queries.getItem(id).name;\n\t\t\tthis.Operations.updateQuery(id, { name, text }).then(() => {\n\t\t\t\tthis.$$(\"qselect\").setValue(id);\n\t\t\t\tthis.LocalState.saved = true;\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t\tvalue: \"\",\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (name) {\n\t\t\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\t\t\tthis.LocalState.saved = true;\n\t\t\t\t\tthis.LocalState.id = id;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tRenameQuery() {\n\t\tconst id = this.LocalState.id;\n\t\tconst { name } = this.Queries.getItem(id);\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tvalue: name,\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (!name) return;\n\n\t\t\tthis.SaveQuery(name);\n\t\t});\n\t}\n\n\tCopyQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet { name, text } = this.Queries.getItem(this.LocalState.id);\n\t\tname = _(\"Copy of\") + \" \" + name;\n\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\tthis.LocalState.id = id;\n\t\t});\n\t}\n\n\tDeleteQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\tok: _(\"Delete\"),\n\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\ttext: _(\"Are you sure to delete this query?\"),\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tthis.Operations.deleteQuery(id).then(() => {\n\t\t\t\t\tthis.LocalState.$batch({ saved: true, id: null });\n\t\t\t\t\tthis.State.query = null;\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tGetMenuOptions() {\n\t\treturn [\n\t\t\t{ id: \"copy\", value: \"Copy\", icon: \"rpi-content-copy\" },\n\t\t\t{ id: \"rename\", value: \"Rename\", icon: \"rpi-pencil\" },\n\t\t\t{ id: \"delete\", value: \"Delete\", icon: \"rpi-delete\" },\n\t\t];\n\t}\n\n\tGetMenuTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\n\tApplyQueryAction(id) {\n\t\tthis.QueryMenu.hide();\n\t\tswitch (id) {\n\t\t\tcase \"rename\":\n\t\t\t\tthis.RenameQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"copy\":\n\t\t\t\tthis.CopyQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tthis.DeleteQuery();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tQSelectTemplate(obj) {\n\t\treturn `${obj.value} <span class='webix_icon wxi-close webix_rpt_qselect_icon'></span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { withContext, createState, debounce } from \"jet-restate\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\toptionWidth: 102,\n\t\t\ttabMinWidth: 102,\n\t\t\tview: \"tabbar\",\n\t\t\tlocalId: \"tabbar\",\n\t\t\tcss: \"webix_rpt_editor_tabbar\",\n\t\t\tborderless: true,\n\t\t\toptions: [\n\t\t\t\t{ id: \"common\", value: _(\"Common\") },\n\t\t\t\t{ id: \"data\", value: _(\"Query\") },\n\t\t\t\t{ id: \"other\", value: _(\"Data\") },\n\t\t\t\t{ id: \"structure\", value: _(\"View\") },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ShowView(v),\n\t\t\t},\n\t\t};\n\n\t\tconst skin = webix.skin.$name;\n\t\tif (skin == \"flat\" || skin == \"compact\" || skin == \"contrast\")\n\t\t\ttabbar.type = \"bottom\";\n\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: { left: 13, top: 0, bottom: 0 },\n\t\t\t//padding: { left: 13, top: webix.skin.$active.layoutPadding.toolbar, bottom: webix.skin.$active.layoutPadding.toolbar },\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tscroll: false,\n\t\t\tcols: [\n\t\t\t\ttabbar,\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\twidth: 40,\n\t\t\t\t\tlocalId: \"closeBtn\",\n\t\t\t\t\ticon: \"rpi-close\",\n\t\t\t\t\tclick: () => this.Hide(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 490,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn this.Local.ready(ui);\n\t}\n\n\tinit() {\n\t\tthis.AppState = this.app.getParam(\"state\");\n\n\t\tconst initial = this.Local.newModule();\n\t\tinitial.id = -1; // mark as temporary\n\n\t\tconst state = (this.State = createState(initial));\n\t\tthis.setParam(\"state\", this.State);\n\n\t\tthis.on(this.AppState.$changes, \"moduleId\", v => this.ChangeModule(v));\n\t\tthis.on(this.State.$changes, \"data\", (id, o, k, ctx) => {\n\t\t\tif (id && (!ctx || !ctx.load)) this.ChangeModel(id);\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowHideButton(v));\n\n\t\tthis.on(\n\t\t\tthis.State.$changes,\n\t\t\t\"*\",\n\t\t\tdebounce(() => {\n\t\t\t\tif (this.State.id === -1) return;\n\n\t\t\t\tthis.TrackChanges();\n\t\t\t\tthis.AppState.module = Object.assign({}, this.State);\n\t\t\t})\n\t\t);\n\n\t\tthis.on(state.$changes, \"group\", (v, old, _key, ctx) => {\n\t\t\tif (!v && old) {\n\t\t\t\t// revert back\n\t\t\t\tconst columns =\n\t\t\t\t\tstate.oldColumns ||\n\t\t\t\t\tthis.Local.getFields(state.data, state.joins, true);\n\t\t\t\tconst numColumns = webix\n\t\t\t\t\t.copy(columns)\n\t\t\t\t\t.filter(a => a.type == \"number\" && !a.key);\n\t\t\t\tconst meta = this.UpdateMeta(numColumns, columns);\n\t\t\t\tstate.$batch({\n\t\t\t\t\tpublicFields: null,\n\t\t\t\t\tcolumns,\n\t\t\t\t\tmeta,\n\t\t\t\t});\n\t\t\t} else if (v) {\n\t\t\t\tlet prev = [];\n\t\t\t\tif (!ctx || !ctx.load) {\n\t\t\t\t\tif (!old) state.oldColumns = state.columns;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (JSON.stringify(v) == JSON.stringify(old)) return;\n\t\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t}\n\n\t\t\t\t// group mode changed, add new columns\n\t\t\t\tlet columns = v.columns.map(a => ({\n\t\t\t\t\tid: `${a.op}.${a.id}`,\n\t\t\t\t\tname: a.name,\n\t\t\t\t\ttype: \"number\",\n\t\t\t\t\tmeta: {},\n\t\t\t\t\tmodel: \"\",\n\t\t\t\t}));\n\t\t\t\tconst groupColumns = webix.copy(columns);\n\t\t\t\tif (v.by)\n\t\t\t\t\tcolumns = columns.concat(\n\t\t\t\t\t\tv.by.map(a => {\n\t\t\t\t\t\t\tconst base = this.State.fields.find(b => b.id == a.id);\n\t\t\t\t\t\t\tconst id = a.mod ? `${a.mod}.${a.id}` : a.id;\n\t\t\t\t\t\t\tconst obj = { ...base, id };\n\t\t\t\t\t\t\tif (a.mod) obj.type = \"text\";\n\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t// apply modifications\n\t\t\t\tconst was = {};\n\t\t\t\t(state.publicFields || state.columns).forEach(a => (was[a.id] = 1));\n\t\t\t\tconst now = {};\n\t\t\t\t// add new / rename\n\t\t\t\tcolumns.forEach(a => {\n\t\t\t\t\tnow[a.id] = 1;\n\t\t\t\t\tif (!was[a.id]) prev.push(a);\n\t\t\t\t\telse {\n\t\t\t\t\t\t// rename a column if needed\n\t\t\t\t\t\tlet column = prev.find(b => b.id == a.id);\n\t\t\t\t\t\tif (column && column.name != a.name) column.name = a.name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//remove old\n\t\t\t\tprev = prev.filter(a => now[a.id]);\n\n\t\t\t\tconst meta = this.UpdateMeta(groupColumns, columns);\n\t\t\t\tif (meta.freeze && meta.freeze >= prev.length) delete meta.freeze;\n\t\t\t\tstate.$batch({ publicFields: columns, columns: prev, meta });\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"saveModule\", () => this.Save());\n\n\t\tthis.on(this.app, \"resetModule\", () => this.Reset());\n\n\t\tthis.on(this.app, \"onColumnResize\", (id, width) => {\n\t\t\tvar next = [...this.State.columns];\n\t\t\tnext.find(a => a.id == id).width = width;\n\t\t\tthis.State.columns = next;\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"readonly\", mod => {\n\t\t\tif (mod) this.Reset();\n\t\t});\n\n\t\tthis.show(\"./editor.common\");\n\t}\n\n\tSave() {\n\t\tconst save = this.Operations.getModuleSaveData(this.State);\n\t\tconst data = {\n\t\t\tname: this.State.name,\n\t\t\ttext: JSON.stringify(save),\n\t\t};\n\n\t\tif (this.AppState.moduleId)\n\t\t\tthis.Operations.updateModule(this.AppState.moduleId, data).then(id =>\n\t\t\t\tthis.SaveCallback(id)\n\t\t\t);\n\t\telse this.Operations.addModule(data).then(id => this.SaveCallback(id));\n\t}\n\tSaveCallback(id) {\n\t\tthis.AppState.$batch({\n\t\t\tmoduleId: id,\n\t\t\tmode: \"view\",\n\t\t\tmodule: Object.assign({}, this.AppState.module),\n\t\t\tsaved: true,\n\t\t});\n\t}\n\n\tShowView(v) {\n\t\tthis.$$(\"tabbar\").setValue(v);\n\t\tthis.show(\"editor.\" + v);\n\t}\n\n\tHide() {\n\t\tthis.Reset();\n\t}\n\n\tReset() {\n\t\tconst id = this.AppState.moduleId;\n\t\tif (!id) {\n\t\t\tthis.AppState.$batch({ mode: \"list\", module: null, saved: true });\n\t\t} else\n\t\t\tthis.Local.getModule(id).then(mod => {\n\t\t\t\tthis.AppState.$batch({\n\t\t\t\t\tmode: \"view\",\n\t\t\t\t\tmodule: Object.assign({}, JSON.parse(mod.text)),\n\t\t\t\t\tsaved: true,\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tChangeModel(id) {\n\t\tif (id) this.State.$batch(this.Local.setDataSource(id));\n\t}\n\n\tChangeModule(id) {\n\t\tthis.InitStateValue = \"\";\n\t\tif (id) {\n\t\t\tthis.Local.getModule(id).then(item => {\n\t\t\t\tconst obj = JSON.parse(item.text);\n\n\t\t\t\tthis.InitStateValue = item.text;\n\t\t\t\tthis.InitName = obj.name = item.name;\n\n\t\t\t\tobj.id = item.id;\n\t\t\t\tobj.saved = true;\n\t\t\t\tobj.fields = this.Local.getFields(obj.data, obj.joins);\n\n\t\t\t\twithContext({ load: true }, () => this.State.$batch(obj));\n\t\t\t\tthis.AppState.saved = true;\n\t\t\t});\n\t\t} else {\n\t\t\tthis.InitStateValue = null; // we need to have an always active Save button\n\t\t\tthis.State.$batch(this.Local.newModule());\n\t\t\tthis.State.fields = this.Local.getFields(\n\t\t\t\tthis.State.data,\n\t\t\t\tthis.State.joins\n\t\t\t);\n\t\t\tthis.AppState.saved = false;\n\t\t}\n\t}\n\tTrackChanges() {\n\t\tthis.AppState.saved =\n\t\t\tJSON.stringify(this.Operations.getModuleSaveData(this.State)) ==\n\t\t\t\tthis.InitStateValue && this.State.name == this.InitName;\n\t}\n\n\tShowHideButton(v) {\n\t\tif (v) this.$$(\"closeBtn\").show();\n\t\telse this.$$(\"closeBtn\").hide();\n\t}\n\n\tUpdateMeta(numColumns, columns) {\n\t\tlet meta = this.State.meta;\n\t\tconst state = this.State;\n\t\tif (numColumns.length) {\n\t\t\tif (state.type == \"chart\") {\n\t\t\t\tnumColumns = numColumns.map(a => {\n\t\t\t\t\tconst c = { ...a, value: a.name };\n\t\t\t\t\tdelete c.name;\n\t\t\t\t\treturn c;\n\t\t\t\t});\n\t\t\t\tmeta.chart.series = this.app\n\t\t\t\t\t.getService(\"charts\")\n\t\t\t\t\t.getSeries(numColumns, state.chartType);\n\t\t\t} else if (state.type == \"heatmap\") {\n\t\t\t\tmeta.value = numColumns[0].id;\n\t\t\t\tmeta.label = state.publicFields\n\t\t\t\t\t? columns[columns.length - 1].id\n\t\t\t\t\t: columns[0].id;\n\t\t\t\tif (meta.color && !numColumns.find(a => a.id == meta.color))\n\t\t\t\t\tmeta.color = numColumns[0].id;\n\t\t\t}\n\t\t}\n\t\treturn meta;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, masterName) {\n\t\tsuper(app);\n\t\tthis.Name = masterName;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.ClickHandler(id);\n\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t},\n\t\t\t\tdata: this.GetOptions(),\n\t\t\t},\n\t\t};\n\t}\n\n\tClickHandler(id) {\n\t\tthis.getParentView().ApplyAction(id);\n\t}\n\tShow(node, data, index) {\n\t\tthis.SetActionStates(data, index);\n\t\tthis.getRoot().show(node);\n\t}\n\tGetOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [{ id: \"delete\", value: _(\"Delete\"), icon: \"rpi-delete\" }];\n\t}\n\tSetActionStates(data) {\n\t\tconst popup = this.getRoot();\n\t\tconst list = popup.getBody();\n\t\tlist.data.each(action => {\n\t\t\tif (data.length == 1) list.disableItem(action.id);\n\t\t\telse list.enableItem(action.id);\n\t\t});\n\t}\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span> ${obj.value}`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class BucketView extends JetView {\n\tconstructor(app, state, pstate) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.ParentState = pstate;\n\t}\n\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.ValueSeparator = \",\";\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: 0, bottom: 0, left: 0, right: 0 },\n\t\t\tlocalId: \"forms\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\telements: [],\n\t\t};\n\t\tconst other = {\n\t\t\tlocalId: \"other\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\twidth: 150,\n\t\t\t\t\tplaceholder: _(\"Bucket name\"),\n\t\t\t\t\tvalue: _(\"Other\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.Changed(\"other\", \"name\", v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\tlabel: _(\"Other values\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t};\n\t\tconst padding = webix.skin.$active.layoutPadding.form;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpadding: { top: padding, bottom: padding, left: 0, right: 0 },\n\t\t\tcss: \"webix_rpt_subview\",\n\t\t\trows: [\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\tother,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add bucket\"),\n\t\t\t\t\tinputWidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewBucket(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Forms = this.$$(\"forms\");\n\t\tthis.GetRowKeys(this.State.id).then(data => {\n\t\t\tthis.Data = data.sort((a, b) => this.Sort(a, b));\n\t\t\tthis.CreateForm();\n\t\t});\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (name == \"bucket\" && action == \"focus\" && id == this.State.id)\n\t\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.ParentState.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetColumnData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\tGetColumnData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = [baseColumn];\n\t\tdelete moduleConfig.buckets;\n\t\tdelete moduleConfig.group;\n\t\tlet waitData = [\n\t\t\tthis.Local.getData(moduleConfig),\n\t\t\tthis.Local.getOptionsList(baseColumn),\n\t\t];\n\t\treturn Promise.all(waitData);\n\t}\n\n\tCreateForm() {\n\t\tconst options = this.State.options;\n\t\tif (options && options.length) this.LoadBuckets(options);\n\t\telse this.AddNewBucket();\n\t\twebix.delay(() => {\n\t\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"resize\", this.State.id]);\n\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\n\tAddNewBucket() {\n\t\tthis.AddBucket();\n\t\tthis.Changed();\n\t\tthis.Focus();\n\t}\n\n\tLoadBuckets(data) {\n\t\tdata.forEach(bucket => {\n\t\t\tif (!bucket.values) this.LoadOther(bucket);\n\t\t\telse this.AddBucket(bucket);\n\t\t});\n\t\tthis.Changed();\n\t}\n\tLoadOther(b) {\n\t\tconst other = this.$$(\"other\");\n\t\tother.setValues({ name: b.id });\n\t}\n\tAddBucket(bucket) {\n\t\tbucket = bucket || {};\n\t\tthis.Forms.addView(this.GetRowForm(webix.uid(), bucket));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: data.id || null,\n\t\t\t\t\t\tplaceholder: this._(\"Bucket name\"),\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: v => this.Changed(id, \"name\", v),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"multicombo\",\n\t\t\t\tname: \"values\",\n\t\t\t\tplaceholder: this._(\"Bucket values\"),\n\t\t\t\tcss: \"webix_multilist webix_rpt_multicombo\",\n\t\t\t\tseparator: this.ValueSeparator,\n\t\t\t\tsuggest: {\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_multilist webix_rpt_bucket_values\",\n\t\t\t\t\t\tdata: this.Data,\n\t\t\t\t\t\ttemplate: obj => this.OptionTemplate(id, obj),\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tthis.getList().refresh();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tvalue: data.values || null,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"values\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\ticon: \"wxi-dots\",\n\t\t\t\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t\tvalues: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"bucket\"));\n\t\tconst form = webix\n\t\t\t.$$(id)\n\t\t\t.getParentView()\n\t\t\t.getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetValues(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\tGetValidBuckets() {\n\t\tconst otherForm = this.$$(\"other\");\n\t\tconst otherName = otherForm.elements.name.getValue();\n\t\totherForm.validate();\n\t\tconst names = {};\n\t\tif (otherName) names[otherName] = [otherForm];\n\t\tconst options = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tform.validate();\n\t\t\tlet values = form.getValues();\n\t\t\tlet n = values.name;\n\t\t\tif (n) {\n\t\t\t\tif (names[n]) {\n\t\t\t\t\tthis.$$(names[n]).forEach(f => f.markInvalid(\"name\", true));\n\t\t\t\t\tform.markInvalid(\"name\", true);\n\t\t\t\t} else if (values.values.length)\n\t\t\t\t\toptions.push({ id: n, values: values.values.split(\",\") });\n\t\t\t\tif (!names[n]) names[n] = [];\n\t\t\t\tnames[n].push(form);\n\t\t\t}\n\t\t});\n\t\tif (options.length && otherName) options.push({ id: otherName });\n\t\treturn options;\n\t}\n\tChanged(id, name, value) {\n\t\tif (name == \"values\") this.CorrectValues(id, value);\n\t\tconst options = this.GetValidBuckets();\n\t\tthis.State.options = options;\n\t}\n\n\tOptionTemplate(id, obj) {\n\t\tlet selected =\n\t\t\t!obj.$checked &&\n\t\t\tthis.GetValues().find(\n\t\t\t\tbucket => bucket.id != id && bucket.values.indexOf(obj.value) > -1\n\t\t\t);\n\t\tconst css =\n\t\t\t\"webix_rpt_bucket_value\" +\n\t\t\t(selected ? \" webix_rpt_bucket_value_selected\" : \"\");\n\t\treturn (\n\t\t\t\"<div class='\" +\n\t\t\tcss +\n\t\t\t\"'>\" +\n\t\t\tobj.value +\n\t\t\t\"</div>\" +\n\t\t\t(selected\n\t\t\t\t? \"<span class='webix_rpt_bucket_icon webix_icon rpi-pail-outline'></span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\tGetValues() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tconst v = form.getValues();\n\t\t\tv.id = form.config.localId;\n\t\t\tdata.push(v);\n\t\t});\n\t\treturn data;\n\t}\n\tForEachFormRow(handler) {\n\t\tthis.Forms.getChildViews().forEach(form => {\n\t\t\tif (form && form.elements) {\n\t\t\t\thandler(form);\n\t\t\t}\n\t\t});\n\t}\n\tCorrectValues(id, v) {\n\t\tthis.ForEachFormRow(form => {\n\t\t\tif (form.config.localId != id) {\n\t\t\t\tlet values = form.getValues().values.split(\",\");\n\t\t\t\tvalues = values.filter(a => v.indexOf(a) == -1);\n\t\t\t\tform.elements.values.setValue(values);\n\t\t\t}\n\t\t});\n\t}\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteBucket(this.ActiveForm);\n\t}\n\n\tDeleteBucket(form) {\n\t\tthis.Forms.removeView(form);\n\t\tthis.Changed();\n\t}\n\tSort(a, b) {\n\t\tconst type = this.ParentState.fields.find(c => c.id == this.State.id).type;\n\t\ta = a.value;\n\t\tb = b.value;\n\t\tif (type == \"number\") {\n\t\t\ta = a * 1;\n\t\t\tb = b * 1;\n\t\t\tif (isNaN(b)) return 1;\n\t\t\tif (isNaN(a)) return -1;\n\t\t} else {\n\t\t\tif (!b) return 1;\n\t\t\tif (!a) return -1;\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t}\n\t\treturn a > b ? 1 : a < b ? -1 : 0;\n\t}\n\tFocus(index) {\n\t\twebix.delay(\n\t\t\t() => {\n\t\t\t\tconst forms = this.Forms.getChildViews();\n\t\t\t\tif (typeof index == \"undefined\") index = forms.length - 1;\n\t\t\t\tconst form = forms[index];\n\t\t\t\tif (form) form.elements.name.focus();\n\t\t\t},\n\t\t\tnull,\n\t\t\tnull,\n\t\t\t100\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tautoheight: true,\n\t\t\tfitMaster: true,\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpadding: { top: 5, bottom: 5, left: 10, right: 10 },\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\t\t\t\tplaceholder: _(\"Search\"),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\tscroll: true,\n\t\t\t\t\t\tyCount: 5,\n\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\t\t\tconst item = this.List.getItem(id);\n\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\tthis.View.hide();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonEnter: () => {\n\t\t\t\t\t\t\t\tconst item = this.List.getSelectedItem();\n\t\t\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\t\twebix.delay(() => this.View.hide());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.View = this.getRoot();\n\t\tconst views = this.View.getBody().getChildViews();\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.BucketState = this.getParam(\"buckets\", true);\n\t\tthis.Text = views[0].getChildViews()[0];\n\t\tthis.List = views[1];\n\t\tthis.Text.attachEvent(\"onTimedKeyPress\", () => {\n\t\t\tthis.Find(this.Text.getValue());\n\t\t});\n\t}\n\tAddColumn(column) {\n\t\tconst t = [...this.BucketState.buckets];\n\t\tt.push({ column: column.id, options: [] });\n\t\tthis.BucketState.buckets = t;\n\t}\n\tShow(node) {\n\t\tnode = node.firstChild.firstChild;\n\t\tthis.View.config.width = node.offsetWidth - 2;\n\t\tthis.View.adjust();\n\t\tthis.View.show(node);\n\t\tthis.Text.focus();\n\t\tthis.List.clearAll();\n\t\tthis.List.parse(this.GetColumns());\n\t}\n\tGetColumns() {\n\t\tlet columns = this.State.fields;\n\t\tif (this.State.publicFields)\n\t\t\tcolumns = columns.filter(a =>\n\t\t\t\tthis.State.publicFields.find(b => b.id == a.id)\n\t\t\t);\n\t\treturn columns.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t\tdisabled:\n\t\t\t\tthis.BucketState.buckets &&\n\t\t\t\tthis.BucketState.buckets.find(b => b.column == a.id),\n\t\t}));\n\t}\n\n\tGetTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tFind(value) {\n\t\tvalue = value.toLowerCase();\n\t\tif (value)\n\t\t\tthis.List.filter(item => item.value.toLowerCase().indexOf(value) > -1);\n\t\telse this.List.filter(\"\");\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"groupselect\",\n\t\t$cssName: \"text webix_rpt_groupselect\",\n\t\tdefaults: {\n\t\t\tselectIcon: true,\n\t\t\tmodifiers: {},\n\t\t},\n\t\trenderModifier(id) {\n\t\t\tconst mid = this._modifiers[id];\n\t\t\tif (mid) {\n\t\t\t\tconst option = this.config.modifiers.find(a => a.id === mid);\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_rpt_date_selector'>\" +\n\t\t\t\t\t(option ? option.value : \"\") +\n\t\t\t\t\t(this.config.selectIcon\n\t\t\t\t\t\t? \"<span class='webix_icon wxi-angle-down'></span>\"\n\t\t\t\t\t\t: \"\") +\n\t\t\t\t\t\"</div> <span class='webix_rpt_groupselect_sep'> | </span> \"\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\t$renderTag(text, width, height, value) {\n\t\t\tlet content = this.renderModifier(value);\n\t\t\tcontent +=\n\t\t\t\t\"<span>\" +\n\t\t\t\ttext +\n\t\t\t\t\"</span><span class='webix_multicombo_delete webix_rpt_groupselect_delete' role='button' aria-label='\" +\n\t\t\t\twebix.i18n.aria.removeItem +\n\t\t\t\t\"'></span>\";\n\t\t\treturn (\n\t\t\t\t\"<li class='webix_multicombo_value' style='line-height:\" +\n\t\t\t\theight +\n\t\t\t\t\"px;' optvalue='\" +\n\t\t\t\twebix.template.escape(value) +\n\t\t\t\t\"'>\" +\n\t\t\t\tcontent +\n\t\t\t\t\"</li>\"\n\t\t\t);\n\t\t},\n\t\t$init() {\n\t\t\tthis._modifiers = {};\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_date_selector: function(e, id, node) {\n\t\t\t\t\tlet value = webix.html.locate(e, \"optvalue\");\n\t\t\t\t\tthis.callEvent(\"onModifierClick\", [value, e, node]);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tsetValue(value) {\n\t\t\tif (value) {\n\t\t\t\tif (typeof value !== \"string\" && typeof value[0] !== \"string\") {\n\t\t\t\t\tthis._modifiers = {};\n\t\t\t\t\tvalue = value.map(a => {\n\t\t\t\t\t\tthis._modifiers[a.id] = a.mod || null;\n\t\t\t\t\t\treturn a.id;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t\t} else {\n\t\t\t\tthis._modifiers = {};\n\t\t\t}\n\n\t\t\treturn webix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t},\n\t\tgetModifier(id) {\n\t\t\treturn this._modifiers[id];\n\t\t},\n\t\tsetModifier(id, value, silent) {\n\t\t\tthis._modifiers[id] = value;\n\t\t\tif (!silent) this.callEvent(\"onChange\", []);\n\t\t\tthis.refresh();\n\t\t},\n\t\t// [FIXME] bug in multicombo repainting during view replacing\n\t\t$setSize: function(x, y) {\n\t\t\tvar config = this.config;\n\n\t\t\tconst [px, py] = this._custom_last_size || [0, 0];\n\t\t\tif (x == px && y == py) return;\n\t\t\tthis._custom_last_size = [x, y];\n\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tif (!x || !y) return;\n\t\t\t\tif (config.labelPosition == \"top\") {\n\t\t\t\t\tconfig.labelWidth = 0;\n\t\t\t\t}\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t},\n\t},\n\twebix.ui.multicombo\n);\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport \"../../../helpers/groupselect\";\nimport BucketView from \"./bucket\";\nimport BucketPopup from \"./bucketpopup\";\n\nexport default class BucketSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Views = {};\n\t\tconst columns = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns and their data buckets\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"addColumn\",\n\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\tclick: () => this.ShowColumns(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list webix_rpt_bcols\",\n\t\t\tlocalId: \"table\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst buckets = createState({\n\t\t\t\t\tid: obj.id,\n\t\t\t\t\toptions: obj.options,\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tbuckets.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, buckets);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = (this.Views[obj.id] = new BucketView(\n\t\t\t\t\tthis.app,\n\t\t\t\t\tbuckets,\n\t\t\t\t\tthis.State\n\t\t\t\t));\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ToggleSub(id),\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_bucket_delete: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\t\t\t\tok: _(\"Delete\"),\n\t\t\t\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveColumn(id));\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [columns, buckets],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Table = this.$$(\"table\");\n\t\tconst buckets = this.State.buckets || [];\n\n\t\tthis.BucketState = createState({ buckets, newColumn: null });\n\t\tthis.LoadBuckets();\n\t\tthis.setParam(\"buckets\", this.BucketState);\n\t\tthis.on(\n\t\t\tthis.BucketState.$changes,\n\t\t\t\"*\",\n\t\t\tignoreInitial((v, o) => this.Changed(v, o))\n\t\t);\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (this.getRoot() && name == \"bucket\" && action == \"resize\")\n\t\t\t\tthis.Table.refresh(id);\n\t\t});\n\t}\n\tShowColumns() {\n\t\tif (!this.ColumnList || !this.ColumnList.$view)\n\t\t\tthis.ColumnList = this.ui(BucketPopup, this.State);\n\t\tthis.ColumnList.Show(this.$$(\"addColumn\").$view);\n\t}\n\n\tLoadBuckets() {\n\t\tconst tableData = this.BucketState.buckets\n\t\t\t? this.BucketState.buckets.map(a => {\n\t\t\t\t\tconst field = this.State.fields.find(f => f.id == a.column);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: a.column,\n\t\t\t\t\t\tname: field.name,\n\t\t\t\t\t\tmodel: field.model || null,\n\t\t\t\t\t\toptions: a.options,\n\t\t\t\t\t};\n\t\t\t  })\n\t\t\t: [];\n\t\tthis.Table.clearAll();\n\t\tthis.Table.parse(tableData);\n\t\tif (!tableData.length) this.Table.hide();\n\t}\n\tAddColumn(id) {\n\t\tif (this.Table.config.hidden) this.Table.show();\n\t\tconst field = this.State.fields.find(f => f.id == id);\n\t\tthis.Table.add({\n\t\t\tid,\n\t\t\tname: field.name,\n\t\t\tmodel: field.model || null,\n\t\t\toptions: [],\n\t\t});\n\t}\n\tRemoveColumn(id) {\n\t\tthis.Table.remove(id);\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst i = buckets.findIndex(a => a.column == id);\n\t\tbuckets.splice(i, 1);\n\t\tthis.BucketState.buckets = buckets;\n\t\tif (!buckets.length) this.Table.hide();\n\t\tif (this._ActiveEditor && String(id) == String(this._ActiveEditor))\n\t\t\tthis.ResetEditor();\n\t\tthis.Views[id].destructor();\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChanged(newV, oldV) {\n\t\tif (newV.length > oldV.length) {\n\t\t\tconst id = newV[newV.length - 1].column;\n\t\t\tthis.AddColumn(id);\n\t\t\tthis.Table.openSub(id);\n\t\t}\n\t\tconst buckets = this.BucketState.buckets.filter(b => b.options.length);\n\t\tthis.State.buckets = buckets;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tconst html = `<div class='webix_rpt_config_row'>\n\t\t\t<span class='webix_rpt_buckets_num'>\n\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"buckets\")}: </span>\n\t\t\t\t\t${item.options.length}\n\t\t\t\t</span>\n\t\t\t\t<div class='webix_rpt_config_row_name'>\n\t\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"column\")}: </span>\n\t\t\t\t\t${item.name}${\n\t\t\titem.model\n\t\t\t\t? `<span class='webix_rpt_sources_path'>${item.model}</span>`\n\t\t\t\t: \"\"\n\t\t}\n\t\t\t\t</div>\n\t\t\t\t<span class='webix_icon rpi-delete webix_rpt_bucket_delete'></span>\n\t\t\t\t${common.subrow(item, common)}\n\t\t\n\t\t</div>`;\n\n\t\treturn html;\n\t}\n\n\tHideAllEditors(id) {\n\t\tconst prevId = this._ActiveEditor;\n\t\tif (prevId && this.Table.getItem(prevId)) this.Table.closeSub(prevId);\n\n\t\tthis._ActiveEditor = id;\n\t\tif (id) this.FocusEditor();\n\t}\n\tFocusEditor() {\n\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"focus\", this._ActiveEditor]);\n\t}\n\n\tResetEditor() {\n\t\tthis._ActiveEditor = null;\n\t}\n\n\tToggleSub(id) {\n\t\tvar row = this.Table.getItem(id);\n\t\tif (row.$subopen) this.Table.closeSub(id);\n\t\telse this.Table.openSub(id);\n\t}\n\tUpdate(id, data) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst column = this.BucketState.buckets.find(b => b.column == id);\n\t\tcolumn.options = data.options;\n\t\tthis.BucketState.buckets = buckets;\n\t\tthis.Table.updateItem(id, { options: column.options });\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tcss: \"webix_rpt_grouppopup\",\n\t\t\t\ttemplate: obj => this.GetPopupTemplate(obj),\n\t\t\t\tdata: this.Master.config.modifiers,\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.Master.setModifier(this.ActiveGroup, id);\n\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t$init() {\n\t\tthis.ActiveGroup = null;\n\t}\n\tGetPopupTemplate(obj) {\n\t\tconst isSelected = obj.id == this.Master.getModifier(this.ActiveGroup);\n\t\treturn `${obj.value} <span class='webix_icon wxi-radiobox-${\n\t\t\tisSelected ? \"marked\" : \"blank\"\n\t\t}'></span>`;\n\t}\n\tShow(node, id) {\n\t\tthis.ActiveGroup = id;\n\t\tthis.getRoot().show(node, { x: -10 });\n\t\tthis.getRoot()\n\t\t\t.getBody()\n\t\t\t.refresh();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class Summaries extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst labels = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Function\"),\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Column\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"New column name\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 38,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tlocalId: \"summaries\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tcss: \"webix_rpt_summary_form\",\n\t\t\telements: [],\n\t\t};\n\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [{ view: \"label\", label: _(\"Group summaries\") }],\n\t\t\t\t},\n\t\t\t\tlabels,\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\twidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewAggregation(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.GroupState = this.getParam(\"group\", true);\n\n\t\tthis.SummaryColumns = this.State.fields\n\t\t\t.filter(column => {\n\t\t\t\treturn (\n\t\t\t\t\t(column.type == \"number\" || column.type == \"date\") && !column.key\n\t\t\t\t);\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\tthis.CreateForm();\n\t\tthis.on(this.GroupState.$changes, \"by\", () => this.ValidateFormData());\n\t}\n\n\tCreateForm() {\n\t\tconst aggregate = this.GroupState.columns;\n\t\tif (aggregate && aggregate.length) this.LoadAggregations(aggregate);\n\t\telse this.AddNewAggregation();\n\n\t\tif (!this.SummaryColumns.length) {\n\t\t\tthis.ApplyOneRowMode();\n\t\t}\n\t}\n\tApplyOneRowMode() {\n\t\tconst rows = this.getRoot().getChildViews();\n\t\trows[3].hide();\n\t\trows[4].hide();\n\t}\n\n\tAddNewAggregation() {\n\t\tthis.AddAggregation();\n\t\tthis.Changed();\n\t}\n\n\tLoadAggregations(data) {\n\t\tdata.forEach(summary => {\n\t\t\tthis.AddAggregation(summary);\n\t\t});\n\t\tthis.Changed();\n\t}\n\n\tAddAggregation(aggregation) {\n\t\taggregation = aggregation || this.GetDefaultFormData();\n\t\tif (!aggregation) return false;\n\t\tconst formId = aggregation.id || \"form\" + webix.uid();\n\t\tthis.$$(\"summaries\").addView(this.GetRowForm(formId, aggregation));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\twidth: 100,\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"op\",\n\t\t\t\tvalue: data.op || null,\n\t\t\t\toptions: this.GetOperations(),\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"op\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"id\",\n\t\t\t\tdisabled: data.op == \"count\",\n\t\t\t\tvalue: data.id || null,\n\t\t\t\toptions: this.SummaryColumns,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"id\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"text\",\n\t\t\t\tvalue: data.name || null,\n\t\t\t\tname: \"name\",\n\t\t\t\ton: {\n\t\t\t\t\tonTimedKeypress: v => this.Changed(id, \"name\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tcols.push({\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-dots\",\n\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t});\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tid: value => {\n\t\t\t\t\tconst groupBy = this.GroupState.by;\n\t\t\t\t\treturn !groupBy || groupBy.indexOf(value) < 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\n\tGetDefaultFormData() {\n\t\tconst data = this.GetData();\n\t\tconst columns = this.SummaryColumns;\n\t\tconst operations = this.GetOperations();\n\t\tif (!columns.length) {\n\t\t\tconst op = !data.length ? operations.find(op => op.id == \"count\") : null;\n\t\t\treturn op\n\t\t\t\t? {\n\t\t\t\t\t\top: \"count\",\n\t\t\t\t\t\tid: \"\",\n\t\t\t\t\t\tname: this.NewColumnTemplate(op),\n\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t  }\n\t\t\t\t: null;\n\t\t} else {\n\t\t\tfor (let i = 0; i < operations.length; i++) {\n\t\t\t\tfor (let j = 0; j < columns.length; j++) {\n\t\t\t\t\tconst op = operations[i];\n\t\t\t\t\tif (\n\t\t\t\t\t\t!data.find(\n\t\t\t\t\t\t\trow =>\n\t\t\t\t\t\t\t\trow.op == op.id && (op.id == \"count\" || row.id == columns[j].id)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\top: op.id,\n\t\t\t\t\t\t\tid: op.id != \"count\" ? columns[j].id : null,\n\t\t\t\t\t\t\tname: this.NewColumnTemplate(op, columns[j]),\n\t\t\t\t\t\t\ttype: columns[j].type,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tNewColumnTemplate(operation, column) {\n\t\treturn operation.id == \"count\"\n\t\t\t? operation.value\n\t\t\t: operation.value + \" \" + column.value;\n\t}\n\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"summary\"));\n\t\tconst form = webix.$$(id).getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetData(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteAggregation();\n\t}\n\n\tDeleteAggregation(form) {\n\t\tform = form || this.ActiveForm;\n\t\tconst formList = form.getParentView();\n\t\tif (formList.getChildViews().length > 1) formList.removeView(form);\n\t\telse form.setValues({});\n\t\tthis.Changed();\n\t}\n\n\tGetOperations() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"sum\", value: _(\"Sum\") },\n\t\t\t{ id: \"count\", value: _(\"Count\") },\n\t\t\t{ id: \"avg\", value: _(\"Average\") },\n\t\t\t{ id: \"max\", value: _(\"Max\") },\n\t\t\t{ id: \"min\", value: _(\"Min\") },\n\t\t];\n\t}\n\n\tGetData() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tdata.push(form.getValues());\n\t\t});\n\t\treturn data;\n\t}\n\n\tForEachFormRow(handler) {\n\t\tthis.$$(\"summaries\")\n\t\t\t.getChildViews()\n\t\t\t.forEach(form => {\n\t\t\t\tif (form && form.elements) {\n\t\t\t\t\thandler(form);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tValidateFormData() {\n\t\tlet valid = true;\n\t\tthis.ForEachFormRow(form => (valid = form.validate() && valid));\n\t\treturn valid;\n\t}\n\n\tChangeNewColumnName(formId) {\n\t\tconst form = this.$$(formId).elements;\n\t\tconst oId = form.op.getValue();\n\t\tconst cId = form.id.getValue();\n\t\tconst operations = this.GetOperations();\n\n\t\tif (oId) {\n\t\t\tif (oId == \"count\")\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(operations.find(o => o.id == oId))\n\t\t\t\t);\n\t\t\telse if (cId)\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(\n\t\t\t\t\t\toperations.find(o => o.id == oId),\n\t\t\t\t\t\tthis.SummaryColumns.find(c => c.id == cId)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tChanged(formId, name, value) {\n\t\tif (name == \"op\" || name == \"id\") this.ChangeNewColumnName(formId);\n\t\tif (name == \"op\" && value == \"count\") {\n\t\t\tthis.$$(formId).elements.id.setValue(null);\n\t\t\tthis.$$(formId).elements.id.disable();\n\t\t} else {\n\t\t\tif (formId && name) this.$$(formId).elements.id.enable();\n\t\t}\n\n\t\tthis.ValidateFormData();\n\t\tconst columns = this.GetData();\n\t\tcolumns.forEach(\n\t\t\ta =>\n\t\t\t\t(a.type = (\n\t\t\t\t\tthis.SummaryColumns.find(b => b.id == a.id) || { type: \"number\" }\n\t\t\t\t).type)\n\t\t);\n\t\tthis.GroupState.columns = columns;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport Summaries from \"./summary\";\nimport \"../../../helpers/groupselect\";\nimport DatePopupView from \"./datepopup\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupBy = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns to group by and output(s)\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"groupBy\",\n\t\t\t\t\tmodifiers: this.GetDateOptions(),\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeGroupBy(),\n\t\t\t\t\t\tonModifierClick: (id, e, node) =>\n\t\t\t\t\t\t\tthis.ShowModifierPopup(id, e, node),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"groupByLayout\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [groupBy, Summaries],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst groupState = this.State.group || {};\n\t\tthis.GroupState = createState({\n\t\t\tby: groupState.by || null,\n\t\t\tcolumns: groupState.columns || null,\n\t\t});\n\n\t\tthis.LoadColumns();\n\n\t\tthis.setParam(\"group\", this.GroupState);\n\t\tthis.on(this.GroupState.$changes, \"*\", ignoreInitial(() => this.Apply()));\n\t}\n\n\tChangeGroupBy() {\n\t\tconst group = this.$$(\"groupBy\");\n\t\tconst list = group.getPopup().getList();\n\t\tlet arr = group.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tthis.GroupState.by = arr.map(a => {\n\t\t\tlet mod = group.getModifier(a);\n\t\t\tif (list.getItem(a).type === \"date\" && !mod) {\n\t\t\t\tmod = \"year\";\n\t\t\t\tgroup.setModifier(a, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id: a };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\t}\n\n\tFilterGroupByColumns(column) {\n\t\treturn column.id != \"id\";\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = this.State.fields.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\t\tconst groupBy = this.$$(\"groupBy\");\n\t\tconst list = groupBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.parse(columns);\n\n\t\tthis.$$(\"groupBy\").setValue(this.GroupState.by);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tShowModifierPopup(id, e, node) {\n\t\tif (!this.DatePopup)\n\t\t\tthis.DatePopup = this.ui(new DatePopupView(this.app, this.$$(\"groupBy\")));\n\t\twebix.delay(() => this.DatePopup.Show(node, id));\n\t}\n\n\tGetDateOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t{ id: \"yearmonth\", value: _(\"Year\") + \"/\" + _(\"Month\") },\n\t\t\t{\n\t\t\t\tid: \"yearmonthday\",\n\t\t\t\tvalue: _(\"Year\") + \"/\" + _(\"Month\") + \"/\" + _(\"Day\"),\n\t\t\t},\n\t\t];\n\t}\n\tApply() {\n\t\tconst s = this.GroupState;\n\t\tthis.State.group = {\n\t\t\tby: s.by || null,\n\t\t\tcolumns: s.columns || [],\n\t\t};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"groupBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleGroupBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Group\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"bucketsSwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleBuckets(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Data buckets\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst sortByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"sortBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleSortBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Sort\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\trows: [\n\t\t\t\t\tgroupByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"group\" },\n\t\t\t\t\tbuckets,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"buckets\" },\n\t\t\t\t\tsortByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"sort\" },\n\t\t\t\t\t{ gravity: 0.000001 },\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"groupBySwitch\").setValue(!!this.State.group);\n\t\tthis.$$(\"sortBySwitch\").setValue(!!this.State.sort);\n\t\tthis.$$(\"bucketsSwitch\").setValue(!!this.State.buckets);\n\t}\n\n\tToggleGroupBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.groups\", { target: \"group\" });\n\t\t} else {\n\t\t\tthis.State.group = null;\n\t\t\tthis.show(\"_hidden\", { target: \"group\" });\n\t\t}\n\t}\n\n\tToggleSortBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.sorts\", { target: \"sort\" });\n\t\t} else {\n\t\t\tthis.State.sort = null;\n\t\t\tthis.show(\"_hidden\", { target: \"sort\" });\n\t\t}\n\t}\n\tToggleBuckets(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.buckets\", { target: \"buckets\" });\n\t\t} else {\n\t\t\tthis.State.buckets = null;\n\t\t\tthis.show(\"_hidden\", { target: \"buckets\" });\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sortAsc, sortDesc } from \"helpers/icons\";\nimport \"../../../helpers/groupselect\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst sortBy = {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Specify columns to sort by\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"sortBy\",\n\t\t\t\t\tselectIcon: false,\n\t\t\t\t\tcss: \"webix_rpt_sort_selector\",\n\t\t\t\t\tmodifiers: [\n\t\t\t\t\t\t{ id: \"asc\", value: sortAsc },\n\t\t\t\t\t\t{ id: \"desc\", value: sortDesc },\n\t\t\t\t\t],\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeSortBy(),\n\t\t\t\t\t\tonModifierClick: id => this.ChangeDirection(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn sortBy;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.on(this.State.$changes, \"publicFields\", v => {\n\t\t\tif (v) this.LoadColumns();\n\t\t});\n\t\tthis.on(this.State.$changes, \"fields\", () => {\n\t\t\tif (!this.State.publicFields) this.LoadColumns();\n\t\t});\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = (this.State.publicFields || this.State.fields).map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\n\t\tconst sortBy = this.$$(\"sortBy\");\n\t\tconst list = sortBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.clearAll();\n\t\tlist.parse(columns);\n\n\t\tlet sort = this.State.sort;\n\t\tif (sort) sort = sort.filter(a => !!columns.find(b => b.id == a.id));\n\t\tsortBy.setValue(sort);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChangeSortBy() {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tlet arr = ui.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tconst state = arr.map(id => {\n\t\t\tlet mod = ui.getModifier(id);\n\t\t\tif (!mod) {\n\t\t\t\tmod = \"asc\";\n\t\t\t\tui.setModifier(id, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\n\t\tthis.State.sort = state.length ? state : null;\n\t}\n\n\tChangeDirection(id) {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tui.setModifier(id, ui.getModifier(id) === \"asc\" ? \"desc\" : \"asc\");\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class AxisPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Axis = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabel: _(\"Logarithmic scale\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"logarithmic\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"title\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabelWidth: 190,\n\t\t\t\t\t\tlabel: _(\"Gridlines\"),\n\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\tname: \"lines\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tname: \"lineColor\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tlabel: _(\"Vertical labels\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"verticalLabels\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabelWidth: 190,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.Axis.$changes, \"id\", id => {\n\t\t\tif (id == \"y\") this.ApplyYAxis();\n\t\t\telse this.ApplyXAxis();\n\t\t});\n\t\tthis.on(this.Axis.$changes, \"lines\", v => {\n\t\t\tconst lineColor = this.getRoot().elements[\"lineColor\"];\n\t\t\tif (v) lineColor.show();\n\t\t\telse lineColor.hide();\n\t\t});\n\t\tbind(this.Axis, \"*\", this.getRoot());\n\t}\n\n\tApplyYAxis() {\n\t\tthis.getRoot().elements[\"logarithmic\"].show();\n\t}\n\tApplyXAxis() {\n\t\tthis.getRoot().elements[\"verticalLabels\"].show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseStructureView extends JetView {\n\tHideField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: false });\n\t\tthis.SaveOrder();\n\t}\n\n\tShowField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: true });\n\t\tthis.SaveOrder();\n\t}\n\n\tHideAllEditors(id, name) {\n\t\tif (!name) name = \"fields\";\n\t\tif (this._ActiveEditor[name])\n\t\t\tthis.$$(name).closeSub(this._ActiveEditor[name]);\n\n\t\tthis._ActiveEditor[name] = id;\n\t\tif (id) {\n\t\t\twebix.delay(\n\t\t\t\t() => {\n\t\t\t\t\tconst subView = this.$$(name).getSubView(id);\n\t\t\t\t\tif (subView) subView.focus();\n\t\t\t\t},\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t}\n\n\tResetEditor(name) {\n\t\tthis._ActiveEditor[name || \"fields\"] = null;\n\t}\n\n\tToggleSub(id, name) {\n\t\tconst table = this.$$(name || \"fields\");\n\t\tvar row = table.getItem(id);\n\t\tif (row.$subopen) table.closeSub(id);\n\t\telse table.openSub(id);\n\t}\n\n\tSaveOrder() {}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ColorPopupView extends JetView {\n\tconstructor(app, state) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.Id = null;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"colorselect\",\n\t\t\t\tbutton: true,\n\t\t\t\ton: {\n\t\t\t\t\tonColorSelect: color => {\n\t\t\t\t\t\tlet s = this.GetSeries(this.Id);\n\t\t\t\t\t\tif (s) s.meta.color = color;\n\t\t\t\t\t\tthis.State.updatedSeries = this.Id;\n\t\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tShow(node, id) {\n\t\tconst popup = this.getRoot();\n\t\tthis.Id = id;\n\t\tpopup.show(node);\n\t\tpopup.getBody().setValue(this.GetSeries(id).meta.color);\n\t}\n\n\tGetSeries(id) {\n\t\treturn this.State.series.find(s => s.id == id);\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"text-search\",\n\t\t$cssName: \"search\",\n\t\tdefaults: {\n\t\t\tcloseIcon: \"wxi-close\",\n\t\t\ttemplate: function(obj, common) {\n\t\t\t\tvar text = common.$renderInput(obj);\n\t\t\t\tif (obj.badge || obj.badge === 0)\n\t\t\t\t\ttext = text.replace(\n\t\t\t\t\t\tnew RegExp(\"</div>$\"),\n\t\t\t\t\t\t\"<span class='webix_badge'>\" + obj.badge + \"</span></div>\"\n\t\t\t\t\t);\n\t\t\t\treturn text;\n\t\t\t},\n\t\t},\n\n\t\ton_click: {\n\t\t\twebix_input_icon: function(e) {\n\t\t\t\tconst css = e.target.className;\n\t\t\t\tthis.getInputNode().focus();\n\n\t\t\t\tif (css.indexOf(this.config.closeIcon) > -1) {\n\t\t\t\t\tthis.setValue(\"\");\n\t\t\t\t\tthis.callEvent(\"onCloseIconClick\", [e]);\n\t\t\t\t\tthis.hideCloseIcon();\n\t\t\t\t} else {\n\t\t\t\t\tthis.callEvent(\"onSearchIconClick\", [e]);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t$init() {\n\t\t\tthis.attachEvent(\"onTimedKeyPress\", () => this._onSearch());\n\t\t\tthis.attachEvent(\"onChange\", () => this._onSearch());\n\t\t},\n\t\t_onSearch() {\n\t\t\tconst v = this.getValue();\n\t\t\tif (v) this.showCloseIcon();\n\t\t\telse this.hideCloseIcon();\n\n\t\t\tthis.callEvent(\"onSearchChange\", [v]);\n\t\t},\n\t\tsetIcon(icon) {\n\t\t\tconst nodes = this.$view.getElementsByClassName(\"webix_input_icon\");\n\t\t\tif (nodes.length) nodes[0].className = \"webix_input_icon \" + icon;\n\t\t},\n\t\tshowCloseIcon() {\n\t\t\tthis.setIcon(this.config.closeIcon);\n\t\t},\n\t\thideCloseIcon() {\n\t\t\tthis.setIcon(this.config.icon);\n\t\t},\n\t\tsetBadge(value) {\n\t\t\tlet node = this.$view.querySelector(\".webix_badge\");\n\t\t\tif (value || value === 0) {\n\t\t\t\tif (!node) {\n\t\t\t\t\tnode = webix.html.create(\n\t\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t\t{ class: \"webix_badge\" },\n\t\t\t\t\t\t\"\" + value\n\t\t\t\t\t);\n\t\t\t\t\tthis.$view.querySelector(\".webix_el_box\").appendChild(node);\n\t\t\t\t} else node.innerHTML = \"\" + value;\n\t\t\t} else if (node) webix.html.remove(node);\n\t\t\tthis.config.badge = value;\n\t\t},\n\t},\n\twebix.ui.search\n);\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class SeriesPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Series = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Marker type\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tcss: \"webix_rpt_markerselect\",\n\t\t\t\tname: \"markerType\",\n\t\t\t\toptions: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_rpt_markerselect_list\",\n\t\t\t\t\t\ttemplate: item => this.ItemListTemplate(item),\n\t\t\t\t\t\tdata: this.Charts.getItemTypes(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Fill marker\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"fillMarker\",\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 170,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Series, \"*\", this.getRoot());\n\t\tif (this.Charts.itemSupport.indexOf(this.ChartState.chartType) > -1)\n\t\t\tthis.getRoot().showBatch(\"marker\");\n\n\t\tthis.on(this.Series.$changes, \"color\", () => {\n\t\t\tconst markerType = this.getRoot().elements[\"markerType\"];\n\t\t\tmarkerType.refresh();\n\t\t\tmarkerType.getList().refresh();\n\t\t});\n\t}\n\n\tItemListTemplate(item) {\n\t\treturn `<div class=\"webix_rpt_config_row\">${item.value} <span class='webix_icon ${item.icon}' style='color:${this.Series.color}'></span></div>`;\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\nimport ColorPopup from \"./colorpopup\";\nimport BaseView from \"./baseview\";\nimport \"../../../helpers/rsearch\";\nimport SeriesProperties from \"./chartseries\";\nimport AxisProperties from \"./axis\";\n//import LegendProperties from \"./legend\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis._ActiveEditor = {};\n\t\tconst type = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: this._(\"Chart type\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"type\",\n\t\t\t\t\toptions: this.Charts.getTypes(),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => (this.ChartState.chartType = v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"X axis column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"labelColumn\",\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLabelField(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueFields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\teditable: true,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tif (!this.SubState) this.SubState = {};\n\t\t\t\tconst series = (this.SubState[obj.id] = createState({\n\t\t\t\t\tname: obj.meta.name,\n\t\t\t\t\tcolor: obj.meta.color,\n\t\t\t\t\ttype: obj.meta.type || null,\n\t\t\t\t\tmarkerType: obj.meta.markerType || null,\n\t\t\t\t\tfillMarker: obj.meta.fillMarker || null,\n\t\t\t\t}));\n\t\t\t\tthis.on(\n\t\t\t\t\tseries.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.UpdateSeries(obj.id, series);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new SeriesProperties(this.app, series, this.ChartState);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tthis.openSub(id);\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => this.SaveOrder(),\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\t\"data->onClearAll\": () => this.ResetEditor(),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_chart_color: (e, id) => this.ShowColorPopup(e, id),\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\t\tconst axisFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Axes\") },\n\n\t\t\t\t{\n\t\t\t\t\tview: \"datatable\",\n\t\t\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\t\t\tlocalId: \"axisFields\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\theader: false,\n\t\t\t\t\tselect: false,\n\t\t\t\t\tsubview: (obj, target) => {\n\t\t\t\t\t\tconst axis = createState({ id: obj.id, ...obj.meta });\n\t\t\t\t\t\tthis.on(\n\t\t\t\t\t\t\taxis.$changes,\n\t\t\t\t\t\t\t\"*\",\n\t\t\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\t\t\tthis.UpdateAxis(obj.id, axis);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst sub = new AxisProperties(this.app, axis, this.ChartState);\n\t\t\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\t\t\treturn sub.getRoot();\n\t\t\t\t\t},\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t\ttemplate: (item, common) => this.AxisRowTemplate(item, common),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ToggleSub(id, \"axisFields\"),\n\t\t\t\t\t\tonAfterRender: () => {\n\t\t\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tel &&\n\t\t\t\t\t\t\t\t\tdocument.contains(el) &&\n\t\t\t\t\t\t\t\t\tel !== document.activeElement\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id, \"axisFields\"),\n\t\t\t\t\t\tonSubViewClose: () => this.ResetEditor(\"axisFields\"),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst legendFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Legend\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tlocalId: \"legendPosition\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"bottom\", value: _(\"Bottom\") },\n\t\t\t\t\t\t{ id: \"right\", value: _(\"Right\") },\n\t\t\t\t\t\t{ id: \"none\", value: _(\"None\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLegend(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tcss: \"webix_rpt_chart_config\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\ttype,\n\t\t\t\tlabelField,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"dataInputs\",\n\t\t\t\t\trows: this.GetDataInputs(),\n\t\t\t\t},\n\t\t\t\tvalueFields,\n\t\t\t\taxisFields,\n\t\t\t\tlegendFields,\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Types = this.Charts.getTypes();\n\n\t\tlet fields = [];\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tfields.push({ ...a });\n\t\t});\n\n\t\t// options with all fields\n\t\tthis.Fields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn !field.key;\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\t// Options with numeric fields\n\t\tthis.ValueFields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn field.type == \"number\" && !field.key;\n\t\t\t})\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type, model: a.model }));\n\n\t\tthis.ChartState = createState(this.GetInitState());\n\n\t\tthis.on(this.ChartState.$changes, \"*\", () => {\n\t\t\tthis.UpdateModuleState();\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"chartType\", (type, prev) => {\n\t\t\tthis.ApplyChartType(type, prev);\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"seriesFrom\", (value, prev) => {\n\t\t\tthis.ApplySeriesFrom(value, prev);\n\t\t});\n\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"baseColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"dataColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\n\t\tthis.on(this.ChartState.$changes, \"updatedSeries\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.$$(\"fields\").refresh(v);\n\t\t\t\tif (this.SubState && this.SubState[v])\n\t\t\t\t\tthis.SubState[v].color = this.ChartState.series.find(\n\t\t\t\t\t\ts => s.id == v\n\t\t\t\t\t).meta.color;\n\t\t\t\tthis.ChartState.updatedSeries = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.$$(\"type\").setValue(this.ChartState.chartType);\n\n\t\tthis.$$(\"labelColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"labelColumn\").setValue(this.ChartState.labelColumn);\n\n\t\tthis.$$(\"seriesFrom\").setValue(this.ChartState.seriesFrom);\n\n\t\tthis.$$(\"baseColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"baseColumn\").setValue(this.ChartState.baseColumn);\n\n\t\tthis.$$(\"dataColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.ValueFields);\n\t\tthis.$$(\"dataColumn\").setValue(this.ChartState.dataColumn);\n\n\t\tthis.$$(\"legendPosition\").setValue(this.ChartState.legendPosition);\n\t}\n\n\tChangeLabelField(label) {\n\t\tthis.ChartState.labelColumn = label;\n\t}\n\tChangeLegend(v) {\n\t\tthis.ChartState.legendPosition = v;\n\t}\n\n\tGetInitState() {\n\t\tconst meta = this.State.meta.chart || {};\n\t\treturn {\n\t\t\tchartType: meta.chartType || this.Charts.type,\n\t\t\tlabelColumn: meta.labelColumn || null,\n\t\t\tupdatedSeries: null,\n\t\t\tseriesFrom: meta.seriesFrom || \"columns\",\n\t\t\tbaseColumn: meta.baseColumn || null,\n\t\t\tdataColumn: meta.dataColumn || null,\n\t\t\tseries: meta.series || null,\n\t\t\tlegend: meta.legend || { layout: \"x\" },\n\t\t\taxises: meta.axises || null,\n\t\t\tlegendPosition: meta.legendPosition || \"bottom\",\n\t\t};\n\t}\n\n\t/*\n\t * Called when chart type changed.\n\t * */\n\tApplyChartType(type, prevType) {\n\t\tthis.ShowAxisInputs(type);\n\t\tthis.RenderSeries(prevType);\n\t}\n\n\t/*\n\t * Renders chart series. Loads init state values\n\t * or generates new series depending on selected type\n\t * */\n\tRenderSeries(prevType) {\n\t\tconst series = this.ChartState.series;\n\t\tif (series && typeof prevType == \"undefined\") this.LoadSeries(series);\n\t\telse this.GenerateSeries();\n\t}\n\n\t// Loads axis data\n\tShowAxisInputs(type) {\n\t\tconst isAxises = this.Charts.noAxisSupport.indexOf(type);\n\t\tif (isAxises) {\n\t\t\tif (!this.ChartState.axises) {\n\t\t\t\tthis.ChartState.axises = {\n\t\t\t\t\tx: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tverticalLabels: true,\n\t\t\t\t\t},\n\t\t\t\t\ty: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tlogarithmic: false,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (!this.$$(\"axisFields\").data.count())\n\t\t\t\tthis.$$(\"axisFields\").parse([\n\t\t\t\t\t{ id: \"x\", meta: { ...this.ChartState.axises.x } },\n\t\t\t\t\t{ id: \"y\", meta: { ...this.ChartState.axises.y } },\n\t\t\t\t]);\n\t\t} else {\n\t\t\tthis.ChartState.axises = null;\n\t\t\tthis.$$(\"axisFields\").clearAll();\n\t\t}\n\t}\n\tGetDataInputs() {\n\t\treturn [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{ view: \"label\", label: this._(\"Data series\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Extract series from\"),\n\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\t\t\t\t\tlocalId: \"seriesFrom\",\n\t\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"columns\", value: this._(\"columns\") },\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"rows\", value: this._(\"rows\") },\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.seriesFrom = v),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\tlocalId: \"baseColumnLayout\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Keys column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"baseColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.baseColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Values column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpdataColumnt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"dataColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.dataColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\t}\n\n\t/*\n\t * Generates series and loads these data\n\t * params:\n\t * - an array of fields/ keys options\n\t * */\n\tApplySeriesKeys(sourceArray) {\n\t\tconst data = this.Charts.getSeries(sourceArray, this.ChartState.type);\n\t\tthis.ChartState.series = data;\n\t\tthis.LoadSeries(data);\n\t}\n\n\tLoadSeries(data) {\n\t\tif (!data.length) this.$$(\"fields\").hide();\n\t\telse this.$$(\"fields\").show();\n\n\t\tthis.$$(\"fields\").clearAll();\n\t\tthis.$$(\"fields\").parse(data);\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.State.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\n\tGenerateSeries() {\n\t\tconst from = this.ChartState.seriesFrom;\n\t\tif (from == \"columns\") this.ApplySeriesKeys([...this.ValueFields], null);\n\t\telse {\n\t\t\tthis.ChartState.dataColumn = this.$$(\"dataColumn\").getValue();\n\t\t\tconst base = (this.ChartState.baseColumn = this.$$(\n\t\t\t\t\"baseColumn\"\n\t\t\t).getValue());\n\t\t\tthis.GetRowKeys(base).then(arr => this.ApplySeriesKeys(arr, base));\n\t\t}\n\t}\n\n\tApplySeriesFrom(v, prevValue) {\n\t\tif (this.$$(\"baseColumnLayout\")) {\n\t\t\tif (v == \"columns\") {\n\t\t\t\tthis.$$(\"baseColumnLayout\").hide();\n\t\t\t\tthis.$$(\"baseColumn\").setValue(null);\n\t\t\t} else this.$$(\"baseColumnLayout\").show();\n\t\t\tif (prevValue) {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t}\n\t\t}\n\t}\n\n\tUpdateSeries(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst series = [...this.ChartState.series];\n\t\tconst ind = series.findIndex(a => a.id == id);\n\t\tObject.assign(series[ind].meta, update);\n\t\tthis.ChartState.series = series;\n\t\tthis.$$(\"fields\").refresh(id);\n\t}\n\n\tUpdateAxis(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tlet axises = { ...this.ChartState.axises };\n\t\tObject.assign(axises[id], update);\n\t\tthis.ChartState.axises = axises;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\t\"<span class='webix_icon \" +\n\t\t\t(item.show\n\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\"'></span>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_chart_color' style='background:\" +\n\t\t\titem.meta.color +\n\t\t\t\"'> </div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n\n\tGetData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = this.State.columns.map(c => c.id);\n\t\tlet waitData = [this.Local.getData(moduleConfig)];\n\t\tif (baseColumn) waitData.push(this.Local.getOptionsList(baseColumn));\n\t\treturn Promise.all(waitData);\n\t}\n\n\tShowColorPopup(e, id) {\n\t\tif (!this.ColorPopup || !this.ColorPopup.$view)\n\t\t\tthis.ColorPopup = this.ui(new ColorPopup(this.app, this.ChartState));\n\t\tthis.ActiveSeries = id;\n\t\tthis.ColorPopup.Show(e.target, id);\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\t\tthis.ChartState.series = table.serialize();\n\t}\n\n\tUpdateModuleState() {\n\t\tconst state = this.ChartState;\n\t\tconst columns = [];\n\n\t\tif (state.labelColumn) this.AddColumn(columns, state.labelColumn);\n\t\tif (state.seriesFrom == \"columns\") {\n\t\t\tif (state.series)\n\t\t\t\tstate.series.forEach(a => {\n\t\t\t\t\tif (a.show) this.AddColumn(columns, a.id);\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (state.baseColumn) this.AddColumn(columns, state.baseColumn);\n\t\t\tif (state.dataColumn) this.AddColumn(columns, state.dataColumn);\n\t\t}\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, chart: this.ChartState },\n\t\t});\n\t}\n\n\tAddColumn(columns, id) {\n\t\tconst col = (this.State.publicFields || this.State.fields).find(\n\t\t\tb => b.id === id\n\t\t);\n\t\tif (col) columns.push(col);\n\t}\n\n\tAxisRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'>\" +\n\t\t\tthis._(item.id == \"x\" ? \"X Axis\" : \"Y Axis\");\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class ColumnPropertiesView extends JetView {\n\tconstructor(app, data) {\n\t\tsuper(app);\n\t\tthis.Column = data;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Filter\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"header\",\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: \"none\", value: _(\"No filter\") },\n\t\t\t\t\t{ id: \"text\", value: _(\"Text\") },\n\t\t\t\t\t{ id: \"select\", value: _(\"Select\") },\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Column, \"*\", this.getRoot());\n\t}\n}\n","import BaseView from \"./baseview\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Labels column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"label\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Values column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"value\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst colorField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Color column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: false,\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [valueField, labelField, colorField, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tlet fields = (this.Fields = (\n\t\t\tthis.State.publicFields || this.State.fields\n\t\t).map(a => ({\n\t\t\t...a,\n\t\t})));\n\t\tlet valueFields = fields.filter(\n\t\t\tfield => field.type == \"number\" && !field.key\n\t\t);\n\t\tif (!valueFields.length)\n\t\t\tvalueFields = fields.filter(field => field.type == \"number\");\n\t\tconst els = this.getRoot().elements;\n\n\t\tconst lc = els.label;\n\t\tlc.getList().parse(fields);\n\t\tlc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tlc.setValue(this.State.meta.label || fields[0].id);\n\n\t\tconst vc = els.value;\n\t\tvc.getList().parse(valueFields);\n\t\tvc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tvc.setValue(this.State.meta.value || valueFields[0].id);\n\n\t\tconst cc = els.color;\n\t\tcc.getList().parse(valueFields);\n\t\tcc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tcc.setValue(this.State.meta.color || valueFields[0].id);\n\n\t\tthis.getRoot().attachEvent(\"onChange\", () => this.OnChange());\n\t\tif (!this.State.meta.value) this.OnChange();\n\t}\n\n\tOnChange() {\n\t\tthis.Apply({ ...this.State.meta, ...this.getRoot().getValues() });\n\t}\n\n\tApply(meta) {\n\t\tconst check = [meta.value, meta.label, meta.color];\n\t\tconst columns = this.Fields.filter(a => check.indexOf(a.id) !== -1);\n\n\t\tthis.State.$batch({\n\t\t\tmeta,\n\t\t\tcolumns,\n\t\t});\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.name +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { types } from \"../../../helpers/icons\";\n\nexport default class StructureView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"select\",\n\t\t\tborderless: true,\n\t\t\talign: \"left\",\n\t\t\tinputWidth: 170,\n\t\t\toptions: [\n\t\t\t\t{\n\t\t\t\t\tid: \"table\",\n\t\t\t\t\tvalue: types.table + \" \" + _(\"Table\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"chart\",\n\t\t\t\t\tvalue: types.chart + \" \" + _(\"Chart\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"heatmap\",\n\t\t\t\t\tvalue: types.heatmap + \" \" + _(\"Heatmap\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ChangeReportType(v),\n\t\t\t},\n\t\t};\n\n\t\tconst toolbar = {\n\t\t\tview: \"form\",\n\t\t\tpadding: {\n\t\t\t\tleft: webix.skin.$active.layoutPadding.form,\n\t\t\t\ttop: 5,\n\t\t\t\tbottom: 0,\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tcols: [tabbar],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 480,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"type\", v => {\n\t\t\tthis.show(\"editor.structure.\" + v);\n\t\t});\n\t\tthis.$$(\"select\").setValue(this.State.type);\n\t}\n\n\tChangeReportType(type) {\n\t\tif (this.State.type != type) this.State.$batch({ type, meta: {} });\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\n\nimport ColumnProperties from \"./column\";\n\nimport \"../../../helpers/rsearch\";\nimport BaseView from \"./baseview\";\n\nexport default class ColumnsView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis._ActiveEditor = {};\n\t\tconst header = {\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Columns\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonSearchChange: () => this.FilterFields(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst fields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst column = createState({\n\t\t\t\t\tname: obj.meta.name || obj.name,\n\t\t\t\t\theader: obj.meta.header || \"none\",\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tcolumn.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, column);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new ColumnProperties(this.app, column);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tif (id.row !== \"$freeze\") this.openSub(id);\n\t\t\t\t},\n\t\t\t\tonBeforeDrag: ctx => {\n\t\t\t\t\tthis.HideAllEditors();\n\t\t\t\t\tconst list = this.$$(\"fields\");\n\t\t\t\t\twebix.html.addCss(list.$view, \"webix_rpt_drag\");\n\n\t\t\t\t\tif (ctx.start === \"$freeze\") {\n\t\t\t\t\t\tctx.html = `<div class=\"webix_drag_zone\"><div class=\"webix_dd_drag wbx-mark_frozen\" style=\"width:${\n\t\t\t\t\t\t\tlist.$width\n\t\t\t\t\t\t}px;\"><div>${this.FrozenTemplate()}</div></div></div>`;\n\t\t\t\t\t} else if (!list.getItem(ctx.start).show) return false;\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => {\n\t\t\t\t\twebix.html.removeCss(this.$$(\"fields\").$view, \"webix_rpt_drag\");\n\t\t\t\t\tthis.SaveOrder();\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [header, fields],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst table = this.$$(\"fields\");\n\t\tconst has = {};\n\t\tconst columns = this.State.columns.map(a => {\n\t\t\thas[a.id] = 1;\n\t\t\treturn { ...a, show: true };\n\t\t});\n\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tif (!has[a.id]) columns.push({ ...a, show: false });\n\t\t});\n\n\t\tcolumns.splice(this.State.meta.freeze || 0, 0, {\n\t\t\tid: \"$freeze\",\n\t\t\t$css: \"wbx-mark_frozen\",\n\t\t\tname: this.FrozenTemplate(),\n\t\t});\n\t\ttable.parse(columns);\n\t}\n\n\tFilterFields() {\n\t\tconst f = this.$$(\"search\")\n\t\t\t.getValue()\n\t\t\t.toLowerCase();\n\t\tthis.$$(\"fields\").filter(a => a.name.toLowerCase().indexOf(f) !== -1);\n\t}\n\n\tUpdate(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst columns = [...this.State.columns];\n\t\tconst ind = columns.findIndex(a => a.id == id);\n\t\tObject.assign(columns[ind].meta, update);\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tGetFreeze() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst order = table.data.order;\n\n\t\tlet freezeColumn = 0;\n\t\tfor (var i = 0; i < order.length; i++) {\n\t\t\tif (order[i] === \"$freeze\") break;\n\t\t\tfreezeColumn += table.getItem(order[i]).show ? 1 : 0;\n\t\t}\n\n\t\treturn freezeColumn;\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tFrozenTemplate() {\n\t\treturn (\n\t\t\t\"<span class='webix_rpt_frozen webix_icon rpi-arrow-horizontal-lock'></span><span>\" +\n\t\t\tthis._(\"Frozen columns above\") +\n\t\t\t\"</span>\"\n\t\t);\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\titem.id !== \"$freeze\"\n\t\t\t\t? \"<span class='webix_icon \" +\n\t\t\t\t  (item.show\n\t\t\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\t  \"'></span>\"\n\t\t\t\t: \"\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += item.id !== \"$freeze\" ? common.subrow(item, common) : \"\";\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { empty } from \"../helpers/icons\";\n\nexport default class EmptyView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tcss: \"webix_rpt_empty\",\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\ttemplate: value => this.GetTemplate(value),\n\t\t};\n\t}\n\tinit() {\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tmods.waitData.then(() => {\n\t\t\tconst text = this.GetText(mods.data.count());\n\t\t\tthis.getRoot().setValues({ text });\n\t\t});\n\t}\n\tGetText(count) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn count\n\t\t\t? _(\"Select any report from the list\")\n\t\t\t: _(\"Click 'New' button to add a new report\");\n\t}\n\tGetSVG() {\n\t\tconst skin = webix.skin.$name;\n\t\tconst icon = skin == \"willow\" || skin == \"dark\" ? \"alt\" : \"main\";\n\t\treturn empty[icon];\n\t}\n\tGetTemplate(value) {\n\t\tconst text =\n\t\t\t\"<div class='webix_rpt_empty_placeholder'>\" +\n\t\t\t(value.text || \"\") +\n\t\t\t\"</div>\";\n\t\treturn text + this.GetSVG();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Toolbar from \"./common/toolbar\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.meta.value && mod.type === \"heatmap\") {\n\t\t\tconst config = this.GetChartConfig(mod);\n\t\t\tif (!config.view) return;\n\t\t\tthis.Bar.show();\n\t\t\tthis.GetChartData(mod).then(([data, options]) => {\n\t\t\t\tconfig.data = this.FormatLabels(webix.copy(data), options);\n\t\t\t\tif (data.length && mod.meta.color)\n\t\t\t\t\tconfig.type.cssClass = this.CssFactory(data, mod.meta.color);\n\n\t\t\t\twebix.ui([config], host);\n\t\t\t\tthis.Chart = host.getChildViews()[0];\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{ template: \" \" }], host);\n\t\t\tthis.Bar.hide();\n\t\t\tthis.Chart = null;\n\t\t}\n\t}\n\n\tGetChartConfig(mod) {\n\t\tconst { meta, columns } = mod;\n\n\t\tconst obj = {\n\t\t\tview: \"treemap\",\n\t\t\tcss: \"webix_rpt\",\n\t\t\tvalue: obj => obj[meta.value],\n\t\t\ttooltip: this.TooltipFactory(meta, columns),\n\t\t\ttype: {},\n\t\t};\n\n\t\tif (meta.label) obj.type.template = obj => obj[meta.label];\n\n\t\treturn obj;\n\t}\n\n\tGetChartData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tCssFactory(data, prop) {\n\t\tvar min = Infinity;\n\t\tvar max = -Infinity;\n\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tconst v = data[i][prop];\n\t\t\tif (v > max) max = v * 1;\n\t\t\tif (v < min) min = v * 1;\n\t\t}\n\n\t\tconst step = (max - min) / 4;\n\t\tconst bases = [max - step, max - step * 2, max - step * 3, min];\n\n\t\treturn function(obj) {\n\t\t\tconst v = obj[prop];\n\t\t\tfor (var i = 0; i < bases.length; i++) if (v >= bases[i]) return \"l\" + i;\n\t\t};\n\t}\n\n\tTooltipFactory(obj, columns) {\n\t\tconst valueColumn = columns.find(a => a.id === obj.value);\n\t\tconst colorColumn = columns.find(a => a.id === obj.color);\n\t\tif (!valueColumn || !colorColumn) return \"\";\n\t\tconst props = [obj.value, valueColumn.name];\n\t\tif (obj.color && obj.color != obj.value)\n\t\t\tprops.push(obj.color, colorColumn.name);\n\n\t\treturn function(obj) {\n\t\t\tlet out = \"\";\n\t\t\tfor (let i = 0; i < props.length; i += 2) {\n\t\t\t\tout += (i ? \", \" : \"\") + props[i + 1] + \": \" + obj[props[i]];\n\t\t\t}\n\n\t\t\treturn out;\n\t\t};\n\t}\n\t/**\n\t * Exports chart to png image or PDF\n\t * @param {String} mode - export mode ( \"png\" or PDF \"table\"/\"image\"/\"all\"),\n\t */\n\tExport(mode) {\n\t\tif (this.Chart) {\n\t\t\tif (mode == \"png\") webix.toPNG(this.Chart);\n\t\t\telse if (mode == \"pdf\") {\n\t\t\t\tlet params = { autowidth: true, display: \"image\" };\n\t\t\t\twebix.toPDF(this.Chart, params);\n\t\t\t}\n\t\t}\n\t}\n\tFormatLabels(data, options) {\n\t\tconst labelColumn = this.State.module.meta.label;\n\t\tconst labelOptions =\n\t\t\tlabelColumn && options.length\n\t\t\t\t? options.find(op => op.field == labelColumn)\n\t\t\t\t: null;\n\n\t\tif (labelOptions)\n\t\t\tdata.forEach(item => {\n\t\t\t\tconst option = labelOptions.data.find(o => o.id == item[labelColumn]);\n\t\t\t\titem[labelColumn] = option ? option.value : item[labelColumn];\n\t\t\t});\n\t\telse {\n\t\t\tconst field = this.State.module.fields.find(\n\t\t\t\tfield => field.id == labelColumn\n\t\t\t);\n\t\t\tif (field && field.type == \"date\") {\n\t\t\t\tdata.forEach(item => {\n\t\t\t\t\titem[labelColumn] = webix.i18n.dateFormatStr(\n\t\t\t\t\t\tnew Date(item[labelColumn])\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MenuPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tborderless: true,\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj =>\n\t\t\t\t\t`<span class='webix_icon ${obj.icon}'></span>${obj.value}`,\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Edit\"),\n\t\t\t\t\t\tid: \"edit\",\n\t\t\t\t\t\ticon: \"rpi-square-edit-outline\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Create copy\"),\n\t\t\t\t\t\tid: \"copy\",\n\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\t\t\tid: \"delete\",\n\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.app.callEvent(\"onMenuAction\", [this.ID, id]);\n\t\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {}\n\n\tShow(trg, id) {\n\t\tthis.ID = id;\n\t\twebix.delay(() => {\n\t\t\tif (this.getRoot()) this.getRoot().show(trg);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../helpers/rsearch\";\nimport MenuPopup from \"./menu\";\nimport { types } from \"../helpers/icons\";\n\nexport default class GridsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tpadding: { left: 10, right: 10, top: 5, bottom: 5 },\n\t\t\tmargin: 0,\n\t\t\tlocalId: \"bar\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"Reports\") },\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"nameSorting\",\n\t\t\t\t\ticon: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon webix_rpt_btn_active\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-alphabetical-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"name\"),\n\t\t\t\t},\n\t\t\t\t{ width: 4 },\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"updatedSorting\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon\",\n\t\t\t\t\ticon: \"rpi-sort-calendar-descending\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-calendar-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-calendar-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"updated\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst menu = {\n\t\t\tview: \"form\",\n\t\t\tpadding: { left: 10, right: 10, top: 2, bottom: 4 },\n\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"list\",\n\t\t\tscroll: true,\n\t\t\tselect: true,\n\t\t\tcss: \"webix_rpt_list\",\n\t\t\ttype: {\n\t\t\t\theight: webix.skin.$active.rowHeight + 24,\n\t\t\t\ttemplate: data => this.GetListTemplate(data),\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: function(obj) {\n\t\t\t\t\tif (obj.date && typeof obj.date === \"string\")\n\t\t\t\t\t\tobj.date = new Date(obj.date);\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_action_menu: (e, id) => {\n\t\t\t\t\tthis.Menu.Show(e, id);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t\tonDblClick: {},\n\t\t\ton: {\n\t\t\t\tonAfterSelect: id => this.LoadModule(id, null),\n\t\t\t\tonItemDblClick: id => this.LoadModule(id, \"edit\"),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\twidth: 320,\n\t\t\ttype: \"clean\",\n\t\t\trows: [bar, { type: \"clean\", rows: [menu, table] }],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Menu = this.ui(MenuPopup);\n\n\t\tconst list = this.$$(\"list\");\n\t\tlist.$view.firstChild.setAttribute(\"placeholder\", this._(\"No reports\"));\n\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tlist.sync(mods);\n\t\tmods.waitData.then(() => {\n\t\t\tif (this.State.moduleId) list.select(this.State.moduleId);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.$$(\"list\").refresh());\n\n\t\tthis.$$(\"search\").attachEvent(\"onSearchChange\", v => this.Find(v));\n\n\t\tthis.Sorting = { by: \"name\", dir: \"asc\" };\n\t}\n\n\tLoadModule(id, mode) {\n\t\tthis.app.callEvent(\"loadModule\", [id, mode]);\n\t}\n\n\tHide() {\n\t\tthis.app.callEvent(\"hideModuleList\");\n\t}\n\n\tFind() {\n\t\tlet text = this.$$(\"search\").getValue();\n\t\tconst list = this.$$(\"list\");\n\t\tif (text) {\n\t\t\ttext = text.toLowerCase();\n\t\t\tlist.filter(data => this.SearchCompare(text, data));\n\t\t} else {\n\t\t\tlist.filter();\n\t\t}\n\t}\n\tSearchCompare(value, item) {\n\t\treturn item.name.toLowerCase().indexOf(value) > -1;\n\t}\n\n\tGetListTemplate(item) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet html = \"<div class='webix_rpt_list_block'>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_name'>\" +\n\t\t\ttypes[item.parsed.type] +\n\t\t\t\" \" +\n\t\t\titem.name +\n\t\t\t\"</div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_date'>\" +\n\t\t\t_(\"Last modified\") +\n\t\t\t\": \" +\n\t\t\twebix.i18n.longDateFormatStr(item.updated || new Date()) +\n\t\t\t\"</div>\";\n\t\tif (!this.State.readonly)\n\t\t\thtml +=\n\t\t\t\t\"<span class='webix_icon webix_rpt_action_menu rpi-dots-vertical'></span>\";\n\t\treturn html + \"</div>\";\n\t}\n\n\tSort(by) {\n\t\tlet sState = this.Sorting;\n\t\tconst prevState = webix.copy(sState);\n\t\tif (sState.by == by) sState.dir = sState.dir == \"desc\" ? \"asc\" : \"desc\";\n\t\telse {\n\t\t\tsState.by = by;\n\t\t\tsState.dir = \"desc\";\n\t\t}\n\t\tsState.as = by == \"updated\" ? \"date\" : \"string\";\n\t\tthis.ChangeSortButtons(sState, prevState);\n\t\tthis.$$(\"list\").sort(sState);\n\t}\n\n\tChangeSortButtons(state, prevState) {\n\t\tconst btn = this.$$(state.by + \"Sorting\");\n\n\t\tthis.webix.html.addCss(btn.$view, \"webix_rpt_btn_active\");\n\t\tbtn.config.icon = btn.config.icons[state.dir];\n\t\tbtn.refresh();\n\t\tif (state.by != prevState.by) {\n\t\t\tconst prevBtn = this.$$(prevState.by + \"Sorting\");\n\t\t\tthis.webix.html.removeCss(prevBtn.$view, \"webix_rpt_btn_active\");\n\t\t}\n\t}\n}\n","import BaseExportView from \"../common/export\";\n\nexport default class ExportView extends BaseExportView {\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To Excel\"), id: \"excel\" },\n\t\t\t{ value: _(\"To CSV\"), id: \"csv\" },\n\t\t];\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/rsearch\";\nimport ExportMenu from \"./export\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: viewId => this.ShowExportPopup(viewId),\n\t\t\t\t},\n\t\t\t\t{},\n\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t\tmaxWidth: 600,\n\t\t\t\t\tminWidth: 200,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn bar;\n\t}\n\n\tready() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"search\").attachEvent(\n\t\t\t\"onSearchChange\",\n\t\t\tv => (this.State.search = v)\n\t\t);\n\t\tthis.on(this.app, \"onRecordsSearch\", (value, result) => {\n\t\t\tif (value) this.$$(\"search\").setBadge(result.length);\n\t\t\telse this.$$(\"search\").setBadge(null);\n\t\t});\n\t}\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport Toolbar from \"./toolbar\";\n\nconst typeToSort = {\n\tnumber: \"int\",\n\tdate: \"date\",\n\ttext: \"string\",\n\tboolean: \"number\",\n\tpicklist: \"text\",\n\treference: \"text\",\n};\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.LocalState = createState({ search: \"\" });\n\t\tthis.setParam(\"state\", this.LocalState);\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t\tthis.on(this.LocalState.$changes, \"search\", v => this.Find(v));\n\t}\n\n\tExport(mode) {\n\t\tconst params = {\n\t\t\tignore: { $selection: true },\n\t\t\tplainOutput: true,\n\t\t\tfilterHTML: true,\n\t\t};\n\t\tif (this.Table) {\n\t\t\tif (mode == \"excel\") webix.toExcel(this.Table, params);\n\t\t\telse if (mode == \"csv\") webix.toCSV(this.Table, params);\n\t\t}\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.columns.length && mod.type === \"table\") {\n\t\t\tconst config = this.GetTableConfig(mod);\n\t\t\tif (!config) return;\n\n\t\t\tthis.Bar.show();\n\t\t\twebix.ui([config], host);\n\t\t\tconst table = (this.Table = host.getChildViews()[0]);\n\n\t\t\tthis.GetTableData(mod).then(([data, options]) => {\n\t\t\t\t// table already reconstructed on moment of data loading\n\t\t\t\tif (table.$destructed) return;\n\t\t\t\toptions.forEach(({ field, data }) => {\n\t\t\t\t\tif (!this.IsBucketColumn(field))\n\t\t\t\t\t\ttable.getColumnConfig(field).collection.parse(data);\n\t\t\t\t});\n\t\t\t\ttable.parse(data);\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{}], host);\n\t\t\tthis.Table = null;\n\t\t\tthis.Bar.hide();\n\t\t}\n\t}\n\tIsBucketColumn(field, module) {\n\t\tmodule = module || this.State.module;\n\t\treturn module.buckets && module.buckets.find(b => b.column == field);\n\t}\n\tGetTableConfig(mod) {\n\t\tconst { groups, columns, meta } = mod;\n\t\tif (!columns) return null;\n\t\tlet dateColumns = [];\n\t\tconst gColumns = columns.map(a => {\n\t\t\tif (a.type == \"date\") dateColumns.push(a.id);\n\t\t\treturn this.GetColumnConfig(a);\n\t\t});\n\n\t\tconst edit = this.State.mode === \"edit\";\n\t\tconst grid = {\n\t\t\tview: groups ? \"treetable\" : \"datatable\",\n\t\t\tcolumns: gColumns,\n\t\t\tresizeColumn: edit ? { headerOnly: true } : false,\n\t\t\tleftSplit: meta.freeze ? meta.freeze : 0,\n\t\t\tcss: edit ? \"webix_header_border\" : \"\",\n\t\t\ton: {\n\t\t\t\tonColumnResize: (id, width, old, byUser) =>\n\t\t\t\t\tthis.SetColWidth(id, width, old, byUser),\n\t\t\t},\n\t\t};\n\n\t\tif (dateColumns.length)\n\t\t\tgrid.scheme = {\n\t\t\t\t$change: row =>\n\t\t\t\t\tdateColumns.forEach(cId => (row[cId] = new Date(row[cId]))),\n\t\t\t};\n\n\t\treturn grid;\n\t}\n\n\tGetColumnConfig(a) {\n\t\tlet column = {\n\t\t\tid: a.id,\n\t\t\theader:\n\t\t\t\t!a.meta.header || a.meta.header === \"none\"\n\t\t\t\t\t? a.meta.name || a.name\n\t\t\t\t\t: [\n\t\t\t\t\t\t\ta.meta.name || a.name,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t\t\ta.meta.header === \"text\" ? \"textFilter\" : \"richSelectFilter\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ],\n\t\t\ttype: a.type,\n\t\t\tsort: typeToSort[a.type],\n\t\t\twidth: a.width || 200,\n\t\t};\n\n\t\tif (a.type === \"date\") column.format = webix.i18n.dateFormatStr;\n\t\tif (a.type === \"boolean\") {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tcolumn.template = obj => (obj[a.id] == 1 ? _(\"True\") : _(\"False\"));\n\t\t}\n\t\tif (\n\t\t\t(a.type === \"reference\" || a.type === \"picklist\") &&\n\t\t\t!this.IsBucketColumn(a.id)\n\t\t)\n\t\t\tcolumn.options = [];\n\n\t\treturn column;\n\t}\n\n\tSetColWidth(id, width, old, byUser) {\n\t\tif (byUser) {\n\t\t\tif (id === \"$selection\" || id === \"$subrow\") {\n\t\t\t\tconst table = this.Tbl;\n\t\t\t\ttable.blockEvent();\n\t\t\t\ttable.setColumnWidth(id, old);\n\t\t\t\ttable.unblockEvent();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.app.callEvent(\"onColumnResize\", [id, width]);\n\t\t}\n\t}\n\n\tGetTableData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tFind(value) {\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tconst table = this.Table;\n\t\tlet result = [];\n\t\tif (!table) return;\n\t\ttable.clearCss(\"webix_rpt_found_record\", true);\n\n\t\tif (value) {\n\t\t\tconst ignoreDateNumber = h.hasNonDigits(value);\n\t\t\tconst regexp = new RegExp(h.wildToRegexp(value), \"gi\");\n\t\t\tconst fields = table.config.columns.filter(\n\t\t\t\tc =>\n\t\t\t\t\t!(c.id === \"$selection\" || c.id === \"$subrow\") &&\n\t\t\t\t\t(!ignoreDateNumber || !(c.type === \"number\" || c.type === \"date\"))\n\t\t\t);\n\n\t\t\tconst matchers = [];\n\n\t\t\tfor (let i = 0; i < fields.length; ++i) {\n\t\t\t\tconst type = fields[i].type || \"text\";\n\t\t\t\tconst colId = fields[i].id;\n\t\t\t\tif (type === \"text\" || type === \"number\") {\n\t\t\t\t\tmatchers.push(o => regexp.test(o[colId]));\n\t\t\t\t} else if (type === \"reference\" || type === \"picklist\") {\n\t\t\t\t\tconst collection = table.getColumnConfig(colId).collection;\n\n\t\t\t\t\tconst optionsMatch = h.findOptions(collection, regexp);\n\t\t\t\t\tmatchers.push(h.matchPerColumn(colId, a => optionsMatch[a]));\n\t\t\t\t} else if (type === \"bool\") {\n\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\tcase \"true\":\n\t\t\t\t\t\t\tmatchers.push(o => o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"false\":\n\t\t\t\t\t\t\tmatchers.push(o => !o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else if (type === \"date\") {\n\t\t\t\t\tconst dateFormats = table.getColumnConfig(colId).format;\n\t\t\t\t\tmatchers.push(o => regexp.test(dateFormats(o[colId])));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet found = false;\n\t\t\tresult = table.find(obj => {\n\t\t\t\tfor (let i = 0; i < matchers.length; ++i) {\n\t\t\t\t\tif (matchers[i](obj)) {\n\t\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\ttable.showItem(obj.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.addCss(obj.id, \"webix_rpt_found_record\", true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\ttable.refresh();\n\t\tthis.app.callEvent(\"onRecordsSearch\", [value, result]);\n\t}\n}\n","export default function handler(view) {\n\treturn {\n\t\tattachEvent: (key, handler) => {\n\t\t\twebix.UIManager.addHotKey(key, handler, view);\n\t\t\treturn { key, handler };\n\t\t},\n\t\tdetachEvent: ({ key, handler }) =>\n\t\t\twebix.UIManager.removeHotKey(key, handler, view),\n\t};\n}\n","export default class Charts {\n\tconstructor(_app) {\n\t\tthis._app = _app;\n\t\tthis.type = \"line\";\n\t\tthis.type = \"line\";\n\t\tthis.colors = [\n\t\t\t\"#FF9700\",\n\t\t\t\"#4CB050\",\n\t\t\t\"#00BCD4\",\n\t\t\t\"#3F51B5\",\n\t\t\t\"#9C28B1\",\n\t\t\t\"#F34336\",\n\t\t\t\"#FFEA3B\",\n\t\t\t\"#009788\",\n\t\t\t\"#2196F3\",\n\t\t\t\"#673BB7\",\n\t\t\t\"#EA1E63\",\n\t\t];\n\t\tthis.itemSupport = [\"line\", \"spline\", \"radar\"];\n\t\tthis.noAxisSupport = [\"pie\", \"donut\"];\n\t\tthis.lineTypes = [\"line\", \"spline\"];\n\t\tthis.multiTypeSupport = [\n\t\t\t\"bar\",\n\t\t\t\"stackedBar\",\n\t\t\t\"area\",\n\t\t\t\"stackedArea\",\n\t\t\t\"splineArea\",\n\t\t];\n\t\tthis.numLimit = 30;\n\t}\n\t/*\n\tGet chart type data.\n\tCreate an array of objects {id, value}\n\tand return this array.\n\t*/\n\tgetTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.types)\n\t\t\tthis.types = [\n\t\t\t\t{ id: \"line\", value: _(\"Line\"), icon: \"rpi-chart-line\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"spline\",\n\t\t\t\t\tvalue: _(\"Spline\"),\n\t\t\t\t\ticon: \"rpi-chart-bell-curve-cumulative\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"area\",\n\t\t\t\t\tvalue: _(\"Area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedArea\",\n\t\t\t\t\tvalue: _(\"Stacked area\"),\n\t\t\t\t\ticon: \"rpi-chart-line-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"splineArea\",\n\t\t\t\t\tvalue: _(\"Spline area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline-variant\",\n\t\t\t\t},\n\n\t\t\t\t{ id: \"bar\", value: _(\"Bar\"), icon: \"rpi-chart-bar\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedBar\",\n\t\t\t\t\tvalue: _(\"Stacked bar\"),\n\t\t\t\t\ticon: \"rpi-chart-bar-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"radar\",\n\t\t\t\t\tvalue: _(\"Radar\"),\n\t\t\t\t\ticon: \"rpi-vector-triangle\",\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.types;\n\t}\n\n\tgetItemTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.itemTypes)\n\t\t\tthis.itemTypes = [\n\t\t\t\t{\n\t\t\t\t\tid: \"r\",\n\t\t\t\t\tvalue: _(\"circle\"),\n\t\t\t\t\ticon: \"rpi-circle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"s\",\n\t\t\t\t\tvalue: _(\"square\"),\n\t\t\t\t\ticon: \"rpi-square-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"t\",\n\t\t\t\t\tvalue: _(\"triangle\"),\n\t\t\t\t\ticon: \"rpi-triangle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"d\",\n\t\t\t\t\tvalue: _(\"diamond\"),\n\t\t\t\t\ticon: \"rpi-rhombus-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"no\",\n\t\t\t\t\tvalue: _(\"no markers\"),\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.itemTypes;\n\t}\n\n\tgetSeries(fiedls, type) {\n\t\tlet data = [];\n\t\tlet colorIndex = 0;\n\t\tfiedls.forEach(field => {\n\t\t\tlet series = {\n\t\t\t\tid: field.id,\n\t\t\t\tname: field.value,\n\t\t\t\tmodel: field.model || null,\n\t\t\t\tshow: true,\n\t\t\t\tmeta: {\n\t\t\t\t\tname: field.value,\n\t\t\t\t\tcolor: this.colors[colorIndex] || this.colors[0],\n\t\t\t\t},\n\t\t\t};\n\t\t\tcolorIndex++;\n\n\t\t\tif (this.itemSupport.indexOf(type) != -1) {\n\t\t\t\tseries.meta.markerType = \"r\";\n\t\t\t\tseries.meta.fillMarker = false;\n\t\t\t}\n\t\t\tdata.push(series);\n\t\t});\n\t\treturn data;\n\t}\n}\n","export function waitVisible(view){\n\tconst promise = webix.promise.defer();\n\n\tconst interval = setInterval(()=> {\n\t\tconst destructed = view.$destructed;\n\t\tif(destructed || view.isVisible()){\n\t\t\tif(destructed)\n\t\t\t\tpromise.reject();\n\t\t\telse\n\t\t\t\tpromise.resolve();\n\t\t\tclearInterval(interval);\n\t\t}\n\t}, 300);\n\n\treturn promise;\n}","import { JetView } from \"webix-jet\";\n\nexport default class AddView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst cals = this.app.config.calendars;\n\n\t\tconst ui = {\n\t\t\tview: compact ? \"icon\" : \"button\",\n\t\t\ttype: \"icon\",\n\t\t\ticon: \"wxi-plus\",\n\t\t\tcss: \"webix_primary\",\n\t\t\tlabel: _(\"Create\"),\n\t\t\twidth: compact ? 50 : cals ? 185 : 100,\n\t\t\theight: compact ? 50 : webix.skin.$active.inputHeight,\n\t\t\ton: {\n\t\t\t\tonItemClick: () => this.AddEvent(),\n\t\t\t},\n\t\t};\n\n\t\treturn { view: \"align\", body: ui, align: \"middle\" };\n\t}\n\n\tAddEvent() {\n\t\tthis.app.getState().selected = { id: \"0\" };\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconfig() {\n\t\tconst toolbar = [\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-angle-left\",\n\t\t\t\ttooltip: () => this.NavLabel(-1),\n\t\t\t\talign: \"left\",\n\t\t\t\ton: { onItemClick: () => this.ChangeDate(-1) },\n\t\t\t},\n\t\t\t{ view: \"label\", localId: \"title\", align: \"center\", width: 160 },\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-angle-right\",\n\t\t\t\ttooltip: () => this.NavLabel(1),\n\t\t\t\talign: \"right\",\n\t\t\t\ton: { onItemClick: () => this.ChangeDate(1) },\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tcols: toolbar,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.on(this.State.$changes, \"date\", () => this.DateLabel());\n\t\tthis.on(this.State.$changes, \"mode\", () => this.DateLabel());\n\t\tif (this.app.config.timeline)\n\t\t\tthis.on(this.State.$changes, \"timelineMode\", () => this.DateLabel());\n\t}\n\n\tChangeDate(dir) {\n\t\tconst state = this.State;\n\t\tconst step = this.GetStep(state.mode);\n\t\tconst next = webix.Date.add(state.date, dir, step, true);\n\n\t\t// fix navigation in month mode when last day of month is selected\n\t\tif (state.mode === \"month\") {\n\t\t\tconst diff = Math.abs(state.date.getMonth() - next.getMonth());\n\t\t\tif (diff != 1 && diff < 6) next.setDate(0);\n\t\t}\n\n\t\tstate.$batch({\n\t\t\tdate: next,\n\t\t\tselected: null,\n\t\t});\n\t}\n\n\tGetStep(mode) {\n\t\tswitch (mode) {\n\t\t\tcase \"agenda\":\n\t\t\t\treturn \"month\";\n\t\t\tcase \"units\":\n\t\t\t\treturn \"day\";\n\t\t\tcase \"timeline\":\n\t\t\t\treturn this.State.timelineMode;\n\t\t\tdefault:\n\t\t\t\treturn mode;\n\t\t}\n\t}\n\n\tDateLabel() {\n\t\tconst date = this.State.date;\n\t\tconst mode = this.State.mode;\n\t\tlet format = webix.Date.dateToStr(\"%F %Y\");\n\t\tif (mode === \"year\") format = webix.Date.dateToStr(\"%Y\");\n\t\telse if (\n\t\t\tmode == \"day\" ||\n\t\t\tmode == \"units\" ||\n\t\t\t(mode == \"timeline\" && this.State.timelineMode == \"day\")\n\t\t)\n\t\t\tformat = webix.i18n.longDateFormatStr;\n\n\t\tthis.$$(\"title\").setHTML(format(date));\n\t}\n\n\tNavLabel(dir) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst modes = [\"month\", \"week\", \"day\"];\n\t\tlet mode = this.State.mode;\n\t\tmode = modes.indexOf(mode) !== -1 ? ` ${mode}` : \"\";\n\n\t\tdir = dir > 0 ? \"Next\" : \"Previous\";\n\n\t\treturn _(dir + mode);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class NavBarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst units = !!this.app.config.units;\n\n\t\tconst toolbar = {\n\t\t\thidden: compact,\n\t\t\tview: \"tabbar\",\n\t\t\tbottomOffset: 0,\n\t\t\tlocalId: \"buttons\",\n\t\t\tborderless: true,\n\t\t\twidth: 320,\n\t\t\toptionWidth: 80,\n\t\t\toptions: [\n\t\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t\t{ id: \"week\", value: _(\"Week\") },\n\t\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t\t{ id: \"agenda\", value: _(\"Agenda\") },\n\t\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t],\n\t\t};\n\n\t\tif (this.app.config.timeline) {\n\t\t\ttoolbar.width += 80;\n\t\t\ttoolbar.options.push({ id: \"timeline\", value: _(\"Timeline\") });\n\t\t}\n\n\t\tif (!compact) {\n\t\t\ttoolbar.on = { onChange: val => this.SetMode(val) };\n\t\t}\n\n\t\tif (units) {\n\t\t\ttoolbar.width += 80;\n\t\t\ttoolbar.options.push({ id: \"units\", value: _(\"Units\") });\n\t\t}\n\n\t\treturn toolbar;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.on(this.State.$changes, \"mode\", val => {\n\t\t\tthis.$$(\"buttons\").setValue(val);\n\t\t});\n\t}\n\tSetMode(val) {\n\t\tthis.State.$batch({\n\t\t\tmode: val,\n\t\t\tselected: null,\n\t\t});\n\t}\n}\n","const defaultPalette = [\n\t[\"#61AEE6\", \"#01C2A5\", \"#E88DD9\", \"#D2FB9E\", \"#6BA8CB\", \"#61BBA5\", \"#CF89D5\"],\n\t[\"#EF9C80\", \"#8289EE\", \"#74B1A7\", \"#DD89AF\", \"#E48882\", \"#997CEB\", \"#ADD579\"],\n\t[\"#F68896\", \"#FFE999\", \"#6D4BCE\", \"#99CA58\", \"#D352BE\", \"#F7CC34\", \"#DA5C53\"],\n];\nconst modernPalette = [\n\t[\"#5890DC\", \"#3AA3E3\", \"#045AA3\", \"#014593\", \"#01C2A5\", \"#61A649\", \"#157B7A\"],\n\t[\"#04864F\", \"#AD44AB\", \"#CB61C8\", \"#AC3C6E\", \"#BA282E\", \"#BD4E1B\", \"#B87728\"],\n\t[\"#B65F06\", \"#7A67EB\", \"#4536AD\", \"#282A8A\", \"#36337E\", \"#585B85\", \"#2A2F50\"],\n];\nconst palettes = {\n\tmaterial: defaultPalette,\n\tmini: defaultPalette,\n\tflat: defaultPalette,\n\tcompact: defaultPalette,\n\tcontrast: defaultPalette,\n\twillow: modernPalette,\n\tdark: modernPalette,\n};\n\nexport default function getPalette() {\n\tconst aSkin = webix.skin.$active;\n\treturn {\n\t\tview: \"colorboard\",\n\t\tcss: \"webix_scheduler_palette\",\n\t\theight: aSkin.optionHeight * 3 + 4,\n\t\twidth: aSkin.optionHeight * 7 + 4,\n\t\tpalette: palettes[webix.skin.$name],\n\t};\n}\n","import { JetView } from \"webix-jet\";\nimport getPalette from \"helpers/palette\";\n\nexport default class SidePopupView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst save = {\n\t\t\tview: \"button\",\n\t\t\tvalue: _(\"Save\"),\n\t\t\talign: \"right\",\n\t\t\tinputWidth: 100,\n\t\t\tcss: \"webix_primary\",\n\t\t\tclick: () => this.Save(),\n\t\t};\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst compactBar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"icon\", icon: \"wxi-close\", click: () => this.getRoot().hide() },\n\t\t\t\t{},\n\t\t\t\tsave,\n\t\t\t],\n\t\t};\n\n\t\tconst controls = [\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"removeBtn\",\n\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\tcss: \"webix_danger webix_scheduler_danger\",\n\t\t\t\thidden: true,\n\t\t\t\talign: compact ? \"center\" : \"left\",\n\t\t\t\tinputWidth: compact ? 330 : 100,\n\t\t\t\tclick: () => this.Delete(),\n\t\t\t},\n\t\t];\n\n\t\tif (!compact) controls.push(save);\n\n\t\tconst ui = this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\twidth: 400,\n\t\t\tclose: true,\n\t\t\tborderless: compact,\n\t\t\tfullscreen: compact,\n\t\t\tcss: \"webix_scheduler_cal_popup\",\n\t\t\thead: compact ? compactBar : _(\"Edit calendar\"),\n\t\t\tbody: {\n\t\t\t\tview: \"form\",\n\t\t\t\tlocalId: \"calendars:form\",\n\t\t\t\telements: [\n\t\t\t\t\t{ view: \"text\", label: _(\"Title\"), name: \"text\" },\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\t\t\tname: \"color\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\t\tbody: getPalette(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{ view: \"checkbox\", label: _(\"Active\"), name: \"active\" },\n\t\t\t\t\t{ cols: controls },\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => {\n\t\t\t\t\tthis.Form.clear();\n\t\t\t\t\tthis.$$(\"removeBtn\").hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (compact) ui.body.elements.splice(3, 0, {});\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.Cals = this.app.getService(\"local\").calendars(true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Form = this.$$(\"calendars:form\");\n\t}\n\n\tShow(id) {\n\t\tif (id) {\n\t\t\tconst obj = this.Cals.getItem(id);\n\t\t\tthis.Form.setValues(obj);\n\t\t\tthis.$$(\"removeBtn\").show();\n\t\t} else {\n\t\t\tthis.Form.setValues({\n\t\t\t\tcolor: \"#997CEB\",\n\t\t\t\tactive: 1,\n\t\t\t});\n\t\t}\n\t\tthis.getRoot().show();\n\t\tthis.Form.focus();\n\t}\n\n\tSave() {\n\t\tconst obj = this.Form.getValues();\n\t\tif (obj.id) this.Ops.updateCalendar(obj.id, obj);\n\t\telse this.Ops.addCalendar(obj);\n\t\tthis.getRoot().hide();\n\t}\n\n\tDelete() {\n\t\tconst obj = this.Form.getValues();\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\ttext: _(\"Do you really want to remove this calendar?\"),\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.Ops.removeCalendar(obj.id);\n\t\t\t\tthis.getRoot().hide();\n\t\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport EditorView from \"./editor\";\nimport getPalette from \"helpers/palette\";\nimport { waitVisible } from \"@xbs/jet-helpers\";\n\nexport default class SidePopupView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst ui = {\n\t\t\tview: \"popup\",\n\t\t\trelative: \"right\",\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\twebix.extend(getPalette(), {\n\t\t\t\t\t\tlocalId: \"colors\",\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: val => this.UpdateColor(val),\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\t{\n\t\t\t\t\t\tcss: \"webix_scheduler_settings\",\n\t\t\t\t\t\ttemplate: _(\"Settings\"),\n\t\t\t\t\t\theight: webix.skin.$active.inputHeight,\n\t\t\t\t\t\tonClick: {\n\t\t\t\t\t\t\twebix_template: () => this.ShowEditor(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => this.app.callEvent(\"side:popup:hide\", []),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\twaitVisible(this.getRoot()).then(() => {\n\t\t\tthis.Editor = this.ui(EditorView);\n\t\t});\n\t}\n\n\tShow(id, node, color) {\n\t\tthis.Cid = id;\n\t\tthis.getRoot().show(node);\n\t\tthis.$$(\"colors\").setValue(color);\n\t}\n\n\tShowEditor() {\n\t\tthis.Editor.Show(this.Cid);\n\t\tthis.getRoot().hide();\n\t}\n\n\tUpdateColor(val) {\n\t\tthis.app.getService(\"operations\").updateCalendar(this.Cid, {\n\t\t\tcolor: val,\n\t\t});\n\t\tthis.getRoot().hide();\n\t}\n\n\tHide() {\n\t\tthis.getRoot().hide();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport PopupView from \"./popup\";\nimport EditorView from \"./editor\";\n\nexport default class SideView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst state = this.app.getState();\n\n\t\tconst calendar = {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\theight: 276,\n\t\t\tmonthSelect: false,\n\t\t\ton: {\n\t\t\t\tonAfterDateSelect: date => {\n\t\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"calendars\",\n\t\t\ttype: this.ListType(_, state),\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\tyCount: 5,\n\t\t\teditable: true,\n\t\t\teditValue: \"text\",\n\t\t\teditaction: \"custom\",\n\t\t\teditor: \"text\",\n\t\t\tcss: \"webix_scheduler_cal_list\",\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_cal_edit: (e, id) => this.ShowPopup(e, id),\n\t\t\t\twebix_scheduler_cal_title: (e, id) => this.ToggleCalendar(id),\n\t\t\t\twebix_scheduler_active: (e, id) => this.ToggleCalendar(id),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeEditStop: (v, editor) => this.SetTitle(editor.id, v.value),\n\t\t\t},\n\t\t};\n\n\t\tconst rows = [\n\t\t\t{ maxHeight: 100 },\n\t\t\tlist,\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"add\",\n\t\t\t\tvalue: _(\"Add calendar\"),\n\t\t\t\thidden: !state.readonly,\n\t\t\t\tinputWidth: 190,\n\t\t\t\talign: \"center\",\n\t\t\t\tclick: () => this.AddCalendar(),\n\t\t\t},\n\t\t\t{},\n\t\t];\n\n\t\tlet side = {\n\t\t\ttype: \"form\",\n\t\t\tpadding: { top: 8 },\n\t\t\trows: rows,\n\t\t};\n\n\t\tif (!this.Compact) {\n\t\t\tlist.on.onAfterScroll = () => this.Popup.Hide();\n\t\t\tside = {\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tbody: {\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [calendar, side],\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn side;\n\t}\n\n\tinit() {\n\t\tthis.Cals = this.$$(\"calendars\");\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Ops = this.app.getService(\"operations\");\n\n\t\tthis.Popup = this.Compact ? this.ui(EditorView) : this.ui(PopupView);\n\t\twebix.extend(this.Cals, webix.EditAbility);\n\n\t\tthis.Data.calendars().then(data => this.Cals.parse(data));\n\n\t\tconst state = this.app.getState();\n\n\t\tif (!this.Compact) {\n\t\t\tthis.on(state.$changes, \"date\", value => {\n\t\t\t\tthis.$$(\"calendar\").setValue(value);\n\t\t\t});\n\t\t\tthis.on(this.app, \"side:popup:hide\", () => {\n\t\t\t\tthis.Cals.unselectAll();\n\t\t\t});\n\t\t}\n\n\t\tthis.on(state.$changes, \"readonly\", value => this.ToggleState(value));\n\t}\n\n\tListType(_, state) {\n\t\treturn {\n\t\t\tcheckbox: function(obj) {\n\t\t\t\tconst icon =\n\t\t\t\t\tobj.active * 1 ? \"wxi-checkbox-marked\" : \"wxi-checkbox-blank\";\n\t\t\t\treturn `<span style=\"color:${obj.color};\" \n\t\t\t\t\trole=\"checkbox\" tabindex=\"-1\" \n\t\t\t\t\taria-checked=\"${obj.active ? \"true\" : \"false\"}\" \n\t\t\t\t\tclass=\"webix_icon webix_scheduler_active ${icon}\">\n\t\t\t\t</span>`;\n\t\t\t},\n\t\t\ttemplate: (obj, common) => {\n\t\t\t\tconst edit = `\n\t\t\t\t\t<span\n\t\t\t\t\t\twebix_tooltip=\"${_(\"Edit calendar\")}\" \n\t\t\t\t\t\tclass=\"webix_icon wxi-dots webix_scheduler_cal_edit \n\t\t\t\t\t\t\t${webix.env.touch ? \" webix_scheduler_cal_visible\" : \"\"}\n\t\t\t\t\t\t\">\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\n\t\t\t\treturn `\n\t\t\t\t\t${common.checkbox(obj)}\n\t\t\t\t\t<span class=\"webix_scheduler_cal_title\">${obj.text || _(\"(no title)\")}</span>\n\t\t\t\t\t${state.readonly ? \"\" : edit}\n\t\t\t\t`;\n\t\t\t},\n\t\t};\n\t}\n\n\tAddCalendar() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Ops.addCalendar().then(id => {\n\t\t\tthis.Cals.edit(id);\n\t\t\tthis.Cals.getEditor()\n\t\t\t\t.getInputNode()\n\t\t\t\t.setAttribute(\"placeholder\", _(\"(no title)\"));\n\t\t});\n\t}\n\n\tShowPopup(e, id) {\n\t\tif (!this.Compact) {\n\t\t\tthis.Cals.select(id);\n\n\t\t\tconst color = this.Cals.getItem(id).color;\n\t\t\tthis.Popup.Show(id, this.Cals.getItemNode(id), color);\n\t\t} else this.Popup.Show(id);\n\t}\n\n\tToggleCalendar(id) {\n\t\tconst obj = this.Cals.getItem(id);\n\t\tthis.Ops.updateCalendar(id, { active: obj.active ^ 1 });\n\t}\n\n\tToggleState(value) {\n\t\tconst add = this.$$(\"add\");\n\t\tif (value) add.hide();\n\t\telse add.show();\n\n\t\tthis.Cals.refresh();\n\t}\n\n\tSetTitle(id, text) {\n\t\tthis.Ops.updateCalendar(id, { text }).then(\n\t\t\t() => this.EditStopSilent(),\n\t\t\t() => this.EditStopSilent(true)\n\t\t);\n\t\treturn false;\n\t}\n\n\tEditStopSilent(fail) {\n\t\tthis.Cals.blockEvent();\n\t\tif (fail) this.Cals.editCancel();\n\t\telse this.Cals.editStop();\n\t\tthis.Cals.unblockEvent();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport side from \"views/side\";\n\nexport default class NavPopupView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst units = !!this.app.config.units;\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tcss: \"webix_scheduler_navlist\",\n\t\t\tlocalId: \"modes\",\n\t\t\tautoheight: true,\n\t\t\tdata: [\n\t\t\t\t{ id: \"day\", value: _(\"Day\"), icon: \"shi-day\" },\n\t\t\t\t{ id: \"week\", value: _(\"Week\"), icon: \"shi-week\" },\n\t\t\t\t{ id: \"month\", value: _(\"Month\"), icon: \"shi-month\" },\n\t\t\t\t{ id: \"agenda\", value: _(\"Agenda\"), icon: \"shi-agenda\" },\n\t\t\t\t{ id: \"year\", value: _(\"Year\"), icon: \"shi-year\" },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.SetMode(id),\n\t\t\t},\n\t\t};\n\n\t\tif (units) {\n\t\t\tlist.data.push({ id: \"units\", value: _(\"Units\"), icon: \"shi-units\" });\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tlist.data.push({\n\t\t\t\tid: \"timeline\",\n\t\t\t\tvalue: _(\"Timeline\"),\n\t\t\t\ticon: \"shi-timeline\",\n\t\t\t});\n\t\t}\n\n\t\tconst ui = {\n\t\t\tview: \"sidemenu\",\n\t\t\tanimate: false,\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_scheduler_sidemenu\",\n\t\t\twidth: 300,\n\t\t\tstate: state => {\n\t\t\t\tconst tHeight = webix.skin.$active.tabbarHeight + 10;\n\t\t\t\tstate.left = this.Parent.left;\n\t\t\t\tstate.top = this.Parent.top + tHeight + 2;\n\t\t\t\tstate.height = this.Parent.height - tHeight - 2;\n\t\t\t},\n\t\t\tbody: list,\n\t\t};\n\n\t\tif (this.app.config.calendars)\n\t\t\tui.body = {\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tbody: {\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [list, side],\n\t\t\t\t},\n\t\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\n\t\tthis.on(this.app, \"view:resize\", () => {\n\t\t\tif (this.getRoot().isVisible()) this.Show(true);\n\t\t});\n\t}\n\tShow(updatePos) {\n\t\tif (!updatePos && this.getRoot().isVisible()) return;\n\n\t\tthis.Parent = this.app.getRoot().$view.getBoundingClientRect();\n\t\tthis.$$(\"modes\").select(this.State.mode);\n\t\tthis.getRoot().show();\n\t}\n\tSetMode(value) {\n\t\tthis.getRoot().hide();\n\n\t\t//wait until hide animation is complete\n\t\tsetTimeout(() => this.State.$batch({ mode: value, selected: null }), 500);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport NavBarView from \"views/bars/nav\";\nimport DateView from \"views/bars/date\";\nimport AddView from \"views/bars/add\";\nimport NavPopupView from \"views/bars/navpopup\";\n\nexport default class TopBarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst todayIcon = {\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-calendar\",\n\t\t\tbatch: \"compact\",\n\t\t\ttooltip: _(\"Today\"),\n\t\t\tclick: () => this.SetToday(),\n\t\t};\n\t\tconst todayBtn = {\n\t\t\tview: \"align\",\n\t\t\talign: \"middle\",\n\t\t\tbatch: \"full\",\n\t\t\tbody: {\n\t\t\t\twidth: 80,\n\t\t\t\tview: \"button\",\n\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\tvalue: _(\"Today\"),\n\t\t\t\tclick: () => this.SetToday(),\n\t\t\t},\n\t\t};\n\n\t\tconst ui = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_scheduler_toolbar webix_dark\",\n\t\t\tresponsive: true,\n\t\t\tpaddingY: 0,\n\t\t\tpaddingX: 4,\n\t\t\theight: webix.skin.$active.tabbarHeight + 10,\n\t\t\tvisibleBatch: this.Compact ? \"compact\" : \"full\",\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"shi-menu\",\n\t\t\t\t\tclick: () => this.ShowNav(),\n\t\t\t\t\thidden: !this.Compact && !this.app.config.calendars,\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tbody: AddView,\n\t\t\t\t\tbatch: \"full\",\n\t\t\t\t\t//[ToDO] makes sence to hide it on medium screens to allows smaller compactWidth\n\t\t\t\t\t//in this case click-to-add behaviour for modes must be implemenetd\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tbody: DateView,\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\ttodayBtn,\n\t\t\t\t{ width: 12 },\n\t\t\t\tNavBarView,\n\t\t\t\ttodayIcon,\n\t\t\t],\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\n\t\tif (this.Compact) this.NavPopup = this.ui(NavPopupView);\n\n\t\tthis.on(this.State.$changes, \"readonly\", value => {\n\t\t\tthis.ToggleAdd(value);\n\t\t});\n\t}\n\tSetToday() {\n\t\tthis.State.date = webix.Date.dayStart(new Date());\n\t}\n\tShowNav() {\n\t\tif (this.Compact) this.NavPopup.Show();\n\t\telse this.app.callEvent(\"show:panel\");\n\t}\n\tToggleAdd(value) {\n\t\tconst add = this.$$(\"add\");\n\t\tif (value) add.hide();\n\t\telse if (!this.Compact) add.show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class EventActionMenu extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\twidth: 220,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{ id: \"this\", value: _(\"This event\") },\n\t\t\t\t\t{ id: \"next\", value: _(\"This event and the following\") },\n\t\t\t\t\t{ id: \"all\", value: _(\"All events\") },\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: id => {\n\t\t\t\t\t\tif (this.Result) this.Result.resolve(id);\n\t\t\t\t\t\tthis.Result = null;\n\t\t\t\t\t\tthis.Root.hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => {\n\t\t\t\t\tif (this.Result) this.Result.reject();\n\t\t\t\t\tthis.Result = null;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.Root = view;\n\t}\n\n\tShow(node) {\n\t\tthis.Result = webix.promise.defer();\n\t\tthis.Root.show(node);\n\t\treturn this.Result;\n\t}\n}\n","export function shrinkTo(start, end) {\n\treturn ev => {\n\t\tconst before = ev.start_date <= start;\n\t\tconst after = ev.end_date >= end;\n\n\t\tif (before || after) {\n\t\t\tconst t = webix.copy(ev);\n\t\t\tif (before) t.start_date = start;\n\t\t\tif (after) t.end_date = end;\n\t\t\treturn t;\n\t\t}\n\n\t\treturn ev;\n\t};\n}\n\nexport function isToday(date) {\n\treturn webix.Date.equal(\n\t\twebix.Date.datePart(date),\n\t\twebix.Date.datePart(new Date())\n\t);\n}\n\nexport function isMultiDay(ev) {\n\treturn (\n\t\tev.all_day ||\n\t\t(ev.start_date.getDate() != ev.end_date.getDate() &&\n\t\t\tev.end_date - ev.start_date >= 1000 * 60 * 60 * 24 * 1)\n\t);\n}\n\n/**\n * Returns the difference between dates\n * @param {Date} start - date 1\n * @param {Date} end - date 2\n * @returns {number} difference between dates in days\n */\nexport function daysBetweenInclusive(start, end) {\n\tconst millisecondsPerDay = 24 * 60 * 60 * 1000;\n\treturn Math.round(\n\t\t(webix.Date.dayStart(end) - webix.Date.dayStart(start)) / millisecondsPerDay\n\t);\n}\n\n/**\n * Checks if the dates are the same\n * @param {Date} adate\n * @param {Date} bdate\n * @returns {Boolean}\n */\nexport function isSameDate(adate, bdate) {\n\treturn webix.Date.equal(\n\t\twebix.Date.dayStart(adate),\n\t\twebix.Date.dayStart(bdate)\n\t);\n}\n\nexport function getYearDay(date) {\n\tconst start = webix.Date.yearStart(date);\n\treturn (date - start) / 1000 / 60 / 60 / 24 + 1;\n}\n","const icalFormat = webix.Date.dateToStr(\"%Y%m%dT000000Z\");\n\nexport function parse(string) {\n\t//FREQ=DAILY;INTERVAL=2\n\tconst parts = string.split(\";\");\n\tconst config = {};\n\tfor (let i = 0; i < parts.length; i++) {\n\t\tconst [code, name] = parts[i].split(\"=\");\n\t\tconfig[code] = name;\n\t}\n\n\tif (config.UNTIL) config.UNTIL = strToDate(config.UNTIL);\n\tif (config.EXDATE) {\n\t\tconfig.EXDATE = config.EXDATE.split(\",\").map(d => strToDate(d));\n\t}\n\n\treturn config;\n}\n\nfunction strToDate(str) {\n\treturn new Date(\n\t\tstr.substr(0, 4) * 1,\n\t\tstr.substr(4, 2) * 1 - 1,\n\t\tstr.substr(6, 2) * 1\n\t);\n}\n\nexport function serialize(config) {\n\tconst str = [];\n\tfor (let key in config) {\n\t\tlet value = config[key];\n\t\tif (key === \"UNTIL\") value = icalFormat(value);\n\n\t\tif (key === \"EXDATE\") {\n\t\t\tvalue = value.map(d => icalFormat(d));\n\t\t\tvalue = value.join(\",\");\n\t\t}\n\t\tif (value) str.push(`${key}=${value}`);\n\t}\n\n\treturn str.join(\";\");\n}\n","import { serialize, parse } from \"helpers/ical\";\nexport const WEEKDAYS = [\"SU\", \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\"];\n\nexport const FREQUENCE = {\n\tDAILY: \"day\",\n\tWEEKLY: \"week\",\n\tMONTHLY: \"month\",\n\tYEARLY: \"year\",\n};\n\n/**\n * Splits each recurring event into a series of events and returns the resulting array\n * @param {Date} sdate - the start date\n * @param {Date} edate - the end date\n * @param {Object} ev - the event data object\n * @returns {Array} with recurring events split into occurrences\n */\nexport function explodeEvent(sdate, edate, ev) {\n\tconst mode = ev.$recurring;\n\n\tconst consts = {};\n\tconst res = [];\n\n\t// when we use week-days in recurring mode, convert structure\n\t// list of days => list of steps to the next allowed day\n\tfillWdays(mode, consts);\n\n\tconst xdate = new Date(ev.start_date);\n\tconst length = ev.end_date - ev.start_date;\n\n\t// occurrences before active window\n\tlet count = 1;\n\twhile (\n\t\t(sdate - xdate >= (length || 1) &&\n\t\t\t(!mode.UNTIL || xdate < mode.UNTIL) &&\n\t\t\t(!mode.COUNT || count <= mode.COUNT)) ||\n\t\tfindDate(mode.EXDATE, xdate)\n\t) {\n\t\t++count;\n\t\tnext(xdate, mode, consts);\n\t}\n\n\t// occurrences inside of window\n\twhile (\n\t\tedate > xdate &&\n\t\t(!mode.UNTIL || xdate < mode.UNTIL) &&\n\t\t(!mode.COUNT || count <= mode.COUNT)\n\t) {\n\t\t// make copy of recurring event\n\t\tif (!findDate(mode.EXDATE, xdate)) {\n\t\t\tconst copy = webix.copy(ev);\n\n\t\t\txdate.setHours(ev.start_date.getHours());\n\t\t\tcopy.start_date = new Date(xdate);\n\t\t\tcopy.end_date = new Date(xdate * 1 + length);\n\n\t\t\tcopy.$id = ev.id;\n\t\t\tcopy.id = copy.start_date.valueOf() + \"_\" + ev.id;\n\t\t\tres.push(copy);\n\t\t}\n\t\tcount++;\n\n\t\tnext(xdate, mode, consts);\n\t}\n\treturn res;\n}\n\n// IE support\n/**\n * Finds a date in an array of dates\n * @param {Array} arr - all dates\n * @param {Date} date - the date to be checked\n * @returns {Boolean}\n */\nfunction findDate(arr, date) {\n\tif (!arr) return false;\n\n\tfor (let i = 0; i < arr.length; ++i) {\n\t\tif (webix.Date.equal(webix.Date.dayStart(date), arr[i])) return true;\n\t}\n\treturn false;\n}\n\n/**\n * Defines the object that stores the recurring pattern, for more details please refer to the iCalendar docs https://icalendar.org/iCalendar-RFC-5545/3-8-5-3-recurrence-rule.html\n * @typedef {Object} Recurring\n * @property {string} FREQ - the step of repetition: DAILY, WEEKLY, MONTHLY, YEARLY\n * @property {(number|string)} INTERVAL - how many steps are between occurrences\n * @property {string} BYDAY - week days, e.g. SU,MO,TU,WE,TH,FR,SA\n * @property {(number|string)} BYMONTH - the number or a month (1-12)\n * @property {(number|string)} BYMONTHDAY - the date (day of a month)\n * @property {(number|string)} BYSETPOS - the number of the week day within a month\n * @property {string} UNTIL - a date like 19970902T090000\n * @property {(number|string)} COUNT - how many times the event repeats\n * @property {string} EXDATE - string with 1 or more dates, on which the event does not repeat, e.g. 19960402T010000Z,19960403T010000Z,19960404T010000Z\n */\n\n/**\n * Fills the list of steps to the next allowed day for recurring events that repeat by certain week days\n * @param {Recurring} mode - the object with the recurring pattern\n * @param {Object} consts - (for events that have BYDAY in their pattern) stores wdays (Array) - the list of steps to the next allowed day\n */\nexport function fillWdays(mode, consts) {\n\tif (mode.BYDAY) {\n\t\tconst diff = (consts.wdays = [0, 0, 0, 0, 0, 0, 0]);\n\t\tconst line = mode.BYDAY.split(\",\")\n\t\t\t.map(a => WEEKDAYS.indexOf(a))\n\t\t\t.sort();\n\n\t\t// for each allowed day, fill range with steps\n\t\tfor (let i = 0; i < line.length; i++) {\n\t\t\tconst s = line[i];\n\t\t\tconst e = line[i + 1] || line[0] + 7;\n\n\t\t\tfor (let j = s; j < e; j++) {\n\t\t\t\tdiff[j % 7] = e - j;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Calculates the date of the next occurrence of a repeating event\n * @param {Date} date - the current date\n * @param {Recurring} mode - the object with the recurring pattern\n * @param {Object} consts - (for events that have BYDAY in their pattern) stores wdays (Array) - the list of steps to the next allowed day\n */\nexport function next(date, mode, consts) {\n\tlet interval = (mode.INTERVAL || 1) * 1;\n\n\tlet now, step;\n\tswitch (mode.FREQ) {\n\t\tcase \"DAILY\":\n\t\t\tdate.setDate(date.getDate() + interval);\n\t\t\tbreak;\n\t\tcase \"WEEKLY\":\n\t\t\tnow = date.getDay();\n\t\t\tstep = consts.wdays ? consts.wdays[now] : 7;\n\t\t\tif (step + now > 6 && interval > 1) {\n\t\t\t\t// when new day is on the different week\n\t\t\t\t// add week interval as well\n\t\t\t\tstep += 7 * (interval - 1);\n\t\t\t}\n\t\t\tdate.setDate(date.getDate() + step);\n\t\t\tbreak;\n\t\tcase \"YEARLY\": {\n\t\t\tif (mode.BYYEARDAY) {\n\t\t\t\tdate.setFullYear(date.getFullYear() + interval);\n\t\t\t\tdate.setMonth(0);\n\t\t\t\tdate.setDate(1);\n\t\t\t\tdate.setDate(mode.BYYEARDAY);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tinterval *= 12;\n\t\t\t// falls through\n\t\t}\n\t\t/*eslint no-fallthrough: \"error\"*/\n\t\tcase \"MONTHLY\":\n\t\t\tnow = date.getMonth();\n\t\t\tdate.setDate(1);\n\t\t\tdate.setMonth(now + interval);\n\t\t\tif (mode.BYMONTHDAY) {\n\t\t\t\tdate.setDate(mode.BYMONTHDAY);\n\t\t\t\t// when date is outside of month bounds, switch to last day of month\n\t\t\t\tif ((now + interval) % 12 != date.getMonth()) date.setDate(0);\n\t\t\t} else if (mode.BYSETPOS) {\n\t\t\t\t// go to last day of month before one in question\n\t\t\t\tdate.setDate(0);\n\t\t\t\t// find the matching day\n\t\t\t\tfor (let i = 0; i < mode.BYSETPOS; i++) {\n\t\t\t\t\tstep = consts.wdays[date.getDay()];\n\t\t\t\t\tdate.setDate(date.getDate() + step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn date;\n}\n\n/**\n * Defines the result of the check if a date fits a BYDAY pattern\n * @typedef {Object} weekdayCheckResult\n * @property {Boolean} result true if the date fits the BYDAY pattern, false otherwise\n * @property {Date} start - the copy of the start date\n * @property {Array} days - BYDAY pattern as an array of strings\n * @property {string} oldDay - the week day of the start date\n */\n/**\n * Checks if the start day fits the recurring BYDAY pattern\n * @param {Date} sdate - the start date of an event\n * @param {Recurring} mode - the object with the recurring pattern\n * @returns {weekdayCheckResult} the result of the check\n */\nfunction checkDay(sdate, mode) {\n\tconst start = new Date(sdate);\n\tconst days = mode.BYDAY.split(\",\");\n\tconst oldDay = WEEKDAYS[start.getDay()];\n\tconst result = days.indexOf(oldDay) !== -1;\n\n\treturn { result, start, days, oldDay };\n}\n\n/**\n * Synchronizes the start and end dates to the BYDAY recurring pattern\n * @param {Date} sdate\n * @param {Date} edate\n * @param {Recurring} mode - the object with the recurring pattern\n * @return {Array} - the start and end dates of an event\n */\nexport function datesToWeekdays(sdate, edate, mode) {\n\tconst { result, start, days } = checkDay(sdate, mode);\n\tif (result) {\n\t\treturn [sdate, edate];\n\t}\n\n\tconst diff = WEEKDAYS.indexOf(days[0]) - start.getDay();\n\tstart.setDate(start.getDate() + diff);\n\n\tconst end = new Date(edate);\n\tend.setDate(end.getDate() + diff);\n\n\treturn [start, end];\n}\n\n/**\n * Synchronizes BYDAY recurring pattern with the date of an event\n * @param {Date} sdate - the start date of an event\n * @param {Recurring} mode - the object with the recurring pattern\n * @returns {string} with the new BYDAY pattern\n */\nexport function WeekdaysToDates(sdate, mode) {\n\tlet { result, days, oldDay } = checkDay(sdate, mode);\n\tif (result) {\n\t\treturn mode.BYDAY;\n\t}\n\n\tif (mode.FREQ === \"WEEKLY\") {\n\t\tdays.splice(WEEKDAYS.indexOf(days[0]), 0, oldDay);\n\t} else {\n\t\tdays = [oldDay];\n\t}\n\treturn days.join(\",\");\n}\n\n/**\n * Returns selection parameters for the global state\n * @param {Object} obj - the event data object\n * @returns {Object} with selection parameters\n */\nexport function getParams(obj) {\n\treturn { id: obj.$id || obj.id, date: obj.$recurring ? obj.id : null };\n}\n\n/**\n * Defines the selection.date parameter of the global state\n * @typedef {(Date|string)} SDate - a Date object or the ID of an event occurrence that consists of a timestamp and the event ID from DB, separated with _\n */\n\n/**\n * Gets a date from the selection.date parameter of the global state\n * @param {(SDate)} sdate\n * @returns {Date}\n */\nexport function extractDate(sdate) {\n\treturn webix.Date.dayStart(\n\t\tsdate.getDate ? sdate : new Date(sdate.split(\"_\")[0] * 1)\n\t);\n}\n\n/**\n * Updates the end of a recurring event sequence\n * @param {SDate} sdate\n * @param {Object} ev - the event data object\n * @param {Boolean} block\n * @returns {string} - serialized recurrence pattern\n */\nexport function clipSequence(sdate, ev, block) {\n\tconst date = extractDate(sdate);\n\n\tif (!block || (!ev.$recurring.UNTIL || ev.$recurring.UNTIL > date))\n\t\tev.$recurring.UNTIL = date;\n\n\tif (ev.$recurring.COUNT) delete ev.$recurring.COUNT;\n\n\tif (ev.$recurring.EXDATE) {\n\t\tev.$recurring.EXDATE = ev.$recurring.EXDATE.filter(d => d < date);\n\t}\n\n\treturn serialize(ev.$recurring);\n}\n\n/**\n * Removes the specified date from the recurrence pattern\n * @param {SDate} sdate\n * @param {Object} ev - the event data object\n * @returns {string} - serialized recurrence pattern\n */\nexport function cutOccurrence(sdate, ev) {\n\tconst date = extractDate(sdate);\n\n\tif (!ev.$recurring.EXDATE) ev.$recurring.EXDATE = [];\n\tev.$recurring.EXDATE.push(date);\n\n\treturn serialize(ev.$recurring);\n}\n\n/**\n * Gets the start and end dates for a particular occurrence from a series\n * @param {Object} obj - the event data object\n * @param {SDate} sdate\n * @returns {Object} with start_date and end_date\n */\nexport function separateSequence(obj, sdate) {\n\tconst start_date =\n\t\ttypeof sdate === \"string\"\n\t\t\t? new Date(sdate.split(\"_\")[0] * 1)\n\t\t\t: new Date(sdate);\n\tconst len = (obj.end_date - obj.start_date) / 1000 / 60; // mins\n\tconst end_date = webix.Date.add(start_date, len, \"minute\", true);\n\treturn { start_date, end_date };\n}\n\n/**\n * Checks if this is the first occurrence of a series\n * @param {SDate} sdate\n * @param {Date} evStart\n * @returns {Boolean}\n */\nexport function isFirstOccurrence(sdate, evStart) {\n\t// editing 'this' event as next\n\tif (!sdate) return false;\n\n\tconst od = sdate.getDate ? sdate : new Date(sdate.split(\"_\")[0] * 1);\n\treturn od <= evStart;\n}\n\n/**\n * Corrects the edit mode for specific cases (depending on which occurrence was selected)\n * @param {Object} obj - the event data object\n * @param {string} mode - \"all\", \"next\", \"this\"\n * @returns {string}\n */\nexport function correctMode(obj, mode) {\n\tif (!obj.origin_id || !obj.recurring) {\n\t\tmode = \"all\";\n\t} else {\n\t\t// if this is 1st occ in 'next' which is the last part of 'all'\n\t\tif (this.app.getService(\"local\").isLastPart(obj)) {\n\t\t\tmode = \"\";\n\t\t}\n\t}\n\treturn mode;\n}\n\nconst dayLength = 86400000;\n/**\n * Moves a recurrence pattern if a recurring event was moved to another date\n * @param {Recurring} rec\n * @param {Object} newEvent - the new event data object\n * @param {Object} oldEvent - the old event data object\n * @returns {Recurring}\n */\nexport function movePattern(rec, newEvent, oldEvent) {\n\tlet days =\n\t\t(webix.Date.dayStart(newEvent.start_date) -\n\t\t\twebix.Date.dayStart(oldEvent.start_date)) /\n\t\tdayLength;\n\n\tif (days) {\n\t\tif (rec.UNTIL) {\n\t\t\tconst until = webix.Date.add(rec.UNTIL, days, \"day\", true);\n\n\t\t\tif (until > newEvent.end_date) rec.UNTIL = until;\n\t\t\telse\n\t\t\t\trec.UNTIL = webix.Date.dayStart(\n\t\t\t\t\twebix.Date.add(newEvent.end_date, 1, \"day\", true)\n\t\t\t\t);\n\t\t}\n\n\t\t// day of start_date changed and pattern doesn't have in anymore\n\t\tif (rec.BYDAY) {\n\t\t\tdays %= 7;\n\t\t\tif (days < 0) days += 7;\n\t\t\trec.BYDAY = rec.BYDAY.split(\",\")\n\t\t\t\t.map(d => WEEKDAYS[(WEEKDAYS.indexOf(d) + days) % 7])\n\t\t\t\t.join(\",\");\n\t\t}\n\n\t\t// in case day of start_date changed in monthly or yearly\n\t\tif (rec.BYMONTHDAY) {\n\t\t\tconst nmd = newEvent.start_date.getDate();\n\t\t\tif (nmd != rec.BYMONTHDAY) {\n\t\t\t\trec.BYMONTHDAY = nmd;\n\t\t\t}\n\t\t}\n\t}\n\n\t// week number of start_date changed in yearly or monthly\n\tif (rec.BYSETPOS) {\n\t\tconst nwn = getWeekNum(newEvent.start_date);\n\t\tif (rec.BYSETPOS != nwn) rec.BYSETPOS = nwn;\n\t}\n\n\t// month of start_date changed in a yearly event\n\tif (rec.BYMONTH) {\n\t\tconst nm = newEvent.start_date.getMonth() + 1;\n\t\tif (nm != rec.BYMONTH) rec.BYMONTH = nm;\n\t}\n\n\treturn rec;\n}\n\n/**\n * Returns the number of a week day within a month (e.g. 3rd Wednesday)\n * @param {Date} date\n * @returns {number}\n */\nexport function getWeekNum(date) {\n\tconst day = date.getDate();\n\treturn Math.floor(day / 7) + (day % 7 ? 1 : 0);\n}\n\n/**\n * Fills incomplete recurring patterns and ensures that they are consistent with the dates of events\n * @param {Object} ev - data object of an event\n */\nexport function checkPattern(ev) {\n\tconst mode = ev.$recurring || parse(ev.recurring);\n\n\t// when exact date not configured, fill recurring config\n\tif (mode.FREQ === \"WEEKLY\" && !mode.BYDAY) {\n\t\tmode.BYDAY = WEEKDAYS[ev.start_date.getDay()];\n\t\treturn;\n\t}\n\n\tif (\n\t\t(mode.FREQ === \"MONTHLY\" || mode.FREQ === \"YEARLY\") &&\n\t\t!mode.BYSETPOS &&\n\t\t!mode.BYMONTHDAY &&\n\t\t!mode.BYYEARDAY\n\t) {\n\t\tmode.BYMONTHDAY = ev.start_date.getDate();\n\t\treturn;\n\t}\n\n\tif (mode.FREQ === \"YEARLY\" && !mode.BYMONTH && !mode.BYYEARDAY) {\n\t\tmode.BYMONTH = ev.start_date.getMonth();\n\t\treturn;\n\t}\n\n\t// in case config is wrong, fix it\n\tif (mode.BYDAY) mode.BYDAY = WeekdaysToDates(ev.start_date, mode);\n\tif (mode.BYMONTHDAY) mode.BYMONTHDAY = ev.start_date.getDate();\n\tif (mode.BYMONTH) mode.BYMONTH = ev.start_date.getMonth() + 1;\n\tif (mode.BYSETPOS) mode.BYSETPOS = getWeekNum(ev.start_date);\n\n\tev.recurring = serialize(mode);\n}\n","import { JetView } from \"webix-jet\";\nimport { WEEKDAYS, fillWdays, next } from \"helpers/recurring\";\n\nexport default class RecurringFormView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"recurringForm\",\n\t\t\thidden: true,\n\t\t\telementsConfig: { labelPosition: \"left\" },\n\t\t\tpadding: {\n\t\t\t\ttop: aSkin.layoutPadding.form,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: compact ? aSkin.layoutPadding.form : 0,\n\t\t\t\tright: compact ? 14 : 0,\n\t\t\t},\n\t\t\tborderless: true,\n\t\t\trows: [\n\t\t\t\tthis.CreateIntervalControls(_),\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"customRecControls\",\n\t\t\t\t\thidden: true,\n\t\t\t\t\trows: [this.CreateCheckboxes(_), this.CreateSelect(_)],\n\t\t\t\t},\n\t\t\t\tthis.CreateRadio(_),\n\t\t\t],\n\t\t};\n\n\t\tif (!compact) {\n\t\t\tform.on = {\n\t\t\t\tonChange: (o, v, m) => this.UpdateEvent(m),\n\t\t\t};\n\t\t}\n\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.Form = this.$$(\"recurringForm\");\n\t\tthis.Events = this.app.getService(\"local\").events(true);\n\n\t\t// commonly called controls\n\t\tthis.CheckBoxContainer = this.$$(\"weekly\");\n\t\tthis.Checkboxes = this.CheckBoxContainer.getChildViews().slice(1);\n\t\tthis.Checkboxes.pop();\n\t\tthis.PatternSelect = this.$$(\"patternSelect\");\n\t\tthis.UntilDateContainer = this.$$(\"untilDate\");\n\t\tthis.UntilDateCalendar = this.Form.elements.untilDate.getPopup().getBody();\n\t\tthis.UntilNumContainer = this.$$(\"untilCount\");\n\t\tthis.UntilNum = this.UntilNumContainer.getBody();\n\t\tthis.CustomRecControls = this.$$(\"customRecControls\");\n\t}\n\n\t// methods of main controls: counter of INTERVAL and richselect of FREQ\n\n\t/**\n\t * Returns the config object for interval counter and recurrence frequency selection\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateIntervalControls(_) {\n\t\treturn {\n\t\t\tmargin: 8,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"counter\",\n\t\t\t\t\tlabel: _(\"Every\"),\n\t\t\t\t\tlabelWidth: 50,\n\t\t\t\t\tmin: 1,\n\t\t\t\t\tname: \"INTERVAL\",\n\t\t\t\t\tcss: \"webix_scheduler_counter\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"FREQ\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"DAILY\", value: _(\"day\") },\n\t\t\t\t\t\t{ id: \"WEEKLY\", value: _(\"week\") },\n\t\t\t\t\t\t{ id: \"MONTHLY\", value: _(\"month\") },\n\t\t\t\t\t\t{ id: \"YEARLY\", value: _(\"year\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Switches controls for detailed recurrence pattern selection depending on the frequency\n\t * @param {string} v - recurrence frequency\n\t */\n\tChangeControls(v) {\n\t\tthis._freq = v;\n\t\tif (v === \"DAILY\") {\n\t\t\tthis.CustomRecControls.hide();\n\t\t} else {\n\t\t\tthis.CustomRecControls.show();\n\t\t\tif (v === \"WEEKLY\") {\n\t\t\t\tthis.CheckBoxContainer.show();\n\t\t\t\tthis.PatternSelect.hide();\n\t\t\t} else {\n\t\t\t\tthis.CheckBoxContainer.hide();\n\t\t\t\tif (v === \"MONTHLY\" && this.PatternSelect.getValue() == 3)\n\t\t\t\t\tthis.PatternSelect.setValue(1);\n\t\t\t\tthis.PatternSelect.show();\n\t\t\t\tthis.PatternSelect.getList().refresh();\n\t\t\t\tthis.PatternSelect.refresh();\n\t\t\t}\n\t\t}\n\t}\n\n\t// methods of checkboxes for WEEKLY\n\n\t/**\n\t * Returns the config object for week day checkboxes\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateCheckboxes(_) {\n\t\tconst days = [];\n\t\tfor (let i = 0; i < 7; ++i) {\n\t\t\tdays.push({\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tlabel: webix.i18n.calendar.dayShort[i],\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t\tlabelAlign: \"center\",\n\t\t\t\tcss: \"webix_scheduler_day_checkbox\",\n\t\t\t\tinputWidth: 26,\n\t\t\t\twidth: 45,\n\t\t\t\talign: \"center\",\n\t\t\t\tname: WEEKDAYS[i],\n\t\t\t\ton: {\n\t\t\t\t\tonChange(v, o) {\n\t\t\t\t\t\tthis.$scope.CheckboxGuard(this.config.name, v, o);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tlocalId: \"weekly\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"on\"), width: 45 },\n\t\t\t\t...days,\n\t\t\t\t{ gravity: 0.00001 },\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Prevents the user from unchecking the only checked weekday checkbox\n\t * @param {string} day - the name of the related checkbox (SU, MO, TU, WE, TH, FR, or SA)\n\t * @param {(Boolean|number)} v - the new value of a checkbox (false/0 or true/1)\n\t * @param {(Boolean|number)} o - the old value of a checkbox (false/0 or true/1)\n\t */\n\tCheckboxGuard(day, v, o) {\n\t\tif (!webix.isUndefined(o) && !v && !this.GetBYDAY()) {\n\t\t\tthis.Form.setValues({ [day]: 1 }, true);\n\t\t}\n\t}\n\n\t/**\n\t * Sets values to weekday checkboxes according to BYDAY recurrence pattern (week days)\n\t * @param {Object} values - values from the form\n\t */\n\tSetBYDAY(values) {\n\t\tconst days = values.BYDAY.split(\",\");\n\t\tthis.Checkboxes.forEach(check => {\n\t\t\tvalues[check.config.name] = !!days.find(d => d == check.config.name);\n\t\t});\n\t}\n\n\t/**\n\t * Gets the BYDAY pattern from checkbox values\n\t * @returns {string}\n\t */\n\tGetBYDAY() {\n\t\tconst BYDAY = [];\n\t\tthis.Checkboxes.forEach(check => {\n\t\t\tif (check.getValue()) {\n\t\t\t\tBYDAY.push(check.config.name);\n\t\t\t}\n\t\t});\n\t\treturn BYDAY.join(\",\");\n\t}\n\n\t// methods of richselect with MONTHLY and YEARLY patterns\n\n\t/**\n\t * Returns the config object for a dropdown list with monthly/yearly recurrence patterns\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateSelect(_) {\n\t\treturn {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"patternSelect\",\n\t\t\tname: \"rec_pattern\",\n\t\t\tsuggest: {\n\t\t\t\tdata: [],\n\t\t\t\tbody: {\n\t\t\t\t\ttemplate: obj => {\n\t\t\t\t\t\tif (this._freq === \"YEARLY\" && obj.BYYEARDAY) {\n\t\t\t\t\t\t\treturn `${_(\"Every\")} ${obj.BYYEARDAY} ${_(\"day of year\")}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst byDay = [];\n\t\t\t\t\t\tif (obj.BYDAY) {\n\t\t\t\t\t\t\tobj.BYDAY.forEach(d =>\n\t\t\t\t\t\t\t\tbyDay.push(webix.i18n.calendar.dayFull[d])\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet text = `${_(\"Every\")} ${obj.BYMONTHDAY || obj.BYSETPOS} ${\n\t\t\t\t\t\t\tobj.BYDAY ? byDay.join(\", \") : \"\"\n\t\t\t\t\t\t}`;\n\t\t\t\t\t\tif (this._freq === \"YEARLY\")\n\t\t\t\t\t\t\ttext += ` ${_(\"of\")} ${\n\t\t\t\t\t\t\t\twebix.i18n.calendar.monthFull[obj.BYMONTH - 1]\n\t\t\t\t\t\t\t}`;\n\t\t\t\t\t\treturn text;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tthis.getList().filter(\n\t\t\t\t\t\t\tobj => this.$scope._freq === \"YEARLY\" || obj.id != 3\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Describes calculated constants of a date\n\t * @typedef {Object} DateInfo\n\t * @property {number} day - the date (day of month)\n\t * @property {number} weekday - the number of a weekday (0-6)\n\t * @property {number} month - the number of month (0-11)\n\t * @property {number} weekNum - the number of a weekday within a month (e.g. 4th Friday)\n\t */\n\n\t/**\n\t * Sets pattern options for the dropdown list (monthly and yearly events)\n\t * @param {Object} ev - values from the form\n\t * @param {DateInfo} calculated - calculated constants of a date\n\t */\n\tSetPatternOptions(ev, calculated) {\n\t\tthis.PatternSelect.getList().parse([\n\t\t\t{\n\t\t\t\tid: 1,\n\t\t\t\tBYMONTH: ev.BYMONTH || calculated.month + 1,\n\t\t\t\tBYMONTHDAY: ev.BYMONTHDAY || calculated.day,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 2,\n\t\t\t\tBYSETPOS: ev.BYSETPOS || calculated.weekNum,\n\t\t\t\tBYDAY: [calculated.weekday],\n\t\t\t\tBYMONTH: ev.BYMONTH || calculated.month + 1,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 3,\n\t\t\t\tBYYEARDAY: ev.BYYEARDAY || calculated.yearday,\n\t\t\t},\n\t\t]);\n\t\tthis.PatternSelect.refresh();\n\t\tthis._freq = ev.FREQ;\n\n\t\tev.rec_pattern = ev.BYSETPOS ? 2 : ev.BYYEARDAY ? 3 : 1;\n\t}\n\n\t/**\n\t *\n\t * @param {Object} values - values from the form\n\t */\n\tGetRecPattern(values) {\n\t\tconst data = webix.copy(\n\t\t\tthis.PatternSelect.getList().getItem(values.rec_pattern)\n\t\t);\n\n\t\tif (this._freq === \"MONTHLY\") delete data.BYMONTH;\n\t\tif (data.BYDAY) data.BYDAY = data.BYDAY.map(d => WEEKDAYS[d]).join(\",\");\n\t\tdelete data.id;\n\n\t\treturn data;\n\t}\n\n\t// methods of radio for UNTIL\n\n\t/**\n\t * Returns the config object for the radio with options for setting the end of repetition\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateRadio(_) {\n\t\tconst selectors = {\n\t\t\twidth: 130,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"untilDate\",\n\t\t\t\t\talign: \"middle\",\n\t\t\t\t\tview: \"align\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\tname: \"untilDate\",\n\t\t\t\t\t\ticons: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"untilCount\",\n\t\t\t\t\tview: \"align\",\n\t\t\t\t\talign: \"bottom\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tname: \"untilCount\",\n\t\t\t\t\t\tview: \"counter\",\n\t\t\t\t\t\tcss: \"webix_scheduler_counter\",\n\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"End repeat\") },\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\tname: \"until\",\n\t\t\t\t\t\t\tlocalId: \"until\",\n\t\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{ id: 1, value: _(\"never\") },\n\t\t\t\t\t\t\t\t{ id: 2, value: _(\"date\") },\n\t\t\t\t\t\t\t\t{ id: 3, value: _(\"after several occurrences\") },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: v => this.ChangeSelectors(v),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectors,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Switches controls for dates or numbers for setting the end of repetition\n\t * @param {(number|string)} v - the value of the radio that sets the type of repetition end (1,2,3)\n\t */\n\tChangeSelectors(v) {\n\t\tthis.UntilDateContainer[v === \"2\" ? \"show\" : \"hide\"]();\n\t\tthis.UntilNumContainer[v === \"3\" ? \"show\" : \"hide\"]();\n\t}\n\n\t/**\n\t * Sets the values of controls that are used to choose the end of repetition\n\t * @param {Object} values - values from the form\n\t */\n\tSetUNTIL(values) {\n\t\tconst start = this._StartDate;\n\t\tvalues.until = values.COUNT ? 3 : values.UNTIL ? 2 : 1;\n\t\tvalues.untilDate = values.UNTIL || webix.Date.add(start, 1, \"year\", true);\n\t\tvalues.untilCount = values.COUNT || this.CountNum(values);\n\t\tthis.UntilDateCalendar.define({ minDate: start });\n\t}\n\n\t/**\n\t * Calculates the number of occurrences based on the end date of repetition (UNTIL)\n\t * @param {Object} values - values from the form\n\t */\n\tCountNum(values) {\n\t\tlet res = 0;\n\n\t\tif (values.UNTIL) {\n\t\t\tconst consts = {};\n\t\t\tfillWdays(values, consts);\n\t\t\tlet date = webix.Date.copy(this._StartDate);\n\n\t\t\twhile (date <= values.UNTIL) {\n\t\t\t\tdate = next(date, values, consts);\n\t\t\t\tres++;\n\t\t\t}\n\t\t} else {\n\t\t\tres = 3;\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t// subform methods\n\n\t/**\n\t * Sets values into this form\n\t * @param {Object} event - the event data object\n\t * @param {DateInfo} calculated - calculated constants of a date\n\t * @param {Boolean} silent - if true, the form is marked as 'saved' (containing no unsaved values)\n\t */\n\tSetValues(event, calculated, silent) {\n\t\tif (!calculated) return this.Form.setValues(event, true);\n\n\t\tthis._StartDate = event.start_date;\n\t\tlet values = event.$recurring;\n\n\t\tif (!values) {\n\t\t\tvalues = { FREQ: \"DAILY\" };\n\t\t}\n\n\t\tif (!values.INTERVAL) values.INTERVAL = 1;\n\t\tif (!values.BYDAY) {\n\t\t\tvalues.BYDAY = WEEKDAYS[calculated.weekday];\n\t\t}\n\n\t\t// for a reset\n\t\tif (!values.EXDATE) values.EXDATE = [];\n\n\t\tthis.SetUNTIL(values);\n\t\tthis.SetBYDAY(values);\n\t\tthis.SetPatternOptions(values, calculated);\n\t\tthis.Form.setValues(values, true);\n\t\tif (silent) this.Form.setDirty();\n\t}\n\n\t/**\n\t * Defines the object that stores the recurring pattern, for more details please refer to the iCalendar docs https://icalendar.org/iCalendar-RFC-5545/3-8-5-3-recurrence-rule.html\n\t * @typedef {Object} Recurring\n\t * @property {string} FREQ - the step of repetition: DAILY, WEEKLY, MONTHLY, YEARLY\n\t * @property {(number|string)} INTERVAL - how many steps are between occurrences\n\t * @property {string} BYDAY - week days, e.g. SU,MO,TU,WE,TH,FR,SA\n\t * @property {(number|string)} BYMONTH - the number or a month (1-12)\n\t * @property {(number|string)} BYMONTHDAY - the date (day of a month)\n\t * @property {(number|string)} BYSETPOS - the number of the week day within a month\n\t * @property {string} UNTIL - a date like 19970902T090000\n\t * @property {(number|string)} COUNT - how many times the event repeats\n\t * @property {string} EXDATE - string with 1 or more dates, on which the event does not repeat, e.g. 19960402T010000Z,19960403T010000Z,19960404T010000Z\n\t */\n\n\t/**\n\t * Collects recurrence pattern object from form values and returns it\n\t * @returns {Recurring} the object that stores the recurring pattern\n\t */\n\tGetValues() {\n\t\tlet values = this.Form.getValues();\n\n\t\tlet res = {\n\t\t\tFREQ: values.FREQ,\n\t\t\tINTERVAL: values.INTERVAL,\n\t\t\tUNTIL: values.until == 2 ? values.untilDate : this.GetUntil(values),\n\t\t\tCOUNT: values.until == 3 ? values.untilCount : null,\n\t\t\tEXDATE: values.EXDATE || [],\n\t\t};\n\n\t\tif (values.FREQ === \"WEEKLY\") {\n\t\t\tres.BYDAY = this.GetBYDAY(values);\n\t\t} else if (values.FREQ === \"MONTHLY\" || values.FREQ === \"YEARLY\") {\n\t\t\tres = webix.extend(res, this.GetRecPattern(values));\n\t\t}\n\n\t\tthis.Form.setDirty();\n\n\t\treturn res;\n\t}\n\n\t/**\n\t * Calculates the end of repetition as date based on COUNT\n\t * @param {Object} values - values from the form\n\t * @returns {Date}\n\t */\n\tGetUntil(values) {\n\t\tif (values.until == 3) {\n\t\t\tconst consts = {};\n\t\t\tfillWdays(values, consts);\n\t\t\tlet date = webix.Date.copy(this._StartDate);\n\t\t\tfor (let i = 1; i < values.untilCount; ++i) {\n\t\t\t\tdate = next(date, values, consts);\n\t\t\t}\n\t\t\tdate = webix.Date.add(date, 1, \"day\", true);\n\t\t\tthis.Form.setValues({ untilDate: date }, true);\n\t\t\treturn date;\n\t\t} else return null;\n\t}\n\n\t/**\n\t * Collects all values and sends them to the master form for event update (via global app event)\n\t * @param {string} mode - \"user\" means that the change was made via UI\n\t */\n\tUpdateEvent(mode) {\n\t\tif (mode === \"user\") {\n\t\t\tconst change = this.GetValues();\n\t\t\tthis.app.callEvent(\"form:update:recurring\", [{ $recurring: change }]);\n\t\t\tthis.Form.setDirty();\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this form has changed values\n\t * @returns {Boolean}\n\t */\n\tIsDirty() {\n\t\treturn this.Form.isDirty();\n\t}\n\n\t/**\n\t * Shows this form\n\t */\n\tShow() {\n\t\tthis.getRoot().show();\n\t}\n\n\t/**\n\t * Hides this form\n\t */\n\tHide() {\n\t\tthis.getRoot().hide();\n\t}\n}\n","import {\n\tisFirstOccurrence,\n\tcorrectMode,\n\textractDate,\n\tFREQUENCE,\n\tfillWdays,\n\tnext,\n} from \"./recurring\";\n\n/* public functions */\n\n/**\n * Changes the mode if the user selected the 1st occurrence in whole sequence or in 'next'\n * @param {string} mode - the mode of editing a recurring event (\"all\", \"next\", \"this\")\n * @param {object} obj - the event object\n * @param {Date} start - the start date of the event\n * @param {Date, string} date_id - the ID of an occurrence of a repeated event or the date of this occurrence\n */\nfunction changeMode(mode, obj, start, date_id) {\n\tif (mode && mode === \"next\" && isFirstOccurrence(date_id, start)) {\n\t\tmode = correctMode.call(this, obj, mode);\n\t}\n\n\treturn mode;\n}\n\n/**\n * Corrects recurring.COUNT or recurring.UNTIL based on all sub-events that are included in the edited range\n * @param {Object} obj - the event data\n * @param {string} mode - the mode of recurring editing (\"all\", \"next\")\n * @param {Date} sdate - the date of the currently selected event occurrence\n * @param {Object} collection - DataCollection of events\n */\nfunction correctCountUntil(obj, mode, sdate, collection) {\n\tconst oid = obj.origin_id || obj.$id || obj.id;\n\tconst parts = collection\n\t\t.find(e => {\n\t\t\treturn oid == e.origin_id && sdate < e.start_date;\n\t\t})\n\t\t.sort((a, b) => {\n\t\t\tif (a.start_date > b.start_date) return -1;\n\t\t\tif (a.start_date < b.start_date) return 1;\n\t\t\treturn 0;\n\t\t});\n\n\tconst rec = webix.copy(obj.$recurring);\n\n\tfor (let i = 0, last; i < parts.length; ++i) {\n\t\tlast = parts[i];\n\n\t\tif (last.$recurring) {\n\t\t\tif (last.$recurring.COUNT) {\n\t\t\t\tif (rec.COUNT && obj.$id != last.id) {\n\t\t\t\t\trec.COUNT = rec.COUNT * 1 + last.$recurring.COUNT * 1;\n\t\t\t\t} else {\n\t\t\t\t\trec.UNTIL = countToUntil(last);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trec.UNTIL = last.$recurring.UNTIL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (mode === \"next\" && !parts.length) {\n\t\tif (rec.COUNT) {\n\t\t\trec.COUNT = cutCount(obj, sdate);\n\t\t} else if (rec.UNTIL && obj.start_date >= rec.UNTIL) {\n\t\t\trec.UNTIL = webix.Date.add(\n\t\t\t\twebix.Date.dayStart(obj.start_date),\n\t\t\t\t1,\n\t\t\t\tFREQUENCE[rec.FREQ],\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\treturn rec;\n}\n\n/**\n * Checks if the selected repeating event has only 1 occurrence\n * @param {Object} obj - the event data\n */\nfunction hasOneOccurrence(obj) {\n\t// as this a 'this' event\n\tif (!obj.recurring) return true;\n\n\t// as 'this' any occurrence in unedited sequence\n\tif (!obj.$recurring.UNTIL) return false;\n\n\tconst end = webix.Date.dayStart(webix.Date.add(obj.end_date, 1, \"day\", true));\n\treturn webix.Date.equal(end, obj.$recurring.UNTIL);\n}\n\n/* EO public functions */\n\n/* private functions */\nfunction countToUntil(last) {\n\tconst lr = last.$recurring;\n\tlet step = lr.COUNT * 1; // !\n\tif (lr.FREQ === \"WEEKLY\") {\n\t\tstep = Math.floor((lr.BYDAY.split(\",\").length / 7) * lr.COUNT);\n\t}\n\treturn webix.Date.add(last.start_date, step, FREQUENCE[lr.FREQ], true);\n}\n\nfunction cutCount(obj, sdate) {\n\tconst date = extractDate(sdate);\n\n\tconst consts = {};\n\tfillWdays(obj.$recurring, consts);\n\tlet nexto = webix.Date.dayStart(obj.start_date);\n\tlet count = 0;\n\twhile (nexto < date) {\n\t\tcount++;\n\t\tnexto = next(nexto, obj.$recurring, consts);\n\t}\n\treturn obj.$recurring.COUNT - count;\n}\n/* EO private functions */\n\nexport default function EditRecurringMixin(child) {\n\tchild.ChangeMode = changeMode;\n\tchild.CorrectCountUntil = correctCountUntil;\n\tchild.HasOneOccurrence = hasOneOccurrence;\n}\n","import { JetView } from \"webix-jet\";\nimport getPalette from \"helpers/palette\";\nimport { getYearDay } from \"helpers/dates\";\n\nimport {\n\tWEEKDAYS,\n\tfillWdays,\n\tnext,\n\tdatesToWeekdays,\n\tWeekdaysToDates,\n\tclipSequence,\n\tcutOccurrence,\n\tseparateSequence,\n} from \"helpers/recurring\";\nimport { serialize } from \"helpers/ical\";\nimport RecurringFormView from \"./recurringform\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class EventFormView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: 14,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\ttooltip: _(\"Close\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{ view: \"label\", label: _(\"Edit event\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\thotkey: \"Ctrl+Enter\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tscroll: true,\n\t\t\tborderless: true,\n\t\t\tpadding: { right: 14 },\n\t\t\telementsConfig: { labelPosition: \"top\" },\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", label: _(\"Event\"), name: \"text\" },\n\t\t\t\t{\n\t\t\t\t\tmargin: 8,\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.GetDateTime(\"start\", _, aSkin),\n\t\t\t\t\t\tthis.GetDateTime(\"end\", _, aSkin),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tname: \"all_day\",\n\t\t\t\t\tlabelPosition: \"left\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"All Day\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleTimeControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.CreateCalendarColor(_),\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tlabel: _(\"Notes\"),\n\t\t\t\t\tname: \"details\",\n\t\t\t\t\theight: 150,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (v, o, m) => {\n\t\t\t\t\t// some fields need preprocessing\n\t\t\t\t\tconst change = this.Form.getDirtyValues();\n\t\t\t\t\tif (Object.keys(change).length) this.PrepareChange(change);\n\t\t\t\t\tif (!this.Compact && m === \"user\")\n\t\t\t\t\t\tthis.Wait(() => this.UpdateEvent(change));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tif (this.app.config.recurring)\n\t\t\tform.elements.splice(3, 0, this.CreateRepeat(_, aSkin));\n\n\t\tif (this.app.config.units) {\n\t\t\tconst index = this.app.config.recurring ? 5 : 4;\n\t\t\tform.elements.splice(index, 0, this.CreateUnitSelector(_));\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tlet index = this.app.config.recurring ? 5 : 4;\n\t\t\tif (this.app.config.units) index++;\n\t\t\tform.elements.splice(index, 0, this.CreateSectionSelector(_));\n\t\t}\n\n\t\tconst config = {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [toolbar, form],\n\t\t\t},\n\t\t};\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.Form = this.$$(\"form\");\n\t\tthis.Local = this.app.getService(\"local\").events(true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\n\t\t// extending this class with common methods for editing of recurring events\n\t\tEditRecurringMixin(this);\n\n\t\t// most commonly called controls\n\t\tthis.RecurringOptions = this.$$(\"recOption\");\n\t\tthis.StartTime = this.$$(\"startTime\");\n\t\tthis.EndTime = this.$$(\"endTime\");\n\n\t\tthis.on(this.State.$changes, \"readonly\", (_v, o) => {\n\t\t\tif (!webix.isUndefined(o)) this.Close();\n\t\t});\n\n\t\tthis.on(this.app, \"form:update:recurring\", update => {\n\t\t\t// 'update' as imitated dirty value\n\t\t\tif (Object.keys(update).length) this.PrepareChange(update);\n\t\t\tthis.UpdateEvent(update);\n\t\t});\n\n\t\t// parse lists that are not data dependable\n\t\tconst local = this.app.getService(\"local\");\n\t\tif (this.app.config.calendars) {\n\t\t\tthis.Calendars = local.calendars(true);\n\t\t\tthis.$$(\"calendar\")\n\t\t\t\t.getList()\n\t\t\t\t.parse(this.Calendars);\n\t\t}\n\n\t\tif (this.app.config.units) {\n\t\t\tconst waitUnits = local.units();\n\t\t\tconst combo = this.Form.elements[\"units\"];\n\t\t\twaitUnits.then(units => {\n\t\t\t\tcombo.getList().parse(units);\n\t\t\t\tcombo.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tthis.Sections = local.sections(true);\n\t\t\tthis.$$(\"sections\")\n\t\t\t\t.getList()\n\t\t\t\t.parse(this.Sections);\n\t\t}\n\t}\n\n\tready() {\n\t\tthis.SubForm = this.getSubView(\"recurringForm\");\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.ClearTempEvent(); // support double clicks and 'Create' at any moment\n\t\t\t\tthis.Wait(() => this.FillForm(v));\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis.ClearTempEvent();\n\t}\n\n\t/**\n\t * Returns the config controls for editing recurring patterns of events\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t * @param {Object} aSkin - stores sizes and colors of a currently active Webix skin\n\t */\n\tCreateRepeat(_, aSkin) {\n\t\tconst rows = [\n\t\t\t{ view: \"label\", label: _(\"Repeat\"), height: aSkin.labelTopHeight },\n\t\t\t{\n\t\t\t\tmargin: 4,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\tlocalId: \"recOption\",\n\t\t\t\t\t\tname: \"rec_option\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{ id: \"none\", value: _(\"never\") },\n\t\t\t\t\t\t\t\t{ id: \"daily\", value: _(\"daily\") },\n\t\t\t\t\t\t\t\t{ id: \"weekly\" },\n\t\t\t\t\t\t\t\t{ id: \"monthly\" },\n\t\t\t\t\t\t\t\t{ id: \"yearly\" },\n\t\t\t\t\t\t\t\t{ id: \"work\", value: _(\"every working day\") },\n\t\t\t\t\t\t\t\t{ id: \"custom\", value: _(\"custom\") },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: (v, o) => this.ToggleSubform(v, o),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\tif (this.Compact) {\n\t\t\trows[1].cols.push({\n\t\t\t\tlocalId: \"editCustomRec\",\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-pencil\",\n\t\t\t\ttooltip: _(\"Change recurring pattern\"),\n\t\t\t\thidden: true,\n\t\t\t\tclick: () => this.ShowSubForm(),\n\t\t\t});\n\t\t}\n\n\t\trows.push({ $subview: RecurringFormView, name: \"recurringForm\" });\n\n\t\treturn { localId: \"repeatControls\", rows: rows };\n\t}\n\n\t/**\n\t * Hides or shows time selectors\n\t * @param {number} v - the value of 'all day' checkbox (1 or 0)\n\t */\n\tToggleTimeControls(v) {\n\t\tif (v == 1) {\n\t\t\tthis.StartTime.hide();\n\t\t\tthis.EndTime.hide();\n\t\t} else {\n\t\t\tthis.StartTime.show();\n\t\t\tthis.EndTime.show();\n\t\t}\n\t}\n\n\t/**\n\t * Shows or hides the subform for editing recurring pattern; the subform is shown when v is 'custom'\n\t * @param {string} v - the new recurring pattern option\n\t * @param {string} o  - the new recurring pattern option\n\t */\n\tToggleSubform(v, o) {\n\t\tif (v === \"custom\") {\n\t\t\tif (this.Compact) {\n\t\t\t\tthis.$$(\"editCustomRec\").show();\n\t\t\t\tif (o) this.ShowSubForm();\n\t\t\t} else {\n\t\t\t\tthis.SubForm.Show();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.SubForm.Hide();\n\t\t\tif (this.Compact) this.$$(\"editCustomRec\").hide();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the config of two controls: a selector of calendar and event color\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t */\n\tCreateCalendarColor(_) {\n\t\tconst ui = {\n\t\t\tmargin: 8,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\tvalue: \"#1abc9c\",\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\tbody: getPalette(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tif (this.app.config.calendars) {\n\t\t\tui.cols.unshift({\n\t\t\t\tview: \"richselect\",\n\t\t\t\tlocalId: \"calendar\",\n\t\t\t\tlabel: _(\"Calendar\"),\n\t\t\t\tname: \"calendar\",\n\t\t\t\tcss: \"webix_scheduler_cal_color\",\n\t\t\t\toptions: {\n\t\t\t\t\tcss: \"webix_scheduler_cal_color_suggest\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttooltip: () => \"\",\n\t\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\t\tconst active = obj.active * 1;\n\t\t\t\t\t\t\tconst css = active ? \"\" : \"class='webix_scheduler_cal_disabled'\";\n\t\t\t\t\t\t\tconst tooltip = active\n\t\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t\t: `webix_tooltip=\"${_(\"Inactive calendar\")}\"`;\n\n\t\t\t\t\t\t\treturn `<div style=\"overflow: hidden;\" ${tooltip} ${css}>${obj.text ||\n\t\t\t\t\t\t\t\t_(\"(no title)\")}\n\t\t\t\t\t\t\t\t<span class=\"webix_scheduler_cal_marker\" style=\"background-color:${obj.color};\">\n\t\t\t\t\t\t\t</span></div>`;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\treturn ui;\n\t}\n\n\t/**\n\t * Returns the config of two controls: a selector of calendar and event color\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t */\n\tCreateUnitSelector(_) {\n\t\tconst ui = {\n\t\t\tview: \"multicombo\",\n\t\t\tname: \"units\",\n\t\t\tlabel: _(\"Units\"),\n\t\t\toptions: [],\n\t\t};\n\t\treturn ui;\n\t}\n\n\t/**\n\t * Returns the config of controls for selecting date and time\n\t * @param {string} type - \"start\" or \"end\"\n\t * @param {function*} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t * @param {Object} aSkin - stores sizes and colors of a currently active Webix skin\n\t */\n\tGetDateTime(type, _, aSkin) {\n\t\treturn {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: aSkin.labelTopHeight,\n\t\t\t\t\tlabel: type === \"start\" ? _(\"Start\") : _(\"End\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 8,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: `${type}_date`,\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\ttype: \"calendar\",\n\t\t\t\t\t\t\t\ticons: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tlocalId: `${type}Time`,\n\t\t\t\t\t\t\tname: `${type}_time`,\n\t\t\t\t\t\t\ttype: \"time\",\n\t\t\t\t\t\t\tformat: \"%H:%i\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tCreateSectionSelector(_) {\n\t\treturn {\n\t\t\tlocalId: \"sections\",\n\t\t\tview: \"richselect\",\n\t\t\tlabel: _(\"Section\"),\n\t\t\tname: \"section\",\n\t\t\toptions: {\n\t\t\t\tdata: [],\n\t\t\t\tbody: {\n\t\t\t\t\ttemplate: \"#text#\",\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t// general form tasks\n\n\t/**\n\t * Fills the form with relevant values for editing of a selected event or adding a new event\n\t * @param {Object} ev - the current state.selected\n\t */\n\tFillForm(ev) {\n\t\tthis.Id = ev.id;\n\n\t\tthis.Form.focus();\n\t\tthis.Date = ev.date;\n\t\tif (typeof this.Date === \"string\") {\n\t\t\tthis.Date = new Date(this.Date.slice(0, this.Date.indexOf(\"_\")) * 1);\n\t\t}\n\n\t\tlet obj;\n\n\t\t// new record or a new copy of a record\n\t\tif (ev.id == \"0\") {\n\t\t\tif (this.State.clipboard && this.State.clipboard.selected) {\n\t\t\t\tobj = this.State.clipboard.selected;\n\t\t\t\tthis.$$(\"repeatControls\").hide();\n\t\t\t} else {\n\t\t\t\tobj = this.NewEvent(ev);\n\t\t\t}\n\n\t\t\tif (obj.then) {\n\t\t\t\treturn obj.then(res => {\n\t\t\t\t\tthis.Local.add({ id: ev.id, ...webix.copy(res) });\n\t\t\t\t\tthis.FillFormContinue(res);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.Local.add({ id: ev.id, ...webix.copy(obj) });\n\t\t\t}\n\t\t} else {\n\t\t\tobj = webix.copy(this.Local.getItem(ev.id));\n\n\t\t\tconst mode = this.getParam(\"mode\", true);\n\t\t\tif (mode) obj = this.AdaptObjToMode(mode, obj);\n\t\t}\n\n\t\tthis.FillFormContinue(obj);\n\t}\n\n\t/**\n\t * Fills the event object with relevant values according to the mode of editing\n\t * @param {string} mode - mode in which a recurring event will be edited (\"all\", \"next\", \"this\")\n\t * @param {Object} obj - event data\n\t */\n\tAdaptObjToMode(mode, obj) {\n\t\tmode = this.ChangeMode(\n\t\t\tmode,\n\t\t\tobj,\n\t\t\tobj.recurring\n\t\t\t\t? obj.start_date\n\t\t\t\t: this.Local.getItem(obj.origin_id).start_date,\n\t\t\tobj.recurring ? this.State.selected.date : obj.start_date\n\t\t);\n\t\tthis.setParam(\"mode\", mode, true);\n\n\t\tif (mode === \"all\" || mode === \"next\") {\n\t\t\tif (mode === \"all\" && obj.origin_id) {\n\t\t\t\tobj = webix.copy(this.Local.getItem(obj.origin_id));\n\t\t\t}\n\n\t\t\t// if this is a \"this\" sub-event\n\t\t\tif (!obj.$recurring)\n\t\t\t\tobj.$recurring = webix.copy(\n\t\t\t\t\tthis.Local.getItem(obj.origin_id).$recurring\n\t\t\t\t);\n\n\t\t\tif (obj.$recurring.COUNT || obj.$recurring.UNTIL) {\n\t\t\t\t// [FIXME] maybe need to store total UNTIL/COUNT on backend (mostly for dynamic loading)\n\t\t\t\tobj.$recurring = this.CorrectCountUntil(\n\t\t\t\t\tobj,\n\t\t\t\t\tmode,\n\t\t\t\t\tobj.start_date,\n\t\t\t\t\tthis.Local\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (mode === \"this\" || mode === \"next\") {\n\t\t\t// split event sequence or cut out an occurrence\n\t\t\tif (this.State.selected.date)\n\t\t\t\tobj = { ...obj, ...separateSequence(obj, this.State.selected.date) };\n\n\t\t\tif (mode === \"this\") {\n\t\t\t\tobj.$recurring = null;\n\t\t\t\tobj.recurring = \"\";\n\t\t\t\tthis.$$(\"repeatControls\").hide();\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Splits start and end dates into date and time parts and fills the form with values\n\t * @param {Object} obj - the event data\n\t */\n\tFillFormContinue(obj) {\n\t\tobj.start_time = webix.Date.copy(obj.start_date);\n\t\tobj.end_time = webix.Date.copy(obj.end_date);\n\n\t\tobj.start_date = webix.Date.datePart(obj.start_date);\n\t\tobj.end_date = webix.Date.datePart(obj.end_date);\n\n\t\tif (this.app.config.recurring) this.SetRecurring(obj);\n\n\t\tthis.Form.setValues(obj);\n\t}\n\n\t/**\n\t * Describes calculated constants of a date\n\t * @typedef {Object} DateInfo\n\t * @property {number} day - the date (day of month)\n\t * @property {number} weekday - the number of a weekday (0-6)\n\t * @property {number} month - the number of month (0-11)\n\t * @property {number} weekNum - the number of a weekday within a month (e.g. 4th Friday)\n\t */\n\n\t/**\n\t * Calculates constants related to the start date of an event\n\t * @param {Date} start - the start date of an event\n\t * @returns {DateInfo}\n\t */\n\tGetFromStartDate(start) {\n\t\tconst res = {\n\t\t\tweekday: start.getDay(),\n\t\t\tday: start.getDate(),\n\t\t\tmonth: start.getMonth(),\n\t\t\tyearday: getYearDay(start),\n\t\t};\n\t\tres.weekNum = Math.floor(res.day / 7) + (res.day % 7 ? 1 : 0);\n\t\treturn res;\n\t}\n\n\t/**\n\t * Sets controls and their values for recurring patterns\n\t * @param {Object} obj - the event data\n\t */\n\tSetRecurring(obj) {\n\t\tconst today = this.GetFromStartDate(obj.start_date);\n\t\tconst roptions = this.ResetRecurringOptions(today);\n\t\tthis.RecurringOptions.getList().parse(roptions);\n\n\t\tthis.SubForm.SetValues(webix.copy(obj), today, true);\n\n\t\tif (!obj.$recurring) {\n\t\t\tobj.rec_option = \"none\";\n\t\t} else if (obj.$recurring.BYDAY === \"MO,TU,WE,TH,FR\") {\n\t\t\tobj.rec_option = \"work\";\n\t\t} else if (\n\t\t\t!obj.$recurring.UNTIL &&\n\t\t\t!obj.$recurring.COUNT &&\n\t\t\t(!obj.$recurring.INTERVAL || obj.$recurring.INTERVAL == 1) &&\n\t\t\t(obj.$recurring.FREQ === \"DAILY\" ||\n\t\t\t\t(obj.$recurring.FREQ === \"WEEKLY\" &&\n\t\t\t\t\tobj.$recurring.BYDAY == WEEKDAYS[today.weekday]) ||\n\t\t\t\t(obj.$recurring.FREQ === \"MONTHLY\" &&\n\t\t\t\t\tobj.$recurring.BYSETPOS &&\n\t\t\t\t\tobj.$recurring.BYSETPOS == today.weekNum &&\n\t\t\t\t\tobj.$recurring.BYDAY == WEEKDAYS[today.weekday]) ||\n\t\t\t\t(obj.$recurring.FREQ === \"YEARLY\" &&\n\t\t\t\t\tobj.$recurring.BYMONTH == today.month + 1 &&\n\t\t\t\t\tobj.$recurring.BYMONTHDAY == today.day))\n\t\t) {\n\t\t\tobj.rec_option = obj.$recurring.FREQ.toLowerCase();\n\t\t} else {\n\t\t\tobj.rec_option = \"custom\";\n\t\t}\n\t}\n\n\t/**\n\t * Returns date-dependent options for recurring pattern select list\n\t * @param {Date} start - the start date of an event\n\t */\n\tResetRecurringOptions(start) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: \"weekly\",\n\t\t\t\tvalue: `${_(\"weekly, every\")} ${\n\t\t\t\t\twebix.i18n.calendar.dayFull[start.weekday]\n\t\t\t\t}`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"monthly\",\n\t\t\t\tvalue: `${_(\"monthly, every\")} ${start.weekNum} ${_(\"week on\")} ${\n\t\t\t\t\twebix.i18n.calendar.dayFull[start.weekday]\n\t\t\t\t}`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"yearly\",\n\t\t\t\tvalue: `${_(\"yearly, every\")} ${\n\t\t\t\t\twebix.i18n.calendar.monthFull[start.month]\n\t\t\t\t} ${start.day}`,\n\t\t\t},\n\t\t];\n\t}\n\n\t/**\n\t * Joins date and time into one Date object\n\t * @param {Date} date - a date without a time part\n\t * @param {Date} time - a date with a time part\n\t */\n\tJoin(date, time) {\n\t\treturn webix.Date.add(date, webix.Date.timePart(time) / 60, \"minute\", true);\n\t}\n\n\t/**\n\t * Returns an object with values for adding a new event\n\t * @param {Object} params - current state.selected property\n\t */\n\tNewEvent(params) {\n\t\tconst start = this.GetStartDate();\n\t\tconst end =\n\t\t\tthis.State.selected.end_date || webix.Date.add(start, 1, \"hour\", true);\n\n\t\tconst obj = {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\ttext: \"\",\n\t\t\tdetails: \"\",\n\t\t};\n\t\tif (this.app.config.recurring) obj.recurring = \"\";\n\t\tif (this.app.config.timeline) {\n\t\t\tobj.section = params.section || this.Sections.getFirstId();\n\t\t}\n\n\t\tif (this.app.config.calendars) {\n\t\t\tlet active = this.State.active[0];\n\t\t\tif (!active) {\n\t\t\t\tconst first = this.Calendars.getFirstId();\n\t\t\t\tconst wait = first\n\t\t\t\t\t? this.Ops.updateCalendar(first, { active: 1 })\n\t\t\t\t\t: this.Ops.addCalendar();\n\n\t\t\t\treturn wait.then(() => {\n\t\t\t\t\tobj.calendar = this.State.active[0];\n\t\t\t\t\tobj.$color = this.Calendars.getItem(obj.calendar).color;\n\t\t\t\t\treturn obj;\n\t\t\t\t});\n\t\t\t}\n\t\t\tobj.calendar = active;\n\t\t\tobj.$color = this.Calendars.getItem(obj.calendar).color;\n\t\t} else obj.$color = \"#01C2A5\"; //same for default color in datacollection\n\n\t\tif (this.app.config.calendars && params.unit) {\n\t\t\tobj.units = params.unit;\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Returns a start date of a new object based on:\n\t * 1) the origin of the double click of the user\n\t * 2) the current date and time\n\t */\n\tGetStartDate() {\n\t\tif (this.Date) {\n\t\t\treturn webix.Date.copy(this.Date);\n\t\t} else {\n\t\t\tconst date = new Date();\n\t\t\tconst minutes = Math.ceil(date.getMinutes() / 30) * 30;\n\t\t\tconst res = webix.Date.copy(this.State.date);\n\t\t\tres.setHours(date.getHours(), minutes);\n\t\t\treturn res;\n\t\t}\n\t}\n\n\t/**\n\t * Launches saving of changes made in the form\n\t * @param {Object} change - an object with changed values\n\t */\n\tUpdateEvent(change) {\n\t\t// clear 'dirty' flag so that next change will definitely be 'dirty'\n\t\tthis.Form.setDirty();\n\n\t\tif (this.Id === \"0\") {\n\t\t\tconst data = this.PrepareOut(change);\n\t\t\tthis._inProgress = this.Ops.addEvent(data, true, this.Id);\n\t\t} else if (Object.keys(change).length) {\n\t\t\tthis._inProgress = this.UpdateExisting(this.Id, change);\n\t\t}\n\n\t\tif (this._inProgress) {\n\t\t\tthis.app.callEvent(\"backend:operation\", [this._inProgress]);\n\t\t\tthis._inProgress\n\t\t\t\t.then(id => {\n\t\t\t\t\tif (id) this.UpdateSelection(id);\n\n\t\t\t\t\t// make event visible if new dates are outside currently selected dates\n\t\t\t\t\tthis.ChangeDate(change, this.Form.getValues());\n\n\t\t\t\t\t// continue editing in simple mode\n\t\t\t\t\tthis.setParam(\"mode\", \"\", true);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis._inProgress = null;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this._inProgress || webix.promise.resolve();\n\t}\n\n\t/**\n\t * Updates an existing event\n\t * @param {(string|number)} sid - the ID of the event\n\t * @param {Object} change - the new data\n\t * @returns {Promise}\n\t */\n\tUpdateExisting(sid, change) {\n\t\tlet mode = this.getParam(\"mode\", true);\n\t\tconst obj = this.Local.getItem(sid);\n\n\t\tif ((mode === \"this\" && !this.HasOneOccurrence(obj)) || mode === \"next\") {\n\t\t\t// cut out occurrence or split event sequence and save as separate events\n\t\t\tchange.origin_id = obj.origin_id || obj.id;\n\t\t\tconst newEvent = this.PrepareOut(change);\n\n\t\t\tlet recurring = \"\";\n\t\t\tif (mode === \"this\") {\n\t\t\t\trecurring = cutOccurrence(this.State.selected.date, obj);\n\t\t\t} else {\n\t\t\t\tlet params;\n\t\t\t\tif (obj.recurring) {\n\t\t\t\t\tparams = [this.State.selected.date, obj];\n\t\t\t\t} else {\n\t\t\t\t\tsid = obj.origin_id;\n\t\t\t\t\tparams = [newEvent.start_date, this.Local.getItem(sid)];\n\t\t\t\t}\n\t\t\t\trecurring = clipSequence(...params);\n\t\t\t}\n\n\t\t\treturn this.Ops.updateEvent(\n\t\t\t\tsid,\n\t\t\t\t{ recurring },\n\t\t\t\tmode,\n\t\t\t\twebix.Date.dayStart(newEvent.start_date),\n\t\t\t\ttrue\n\t\t\t).then(() => {\n\t\t\t\tif (change.rec_option === \"none\") this.State.selected.date = null;\n\t\t\t\treturn this.Ops.addEvent(newEvent, true);\n\t\t\t});\n\t\t} else {\n\t\t\t// non-recurring and recurring in mode \"all\"\n\n\t\t\tif (mode === \"all\") {\n\t\t\t\tconst recVals = this.Form.getValues().$recurring;\n\t\t\t\tif (recVals && webix.isUndefined(change.recurring)) {\n\t\t\t\t\tdelete recVals.EXDATE;\n\t\t\t\t\tchange.recurring = serialize(recVals); // plus all that's been updated in form silently in FillForm\n\n\t\t\t\t\tthis.Form.setValues(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$recurring: recVals,\n\t\t\t\t\t\t\trecurring: change.recurring,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t\tthis.SubForm.SetValues({ EXDATE: null });\n\t\t\t\t}\n\n\t\t\t\tif (obj.origin_id) this.Id = this.State.selected.id = obj.origin_id;\n\t\t\t}\n\n\t\t\treturn this.Ops.updateEvent(this.Id, change, mode, undefined, true).then(\n\t\t\t\t() => {\n\t\t\t\t\tif (change.rec_option === \"none\") this.State.selected.date = null;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * if event was saved as new, update selected silently to avoid triggering listeners\n\t * @param {(string|number)} id - the ID of the event\n\t */\n\tUpdateSelection(id) {\n\t\tthis.State.selected.id = this.Id = id;\n\t\tconst sdate = this.State.selected.date;\n\t\tif (sdate instanceof Date) {\n\t\t\tthis.State.selected.date = null;\n\t\t} else if (sdate) {\n\t\t\tconst fvals = this.Form.getValues();\n\t\t\tthis.State.selected.date =\n\t\t\t\tthis.Join(fvals.start_date, fvals.start_time).valueOf() + \"_\" + id;\n\t\t}\n\t}\n\n\t/**\n\t * Processes changes made in the form and prepares values for saving to the server\n\t * @param {Object} change - an object with changed values\n\t */\n\tPrepareChange(change) {\n\t\tif (change.rec_option) this.ProcessRecurringOption(change);\n\t\telse if (!webix.isUndefined(change.$recurring)) {\n\t\t\tthis.ProcessRecurringPattern(change);\n\t\t}\n\n\t\tthis.ProcessDates(change);\n\n\t\tif (this.app.config.recurring && change.start_date)\n\t\t\tthis.ApplyDatechangeToRecurring(change);\n\n\t\tthis.ProcessText(change, \"text\");\n\t\tthis.ProcessText(change, \"details\");\n\n\t\tthis._changedValues = change;\n\t}\n\n\t/**\n\t * Gets recurring pattern according to the new recurring option\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessRecurringOption(change) {\n\t\tconst fvals = this.Form.getValues();\n\n\t\tif (change.rec_option === \"none\") {\n\t\t\tchange.recurring = \"\";\n\t\t\tchange.series_end_date = \"\";\n\t\t} else if (change.rec_option === \"custom\") {\n\t\t\tif (fvals.$recurring) {\n\t\t\t\tthis.SubForm.SetValues(\n\t\t\t\t\t{ ...fvals, ...change },\n\t\t\t\t\tthis.GetFromStartDate(fvals.start_date)\n\t\t\t\t);\n\t\t\t}\n\t\t\tchange.$recurring = this.SubForm.GetValues();\n\t\t\tthis.ProcessRecurringPattern(change);\n\n\t\t\tif (!fvals.$recurring) {\n\t\t\t\tthis.Form.setValues({ $recurring: change.$recurring }, true);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.GetRecurring(change.rec_option, change, fvals.start_date);\n\t\t\tchange.series_end_date = \"\";\n\t\t}\n\n\t\tdelete change.rec_option;\n\t\tdelete change.$recurring;\n\t}\n\n\t/**\n\t * Serializes recurring pattern object and synchronizes dates with the new pattern\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessRecurringPattern(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tconst recurring = serialize(change.$recurring);\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\n\t\t// check if switch from a preset to custom and back and the pattern is the same\n\t\tif (!old || recurring !== old.recurring) {\n\t\t\tchange.recurring = recurring;\n\t\t\tchange.series_end_date = change.$recurring.UNTIL;\n\n\t\t\tif (change.$recurring.BYDAY) {\n\t\t\t\t[change.start_date, change.end_date] = datesToWeekdays(\n\t\t\t\t\tfvals.start_date,\n\t\t\t\t\tfvals.end_date,\n\t\t\t\t\tchange.$recurring\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.Form.setValues(change, true);\n\t\t}\n\t\tdelete change.$recurring;\n\t}\n\n\t/**\n\t * Sums up dates and time depending on the changes in dates, time and all_day flag\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessDates(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tif (webix.isUndefined(change.all_day)) {\n\t\t\tif ((change.start_date || change.start_time) && fvals.all_day == 0) {\n\t\t\t\tchange.start_date = this.Join(fvals.start_date, fvals.start_time);\n\t\t\t}\n\t\t\tif ((change.end_date || change.end_time) && fvals.all_day == 0) {\n\t\t\t\tchange.end_date = this.Join(fvals.end_date, fvals.end_time);\n\t\t\t}\n\t\t} else if (change.all_day == 1) {\n\t\t\tchange.start_date = fvals.start_date;\n\t\t\tchange.end_date = fvals.end_date;\n\t\t} else if (change.all_day == 0) {\n\t\t\tchange.start_date = this.Join(fvals.start_date, fvals.start_time);\n\t\t\tchange.end_date = this.Join(fvals.end_date, fvals.end_time);\n\t\t}\n\n\t\tif (change.start_date || change.end_date) this.CorrectDateTime(change);\n\t}\n\n\t/**\n\t * Corrects the unchanged field if start > end or end < start\n\t * @param {Object} change - an object with changed values\n\t */\n\tCorrectDateTime(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\t\tconst ev_length = (old.end_date - old.start_date) / 1000 / 60; // minutes\n\n\t\tconst type = change.start_date ? \"start\" : \"end\";\n\t\tconst opposite = type === \"start\" ? \"end\" : \"start\";\n\n\t\tconst start = change.start_date || old.start_date;\n\t\tconst end = change.end_date || old.end_date;\n\n\t\tif ((start >= end && !fvals.all_day) || start > end) {\n\t\t\tchange[opposite + \"_date\"] = webix.Date.add(\n\t\t\t\tchange[type + \"_date\"],\n\t\t\t\t(type === \"start\" ? 1 : -1) * (ev_length || 60),\n\t\t\t\t\"minute\",\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\t// apply also to form\n\t\t\tthis.Form.setValues(\n\t\t\t\t{\n\t\t\t\t\tstart_date: webix.Date.datePart(change.start_date, true),\n\t\t\t\t\tend_date: webix.Date.datePart(change.end_date, true),\n\t\t\t\t\tstart_time: change.start_time || webix.Date.copy(change.start_date),\n\t\t\t\t\tend_time: change.end_time || webix.Date.copy(change.end_date),\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tdelete change.start_time;\n\t\tdelete change.end_time;\n\t}\n\n\t/**\n\t * Removes trailing spaces from input text\n\t * @param {Object} change - an object with changed values\n\t * @param {string} field - the name of a text field ('text', 'details')\n\t */\n\tProcessText(change, field) {\n\t\tif (!this.webix.isUndefined(change[field])) {\n\t\t\tchange[field] = change[field].replace(/(<[^>]+>|^\\s+|\\s+$)/gi, \"\");\n\t\t\tconst prev = this.Local.getItem(this.State.selected.id)[field] || \"\";\n\t\t\tif (change[field] === prev.trim()) delete change[field];\n\t\t}\n\t}\n\n\t/**\n\t * Synchronizes recurring pattern with new start date\n\t * @param {Object} change - an object with changed values\n\t */\n\tApplyDatechangeToRecurring(change) {\n\t\tconst today = this.GetFromStartDate(change.start_date);\n\t\t// if date was changed after subform change, ignore\n\t\tconst fvals = this.Form.getValues();\n\t\tif (!change.recurring && fvals.$recurring) {\n\t\t\tif (fvals.rec_option === \"custom\") {\n\t\t\t\tconst recurring = fvals.$recurring;\n\n\t\t\t\tif (recurring.BYYEARDAY) {\n\t\t\t\t\trecurring.BYYEARDAY = today.yearday;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYMONTH) {\n\t\t\t\t\trecurring.BYMONTH = today.month + 1;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYMONTHDAY) {\n\t\t\t\t\trecurring.BYMONTHDAY = today.day;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYSETPOS) {\n\t\t\t\t\trecurring.BYSETPOS = today.weekNum;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYDAY) {\n\t\t\t\t\trecurring.BYDAY = WeekdaysToDates(\n\t\t\t\t\t\tchange.start_date,\n\t\t\t\t\t\tfvals.$recurring\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (recurring.UNTIL && recurring.UNTIL < change.start_date) {\n\t\t\t\t\tconst oldStart = this.Local.getItem(this.State.selected.id)\n\t\t\t\t\t\t.start_date;\n\t\t\t\t\tconst length = (fvals.$recurring.UNTIL - oldStart) / 1000 / 60; // minutes\n\t\t\t\t\trecurring.UNTIL = webix.Date.add(\n\t\t\t\t\t\tchange.start_date,\n\t\t\t\t\t\tlength,\n\t\t\t\t\t\t\"minute\",\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tchange.recurring = serialize(recurring);\n\n\t\t\t\tthis.SubForm.SetValues({ ...fvals, ...change }, today);\n\t\t\t} else {\n\t\t\t\tthis.GetRecurring(fvals.rec_option, change, fvals.start_date);\n\t\t\t\tdelete change.$recurring;\n\t\t\t}\n\t\t}\n\t\tthis.RecurringOptions.getList().parse(this.ResetRecurringOptions(today));\n\t\tthis.RecurringOptions.refresh();\n\t}\n\n\t/**\n\t * Assigns recurring pattern according to a preset\n\t * @param {string} r the ID of a recurring pattern option\n\t * @param {Object} change - an object with changed values\n\t * @param {Date} start - the start date of the event\n\t */\n\tGetRecurring(r, change, start) {\n\t\tlet $recurring = this.GetRecurringPreset(r, start);\n\n\t\tif (r === \"work\" && change.start_date) {\n\t\t\tconst BYDAY = WeekdaysToDates(change.start_date, $recurring);\n\t\t\tif ($recurring.BYDAY !== BYDAY) {\n\t\t\t\t$recurring.BYDAY = BYDAY;\n\t\t\t\tr = \"custom\";\n\t\t\t}\n\t\t}\n\n\t\tconst recurring = serialize($recurring);\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\n\t\t// check if switch from a preset to custom and back and the pattern is the same\n\t\tif (!old || recurring !== old.recurring) {\n\t\t\tchange.$recurring = $recurring;\n\t\t\tchange.recurring = recurring;\n\t\t\tthis.Form.setValues(\n\t\t\t\t{\n\t\t\t\t\t$recurring: change.$recurring,\n\t\t\t\t\trecurring,\n\t\t\t\t\trec_option: r,\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Gets a recurring pattern object for a pattern preset based on the start date of the event\n\t * @param {string} r - a recurring option (accepted values: \"daily\", \"weekly\", \"work\", \"monthly\", \"yearly\")\n\t * @param {Date} start - the start date of an event\n\t * @returns {Object} - $recurring\n\t */\n\tGetRecurringPreset(r, start) {\n\t\tconst today = this.GetFromStartDate(start);\n\t\tswitch (r) {\n\t\t\tcase \"daily\":\n\t\t\t\treturn { FREQ: \"DAILY\", INTERVAL: 1 };\n\t\t\tcase \"weekly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"WEEKLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYDAY: WEEKDAYS[today.weekday],\n\t\t\t\t};\n\t\t\tcase \"work\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"WEEKLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYDAY: \"MO,TU,WE,TH,FR\",\n\t\t\t\t};\n\t\t\tcase \"monthly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"MONTHLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYSETPOS: today.weekNum,\n\t\t\t\t\tBYDAY: WEEKDAYS[today.weekday],\n\t\t\t\t};\n\t\t\tcase \"yearly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"YEARLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYMONTH: today.month + 1,\n\t\t\t\t\tBYMONTHDAY: today.day,\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn { FREQ: \"DAILY\", INTERVAL: 1 };\n\t\t}\n\t}\n\n\t/**\n\t * Switches Scheduler to another date if the event after change is no longer visible\n\t * @param {Object} dirty - an object with changed values\n\t * @param {Object} fvals - an object with all current form values\n\t */\n\tChangeDate(dirty, fvals) {\n\t\tif (dirty) {\n\t\t\t// start date of non-repeating event changed or repeating event became non-repeating\n\t\t\tif ((dirty.start_date && !fvals.recurring) || dirty.recurring === \"\") {\n\t\t\t\tthis.State.selected.date = null;\n\t\t\t\tthis.UpdateStateDate(dirty.start_date || fvals.start_date);\n\t\t\t} else if (dirty.start_date || dirty.recurring) {\n\t\t\t\tconst date = this.GetClosestOccurrenceDate(dirty, fvals);\n\t\t\t\tthis.State.selected.date =\n\t\t\t\t\tdate.valueOf() + \"_\" + this.State.selected.id;\n\t\t\t\tthis.UpdateStateDate(date);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns the next closest occurrence date when dates or recurring pattern of an event was changed\n\t * @param {Object} dirty - an object with changed data\n\t * @param {Object} fvals - an object of all event form values\n\t * @returns {Date} the date of the next closest occurrence\n\t */\n\tGetClosestOccurrenceDate(dirty, fvals) {\n\t\tlet date = dirty.start_date\n\t\t\t? webix.Date.copy(dirty.start_date)\n\t\t\t: this.Join(fvals.start_date, fvals.start_time);\n\t\tlet end = webix.Date.dayStart(\n\t\t\tthis.State.selected.date\n\t\t\t\t? new Date(this.State.selected.date.split(\"_\")[0] * 1)\n\t\t\t\t: date\n\t\t);\n\t\tif (fvals.series_end_date) {\n\t\t\tend = new Date(\n\t\t\t\tMath.min(webix.Date.add(fvals.series_end_date, -1, \"day\", true), end)\n\t\t\t);\n\t\t}\n\n\t\tconst consts = {};\n\t\tfillWdays(fvals.$recurring, consts);\n\t\tlet temp = webix.Date.copy(date);\n\t\twhile (webix.Date.dayStart(temp) < end) {\n\t\t\ttemp = next(temp, fvals.$recurring, consts);\n\t\t\tif (Math.abs(end - temp) < Math.abs(end - date)) {\n\t\t\t\tdate = webix.Date.copy(temp);\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t}\n\n\t/**\n\t * Updates state.date according to state.mode\n\t * @param {Date} date - new state.date\n\t */\n\tUpdateStateDate(date) {\n\t\tdate = webix.Date.dayStart(date);\n\t\tconst state = this.State;\n\t\tif (\n\t\t\tstate.mode === \"day\" ||\n\t\t\tstate.mode === \"units\" ||\n\t\t\t(state.mode === \"timeline\" && state.timelineMode === \"day\")\n\t\t) {\n\t\t\tconst sdate = webix.Date.dayStart(state.date);\n\t\t\tif (!webix.Date.equal(date, sdate)) {\n\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t}\n\t\t} else {\n\t\t\tconst { start, end } = this.GetModeBounds();\n\t\t\tif (date < start || date >= end) {\n\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns start and end dates of a currently displayed period\n\t */\n\tGetModeBounds() {\n\t\tconst state = this.State;\n\t\tlet mode = state.mode;\n\t\tif (mode === \"timeline\") mode = state.timelineMode;\n\t\telse if (mode === \"agenda\") mode = \"month\";\n\t\tlet start = webix.Date[mode + \"Start\"](state.date);\n\t\tlet end = webix.Date.add(start, 1, mode, true);\n\n\t\tif (state.mode === \"month\") {\n\t\t\tstart = webix.Date.weekStart(start);\n\t\t\tconst weeks = Math.ceil((end - start) / (24 * 60 * 60 * 1000) / 7);\n\t\t\tend = webix.Date.add(start, weeks, \"week\", true);\n\t\t}\n\n\t\treturn { start, end };\n\t}\n\n\t/**\n\t * Unites changed and unchanged fields into 1 object for saving newly added events\n\t * @param {Object} change - an object with changed values\n\t */\n\tPrepareOut(change) {\n\t\tlet obj = this.Form.getValues();\n\n\t\tif (!obj.all_day) {\n\t\t\tobj.start_date = this.Join(obj.start_date, obj.start_time);\n\t\t\tobj.end_date = this.Join(obj.end_date, obj.end_time);\n\t\t}\n\n\t\tobj = webix.extend(obj, change || {}, true);\n\n\t\tif (!(change && change.recurring) && obj.$recurring) {\n\t\t\tobj.$recurring.EXDATE = [];\n\t\t\tobj.recurring = serialize(obj.$recurring);\n\t\t}\n\n\t\tif (!obj.origin_id) obj.origin_id = 0;\n\n\t\t// go backend wants a number\n\t\tif (this.app.config.timeline && !obj.section) obj.section = 0;\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Removes a temporary local event\n\t */\n\tClearTempEvent() {\n\t\tconst sid = this.Id;\n\t\tif (sid === \"0\" && this.Local.exists(sid)) {\n\t\t\tthis.Local.remove(sid);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form and either the whole right panel with it or returns to Info\n\t * @param {boolean} close - if true, the right panel is closed\n\t */\n\tBack(close) {\n\t\tthis.Form.clear();\n\n\t\tif (close || this.State.selected.id === \"0\") {\n\t\t\tthis.State.selected = null;\n\t\t} else {\n\t\t\tconst path = this.Compact ? \"event.formpopup/\" : \"../\";\n\t\t\tthis.show(path + \"event.info\", { target: \"edit\" });\n\t\t}\n\t}\n\n\t/**\n\t * Closes the right panel\n\t */\n\tClose() {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(() => {\n\t\t\t\tthis.Back(true);\n\t\t\t});\n\t\t} else {\n\t\t\tconst dirty =\n\t\t\t\tthis.Form.isDirty() || (this.Subform && this.SubForm.IsDirty());\n\t\t\tif (this.Compact && dirty) {\n\t\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\ttext: _(\"Save changes?\"),\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.Done(true))\n\t\t\t\t\t.catch(() => this.Back(true));\n\t\t\t} else this.Back(true);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form\n\t * @param {boolean} close\n\t */\n\tDone(close) {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(() => {\n\t\t\t\tthis.Back();\n\t\t\t});\n\t\t} else if (this.State.selected.id === \"0\" || this.Compact) {\n\t\t\tlet change = {};\n\t\t\tif (this.Compact) {\n\t\t\t\tif (this._changedValues) change = this._changedValues;\n\n\t\t\t\tif (this.SubForm.IsDirty()) {\n\t\t\t\t\tchange.$recurring = this.SubForm.GetValues();\n\t\t\t\t\tchange.series_end_date = change.$recurring.UNTIL;\n\t\t\t\t\tdelete change.rec_option;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.UpdateEvent(change).then(() => this.Back(close));\n\t\t} else {\n\t\t\tthis.Back();\n\t\t}\n\t}\n\n\t/**\n\t * Waits until some asynchronous operation finishes (if there's any) and then executes 'handler'\n\t * @param {function} handler - the code that will be executed\n\t */\n\tWait(handler) {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(handler);\n\t\t} else {\n\t\t\thandler.call();\n\t\t}\n\t}\n\n\t// compact\n\n\t/**\n\t * Shows a subform with controls for editing recurring pattern in a window\n\t */\n\tShowSubForm() {\n\t\tthis.SubForm.Show();\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst subform = this.SubForm.getRoot();\n\n\t\tconst aSkin = webix.skin.$active;\n\t\twebix.fullscreen.set(subform, {\n\t\t\thead: {\n\t\t\t\tview: \"toolbar\",\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\t\tright: 14,\n\t\t\t\t},\n\t\t\t\telements: [\n\t\t\t\t\t{ view: \"icon\", icon: \"shi-back\", click: () => this.HideSubPop() },\n\t\t\t\t\t{ view: \"label\", label: _(\"Change recurring pattern\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\t\twidth: 130,\n\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\tclick: () => this.HideSubPop(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tconst win = subform.getTopParentView();\n\t\twin.define({ css: \"webix_scheduler_subform_popup\" });\n\t}\n\n\t/**\n\t * Hides the window with the subform\n\t */\n\tHideSubPop() {\n\t\tthis.SubForm.Hide();\n\t\twebix.fullscreen.exit();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class FormPopup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { cutOccurrence } from \"helpers/recurring\";\nimport hotkey from \"jet-hotkey\";\n\n/**\n * Common function used to prepare data of a copied event\n * @param {Object} newEvent\n */\nexport function cleanEventData(newEvent) {\n\t// in recurring event, copy only this event and make sure it stays a part of the series\n\tconst isRecurring = newEvent.recurring || newEvent.$id || newEvent.origin_id;\n\tif (isRecurring) {\n\t\tnewEvent.recurring = \"\";\n\t\tdelete newEvent.$recurring;\n\t\tif (!newEvent.origin_id) newEvent.origin_id = newEvent.$id || newEvent.id;\n\n\t\tdelete newEvent.$id;\n\t}\n\n\tdelete newEvent.id;\n\n\tconst _ = this.app.getService(\"locale\")._;\n\tif (newEvent.text)\n\t\tnewEvent.text = `${_(\"Copy of\")} ${newEvent.text.replace(\n\t\t\t`${_(\"Copy of\")} `,\n\t\t\t\"\"\n\t\t)}`;\n}\n\n/** CopyPaste Mixin adds logic for copying and cutting events with hotkeys */\n\n/**\n * Handles events related to copying, cutting and pasting events (desktop devices)\n * @param {Object} view - a Webix data widget that is used to display events\n */\nfunction HandleCopyPaste(view) {\n\tthis.clipboardModes = [\"copy\", \"cut\"];\n\tthis.Ops = this.app.getService(\"operations\");\n\tconst ctrlKey = webix.env.isMac ? \"COMMAND\" : \"CTRL\";\n\t// when form is opened, hotkeys do not work because focus is on form, not on view\n\tthis.on(hotkey(view), `${ctrlKey}+C`, v => this.AddToClipboard(v, \"copy\"));\n\tthis.on(hotkey(view), `${ctrlKey}+X`, v => this.AddToClipboard(v, \"cut\"));\n\tthis.on(hotkey(view), `${ctrlKey}+V`, (v, e) => this.PasteFromClipboard(e));\n\tthis.on(hotkey(view), \"Esc\", (v, e) => this.PurgeClipboard(v, e));\n\n\tthis.on(this.State.$changes, \"mode\", () => {\n\t\twebix.UIManager.setFocus(view);\n\t});\n\n\tthis.on(this.State.$changes, \"clipboard\", (v, o) => {\n\t\tif (v) {\n\t\t\twebix.html.addCss(view.$view, \"webix_scheduler_clipboard_target\");\n\t\t} else if (o) {\n\t\t\twebix.html.removeCss(view.$view, \"webix_scheduler_clipboard_target\");\n\t\t}\n\t});\n\n\tthis.on(this.app, \"events:rendered\", () => {\n\t\tthis.RestoreClipboardSource(view);\n\t});\n\n\tif (this.$multi) {\n\t\tthis._globalClickHandler = webix.event(this.List.$view, \"click\", () => {\n\t\t\tif (this.State.clipboard && this.State.clipboard.source) {\n\t\t\t\tthis.ChangePasteTarget(this.List.$view);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tthis.on(view, \"onItemClick\", (id, e, node) => {\n\t\t\tif (this.State.clipboard && this.State.clipboard.source) {\n\t\t\t\tif (this.State.mode === \"timeline\") {\n\t\t\t\t\tnode = this.CreatePasteTarget(view, e);\n\t\t\t\t}\n\t\t\t\tthis.ChangePasteTarget(node);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * Cleans up click handler when the view is destroyed\n */\nfunction OnDestroy() {\n\tif (this._globalClickHandler) {\n\t\twebix.eventRemove(this._globalClickHandler);\n\t\tthis._globalClickHandler = null;\n\t}\n}\n\n/**\n * Creates an HTML element that represents a paste target for widgets that do not have suitable elements (timeline mode)\n * @param {Object} view - a Webix data widget that is used to display events\n * @param {MouseEvent} e\n * @returns {HTMLElement}\n */\nfunction CreatePasteTarget(view, e) {\n\tconst scroll = view.getScrollState();\n\tconst x = e.clientX - view.$view.offsetLeft + scroll.x;\n\tconst y = e.clientY - view.$view.offsetTop + scroll.y;\n\tthis.mousePosUnit = Math.floor(x / this.Scales.cellWidth);\n\n\tconst target = webix.html.create(\"div\");\n\tconst sheight = this.GetSectionHeight();\n\ttarget.style.top = `${y - (y % sheight)}px`;\n\ttarget.style.left = `${x - (x % this.Scales.cellWidth)}px`;\n\ttarget.style.width = `${this.Scales.cellWidth}px`;\n\ttarget.style.height = `${sheight}px`;\n\ttarget.style.position = \"absolute\";\n\n\t// view.$view.firstChild.prepend(target); // when IE dies, replace with this line\n\tconst parent = view.$view.firstChild;\n\tparent.insertBefore(target, parent.childNodes[0]);\n\n\treturn target;\n}\n\n/**\n * Sets styling for a paste target and sets it to state.clipboard\n * @param {HTMLElement} node\n */\nfunction SetPasteTargetStyle(node) {\n\twebix.html.addCss(node, \"webix_scheduler_paste_target\");\n\tthis.State.clipboard.target = node;\n}\n\n/**\n * Removes styling from a paste target, cleans up its reference from state and removes it from the DOM if it was created specifically (timeline mode)\n */\nfunction ClearPasteTargetStyle() {\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.target) {\n\t\twebix.html.removeCss(\n\t\t\tthis.State.clipboard.target,\n\t\t\t\"webix_scheduler_paste_target\"\n\t\t);\n\t\tif (this.State.mode === \"timeline\" && clipboard.target.parentNode) {\n\t\t\t// this.State.clipboard.target.remove(); // when IE dies, replace with this line\n\t\t\tconst target = clipboard.target;\n\t\t\ttarget.parentNode.removeChild(target);\n\t\t}\n\t\tthis.State.clipboard.target = null;\n\t}\n}\n\n/**\n * Makes another element the target for pasting\n * @param {HTMLElement} node\n */\nfunction ChangePasteTarget(node) {\n\tif (this.State.clipboard.target !== node) {\n\t\tthis.ClearPasteTargetStyle();\n\t\tthis.SetPasteTargetStyle(node);\n\t}\n}\n\n/**\n * Locates event node by event ID (checks the given one and locates it anew if the parent was re-rendered)\n * @param {HTMLElement} view - parent html element (top html element of a widget)\n * @param {HTMLElement} node - given html element of the event\n * @param {string} id - the ID of the event\n * @returns {HTMLElement}\n */\nfunction locateEvent(view, node, id) {\n\tif (node && view.contains(node)) return node;\n\treturn (\n\t\tview.querySelectorAll(`[webix_e_id=\"${id}\"]`)[0] ||\n\t\tview.querySelectorAll(`[webix_l_id=\"${id}\"]`)[0]\n\t);\n}\n\n/**\n * Adds the selected event to clipboard, sets mode, styles the node of the copied/cut event\n * @param {string} mode - \"copy\" or \"cut\"\n */\nfunction AddToClipboard(view, mode) {\n\tconst sel = this.State.selected;\n\tif (sel && sel.id !== \"0\") {\n\t\tthis.ClearPasteTargetStyle();\n\n\t\tconst source = locateEvent(view.$view, sel.node, sel.date || sel.id);\n\t\tif (source) this.SetClipboardSourceStyle(mode, source);\n\n\t\tconst event = this.GetEvent(sel.date || sel.id);\n\t\tthis.State.clipboard = {\n\t\t\tmode,\n\t\t\tselected: webix.copy(event),\n\t\t\tsource,\n\t\t};\n\t}\n}\n\n/**\n * Adds relevant styling to the node of the copied or cut event\n * @param {string} mode - \"copy\" or \"cut\"\n * @param {HTMLElement} node\n */\nfunction SetClipboardSourceStyle(mode, node) {\n\tconst css = `webix_scheduler_${mode}`;\n\tif (node.className.indexOf(css) === -1) webix.html.addCss(node, css);\n\tconst opMode = this.clipboardModes[this.clipboardModes.indexOf(mode) ^ 1];\n\tconst prevCss = `webix_scheduler_${opMode}`;\n\twebix.html.removeCss(node, prevCss);\n\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.source && node != clipboard.source) {\n\t\twebix.html.removeCss(this.State.clipboard.source, css);\n\t\twebix.html.removeCss(this.State.clipboard.source, prevCss);\n\t}\n}\n\n/**\n * Locates the copied or cut event and highlights it\n * @param {Object} view - the widget that displays events\n */\nfunction RestoreClipboardSource(view) {\n\tconst clip = this.State.clipboard;\n\tif (clip) {\n\t\tconst source = locateEvent(view.$view, clip.source, clip.selected.id);\n\t\tif (source) {\n\t\t\tif (source !== clip.source) {\n\t\t\t\tthis.State.clipboard.source = source;\n\t\t\t}\n\t\t\tthis.SetClipboardSourceStyle(clip.mode, source);\n\t\t}\n\t}\n}\n\n/**\n * Pastes the event from clipboard to the target\n * @param {KeyboardEvent} e\n */\nfunction PasteFromClipboard(e) {\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.source) {\n\t\tconst newEvent = this.GetEventData(clipboard, e);\n\n\t\tif (clipboard.mode === \"copy\") {\n\t\t\tthis.CopyEvent(newEvent);\n\t\t} else if (clipboard.mode === \"cut\") {\n\t\t\tthis.MoveEvent(newEvent);\n\t\t}\n\n\t\tthis.PurgeClipboard();\n\t}\n}\n\n/**\n * Collects new event data for the pasted event based on the chosen target\n * @param {Object} clipboard - clipboard property from the global app state\n * @param {KeyboardEvent} e\n * @returns {Object}\n */\nfunction GetEventData(clipboard, e) {\n\tconst newEvent = clipboard.selected;\n\n\tconst evLength =\n\t\tMath.floor(newEvent.end_date - newEvent.start_date) / (60 * 1000); // minutes\n\tnewEvent.start_date = this.GetTargetDate(e.target.getAttribute(\"webix_l_id\"));\n\tnewEvent.end_date = webix.Date.add(\n\t\tnewEvent.start_date,\n\t\tevLength,\n\t\t\"minute\",\n\t\ttrue\n\t);\n\n\tif (this.State.mode === \"units\") {\n\t\tnewEvent.units = this.Unit.id;\n\t} else if (this.State.mode === \"timeline\") {\n\t\tconst sec = e.target.getAttribute(\"webix_l_id\");\n\t\tif (sec) newEvent.section = sec;\n\t}\n\n\treturn newEvent;\n}\n\n/**\n * Saves the copy of the event\n * @param {Object} newEvent\n */\nfunction CopyEvent(newEvent) {\n\tcleanEventData.call(this, newEvent);\n\tthis.Ops.addEvent(newEvent, true).then(id =>\n\t\tthis.UpdateSelection(id, newEvent)\n\t);\n}\n\n/**\n * Saves the event to a new target\n * @param {Object} newEvent\n */\nfunction MoveEvent(newEvent) {\n\t// cut operation is either update - for normal events\n\t// or edit as 'this' - for recurring events\n\tif (newEvent.recurring) {\n\t\tconst recurring = cutOccurrence(newEvent.id, newEvent);\n\t\tconst updateId = newEvent.$id;\n\t\tcleanEventData.call(this, newEvent);\n\n\t\t// [todo] create 1 Op for updating as this because calling 2 methods (update, add) for this wasn't the best idea\n\t\tthis.Ops.updateEvent(\n\t\t\tupdateId,\n\t\t\t{ recurring },\n\t\t\t\"this\",\n\t\t\tnewEvent.start_date,\n\t\t\ttrue\n\t\t).then(() =>\n\t\t\tthis.Ops.addEvent(newEvent, true).then(id =>\n\t\t\t\tthis.UpdateSelection(id, newEvent)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tconst update = {\n\t\t\tstart_date: newEvent.start_date,\n\t\t\tend_date: newEvent.end_date,\n\t\t};\n\t\tif (newEvent.units) update.units = newEvent.units;\n\t\tif (newEvent.section) update.section = newEvent.section;\n\t\tthis.Ops.updateEvent(newEvent.id, update, null, null, true).then(() => {\n\t\t\tthis.UpdateSelection(newEvent.id, newEvent);\n\t\t});\n\t}\n}\n\nfunction PurgeClipboard() {\n\tconst clip = this.State.clipboard;\n\tif (clip) {\n\t\tconst { mode, source } = clip;\n\t\twebix.html.removeCss(source, `webix_scheduler_${mode}`);\n\n\t\tthis.ClearPasteTargetStyle();\n\t\tthis.State.clipboard = null;\n\n\t\treturn false;\n\t}\n}\n\n/**\n *\n * @param {Object} child - the object of a JetView instance\n * @param {Object} mainWidget - the main widget within a jet view\n * @param {Object} config - some config that is passed for this view (e.g. multi: true)\n */\nexport default function CopyPasteMixin(child, mainWidget, config) {\n\tchild.AddToClipboard = AddToClipboard;\n\tchild.SetClipboardSourceStyle = SetClipboardSourceStyle;\n\tchild.RestoreClipboardSource = RestoreClipboardSource;\n\tchild.PasteFromClipboard = PasteFromClipboard;\n\tchild.GetEventData = GetEventData;\n\tchild.CopyEvent = CopyEvent;\n\tchild.MoveEvent = MoveEvent;\n\tchild.ClearPasteTargetStyle = ClearPasteTargetStyle;\n\tchild.SetPasteTargetStyle = SetPasteTargetStyle;\n\tchild.ChangePasteTarget = ChangePasteTarget;\n\tchild.CreatePasteTarget = CreatePasteTarget;\n\tchild.PurgeClipboard = PurgeClipboard;\n\n\tif (config && config.multi) {\n\t\tchild.$multi = true;\n\t\tchild.destroy = OnDestroy;\n\t}\n\n\tHandleCopyPaste.call(child, mainWidget);\n}\n","/* eslint-disable indent */\n/* eslint-disable no-mixed-spaces-and-tabs */\nimport { JetView } from \"webix-jet\";\nimport { FREQUENCE, WEEKDAYS, separateSequence } from \"../../helpers/recurring\";\nimport { cleanEventData } from \"helpers/copypaste\";\n\nimport EventActionMenu from \"./actionmenu\";\n\nexport default class EventView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: 14,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Back(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"edit\",\n\t\t\t\t\tlabel: _(\"Edit\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\tthis.$scope.StartAction(\"Edit\", this.$view);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tif (this.app.config.copypaste) {\n\t\t\tbar.elements.splice(-1, 0, {\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"shi-content-copy\",\n\t\t\t\ttooltip: _(\"Copy event\"),\n\t\t\t\tclick: () => this.CopyEvent(),\n\t\t\t});\n\t\t}\n\n\t\tconst info = {\n\t\t\tlocalId: \"text\",\n\t\t\tview: \"template\",\n\t\t\tcss: \"webix_scheduler_info\",\n\t\t\ttemplate: obj => (obj.start_date ? this.InfoTemplate(obj) : \"\"),\n\t\t\tborderless: true,\n\t\t};\n\n\t\tconst deleteButton = {\n\t\t\tview: \"button\",\n\t\t\tlocalId: \"remove\",\n\t\t\tlabel: _(\"Delete event\"),\n\t\t\tcss: \"webix_danger webix_scheduler_danger\",\n\t\t\talign: \"center\",\n\t\t\tinputWidth: 330,\n\t\t\tclick: function() {\n\t\t\t\tthis.$scope.StartAction(\"Delete\", this.$view);\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\tbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\tpadding: { right: 14 + 2 },\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [info, deleteButton],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.UnitsLocal = this.app.getService(\"local\").units(true);\n\n\t\tthis.on(this.State.$changes, \"readonly\", v => {\n\t\t\tconst action = v ? \"hide\" : \"show\";\n\t\t\tthis.$$(\"edit\")[action]();\n\t\t\tthis.$$(\"remove\")[action]();\n\t\t});\n\n\t\tconst template = this.$$(\"text\");\n\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.EventObj = this.app\n\t\t\t\t\t.getService(\"local\")\n\t\t\t\t\t.events(true)\n\t\t\t\t\t.getItem(v.id);\n\t\t\t\ttemplate.setValues(this.EventObj);\n\t\t\t}\n\t\t});\n\n\t\tthis.Menu = this.ui(EventActionMenu);\n\n\t\tif (this.app.config.units) {\n\t\t\tconst waitUnits = this.app.getService(\"local\").units();\n\t\t\twaitUnits.then(() => {\n\t\t\t\ttemplate.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tconst local = this.app.getService(\"local\");\n\t\t\tlocal.sections().then(data => {\n\t\t\t\tthis.Sections = data;\n\t\t\t\ttemplate.refresh();\n\t\t\t});\n\t\t}\n\t}\n\n\tStartAction(mode, node) {\n\t\tif (\n\t\t\tthis.app.config.recurring &&\n\t\t\t(typeof this.State.selected.date === \"string\" || this.EventObj.origin_id)\n\t\t) {\n\t\t\tthis.Menu.Show(node).then(o => {\n\t\t\t\tif (mode === \"Delete\") this.DeleteEvent(o);\n\t\t\t\telse this.EditEvent(o);\n\t\t\t});\n\t\t} else {\n\t\t\tif (mode === \"Delete\") this.DeleteEvent();\n\t\t\telse this.EditEvent();\n\t\t}\n\t}\n\n\tEditEvent(o) {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst path = compact ? \"event.formpopup/\" : \"../\";\n\t\tthis.show(path + \"event.form\", { target: \"edit\", params: { mode: o } });\n\t}\n\n\tDeleteEvent(mode) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\ttitle: _(\"Delete event\"),\n\t\t\t\ttext: _(\"The event will be deleted permanently, are you sure?\"),\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst obj = this.EventObj;\n\t\t\t\tlet sdate = \"\";\n\t\t\t\tif (mode && mode !== \"all\") {\n\t\t\t\t\tif (this.State.selected) sdate = this.State.selected.date;\n\t\t\t\t\telse if (obj.$id) sdate = obj.id;\n\t\t\t\t}\n\t\t\t\tthis.app\n\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t.removeEvent(this.EventObj, mode, sdate);\n\t\t\t\tthis.Back(true);\n\t\t\t});\n\t}\n\n\t/** Sets selected of the global reactive state to open form for copy creation */\n\tCopyEvent() {\n\t\tconst data = webix.copy(this.EventObj);\n\t\tcleanEventData.call(this, data);\n\t\tthis.State.$batch({\n\t\t\tselected: { id: \"0\" },\n\t\t\tclipboard: { mode: \"copy\", selected: data },\n\t\t});\n\t}\n\n\t/**\n\t * Closes the info panel\n\t * @param {Boolean} removal - indicates that the panel was closed after an event was removed\n\t */\n\tBack(removal) {\n\t\tif (removal) {\n\t\t\tconst clip = this.State.clipboard;\n\t\t\tif (\n\t\t\t\tclip &&\n\t\t\t\t(clip.selected.id === this.EventObj.id ||\n\t\t\t\t\tclip.selected.id.indexOf(\"_\" + this.EventObj.id) > -1)\n\t\t\t) {\n\t\t\t\tthis.State.clipboard = null;\n\t\t\t}\n\t\t}\n\n\t\tthis.State.selected = null;\n\t}\n\n\tInfoTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (this.app.config.recurring && this.State.selected.date) {\n\t\t\tobj = { ...obj, ...separateSequence(obj, this.State.selected.date) };\n\t\t}\n\t\tconst [start, end] = [obj.start_date, obj.end_date];\n\n\t\tconst oneday = webix.Date.equal(\n\t\t\twebix.Date.datePart(start, true),\n\t\t\twebix.Date.datePart(end, true)\n\t\t);\n\n\t\tconst allday =\n\t\t\twebix.Date.equal(webix.Date.datePart(start, true), start) &&\n\t\t\twebix.Date.equal(webix.Date.datePart(end, true), end) &&\n\t\t\tobj.all_day;\n\n\t\tconst time = webix.i18n.timeFormatStr;\n\t\tconst date = webix.i18n.longDateFormatStr;\n\n\t\tconst title = `<div class=\"webix_scheduler_event_title\">${obj.text ||\n\t\t\t_(\"(No title)\")}</div>`;\n\n\t\tconst startDate = date(start);\n\t\tconst endDate = date(end);\n\t\tconst startTime = time(start);\n\t\tconst endTime = time(end);\n\n\t\tlet fromTo = \"\";\n\t\tif (oneday) {\n\t\t\tfromTo = `<div class=\"webix_scheduler_event_text\">${startDate}</div>`;\n\t\t\tif (!allday)\n\t\t\t\tfromTo += `<div class=\"webix_scheduler_event_text\">${_(\n\t\t\t\t\t\"from\"\n\t\t\t\t)} ${startTime} ${_(\"to\")} ${endTime}</div>`;\n\t\t} else {\n\t\t\tfromTo = `<div class=\"webix_scheduler_event_text\">${_(\"from\")} ${\n\t\t\t\t!allday ? startTime : \"\"\n\t\t\t} ${startDate}</div><div class=\"webix_scheduler_event_text\">${_(\"to\")} ${\n\t\t\t\t!allday ? endTime : \"\"\n\t\t\t} ${endDate}</div>`;\n\t\t}\n\n\t\tconst recurring =\n\t\t\tthis.app.config.recurring && obj.recurring\n\t\t\t\t? this.GetRecurringText(obj, _)\n\t\t\t\t: \"\";\n\n\t\tlet units = \"\";\n\t\tif (this.app.config.units) {\n\t\t\tunits += `<div class=\"webix_scheduler_event_units_title\">${_(\n\t\t\t\t\"Assigned to units\"\n\t\t\t)}:</div><div class=\"webix_scheduler_event_units\">`;\n\t\t\tif (obj.units) {\n\t\t\t\tconst unitIDs = obj.units.split(\",\");\n\t\t\t\tunitIDs.forEach((id, index) => {\n\t\t\t\t\tconst isLast = index === unitIDs.length - 1;\n\t\t\t\t\tconst unitObj = this.UnitsLocal.getItem(id);\n\t\t\t\t\tconst unitValue =\n\t\t\t\t\t\tunitObj && unitObj.value ? unitObj.value : _(\"Unknown unit\");\n\t\t\t\t\tunits += `<div class=\"webix_scheduler_event_unit_item\">${unitValue}${\n\t\t\t\t\t\tisLast ? \"\" : \",\"\n\t\t\t\t\t}</div>`;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tunits += _(\"No units\");\n\t\t\t}\n\t\t\tunits += \"</div>\";\n\t\t}\n\n\t\tconst section =\n\t\t\tthis.app.config.timeline && this.Sections ? this.GetSection(obj, _) : \"\";\n\n\t\tlet details = \"\";\n\t\tif (obj.details)\n\t\t\tdetails = `<div class=\"webix_scheduler_event_details_title\">${_(\n\t\t\t\t\"Notes\"\n\t\t\t)}</div>\n\t\t\t\t<div class=\"webix_scheduler_event_text\">${obj.details.replace(\n\t\t\t\t\t/(?:\\r\\n|\\r|\\n)/g,\n\t\t\t\t\t\"<br>\"\n\t\t\t\t)}</div>`;\n\n\t\treturn `${title}\n\t\t\t<div class='webix_scheduler_event_from_to'>${fromTo}</div>\n\t\t\t<div class='webix_scheduler_event_recurring_pattern'>${recurring}</div>${units}${section}${details}`;\n\t}\n\n\tGetRecurringText(obj, _) {\n\t\tconst mode = obj.$recurring;\n\t\tconst interval = mode.INTERVAL && mode.INTERVAL > 1 ? mode.INTERVAL : \"\";\n\n\t\tlet pattern = \"\";\n\t\tif (mode.BYDAY) {\n\t\t\tpattern = ` ${_(\"on\")} ${mode.BYSETPOS || \"\"} ${mode.BYDAY.split(\",\")\n\t\t\t\t.map(d => webix.i18n.calendar.dayFull[WEEKDAYS.indexOf(d)])\n\t\t\t\t.join(\", \")} ${\n\t\t\t\tmode.BYMONTH\n\t\t\t\t\t? `${_(\"of\")} ${webix.i18n.calendar.monthFull[mode.BYMONTH - 1]}`\n\t\t\t\t\t: \"\"\n\t\t\t}`;\n\t\t} else if (mode.BYMONTHDAY) {\n\t\t\tpattern =\n\t\t\t\t(mode.BYMONTHDAY ? ` ${_(\"on\")} ` : \"\") +\n\t\t\t\t(mode.BYMONTH\n\t\t\t\t\t? `${mode.BYSETPOS ? _(\"of\") : \"\"} ${\n\t\t\t\t\t\t\twebix.i18n.calendar.monthFull[mode.BYMONTH - 1]\n\t\t\t\t\t  }`\n\t\t\t\t\t: \"\") +\n\t\t\t\t(mode.BYMONTHDAY ? ` ${mode.BYMONTHDAY}` : \"\");\n\t\t} else if (mode.BYYEARDAY) {\n\t\t\tpattern = `${_(\"day\")} ${mode.BYYEARDAY}`;\n\t\t}\n\n\t\treturn `${_(\"Repeats each\")} ${interval} ${_(\n\t\t\tFREQUENCE[mode.FREQ] + (interval ? \"s\" : \"\")\n\t\t)} ${pattern}${\n\t\t\tmode.COUNT\n\t\t\t\t? `, ${mode.COUNT} ${_(\"times\")}`\n\t\t\t\t: mode.UNTIL\n\t\t\t\t? ` ${_(\"till\")} ${webix.i18n.longDateFormatStr(mode.UNTIL)}`\n\t\t\t\t: \"\"\n\t\t}`;\n\t}\n\n\t/**\n\t * Returns a string with HTML for the info with the section\n\t * @param {Object} obj - data of an event\n\t * @param {function} _ - the translator function of the Locale plugin\n\t * @returns {string} a string with HTML for the info with the section\n\t */\n\tGetSection(obj, _) {\n\t\tconst section = this.Sections.getItem(obj.section);\n\t\tif (section)\n\t\t\treturn `<div class=\"webix_scheduler_section_tpl\"><span class=\"webix_scheduler_section_title\">${_(\n\t\t\t\t\"Section\"\n\t\t\t)}:</span> ${section.text}</div>`;\n\t\treturn \"\";\n\t}\n}\n","let BRIGHTNESS;\nlet FONT;\nwebix.ready(() => {\n\tconst dark = webix.skin.$name === \"contrast\" || webix.skin.$name === \"dark\";\n\tBRIGHTNESS = dark ? 0.35 : 0.75;\n\tFONT = dark ? \"#9f9d9d\" : \"#ffffff\";\n});\n\n/**\n * Gets contrasting text color for the event background color\n * @param {string} color - background color\n * @returns {string} text color\n */\nexport function getContrastingColor(color) {\n\tconst rgb = webix.color.toRgb(color);\n\tconst brightness = Math.round(\n\t\t(rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000\n\t);\n\treturn brightness > 180 ? \"#475466\" : \"#ffffff\";\n}\n\nexport function getDimmedColor(color) {\n\tlet [hue, saturation] = hexToHsv(color);\n\thue *= 0.95;\n\tsaturation *= 0.4;\n\treturn `rgb(${webix.color.hsvToRgb(hue, saturation, BRIGHTNESS)})`;\n}\n\nexport function getDimmedFont() {\n\treturn FONT;\n}\n\nfunction hexToHsv(hex) {\n\tconst [red, green, blue] = webix.color.toRgb(hex);\n\treturn webix.color.rgbToHsv(red, green, blue);\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class EventActionPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst buttons = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Cancel\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Cancel(),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Apply\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\thead: _(\"Edit recurring event\"),\n\t\t\tautoheight: true,\n\t\t\tcss: \"webix_scheduler_action_popup\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\tpadding: { top: 0 },\n\t\t\t\twidth: 340,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\tlocalId: \"option\",\n\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ id: \"this\", value: _(\"This event\") },\n\t\t\t\t\t\t\t{ id: \"next\", value: _(\"This event and the following\") },\n\t\t\t\t\t\t\t{ id: \"all\", value: _(\"All events\") },\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\tbuttons,\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => (this.Result = null),\n\t\t\t},\n\t\t});\n\t}\n\n\tinit(view) {\n\t\tthis.Root = view;\n\t}\n\n\tShow(promise) {\n\t\tthis.Result = promise;\n\t\tthis.$$(\"option\").setValue(\"this\");\n\t\tthis.Root.show();\n\t}\n\n\tDone() {\n\t\tconst id = this.$$(\"option\").getValue();\n\t\tif (this.Result) this.Result.resolve(id);\n\t\tthis.Root.hide();\n\t}\n\n\tCancel() {\n\t\tif (this.Result) this.Result.reject();\n\t\tthis.Root.hide();\n\t}\n}\n","import { getDimmedColor, getDimmedFont } from \"./colors\";\n\nexport function marker(obj) {\n\tconst color = obj.color || obj.$color;\n\treturn `<div class=\"webix_event_marker\"><div class=\"webix_event_marker_inner\" style=\"background-color:${\n\t\tobj.$past ? getDimmedColor(color) : color\n\t};\"></div></div>`;\n}\n\nexport function events(_) {\n\treturn function(obj, common) {\n\t\treturn `<div class=\"webix_event_overall ${\n\t\t\tobj.$past ? \"webix_scheduler_past_event\" : \"\"\n\t\t}\"><div class=\"webix_event_time\">${common.timeStart(obj)}</div>${marker(\n\t\t\tobj,\n\t\t\tcommon\n\t\t)}<div class=\"webix_event_text\">${obj.text || _(\"(No title)\")}</div></div>`;\n\t};\n}\n\nexport function dayEventColor(obj) {\n\tconst color = obj.color || obj.$color;\n\treturn `border-color:${\n\t\tobj.$past ? getDimmedColor(obj.$color) : obj.$color\n\t}; background-color:${obj.$past ? getDimmedColor(color) : color}; color:${\n\t\tobj.$past ? getDimmedFont() : obj.$textColor\n\t};`;\n}\n\nexport function timeStart(start, end) {\n\treturn `<div class=\"start\">${webix.i18n.timeFormatStr(\n\t\tstart\n\t)}</div><div class=\"end\">${webix.i18n.timeFormatStr(end)}</div>`;\n}\n\nfunction fill(obj, common, size) {\n\tconst v = common.master;\n\treturn (\n\t\tv[\"$\" + size] -\n\t\t(v.config[size == \"width\" ? \"xCount\" : \"yCount\"] - 1) * common[size]\n\t);\n}\n\nexport function templateStart(obj, common, marks) {\n\tlet { width, height } = common;\n\tif (obj.right) width = fill(obj, common, \"width\");\n\tif (obj.bottom) height = fill(obj, common, \"height\");\n\treturn (\n\t\t\"<div \" +\n\t\t/*@attr*/ \"webix_l_id\" +\n\t\t`=\"${obj.id}\" class=\"${common.classname(obj, common, marks)}\" ${common.aria(\n\t\t\tobj,\n\t\t\tcommon,\n\t\t\tmarks\n\t\t)} style=\"width:${width}px; height:${height}px; float:left; overflow:hidden;\">`\n\t);\n}\n","import { JetView } from \"webix-jet\";\nimport { events, timeStart } from \"helpers/templates\";\nimport { isMultiDay } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\n\nexport default class UnitListView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"unitlist\",\n\t\t\tlocalId: \"list\",\n\t\t\tuniteBy: () => \"custom\",\n\t\t\ttype: {\n\t\t\t\ttemplate: events(_),\n\t\t\t\ttemplateHeader: obj => this.TemplateHeader(obj),\n\t\t\t\ttimeStart: obj => this.TimeStart(obj),\n\t\t\t\theight: 50,\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonUnits: () => this.SetUnits(),\n\t\t\t\tonItemClick: (id, node) => this.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"list\");\n\t\twebix.extend(this.List, webix.OverlayBox);\n\t}\n\n\tShowEvent(id, node) {\n\t\tconst obj = this.List.getItem(id);\n\t\tconst sel = getParams(obj);\n\t\tsel.node = node;\n\t\tthis.State.selected = sel;\n\t}\n\n\tToggleOverlay() {\n\t\tif (!this.List.count()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.List.showOverlay(_(\"No Events\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tSetUnits() {\n\t\tlet units = this.List.units;\n\t\tconst data = this.data.all;\n\n\t\t// ignore clearAll\n\t\tif (Object.keys(units).length) {\n\t\t\tthis.List.units = {};\n\t\t\tlet start = this.data.start;\n\t\t\tconst end = this.data.end;\n\n\t\t\twhile (start < end) {\n\t\t\t\tconst next = webix.Date.add(start, 1, \"day\", true);\n\n\t\t\t\tlet result = data\n\t\t\t\t\t.filter(\n\t\t\t\t\t\td =>\n\t\t\t\t\t\t\td.start_date < next &&\n\t\t\t\t\t\t\t(d.end_date > start || (d.end_date >= start && d.all_day))\n\t\t\t\t\t)\n\t\t\t\t\t.map(ev => ev.id);\n\t\t\t\tif (result.length) {\n\t\t\t\t\tthis.List.units[start.valueOf()] = result;\n\t\t\t\t}\n\n\t\t\t\tstart = webix.Date.add(start, 1, \"day\", true);\n\t\t\t}\n\t\t}\n\t}\n\n\tTimeStart(ev) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (isMultiDay(ev)) return _(\"All Day\");\n\t\telse return timeStart(ev.start_date, ev.end_date);\n\t}\n}\n","import UnitListView from \"../common/unitlist\";\nimport { shrinkTo, isToday } from \"helpers/dates\";\n\nexport default class AgendaView extends UnitListView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst ui = super.config();\n\t\tui.css = \"webix_scheduler_agenda\";\n\n\t\twebix.extend(\n\t\t\tui.type,\n\t\t\t{\n\t\t\t\theight: \"auto\",\n\t\t\t\theaderHeight: 50,\n\t\t\t\tclassname: obj => this.TemplateCss(obj),\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\twebix.extend(\n\t\t\tui.on,\n\t\t\t{\n\t\t\t\tonItemRender: obj => {\n\t\t\t\t\tif (obj.$unit) this.CurrentUnit = obj.$unit;\n\t\t\t\t},\n\t\t\t\tonItemClick: (id, e, node) => {\n\t\t\t\t\tnode = node.firstChild;\n\t\t\t\t\tthis.ShowEvent(id, node);\n\t\t\t\t\tif (!compact) this.SelectEvent(node);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tconst events = this.Data.events(true);\n\n\t\tthis.on(this.State.$changes, \"date\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"active\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (!v) this.SelectEvent(); //remove selection\n\t\t});\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData());\n\n\t\t// updates made in full mode by form\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData()\n\t\t);\n\t}\n\n\tRefreshData() {\n\t\tlet start = webix.Date.monthStart(this.State.date);\n\t\tlet end = webix.Date.add(start, 1, \"month\", true);\n\n\t\tthis.Data.getEvents(start, end).then(data => {\n\t\t\tthis.data = { all: data, start: start, end: end };\n\t\t\tif (this.app) {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(data.map(shrinkTo(start, end)));\n\t\t\t\tthis.ToggleOverlay();\n\t\t\t}\n\t\t});\n\t}\n\n\tSelectEvent(node) {\n\t\tif (node == this._selected) return;\n\n\t\tconst name = \"webix_agenda_selected\";\n\t\tif (this._selected) webix.html.removeCss(this._selected, name);\n\t\tif (node) webix.html.addCss(node, name);\n\n\t\tthis._selected = node;\n\t}\n\n\tTemplateHeader(datestring) {\n\t\tconst date = new Date(datestring * 1);\n\t\tconst today = isToday(date);\n\n\t\tconst fstring = `%F <span class='webix_scheduler_monthday${\n\t\t\ttoday ? \" webix_scheduler_today\" : \"\"\n\t\t}'>%j</span><br><span class='webix_scheduler_dayofweek'>%l</span>`;\n\n\t\treturn webix.Date.dateToStr(fstring)(date);\n\t}\n\n\tTemplateCss(obj) {\n\t\tconst ids = this.List.getUnitList(this.CurrentUnit);\n\n\t\tlet css = \"webix_list_item\";\n\t\tif (obj.id == ids[ids.length - 1]) css += \" webix_event_last\";\n\t\tif (obj.id == ids[0]) css += \" webix_event_first\";\n\n\t\treturn css;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class HourscaleView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tborderless: true,\n\t\t\tlocalId: \"scale\",\n\t\t\tcss: \"webix_scheduler_scale\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\theightSize: (obj, common) => {\n\t\t\t\t\tconst ind = this.List.getIndexById(obj.id);\n\t\t\t\t\treturn common.height - (ind === 0 ? 17 : 0) + \"px\";\n\t\t\t\t},\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 51,\n\t\t\ttemplate: obj => this.HourScaleItem(obj),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.List = this.$$(\"scale\");\n\t\tthis.ParseHours();\n\t}\n\n\tParseHours() {\n\t\tconst data = [];\n\t\tfor (let h = 0; h < 24; h++) {\n\t\t\tdata.push({ id: h + \"\" });\n\t\t}\n\t\tthis.List.parse(data);\n\t}\n\n\tHourScaleItem(obj) {\n\t\tif (this.List.getIndexById(obj.id) === 0) return \"\";\n\t\telse return `${(obj.id < 10 ? \"0\" : \"\") + obj.id}:00`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MultiMoreView extends JetView {\n\tconfig() {\n\t\tconst more = {\n\t\t\tview: \"template\",\n\t\t\tlocalId: \"more\",\n\t\t\twidth: 50,\n\t\t\tcss: \"webix_scheduler_multi_space\",\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\t\"wxi-angle-down\": () => this.ExpandData(),\n\t\t\t\t\"wxi-angle-up\": () => this.WrapData(),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tcols: [more, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.List = this.$$(\"multiDayList\");\n\t\tthis.MoreIcon = this.$$(\"more\");\n\n\t\tthis._expandState = \"down\";\n\t\tthis.maxVisibleLines = 3;\n\t}\n\n\t/**\n\t *\n\t * @param {*} mode\n\t */\n\tSetMoreIcon(mode) {\n\t\tif (!mode) {\n\t\t\tthis.MoreIcon.setHTML(\"\");\n\t\t} else {\n\t\t\tconst tooltip = mode === \"up\" ? \"Collapse\" : \"Expand\";\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.MoreIcon.setHTML(\n\t\t\t\t`<div class=\"webix_scheduler_more_icon webix_icon wxi-angle-${mode}\" webix_tooltip=\"${_(\n\t\t\t\t\t`${tooltip} all-day events`\n\t\t\t\t)}\"><div>`\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Sets new height and delay for animation\n\t * @param {string} mode - \"up\" or \"down\"\n\t * @param {number} height\n\t * @param {function} handler\n\t */\n\tAnimate(mode, height, handler) {\n\t\tconst delay = 150;\n\t\tthis.List.$view.style.transition = `height ${delay}ms`;\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, delay);\n\t}\n}\n","function _select(id, functor) {\n\tconst trgs = this.LocateSelected(id);\n\tif (trgs) {\n\t\tfor (let i = 0; i < trgs.length; i++)\n\t\t\tfunctor(trgs[i], \"webix_scheduler_event_selected\");\n\t}\n}\n\nfunction Select(id) {\n\treturn _select.call(this, id, webix.html.addCss);\n}\n\nfunction Unselect(id) {\n\treturn _select.call(this, id, webix.html.removeCss);\n}\n\nfunction HandleSelection() {\n\tconst mode = this._SelectionMode;\n\tthis.State = this.app.getState();\n\n\tthis.on(this.State.$changes, \"selected\", (v, o) => {\n\t\tif (o) this.Unselect(o.date && typeof o.date === \"string\" ? o.date : o.id);\n\n\t\tif (v) {\n\t\t\tconst id = v.id === \"0\" || !v.date ? v.id : v.date;\n\t\t\tsetTimeout(\n\t\t\t\t() => this.Select(id),\n\t\t\t\tmode !== \"multi\" && id === \"0\" ? 150 : 0\n\t\t\t);\n\t\t}\n\t});\n\n\t// reapply selection to a saved new event\n\tif (mode !== \"multi\") {\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(events.data, \"onStoreUpdated\", (id, o, operation) => {\n\t\t\tif (\n\t\t\t\toperation === \"add\" &&\n\t\t\t\tid != \"0\" &&\n\t\t\t\tthis.State.selected &&\n\t\t\t\tthis.State.selected.id === \"0\"\n\t\t\t) {\n\t\t\t\tthis.State.selected.id = id;\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction locate(inner) {\n\treturn function LocateSelected(id) {\n\t\tif (this._DataObj) {\n\t\t\treturn Array.prototype.map.call(\n\t\t\t\tthis._DataObj.querySelectorAll(\n\t\t\t\t\t`[webix_${inner ? \"l\" : \"e\"}_id=\"${id}\"]`\n\t\t\t\t),\n\t\t\t\tel => (inner ? el.firstElementChild : el)\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n}\n\nexport default function SelectionMixin(child, mode, inner) {\n\tchild._SelectionMode = mode;\n\n\tchild.Select = Select;\n\tchild.Unselect = Unselect;\n\tchild.HandleSelection = HandleSelection;\n\tchild.LocateSelected = locate(inner);\n\n\tchild.HandleSelection();\n}\n","export const Resizer = {\n\t$dragIn: function() {\n\t\tconst ctx = this.getContext();\n\n\t\tif (ctx.from.mode !== this.mode) return false;\n\t\treturn true;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\n\t\tconst box = webix.html.offset(ctx.target);\n\t\tlet y = pos.y - box.y;\n\n\t\tif (y < ctx.y_diff) y = ctx.y_diff;\n\t\telse if (y > box.height) y = box.height;\n\n\t\tconst height = y - ctx.y_diff;\n\t\tResizer.updateNodeHeight.call(this, height);\n\n\t\tif (ctx.duration !== height) {\n\t\t\tctx.duration = height;\n\t\t\tthis.updateText(ctx);\n\t\t}\n\n\t\tpos.x = ctx.x_diff;\n\t\tpos.y = ctx.y_diff;\n\t},\n\tupdateNodeHeight: function(height) {\n\t\tconst node = webix.DragControl.getNode();\n\t\tnode.style.height = Math.max(this.master.minEventHeight, height) + \"px\";\n\t},\n\tgetActualDate: function(master, any) {\n\t\tconst ctx = this.getContext();\n\n\t\tconst date = webix.Date.copy(ctx.event.start_date);\n\t\tconst minutes =\n\t\t\t(Math.round((ctx.duration * 60) / master.List.type.height / 5) || 1) * 5;\n\n\t\twebix.Date.add(date, minutes, \"minute\");\n\n\t\tif (!any && webix.Date.equal(date, ctx.event.end_date)) return null;\n\n\t\treturn {\n\t\t\tstart_date: webix.Date.copy(ctx.event.start_date),\n\t\t\tend_date: date,\n\t\t};\n\t},\n};\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nconst d = webix.Date;\r\nfunction addMinutes(date, inc) {\r\n\treturn d.add(date, inc * 1, \"minute\", true);\r\n}\r\n\r\nfunction addHours(date, inc) {\r\n\treturn d.add(date, inc * 1, \"hour\", true);\r\n}\r\n\r\nfunction addDays(date, inc) {\r\n\treturn d.add(date, inc * 1, \"day\", true);\r\n}\r\n\r\nfunction addWeeks(date, inc) {\r\n\treturn d.add(date, inc * 1, \"week\", true);\r\n}\r\n\r\nfunction addMonths(date, inc) {\r\n\treturn d.add(date, inc * 1, \"month\", true);\r\n}\r\n\r\nfunction addQuarters(date, inc) {\r\n\treturn d.add(date, inc * 3, \"month\", true);\r\n}\r\n\r\nfunction addYears(date, inc) {\r\n\treturn d.add(date, inc * 1, \"year\", true);\r\n}\r\n\r\nfunction differenceInYears(a, b) {\r\n\treturn a.getFullYear() - b.getFullYear();\r\n}\r\n\r\nfunction differenceInMonths(a, b) {\r\n\treturn (\r\n\t\t(a.getFullYear() - b.getFullYear()) * 12 + (a.getMonth() - b.getMonth())\r\n\t);\r\n}\r\n\r\nconst day_length = 86400000;\r\nfunction differenceInCalendarDays(a, b) {\r\n\ta = new Date(a);\r\n\ta.setHours(0, 0, 0, 0);\r\n\tb = new Date(b);\r\n\tb.setHours(0, 0, 0, 0);\r\n\r\n\treturn Math.round((a.getTime() - b.getTime()) / day_length);\r\n}\r\n\r\nfunction differenceInQuarters(a, b) {\r\n\treturn (\r\n\t\t(a.getFullYear() - b.getFullYear()) * 4 +\r\n\t\t(Math.floor(a.getMonth() / 3) + 1) -\r\n\t\t(Math.floor(b.getMonth() / 3) + 1)\r\n\t);\r\n}\r\n\r\nfunction differenceInWeeks(a, b) {\r\n\tconst diff = differenceInCalendarDays(a, b) / 7;\r\n\tconst end = getDay(a);\r\n\tconst start = getDay(b);\r\n\r\n\treturn Math.ceil(Math.abs(diff) - (end <= start ? 0 : 1)) * Math.sign(diff);\r\n}\r\n\r\nfunction differenceInHours(a, b) {\r\n\treturn differenceInCalendarDays(a, b) * 24 + (a.getHours() - b.getHours());\r\n}\r\n\r\nfunction differenceInMinutes(a, b) {\r\n\treturn differenceInHours(a, b) * 60 + (a.getMinutes() - b.getMinutes());\r\n}\r\n\r\nconst f_cache = {};\r\nfunction format(date, format) {\r\n\treturn formatFunction(format)(date);\r\n}\r\nfunction formatFunction(format) {\r\n\tlet cb = f_cache[format];\r\n\tif (!cb) {\r\n\t\tcb = f_cache[format] = d.dateToStr(format);\r\n\t}\r\n\r\n\treturn cb;\r\n}\r\n\r\nfunction getDay(date) {\r\n\tlet shift = date.getDay();\r\n\tif (d.startOnMonday) {\r\n\t\tif (shift === 0) shift = 6;\r\n\t\telse shift--;\r\n\t}\r\n\treturn shift;\r\n}\r\n\r\nfunction getDatePart(date) {\r\n\treturn d.datePart(date, true);\r\n}\r\n\r\nfunction getTimePart(date) {\r\n\treturn d.timePart(date);\r\n}\n\nconst diff = {\r\n\tyear: differenceInYears,\r\n\tquarter: differenceInQuarters,\r\n\tmonth: differenceInMonths,\r\n\tweek: differenceInWeeks,\r\n\tday: differenceInCalendarDays,\r\n\thour: differenceInHours,\r\n\tminute: differenceInMinutes,\r\n};\r\n\r\nfunction countDaysInMonth(sdate) {\r\n\tif (!sdate) return 30;\r\n\r\n\tconst m = sdate.getMonth();\r\n\r\n\tif (m === 1) {\r\n\t\tconst y = sdate.getFullYear();\r\n\t\tif (y % 4) return 28;\r\n\t\tif (y % 100) return 29;\r\n\t\tif (y % 400) return 28;\r\n\t\treturn 29;\r\n\t}\r\n\r\n\tif ((m % 2 && m < 7) || (!(m % 2) && m > 7)) {\r\n\t\treturn 30;\r\n\t}\r\n\r\n\treturn 31;\r\n}\r\n/**\r\n * Smaller units for task position and width for scales with precision setting:\r\n * the name of the unit and the number within a larger unit\r\n */\r\nconst smallerCount = {\r\n\tyear: [\"quarter\", 4],\r\n\tquarter: [\"month\", 3],\r\n\tmonth: [\"day\", countDaysInMonth],\r\n\tweek: [\"day\", 7],\r\n\tday: [\"hour\", 24],\r\n\thour: [\"minute\", 60],\r\n};\r\n\r\nconst add = {\r\n\tyear: addYears,\r\n\tquarter: addQuarters,\r\n\tmonth: addMonths,\r\n\tweek: addWeeks,\r\n\tday: addDays,\r\n\thour: addHours,\r\n\tminute: addMinutes,\r\n};\r\n\r\n/**\r\n * Calculates the difference between two dates in units\r\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\r\n * @param {Date} next - a later date\r\n * @param {Date} prev - an earlier date\r\n * @param {boolean} precise - current precision setting of the scales (if true, diff will be counted for smallerCount)\r\n * @param {boolean} wt - shows that diff will be counted for the width of a task\r\n * @returns {number} - an int (if precise is false) or a float number\r\n */\r\nfunction innerDiff(unit, next, prev, precise, wt) {\r\n\tconst minUnit = precise ? smallerCount[unit][0] : unit;\r\n\r\n\tlet start = prev;\r\n\tlet end = next;\r\n\tif (wt) {\r\n\t\tstart = getUnitStart(minUnit, prev);\r\n\t\tend = getUnitStart(minUnit, next);\r\n\t\tif (end < next) end = addUnit(minUnit)(end, 1);\r\n\t}\r\n\r\n\tif (precise) {\r\n\t\tlet filled = diff[minUnit](end, start);\r\n\t\tconst all = smallerCount[unit][1];\r\n\t\treturn filled / (typeof all === \"number\" ? all : all(prev));\r\n\t} else {\r\n\t\treturn diff[minUnit](end, start);\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns a function for calculating the difference between two dates in units\r\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\r\n * @returns {function} - details below\r\n */\r\nfunction getDiff(unit) {\r\n\t/**\r\n\t * the returned function calculates the difference between two dates based on passed parameters\r\n\t * @param {Date} next - first date\r\n\t * @param {Date} prev - second date\r\n\t * @param {boolean} precise false by default, true when used to count x-position\r\n\t * and width of tasks with 'step-1' precision\r\n\t * @param {boolean} wt - marker that diff is used to count width of a task;\r\n\t * if diff returns 0, you have to add 1; otherwise tasks that are within 1 unit will have 0 width\r\n\t * and will be displayed incorrectly\r\n\t * @returns {number} - the difference between two dates in 'units'; if 'precise' is true, the number is float, otherwise int\r\n\t */\r\n\treturn (next, prev, precise, wt) => {\r\n\t\tif (unit === \"month\" && precise) {\r\n\t\t\treturn getMonthDayDiff(next, prev, wt);\r\n\t\t} else {\r\n\t\t\treturn innerDiff(unit, next, prev, precise, wt);\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Calculates the difference in months between two days for a scale with precision setting\r\n * This is a specific case of diff counting, because a month can have 28-31 days\r\n * @param {Date} end - a later date\r\n * @param {Date} start - an earlier date\r\n * @param {Boolean} wt - shows that diff will be counted for the width of a task\r\n * @returns {number} - a float number\r\n */\r\nfunction getMonthDayDiff(end, start, wt) {\r\n\tif (sameMonth(start, end)) {\r\n\t\treturn innerDiff(\"month\", end, start, true, wt);\r\n\t}\r\n\r\n\t// if starts not on 1st day\r\n\tlet daysOfFirstMonth = 0;\r\n\tif (start.getDate() > 1) {\r\n\t\tconst me = new Date(start.getFullYear(), start.getMonth() + 1, 1);\r\n\t\tdaysOfFirstMonth = innerDiff(\"month\", me, start, true);\r\n\t\tstart = me;\r\n\t}\r\n\r\n\t// if lasts 1+ whole months\r\n\tlet months = 0;\r\n\tif (!sameMonth(start, end)) {\r\n\t\tmonths = innerDiff(\"month\", webix.Date.monthStart(end), start); // int part\r\n\t\tstart = webix.Date.add(start, months, \"month\", true);\r\n\t}\r\n\r\n\t// all above plus days of last month if any\r\n\treturn daysOfFirstMonth + months + innerDiff(\"month\", end, start, true);\r\n}\r\n\r\nfunction sameMonth(a, b) {\r\n\treturn webix.Date.equal(webix.Date.monthStart(a), webix.Date.monthStart(b));\r\n}\r\n\r\nfunction addUnit(unit) {\r\n\treturn add[unit];\r\n}\r\n\r\nfunction getUnitStart(unit, start) {\r\n\tlet t;\r\n\tswitch (unit) {\r\n\t\tcase \"year\":\r\n\t\t\treturn new Date(start.getFullYear(), 0, 1);\r\n\t\tcase \"quarter\":\r\n\t\t\treturn new Date(\r\n\t\t\t\tstart.getFullYear(),\r\n\t\t\t\tMath.floor(start.getMonth() / 3) * 3,\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\tcase \"month\":\r\n\t\t\treturn new Date(start.getFullYear(), start.getMonth(), 1);\r\n\t\tcase \"week\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setDate(start.getDate() - getDay(start));\r\n\t\t\treturn t;\r\n\t\tcase \"day\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setHours(0, 0, 0, 0);\r\n\t\t\treturn t;\r\n\t\tcase \"hour\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setHours(start.getHours(), 0, 0, 0);\r\n\t\t\treturn t;\r\n\t\tdefault:\r\n\t\t\treturn new Date(start);\r\n\t}\r\n}\n\nfunction getMinUnit(scales) {\r\n\tconst start = new Date();\r\n\treturn scales\r\n\t\t.map(item => ({ item, len: addUnit(item.unit)(start, 1) }))\r\n\t\t.sort((a, b) => (a.len < b.len ? -1 : 1))[0].item.unit;\r\n}\r\n\r\n/**\r\n * Resets scales to new parameters and returns the object that stores related constants and functions\r\n * @param {Date} start - start date\r\n * @param {Date} end - end date\r\n * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\r\n * @param {number} width - width of smallest cell unit\r\n * @param {number} height - height of scale cell\r\n * @param {Array} scales - a set of scales (objects)\r\n * @param {function} isHoliday - the function that checks if a day is a holiday\r\n * @returns {Object} scales\r\n */\r\nfunction resetScales(\r\n\tstart,\r\n\tend,\r\n\tprecise,\r\n\twidth,\r\n\theight,\r\n\tscales,\r\n\tisHoliday\r\n) {\r\n\t// console.log(\"[x] reset scales\");\r\n\r\n\tconst minUnit = getMinUnit(scales);\r\n\tconst diff = getDiff(minUnit);\r\n\r\n\tconst tempEnd = getUnitStart(minUnit, end);\r\n\tstart = getUnitStart(minUnit, start);\r\n\tend = tempEnd < end ? addUnit(minUnit)(tempEnd, 1) : tempEnd;\r\n\r\n\tconst fullWidth = diff(end, start) * width;\r\n\tconst fullHeight = height * scales.length;\r\n\r\n\tconst rows = scales.map(line => {\r\n\t\tconst cells = [];\r\n\t\tconst add = addUnit(line.unit);\r\n\t\tconst step = line.step || 1;\r\n\t\tconst countInWeeks = minUnit === \"week\" && line.unit !== \"week\";\r\n\r\n\t\tlet date = getUnitStart(line.unit, start);\r\n\t\twhile (date < end) {\r\n\t\t\tlet next = add(date, step);\r\n\r\n\t\t\tif (date < start) date = start;\r\n\t\t\tif (next > end) next = end;\r\n\r\n\t\t\t/**\r\n\t\t\t * Special handling for counting width of greater units in weeks\r\n\t\t\t * this code decides whether a week belongs to the current greater unit based on weekdays of this unit boundaries\r\n\t\t\t * if start day is Thursday+, then this greater unit should not count this week as its own\r\n\t\t\t * if end day is Thursday+, then this greater unit should count this week as its own\r\n\t\t\t */\r\n\t\t\tlet cdate = date;\r\n\t\t\tlet cnext = next;\r\n\t\t\tif (countInWeeks) {\r\n\t\t\t\tif (getDay(date) > 3) {\r\n\t\t\t\t\tcdate = webix.Date.add(date, 1, \"week\", true);\r\n\t\t\t\t}\r\n\t\t\t\tif (getDay(next) > 3) {\r\n\t\t\t\t\tcnext = webix.Date.add(next, 1, \"week\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst cellWidth = (diff(cnext, cdate) || 1) * width;\r\n\r\n\t\t\t/*[ToDo] suggestion\r\n\t\t\t value must not be formatted within engine as it depends on app locale\r\n\t\t\t use scales.format function to format dates in UI\r\n\t\t\t*/\r\n\r\n\t\t\tconst value =\r\n\t\t\t\ttypeof line.format === \"function\"\r\n\t\t\t\t\t? line.format(date, next)\r\n\t\t\t\t\t: format(date, line.format);\r\n\r\n\t\t\tlet css = \"\";\r\n\t\t\tif (line.css)\r\n\t\t\t\tcss += typeof line.css === \"function\" ? line.css(date) : line.css;\r\n\r\n\t\t\tcells.push({\r\n\t\t\t\twidth: cellWidth,\r\n\t\t\t\tvalue,\r\n\t\t\t\tcss,\r\n\t\t\t\tdate,\r\n\t\t\t\tformat: formatFunction(line.format),\r\n\t\t\t});\r\n\r\n\t\t\tdate = next;\r\n\t\t}\r\n\r\n\t\treturn { cells, add, height, type: line.unit, step: line.step || 1 };\r\n\t});\r\n\r\n\tprecise = !!(minUnit === \"day\" ? precise : precise != false);\r\n\r\n\treturn {\r\n\t\trows,\r\n\t\twidth: fullWidth,\r\n\t\theight: fullHeight,\r\n\t\tcellWidth: width,\r\n\t\tcellHeight: height,\r\n\t\tdiff,\r\n\t\tstart,\r\n\t\tend,\r\n\t\tminUnit,\r\n\t\tprecise,\r\n\t\tisHoliday,\r\n\t};\r\n}\r\n\r\nfunction grid(width, height, color) {\r\n\tconst canvas = document.createElement(\"canvas\");\r\n\tcanvas.setAttribute(\"width\", width);\r\n\tcanvas.setAttribute(\"height\", height);\r\n\r\n\tconst ctx = canvas.getContext(\"2d\");\r\n\tctx.strokeStyle = color;\r\n\tctx.moveTo(0, height);\r\n\tctx.lineTo(width, height);\r\n\tctx.lineTo(width, 0);\r\n\tctx.stroke();\r\n\r\n\treturn canvas.toDataURL();\r\n}\n\n/**\r\n * Prepares dimensional coordinates for a task\r\n * @param {Object} task - task data object\r\n * @param {number} i - the index of the task\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {number} taskHeight - the height of a task bar\r\n * @param {number} y - the top position of a task after which the current task will be placed (timeline mode)\r\n * @returns {Object} task data object\r\n */\r\nfunction updateTask(task, i, scales, taskHeight, y) {\r\n\tif (task.type === \"split\" && task.$data && task.$data.length) {\r\n\t\ttask.$data.forEach(k => getSizes(k, i, scales, taskHeight));\r\n\t} else {\r\n\t\tgetSizes(task, i, scales, taskHeight, y);\r\n\t}\r\n\treturn task;\r\n}\r\n\r\nfunction getSizes(task, i, scales, taskHeight, y) {\r\n\tconst { start, end, cellWidth, cellHeight, diff, minUnit, precise } = scales;\r\n\tconst startDate = task.start_date < start ? start : task.start_date;\r\n\tconst endDate = task.end_date > end ? end : task.end_date;\r\n\tconst astart = getUnitStart(minUnit, start);\r\n\r\n\tconst ms = task.type == \"milestone\";\r\n\ttask.$h = taskHeight;\r\n\ttask.$x =\r\n\t\tMath.round(diff(startDate, astart, precise) * cellWidth) -\r\n\t\t(ms ? task.$h / 2 : 0);\r\n\ttask.$w = ms\r\n\t\t? task.$h\r\n\t\t: Math.round(diff(endDate, startDate, precise, true) * cellWidth);\r\n\ttask.$y = webix.isUndefined(y)\r\n\t\t? cellHeight * i + (cellHeight - taskHeight) / 2\r\n\t\t: y;\r\n}\r\n\r\n/**\r\n * Updates start, end and duration fields of tasks during initial loading and updating\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - (optional) the data for current scales; the return value of resetScales()\r\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\r\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\r\n */\r\nfunction updateTaskDuration(task, scales, mode, dir) {\r\n\tif (\r\n\t\ttask.start_date &&\r\n\t\ttask.end_date &&\r\n\t\ttask.start_date.valueOf() >= task.end_date.valueOf()\r\n\t) {\r\n\t\ttask.end_date = null;\r\n\t\ttask.duration = 1;\r\n\r\n\t\tif (mode) mode = \"move\";\r\n\t}\r\n\r\n\tif (scales) {\r\n\t\texcludeHolidays(task, scales, mode, dir);\r\n\t} else {\r\n\t\tif (task.type == \"milestone\") {\r\n\t\t\tgetMilestone(task);\r\n\t\t} else {\r\n\t\t\tif (!task.duration) {\r\n\t\t\t\ttask.duration = getDuration(task);\r\n\t\t\t}\r\n\t\t\tif (!task.end_date) {\r\n\t\t\t\ttask.end_date = getEnd(task);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Excludes holidays from start, end and duration of tasks (can't start or end on a holiday)\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\r\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\r\n */\r\nfunction excludeHolidays(task, scales, mode, dir) {\r\n\tif (task.type == \"milestone\") {\r\n\t\ttask.start_date = mode\r\n\t\t\t? toWorkday(task.start_date, false, scales, dir)\r\n\t\t\t: toClosestWorkday(task.start_date, scales); //on load\r\n\t\treturn getMilestone(task);\r\n\t}\r\n\r\n\tif (!mode) {\r\n\t\t//on load\r\n\t\ttask.start_date = toClosestWorkday(task.start_date, scales);\r\n\t\ttask.end_date = getEndWorkday(task, scales);\r\n\t\ttask.duration = getDuration(task, scales);\r\n\t} else {\r\n\t\tif (mode == \"start\" || mode == \"move\") {\r\n\t\t\ttask.start_date = toWorkday(task.start_date, false, scales, dir);\r\n\t\t\tif (!task.duration) task.duration = getDuration(task, scales);\r\n\t\t\tif (!task.end_date) task.end_date = getEndWorkday(task, scales);\r\n\t\t} else {\r\n\t\t\t//end, duration\r\n\t\t\tif (!task.end_date) task.end_date = getEndWorkday(task, scales);\r\n\t\t\tif (!task.duration) {\r\n\t\t\t\ttask.end_date = toWorkday(task.end_date, true, scales, dir);\r\n\t\t\t\ttask.duration = getDuration(task, scales);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getMilestone(task) {\r\n\ttask.duration = 0;\r\n\ttask.end_date = task.start_date;\r\n}\r\n\r\n/**\r\n * Returns the end date of a task\r\n * @param {Object} task - task data object\r\n */\r\nfunction getEnd(task) {\r\n\tif (task.duration < 1)\r\n\t\treturn addUnit(\"hour\")(task.start_date, Math.floor(24 * task.duration));\r\n\telse return addUnit(\"day\")(task.start_date, task.duration);\r\n}\r\n\r\n/**\r\n * Returns end date excluding holidays from duration\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {Date} end date\r\n */\r\nfunction getEndWorkday(task, scales) {\r\n\tif (task.duration < 1) return getEnd(task);\r\n\r\n\tlet date = getDatePart(task.start_date);\r\n\tfor (let w = 0, d = 0; w < task.duration; ) {\r\n\t\tif (!scales.isHoliday(date)) {\r\n\t\t\t++w;\r\n\t\t\td = 0;\r\n\t\t} else {\r\n\t\t\tif (++d === 30) holidayGuard();\r\n\t\t}\r\n\r\n\t\tdate = addDays(date, 1);\r\n\t}\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Calculates the duration of a task\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {number} task duration\r\n */\r\nfunction getDuration(task, scales) {\r\n\tconst d = getDiff(\"day\")(task.end_date, task.start_date, true);\r\n\t// allow float duration for tasks smaller than day\r\n\tif (d < 1) return parseFloat(d.toFixed(2));\r\n\r\n\tif (!scales) return Math.floor(d);\r\n\r\n\tlet date = task.start_date;\r\n\tlet duration = 0;\r\n\twhile (date < task.end_date) {\r\n\t\tif (!scales.isHoliday(date)) ++duration;\r\n\t\tdate = addDays(date, 1);\r\n\t}\r\n\treturn duration;\r\n}\r\n\r\n/**\r\n * Moves a date from a holiday to the closest working day (priority to the future)\r\n * @param {Date} date - original date\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {Date} the date of a closest work day\r\n */\r\nfunction toClosestWorkday(date, scales) {\r\n\tlet left = date;\r\n\tlet right = date;\r\n\tlet notRight;\r\n\tlet d = 0;\r\n\r\n\twhile (\r\n\t\td < 30 &&\r\n\t\t(notRight = scales.isHoliday(right)) &&\r\n\t\tscales.isHoliday(left)\r\n\t) {\r\n\t\tleft = addDays(left, -1);\r\n\t\tright = addDays(right, 1);\r\n\t\td++;\r\n\t}\r\n\tif (d === 30) holidayGuard();\r\n\r\n\treturn !notRight ? right : left;\r\n}\r\n\r\nfunction holidayGuard() {\r\n\talert(\r\n\t\t\"No work days found within 30 days, check your isHoliday function!\",\r\n\t\t\"error\"\r\n\t);\r\n\tthrow \"Wrong isHoliday function\";\r\n}\r\n\r\n/**\r\n * Moves a date from a holiday to a working day in the given direction\r\n * @param {Date} date - the current date\r\n * @param {Boolean} end - indicates if this is the end of a task\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {number} dir - the direction in which nearest workday will be located; -1 is the past, 1 is the future\r\n * @returns {Date} the date of a working day\r\n */\r\nfunction toWorkday(date, end, scales, dir) {\r\n\tlet d = 0;\r\n\r\n\twhile (d < 30 && scales.isHoliday(getCheckDate(date, end))) {\r\n\t\tdate = addDays(date, dir);\r\n\t\td++;\r\n\t}\r\n\r\n\tif (d === 30) holidayGuard();\r\n\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Returns the date for a holiday check\r\n * @param {Date} date - the date\r\n * @param {Boolean} end - if true, means it's the end date (end dates are exclusive)\r\n * @returns {Date} the date that will be used for a check\r\n */\r\nfunction getCheckDate(date, end) {\r\n\treturn end && !getTimePart(date) ? addDays(date, -1) : date;\r\n}\n\nconst delta = 20;\r\n\r\nconst updateLink = function(link, startTask, endTask, height) {\r\n\tconst dy = Math.round(height / 2);\r\n\tif (!startTask || !endTask) {\r\n\t\tlink.$p = \"\";\r\n\t\treturn link;\r\n\t}\r\n\r\n\tlet sx, sy, ex, ey;\r\n\tlet s_start = false;\r\n\tlet e_start = false;\r\n\r\n\tswitch (link.type) {\r\n\t\tcase 0:\r\n\t\t\te_start = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 1:\r\n\t\t\ts_start = true;\r\n\t\t\te_start = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 3:\r\n\t\t\ts_start = true;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tsx = s_start ? startTask.$x : startTask.$x + startTask.$w;\r\n\tsy = startTask.$y;\r\n\tex = e_start ? endTask.$x : endTask.$x + endTask.$w;\r\n\tey = endTask.$y;\r\n\r\n\tif (differentX(startTask, endTask, sx, ex, height) || sy !== ey) {\r\n\t\tconst lineCoords = getLineCoords(\r\n\t\t\tsx,\r\n\t\t\tsy + dy,\r\n\t\t\tex,\r\n\t\t\tey + dy,\r\n\t\t\ts_start,\r\n\t\t\te_start,\r\n\t\t\t38 / 2\r\n\t\t);\r\n\r\n\t\tconst arrowCoords = getArrowCoords(ex, ey + dy, e_start);\r\n\t\tlink.$p = `${lineCoords},${arrowCoords}`;\r\n\t} else {\r\n\t\tlink.$p = \"\";\r\n\t}\r\n\r\n\treturn link;\r\n};\r\n\r\nfunction differentX(startTask, endTask, sx, ex, height) {\r\n\treturn startTask.type === \"milestone\" || endTask.type === \"milestone\"\r\n\t\t? Math.abs(sx - ex) > height / 2\r\n\t\t: sx !== ex;\r\n}\r\n\r\nfunction getLineCoords(sx, sy, ex, ey, s_start, e_start, gapp) {\r\n\tconst shift = delta * (s_start ? -1 : 1);\r\n\tconst backshift = delta * (e_start ? -1 : 1);\r\n\r\n\tconst sx1 = sx + shift;\r\n\tconst ex1 = ex + backshift;\r\n\tconst line = [sx, sy, sx1, sy, 0, 0, 0, 0, ex1, ey, ex, ey];\r\n\r\n\tconst dx = ex1 - sx1;\r\n\tlet dy = ey - sy;\r\n\r\n\tconst same = e_start === s_start;\r\n\tif (!same && ((ex1 <= sx && e_start) || (ex1 > sx && !e_start))) {\r\n\t\tdy -= gapp;\r\n\t}\r\n\r\n\tif ((same && e_start && sx1 > ex1) || (same && !e_start && sx1 < ex1)) {\r\n\t\tline[4] = line[2] + dx;\r\n\t\tline[5] = line[3];\r\n\t\tline[6] = line[4];\r\n\t\tline[7] = line[5] + dy;\r\n\t} else {\r\n\t\tline[4] = line[2];\r\n\t\tline[5] = line[3] + dy;\r\n\t\tline[6] = line[4] + dx;\r\n\t\tline[7] = line[5];\r\n\t}\r\n\r\n\treturn line.join(\",\");\r\n}\r\n\r\nfunction getArrowCoords(x, y, start) {\r\n\tif (start) {\r\n\t\treturn `${x - 5},${y - 3},${x - 5},${y + 3},${x},${y}`;\r\n\t} else {\r\n\t\treturn `${x + 5},${y + 3},${x + 5},${y - 3},${x},${y}`;\r\n\t}\r\n}\r\n\r\nfunction newLink(box, start, end) {\r\n\tif (start && end) {\r\n\t\tconst width = end.x - start.x;\r\n\t\tconst height = end.y - start.y;\r\n\t\tconst left = (width > 0 ? start.x : end.x) - box.left;\r\n\t\tconst top = (height > 0 ? start.y : end.y) - box.top;\r\n\t\tconst p = `${width > 0 ? 0 : -width},${height > 0 ? 0 : -height},${\r\n\t\t\twidth > 0 ? width : 0\r\n\t\t},${height > 0 ? height : 0}`;\r\n\t\treturn { width: Math.abs(width), height: Math.abs(height), left, top, p };\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\n\nexports.addUnit = addUnit;\nexports.getDiff = getDiff;\nexports.getUnitStart = getUnitStart;\nexports.grid = grid;\nexports.newLink = newLink;\nexports.resetScales = resetScales;\nexports.smallerCount = smallerCount;\nexports.updateLink = updateLink;\nexports.updateTask = updateTask;\nexports.updateTaskDuration = updateTaskDuration;\n//# sourceMappingURL=wgantt.js.map\n","import HourscaleView from \"../common/hourscale\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { shrinkTo, isToday } from \"helpers/dates\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class DayEventsView extends HourscaleView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\t// when dayevents is a part of week\n\t\tif (config) {\n\t\t\tthis.WeekDayNum = config.day;\n\t\t}\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"dayList\",\n\t\t\tcss: \"webix_scheduler_day_events\",\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\ttemplate: \"\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\tcss: \"webix_scheduler_day_scale_item\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_day_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_scheduler_day_scale_item: (_e, h) => this.ShowNew(h),\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"dayList\");\n\n\t\tSelectionMixin(this, \"scale\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.List.$setSize = function(x, y) {\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\tthis.minEventHeight = 62;\n\t\tthis.ParseHours();\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.List.render());\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"day\");\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.Day = webix.Date.datePart(this.State.date, true);\n\n\t\t\tif (this.WeekDayNum > -1) {\n\t\t\t\tconst weekStart = this.data.start;\n\t\t\t\tthis.Day = webix.Date.add(weekStart, this.WeekDayNum, \"day\", true);\n\t\t\t}\n\n\t\t\tconst to = webix.Date.add(this.Day, 1, \"day\", true);\n\t\t\tthis.Events = this.FilterToday(this.Day, to);\n\n\t\t\tif (this._marker_update_interval)\n\t\t\t\tthis._marker_update_interval = clearInterval(\n\t\t\t\t\tthis._marker_update_interval\n\t\t\t\t);\n\n\t\t\tif (isToday(this.Day))\n\t\t\t\tthis._marker_update_interval = setInterval(() => {\n\t\t\t\t\tif (isToday(this.Day)) this.UpdateMarkerPosition();\n\t\t\t\t\telse {\n\t\t\t\t\t\twebix.html.remove(this._Marker);\n\t\t\t\t\t\tthis._Marker = this._marker_update_interval = clearInterval(\n\t\t\t\t\t\t\tthis._marker_update_interval\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, 5 * 60 * 1000); // 5 minutes\n\n\t\t\tthis.List.render();\n\t\t}\n\t}\n\n\tGetEvent(id) {\n\t\tfor (let i = 0; i < this.Events.length; i++)\n\t\t\tif (this.Events[i].id == id) return this.Events[i];\n\t\treturn null;\n\t}\n\n\tFilterToday(value, to) {\n\t\tif (this.WeekDayNum > -1) {\n\t\t\treturn this.data.single.filter(ev => {\n\t\t\t\treturn ev.start_date < to && ev.end_date > value;\n\t\t\t});\n\t\t}\n\t\treturn this.data.single;\n\t}\n\n\tMarkToday() {\n\t\tif (this.Day && isToday(this.Day)) {\n\t\t\tconst marker = webix.html.create(\"div\", {\n\t\t\t\tclass: \"webix_scheduler_today_marker\",\n\t\t\t});\n\t\t\tthis._Marker = this.List.$view.firstChild.appendChild(marker);\n\t\t\tthis.UpdateMarkerPosition();\n\t\t} else {\n\t\t\tthis._Marker = null;\n\t\t}\n\t}\n\n\tUpdateMarkerPosition() {\n\t\tif (this._Marker) {\n\t\t\tconst current = new Date();\n\t\t\tconst time = current.getHours() * 60 + current.getMinutes();\n\t\t\tthis._Marker.style.top =\n\t\t\t\tMath.round((time * this.List.type.height) / 60) + \"px\";\n\t\t}\n\t}\n\n\tRenderEvents() {\n\t\tconst evs = this.Events;\n\t\tif (evs && evs.length) {\n\t\t\tthis.PrepareEvents();\n\t\t\tconst container = webix.html.create(\"div\", {\n\t\t\t\trole: \"presentation\",\n\t\t\t});\n\t\t\tcontainer.innerHTML = evs.map(i => this.ToHTML(i)).join(\"\");\n\t\t\tthis._DataObj = this.List.$view.firstChild.appendChild(container);\n\t\t\tthis.app.callEvent(\"events:rendered\", []);\n\t\t}\n\t\tthis.MarkToday();\n\t}\n\n\tPrepareEvents() {\n\t\tconst evs = this.Events;\n\t\tlet stack = [];\n\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tconst ev = evs[i];\n\t\t\tev.$inner = false;\n\n\t\t\tlet orderSet = this.PruneStack(ev, stack);\n\n\t\t\tif (stack.length) {\n\t\t\t\tstack[stack.length - 1].$inner = true;\n\t\t\t}\n\n\t\t\tif (!orderSet) {\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tev.$sorder = stack[stack.length - 1].$sorder + 1;\n\t\t\t\t\tev.$inner = false;\n\t\t\t\t} else {\n\t\t\t\t\tev.$sorder = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// insert new event into stack\n\t\t\tstack.splice(ev.$sorder, 0, ev);\n\t\t\tif (stack.length > (stack.max_count || 0)) {\n\t\t\t\tstack.max_count = stack.length;\n\t\t\t}\n\t\t}\n\n\t\tthis.SetPosition(stack, evs);\n\t}\n\n\t// returns true if new event was marked for inserting;\n\t// false if stack is empty or there is no suitable place for new event inside\n\tPruneStack(newEvent, stack) {\n\t\t// clean events from top of stack if new event starts after they end\n\t\twhile (\n\t\t\tstack.length &&\n\t\t\tthis.GetEventEndDate(stack[stack.length - 1]) <= newEvent.start_date\n\t\t) {\n\t\t\tstack.splice(stack.length - 1, 1);\n\t\t}\n\n\t\t// clean 1 event from within remaining stack if this event ends before new event starts\n\t\tfor (let j = 0; j < stack.length; j++) {\n\t\t\tif (this.GetEventEndDate(stack[j]) <= newEvent.start_date) {\n\t\t\t\tnewEvent.$sorder = stack[j].$sorder; // mark new event for this place in stack\n\t\t\t\tstack.splice(j, 1);\n\t\t\t\tnewEvent.$inner = true;\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tSetPosition(stack, evs) {\n\t\t//scale start correction\n\t\tconst delta = this.List.getFirstId() * this.List.type.height;\n\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tconst ev = evs[i];\n\n\t\t\tev.$count = stack.max_count;\n\t\t\tlet temp_width = Math.floor(this.List.$width / ev.$count);\n\t\t\tev.$left = ev.$sorder * temp_width;\n\t\t\tif (!ev.$inner) temp_width = temp_width * (ev.$count - ev.$sorder);\n\t\t\tev.$width = temp_width - 8;\n\n\t\t\tconst evCorrectedCopy = shrinkTo(\n\t\t\t\tthis.Day,\n\t\t\t\twebix.Date.add(this.Day, 1, \"day\", true)\n\t\t\t)(ev);\n\t\t\tconst sm =\n\t\t\t\tevCorrectedCopy.start_date.getHours() * 60 +\n\t\t\t\tevCorrectedCopy.start_date.getMinutes();\n\t\t\tconst em =\n\t\t\t\tevCorrectedCopy.end_date.getHours() * 60 +\n\t\t\t\t\tevCorrectedCopy.end_date.getMinutes() || 24 * 60;\n\n\t\t\tev.$top = Math.round((sm * this.List.type.height) / 60) - delta;\n\t\t\tev.$height = Math.max(\n\t\t\t\tthis.minEventHeight,\n\t\t\t\t((em - sm) * this.List.type.height) / 60\n\t\t\t);\n\t\t}\n\t}\n\n\tToHTML(obj) {\n\t\tconst content = this.EventTemplate(obj);\n\t\treturn this.EventTemplateStart(obj) + content + \"</div>\";\n\t}\n\n\tGetEventEndDate(ev) {\n\t\tlet end_date = ev.end_date;\n\t\tconst duration =\n\t\t\t(((ev.end_date - ev.start_date) / 60000) * this.List.type.height) / 60;\n\n\t\tif (duration < this.minEventHeight) {\n\t\t\tend_date = webix.Date.add(\n\t\t\t\tev.start_date,\n\t\t\t\tMath.ceil((this.minEventHeight / this.List.type.height) * 60),\n\t\t\t\t\"minute\",\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t\treturn end_date;\n\t}\n\n\tEventTemplateStart(obj) {\n\t\tconst css = `class=\"webix_scheduler_day_event ${\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \"webix_scheduler_event_selected\"\n\t\t\t\t: \"\"\n\t\t} ${obj.$past ? \"webix_scheduler_past_event\" : \"\"}\"`;\n\n\t\treturn `<div webix_e_id='${obj.id}' ${css} style='left:${\n\t\t\tobj.$left\n\t\t}px; top:${obj.$top}px; width:${obj.$width}px; height:${\n\t\t\tobj.$height\n\t\t}px; ${dayEventColor(obj)}'>`;\n\t}\n\n\tEventTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst resizer = this.State.readonly\n\t\t\t? \"\"\n\t\t\t: \"<div class='webix_icon webix_scheduler_resizer' webix_resizer='true'></div>\";\n\n\t\treturn `<div class=\"webix_scheduler_inner_day\"><span class=\"webix_scheduler_event_name\">${obj.text ||\n\t\t\t_(\n\t\t\t\t\"(No title)\"\n\t\t\t)}</span><div class=\"webix_scheduler_event_time\">${webix.i18n.timeFormatStr(\n\t\t\tobj.start_date\n\t\t)} - ${webix.i18n.timeFormatStr(obj.end_date)}</div></div>${resizer}`;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.List.$view);\n\t\tif (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.GetEvent(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} h - the ID of the hour segment of the main view\n\t * @returns {Date}\n\t */\n\tGetTargetDate(h) {\n\t\tconst date = webix.Date.copy(this.Day || this.State.date);\n\t\tif (h) date.setHours(h);\n\t\treturn date;\n\t}\n\n\t/**\n\t * Sets selected in the global reactive state to display a newly created event\n\t * @param {(string|number)} h - the ID of the hour segment of the main view\n\t */\n\tShowNew(h) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tstate.selected = { id: \"0\", date: this.GetTargetDate(h) };\n\t\t}\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of the event\n\t * @param {Object} newEvent - the data of the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport SelectionMixin from \"helpers/selection\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class MultidayEventList extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.cols[1] = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tautoheight: true,\n\t\t\tscroll: false,\n\t\t\tcss: \"webix_scheduler_multilist\",\n\t\t\ttype: {\n\t\t\t\theight: 36,\n\t\t\t\ttemplate: (obj, common) => this.EventTemplate(obj, common),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: (e, id, node) =>\n\t\t\t\t\tthis.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tsuper.init();\n\n\t\tthis._DataObj = this.List.$view.firstChild;\n\t\tSelectionMixin(this, \"multi\", true);\n\n\t\tthis.MoreIcon = this.$$(\"more\");\n\t\tthis._moreBtn = {\n\t\t\tid: \"$wsh_multi_more\",\n\t\t\t$css: \"webix_scheduler_multi_more\",\n\t\t};\n\n\t\tthis.on(this.$$(\"multiDayList\"), \"onAfterRender\", () => {\n\t\t\tthis.app.callEvent(\"events:rendered\", []);\n\t\t});\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile) {\n\t\t\tEditRecurringMixin(this);\n\t\t\tCopyPasteMixin(this, this.List, { multi: true });\n\t\t}\n\t}\n\n\turlChange() {\n\t\tconst data = this.getParam(\"data\");\n\t\tif (data) {\n\t\t\tthis.LimitData(data.multi);\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(data.multi);\n\t\t}\n\t}\n\n\tEventTemplate(obj, common) {\n\t\tconst height = common.height - 8;\n\t\tconst size = `height:${height}px; line-height:${height}px; width:calc(100% - 5px);`;\n\t\tconst color = obj.id !== \"$wsh_multi_more\" ? dayEventColor(obj) : \"\";\n\t\tconst css = this.GetStyle(obj);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${color}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj) {\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tif (obj.id == \"$wsh_multi_more\") return css;\n\n\t\tconst date = this.State.date;\n\t\tconst end =\n\t\t\t!obj.all_day && !webix.Date.timePart(obj.end_date)\n\t\t\t\t? webix.Date.add(obj.end_date, -1, \"day\", true)\n\t\t\t\t: obj.end_date;\n\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (obj.start_date < date) css += \" webix_scheduler_event_break_left\";\n\t\tif (end >= webix.Date.add(date, 1, \"day\", true))\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\treturn css;\n\t}\n\n\tLimitData(data) {\n\t\tif (data.length > this.maxVisibleLines) {\n\t\t\tconst excess = data.length - 2;\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis._moreBtn.text = `${excess} ${_(\"more\")}`;\n\n\t\t\tif (this._expandState === \"down\") {\n\t\t\t\tthis._reserve = data.splice(2, excess, this._moreBtn);\n\t\t\t} else {\n\t\t\t\tthis._reserve = data.slice(2);\n\t\t\t}\n\n\t\t\tthis.SetMoreIcon(this._expandState);\n\t\t\tthis._reserveIds = this._reserve.map(d => d.id);\n\t\t} else {\n\t\t\tthis.SetMoreIcon();\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tconst height =\n\t\t\t\tthis.List.$height -\n\t\t\t\t(this._reserveIds.length - 1) * this.List.type.height;\n\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\tthis.List.add(this._moreBtn);\n\t\t\t\tthis.List.remove(this._reserveIds);\n\t\t\t});\n\t\t}\n\t}\n\n\tExpandData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"up\";\n\n\t\t\tthis.Animate(\"up\");\n\n\t\t\tthis.List.remove(\"$wsh_multi_more\");\n\t\t\tthis.List.parse(this._reserve);\n\t\t}\n\t}\n\n\t// height change and delay for animation\n\tAnimate(mode, height, handler) {\n\t\tthis.List.$view.style.transition = \"height 150ms\";\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, 150);\n\t}\n\n\tSetMoreIcon(mode) {\n\t\tif (!mode) {\n\t\t\tthis.MoreIcon.setHTML(\"\");\n\t\t} else {\n\t\t\tthis._expandState = mode;\n\n\t\t\tconst tooltip = mode === \"up\" ? \"Collapse\" : \"Expand\";\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.MoreIcon.setHTML(\n\t\t\t\t`<div class=\"webix_scheduler_more_icon webix_icon wxi-angle-${mode}\" webix_tooltip=\"${_(\n\t\t\t\t\t`${tooltip} all-day events`\n\t\t\t\t)}\"><div>`\n\t\t\t);\n\t\t}\n\t}\n\n\tShowEvent(id, node) {\n\t\tif (id === \"$wsh_multi_more\") {\n\t\t\tthis.ExpandData();\n\t\t} else {\n\t\t\tconst obj = this.List.getItem(id);\n\t\t\tconst sel = getParams(obj);\n\t\t\tsel.node = node;\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the data object of an event\n\t * @param {(string|number)} id\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.List.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\treturn this.State.date;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MultidayEventList from \"./multiday\";\nimport DayEventsView from \"./events\";\nimport HourscaleView from \"../common/hourscale\";\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class DayView extends JetView {\n\tconfig() {\n\t\tconst header = {\n\t\t\tview: \"template\",\n\t\t\tlocalId: \"header\",\n\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\theight: 32,\n\t\t\ttemplate: obj => {\n\t\t\t\treturn obj.date ? webix.Date.dateToStr(\"%l\")(obj.date) : \"\";\n\t\t\t},\n\t\t};\n\n\t\tconst config = {\n\t\t\tcss: \"webix_scheduler_day\",\n\t\t\trows: [\n\t\t\t\theader,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"multi\",\n\t\t\t\t\thidden: true,\n\t\t\t\t\tcols: [MultidayEventList],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"scroll\",\n\t\t\t\t\tview: \"scrollview\",\n\t\t\t\t\tcss: \"webix_scheduler_day_scroll\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcols: [HourscaleView, DayEventsView],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tconst state = this.app.getState();\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\n\t\tthis.on(state.$changes, \"selected\", v => {\n\t\t\tif (v && !state.clipboard) this.ScrollScale(v);\n\t\t});\n\t}\n\n\tRefreshData(value) {\n\t\tthis.$$(\"header\").setValues({ date: value });\n\n\t\tthis.GetDay(value).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetDay(date) {\n\t\tconst end = webix.Date.add(date, 1, \"day\", true);\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(date, end)\n\t\t\t.then(evs => {\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { multi, single };\n\t\t\t});\n\t}\n\n\tScrollScale(v) {\n\t\tif (v.id === \"0\" && !v.date) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst y = (new Date().getHours() + 2) * 40;\n\t\t\t\tthis.$$(\"scroll\").scrollTo(0, y);\n\t\t\t}, 100);\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class CalendarView extends JetView {\n\tconfig() {\n\t\tthis.Events = {};\n\n\t\treturn {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\tevents: (day, isOutside) => this.MarkEvent(day, isOutside),\n\t\t\ticons: false,\n\t\t\tnavigation: false,\n\t\t\tmonthHeader: false,\n\t\t\tskipEmptyWeeks: true,\n\t\t\twidth: 0,\n\t\t\theight: 410,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Calendar = this.getRoot();\n\t\tthis.Calendar.attachEvent(\"onAfterDateSelect\", date => {\n\t\t\tthis.app.getState().date = webix.Date.dayStart(date);\n\t\t});\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tRefreshData() {\n\t\tlet { start, weeks, data } = this.data;\n\t\tconst end = webix.Date.add(start, weeks, \"week\", true);\n\n\t\tthis.Events = {};\n\n\t\twhile (start < end) {\n\t\t\tconst next = webix.Date.add(start, 1, \"day\", true);\n\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t\tif (\n\t\t\t\t\t(data[i].all_day\n\t\t\t\t\t\t? data[i].end_date >= start\n\t\t\t\t\t\t: data[i].end_date > start) &&\n\t\t\t\t\tdata[i].start_date < next\n\t\t\t\t)\n\t\t\t\t\tthis.Events[start.valueOf()] = true;\n\t\t\tstart = next;\n\t\t}\n\n\t\tthis.Calendar.setValue(this.app.getState().date);\n\t}\n\n\t// adds dots to days with events\n\tMarkEvent(day, isOutside) {\n\t\tlet css = \"\";\n\n\t\tif (!isOutside) css += webix.Date.isHoliday(day) || \"\";\n\t\tif (this.Events[day.valueOf()]) css += \" webix_cal_day_with_event\";\n\n\t\treturn css;\n\t}\n}\n","/* eslint-disable indent */\n\nimport { JetView } from \"webix-jet\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { daysBetweenInclusive } from \"helpers/dates\";\nimport { marker, dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport { initDnD } from \"helpers/dnd\";\n\nexport default class MoreWindowView extends JetView {\n\tconstructor(app, c) {\n\t\tsuper(app);\n\t\tthis.Events = c.events;\n\t\tthis.drag = webix.isUndefined(c.drag) ? true : c.drag;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\twidth: 266,\n\t\t\tpadding: 8,\n\t\t\tminHeight: 70,\n\t\t\trelative: \"right\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_scheduler_more_list\",\n\t\t\t\tborderless: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tyCount: 3,\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate: \"\",\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\twebix_scheduler_month_event: (e, id) => this.ShowEvent(id),\n\t\t\t\t\twebix_scheduler_month_event_single: (e, id) => this.ShowEvent(id),\n\t\t\t\t},\n\t\t\t\ttype: {\n\t\t\t\t\theight: 56,\n\t\t\t\t\ttemplate: (o, c) => this.MoreTemplate(o, c, _),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.Win = view;\n\n\t\tEditRecurringMixin(this);\n\n\t\tif (this.drag) initDnD.call(this, view.getBody(), \"more\", true);\n\t}\n\n\tMoreTemplate(obj, _c, _) {\n\t\tconst i18n = webix.i18n;\n\t\tconst single = !daysBetweenInclusive(\n\t\t\tobj.start_date,\n\t\t\tobj.all_day ? webix.Date.add(obj.end_date, 1, \"day\", true) : obj.end_date\n\t\t);\n\t\tconst style = single ? \"\" : dayEventColor(obj);\n\n\t\tconst oneDay =\n\t\t\t!single && this.webix.Date.equal(obj.start_date, obj.end_date);\n\n\t\tlet css = `webix_scheduler_month_event${single ? \"_single\" : \"\"}`;\n\t\tif (obj.$past) css += \" webix_scheduler_past_event\";\n\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${style}\"\n\t\t\t>\n\t\t\t\t${single ? marker(obj) : \"\"}\n\t\t\t\t<div webix_tooltip=\"${obj.text}\" class=\"webix_event_text\">${obj.text ||\n\t\t\t_(\"(No title)\")}</div>\n\t\t\t\t<div class=\"webix_event_time\">\n\t\t\t\t\t${this.DayFormatStr(obj.start_date)}\n\t\t\t\t\t${\n\t\t\t\t\t\toneDay\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: `${i18n.timeFormatStr(obj.start_date)} -\n\t\t\t\t\t\t${single ? \"\" : \" \" + this.DayFormatStr(obj.end_date)}\n\t\t\t\t\t\t${i18n.timeFormatStr(obj.end_date)}`\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tDayFormatStr(date) {\n\t\treturn webix.Date.dateToStr(\"%F %j\")(date);\n\t}\n\n\tShowEvent(id) {\n\t\tconst obj = this.Events.getItem(id);\n\t\tthis.app.getState().selected = getParams(obj);\n\t\tthis.HideWindow();\n\t}\n\n\tShowWindow(id, node, data) {\n\t\tif (this.ID === id && this.Win.isVisible()) return this.Win.hide();\n\n\t\tthis.ID = id;\n\t\tdata = data.map(v => this.Events.getItem(v));\n\n\t\tconst list = this.Win.getBody();\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.Win.show(node);\n\t}\n\n\tHideWindow() {\n\t\tthis.Win.hide();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MoreWindowView from \"./more\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { marker, dayEventColor, templateStart } from \"helpers/templates\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { daysBetweenInclusive, isToday } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class MonthEventsView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"dataview\",\n\t\t\tcss: \"webix_scheduler_calendar\",\n\t\t\tprerender: true,\n\t\t\txCount: 7,\n\t\t\tyCount: 5,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tscroll: false,\n\t\t\ttooltip: {\n\t\t\t\ttemplate: \"\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_cal_date: (_ev, id) => this.ShowDay(id),\n\t\t\t\twebix_scheduler_month_event: ev => this.ShowEvent(ev),\n\t\t\t\twebix_scheduler_month_event_single: ev => this.ShowEvent(ev),\n\t\t\t\twebix_scheduler_more: (_ev, id) => this.ShowMore(id),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_cal_day: (_e, id) => this.ShowNew(id),\n\t\t\t},\n\t\t\ttype: {\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: \"auto\",\n\t\t\t\ttemplate: (o, c) => this.CalendarTemplate(o, c),\n\t\t\t\ttemplateStart,\n\t\t\t\theaderHeight: 32,\n\t\t\t\teventHeight: 28,\n\t\t\t\tpadding: 8,\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.State = this.app.getState();\n\t\tthis.Calendar = view;\n\t\tview.type.master = this.Calendar;\n\n\t\tSelectionMixin(this, \"month\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.Events = new webix.DataCollection({});\n\t\tthis.MoreWindow = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t})\n\t\t);\n\n\t\tview.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.Calendar, \"month\");\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, view);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\", true); // IE hack\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tCalendarTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tlet html = `<span class=\"webix_cal_date\">${obj.date.getDate()}</span>`;\n\t\tif (obj.$more && obj.$more.length) {\n\t\t\thtml += `<div class=\"webix_scheduler_more\">${obj.$more.length} ${_(\n\t\t\t\t\"more\"\n\t\t\t)}</div>`;\n\t\t}\n\t\treturn html;\n\t}\n\n\tGetDayCss(day, month) {\n\t\tlet css = \"webix_cal_day\";\n\t\tif (isToday(day)) css += \" webix_cal_today\";\n\t\tif (day.getMonth() != month) css += \" webix_cal_outside\";\n\t\telse css += \" \" + (webix.Date.isHoliday(day) || \"\");\n\t\treturn css;\n\t}\n\n\tGetMonthData() {\n\t\tconst data = [];\n\t\tconst { start, weeks } = this.data;\n\t\tconst month = webix.Date.add(start, 1, \"week\", true).getMonth();\n\n\t\tlet day = webix.Date.copy(start);\n\t\tfor (let i = 0; i < weeks * 7; i++) {\n\t\t\tconst obj = {\n\t\t\t\tdate: webix.Date.copy(day),\n\t\t\t\t$css: this.GetDayCss(day, month),\n\t\t\t};\n\n\t\t\tif ((i + 1) % 7 === 0) obj.right = true;\n\t\t\tif (i >= (weeks - 1) * 7) obj.bottom = true;\n\n\t\t\tdata.push(obj);\n\t\t\twebix.Date.add(day, 1, \"day\");\n\t\t}\n\t\treturn data;\n\t}\n\n\tRenderEvents() {\n\t\t// No Events, No Render\n\t\tif (!this.Events.count() || !this.Calendar.count()) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t\tclass: \"webix_scheduler_month_events\",\n\t\t});\n\n\t\tconst { start } = this.data;\n\t\tconst type = this.Calendar.type;\n\t\tconst maxLines = Math.floor(\n\t\t\t(type.height - type.headerHeight + type.padding - 2) /\n\t\t\t\t(type.eventHeight + type.padding)\n\t\t);\n\n\t\tlet wStart = webix.Date.copy(start);\n\t\tlet wEnd = webix.Date.add(wStart, 1, \"week\", true);\n\n\t\tlet html = \"\";\n\t\tlet cache = {};\n\t\tconst me = this.GetTargetDate(this.Calendar.getLastId());\n\t\tconst ms = this.GetTargetDate(this.Calendar.getFirstId());\n\t\tthis.Calendar.data.each(function(day, dayIndex) {\n\t\t\t// next week\n\t\t\tif (day.date >= wEnd) {\n\t\t\t\tcache = {};\n\t\t\t\twStart = wEnd;\n\t\t\t\twEnd = webix.Date.add(wStart, 1, \"week\", true);\n\t\t\t}\n\n\t\t\tconst more = [];\n\t\t\tconst dayHTML = [];\n\t\t\tthis.Events.data.each(function(ev) {\n\t\t\t\tconst id = ev.id;\n\n\t\t\t\t// will not be this week\n\t\t\t\tif (\n\t\t\t\t\tev.start_date >= wEnd ||\n\t\t\t\t\tev.end_date < wStart ||\n\t\t\t\t\t(!ev.all_day && webix.Date.equal(ev.end_date, wStart))\n\t\t\t\t)\n\t\t\t\t\treturn;\n\n\t\t\t\t// if already processed - check and skip\n\t\t\t\tif (!webix.isUndefined(cache[id])) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(day.date <= ev.end_date && ev.all_day) ||\n\t\t\t\t\t\tday.date < ev.end_date\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (cache[id] >= maxLines) {\n\t\t\t\t\t\t\tmore.push(id);\n\t\t\t\t\t\t} else dayHTML[cache[id]] = \"\";\n\t\t\t\t\t} else delete cache[id];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// today\n\t\t\t\tif (\n\t\t\t\t\tev.start_date < webix.Date.add(day.date, 1, \"day\", true) &&\n\t\t\t\t\tev.end_date >= day.date\n\t\t\t\t) {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\t// search for the first available index\n\t\t\t\t\twhile (!webix.isUndefined(dayHTML[index])) index++;\n\n\t\t\t\t\tcache[id] = index;\n\t\t\t\t\tif (index >= maxLines) return more.push(id);\n\n\t\t\t\t\tconst config = { ms, me };\n\t\t\t\t\tconfig.single = this.IsSingleDay(ev);\n\n\t\t\t\t\tconfig.length = 1;\n\t\t\t\t\tif (!config.single) {\n\t\t\t\t\t\tconfig.es = ev.start_date;\n\t\t\t\t\t\tconfig.ee =\n\t\t\t\t\t\t\t!ev.all_day && !webix.Date.timePart(ev.end_date)\n\t\t\t\t\t\t\t\t? webix.Date.add(ev.end_date, -1, \"day\", true)\n\t\t\t\t\t\t\t\t: ev.end_date;\n\n\t\t\t\t\t\tconfig.length += daysBetweenInclusive(\n\t\t\t\t\t\t\t(config.ls = new Date(Math.max(wStart, config.es))),\n\t\t\t\t\t\t\t(config.le = new Date(Math.min(wEnd - 1, config.ee)))\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tconfig.index = dayIndex;\n\t\t\t\t\tdayHTML[index] = this.ToHTML(ev, index, config);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tconst prevLength = day.$more && day.$more.length;\n\t\t\tday.$more = more;\n\t\t\tif (prevLength != more.length) this.Calendar.render(day.id, day, \"paint\");\n\n\t\t\thtml += dayHTML.join(\"\");\n\t\t}, this);\n\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.Calendar.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\tIsSingleDay(ev) {\n\t\tif (ev.all_day)\n\t\t\treturn !daysBetweenInclusive(\n\t\t\t\tev.start_date,\n\t\t\t\twebix.Date.add(ev.end_date, 1, \"day\", true)\n\t\t\t);\n\n\t\tlet len = daysBetweenInclusive(ev.start_date, ev.end_date);\n\n\t\tif (\n\t\t\tlen === 1 &&\n\t\t\twebix.Date.timePart(ev.start_date) &&\n\t\t\t!webix.Date.timePart(ev.end_date)\n\t\t)\n\t\t\tlen = 0;\n\n\t\treturn !len;\n\t}\n\n\tToHTML(obj, index, c) {\n\t\tconst type = this.Calendar.type;\n\t\tconst style = c.single ? \"\" : dayEventColor(obj);\n\t\tconst width = c.length * type.width - type.padding;\n\t\tconst height = type.eventHeight;\n\t\tconst pos = this.GetPosition(type, index, c.index);\n\n\t\tlet extra = \"\";\n\t\tif (c.single) {\n\t\t\textra =\n\t\t\t\tmarker(obj) +\n\t\t\t\t`<span class=\"webix_event_time\">${webix.i18n.timeFormatStr(\n\t\t\t\t\tobj.start_date\n\t\t\t\t)}</span>`;\n\t\t}\n\t\tconst css = this.GetStyle(obj, c);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\twebix_tooltip=\"${obj.text}\"\n\t\t\t\twebix_e_id=\"${obj.id}\"\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"height:${height}px;line-height:${height}px; width:${width}px; ${pos +\n\t\t\tstyle}\">\n\t\t\t\t\t${extra + (obj.text || _(\"(No title)\"))}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj, c) {\n\t\tlet css = `webix_scheduler_month_event${c.single ? \"_single\" : \"\"}`;\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (!c.single) {\n\t\t\tif (c.es < c.ms && webix.Date.equal(c.ms, webix.Date.dayStart(c.ls)))\n\t\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\t\telse if (\n\t\t\t\tc.ee >= webix.Date.add(c.me, 1, \"day\", true) &&\n\t\t\t\twebix.Date.equal(c.me, webix.Date.dayStart(c.le))\n\t\t\t)\n\t\t\t\tcss += \" webix_scheduler_event_break_right\";\n\t\t}\n\t\treturn css;\n\t}\n\n\tGetPosition(type, index, dayIndex) {\n\t\tconst row = Math.floor(dayIndex / this.Calendar.config.xCount);\n\t\tconst col = dayIndex % this.Calendar.config.xCount;\n\n\t\treturn `\n\t\t\ttop:${row * type.height +\n\t\t\t\ttype.headerHeight +\n\t\t\t\tindex * (type.eventHeight + type.padding)}px;\n\t\t\tleft:${col * type.width}px;\n\t\t`;\n\t}\n\n\tRefreshData() {\n\t\tconst { data, weeks } = this.data;\n\n\t\tthis.Events.clearAll();\n\t\tthis.Events.parse(data);\n\t\tthis.Events.sort(function(a, b) {\n\t\t\tconst start_a = webix.Date.dayStart(a.start_date);\n\t\t\tconst start_b = webix.Date.dayStart(b.start_date);\n\n\t\t\tif (webix.Date.equal(start_a, start_b)) {\n\t\t\t\tconst days_a = daysBetweenInclusive(a.start_date, a.end_date);\n\t\t\t\tconst days_b = daysBetweenInclusive(b.start_date, b.end_date);\n\t\t\t\treturn days_b - days_a || a.start_date - b.start_date;\n\t\t\t}\n\t\t\treturn start_a - start_b;\n\t\t});\n\n\t\tconst monthData = this.GetMonthData();\n\n\t\tthis.Calendar.clearAll();\n\t\tif (this.Calendar.config.yCount != weeks) {\n\t\t\tthis.Calendar.define(\"yCount\", weeks);\n\t\t\tthis.Calendar.resize();\n\t\t}\n\t\tthis.Calendar.parse(monthData);\n\t}\n\n\tShowMore(id) {\n\t\tthis.MoreWindow.ShowWindow(\n\t\t\tid,\n\t\t\tthis.Calendar.getItemNode(id),\n\t\t\tthis.Calendar.getItem(id).$more || []\n\t\t);\n\t\treturn false;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.Calendar.$view);\n\t\tif (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.Events.getItem(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tShowNew(id) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = this.GetTargetDate(id);\n\t\t\tstate.selected = { id: \"0\", date };\n\t\t}\n\t}\n\n\tShowDay(id) {\n\t\tconst state = this.app.getState();\n\n\t\tstate.$batch({\n\t\t\tdate: this.GetTargetDate(id),\n\t\t\tmode: \"day\",\n\t\t});\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} id - the ID of the day in the calendar\n\t * @returns\n\t */\n\tGetTargetDate(id) {\n\t\treturn id ? this.Calendar.getItem(id).date : this.State.date;\n\t}\n\n\t/**\n\t * Returns the data object of an event\n\t * @param {(string|number)} id - the ID of the event\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of the event\n\t * @param {Object} newEvent - the data of the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { templateStart } from \"helpers/templates\";\n\nexport default class MonthHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"dataview\",\n\t\t\tcss: \"webix_scheduler_calendar_header\",\n\t\t\txCount: 7,\n\t\t\tyCount: 1,\n\t\t\twidth: 0,\n\t\t\theight: 32,\n\t\t\tscroll: false,\n\t\t\ttype: {\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: \"auto\",\n\t\t\t\ttemplateStart,\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tview.type.master = view;\n\t\tview.parse(this.GetHeaderData());\n\t}\n\n\tGetHeaderData() {\n\t\tconst data = [];\n\t\tconst k = webix.Date.startOnMonday ? 1 : 0;\n\n\t\tfor (let i = 0; i < 7; i++)\n\t\t\tdata.push({ value: webix.i18n.calendar.dayShort[(k + i) % 7] });\n\n\t\tdata[data.length - 1][\"right\"] = true;\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { events, timeStart } from \"helpers/templates\";\nimport { shrinkTo, isMultiDay } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\n\nexport default class MonthListView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst config = {\n\t\t\tview: \"list\",\n\t\t\ttype: {\n\t\t\t\theight: 50,\n\t\t\t\ttemplate: events(_),\n\t\t\t\ttimeStart: ev => this.TimeStart(ev),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ShowEvent(id),\n\t\t\t},\n\t\t};\n\n\t\treturn config;\n\t}\n\tinit() {\n\t\tthis.List = this.getRoot();\n\t\tthis.State = this.app.getState();\n\n\t\twebix.extend(this.List, webix.OverlayBox);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tRefreshData() {\n\t\tconst start = webix.Date.datePart(this.State.date, true);\n\t\tconst end = webix.Date.add(start, 1, \"day\", true);\n\t\tthis.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(start, end)\n\t\t\t.then(evs => {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(evs.map(shrinkTo(start, end)));\n\t\t\t\tthis.ToggleOverlay();\n\t\t\t});\n\t}\n\n\tToggleOverlay() {\n\t\tif (!this.List.count()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.List.showOverlay(_(\"No Events\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tShowEvent(id) {\n\t\tconst obj = this.List.getItem(id);\n\t\tthis.State.selected = getParams(obj);\n\t}\n\n\tTimeStart(ev) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (isMultiDay(ev)) return _(\"All Day\");\n\t\telse return timeStart(ev.start_date, ev.end_date);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MonthListView from \"./list\";\nimport CalendarView from \"./compact\";\nimport MonthEventsView from \"./events\";\nimport MonthHeaderView from \"./header\";\n\nexport default class MonthView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst views = compact\n\t\t\t? [CalendarView, MonthListView]\n\t\t\t: [MonthHeaderView, MonthEventsView];\n\n\t\treturn {\n\t\t\trows: views,\n\t\t};\n\t}\n\tinit() {\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tconst state = this.app.getState();\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\t}\n\tRefreshData(value) {\n\t\tlet start = webix.Date.monthStart(value);\n\t\tlet end = webix.Date.add(start, 1, \"month\", true);\n\n\t\tstart = webix.Date.weekStart(\n\t\t\tnew Date(start.getFullYear(), start.getMonth(), 1)\n\t\t);\n\t\tconst weeks = Math.ceil((end - start) / (24 * 60 * 60 * 1000) / 7);\n\t\tend = webix.Date.add(start, weeks, \"week\", true);\n\n\t\tthis.Data.getEvents(start, end).then(data => {\n\t\t\tif (this.app) this.setParam(\"data\", { start, weeks, data }, true);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BarView extends JetView {\n\tconfig() {\n\t\tconst active = webix.skin.$active;\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst state = this.getParam(\"state\", true);\n\n\t\treturn {\n\t\t\tview: \"toolbar\",\n\t\t\theight: active.barHeight,\n\t\t\telements: [\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlabel: _(\"Timeline scale\"),\n\t\t\t\t\tlabelWidth: 120,\n\t\t\t\t\twidth: 260,\n\t\t\t\t\tvalue: state.timelineMode,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t\t\t\t{ id: \"week\", value: _(\"Week\") },\n\t\t\t\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => {\n\t\t\t\t\t\t\tstate.timelineMode = v;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n}\n","import MoreWindowView from \"../month/more\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD } from \"helpers/dnd\";\n\nexport default class MoreView extends MoreWindowView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.width = 360;\n\t\tui.relative = \"bottom\";\n\n\t\treturn ui;\n\t}\n\n\tinit(view) {\n\t\tthis.Win = view;\n\n\t\tEditRecurringMixin(this);\n\n\t\t// set dnd mode to timeline to allow dnd between more popup and timeline chart\n\t\tinitDnD.call(this, view.getBody(), \"timelineMore\", true);\n\t}\n\n\t/**\n\t * Show the popup with extra events\n\t * @param {(string|number)} id - the ID of a section\n\t * @param {HTMLElement} node - the HTML element of the section from left part of the timeline chart\n\t * @param {Array<Object>} data - an array of events\n\t * @returns\n\t */\n\tShowWindow(id, node, data) {\n\t\tif (this.ID === id && this.Win.isVisible()) return this.Win.hide();\n\n\t\tthis.ID = id;\n\t\tdata = data.map(v => this.Events.getItem(v));\n\n\t\tconst list = this.Win.getBody();\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.Win.show(node, { x: node.clientWidth }); // here we position the popup to the left of the node as well as bottom\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport {\n\tsmallerCount,\n\tgetUnitStart,\n\tgrid,\n\tupdateTask,\n\taddUnit,\n} from \"@xbs/webix-gantt-lib\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { initDnD, switchCursor, locateEvent } from \"helpers/dnd\";\nimport { getParams } from \"helpers/recurring\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport MoreWindowView from \"./more\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst height = this.GetSectionHeight();\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\treturn {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"treetable\",\n\t\t\t\t\tlocalId: \"sections\",\n\t\t\t\t\tcss: \"webix_scheduler_timeline_sections\",\n\t\t\t\t\twidth: compact ? 80 : 200,\n\t\t\t\t\theader: false,\n\t\t\t\t\tscroll: \"y\",\n\t\t\t\t\trowHeight: height,\n\t\t\t\t\tscrollAlignY: false,\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"text\",\n\t\t\t\t\t\t\theader: \"\",\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"list\",\n\t\t\t\t\tlocalId: \"list\",\n\t\t\t\t\ttype: { height, template: \"\" },\n\t\t\t\t\tcss: `webix_scheduler_timeline${\n\t\t\t\t\t\twebix.env.touch ? \"_touch\" : \"\"\n\t\t\t\t\t}_bars`,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_scheduler_timeline_event: e => this.ShowEvent(e),\n\t\t\t\t\t},\n\t\t\t\t\tonDblClick: {\n\t\t\t\t\t\twebix_list_item: (e, id) => this.ShowNew(e, id),\n\t\t\t\t\t},\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: \"\",\n\t\t\t\t\t},\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Tree = this.$$(\"sections\");\n\t\tthis.Bars = this.$$(\"list\");\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.InnerState = this.getParam(\"innerState\", true);\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Events = new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => this.RefreshTask(obj.id),\n\t\t\t},\n\t\t});\n\n\t\tthis.MoreWindow = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t})\n\t\t);\n\n\t\tSelectionMixin(this, \"month\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis._sectionsReady = this.Data.sections().then(data => {\n\t\t\tthis.Sections = data;\n\t\t\tthis.Tree.parse(data);\n\t\t\tthis.Bars.parse(data);\n\t\t});\n\n\t\tthis.HandleScroll();\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData()\n\t\t);\n\t\t// calendars\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"active\", (_v, o) => o && this.RefreshData());\n\n\t\tinitDnD.call(this, this.Bars, \"timeline\");\n\t\tthis._mousemove_handler = webix.event(this.Bars.$view, \"pointermove\", e => {\n\t\t\tif (e.pointerType == \"mouse\") switchCursor(e, this.Bars.$view);\n\t\t});\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.Bars);\n\t}\n\n\turlChange() {\n\t\tconst scales = (this.Scales = this.getParam(\"scales\", true));\n\t\tthis.DrawGrid(scales);\n\t\tthis.RefreshData(scales);\n\t}\n\n\tGetSectionHeight() {\n\t\tconst active = webix.skin.$active;\n\t\tthis._sectionSize = 5;\n\t\treturn (active.barHeight - active.borderWidth * 2) * this._sectionSize;\n\t}\n\n\t/**\n\t * Reloads data into timeline\n\t * @param {Object} scales - current chart scales\n\t */\n\tRefreshData(scales) {\n\t\tif (!scales) scales = this.Scales;\n\t\twebix.promise\n\t\t\t.all([this._sectionsReady, this.Data.getEvents(scales.start, scales.end)])\n\t\t\t.then(res => {\n\t\t\t\tthis.ClearCollections();\n\n\t\t\t\tthis.Events.parse(res[1]);\n\t\t\t\tthis.RenderEvents();\n\t\t\t});\n\t}\n\n\tClearCollections() {\n\t\tthis.Events.clearAll();\n\t\tthis._processed = [];\n\t\tthis._lastRow = {};\n\t\tthis._moreEvents = {};\n\t}\n\n\t/**\n\t * Updates task object with new coordinates and allocates it to the correct position inside a section\n\t * @param {(string|number)} updID - the ID of an event\n\t */\n\tRefreshTask(updID) {\n\t\tconst t = this.GetEvent(updID);\n\n\t\tconst sectionIndex = indexOf(this.Sections.data.order, t.section);\n\t\tif (sectionIndex == -1) {\n\t\t\tt.$hide = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst type = this.State.timelineMode;\n\t\tlet unit = this.GetUnitCount(type);\n\t\tif (type !== \"day\" || type !== \"week\") unit = this.GetUnitCount(unit);\n\n\t\tconst prev = this._processed.find(obj => {\n\t\t\tif (obj.section == t.section) {\n\t\t\t\tif (type === \"day\")\n\t\t\t\t\treturn this.CheckDates(obj.end_date, t.start_date, obj.all_day);\n\n\t\t\t\tconst prev = webix.Date.timePart(obj.end_date)\n\t\t\t\t\t? this.GetUnitStart(unit, webix.Date.add(obj.end_date, 1, unit, true))\n\t\t\t\t\t: obj.end_date;\n\t\t\t\tconst next = this.GetUnitStart(unit, t.start_date);\n\t\t\t\treturn this.CheckDates(prev, next, obj.all_day);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tlet y;\n\t\tif (prev) {\n\t\t\ty = prev.$y;\n\t\t\tthis._processed.splice(\n\t\t\t\tthis._processed.findIndex(p => prev.id == p.id),\n\t\t\t\t1\n\t\t\t);\n\t\t} else {\n\t\t\tif (webix.isUndefined(this._lastRow[t.section]))\n\t\t\t\tthis._lastRow[t.section] = 0;\n\t\t\telse this._lastRow[t.section]++;\n\n\t\t\tif (this._lastRow[t.section] >= this._sectionSize - 1) t.$more = true;\n\t\t\telse t.$more = false;\n\t\t}\n\n\t\tthis.UpdateTask(t, sectionIndex, y);\n\n\t\tthis._processed.push(t);\n\t\tthis._processed.sort((a, b) => a.$y - b.$y);\n\t}\n\n\t/**\n\t * Checks if the start of one event follows the end of the previous one\n\t * @param {Date} prev - the end date of the previous event\n\t * @param {Date} next - the start date of the next event\n\t * @param {Boolean} all_day - the flag that indicates that the previous event is all-day (which means that the end date is really 1 day later)\n\t * @returns {Boolean} true if the start follows the end, false otherwise\n\t */\n\tCheckDates(prev, next, all_day) {\n\t\treturn (all_day ? webix.Date.add(prev, 1, \"day\", true) : prev) <= next;\n\t}\n\n\t/**\n\t * Creates a layer with events\n\t */\n\tRenderEvents() {\n\t\tif (this._DataObj) {\n\t\t\tthis.Bars.$view.firstChild.removeChild(this._DataObj);\n\t\t\tdelete this._DataObj;\n\t\t}\n\n\t\t// No Events, No Render\n\t\tif (!this.Events.count() || !this.Bars.count()) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t});\n\t\tlet html = \"\";\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Events.data.each(obj => {\n\t\t\tif (!obj.$hide) {\n\t\t\t\tif (!obj.$more || this._lastRow[obj.section] == 4) {\n\t\t\t\t\thtml += this.BarsTemplate(obj, _);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this._moreEvents[obj.section]) {\n\t\t\t\t\t\tthis._moreEvents[obj.section] = [];\n\n\t\t\t\t\t\thtml += this.MoreBarTemplate(obj, _);\n\t\t\t\t\t}\n\t\t\t\t\tthis._moreEvents[obj.section].push(obj.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.Bars.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\t/**\n\t * Paints a grid\n\t * @param {Object} scales - scales object as returned by this.Local.getScales()\n\t */\n\tDrawGrid(scales) {\n\t\tconst view = this.Bars;\n\t\tconst colors = { contrast: \"#808080\", dark: \"#384047\" };\n\t\tview.$view.style.backgroundImage = `url(${this.GetGrid(\n\t\t\tscales,\n\t\t\tcolors[webix.skin.$name] || \"#ddd\"\n\t\t)})`;\n\t\tview.$view.style.marginTop = \"0px\";\n\n\t\t// sync grid to scroll position\n\t\tview.$view.style.backgroundPosition = `-${this.InnerState.left}px -${this.InnerState.top}px`;\n\n\t\tthis.Resize(scales.width);\n\t}\n\n\t/**\n\t * Changes the width of the root component (list with bars)\n\t * @param {number} width\n\t */\n\tResize(width) {\n\t\tconst area = this.Bars.$view.querySelector(\".webix_scroll_cont\");\n\t\tarea.style.width = width + \"px\";\n\t\tarea.style.minHeight = \"1px\";\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis.InnerState = this.getParam(\"innerState\", true);\n\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\t\t\tthis.Bars.$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.InnerState.$batch({ top, left });\n\t\t\tthis.Tree.scrollTo(0, top);\n\n\t\t\tthis.MoreWindow.HideWindow();\n\t\t});\n\n\t\tthis.on(this.Tree, \"onScrollY\", function() {\n\t\t\tconst y = this.getScrollState().y;\n\t\t\tthis.$scope.Bars.scrollTo(this.$scope.InnerState.left, y);\n\t\t});\n\t}\n\n\t/**\n\t * Returns a string with HTML of a task node content\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string} a string with HTML of an event bar\n\t */\n\tBarsTemplate(obj, _) {\n\t\tconst style = dayEventColor(obj);\n\t\tconst scales = this.Scales;\n\n\t\tlet w = obj.$w - 2;\n\t\t// all day events last 1 day longer than their end_date\n\t\tif (obj.all_day && obj.end_date < scales.end) {\n\t\t\tw += this.GetUnitWidth(scales, obj.start_date);\n\t\t}\n\n\t\tconst content = `<div class=\"webix_scheduler_timeline_content\">${obj.text ||\n\t\t\t_(\"(no title)\")}</div>`;\n\n\t\tlet css = \"webix_scheduler_timeline_event\";\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tif (obj.start_date < this.Scales.start)\n\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\telse if (obj.end_date > this.Scales.end)\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\tconst tooltip = this.GetTooltip(obj);\n\t\treturn `<div webix_e_id=\"${obj.id}\" \n\t\t\twebix_tooltip=\"${tooltip}\" class=\"${css}\" \n\t\t\tstyle=\"left:${obj.$x}px;top:${obj.$y}px;width:${w}px;height:${obj.$h}px;${style}\">\n\t\t\t${content}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Returns a string with a tooltip for an event\n\t * @param {Object} obj - event data\n\t * @returns {string} a string with HTML of a tooltip\n\t */\n\tGetTooltip(obj) {\n\t\treturn obj.text;\n\t}\n\n\t/**\n\t * Defines the looks and contents of the bar that allows to see events that did not fit into a 5-line section\n\t * @param {Object} obj - the event data\n\t * @param {function} _ - the translator function of the Locale plugin\n\t * @returns {string} with the HTML of the bar\n\t */\n\tMoreBarTemplate(obj, _) {\n\t\tconst text = _(\"Show more\");\n\t\tconst content = `<div class=\"webix_scheduler_timeline_content\" webix_tooltip=\"${text}\">${text}</div>`;\n\t\tconst css = \"webix_scheduler_timeline_event webix_scheduler_multi_more\";\n\n\t\treturn `<div webix_e_id=\"$wsh_multi_more\" webix_r_id=\"${obj.section}\" class=\"${css}\" style=\"left:0px;top:${obj.$y}px;width:100%;height:${obj.$h}px;\">\n\t\t\t${content}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Either shows the selected event in Info or opens the list of extra events in a popup\n\t * @param {MouseEvent} e - a native browser event\n\t * @returns {Boolean} always false to prevent bubbling\n\t */\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.Bars.$view);\n\t\tif (event.id === \"$wsh_multi_more\") {\n\t\t\tconst id = event.node.getAttribute(\"webix_r_id\");\n\t\t\tthis.MoreWindow.ShowWindow(\n\t\t\t\tid,\n\t\t\t\tthis.Tree.getItemNode(id),\n\t\t\t\tthis._moreEvents[id] || []\n\t\t\t);\n\t\t} else if (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.GetEvent(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initiates creating a new event\n\t * @param {MouseEvent} e - a native browser event\n\t * @param {(string|number)} id - the ID of a section\n\t */\n\tShowNew(e, id) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst scales = this.Scales;\n\t\t\tconst start = scales.start;\n\n\t\t\tconst unit = scales.precise\n\t\t\t\t? this.GetUnitCount(scales.minUnit)\n\t\t\t\t: scales.minUnit;\n\t\t\tconst n = Math.floor(e.offsetX / this.GetUnitWidth(scales));\n\t\t\tconst date = this.AddUnit(unit, start, n);\n\n\t\t\tstate.selected = { id: \"0\", date, section: id };\n\t\t}\n\t}\n\n\t/**\n\t * Returns the event data by its ID\n\t * @param {(string|id)} id - the ID of an event\n\t * @returns {Object} the event data\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of an event\n\t * @param {Object} newEvent - the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\tconst clickedUnit = this.mousePosUnit || 0;\n\t\tconst scales = this.Scales;\n\t\treturn this.AddUnit(scales.minUnit, scales.start, clickedUnit);\n\t}\n\n\t/* Method wrappers for gantt-lib functions */\n\n\tGetUnitCount(type) {\n\t\treturn smallerCount[type][0];\n\t}\n\n\tGetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date);\n\t}\n\n\tAddUnit(unit, date, count) {\n\t\treturn addUnit(unit)(date, count);\n\t}\n\n\tGetGrid(scales, color) {\n\t\treturn grid(scales.cellWidth, scales.cellHeight, color);\n\t}\n\n\tUpdateTask(task, sectionIndex, y) {\n\t\treturn updateTask(\n\t\t\ttask,\n\t\t\tthis._lastRow[task.section] + sectionIndex * this._sectionSize,\n\t\t\tthis.Scales,\n\t\t\tthis.Scales.cellHeight - 12,\n\t\t\ty\n\t\t);\n\t}\n\n\tGetUnitWidth(scales, date) {\n\t\tif (\n\t\t\tscales.precise &&\n\t\t\t(scales.minUnit !== \"day\" || scales.minUnit !== \"month\")\n\t\t) {\n\t\t\tconst count = smallerCount[scales.minUnit][1];\n\t\t\tconst number = typeof count === \"number\" ? count : count(date);\n\t\t\treturn Math.floor(scales.cellWidth / number);\n\t\t}\n\t\treturn scales.cellWidth;\n\t}\n}\n\n/**\n * Case-insensitive indexOf\n * @param {Array<any>} arr - the array to be checked\n * @param {any} el - something that you need to find in the array\n * @returns {number} the index of the first found element or -1\n */\nfunction indexOf(arr, el) {\n\tfor (let i = 0; i < arr.length; ++i) {\n\t\tif (arr[i] == el) return i;\n\t}\n\treturn -1;\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ScalesView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\treturn {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\twidth: compact ? 80 : 200,\n\t\t\t\t\tcss: \"webix_scheduler_timeline_space\",\n\t\t\t\t\tborderless: false,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tlocalId: \"scale\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tcss: \"webix_scheduler_timeline_scale\",\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst scale = this.$$(\"scale\");\n\t\tconst innerState = (this.InnerState = this.getParam(\"innerState\", true));\n\t\tthis.on(innerState.$changes, \"left\", x => scale.scrollTo(x, null));\n\t}\n\n\turlChange() {\n\t\tthis.RenderScales();\n\t}\n\n\t/**\n\t * Renders gantt scales\n\t */\n\tRenderScales() {\n\t\tconst scales = this.getParam(\"scales\", true);\n\t\tconst view = this.$$(\"scale\");\n\t\tconst html = scales.rows\n\t\t\t.map(line => {\n\t\t\t\treturn (\n\t\t\t\t\t`<div class=\"webix_scheduler_timeline_scale_row\" style='height:${line.height}px;width:${scales.width}px'>` +\n\t\t\t\t\tline.cells.map(cell => this.CellTemplate(cell, line.type)).join(\"\") +\n\t\t\t\t\t\"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tview.config.height = scales.height;\n\t\tview.setHTML(html);\n\t\tview.resize();\n\t}\n\n\t/**\n\t * Returns the template string for a scale unit\n\t * @param {Object} cell - a scale unit\n\t * @returns {string} - the template string of the scale cell\n\t */\n\tCellTemplate(cell) {\n\t\tconst css = `webix_scheduler_timeline_scale_cell ${cell.css}`;\n\t\treturn `<div class=\"${css}\" style=\"width:${cell.width}px;\">${cell.format(\n\t\t\tcell.date\n\t\t)}</div>`;\n\t}\n\n\tDateIsToday(date) {\n\t\tconst today = webix.Date.dayStart(new Date());\n\t\treturn webix.Date.equal(today, webix.Date.dayStart(date));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport BarView from \"./bar\";\nimport ScaleView from \"./scale\";\nimport ChartView from \"./chart\";\n\nimport {\n\taddUnit,\n\tresetScales,\n\tgetUnitStart,\n\tsmallerCount,\n} from \"@xbs/webix-gantt-lib\";\n\nimport { createState } from \"jet-restate\";\n\nexport default class TimelineView extends JetView {\n\tconfig() {\n\t\tconst ui = {\n\t\t\trows: [BarView, ScaleView, ChartView],\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst innerState = (this.InnerState = createState({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t}));\n\t\tthis.setParam(\"innerState\", innerState, true);\n\n\t\tthis.on(state.$changes, \"date\", v => this.SetScales(v, state.timelineMode));\n\n\t\tthis.on(state.$changes, \"timelineMode\", (t, o) => {\n\t\t\tif (o) this.SetScales(state.date, t);\n\t\t});\n\t}\n\n\tSetScales(date, type) {\n\t\tconst scales = this.ResetScales(type, date);\n\t\tthis.setParam(\"scales\", scales, true);\n\t}\n\n\tGetScalesArray(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn [{ unit: \"hour\", format: \"%H:00\" }];\n\t\t\tcase \"week\":\n\t\t\t\treturn [{ unit: \"day\", step: 1, format: \"%d\" }];\n\t\t\tcase \"month\":\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tunit: \"week\",\n\t\t\t\t\t\tformat: function(start) {\n\t\t\t\t\t\t\tconst parser = webix.Date.dateToStr(\"%d %M\");\n\t\t\t\t\t\t\tconst wstart = webix.Date.weekStart(start);\n\t\t\t\t\t\t\tconst wend = webix.Date.add(\n\t\t\t\t\t\t\t\twebix.Date.add(wstart, 1, \"week\", true),\n\t\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t\t\t\"day\",\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn parser(wstart) + \" - \" + parser(wend);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\tdefault: {\n\t\t\t\tconst unit = this.GetDefaultScaleUnit(type);\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tunit,\n\t\t\t\t\t\tformat: (start, end) => {\n\t\t\t\t\t\t\tconst parser = webix.Date.dateToStr(\"%d %M %YYYY\");\n\t\t\t\t\t\t\treturn parser(start) + \" - \" + parser(end);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t}\n\n\tGetScalesCellWidth(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn 80;\n\t\t\tcase \"week\":\n\t\t\t\treturn 300;\n\t\t\tcase \"month\":\n\t\t\t\treturn 400;\n\t\t\tdefault:\n\t\t\t\treturn 100;\n\t\t}\n\t}\n\n\tGetScalePrecision(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn false;\n\t\t\tcase \"week\":\n\t\t\t\treturn false;\n\t\t\tcase \"month\":\n\t\t\t\treturn true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* Method wrappers for gantt-lib functions */\n\n\tAddUnit(unit, date, step) {\n\t\treturn addUnit(unit)(date, step);\n\t}\n\n\tGetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date);\n\t}\n\n\tResetScales(unit, date) {\n\t\tconst start = this.GetUnitStart(unit, date);\n\t\tconst end = this.AddUnit(unit, start, 1);\n\t\tconst active = webix.skin.$active;\n\t\treturn resetScales(\n\t\t\tstart,\n\t\t\tend,\n\t\t\tthis.GetScalePrecision(unit),\n\t\t\tthis.GetScalesCellWidth(unit),\n\t\t\tactive.barHeight - active.borderWidth * 2,\n\t\t\tthis.GetScalesArray(unit)\n\t\t);\n\t}\n\n\tGetDefaultScaleUnit(type) {\n\t\treturn smallerCount[type][0] || type;\n\t}\n}\n","import DayEventsView from \"../day/events\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD } from \"helpers/dnd\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class UnitEventsView extends DayEventsView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\tif (config) {\n\t\t\tthis.Unit = config.unit;\n\t\t}\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"unitList\",\n\t\t\tcss: \"webix_scheduler_day_events\",\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\ttemplate: \"\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\tcss: \"webix_scheduler_day_scale_item\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_day_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_scheduler_day_scale_item: (_e, h) => this.ShowNew(h),\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"unitList\");\n\n\t\tSelectionMixin(this, \"scale\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.List.$setSize = function(x, y) {\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\tthis.minEventHeight = 62;\n\t\tthis.ParseHours();\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.List.render());\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"units\");\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\tFilterToday(value, to) {\n\t\tconst dayEvents = super.FilterToday(value, to);\n\n\t\treturn dayEvents.filter(obj => {\n\t\t\tif (obj.units) {\n\t\t\t\tconst units = obj.units.split(\",\");\n\t\t\t\tconst unitID = this.Unit.id + \"\";\n\t\t\t\treturn units.indexOf(unitID) !== -1;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tShowNew(h) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = webix.Date.copy(this.Day || state.date);\n\t\t\tconst unit = this.Unit.id;\n\t\t\tdate.setHours(h);\n\t\t\tstate.selected = { id: \"0\", date, unit };\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class UnitsHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\ttype: \"clean\",\n\t\t\tcols: [\n\t\t\t\t{ borderless: false, width: 51 },\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tlocalId: \"header\",\n\t\t\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\t\t\txCount: 1,\n\t\t\t\t\tyCount: 1,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 32,\n\t\t\t\t\tscroll: false,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\twidth: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: obj => obj.value,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Header = this.$$(\"header\");\n\n\t\tthis.Units = this.app.getService(\"local\").units();\n\n\t\tthis.Units.then(unitsCache => {\n\t\t\tthis.Header.sync(unitsCache, () => {\n\t\t\t\tthis.Header.define({ xCount: unitsCache.count() });\n\t\t\t\tthis.Header.resize();\n\t\t\t});\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport SelectionMixin from \"helpers/selection\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\nimport { initDnD } from \"helpers/dnd\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class UnitMultidayList extends JetView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\tif (config) {\n\t\t\tthis.Unit = config.unit;\n\t\t}\n\t}\n\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tautoheight: true,\n\t\t\tscroll: false,\n\t\t\tcss: \"webix_scheduler_multilist\",\n\t\t\ttype: {\n\t\t\t\theight: 36,\n\t\t\t\ttemplate: (obj, common) => this.EventTemplate(obj, common),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: (e, id, node) =>\n\t\t\t\t\tthis.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"multiDayList\");\n\n\t\tthis._expandState = \"down\";\n\t\tthis.maxVisibleLines = 3;\n\n\t\tthis._DataObj = this.List.$view.firstChild;\n\t\tSelectionMixin(this, \"multi\", true);\n\n\t\tthis._moreBtn = {\n\t\t\tid: \"$wsh_multi_more\",\n\t\t\t$css: \"webix_scheduler_multi_more\",\n\t\t};\n\n\t\tthis.on(this.app, \"units:multi:state\", state => {\n\t\t\tif (state !== this._expandState) {\n\t\t\t\tstate === \"down\" ? this.WrapData() : this.ExpandData();\n\t\t\t}\n\t\t});\n\n\t\tinitDnD.call(this, this.List, \"multidayUnits\");\n\t\tEditRecurringMixin(this);\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, this.List, { multi: true });\n\t}\n\n\turlChange() {\n\t\tconst data = this.getParam(\"data\");\n\t\tif (data) {\n\t\t\tconst copy = webix.copy(data.multi);\n\t\t\tconst multi = this.FilterByUnits(copy);\n\t\t\tthis.LimitData(multi);\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(multi);\n\t\t}\n\t}\n\n\tEventTemplate(obj, common) {\n\t\tconst height = common.height - 8;\n\t\tconst size = `height:${height}px; line-height:${height}px; width:calc(100% - 5px);`;\n\t\tconst color = obj.id !== \"$wsh_multi_more\" ? dayEventColor(obj) : \"\";\n\t\tconst css = this.GetStyle(obj);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${color}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj) {\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tif (obj.id == \"$wsh_multi_more\") return css;\n\n\t\tconst date = this.State.date;\n\t\tconst end =\n\t\t\t!obj.all_day && !webix.Date.timePart(obj.end_date)\n\t\t\t\t? webix.Date.add(obj.end_date, -1, \"day\", true)\n\t\t\t\t: obj.end_date;\n\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (obj.start_date < date) css += \" webix_scheduler_event_break_left\";\n\t\tif (end >= webix.Date.add(date, 1, \"day\", true))\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\treturn css;\n\t}\n\n\tLimitData(data) {\n\t\tdelete this._reserve;\n\t\tdelete this._reserveIds;\n\t\tif (data.length > this.maxVisibleLines) {\n\t\t\tconst excess = data.length - 2;\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis._moreBtn.text = `${excess} ${_(\"more\")}`;\n\n\t\t\tif (this._expandState === \"down\") {\n\t\t\t\tthis._reserve = data.splice(2, excess, this._moreBtn);\n\t\t\t} else {\n\t\t\t\tthis._reserve = data.slice(2);\n\t\t\t}\n\n\t\t\tthis._reserveIds = this._reserve.map(d => d.id);\n\n\t\t\tthis.app.callEvent(\"units:multi:state\", [this._expandState, false]);\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tif (this._reserveIds) {\n\t\t\t\tthis._inAnimation = true;\n\t\t\t\tconst height =\n\t\t\t\t\tthis.List.$height -\n\t\t\t\t\t(this._reserveIds.length - 1) * this.List.type.height;\n\t\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\t\tthis.List.add(this._moreBtn);\n\t\t\t\t\tthis.List.remove(this._reserveIds);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tExpandData() {\n\t\tconst expandable = this.List.exists(\"$wsh_multi_more\");\n\t\tif (!this._inAnimation) {\n\t\t\tthis._expandState = \"up\";\n\t\t\tif (expandable) {\n\t\t\t\tthis._inAnimation = true;\n\t\t\t\tthis.Animate(\"up\");\n\n\t\t\t\tthis.List.remove(\"$wsh_multi_more\");\n\t\t\t\tthis.List.parse(this._reserve);\n\t\t\t}\n\t\t}\n\t}\n\n\tAnimate(mode, height, handler) {\n\t\tthis.List.$view.style.transition = \"height 150ms\";\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t}, 150);\n\t}\n\n\tShowEvent(id, node) {\n\t\tif (id === \"$wsh_multi_more\") {\n\t\t\tthis.app.callEvent(\"units:multi:state\", [\"up\", true]);\n\t\t} else {\n\t\t\tconst obj = this.List.getItem(id);\n\t\t\tconst sel = getParams(obj);\n\t\t\tsel.node = node;\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tFilterByUnits(multiEvents) {\n\t\treturn multiEvents.filter(obj => {\n\t\t\tif (obj.units) {\n\t\t\t\tconst units = obj.units.split(\",\");\n\t\t\t\tconst unitID = this.Unit.id + \"\";\n\t\t\t\treturn units.indexOf(unitID) !== -1;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\t/**\n\t * Returns the event object by its ID\n\t * @param {(string|number)} id - the ID of the event\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.List.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for the event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\treturn this.State.date;\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport UnitMultidayList from \"./multidaylist\";\nexport default class UnitMultidayView extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tconst units = this.app.getService(\"local\").units();\n\n\t\tconst more = ui.cols[0];\n\t\tmore.onClick = {\n\t\t\t\"wxi-angle-down\": () =>\n\t\t\t\tthis.app.callEvent(\"units:multi:state\", [\"up\", true]),\n\t\t\t\"wxi-angle-up\": () =>\n\t\t\t\tthis.app.callEvent(\"units:multi:state\", [\"down\", true]),\n\t\t};\n\n\t\tui.cols[1] = { cols: [] };\n\n\t\treturn units.then(unitsCache => {\n\t\t\tconst data = unitsCache.serialize();\n\t\t\tfor (let i = 0; i < data.length; ++i) {\n\t\t\t\tui.cols[1].cols.push(\n\t\t\t\t\tnew (this.app.dynamic(UnitMultidayList))(this.app, {\n\t\t\t\t\t\tunit: data[i],\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn ui;\n\t\t});\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.MoreIcon = this.$$(\"more\");\n\n\t\tthis.on(this.State.$changes, \"date\", () => {\n\t\t\tthis.SetMoreIcon();\n\t\t});\n\n\t\tthis.on(this.app, \"units:multi:state\", (state, animate) => {\n\t\t\tthis.Animate(state, animate ? 150 : 1);\n\t\t});\n\t}\n\n\t/**\n\t * Sets a delay for animation of inner views (collapse/expand)\n\t * @param {string} mode - \"up\" or \"down\" - the direction of the icon\n\t * @param {number} delay - delay in milliseconds\n\t */\n\tAnimate(mode, delay) {\n\t\tsetTimeout(() => {\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, delay);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport HourscaleView from \"../common/hourscale\";\nimport UnitEventsView from \"./events\";\nimport UnitsHeaderView from \"./header\";\nimport UnitMultidayView from \"./multiday\";\n\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class UnitsView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst units = this.app.getService(\"local\").units();\n\n\t\tconst multi = {\n\t\t\tlocalId: \"multi\",\n\t\t\thidden: true,\n\t\t\tcols: [UnitMultidayView],\n\t\t};\n\n\t\tconst days = {\n\t\t\tlocalId: \"scroll\",\n\t\t\tview: \"scrollview\",\n\t\t\tscroll: \"y\",\n\t\t\tcss: \"webix_scheduler_week_days\",\n\t\t\tbody: {\n\t\t\t\tcols: [HourscaleView],\n\t\t\t},\n\t\t};\n\n\t\treturn units.then(unitsCache => {\n\t\t\tconst data = unitsCache.serialize();\n\t\t\tfor (let i = 0; i < data.length; ++i) {\n\t\t\t\tdays.body.cols.push(\n\t\t\t\t\tnew (this.app.dynamic(UnitEventsView))(this.app, {\n\t\t\t\t\t\tunit: data[i],\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\trows: [UnitsHeaderView, multi, days],\n\t\t\t};\n\t\t});\n\t}\n\tinit() {\n\t\tconst state = this.app.getState();\n\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\t}\n\n\tRefreshData(value) {\n\t\tthis.GetDay(value).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetDay(date) {\n\t\tconst end = webix.Date.add(date, 1, \"day\", true);\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(date, end)\n\t\t\t.then(evs => {\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { multi, single };\n\t\t\t});\n\t}\n}\n","import UnitListView from \"../common/unitlist\";\nimport { isToday } from \"helpers/dates\";\n\nexport default class WeekEventsView extends UnitListView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tui.css = \"webix_scheduler_week\";\n\t\tui.type.headerHeight = 28;\n\n\t\treturn ui;\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(this.data.all);\n\t\t\tthis.ToggleOverlay();\n\t\t}\n\t}\n\n\tTemplateHeader(datestring) {\n\t\tconst date = new Date(datestring * 1);\n\t\tconst today = isToday(date);\n\n\t\tconst fstring = `%l, %F <span class='webix_scheduler_monthday${\n\t\t\ttoday ? \" webix_scheduler_today\" : \"\"\n\t\t}'>%j</span>`;\n\n\t\treturn `<span class=\"webix_unit_header_inner\">${webix.Date.dateToStr(\n\t\t\tfstring\n\t\t)(date)}</span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { isToday } from \"helpers/dates\";\n\nexport default class WeekHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\ttype: \"clean\",\n\t\t\tcols: [\n\t\t\t\t{ borderless: false, width: 51 },\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tlocalId: \"header\",\n\t\t\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\t\t\txCount: 7,\n\t\t\t\t\tyCount: 1,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 32,\n\t\t\t\t\tscroll: false,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\twidth: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: obj => {\n\t\t\t\t\t\treturn `<span class=\"webix_scheduler_weekday\">${obj.day}</span> <span class=\"webix_scheduler_monthday\">${obj.date}</span>`;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.RefreshData();\n\t\t}\n\t}\n\n\tRefreshData() {\n\t\tlet start = this.data.start;\n\t\tconst data = [];\n\t\twhile (start < this.data.end) {\n\t\t\tconst obj = {\n\t\t\t\tday: webix.i18n.calendar.dayShort[start.getDay()],\n\t\t\t\tdate: start.getDate(),\n\t\t\t};\n\t\t\tif (isToday(start)) {\n\t\t\t\tobj.$css = \"webix_scheduler_list_today\";\n\t\t\t}\n\t\t\tdata.push(obj);\n\t\t\tstart = webix.Date.add(start, 1, \"day\", true);\n\t\t}\n\n\t\tconst header = this.$$(\"header\");\n\t\theader.clearAll();\n\t\theader.parse(data);\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { daysBetweenInclusive } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class MultiDayEventsView extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.cols[1] = {\n\t\t\tview: \"dataview\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tcss: \"webix_scheduler_multidays\",\n\t\t\tscroll: false,\n\t\t\theight: 32,\n\t\t\txCount: 7,\n\t\t\tyCount: 1,\n\t\t\twidth: 0,\n\t\t\ttype: {\n\t\t\t\twidth: \"auto\",\n\t\t\t\theight: \"auto\",\n\t\t\t\titemHeight: 36,\n\t\t\t},\n\t\t\ttemplate: \"\",\n\t\t\ttooltip: {\n\t\t\t\ttemplate: \"\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tsuper.init();\n\n\t\tSelectionMixin(this, \"multi\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.Events = new webix.DataCollection({});\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"multiday\");\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.ParseDays(this.data.multi);\n\t\t}\n\t}\n\n\tParseDays(events) {\n\t\tif (!events.length) return;\n\n\t\tthis.Events.clearAll();\n\t\tthis.Events.parse(events);\n\n\t\tconst days = [];\n\t\tfor (let d = 0; d < 7; d++) {\n\t\t\tdays.push({\n\t\t\t\tid: d + 1,\n\t\t\t\tdate: webix.Date.add(this.data.start, d, \"day\", true),\n\t\t\t});\n\t\t}\n\t\tthis.BreakEventsByDay(days);\n\n\t\tthis.SetMoreIcon(\n\t\t\tthis._maxEvents > this.maxVisibleLines ? this._expandState : null\n\t\t);\n\n\t\tthis.List.blockEvent();\n\t\tthis.List.parse(days);\n\t\tthis.ResetListHeight();\n\t\tthis.List.unblockEvent();\n\n\t\tthis.RenderEvents();\n\t}\n\n\tBreakEventsByDay(data) {\n\t\tthis.Days = [];\n\t\tconst processed = {};\n\t\tthis._maxEvents = 0;\n\n\t\tdata.forEach((day, dayIndex) => {\n\t\t\tconst today = day.date;\n\t\t\tthis.Days.push([]);\n\n\t\t\tthis.Events.data.each(ev => {\n\t\t\t\tif (!webix.isUndefined(processed[ev.id])) {\n\t\t\t\t\tif ((today <= ev.end_date && ev.all_day) || today < ev.end_date) {\n\t\t\t\t\t\tthis.Days[dayIndex][processed[ev.id]] = \"\";\n\t\t\t\t\t} else delete processed[ev.id];\n\t\t\t\t} else if (\n\t\t\t\t\tev.start_date < webix.Date.add(today, 1, \"day\", true) &&\n\t\t\t\t\tev.end_date >= today\n\t\t\t\t) {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\t// search for the first available index\n\t\t\t\t\twhile (!webix.isUndefined(this.Days[dayIndex][index])) index++;\n\n\t\t\t\t\tprocessed[ev.id] = index;\n\n\t\t\t\t\tconst config = {};\n\t\t\t\t\tconfig.es = ev.start_date;\n\t\t\t\t\tconfig.ee =\n\t\t\t\t\t\t!ev.all_day && !webix.Date.timePart(ev.end_date)\n\t\t\t\t\t\t\t? webix.Date.add(ev.end_date, -1, \"day\", true)\n\t\t\t\t\t\t\t: ev.end_date;\n\n\t\t\t\t\tconfig.length =\n\t\t\t\t\t\t1 +\n\t\t\t\t\t\tdaysBetweenInclusive(\n\t\t\t\t\t\t\t(config.ls = new Date(Math.max(this.data.start, config.es))),\n\t\t\t\t\t\t\t(config.le = new Date(Math.min(this.data.end - 1, config.ee)))\n\t\t\t\t\t\t);\n\n\t\t\t\t\tev.$config = config;\n\t\t\t\t\tthis.Days[dayIndex][index] = ev;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.Days[dayIndex].length > this._maxEvents)\n\t\t\t\tthis._maxEvents = this.Days[dayIndex].length;\n\t\t});\n\t}\n\n\tRenderEvents() {\n\t\tconst allEvents = this.Events.count();\n\n\t\tif (!allEvents) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t});\n\n\t\tlet html = \"\";\n\t\tlet renderedEvents = 0;\n\t\tconst toHide =\n\t\t\tthis._expandState === \"down\" && this._maxEvents > this.maxVisibleLines;\n\n\t\tthis.List.data.each((_day, dayIndex) => {\n\t\t\tconst dayHTML = [];\n\t\t\tconst visible = toHide\n\t\t\t\t? this.maxVisibleLines - 1\n\t\t\t\t: this.Days[dayIndex].length;\n\n\t\t\tfor (let i = 0; i < visible; ++i) {\n\t\t\t\tdayHTML[i] = this.Days[dayIndex][i];\n\n\t\t\t\tif (dayHTML[i]) {\n\t\t\t\t\tdayHTML[i] = this.ToHTML(dayHTML[i], dayIndex, i);\n\t\t\t\t\trenderedEvents++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\thtml += dayHTML.join(\"\");\n\t\t});\n\n\t\tif (toHide) {\n\t\t\thtml += this.MoreOption(allEvents - renderedEvents);\n\t\t}\n\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.List.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\tToHTML(obj, cIndex, rIndex) {\n\t\tconst style = dayEventColor(obj);\n\t\tconst size = this.GetSizePosition(obj.$config.length, cIndex, rIndex);\n\t\tconst css = this.GetStyle(obj, obj.$config);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\twebix_tooltip=\"${obj.text || _(\"(No title)\")}\"\n\t\t\t\twebix_e_id=\"${obj.id}\"\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${style}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj, c) {\n\t\tconst { start, end } = this.data;\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tif (c.es < start && webix.Date.equal(start, webix.Date.dayStart(c.ls)))\n\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\tif (\n\t\t\tc.ee >= end &&\n\t\t\twebix.Date.equal(\n\t\t\t\twebix.Date.add(end, -1, \"day\", true),\n\t\t\t\twebix.Date.dayStart(c.le)\n\t\t\t)\n\t\t)\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\treturn css;\n\t}\n\n\tMoreOption(excess) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst size = this.GetSizePosition(\n\t\t\tthis.List.config.xCount,\n\t\t\t0,\n\t\t\tthis.maxVisibleLines - 1\n\t\t);\n\n\t\treturn `<div webix_e_id=\"$wsh_multi_more\" class=\"webix_scheduler_multiday_event webix_scheduler_multi_more\" style=\"${size}\">${excess} ${_(\n\t\t\t\"more\"\n\t\t)}</div>`;\n\t}\n\n\tGetSizePosition(length, cIndex, rIndex) {\n\t\t// numbers are for space between events and borders of component\n\t\tconst width = length * this.List.type.width - 4;\n\t\tconst height = this.List.type.itemHeight - 8;\n\t\tconst left = this.List.type.width * cIndex + 1;\n\t\tconst top = rIndex * this.List.type.itemHeight + 4;\n\n\t\treturn `width:${width}px; height:${height}px; line-height:${height}px; left:${left}px; top:${top}px;`;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.List.$view);\n\t\tif (event.id) {\n\t\t\tif (event.id === \"$wsh_multi_more\") return this.ExpandData();\n\n\t\t\tconst obj = this.Events.getItem(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tExpandData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\n\t\t\tthis._expandState = \"up\";\n\t\t\tthis.Animate(\"up\");\n\n\t\t\tthis.ResetListHeight(this._maxEvents);\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tconst height =\n\t\t\t\tthis.List.$height -\n\t\t\t\t(this._maxEvents - this.maxVisibleLines) * this.List.type.height;\n\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\tthis.ResetListHeight(this.maxVisibleLines);\n\t\t\t});\n\t\t}\n\t}\n\n\tResetListHeight(count) {\n\t\tif (!count)\n\t\t\tcount =\n\t\t\t\tthis._expandState === \"down\"\n\t\t\t\t\t? Math.min(this._maxEvents, this.maxVisibleLines)\n\t\t\t\t\t: this._maxEvents;\n\n\t\tconst height = count * this.List.type.itemHeight;\n\t\tif (this.List.type.height !== height) {\n\t\t\tthis.List.type.height = height;\n\t\t\tthis.List.define(\"height\", height);\n\t\t\tthis.List.resize();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the data object for an event\n\t * @param {(string|number)} id - the ID of an event\n\t * @returns {Object} - the event object\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} id - the ID of a data item of the main view (corresponds to a day)\n\t * @returns {Date}\n\t */\n\tGetTargetDate(id) {\n\t\treturn id ? this.List.getItem(id).date : this.State.date;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport DayEventsView from \"../day/events\";\nimport WeekHeaderView from \"./header\";\nimport WeekEventsView from \"./compact\";\nimport HourscaleView from \"../common/hourscale\";\nimport MultiDayEventsView from \"./multiday\";\n\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class WeekView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tif (this.Compact) {\n\t\t\treturn {\n\t\t\t\trows: [WeekEventsView],\n\t\t\t};\n\t\t} else {\n\t\t\tconst days = {\n\t\t\t\tlocalId: \"scroll\",\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tscroll: \"y\",\n\t\t\t\tcss: \"webix_scheduler_week_days\",\n\t\t\t\tbody: {\n\t\t\t\t\tcols: [HourscaleView],\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst weekLength = 7;\n\t\t\tfor (let i = 0; i < weekLength; ++i) {\n\t\t\t\tdays.body.cols.push(\n\t\t\t\t\tnew (this.app.dynamic(DayEventsView))(this.app, {\n\t\t\t\t\t\tday: i,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\trows: [\n\t\t\t\t\tWeekHeaderView,\n\t\t\t\t\t{ localId: \"multi\", hidden: true, cols: [MultiDayEventsView] },\n\t\t\t\t\tdays,\n\t\t\t\t],\n\t\t\t};\n\t\t}\n\t}\n\tinit() {\n\t\tconst state = this.app.getState();\n\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\n\t\tif (!this.Compact) {\n\t\t\tthis.on(state.$changes, \"selected\", v => v && this.ScrollScale(v));\n\t\t}\n\t}\n\n\tRefreshData(date) {\n\t\tconst start = webix.Date.weekStart(date);\n\t\tconst end = webix.Date.add(start, 1, \"week\", true);\n\t\tthis.GetWeek(start, end).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetWeek(start, end) {\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(start, end)\n\t\t\t.then(evs => {\n\t\t\t\tif (this.Compact) {\n\t\t\t\t\treturn { start, end, all: evs };\n\t\t\t\t}\n\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn { start, end, multi, single };\n\t\t\t});\n\t}\n\n\tScrollScale(v) {\n\t\tif (v.id === \"0\" && !v.date) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst y = (new Date().getHours() + 2) * 40;\n\t\t\t\tthis.$$(\"scroll\").scrollTo(0, y);\n\t\t\t}, 100);\n\t\t}\n\t}\n}\n","import { ignoreInitial } from \"jet-restate\";\nimport { JetView } from \"webix-jet\";\nimport MoreWindowView from \"../month/more\";\n\nexport default class YearCalendarView extends JetView {\n\tconstructor(app, config) {\n\t\tsuper(app, config);\n\n\t\tthis._month = config.month;\n\t}\n\n\tconfig() {\n\t\tthis.DayEvents = {};\n\n\t\treturn {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\tevents: day => this.MarkEvent(day),\n\t\t\ticons: false,\n\t\t\tnavigation: false,\n\t\t\tcalendarHeader: \"%F\",\n\t\t\tskipEmptyWeeks: true,\n\t\t\tborderless: true,\n\t\t\tonClick: {\n\t\t\t\twebix_cal_day_with_event: e => this.ShowEvents(e),\n\t\t\t\twebix_cal_month: () => this.ShowMonth(),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_cal_day: e => this.ShowNew(e),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonChange: (date, mode) => mode === \"user\" && this.SetStateDate(date),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Calendar = this.getRoot();\n\t\tthis.Events = new webix.DataCollection({});\n\t\tconst state = (this.State = this.app.getState());\n\n\t\tthis.on(state.$changes, \"date\", date => this.ManageDateChange(date));\n\n\t\tthis.on(\n\t\t\tstate.$changes,\n\t\t\t\"active\",\n\t\t\tignoreInitial(() => this.RefreshData(this.GetMonthStart(state.date)))\n\t\t);\n\t\tthis.on(this.app, \"events:refresh\", () =>\n\t\t\tthis.RefreshData(this.GetMonthStart(state.date))\n\t\t);\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(this.GetMonthStart(state.date))\n\t\t);\n\n\t\tthis.Popup = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t\tdrag: false,\n\t\t\t})\n\t\t);\n\t}\n\n\t/**\n\t * Sets the date in the global reactive state\n\t * @param {Date} date\n\t */\n\tSetStateDate(date) {\n\t\tthis.State.date = webix.Date.dayStart(date);\n\t}\n\n\t/**\n\t * Switches the calendar to a new month and gets events for it\n\t * @param {Date} date\n\t */\n\tManageDateChange(date) {\n\t\tif (!this._date || this._date.getFullYear() != date.getFullYear()) {\n\t\t\tlet monthStart = (this.MonthStart = this.GetMonthStart(date));\n\t\t\tthis.Calendar.showCalendar(monthStart);\n\t\t\tthis.RefreshData(monthStart);\n\t\t}\n\t\tif (this._month === date.getMonth()) this.Calendar.setValue(date);\n\t\telse if (this.Calendar.getValue()) this.Calendar.setValue();\n\t\tthis._date = date;\n\t}\n\n\t/**\n\t * Gets the date at the start of the current month\n\t * @param {Date} date\n\t * @returns {Date}\n\t */\n\tGetMonthStart(date) {\n\t\treturn new Date(date.getFullYear(), this._month, 1);\n\t}\n\n\t/**\n\t * Gets events for the given month\n\t * @param {Date} monthStart - the start of the month\n\t */\n\tRefreshData(monthStart) {\n\t\tthis.DayEvents = {};\n\t\tconst monthEnd = webix.Date.add(monthStart, 1, \"month\", true);\n\n\t\tthis.Data.getEvents(monthStart, monthEnd).then(data => {\n\t\t\tthis.Events.clearAll();\n\t\t\tthis.Events.parse(data);\n\t\t\twhile (monthStart < monthEnd) {\n\t\t\t\tlet next = webix.Date.add(monthStart, 1, \"day\", true);\n\t\t\t\tdata.forEach(obj => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(obj.all_day\n\t\t\t\t\t\t\t? obj.end_date >= monthStart\n\t\t\t\t\t\t\t: obj.end_date > monthStart) &&\n\t\t\t\t\t\tobj.start_date < next\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst dateKey = monthStart.valueOf();\n\t\t\t\t\t\tif (!this.DayEvents[dateKey]) this.DayEvents[dateKey] = [];\n\t\t\t\t\t\tthis.DayEvents[dateKey].push(obj.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmonthStart = next;\n\t\t\t}\n\t\t\tthis.Calendar.refresh();\n\t\t});\n\t}\n\n\t/**\n\t * Adds dots to days with events\n\t * @param {Date} day - the date\n\t * @returns {string} the name of the CSS class\n\t */\n\tMarkEvent(day) {\n\t\tlet css = webix.Date.isHoliday(day) || \"\";\n\t\tif (this.DayEvents[day.valueOf()]) css += \" webix_cal_day_with_event\";\n\t\treturn css;\n\t}\n\n\t/**\n\t * Returns a timestamp of the day that was clicked\n\t * @param {MouseEvent} e - the mouse event\n\t * @returns {number|null} the timestamp or null\n\t */\n\tGetDay(e) {\n\t\tconst day = e.target.innerHTML;\n\t\tif (day) return new Date(this.MonthStart).setDate(day * 1);\n\t\treturn null;\n\t}\n\n\t/**\n\t * Shows a popup with a list of events for the day\n\t * @param {MouseEvent} e - the mouse event\n\t */\n\tShowEvents(e) {\n\t\tconst date = this.GetDay(e);\n\t\tif (date) {\n\t\t\tconst data = this.DayEvents[date];\n\t\t\tthis.Popup.ShowWindow(date, e.target.parentNode, data || []);\n\t\t}\n\t}\n\n\t/**\n\t * Opens this day and opens the form with data for a new event\n\t * @param {MouseEvent} e - the mouse event\n\t */\n\tShowNew(e) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = this.GetDay(e);\n\t\t\tif (date) {\n\t\t\t\t// no $batch because view needs to be ready\n\t\t\t\tstate.mode = \"day\";\n\t\t\t\tstate.selected = { id: \"0\", date };\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Opens the month view for the selected month\n\t */\n\tShowMonth() {\n\t\tthis.State.$batch({\n\t\t\tmode: \"month\",\n\t\t\tdate: this.MonthStart,\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport YearCalendarView from \"./calendar\";\n\nexport default class YearView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\tpadding: 20,\n\t\t\t\tview: \"flexlayout\",\n\t\t\t\tcss: \"webix_scheduler_year\",\n\t\t\t\tcols: this.GetCalendars(),\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Creates 12 calendars for each month of the current year\n\t * @returns {Array} an array of calendar views\n\t */\n\tGetCalendars() {\n\t\tconst calendars = [];\n\t\tfor (let i = 0; i < 12; i++) {\n\t\t\tcalendars.push(\n\t\t\t\tnew (this.app.dynamic(YearCalendarView))(this.app, { month: i })\n\t\t\t);\n\t\t}\n\t\treturn calendars;\n\t}\n}\n","/*Thai (Thailand) locale\n * modified to use Budhist Era Years\n */\n \nwebix.i18n.locales[\"th-TH\"] = {\n   groupDelimiter: \",\",\n   groupSize: 3,\n   decimalDelimiter: \".\",\n   decimalSize: 2,\n   dateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(`%j/%m/${date.getFullYear() + 543}`);\n      return format(date);\n   },\n   timeFormat: \"%G:%i\",\n   longDateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(`%j %F ${date.getFullYear() + 543}`);\n      return format(date);\n   },\n   fullDateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(\n         // `%j %F ${date.getFullYear() + 543} %G:%i`\n         `%d/%m/${date.getFullYear() + 543} %G:%i`\n      );\n      return format(date);\n   },\n   am: [\"am\", \"AM\"],\n   pm: [\"pm\", \"PM\"],\n   price: \"{obj}\",\n   priceSettings: {\n      groupDelimiter: \",\",\n      groupSize: 3,\n      decimalDelimiter: \".\",\n      decimalSize: 2,\n   },\n   calendar: {\n      monthFull: [\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n      ],\n      monthShort: [\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n         \"..\",\n      ],\n      dayFull: [\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n         \"\",\n      ],\n      dayShort: [\".\", \".\", \".\", \".\", \".\", \".\", \".\"],\n   },\n   aria: {\n      dateFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(\n            `%d %F ${date.getFullYear() + 543}`\n         );\n         return format(date);\n      },\n      monthFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(`%F ${date.getFullYear() + 543}`);\n         return format(date);\n      },\n      yearFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(`${date.getFullYear() + 543}`);\n         return format(date);\n      },\n   },\n};\n","/**\n * webixResources.js\n * This file should include all extra webix resources (components, locales, etc.)\n * This will be bundeled by webpack into a single file and loaded as a dynamic\n * import after webix is loaded.\n *\n * Notes:\n * - use `webpackMode: \"eager\"` comment to include the dynamic import in this\n *   package\n */\n\n// Components\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/gantt/gantt.min.js\"\n).then((gantt) => (window.gantt = gantt));\nimport \"./components/hint/hint.js\";\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/kanban/kanban.min.js\"\n).then((kanban) => (window.kanban = kanban));\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/pivot/pivot.min.js\"\n).then((pivot) => (window.pivot = pivot));\nimport \"./components/query/query.min.js\";\n// Should use webix/query, querybuilder no longer maintained\n// But we still use this in some places (processing record rules, etc)\nimport \"./components/querybuilder/querybuilder.min.js\";\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/reports/reports.min.js\"\n).then((report) => (window.reports = report));\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/scheduler/scheduler.min.js\"\n).then((scheduler) => (window.scheduler = scheduler));\n\n// Locales\nimport \"./locales/th-TH.js\";\n"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","id","module","exports","webix","config","this","webixJet","_events","_subs","_data","params","extend","JetBase","_root","_detachEvents","_destroySubs","_container","app","_parent","value","url","_segment","update","show","parent","view","getParentView","getParam","suburl","toString","root_1","getRoot","queryView","obj","localId","$scope","name","attachEvent","push","key","kid","contains","sub","getSubViewInfo","subview","popup","events","i","length","detachEvent","subView","destructor","current","default","branch","child","_getDefaultSub","_routed_view","parse","substr","parts","split","chunks","test","result","pos","indexOf","params_1","_i","dchunk","decodeURIComponent","page","isNew","url2str","stack","stack_1","chunk","obj2str","join","str","encodeURIComponent","c","route","index","_next","path","Route","slice","setParams","old","kids","reset","concat","_join","Promise","res","rej","redirect","confirm","callEvent","catch","err","then","NavigationBlocked","_this","n","_super","_children","__extends","JetView","ui","container","jetview","createView","render","setParam","parent_1","target","_renderFrameLock","_show","segment","_init_url_data","_urlChange","linkRouter","getRouter","set","silent","_$view","_$","_$url","message","destroy","_destroyKids","plugin","getUrl","tagName","refresh","_render","root","r","document","body","toNode","cfg","_render_final","response","slot","$$","reject","copyConfig","oldui","parent_2","asWin","setPosition","isVisible","_init","_initUrl","ready","_initError","init","waits","frame","wait","all","urlChange","lock","_renderFrame","next","_createSubView","shift","_override","error","createFromURL","uis","_ui","JetViewRaw","cb","SubRouter","a","append","_once","t","window","version","start","_services","EventSystem","JetAppBase","_subSegment","handler","getSubView","prototype","$subview","addSubView","isArray","Array","method","point","DataCollection","RegExp","Map","Date","copy","$router","srcElement","getAttribute","trigger_1","_forView","trigger","cancelBubble","preventDefault","route_1","parentNode","clickHandler","views","_loadError","hidden","replace","require","__esModule","loadView","over","override","dv","get","router","rest","apply","data","bind","er","debug","console","text","innerHTML","type","expire","event","_first_start","top","base","setTimeout","animation","node_1","html","addCss","removeCss","now","urlString","template","uid","_detectPrefix","onpopstate","HashRouter","routes","compare","history","pushState","prefix","sufix","_getRaw","routerPrefix","location","href","isPatched","patch","w","win","promise","freeze","some","$freeze","resize","baseAdd","baselayout","addView","baseRemove","removeView","jview_1","subs_1","arguments","subs","layout","protoUI","$init","$app","$ready","proxy","JetApp","UrlRouter","pathname","search","_$config","EmptyRouter","has","store","Object","hasOwnProperty","call","forEach","context","warn","x","String","russianPluralGroups","end","pluralTypes","arabic","lastTwo","bosnian_serbian","chinese","croatian","french","german","russian","lithuanian","czech","polish","icelandic","slovenian","pluralTypeToLanguages","escape","token","dollarRegex","defaultTokenRegex","transformPhrase","phrase","substitutions","locale","tokenRegex","TypeError","interpolationRegex","options","smart_count","texts","count","ret","langToPluralType","langs","lang","en","pluralTypeName","expression","argument","Polyglot","opts","phrases","currentLocale","allowMissing","onMissingKey","suffix","RangeError","interpolation","newLocale","morePhrases","prefixedKey","unset","clear","newPhrases","_","webixPolyglot","plugins","_view","storage","setLangData","pconfig","polyglot","poly","service","put","locName","i18n","setLocale","setLang","getLang","setService","once","setSize","appView","appWidth","$width","appHeight","$height","_fillApp","define","width","height","left","link","source","defineProperty","createState","handlers","out","observe","mask","queue","waitInQueue","notify","meta","list","enumerable","configurable","values_1","sconfig","nested","reactive","$extend","val","valueOf","DragScroll","ctx","_auto_scroll_delay","delay","autoScroll","clearTimeout","yScroll","direction","xScroll","box","offset","from","$view","autoYScroll","senseY","autoXScroll","senseX","DragControl","active","node","getNode","$dragPos","style","y","sense","scroll","getScrollState","autoScrollTo","snode","Math","min","scrollWidth","mode","scrollTo","abs","initDnD","ctrl","master","Local","getService","addDrag","addDrop","getMoveMode","rect","getBoundingClientRect","p","minWidth","env","touch","delta","updateDragScrollConfig","ds","scales","getScales","round","cellWidth","cellHeight","$longTouchLimit","$dragCreate","pointer","State","readonly","getContext","$touch","locateEvent","item","getItem","$group","classList","Modes","getItemNode","scroll_1","evContext","getEventContext","step","precise","nsc","getSmallerCount","minUnit","dx","querySelector","parseInt","l","dragScroll","cloneNode","className","visibility","cursor","appendChild","display","$dragDestroy","$waitUpdate","Action","action","finally","remove","$dragIn","s","$dragOut","$drop","time","timeShift","ev","elementFromPoint","locate","changedTouches","touches","pageX","pageY","clientX","clientY","setDragOffset","x_offset","y_offset","nscroll","max","links","css","fromStart","opacity","create","toStart","linkType","targetId","move","progress","prevProgress","progressNode","updateTaskTemplate","zIndex","boxShadow","contrast","dark","skin","$name","isUndefined","DragProgressTemplate","selection","class","tb","floor","offsetX","getIdByIndex","dates","BarsView","borderless","cells","relative","BarsType","on","onItemClick","ItemClickHandler","tooltip","GetTooltip","_a","getChildViews","holidays","bars","Holidays","Links","Bars","Ops","Helpers","local","linkCollection","ldata","LinksData","Calendars","resourceCalendars","HandleScroll","HandleDrag","HandleSelection","InitMarkers","HandleHolidays","$changes","v","SyncData","refreshLinks","RefreshLinks","RenderResourceHolidays","DrawGrid","VisibleTasks","ApplySelection","o","showCriticalPath","assignments","excludeHolidays","task","tasks","updateAssignedTaskDates","updateScaleMinMax","$batch","selected","backgroundImage","drawGridInner","marginTop","state","getState","backgroundPosition","Resize","unselect","clearAll","getVisibleTasksCollection","taskCalendarMap","sync","$data","GetSplitBox","top_1","html_1","order","isLast_1","TemplateStart","BarsTemplate","TemplateEnd","templateStart","isLast","templateEnd","last","first","$x","$w","rwidth","$y","$h","h","diff","BarCSS","contentCss","ContentCss","ceil","sqrt","pow","drag","baseline","planned_start","TemplateBaseline","$x0","$w0","$critical","_mousemove_handler","pointerType","eventRemove","_scroll_handler","markers","m","$interval","clearInterval","temp","scrollTop","scrollLeft","holidaysContainer","containerForMarkers","lines","GetLinks","attrs","viewBox","scrollHeight","setAttribute","SetHolidaysScroll","resources","resourcesDiagram","resHolidaysContainer","selLine","insertBefore","firstChild","ind","getIndexById","exists","ScrollToTask","RenderMarkers","start_date","setInterval","GetMarkerPosition","MarkerTemplate","date","astart","getUnitStart","startOnMonday","links_1","each","$p","critical","criticalPath","isLinkCritical","LinksTemplate","setHTML","tid","find","updateLink","area","minHeight","ops","inProgress","updateTaskTime","refreshTasks","RefreshTaskLinks","updateTask","addLink","newLink","top_2","shift_1","points","map","unit","getSmallerUnit","addUnit","splitCont","sort","b","_b","RenderHolidays","func","dayStart","add","hourOffset","getHours","equal","timePart","html_2","EachScaleDate","isHoliday","HolidayTemplate","calendar","dateStart","isResourceHoliday","ResourceHolidayTemplate","ResourceWorkDayTemplate","taskId","MarkResourceHolidays","GetDateBox","parser","longDateFormatStr","tip","end_date","duration","ScalesView","RenderScales","rows","line","canMarkHolidays","cell","CellTemplate","FormatDate","format","dateToStr","ChartView","ScaleView","hide","DiagramView","WorkloadMarkersType","filterMode","showSubItems","level","LocalState","Unit","Scales","RDCollection","getRDCollection","RestoreTreeState","filter","ToggleBranch","by","dir","as","open","close","getBranch","opened","_treeOpened","clientHeight","t_1","openAll","u","common","MarkerStartTemplate","classname","aria","$level","GetMarkerData","MarkerToHTML","resId","resource_id","calendarId","calendar_id","calendars","d","hourParts","units","markerWidth","halfStep","CheckResourceHoliday","hours","overloaded","CheckOverload","marker","unitLoadNorm","day","number","localeCompare","ignorePunctuation","numeric","arrayEquals","every","includes","TreeView","compact","Compact","columns","header","TreeTemplate","fillspace","batch","tree","prerender","treeWidth","rowHeight","headerRowHeight","scrollAlignY","resizeColumn","headerOnly","size","onViewResize","Tree","onAfterOpen","onAfterClose","onAfterSort","SortTasks","onColumnResize","user","NormalizeColumns","onClick","gti-menu","ToggleColumns","ls","_unit","_collapsed","ShowInUnits","col","columnId","getColumnConfig","refreshColumns","icon","treetable","category","resourceAvatar","space","cols","lastFillspace","showColumnBatch","SetColumns","getColumnIndex","lv","isColumnVisible","cv","vis","hideColumn","showColumn","RDiagramView","elements","onChange","localState","radio","words","BaselineView","icons","autoheight","elementsConfig","labelPosition","padding","right","visibleBatch","label","suggest","autowidth","click","AddBtnClickHandler","RemoveBtnClickHandler","UpdateTaskTime","UpdateTask","Form","Tasks","FillData","showBatch","setValues","vals","f","_eventSource","$eventSource","updateDates","planned_end","planned_duration","getValues","PrepareDates","updatePlannedTaskDuration","blockEvent","unblockEvent","TableView","table","editable","hover","scheme","ttype","conf","collection","editor","onBeforeEditStart","onBeforeEditStop","UpdateLink","row","onAfterLoad","wxi-trash","title","DeleteLink","$active","layoutMargin","form","bottom","_id","related","getLinks","editCancel","updateItem","removeLink","editors","gantt_numeditor","inp","ResourcesView","single","IsSingle","button","editaction","ResourceTemplate","listItemHeight","OptionTemplate","EditorOptionTemplate","ValueTemplate","editFormat","parseFloat","editParse","isNaN","DeleteIconTemplate","Table","column","editRow","getEditor","getPopup","focus","addCellCss","resource","FilterOptions","onAfterEditStart","getInputNode","range","GetRange","ApplyEditorLimits","GetValueStep","ApplyEditorStep","removeCellCss","ApplyValueRange","UpdateAssignment","webix_gantt_remove_icon","RemoveAssignment","margin","Resources","getAssignments","assignees","GetData","disable","enable","sortResources","tableIds","rInd","updateAssignment","CloseEditor","resourceItem","getResourceValueRange","getResourceValueStep","removeAssignment","ShowPopup","addAssignment","getDefaultResourceValue","EditorTemplate","GetUnitName","getResourceUnit","fitMaster","AddAssignment","Popup","GetPopupConfig","SetPopupPlaceholder","placeholder","getBody","FormView","isResources","aSkin","bar","layoutPadding","inputHeight","Close","Done","types","projects","splice","accItems","collapsed","accordion","multi","ToggleControls","typeSelect","SetResourceHolidays","SetBaselineVisibility","typeList","getList","$count","LimitTypeOptions","SetResourcesVisibility","RemoveTagsFromText","updateTaskDuration","_inProgress","isDirty","Back","exit","edit","arr","els","getTaskCalendar","el","TaskView","editButton","EditTask","info","InfoTemplate","deleteButton","align","inputWidth","DeleteTask","Text","FillTemplate","sources","targets","removeTask","BaseTemplate","LinkTemplate","BaselineTemplateChunk","details","DateFormat","InfoTemplateChunk","ResourcesTemplateChunk","maxWidth","s0","getTextSize","s1","avatar","dpt","TaskPopup","updateConfig","fullscreen","head","maxAvatarNumber","TitleTemplate","dateFormatStr","ResourcesTemplate","unshift","select","wxi-plus","AddTask","wxi-plus-circle","onBeforeOpen","HandleToggle","onBeforeSelect","BeforeSelectHandler","onBeforeDrag","BeforeDragHandler","onBeforeDrop","BeforeDropHandler","Mode","Assignments","pid","$dragHTML","moveTask","resDisplayed","clearEvID","RefreshData","loaders","waitData","GetLoaders","ApplySorting","getSelectedId","pdata","_isTaskVisible","showItem","setState","newTask","GetNewTask","AddTaskWithAssignment","assigned","SplitTaskWithAssignment","splitTaskWithDnd","addTask","GetDates","waitArr","getParentId","rId","sibling","aops","dataSorter","sortState","RefreshTasks","assigned_1","GetAssignmentsHTML","assignedArr","num","pop","lastStr","numStr","TopView","sizeTrigger","_compactValue","_compactHandler","_app","_forceCompact","forceCompact","_compactWidth","compactWidth","_checkTrigger","$setSize","fCompact","SetCompactMode","oid","ShowTask","HideTask","ProgressBar","showProgress","hideProgress","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","resetScales","dateToLocalStr","parseFormat","scaleStart","scaleEnd","oldScale","_scales","_scaleBase","setScales","_taskHeight","refreshResourceTasks","preciseTimeUnit","scaleCellWidth","barHeight","borderWidth","force","_tasks","createTasks","getTreeData","TreeCollection","data->onStoreLoad","data->onStoreUpdated","_links","$change","parseFormatDate","$css","$sort","$serialize","taskOut","$export","updID","k","refreshBaseline","createLinks","found","tcollection","taskParent","$parent","taskSplit","_categories","categories","_resources","rData","ctg","_assignments","aCopy","assign","_calendars","createCalendars","weekDays","datePart","clean","getRange","latestDate_1","isTaskCritical","latestDate","dependent","isNoSlack","nextStart","currentEnd","g","getResourceTree","_calendarMap","refreshCalendarMap","cal","grouping","collections","Infinity","_url","Backend","ajax","json","post","del","_local","_helpers","_back","_state","Operations","addMode","cleanData","added","adjustScale","completeAdd","position","syncProject","inner","updatePlanned","removeAssignments","syncTasks","field","_updatePlannedTaskDuration","change","getWorkDateDiff","p_1","eachSubItem","newDate","changedKid","sign","ad","setProjectData","offsetDate","us","completeRemoval","linkExists","duplicate","oldParent","oldIndex","getBranchIndex","reorderTask","collection_1","waitArr_1","toInteger","dirtyNumber","NaN","Number","requiredArgs","required","args","toDate","argStr","getTime","addDays","dirtyDate","dirtyAmount","amount","setDate","getDate","addMonths","dayOfMonth","endOfDesiredMonth","setMonth","getMonth","setFullYear","getFullYear","addMilliseconds","timestamp","startOfWeek","dirtyOptions","localeWeekStartsOn","weekStartsOn","defaultWeekStartsOn","getDay","setHours","getTimezoneOffsetInMilliseconds","utcDate","UTC","getMinutes","getSeconds","getMilliseconds","setUTCFullYear","startOfDay","compareAsc","dirtyDateLeft","dirtyDateRight","dateLeft","dateRight","differenceInMilliseconds","roundingMap","trunc","getRoundingMethod","isLastDayOfMonth","endOfDay","month","endOfMonth","differenceInMonths","difference","monthDiff","differenceInCalendarMonths","isLastMonthNotFull","year","differenceInCalendarYears","isLastYearNotFull","quarter","roundingMethod","week","startOfWeekLeft","startOfWeekRight","timestampLeft","timestampRight","startOfDayLeft","startOfDayRight","hour","minute","smallerCount","months","days","innerDiff","prev","wt","filled","getDiff","sameMonth","daysOfFirstMonth","me","setSizes","taskHeight","startDate","endDate","ms","getMilestone","getEnd","getEndWorkday","setMinutes","setSeconds","setMilliseconds","holidayGuard","getDuration","toFixed","toClosestWorkday","notRight","alert","toWorkday","getCheckDate","getTimezoneOffset","defaultResourceUnit","defaultResourceValues","resourceValueRanges","resourceValueSteps","initials","match","charAt","toUpperCase","charCodeAt","cssClass","withTooltip","txt","avatarCss","inc","getTaskHeight","len","tempEnd","fullWidth","fullHeight","countInWeeks","cdate","cnext","startTask","endTask","dy","s_start","e_start","sx","sy","ex","ey","lineCoords","gapp","sx1","ex1","same","arrowCoords","color","canvas","createElement","strokeStyle","moveTo","lineTo","stroke","toDataURL","helpers","closedResources","Grouping","_rdCollection","Group","syncRDWithData","getDiagramItemData","groupResourceDiagram","refreshTaskDiagram","updateUnitDurations","updateTaskDiagram","refreshResourceDiagram","assignment","calculateUnitDuration","calculateLoad","truncateX","getUnitLoad","startUnitEnd","load","startUnitStart","endUnitStart","days_1","findUnitDuration","days_2","plusUnit","getDifference","checkHoliday","pruneDiagram","rec","oa","toRemove","eachLeaf","group","collect","_resourcesTree","resourceTaskLoader","syncResourceTree","task_1","tasksWithResources","getResourceTaskData","eachChild","inTree","becomesTask","pId","refreshResourceTree","unassignedBranch","checkResourceOpen","property","ws","sum","j","appId","defaults","dynamic","appNode","addStyle","firstShow","defaultHandler","onShow","$destructed","resizeEv","setHandlers","use","App","locales","$exportView","export_mode","reload","jetapp","services","Edit","Delete task","Delete link","The task will be deleted permanently, are you sure?","The link will be deleted permanently, are you sure?","Predecessors","Successors","Title","Start date","End date","Duration","Progress","Notes","Type","Project","Milestone","Add task","Add project","(no title)","Save changes?","Related tasks","Task","Link","End to start","Start to start","End to end","Start to end","Lasts","Add assignment","Assignment","Assigned","Delete assignment","Are you sure to delete this assignment?","No resources to add","Unassigned","Hours per","Tasks per","Name","Hours","Split task","Planned dates","Planned dates will be removed, are you sure?","Add dates","Remove dates","$kanban","$skin","_template_types","subtype","on_click","kanban","getKanban","setListStatus","MouseEvents","images","jpg","jpeg","png","gif","ppt","pptx","pptm","pps","ppsx","ppsm","doc","docx","docm","xls","xlsx","xlsm","xlsb","pdf","wav","aif","mp3","mid","mpg","mov","wmv","avi","mp4","zip","jar","rar","gz","isImage","toLowerCase","attachments","comments","cardActions","templateTags","tags","_tags","tag","templateIcons","templateAvatar","users","_users","user_id","image","templateBody","templateAttachments","templateFooter","_colors","KanbanView","on_context","_kanban_event","_fixOrder","$index","sid","tindex","tobj","DataMove","statusChange","dp","status","ignore","webix_move_index","webix_move_id","webix_move_parent","serverStatus","save","_setHandlers","eachOtherList","webix_kanban_user_avatar","_handle_icons","webix_kanban_footer_icon","_typeof","$drag","drag_container","$dropHTML","self","eachList","dtype","defaultSetter","defaultFilter","dataview","files","sizetext","_format_size","dnd","hideOverlay","showOverlay","getValue","fileSize","uploader","removeIcon","percent","preventEvent","modal","paddingX","paddingY","_close","$hide","yCount","_statuses","upload","onItemDblClick","getElementsByTagName","values","_removeCard","_fixStatus","$list","_afterInit","_form","_removeBtn","_header","addDropZone","OverlayBox","_sublists","getForm","listIndex","_assignList","_prepareEditor","unselectAll","selectedTask","masterId","contextmenu","cid","showEditor","_hide_chat","_save","serialize","delimiter","provideApi","_strToArr","_destroy_with_me","_data_unification","colors","reconstruct","_initEditor","_initUserList","_initMenu","_initComments","_this2","_applyOrder","oldid","newid","getOwnerList","changeId","_serialize","getTags","getUsers","getColors","getStatuses","cardActions_setter","menu","defer","callback","_this3","_editor","getUserList","_userList","getMenu","_menu","getComments","_comments","_this4","userList","userlist","_this5","setContext","_this6","_this7","chat","_syncData","subList","prevList","_prepareLists","_subfilters","statuses","sets","importData","DataLoader","headerlayout","[object Object]","param","super","jview","$reorderOnly","object","operation","fixMath","math","getField","name2","askin","portlet","Property","plusLabel","inputPadding","webix_pivot_handle_add_value","forms","Add","input","triggerEvent","fields","GetValue","_activeInput","wavg","getFormView","corrections","GetCorrections","CheckCorrections","structure","getStructure","external","ItemConfig","PrepareValue","onBeforeShow","FilterSuggest","ListTemplate","pivotPropertyRemove","activeVal","isSymbolAllowed","char","getLastSymbolIndex","startsWith","_addFirst","$enterKey","selectionStart","substring","nextSymbol","disabled","operations","suggestClick","activeElement","UIManager","getFocus","setValue","setValueHere","formula","str1","str2","lastSymbol","$setValue","setSelectionRange","ValuesProperty","typeName","ToggleColors","OutComplexMath","def","defaultOperation","defIndex","findIndex","SetOperation","getOperation","SuggestData","mini","palette","getPalette","getValueColor","fieldsRegex","fieldsMatch","matchAll","methods","methodsRegex","methodsMatch","GroupProperty","oldValue","ChartSettings","complexData","labelWidth","labelRight","checkValue","uncheckValue","OutValues","innerChange","chart","HandleVisibility","InValues","stackedArea","stacked","horizontal","TableSettings","datatable","footer","totalColumn","FilterView","filters","filterObj","collectFieldValues","ModeView","toolbarHeight","optionWidth","SetMode","dataPadding","ToolbarView","buttonHeight","ToggleConfig","webix_pivot_settings","scrollSize","$customScroll","_GetScrollWidth","GetFilters","filterPopup","filtersView","FiltersChanged","ToggleReadonly","oldStructure","JSON","stringify","FilterConfig","activeCss","condition","webix_pivot_filter","Show","outer","scrollbarWidth","offsetWidth","removeChild","$mainView","xAxis","yAxis","commonAxisSettings","scaleColor","lineColor","IsPieBased","multilevel","ValueFormat","pieInnerText","LoadData","getData","UpdateChart","removeAllSeries","SetSeries","SetLegend","addSeries","GetSeriesConfig","settings","alpha","borderColor","legend","valign","hotkey","ToggleForm","GroupConfig","_v","HandleFieldChange","SetValues","oldMode","isChart","SetValue","CorrectFilters","CorrectInputs","setStructure","groupBy","inputs","ShowConfig","HideConfig","leftSplit","UpdateTable","CheckFreeze","rightSplit","totalCols","totalOps","total","lastId","colspan","totalIndex","_store","_prepareData","marks","Proxy","prop","freezeColumns","SetFirstColumn","CellFormat","cssFormat","rid","HeaderTemplate","asc","desc","DataDimension","_sort","_label","_meta","_table","_getter","_prepared","_indexes","_values","_prepareOptions","_keys","fSize","indexes","DataExport","pivot","_pivot","cleanRows","maxRow","getLimit","resetCursor","Set","rAggr","rowData","cAggr","scaleWidth","getWidth","_cleanRows","columnData","aggregateColumns","mark","getXHeader","rowsLength","Function","propertyName","methodName","contextName","optimize","allMath","getMath","to","array","getter","cache","optimizeRangeGroup","optimizeGroup","rule","getColumn","and","buildFinder","check","DataPivot","_rows","_cols","_dims","_context","_cursor","_order","_base_order","getIndexes","_group","_nextRow","_nextColumn","_ops","dimsSize","_fillRow","dimSize","dimOutSize","levels","_groupOps","_groupLength","limit","_sizes","getSize","closeLevels","kAgr","vAgr","z","_fillGroupRow","hConfig","_opInfo","nonEmpty","isNested","rpref","ostep","unitsInParent","reduce","fullLength","unitSizes","opNames","rowspan","getLabel","metaLine","getMeta","rules","_masterRules","_groupResultOps","branchMode","branchMath","_rowResultOps","compactOps","op","_rowOps","_colResultOps","_colOps","_marks","_setSizes","dmr","opsLength","rarr","_fillGroupRowInner","rl","collectRaggr","ctemp","cfrom","cind","cto","opset","dataset","raws","dimsData","ok","sizes","kind","optimizer","getName","trim","RawTable","_columns","_raw","_parse_inner","dataLength","columnsLength","setter","ColumnTable","_parse_init","acc","avg","summ","any","eq","neq","gt","gte","lt","lte","in","hasPrefix","predicates","Analytic","_tables","_dimensions","_preds","_maths","_comps","tables","addTable","dimensions","addDimension","_predicateGetter","preserve","used","driver","prepare","rDims","cDims","fn","LocalData","_filtersHash","externalProcessing","_setOperations","_initRengine","extraOperations","_reng","addMath","totalOperations","addComparator","addPredicate","firstRow","dataType","useOldData","_dataLoad","_rengineToWebix","getTable","getPivotData","loadError","newConfig","_old","rengine.Analytic","_setFilters","_setTotalOperations","_setPredicates","setDimensions","getRows","getColumns","getLimits","getOps","headerConfig","toArray","toNested","toXHeader","isComplex","_updateTotalMath","minY","maxY","minX","maxX","getChartData","getHeader","_toTree","getFields","prepareData","fieldObj","hash","predicate","replaceAll","struct","hdata","resetDimensions","chartType","axis","pieGroup","rowIndex","columnIndex","scale","prepareStructure","initial","exportView","Chart","Click to configure","Configure Pivot","Total","Fields","Methods","Columns","Add column","Rows","Add row","Clean rows","Filters","Add filter","Group By","Chart type","Logarithmic scale","X axis title","Y axis title","Scale color","Circled lines","Horizontal","Stacked","Lines","Line","Radar","Bar","Area","Spline","Spline Area","Pie","Donut","Values","Add value","Field not defined","Highlight","Min X","Max X","Min Y","Max Y","Footer","Total Column","Off","On","Sum Only","3D","Show values inside","complex","Incorrect formula in values","ignoreInitial","withContext","BaseExportView","subMenuPos","subsign","GetTemplate","submenuConfig","onMenuItemClick","PopupAction","BaseToolbarView","ShowExportPopup","viewId","ExportMenu","Toolbar","Charts","Host","mod","Export","host","CheckColumns","config_1","GetChartConfig","GetChartData","seriesFrom","ConvertDataBySeries","FormatLabels","numLimit","labelColumn","labelOptions","option","undefined","legendPosition","series","axises","seriesConfig","ApplyTypeConfig","onAfterRender","CorrectLabels","GetLegendConfig","logarithmic","verticalLabels","itemTypes","itemSupport","markerType","getDataConfig","getOptions","fill","radius","fillMarker","disableItems","border","baseColumn","dataColumn","aRow","toPNG","toPDF","bindOut","newValue","subkey","_value","factory","heatmap","empty","main","alt","CommonView","JoinListTemplate","webix_rpt_action_remove","RemoveJoin","ShowJoins","AppState","Models","getModels","ShowDeleteButton","SourcesList","JoinTemplate","AddJoin","addJoin","joins","cleanLinkedModels","block","sf","tf","getLinkedModels","toolbar","prompt","getTopParentView","newname","selectMask","$cssName","webix_rpt_qselect_icon","richselect","extendStatics","setPrototypeOf","__proto__","__","constructor","__assign","getUrlString","_loadViewDynamic","_loop_1","webix$1","key2","ActionsPopupView","Item","Hide","BaseView","GetButton","GetList","AND","OR","GLUE","glue","editCss","DisableSwitch","Template","action-menu","Actions","action-close","Delete","wbq-filter_join","SwitchGlue","EditStart","EditStop","AddGroup","LastValue","ConvertTo","ConvertFrom","after","getFirstId","CreateMode","Save","DeleteSilent","grand","pIndex","Active","ActiveId","asString","Format","AdjustToField","ApplyFilter","GetField","fselect","CreateFilter","conditions","place","FilterPopup","at","TopBarView","TopListView","log","queryToFilter","query","con","glueOr","glueAnd","simple","GetFilter","getFilterFunction","notEqual","less","greater","greaterOrEqual","lessOrEqual","notContains","beginsWith","notBeginsWith","endsWith","notEndsWith","between","notBetween","or","Add Filter","Add Group","Apply","Cancel","QueryView","getFieldData","model","fixDates","$observe","QueryBuilderView","DeleteQuery","CopyQuery","RenameQuery","SaveQuery","QSelectTemplate","onClearClick","NewQuery","Query","qData","Queries","getQueries","saved","models","changed","saveBtn","updateQuery","addQuery","cancel","deleteQuery","QueryMenu","tabbar","tabMinWidth","ShowView","newModule","ChangeModule","ChangeModel","ShowHideButton","timer","debounce","TrackChanges","_key","oldColumns","numColumns","UpdateMeta","publicFields","prev_1","groupColumns","was_1","now_1","Reset","getModuleSaveData","moduleId","updateModule","SaveCallback","addModule","getModule","setDataSource","InitStateValue","InitName","getSeries","masterName","SummaryPopupView","ClickHandler","GetOptions","ApplyAction","SetActionStates","disableItem","enableItem","pstate","ParentState","BucketView","ValueSeparator","other","Changed","isNotEmpty","AddNewBucket","Forms","GetRowKeys","Data","Sort","CreateForm","Focus","keys_1","GetColumnData","baseOptions","keyOption","appState","moduleConfig","buckets","getOptionsList","LoadBuckets","AddBucket","bucket","LoadOther","GetRowForm","separator","ActiveForm","GetValues","otherForm","otherName","validate","names","ForEachFormRow","markInvalid","CorrectValues","GetValidBuckets","$checked","DeleteBucket","Master","List","AddColumn","View","onEnter","getSelectedItem","BucketState","Find","adjust","GetColumns","selectIcon","modifiers","renderModifier","_modifiers","$renderTag","content","removeItem","webix_rpt_date_selector","multicombo","getModifier","setModifier","_custom_last_size","px","py","BucketSettingsView","Views","ShowColumns","Update","RowTemplate","ToggleSub","_hasFocus","onSubViewOpen","HideAllEditors","onSubViewClose","ResetEditor","webix_rpt_bucket_delete","RemoveColumn","newColumn","ColumnList","BucketPopup","tableData","_ActiveEditor","newV","oldV","openSub","subrow","prevId","closeSub","FocusEditor","$subopen","DateView","GetPopupTemplate","ActiveGroup","isSelected","Summaries","labels","AddNewAggregation","GroupState","SummaryColumns","ValidateFormData","aggregate","LoadAggregations","ApplyOneRowMode","AddAggregation","summary","aggregation","GetDefaultFormData","formId","GetOperations","onTimedKeypress","NewColumnTemplate","this_1","DeleteAggregation","formList","valid","oId","cId","ChangeNewColumnName","OtherSettingsView","GetDateOptions","ChangeGroupBy","onModifierClick","ShowModifierPopup","groupState","LoadColumns","DatePopup","DatePopupView","ToggleGroupBy","ToggleBuckets","ToggleSortBy","gravity","ChangeSortBy","ChangeDirection","sortBy","chartState","Axis","ChartState","AxisPropertiesView","labelAlign","ApplyYAxis","ApplyXAxis","BaseStructureView","SaveOrder","Id","ColorPopupView","onColorSelect","GetSeries","updatedSeries","closeIcon","$renderInput","badge","webix_input_icon","hideCloseIcon","_onSearch","showCloseIcon","setIcon","nodes","getElementsByClassName","setBadge","Series","SeriesPropertiesView","ItemListTemplate","getItemTypes","getTypes","labelField","ChangeLabelField","valueFields","SubState","UpdateSeries","SeriesProperties","onAfterDrop","data->onClearAll","webix_rpt_chart_color","ShowColorPopup","action-visible","HideField","action-hidden","ShowField","webix_rpt_config_row_name","axisFields","UpdateAxis","AxisProperties","AxisRowTemplate","legendFields","ChangeLegend","GetDataInputs","Types","ValueFields","GetInitState","UpdateModuleState","ApplyChartType","ApplySeriesFrom","GenerateSeries","prevType","ShowAxisInputs","RenderSeries","LoadSeries","noAxisSupport","sourceArray","ApplySeriesKeys","base_1","prevValue","ColorPopup","ActiveSeries","Column","ColumnPropertiesView","valueField","colorField","lc","vc","cc","OnChange","StructureView","ChangeReportType","ColumnsView","onSearchChange","FilterFields","ColumnProperties","FrozenTemplate","GetFreeze","freezeColumn","EmptyView","mods","getModules","GetText","GetSVG","CssFactory","TooltipFactory","bases","valueColumn","colorColumn","props","MenuPopup","ID","trg","GridsView","GetListTemplate","webix_rpt_action_menu","Menu","onDblClick","onAfterSelect","LoadModule","Sorting","SearchCompare","parsed","updated","sState","prevState","ChangeSortButtons","btn","prevBtn","ExportView","typeToSort","boolean","picklist","reference","$selection","plainOutput","filterHTML","toExcel","toCSV","GetTableConfig","table_1","GetTableData","IsBucketColumn","groups","dateColumns","gColumns","GetColumnConfig","grid","byUser","SetColWidth","_1","Tbl","setColumnWidth","clearCss","ignoreDateNumber_1","hasNonDigits","regexp_1","wildToRegexp","matchers_1","colId","optionsMatch_1","findOptions","matchPerColumn","dateFormats_1","found_1","addHotKey","removeHotKey","offIcon","onIcon","SetVisibleButtons","newBtn","deleteModule","copyModule","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","m31","m32","m33","_fieldData","_optionsData","_modules","modules","_models","_models_async","refs","ref","_refs","major","newField","onlyNew","getRefs","was","origin","queryObj","collectTables","check_1","_queries","q","moduleProps","replacements","wild","regexp","lineTypes","multiTypeSupport","fiedls","colorIndex","All reports","Are you sure to delete this report?","Are you sure to delete this query?","Average","Color column","Common","Copy of","Count","Created on","Data source","Day","Delete report","Description","Enter query name","To Excel","To CSV","To PNG","To PDF","Filter","Filtering query","Frozen columns above","Group summaries","Join data","Heatmap","Labels column","Max","Min","Month","New","Click 'New' button to add a new report","Select any report from the list","No reports","No saved queries","Last modified","New column name","New report","Please delete the related query filter first","Please delete the related group rule first","Rename","Report name","Reports","Save query","Specify columns to group by and output(s)","Specify columns to sort by","Sum","Type to search","Year","Axes","X Axis","Y Axis","Data series","Keys column","X axis column","Values column","Color","Marker type","Fill marker","Legend","Gridlines","Bottom","None","Right","Stacked area","Spline area","Stacked bar","Create copy","circle","square","triangle","diamond","no markers","Vertical labels","Extract series from","True","False","Save filter to use it in other reports","No filter","Select","Data buckets","Bucket name","Bucket values","Add bucket","Specify columns and their data buckets","Search","Other","Other values","Are you sure to delete?","waitVisible","interval","destructed","AddView","cals","AddEvent","NavLabel","ChangeDate","DateLabel","timeline","GetStep","timelineMode","NavBarView","bottomOffset","defaultPalette","modernPalette","palettes","material","flat","willow","optionHeight","SidePopupView","compactBar","controls","onHide","Cals","updateCalendar","addCalendar","removeCalendar","UpdateColor","webix_template","ShowEditor","Editor","EditorView","Cid","SideView","monthSelect","onAfterDateSelect","ListType","editValue","webix_scheduler_cal_edit","webix_scheduler_cal_title","ToggleCalendar","webix_scheduler_active","SetTitle","side","maxHeight","AddCalendar","onAfterScroll","PopupView","EditAbility","ToggleState","checkbox","EditStopSilent","fail","editStop","NavPopupView","animate","tHeight","tabbarHeight","Parent","updatePos","todayIcon","SetToday","todayBtn","responsive","ShowNav","responsiveCell","NavPopup","ToggleAdd","EventActionMenu","Result","Root","shrinkTo","before","isToday","isMultiDay","all_day","daysBetweenInclusive","isSameDate","adate","bdate","icalFormat","string","name_1","UNTIL","strToDate","EXDATE","WEEKDAYS","FREQUENCE","DAILY","WEEKLY","MONTHLY","YEARLY","findDate","fillWdays","consts","BYDAY","wdays","INTERVAL","FREQ","BYYEARDAY","BYMONTHDAY","BYSETPOS","checkDay","sdate","oldDay","WeekdaysToDates","getParams","$id","$recurring","extractDate","clipSequence","COUNT","cutOccurrence","separateSequence","isFirstOccurrence","evStart","correctMode","origin_id","recurring","isLastPart","movePattern","newEvent","oldEvent","until","nmd","nwn","getWeekNum","BYMONTH","nm","checkPattern","RecurringFormView","CreateIntervalControls","CreateCheckboxes","CreateSelect","CreateRadio","UpdateEvent","Events","CheckBoxContainer","Checkboxes","PatternSelect","UntilDateContainer","UntilDateCalendar","untilDate","UntilNumContainer","UntilNum","CustomRecControls","ChangeControls","_freq","dayShort","CheckboxGuard","GetBYDAY","byDay","dayFull","monthFull","calculated","weekNum","weekday","yearday","rec_pattern","vertical","ChangeSelectors","_StartDate","untilCount","CountNum","minDate","SetUNTIL","SetBYDAY","SetPatternOptions","setDirty","GetUntil","GetRecPattern","changeMode","date_id","correctCountUntil","countToUntil","nexto","hasOneOccurrence","lr","EditRecurringMixin","ChangeMode","CorrectCountUntil","HasOneOccurrence","EventFormView","GetDateTime","ToggleTimeControls","CreateCalendarColor","getDirtyValues","PrepareChange","Wait","CreateRepeat","CreateUnitSelector","CreateSectionSelector","RecurringOptions","StartTime","EndTime","waitUnits","combo_1","Sections","sections","SubForm","ClearTempEvent","FillForm","labelTopHeight","ToggleSubform","ShowSubForm","clipboard","NewEvent","FillFormContinue","AdaptObjToMode","start_time","end_time","SetRecurring","yearStart","today","GetFromStartDate","roptions","ResetRecurringOptions","rec_option","GetStartDate","section","$color","minutes","PrepareOut","addEvent","UpdateExisting","UpdateSelection","newEvent_1","updateEvent","recVals","fvals","Join","ProcessRecurringOption","ProcessRecurringPattern","ProcessDates","ApplyDatechangeToRecurring","ProcessText","_changedValues","series_end_date","GetRecurring","edate","CorrectDateTime","ev_length","opposite","oldStart","length_1","GetRecurringPreset","dirty","UpdateStateDate","GetClosestOccurrenceDate","GetModeBounds","weekStart","weeks","Subform","IsDirty","subform","HideSubPop","FormPopup","cleanEventData","HandleCopyPaste","clipboardModes","ctrlKey","isMac","AddToClipboard","PasteFromClipboard","PurgeClipboard","setFocus","RestoreClipboardSource","$multi","_globalClickHandler","ChangePasteTarget","CreatePasteTarget","OnDestroy","offsetLeft","offsetTop","mousePosUnit","sheight","GetSectionHeight","childNodes","SetPasteTargetStyle","ClearPasteTargetStyle","querySelectorAll","sel","SetClipboardSourceStyle","event_1","GetEvent","prevCss","clip","GetEventData","CopyEvent","MoveEvent","evLength","GetTargetDate","sec","updateId","CopyPasteMixin","mainWidget","BRIGHTNESS","FONT","EventView","StartAction","copypaste","UnitsLocal","EventObj","DeleteEvent","EditEvent","removeEvent","removal","oneday","allday","timeFormatStr","startTime","endTime","fromTo","GetRecurringText","unitIDs_1","unitObj","unitValue","GetSection","pattern","EventActionPopup","buttons","MainView","topbar","ToggleEvent","ToggleSidePanel","_dndActionPopup","ShowEvent","HideEvent","sameEvent","_sidePanel","getDimmedColor","hex","toRgb","red","green","blue","rgbToHsv","hue","saturation","hsvToRgb","$past","timeStart","dayEventColor","$textColor","UnitListView","uniteBy","templateHeader","TemplateHeader","TimeStart","onUnits","SetUnits","start_1","AgendaView","headerHeight","TemplateCss","onItemRender","$unit","CurrentUnit","SelectEvent","_o","monthStart","getEvents","ToggleOverlay","_selected","datestring","fstring","ids","getUnitList","HourscaleView","heightSize","HourScaleItem","ParseHours","MultiMoreView","wxi-angle-down","ExpandData","wxi-angle-up","WrapData","MoreIcon","_expandState","maxVisibleLines","transition","_inAnimation","SetMoreIcon","_select","functor","trgs","LocateSelected","Unselect","_SelectionMode","id_1","SelectionMixin","_DataObj","firstElementChild","Resizer","y_diff","updateNodeHeight","updateText","x_diff","minEventHeight","getActualDate","differenceInCalendarDays","differenceInHours","f_cache","formatFunction","getSizes","d_1","dragOnly","modes","attr","updateSelection","editRecurring","newSubEvent","joinDateTime","shiftDate","mainDate","occDate","changeDate","ddate","dtime","$resize","moveMode","more","_waitPopup","finishOperation","copyEvent","$creation","$copy","$last_y","metaKey","dragCreate","scrollY_1","parentTopOffset","$top","$left","calId","ToHTML","getMaster","EventTemplate","noff","toff","$marked","markDropArea","drop","$extra","extra","getLastId","xCount","multiday","children","HideWindow","getEventUnits","sourceUnit","currentUnits","targetUnit","newUnits","multidayUnits","getStep","wrongDates","allDay","timelineMore","offsetParent","WeekDayNum","DayEventsView","webix_scheduler_day_event","webix_scheduler_day_scale_item","_e","ShowNew","RenderEvents","mobile","FilterToday","_marker_update_interval","UpdateMarkerPosition","_Marker","evs","PrepareEvents","role","MarkToday","$inner","orderSet","PruneStack","$sorder","max_count","SetPosition","GetEventEndDate","temp_width","evCorrectedCopy","sm","em","EventTemplateStart","resizer","MultidayEventList","webix_scheduler_multiday_event","_moreBtn","LimitData","GetStyle","excess","_reserve","_reserveIds","Animate","DayView","ScrollScale","GetDay","CalendarView","isOutside","MarkEvent","navigation","monthHeader","skipEmptyWeeks","Calendar","MoreWindowView","webix_scheduler_month_event","webix_scheduler_month_event_single","MoreTemplate","Win","_c","oneDay","DayFormatStr","MonthEventsView","webix_cal_date","_ev","ShowDay","webix_scheduler_more","ShowMore","webix_cal_day","CalendarTemplate","eventHeight","MoreWindow","$more","GetDayCss","maxLines","wStart","wEnd","dayIndex","dayHTML","IsSingleDay","es","ee","le","prevLength","GetPosition","start_a","start_b","days_a","monthData","GetMonthData","ShowWindow","MonthHeaderView","GetHeaderData","MonthListView","MonthView","BarView","MoreView","clientWidth","webix_scheduler_timeline_event","webix_list_item","InnerState","RefreshTask","_sectionsReady","_sectionSize","ClearCollections","_processed","_lastRow","_moreEvents","sectionIndex","GetUnitCount","CheckDates","GetUnitStart","MoreBarTemplate","GetGrid","GetUnitWidth","AddUnit","clickedUnit","innerState","TimelineView","SetScales","ResetScales","wstart","wend","GetDefaultScaleUnit","GetScalePrecision","GetScalesCellWidth","GetScalesArray","UnitEventsView","unitID","UnitsHeaderView","Header","Units","unitsCache","UnitMultidayList","FilterByUnits","expandable","multiEvents","UnitMultidayView","UnitsView","WeekEventsView","WeekHeaderView","MultiDayEventsView","itemHeight","ParseDays","BreakEventsByDay","_maxEvents","ResetListHeight","Days","processed","$config","allEvents","renderedEvents","toHide","_day","visible","MoreOption","cIndex","rIndex","GetSizePosition","WeekView","GetWeek","_month","YearCalendarView","DayEvents","calendarHeader","webix_cal_day_with_event","ShowEvents","webix_cal_month","ShowMonth","SetStateDate","ManageDateChange","GetMonthStart","_date","MonthStart","showCalendar","monthEnd","dateKey","YearView","GetCalendars","m34","m35","m36","m37","m38","m39","m40","m41","m42","m43","createEvents","events_ready","cals_ready","createUnits","units_ready","_sections","createSections","sections_ready","utc","serverUTC","loaded_ranges","getColor","eventOut","getLocal","getDynamic","dimPastEvents","xdate","isPast","roundTime","parseFormatStr","fromStr","sortCalendars","onAfterDelete","setActive","onAfterAdd","data->onDataUpdate","rgb","tosave","cev","isFirst","recurring_update_mode","recurring_update_date","Week","Agenda","Timeline","Today","Create","Next","Previous","Next day","Previous day","Next week","Previous week","Next month","Previous month","Add calendar","Do you really want to remove this calendar?","Edit calendar","Settings","Inactive calendar","No Events","All Day","Expand all-day events","Collapse all-day events","The event will be deleted permanently, are you sure?","Delete event","(No title)","Event","Start","End","Edit event","Assigned to units","No units","Unknown unit","never","none","daily","weekly","monthly","yearly","years","Repeat","End repeat","Repeats each","till","times","weekly, every","monthly, every","yearly, every","every working day","custom","Every","of","day of year","after several occurrences","week on","Change recurring pattern","All events","This event","This event and the following","Edit recurring event","Timeline scale","Section","Show more","Copy event","groupDelimiter","groupSize","decimalDelimiter","decimalSize","dateFormat","timeFormat","longDateFormat","fullDateFormat","am","pm","price","priceSettings","monthShort","monthFormat","yearFormat","gantt","report","reports","scheduler"],"sourceRoot":""}